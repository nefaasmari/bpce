/**
 * Généré par : SIGCESIE\ct-tfsbuild
 * Changeset TFS : C518455
 * Etiquette TFS : DC_api-portail_20190710.1
 * Déclenchement : Manual
 */
var myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){function e(){}return e.Application="applicationService-libPortail",e.Authentification="authentificationService-libPortail",e.Habilitation="habilitationService-libPortail",e.EntiteTitulaire="entiteTitulaireService-libPortail",e.ContexteClient="contexteClientService-libPortail",e.CultureNet="cultureNetService-libPortail",e.FavoriMetier="favoriMetierService-libPortail",e.FavoriPerso="favoriPersoService-libPortail",e.MigrationFavori="migrationFavoriService-libPortail",e.Guichet="guichetService-libPortail",e.Lien="lienService-libPortail",e.ContexteLisa="contexteLisaService-libPortail",e.MigrationPreference="migrationPreferenceService-libPortail",e.MigrationPreference1803="migrationPreference1803Service-libPortail",e.MigrationPreference1806="migrationPreference1806Service-libPortail",e.MigrationPreference1811="migrationPreference1811Service-libPortail",e.Preference="preferenceService-libPortail",e.Eds="edsService-libPortail",e.Portail="portailService-libPortail",e.Tiers="tiersService-libPortail",e.Widget="widgetService-libPortail",e.FavoriPersoV1="favoriPerso-v1-libPortail",e.FavoriPersoV2="favoriPerso-v2-libPortail",e.LienV1="lien-v1-libPortail",e.Hint="hintService-libPortail",e.Message="messageService-libPortail",e.Token="tokenService-libPortail",e.Hook="hookService-libPortail",e}();t.ServiceNames=i;var n=function(){function e(){}return e}();t.ProviderNames=n,t.app=angular.module("libPortail",["ngSanitize","ui.bootstrap","myway.ui","myway.core-api"]),t.Utils=e.core.Utils,t.EdsUtils=e.core.EdsUtils,t.StringUtils=e.core.StringUtils,t.NumberUtils=e.core.NumberUtils}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.OUTLOOK="AC44",e}();e.CodesApplication=t}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){function i(e,t,i,n,r,o,a,s){this.$q=e,this.agentService=t,this.mobiliteService=i,this.logger=n,this.habilitationService=r,this.favoriPersoService=o,this.favoriMetierService=a,this.modalService=s}return i.prototype.getFamilles=function(e){var i=this;return void 0===e&&(e=""),this.agentService.getAuthentificationInfo().then(function(t){var n={motClef:e,codeEtablissement:t.codeEtablissement};return i.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway/v1/rechercheFamille",params:n,method:MyWay.Services.MethodEnum.GET,withHeaders:!0})}).then(function(e){var i=_.find(e,function(e){return"CAT"===e.codeFamille});return new t.application.FamilleList(i?i.listeSousFamille:[])})},i.prototype.getApplications=function(e,t){var i=this;return void 0===t&&(t=!0),e=e||{},e.typeRecherche=e.typeRecherche||1,this.agentService.getAuthentificationInfo().then(function(n){return e.codeEtablissement=e.codeEtablissement||n.codeEtablissement,i.rechercheApplications(e,t)}).then(function(t){return i.buildApplicationList(t,e.codeEtablissement)})},i.prototype.rechercheApplications=function(t,i){var n=this;return void 0===i&&(i=!0),this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/rechercheApplication",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:t,cache:i})["catch"](function(t){return n.$q.reject(new e.core.ErreurMyway("Erreur technique lors de la recherche des applications",t))})},i.prototype.rechercheApplicationsByCodes=function(t){var i=this;if(!t.length)return this.$q.when([]);var n={listeApplicationParametre:_.map(t,function(e){var t={codeApplication:e};return t})};return this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/rechercheApplication",method:MyWay.Services.MethodEnum.POST,withHeaders:!0,data:n}).then(function(e){return e.listeApplicationParametre})["catch"](function(t){return i.$q.reject(new e.core.ErreurMyway("Erreur technique lors de la recherche des applications",t))})},i.prototype.getApplication=function(i){var n=this;return this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/application",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:i}).then(function(e){return new t.Application(e,null)})["catch"](function(t){return n.$q.reject(new e.core.ErreurMyway("Erreur technique lors de la récupération du détail d'une application",t))})},i.prototype.saveApplication=function(t){var i=this;return this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/application",method:t.codeApplication?MyWay.Services.MethodEnum.PUT:MyWay.Services.MethodEnum.POST,withHeaders:!0,data:t})["catch"](function(t){return i.$q.reject(new e.core.ErreurMyway("Erreur technique lors de l'enregistrement d'une application",t))})},i.prototype.postApplication=function(t){var i=this;return this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/application",method:MyWay.Services.MethodEnum.POST,withHeaders:!0,data:t})["catch"](function(t){return i.$q.reject(new e.core.ErreurMyway("Erreur technique lors de la création d'une application",t))})},i.prototype.getApplicationContexteMobilite=function(e){return this.getInfosMobilite().then(function(i){t.ApplicationList.PLATEFORMES=i.plateformes;var n=new t.DeviceCompatible(e.libelleDeviceCompatible,e.codeVisibiliteApplication);return n.init(i),n})},i.prototype.getApplicationsContexteMobilite=function(e){var t=this,i={},n=[];return e.forEach(function(e){n.push(t.getApplicationContexteMobilite(e).then(function(t){i[e.codeApplication]=t}))}),this.$q.all(n).then(function(){return i})},i.prototype.getElementsConfigurationPortail=function(){var t=this;return this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/elementConfPortail",method:MyWay.Services.MethodEnum.GET,withHeaders:!0})["catch"](function(i){return t.$q.reject(new e.core.ErreurMyway("Erreur technique lors de la recherche des éléments de configuration",i))})},i.prototype.getElementConfigurationZone=function(e){var t={};return null!=e&&(t.idZone=e),this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/elementConfZone",withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:t}).then(function(e){return _.sortBy(e,function(e){return e.ordre})})},i.prototype.getListeZonePortail=function(){return this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/zonePortail",withHeaders:!0,method:MyWay.Services.MethodEnum.GET})},i.prototype.getVisibilites=function(){var e=[{code:0,libelle:"Pas de restriction"},{code:1,libelle:"Dans établissement uniquement"},{code:2,libelle:"Hors établissement uniquement"}];return this.$q.when(e)},i.prototype.afficherModaleDeviceNonCompatible=function(){return this.modalService.showPopup({headerText:"Erreur",bodyText:"Le fonctionnement de cette application n'est pas compatible avec l'un ou plusieurs des éléments suivants : résolution minimale, type de réseau, système d’exploitation, écran non tactile.",closeButtonText:"Fermer",iconName:"",size:"md"})},i.prototype.afficherModaleClientIdentifie=function(){return this.modalService.showPopup({headerText:"Information",bodyText:"Le fonctionnement de cette application nécessite d'avoir identifié un client au préalable.",closeButtonText:"Fermer",iconName:"",size:"md"})},i.prototype.afficherModaleProduitIdentifie=function(){return this.modalService.showPopup({headerText:"Information",bodyText:"Cette application doit être lancée à partir du produit ou service correspondant dans la synthèse client.",closeButtonText:"Fermer",iconName:"",size:"md"})},i.prototype.chargerConfigurationElementZone=function(){return this.$q.all([this.getElementsConfigurationPortail().then(function(e){return t.ApplicationList.LISTE_ELEMENTS_CONF=e}),this.getElementConfigurationZone().then(function(e){return t.ApplicationList.LISTE_ELEMENTS_ZONE=e}),this.getListeZonePortail().then(function(e){return t.ApplicationList.LISTE_ZONE_PORTAIL=e})]).then(function(){})},i.prototype.getInfosMobilite=function(){return this.infosMobilitePromise||(this.infosMobilitePromise=this.mobiliteService.getInfosMobilite()),this.infosMobilitePromise},i.prototype.buildApplicationList=function(e,i){var n,r,o,a,s=this;return this.logger.trace("buildApplicationList","START"),this.$q.all([this.chargerConfigurationElementZone(),this.agentService.isAgentFromAgenceLaHenin().then(function(e){return n=e})["catch"](function(e){s.logger.error("isAgentFromAgenceLaHenin",e),n=!1}),this.favoriMetierService.getUserFavoris().then(function(e){return r=e}),this.getApplicationsContexteMobilite(e).then(function(e){return o=e}),this.getVisibilites().then(function(e){return a=e})]).then(function(){var r=_.chain(e).map(function(e){var i=new t.Application(e,o[e.codeApplication]);return i.visibilite=_.find(a,function(e){return e.code===i.application.codeVisibiliteApplication}),i}).filter(function(e){return!(n&&e.isExclusAgentLaHenin()||e.application.codeEtablissement&&e.application.codeEtablissement!==i)}).value();return s.habilitationService.setHabilitationFlags(r,function(e){return e.getHabilitation()},function(e,t){return e.isHabilite=t})}).then(function(e){s.logger.trace("buildApplicationList","END");var i=new t.ApplicationList(e);return r.forEach(function(e){var t=i.getByCodeApplication(e.application.codeApplication);t&&(t.isFavoriMetier=!0,t.pushToFavoris=e.pushToFavoris)}),i})},i.$inject=["$q",e.core.ServiceNames.Agent,e.core.ServiceNames.Mobilite,e.core.ServiceNames.Logger,t.ServiceNames.Habilitation,t.ServiceNames.FavoriPerso,t.ServiceNames.FavoriMetier,"modalService"],i}();t.ApplicationService=i,t.app.service(t.ServiceNames.Application,i)}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){function i(e,t,i){this.$q=e,this.agentService=t,this.logger=i}return i.prototype.getAuthentificationInfo=function(){return this.agentService.getAuthentificationInfo()},i.prototype.verifierHabilitation=function(){var i=this;return this.agentService.estHabiliteKV([t.CodesHabilitations.SHOR0S]).then(function(n){return n[t.CodesHabilitations.SHOR0S]?void 0:i.$q.reject(new e.core.ErreurMyway("Vous ne disposez pas de l'habilitation ("+t.CodesHabilitations.SHOR0S+" requis pour accéder au portail.",2))},function(t){throw new e.core.ErreurMyway("Service de vérification des habilitations non disponible.",t,2)})},i.prototype.rechargerHabilitations=function(e){var t=this;return this.updatePosteFonctionnelAuthentificationInfo(e).then(function(e){var i=t.$q.when();return t.logger.trace("chargement des habilitations"),i=t.agentService.chargerHabilitations(),i.then(function(){return t.verifierHabilitation()})})},i.prototype.getPosteFonctionnelAgent=function(){var e,i=this;return this.agentService.getAuthentificationInfo().then(function(n){return e=n,i.logger.trace("getPosteFonctionnelAgent",e.codeEtablissement,e.agentConnecte.referenceExterneAgent),i.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/structure/v2/posteFonctionnelAgent",method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:e.codeEtablissement,codeAgent:t.EdsUtils.getIdentifiantEDS(e.agentConnecte.referenceExterneAgent)},withHeaders:!0})}).then(function(t){var i=_.filter(t.listePosteFonctionnel,function(t){return t.codeEtablissement===e.codeEtablissement});return i})},i.prototype.getAdresseMessagerie=function(e){var t="";return t},i.prototype.updatePosteFonctionnelAuthentificationInfo=function(i){var n,r=this;return this.agentService.getAuthentificationInfo().then(function(o){var a=i.dateDebutValiditePF.split("-").reverse().join(""),s=i.dateDebutValiditePF.split("-").reverse().join(""),c={NODATP:i.telephonePosteFonctionnel,adresseMessagerie:r.getAdresseMessagerie(i),codeCivilite:i.civiliteAgent,codeIndicateurFinStructure:i.informationRattachement.codeIndicateurFinStructure,codeInseePays:i.codePaysSite,codeQualiteAgent:i.codeQualiteAgent,dateDebutValidite:a,dateFinValidite:s,designationLongueAgent:i.designationAgent,designationPosteFonctionnel:i.libelleFonction,identifiantInterneSite:t.EdsUtils.getIdentifiantEDS(i.identSitePosteFonctionnel),libelleEds:i.informationRattachement.libelleEDSRattachement,libelleTypeEds:i.informationRattachement.libelleTypeEDSRattachement,ligne2Adresse:t.StringUtils.decodeRestString(i.ligne2AdresseSite),ligne3Adresse:t.StringUtils.decodeRestString(i.ligne3AdresseSite),ligne4Adresse:t.StringUtils.decodeRestString(i.ligne4AdresseSite),ligne5Adresse:t.StringUtils.decodeRestString(i.ligne5AdresseSite),ligne6Adresse:t.StringUtils.decodeRestString(i.ligne6AdresseSite),nomFamillePersonnePhysique:i.nomFamilleAgent,nomUsagePersonnePhysique:t.StringUtils.decodeRestString(i.nomUsageAgent),numeroEdsSuperieur:t.EdsUtils.getIdentifiantEDS(i.informationRattachement.identifiantEDSRattachement),numeroExterneEds:t.EdsUtils.getIdentifiantEDS(i.referencePosteFonctionnel),numeroInterneEds:t.EdsUtils.getIdentifiantEDS(i.identifiantPosteFonctionnel),prenom:t.StringUtils.decodeRestString(i.prenomAgent),referenceExterneAgent:t.EdsUtils.getIdentifiantEDS(i.codeAgent),referenceExterneEdsRattachemen:t.EdsUtils.getIdentifiantEDS(i.informationRattachement.referenceEDSRattachement),typeEds:t.EdsUtils.getTypeEDS(i.informationRattachement.typeEDSRattachement),typeEdsRattachement:t.EdsUtils.getTypeEDS(i.informationRattachement.codeIndicateurFinStructure),typeFonction:i.typeFonction,LICEE1:o.agentConnecte.LICEE1,dateDebutValiditeReferentiel:o.agentConnecte.dateDebutValiditeReferentiel};if(n={agentConnecte:c,codeEtablissement:o.codeEtablissement,ENVIRON:o.ENVIRON,numeroStationTravail:o.numeroStationTravail,guichetAgent:o.guichetAgent},!n.codeEtablissement||!n.agentConnecte.referenceExterneAgent||!n.agentConnecte.typeFonction||null==n.numeroStationTravail)throw new e.core.ErreurMyway("Données d'authentification incomplètes !",2);return r.logger.trace("updatePosteFonctionnelAuthentificationInfo",n),r.agentService.setAuthentificationInfo(n)}).then(function(){return n})},i.$inject=["$q",e.core.ServiceNames.Agent,e.core.ServiceNames.Logger],i}();t.AuthentificationService=i,t.app.service(t.ServiceNames.Authentification,i)}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.SHOR0S="SHOR0S",e.SHDYD0="SHDYD0",e.SHDYD5="SHDYD5",e.SHOPB3="SHOPB3",e.SHOPI3="SHOPI3",e.SHDS73="SHDS73",e.SHDS75="SHDS75",e.SHDS44="SHDS44",e.SHDS43="SHDS43",e.SHDS42="SHDS42",e}();e.CodesHabilitations=t}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){function t(e,t,i,n){this.$q=e,this.$rootScope=t,this.agentService=i,this.logger=n}return t.prototype.filterByHabilitation=function(e,t,i){var n=this,r=_.map(e,function(e){return n.estHabiliteExpression(t(e))});return this.$q.all(r).then(function(t){for(var i=[],n=0;n<e.length;n++)t[n]&&i.push(e[n]);return i})},t.prototype.setHabilitationFlags=function(e,t,i){var n=this,r=_.map(e,function(e){return n.estHabiliteExpression(t(e))});return this.$q.all(r).then(function(t){for(var n=0;n<e.length;n++)i(e[n],t[n]);return e})},t.prototype.estHabiliteExpression=function(t){var i=this;if(!t)return this.$q.when(!0);if(!this.isExpressionValide(t))throw new e.core.ErreurMyway("Chaîne habilitation non valide",t);var n=t,r=n.match(/\w{2,6}/g);return this.agentService.estHabiliteKV(r).then(function(e){r.forEach(function(t){n=n.replace(new RegExp(t,"g"),e[t].toString())});try{var o=i.$rootScope.$eval(n);return o}catch(a){return i.logger.error("expression habilitation invalide: "+t),!1}})["catch"](function(e){return i.logger.error("estHabiliteExpression",t,e),!1})},t.prototype.isExpressionValide=function(e){var t=0;return _.forEach(e,function(e){"("===e?t++:")"===e&&t--}),0===t},t.$inject=["$q","$rootScope",e.core.ServiceNames.Agent,e.core.ServiceNames.Logger],t}();t.HabilitationService=i,t.app.service(t.ServiceNames.Habilitation,i)}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.entiteTitulaire||(e.entiteTitulaire={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function i(e,t,i,n){this.$q=e,this.logger=t,this.agentService=i,this.modalService=n}return i.prototype.getEntitesTitulaires=function(i){var n=this;return this.agentService.getAuthentificationInfo().then(function(r){var o={typeRechercheEntiteTitulaire:"1",codeEtablissement:r.codeEtablissement,identifiantTiers:parseInt(i,10)};return n.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/entitetitulaire/v1/recherche",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:o}).then(function(e){return _.forEach(e,function(e){e.identifiantEntiteTitulaire=t.EdsUtils.getIdentifiantEntiteTitulaire(e.identifiantEntiteTitulaire)}),e})["catch"](function(t){return n.logger.error("getEntitesTitulaires",t),n.$q.reject(new e.core.ErreurMyway("Erreur technique lors de la récupération des entités titulaires",t))})})},i.prototype.getInformationEntiteTitulaire=function(t){var i=this;return this.agentService.getAuthentificationInfo().then(function(n){var r={codeEtablissement:n.codeEtablissement,identifiantEntiteTitulaire:parseInt(t,10)};return i.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/entitetitulaire-v2/informationEntiteTitulaire",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:r})["catch"](function(t){return i.logger.error("getInformationEntiteTitulaire",t),i.$q.reject(new e.core.ErreurMyway("Erreur technique lors de la récupération des informations sur l'entité titulaire",t))})})},i.prototype.selectEntiteTitulaire=function(e,t){return this.modalService.showModal({templateUrl:"typescript/choix-entite-titulaire/selection-entite-titulaire.html",controller:"SelectionEntiteTitulaireControleur",controllerAs:"ctrl",windowClass:"app-modal-window-MEG",backdrop:!1,keyboard:!1,size:"lg",resolve:{identifiantPersonne:function(){return e},identifiantProfessionnel:function(){return t}}})},i.$inject=["$q",e.core.ServiceNames.Logger,e.core.ServiceNames.Agent,"modalService"],i}();i.EntiteTitulaireService=n,t.app.service(t.ServiceNames.EntiteTitulaire,n)}(i=t.entiteTitulaire||(t.entiteTitulaire={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";function t(){return function(e,t){switch(t){case"1":return"Simple";case"2":return"Joint entre époux";case"3":return"Joint entre tiers";case"4":return"Indivision successorale";default:return""}}}e.app.filter("modeCompositionClientBancaireFilter",t)}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function i(t,i,n,r,o,a,s){var c=this;this.$scope=t,this.$q=i,this.$modalInstance=n,this.agentService=r,this.entiteTitulaireService=o,this.identifiantPersonne=a,this.identifiantProfessionnel=s,this.loading=!1,this.loading=!0,this.initTableau(),this.entiteTitulaireService.getEntitesTitulaires(a).then(function(e){c.identifiantProfessionnel&&(e=_.filter(e,function(e){return"2"===e.codeUsageEntiteTitulaire})),c.tableauOptions.data=e})["finally"](function(){c.loading=!1})["catch"](function(t){return c.$q.reject(new e.core.ErreurMyway("Erreur technique lors de la récupération des entités titulaires",t))})}return i.prototype.onSelectionChange=function(e){this.entiteSelectionnee=e},i.prototype.valider=function(){var t=this,i={identifiantEntiteTitulaire:this.entiteSelectionnee.identifiantEntiteTitulaire},n=this.$q.when();this.identifiantProfessionnel&&(n=this.entiteTitulaireService.getInformationEntiteTitulaire(this.entiteSelectionnee.identifiantEntiteTitulaire).then(function(t){var n=_.find(t.compositionEntiteTitulaire.listePersonneTitulaire,function(e){return null!==e.identifiantProfessionnel});n&&(i.identifiantProfessionnel=e.core.EdsUtils.getIdentifiantProfessionnel(n.identifiantProfessionnel))})),n.then(function(){return t.$modalInstance.close(i)})},i.prototype.initTableau=function(){this.tableauOptions={width:"col-md-12 ",orderBy:"",reserve:!1,perPage:100,multiSelect:!1,filterEnable:!1,sortEnable:!1,moreEnable:!1,columns:[{title:"Numéro",bind:"identifiantEntiteTitulaire",cssClass:"col-md-2"},{title:"Libellé",bind:"designationEntiteTitulaire",cssClass:"col-md-4",filter:"|date: 'dd/MM/yyyy'"},{title:"Usage",bind:"codeUsageEntiteTitulaire",cssClass:"col-md-2",filter:"|usageClientBancaireFilter"},{title:"Mode de composition",bind:"codeUsageEntiteTitulaire",cssClass:"col-md-4",filter:"|modeCompositionClientBancaireFilter: mwTableRow.modeCompositionEntiteTitulaire"}],data:null,selectedItems:[],templateUrl:"",selectionChangeHandler:this}},i.$inject=["$scope","$q","$modalInstance",e.core.ServiceNames.Agent,t.ServiceNames.EntiteTitulaire,"identifiantPersonne","identifiantProfessionnel"],i}();i.SelectionEntiteTitulaireControleur=n,t.app.controller("SelectionEntiteTitulaireControleur",n)}(i=t.entiteTitulaire||(t.entiteTitulaire={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";function t(){return function(e){var t;return t="1"===e?"Privé":"Professionnel"}}e.app.filter("usageClientBancaireFilter",t)}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.PORTAIL_MYWAY="portailMyway",e.TYPE_PORTAIL="typePortail",e.URL_CULTURE_NET="URLCultureNet",e}();e.ContextKeys=t}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.PERSONNE_PHYSIQUE="1",e.PERSONNE_MORALE="2",e.INCONNU="",e}();e.CodesPersonnaliteJuridique=t,e.CAPACITES_JURIDIQUES_PERSONNE_PROTEGEE=["00","03","04","05","06","08","10","11","12","13","14","15","16","17","18","19","20"];var i=function(){function e(){}return e.CLIENT="0",e.TIERS="1",e.PROSPECT="2",e}();e.CodesTypeRelation=i;var n=function(){function e(){}return e.AGENCE="003",e}();e.TypeEds=n}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.culturenet||(e.culturenet={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function t(e,t,i,n,r,o){this.$q=e,this.$timeout=t,this.$http=i,this.agentService=n,this.habilitationService=r,this.logger=o}return t.prototype.chargerHabilitations=function(){this.logger.trace("CultureNet","chargement des habilitations");var e={rubriquesCommunautairesLoaded:!1,rubriquesEtablissementsLoaded:!1},t=[];return t.push(this.habilitationService.loadHabilitationsCommunautaires().then(function(){return e.rubriquesCommunautairesLoaded=!0})["catch"](function(t){e.erreurRubriquesCommunautaires=t})),t.push(this.habilitationService.chargerHabilitationsCultureNet().then(function(){return e.rubriquesEtablissementsLoaded=!0})["catch"](function(t){e.erreurRubriquesEtablissements=t})),this.$q.all(t).then(function(){return e})},t.prototype.getUneBPCE=function(){return this.$http.get("http://culturenet.intragrp.caisse-epargne.fr:8080/GCE.CultureNet.Web/Contenu/national/rss/unesGroupe.xml",{withCredentials:!0}).then(function(t){var i=e.core.XmlUtils.parseFromString(t.data,!0),n=i.getElementsByTagName("rss");if(!n.length)throw"Format du XML incorrect: balise rss inexistante";var r=n[0].getElementsByTagName("item");return _.map(r,function(e){var t={title:e.getElementsByTagName("title")[0].textContent,description:e.getElementsByTagName("description")[0].textContent,image:e.getElementsByTagName("image")[0].textContent,link:e.getElementsByTagName("link")[0].textContent};return t})})},t.$inject=["$q","$timeout","$http",e.core.ServiceNames.Agent,e.core.ServiceNames.Habilitation,e.core.ServiceNames.Logger],t}();i.CultureNetService=n,t.app.service(t.ServiceNames.CultureNet,n)}(i=t.culturenet||(t.culturenet={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";e.CONTEXTE_CLIENT_PCM_PATHS={indicateurSyntheseClient:"indicateurSyntheseClient",indicateurChargement:"indicateurChargement",indicateurSynchroSynthese:"indicateurSynchroSynthese",designationCourte:"syntheseClientProfilPP.designationCourte",codeCivilite:"syntheseClientProfilPP.codeCivilite",nomUsage:"syntheseClientProfilPP.nomUsage",nomFamille:"syntheseClientProfilPP.nomFamille",prenom:"syntheseClientProfilPM.prenom",nomCommercial:"syntheseClientProfilPM.nomCommercial",raisonSociale:"syntheseClientProfilPM.raisonSocial",numeroSiren:"syntheseClientProfilPM.numeroSIREN",idEdsOrigineClient:"syntheseClientOrigineClient.idEdsInterne",idEdsInterneSuiviPar:"syntheseClientSuivi.idEdsInterne",codeAgentSuiviPar:"syntheseClientSuivi.codeAgent",codeAppartenanceReseau:"syntheseClientProfilPP.codeAppartenanceReseau",codePersonnaliteJuridique:"",codeCapaciteJuridique:"syntheseClientProfilPP.codeCapaciteJuridique",codeCategorieSocioProf:"syntheseClientProfilPP.codeCategorieSocioProf",dateDeces:"syntheseClientProfilPP.dateDeces",indicExistenceProfessionnel:"syntheseClientProfilPP.indicExistenceProfessionnel",codeClientTiers:"syntheseClientProfilPP.codeClientTiers",codeProspect:"syntheseClientProfilPP.codeProspect",codeMarche:"syntheseClientProfilPP.codeMarche"},e.CONTEXTE_CLIENT_MYWAY_PATHS={indicateurSyntheseClient:"indicateurSyntheseClient",indicateurChargement:"indicateurChargement",indicateurSynchroSynthese:"indicateurSynchroSynthese",designationCourte:"syntheseClientDonneesSignaletiques.syntheseClientProfil.designationCourte",codeCivilite:"syntheseClientDonneesSignaletiques.syntheseClientProfil.codeCivilite",nomUsage:"syntheseClientDonneesSignaletiques.syntheseClientProfil.nomUsage",nomFamille:"syntheseClientDonneesSignaletiques.syntheseClientProfil.nomFamille",prenom:"syntheseClientDonneesSignaletiques.syntheseClientProfil.prenom",nomCommercial:"syntheseClientDonneesSignaletiques.syntheseClientProfil.nomCommercial",raisonSociale:"syntheseClientDonneesSignaletiques.syntheseClientProfil.syntheseClientProfilSpecifiquePersonneMorale.raisonSocial",numeroSiren:"syntheseClientDonneesSignaletiques.syntheseClientProfil.syntheseClientProfilSpecifiquePersonneMorale.numeroSIREN",idEdsOrigineClient:"syntheseClientDonneesSignaletiques.syntheseClientOrigineClient.idEdsOrigineClient",idEdsInterneSuiviPar:"syntheseClientDonneesSignaletiques.syntheseClientSuivi.idEdsInterneSuiviPar",codeAgentSuiviPar:"syntheseClientDonneesSignaletiques.syntheseClientSuivi.codeAgentSuiviPar",codeAppartenanceReseau:"syntheseClientDonneesSignaletiques.syntheseClientProfil.codeAppartenanceReseau",codePersonnaliteJuridique:"syntheseClientDonneesSignaletiques.syntheseClientOrigineClient.codePersonnaliteJuridique",codeCapaciteJuridique:"syntheseClientDonneesSignaletiques.syntheseClientProfil.codeCapaciteJuridique",codeCategorieSocioProf:"syntheseClientDonneesSignaletiques.syntheseClientProfil.codeCategorieSocioProf",dateDeces:"syntheseClientDonneesSignaletiques.syntheseClientProfil.dateDeces",indicExistenceProfessionnel:"syntheseClientDonneesSignaletiques.syntheseClientProfil.indicExistenceProfessionnel",codeClientTiers:"syntheseClientDonneesSignaletiques.syntheseClientProfil.codeClientTiers",codeProspect:"syntheseClientDonneesSignaletiques.syntheseClientProfil.codeProspect",codeMarche:"syntheseClientDonneesSignaletiques.syntheseClientProfil.codeMarche"}}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){function i(e,i){this.contextId=e,this.identifiantPersonne=i,this.codePersonnaliteJuridique=t.CodesPersonnaliteJuridique.INCONNU,this.indicateurActiviteProfessionnel=!1}return Object.defineProperty(i.prototype,"libelleTypeRelation",{get:function(){var e="";return this.codeTypeRelation===t.CodesTypeRelation.PROSPECT?e="Prospect":this.codeTypeRelation===t.CodesTypeRelation.TIERS&&(e="Tiers"),e},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"personneProtegee",{get:function(){var e=this;return t.CAPACITES_JURIDIQUES_PERSONNE_PROTEGEE.some(function(t){return t===e.codeCapaciteJuridique})},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"designationLongue",{get:function(){return e.core.ClientUtils.getDesignation(this.codeCivilite,this.nomUsage,this.nomFamille,this.prenom)},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"libelleCourt",{get:function(){return this.isPersonnePhysique?e.core.ClientUtils.getDesignationCourte(this.nomUsage,this.nomFamille,this.prenom):this.raisonSociale},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPersonnePhysique",{get:function(){return this.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"isPersonneMorale",{get:function(){return this.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_MORALE},enumerable:!0,configurable:!0}),i.prototype.isEmpty=function(){return null==this.designationCourte&&this.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.INCONNU&&null==this.codeAgentSuiviPar&&null==this.idEdsInterneSuiviPar&&null==this.idEdsOrigineClient},i}();t.ContexteClientData=i}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var __extends=this&&this.__extends||function(e,t){function i(){this.constructor=e}for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)},myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(i){function n(e,t,n,r,o,a,s,c){i.call(this,e),this.$q=t,this.$parse=n,this.logger=r,this.agentService=o,this.contexteClientService=a,this.tiersService=s,this.edsService=c}return __extends(n,i),n.prototype.deleteAllContexts=function(){return this.contexteClientService.deleteAllContexts()},n.prototype.getIdClientFromContext=function(e){return this.contexteClientService.getIdClientFromContext(e)},n.prototype.getAttachedProcessIdFromContext=function(e){return this.contexteClientService.getAttachedProcessIdFromContext(e)},n.prototype.setContextMode=function(e,t){return this.contexteClientService.setContextMode(e,t)},n.prototype.getCurrentContext=function(){return this.contexteClientService.getProperty()},n.prototype.setCurrentContext=function(e){return this.contexteClientService.setProperty(null,e)},n.prototype.setCurrentContextProperty=function(e,t){return this.contexteClientService.setProperty(e,t)},n.prototype.setContexteClientData=function(e,i){var n=this;return this.agentService.getTypePortail().then(function(r){var o=1===r?t.CONTEXTE_CLIENT_MYWAY_PATHS:t.CONTEXTE_CLIENT_PCM_PATHS,a=[];if(i.designationCourte&&a.push(n.contexteClientService.setContextProperty(o.designationCourte,i.designationCourte,e)),i.codePersonnaliteJuridique&&a.push(n.contexteClientService.setContextProperty(o.codePersonnaliteJuridique,i.codePersonnaliteJuridique,e)),i.idEdsOrigineClient&&a.push(n.contexteClientService.setContextProperty(o.idEdsOrigineClient,i.idEdsOrigineClient+"",e)),i.codeAgentSuiviPar&&a.push(n.contexteClientService.setContextProperty(o.codeAgentSuiviPar,i.codeAgentSuiviPar+"",e)),i.idEdsInterneSuiviPar&&a.push(n.contexteClientService.setContextProperty(o.idEdsInterneSuiviPar,i.idEdsInterneSuiviPar+"",e)),i.nomCommercial&&a.push(n.contexteClientService.setContextProperty(o.nomCommercial,i.nomCommercial,e)),i.raisonSociale&&a.push(n.contexteClientService.setContextProperty(o.raisonSociale,i.raisonSociale,e)),
i.codeAppartenanceReseau&&a.push(n.contexteClientService.setContextProperty(o.codeAppartenanceReseau,i.codeAppartenanceReseau,e)),i.numeroSIREN&&a.push(n.contexteClientService.setContextProperty(o.numeroSiren,i.numeroSIREN,e)),i.codeCivilite&&a.push(n.contexteClientService.setContextProperty(o.codeCivilite,i.codeCivilite,e)),i.nomUsage&&a.push(n.contexteClientService.setContextProperty(o.nomUsage,i.nomUsage,e)),i.nomFamille&&a.push(n.contexteClientService.setContextProperty(o.nomFamille,i.nomFamille,e)),i.prenom&&a.push(n.contexteClientService.setContextProperty(o.prenom,i.prenom,e)),i.codeCapaciteJuridique&&a.push(n.contexteClientService.setContextProperty(o.codeCapaciteJuridique,i.codeCapaciteJuridique,e)),i.codeCategorieSocioProf&&a.push(n.contexteClientService.setContextProperty(o.codeCategorieSocioProf,i.codeCategorieSocioProf,e)),i.dateDeces&&a.push(n.contexteClientService.setContextProperty(o.dateDeces,i.dateDeces,e)),i.indicateurActiviteProfessionnel&&a.push(n.contexteClientService.setContextProperty(o.indicExistenceProfessionnel,i.indicateurActiviteProfessionnel?"1":"0",e)),i.codeMarche&&a.push(n.contexteClientService.setContextProperty(o.codeMarche,i.codeMarche,e)),i.codeTypeRelation){var s=i.codeTypeRelation===t.CodesTypeRelation.PROSPECT?"1":"0",c=i.codeTypeRelation===t.CodesTypeRelation.CLIENT?"0":"1";a.push(n.contexteClientService.setContextProperty(o.codeProspect,s)),a.push(n.contexteClientService.setContextProperty(o.codeClientTiers,c))}return n.$q.all(a).then(function(e){return _.every(e,function(e){return e})||n.logger.warn("ContexteClientService","setContexteClientData","La mise à jour du contexte client est partielle",e),i})})},n.prototype.consolidationContexteClient=function(e,i,n){var r=this;n||(n={infosTiers:!0,eds:!0});var o={};return i.codePersonnaliteJuridique||(o.identificationV1=this.tiersService.getIdentification(i.identifiantPersonne)),this.consoliderInfosIdentification(i,o).then(function(){n.eds&&!i.idEdsOrigineClient&&(o.portefeuille=r.tiersService.getPortefeuille(i.identifiantPersonne)),(n.eds&&!i.idEdsOrigineClient||n.infosTiers&&!i.designationCourte)&&(i.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE?o.infosTiers=r.tiersService.getParticulierInformation(i.identifiantPersonne):i.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_MORALE&&(o.infosTiers=r.tiersService.getCorporateInformation(i.identifiantPersonne)));var a=[];return n.infosTiers&&a.push(r.consoliderInfosTiers(i,o)),n.eds&&a.push(r.consoliderEDS(i,o)),r.$q.all(a).then(function(){return r.setContexteClientData(e,i)})})},n.prototype.setClient=function(e){for(var i=this,n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];var o=t.EdsUtils.getIdentifiantPersonne(e);return this.logger.info("ContexteClientService","setClient",o,n),this.contexteClientService.getIdClient().then(function(e){return o===e?i.$q.when():i.contexteClientService.setIdClient(o)}).then(function(){var e;return 1===n.length?e=n[0]:n.length>1&&(e=i.getDesignationClient(n[0],n[1],n[2],n[3])),e?(i.logger.info("ContexteClientService","setClient","ChangeMainProcessName",e),i.agentService.changeMainProcessName(e)):void 0})["catch"](function(e){throw i.logger.error("ContexteClientService","setClient",e),e})},n.prototype.isClientDefined=function(e){var i=t.EdsUtils.getIdentifiantPersonne(e);return this.contexteClientService.getIdClient().then(function(e){return i===e})["catch"](function(){return!1})},n.prototype.getDesignationClient=function(t,i,n,r){return e.core.ClientUtils.getDesignation(t,i,n,r)},n.prototype.getContexteClientData=function(i){var n=this;if(!i)return this.$q.reject(new e.core.ErreurMyway("contextId non renseigné",5));var r;return this.agentService.getTypePortail().then(function(e){return r=e,n.$q.all([n.contexteClientService.getContextById(i),n.contexteClientService.getIdClientFromContext(i)])}).then(function(e){var o=e[0],a=e[1],s=new t.ContexteClientData(i,parseInt(a,10)),c=1===r?t.CONTEXTE_CLIENT_MYWAY_PATHS:t.CONTEXTE_CLIENT_PCM_PATHS;s.indicateurChargement=n.extractBooleanFromPath(c.indicateurChargement,o),s.nomCommercial=n.extractStringFromPath(c.nomCommercial,o),s.raisonSociale=n.extractStringFromPath(c.raisonSociale,o),s.designationCourte=n.extractStringFromPath(c.designationCourte,o),s.designationCourte||(s.designationCourte=s.raisonSociale),s.codeAppartenanceReseau=n.extractStringFromPath(c.codeAppartenanceReseau,o),s.numeroSIREN=n.extractStringFromPath(c.numeroSiren,o),s.codeCivilite=n.extractStringFromPath(c.codeCivilite,o),s.nomUsage=n.extractStringFromPath(c.nomUsage,o),s.nomFamille=n.extractStringFromPath(c.nomFamille,o),s.prenom=n.extractStringFromPath(c.prenom,o),s.codeCapaciteJuridique=n.extractStringFromPath(c.codeCapaciteJuridique,o),s.codeCategorieSocioProf=n.extractStringFromPath(c.codeCategorieSocioProf,o),s.codePersonnaliteJuridique=n.extractStringFromPath(c.codePersonnaliteJuridique,o)||t.CodesPersonnaliteJuridique.INCONNU,s.idEdsOrigineClient=t.NumberUtils.parseInt(n.extractStringFromPath(c.idEdsOrigineClient,o)),s.codeAgentSuiviPar=t.NumberUtils.parseInt(n.extractStringFromPath(c.codeAgentSuiviPar,o)),s.idEdsInterneSuiviPar=t.NumberUtils.parseInt(n.extractStringFromPath(c.idEdsInterneSuiviPar,o)),s.dateDeces=n.extractStringFromPath(c.dateDeces,o),s.indicateurActiviteProfessionnel="1"===n.extractStringFromPath(c.indicExistenceProfessionnel,o),s.codeMarche=n.extractStringFromPath(c.codeMarche,o);var l="1"===n.extractStringFromPath(c.codeClientTiers,o),u="1"===n.extractStringFromPath(c.codeProspect,o);return s.codeTypeRelation=u?t.CodesTypeRelation.PROSPECT:l?t.CodesTypeRelation.TIERS:t.CodesTypeRelation.CLIENT,s})},n.prototype.getAllClients=function(){var e=this;return this.contexteClientService.getAllIdContextes().then(function(t){return e.$q.all(_.map(t,function(t){return e.getContexteClientData(t)})).then(function(e){return e.filter(function(e){return!!e.identifiantPersonne})})})},n.prototype.getIndicateurSynchroSynthese=function(){return this.contexteClientService.getProperty(t.CONTEXTE_CLIENT_MYWAY_PATHS.indicateurSynchroSynthese).then(function(e){return parseInt(e,10)})},n.prototype.setIndicateurSynchroSynthese=function(e){return this.contexteClientService.setProperty(t.CONTEXTE_CLIENT_MYWAY_PATHS.indicateurSynchroSynthese,e+"")},n.prototype.getIndicateurChargement=function(){return this.contexteClientService.getProperty(t.CONTEXTE_CLIENT_MYWAY_PATHS.indicateurChargement)},n.prototype.setIndicateurChargement=function(e){return this.contexteClientService.setProperty(t.CONTEXTE_CLIENT_MYWAY_PATHS.indicateurChargement,e)},n.prototype.setIndicateurSyntheseClient=function(e){return this.contexteClientService.setProperty(t.CONTEXTE_CLIENT_MYWAY_PATHS.indicateurSyntheseClient,e)},n.prototype.logInfosContextes=function(){var e=this;this.contexteClientService.getAllIdContextes().then(function(t){var i=_.map(t,function(t){return e.contexteClientService.getContextById(t)});return e.$q.all(i)}).then(function(e){console.log("========================================="),console.log("Infos contextes clients"),e.forEach(function(e){console.log(e)})})},n.prototype.consoliderInfosIdentification=function(e,t){var i=this;return e.codePersonnaliteJuridique?this.$q.when():t.identificationV1.then(function(t){e.codePersonnaliteJuridique=t.codePersonnaliteJuridique,e.codeTypeRelation=t.codeTypeRelation;var i="";i=t.codeMarche.codeTypeSegmentation,null!=t.codeMarche.codeSegmentationConfirmee?i+=String(t.codeMarche.codeSegmentationConfirmee).substr(0,1):null!=t.codeMarche.codeSegmentationCalculee&&(i+=String(t.codeMarche.codeSegmentationCalculee).substr(0,1)),e.codeMarche=i})["catch"](function(t){i.logger.error("ContexteClientService","consoliderInfosIdentification",e.identifiantPersonne,t)})},n.prototype.consoliderInfosTiers=function(e,i){var n,r=this;return e.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE?n=!!e.designationCourte&&!!e.codeCivilite:e.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_MORALE&&(n=!!(e.designationCourte&&e.raisonSociale&&e.numeroSIREN&&e.codeMarche)),n||!i.infosTiers?this.$q.when():i.infosTiers.then(function(i){e.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE?(e.designationCourte=i.designationCourte,e.codeCivilite=i.codeCivilite,e.codeCategorieSocioProf=i.categorieSocioprofessionnelle,e.codeAppartenanceReseau=i.codeAppartenanceReseau,e.indicateurActiviteProfessionnel="O"===i.indicateurActiviteProfessionnel,e.dateDeces=i.dateDeces,e.codeCapaciteJuridique=i.codeCapaciteJuridique):e.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_MORALE&&(e.raisonSociale=i.raisonSociale,e.designationCourte=i.designationCourte||i.raisonSociale,e.numeroSIREN=i.numeroSiren,e.codeAppartenanceReseau=i.codeAppartenanceReseau,e.nomCommercial=i.nomCommercial)})["catch"](function(t){r.logger.error("ContexteClientService","consoliderInfosTiers",e.identifiantPersonne,t)})},n.prototype.consoliderEDS=function(e,i){var n=this;return e.idEdsOrigineClient?this.$q.when():i.portefeuille.then(function(r){return"H"===r.portefeuilleRattachement.codeTypePortefeuille?e.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.INCONNU?n.$q.when():i.infosTiers.then(function(i){var r=e.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE?i.edsDomiciliation:i.referenceExterneEDS;return n.edsService.getCaracteristiqueAgence({referenceExterneEDS:r}).then(function(t){e.idEdsOrigineClient=t.infoEDS.identifiantInterneEDS})}):(e.idEdsInterneSuiviPar=r.portefeuilleRattachement.identifiantElementStructureSuiviPortefeuille,void(e.idEdsOrigineClient=r.portefeuilleRattachement.identifiantElementStructurePortefeuille))})["catch"](function(t){n.logger.error("ContexteClientService","consoliderEDS",e.identifiantPersonne,t)})},n.prototype.extractStringFromPath=function(e,t){return e?this.$parse(e)(t):null},n.prototype.extractBooleanFromPath=function(e,t){return e?this.$parse(e)(t):void 0},n.$inject=["$injector","$q","$parse",e.core.ServiceNames.Logger,e.core.ServiceNames.Agent,e.core.ServiceNames.ContexteClient,t.ServiceNames.Tiers,t.ServiceNames.Eds],n}(e.core.FrameworkService);t.ContexteClientService=i,t.app.service(t.ServiceNames.ContexteClient,i)}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.event||(e.event={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.getManagerEventTypeName=function(e){var t;switch(e){case MyWay.Services.Component.ManagerEventType.PortalContextChanged:t="PortalContextChanged";break;case MyWay.Services.Component.ManagerEventType.FinDeTransition:t="FinDeTransition";break;case MyWay.Services.Component.ManagerEventType.FinDeProcessus:t="FinDeProcessus";break;case MyWay.Services.Component.ManagerEventType.NouvelleEtape:t="NouvelleEtape";break;case MyWay.Services.Component.ManagerEventType.NouveauProcess:t="NouveauProcess";break;case MyWay.Services.Component.ManagerEventType.NouveauSousProcess:t="NouveauSousProcess";break;case MyWay.Services.Component.ManagerEventType.NouvelleAppliExterne:t="NouvelleAppliExterne";break;case MyWay.Services.Component.ManagerEventType.BasculeProcess:t="BasculeProcess";break;case MyWay.Services.Component.ManagerEventType.ChangementNomProcess:t="ChangementNomProcess";break;case MyWay.Services.Component.ManagerEventType.DemandeDeDemarrageDeProcessus:t="DemandeDeDemarrageDeProcessus";break;case MyWay.Services.Component.ManagerEventType.AcceptPhase:t="AcceptPhase";break;case MyWay.Services.Component.ManagerEventType.ConnectionSignalR:t="ConnectionSignalR";break;case MyWay.Services.Component.ManagerEventType.AfficherLogOn:t="AfficherLogOn";break;case MyWay.Services.Component.ManagerEventType.MasquerLogOn:t="MasquerLogOn";break;case MyWay.Services.Component.ManagerEventType.Extraction:t="Extraction";break;case MyWay.Services.Component.ManagerEventType.Diagnostic:t="Diagnostic";break;case MyWay.Services.Component.ManagerEventType.MiseAJourContexteClient:t="MiseAJourContexteClient";break;case MyWay.Services.Component.ManagerEventType.Log:t="Log";break;case MyWay.Services.Component.ManagerEventType.ChangementAuthentificationInfo:t="ChangementAuthentificationInfo";break;case MyWay.Services.Component.ManagerEventType.BriqueCommunication:t="BriqueCommunication";break;case MyWay.Services.Component.ManagerEventType.ContextRecharge:t="ContextRecharge";break;case MyWay.Services.Component.ManagerEventType.ResetHabilitations:t="ResetHabilitations";break;default:t=""}return t},e}();e.EventUtils=t}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.guichet||(e.guichet={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function i(e,t,i,n){this.$q=e,this.agentService=t,this.authentificationService=i,this.logger=n}return i.prototype.getCodesGuichets=function(){var t,i=this;return this.agentService.getAuthentificationInfo().then(function(e){return t=e,i.agentService.getDonneesDelocalisees("CU3E")}).then(function(e){return _.reduce(e.donnees,function(e,i){return i.COCXBQ===t.codeEtablissement&&e.push(i.COCXGU),e},[])})["catch"](function(t){return i.$q.reject(new e.core.ErreurMyway("Erreur lors de la récupération des guichets.",t))})},i.prototype.tryOpenGuichet=function(t){var i,n,r,o=this;return this.agentService.getAuthentificationInfo().then(function(e){return i=e,o.getPreferencesGuichet()}).then(function(e){if(r=e,n=_.find(t,function(e){return e.identifiantPosteFonctionnel===r.idPosteFonctionnel}),!n)throw"poste fonctionnel non enregistre ou non trouve";return o.authentificationService.rechargerHabilitations(n)}).then(function(){return o.ouvrirGuichet(i.codeEtablissement,n,r)})["catch"](function(t){throw new e.core.ErreurMyway("Erreur lors de l'ouverture automatique du guichet",t)})},i.prototype.ouvrirGuichet=function(e,i,n){var r=this;return this.getControleDebutJournee(e,i.typeFonction,i.referencePosteFonctionnel,n.coordonneeGuichet.referenceExterne,i.informationRattachement.identifiantEDSRattachement).then(function(e){var i={codeGuichetInterbancaire:_.padLeft(n.guichetInterbancaire,5,"0"),edsInterneGuichetComptable:t.EdsUtils.getIdentifiantEDS(e.coordonneeGuichet.identifiantInterneGuichet),edsExterneGuichetComptable:t.EdsUtils.getIdentifiantEDS(e.coordonneeGuichet.referenceExterneGuichet),edsTypeGuichetComptable:"020",edsInterneRattachementGuichetComptable:t.EdsUtils.getIdentifiantEDS(e.coordonneeGuichet.identifiantEDSRattGuichet),edsExterneRattachementGuichetComptable:t.EdsUtils.getIdentifiantEDS(e.coordonneeGuichet.referenceEDSRattGuichet),edsTypeRattachementGuichetComptable:t.EdsUtils.getTypeEDS(e.coordonneeGuichet.typeEDSRattGuichet),dateOperationJourneeComptable:moment().format("DDMMYYYY"),typeCA:"",libelleEdsRattachementGuichetComptable:e.adresseGuichet.libelleEDSRattGuichet,numTelEdsRattachementGuichetComptable:e.adresseGuichet.telephoneEDSRattGuichet};return r.logger.trace("ouvrirGuichet",i),r.$q.all([r.agentService.setParametresComptables(i),r.setPreferencesGuichet(n,e)])})},i.prototype.getPreferencesGuichet=function(){var t=this;return this.getKeyPreferencesBureauGuichet().then(function(e){return t.logger.trace("getPreferencesGuichet",e),t.agentService.lirePreference(e)}).then(function(t){if(!t)throw new e.core.ErreurMyway("Pas de préférences utilisateur !",1);var i=JSON.parse(t);if(null==i.coordonneeGuichet||null==i.coordonneeGuichet.referenceExterne)throw new e.core.ErreurMyway("Pas de préférences utilisateur !",1);return i})},i.prototype.setPreferencesGuichet=function(t,i){var n=this;return this.getKeyPreferencesBureauGuichet().then(function(e){return null!=i&&(t.idEdsRattachement=i.coordonneeGuichet.identifiantEDSRattGuichet,t.libelleEdsRattachement=i.adresseGuichet.libelleEDSRattGuichet),n.logger.trace("setPreferencesGuichet","clé:",e,"valeur:",t),n.agentService.ecrirePreference(e,JSON.stringify(t))}).then(function(){n.logger.trace("préférences guichet mémorisée !")})["catch"](function(t){return n.logger.error("erreur lors de la mémorisation des préférences guichet !",t),n.$q.reject(new e.core.ErreurMyway("Erreur lors de la mémorisation du guichet.",t))})},i.prototype.getControleDebutJournee=function(t,i,n,r,o){var a=this,s={codeEtablissement:t,typeFonctionPF:i,identifiantInternePF:n,referenceExterneGuichet:r,identifiantInterneEDSRattPF:o};return this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/encaisseagenceservice/v1/ctrlDebutJournee",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:s})["catch"](function(t){return a.$q.reject(new e.core.ErreurMyway("Erreur lors du contrôle de début de journée.",t))})},i.prototype.getKeyPreferencesBureauGuichet=function(){var e=this;return this.agentService.getAuthentificationInfo().then(function(t){return e.logger.trace("getKeyPreferencesBureauGuichet",t.codeEtablissement),["guichet",t.codeEtablissement].join("/")})},i.$inject=["$q",e.core.ServiceNames.Agent,t.ServiceNames.Authentification,e.core.ServiceNames.Logger],i}();i.GuichetService=n,t.app.service(t.ServiceNames.Guichet,n)}(i=t.guichet||(t.guichet={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){function e(e){this.$modalInstance=e}return e.$inject=["$modalInstance"],e}();e.app.controller("hintModaleController",i)}(t=e.hint||(e.hint={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";!function(e){e[e.STORE_DRAG_DROP=0]="STORE_DRAG_DROP"}(e.HintKeyEnum||(e.HintKeyEnum={}));var t=e.HintKeyEnum;e.HINTS=[{key:t.STORE_DRAG_DROP,text:"Vous pouvez utiliser le glisser-déposer pour ajouter ou déplacer des favoris"}]}(t=e.hint||(e.hint={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function t(e,t,i,n,r){this.$q=e,this.notificationService=t,this.modalService=i,this.agentService=n,this.logger=r}return t.prototype.show=function(e){var t=_.find(i.HINTS,function(t){return t.key===e});t||this.logger.warn("astuce non définie: ",e),t.viewed||(this.notificationService.showNotification(t.text,"information"),t.viewed=!0)},t.prototype.showModaleStoreFavori=function(){return this.modalService.showModal({templateUrl:"typescript/hint/modale-store-favori/hint-store.html",controller:"hintModaleController",controllerAs:"ctrl",windowClass:"app-modal-window-MEG",backdrop:"true",keyboard:!0,size:"lg"})},t.prototype.showModaleStoreCatalogue=function(){return this.modalService.showModal({templateUrl:"typescript/hint/modale-store-catalogue/hint-store.html",controller:"hintModaleController",controllerAs:"ctrl",windowClass:"app-modal-window-MEG",backdrop:"true",keyboard:!0,size:"lg"})},t.$inject=["$q","MwNotificationService","modalService",e.core.ServiceNames.Agent,e.core.ServiceNames.Logger],t}();i.HintService=n,t.app.service(t.ServiceNames.Hint,n)}(i=t.hint||(t.hint={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.lien||(e.lien={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function n(e,t,i,n,r,o){this.$q=e,this.$filter=t,this.modalService=i,this.logger=n,this.lienInstance=r,this.favoriPersoService=o}return n.prototype.getList=function(){return this.lienInstance.getList()},n.prototype.getLiens=function(){return this.getList().then(function(e){return e.items})},n.prototype.write=function(){return this.lienInstance.write()},n.prototype.editerLien=function(e){return this.modalService.showModal({templateUrl:"typescript/lien/modale-edition/editer-lien.html",controller:i.ModaleEditerLienControleur,controllerAs:"ctrl",windowClass:"app-modal-window-MEG",backdrop:!0,keyboard:!0,size:"lg",resolve:{lien:function(){return e}}})},n.$inject=["$q","$filter","modalService",e.core.ServiceNames.Logger,t.ServiceNames.LienV1,t.ServiceNames.FavoriPerso],n}();i.LienService=n,t.app.service(t.ServiceNames.Lien,n)}(i=t.lien||(t.lien={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,i){void 0===i&&(i=!1),this.key=e,this._value=t,this.variable=i}return Object.defineProperty(e.prototype,"value",{get:function(){return this._value},set:function(e){this._value=e,this.format&&null!=e&&this.formatValue(e),this.variable=!1},enumerable:!0,configurable:!0}),e.prototype.formatValue=function(e){var t=this.format.match(/([S])(\d+)/);null!=t&&this.formatString(e+"",+t[2])},e.prototype.formatString=function(e,t){this._value=_.padLeft(+e+"",t,"0")},e}();e.ContexteLisaKeyValue=t;var i=function(){function i(e){var t=this;this.contexte=e,this.contexte=this.contexte||{};var i=this.getOrderedKeys();this.keyValues=[],i.forEach(function(e){t.keyValues.push(t.getKeyValue(e))})}return Object.defineProperty(i.prototype,"identifiantPersonne",{get:function(){return this.getValue(e.ScopeLisa.IDENTIFIANT_PERSONNE)},enumerable:!0,configurable:!0}),i.prototype.isUndefined=function(e){var t=this.get(e);return!!t&&(t.variable||!t.value)},i.prototype.get=function(e){return _.find(this.keyValues,function(t){return t.key===e})},i.prototype.getValue=function(e){var t=this.get(e);return t?t.value:void 0},i.prototype.set=function(e,t){var i=this.get(e);i.value=t},i.prototype.getKeyValue=function(e){var i=this.contexte[e];if("string"==typeof i&&-1!==i.indexOf("{{"))return this.getKeyValueFromVariable(e);var n=new t(e,i);return n},i.prototype.getKeyValueFromVariable=function(e){var i=this.contexte[e];if("string"==typeof i){var n=i.match(/\{\{([^[]+)(\[([^\]]*)\])?\}\}/);if(null==n)throw"getKeyValueFromVariable, invalid value: "+i;var r=new t(e,n[1],!0);return 4===n.length&&(r.format=n[3]),r}},i.prototype.getOrderedKeys=function(){var t=Object.keys(this.contexte);return t.sort(function(t,i){return t===e.ScopeLisa.IDENTIFIANT_PERSONNE?-1:i===e.ScopeLisa.IDENTIFIANT_PERSONNE?1:t===e.ScopeLisa.IDENTIFIANT_ENTITE_TITULAIRE?-1:i===e.ScopeLisa.IDENTIFIANT_ENTITE_TITULAIRE?1:0}),t},i}();e.ContexteLisa=i}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){function i(e,t,i,n,r,o,a){this.$q=e,this.$parse=t,this.$interpolate=i,this.logger=n,this.agentService=r,this.tokenService=o,this.entiteTitulaireService=a}return i.prototype.getParamLisaFromString=function(e){var i=new t.ParamLisa;if(!e||e.length<2)return i;var n=JSON.parse(e.replace(/\\"/g,'"').slice(1,-1));return"object"==typeof n&&(i.idClient=n.idClient,i.processusAOuvrirDansUneNouvelleInstance=n.processusAOuvrirDansUneNouvelleInstance,_.forEach(n.context,function(e,t){i.addParam(t,e)})),i},i.prototype.getConfigLisa=function(t,i){var n=this;return this.agentService.sendRequest({url:"http://myway-dua.sigcesie.caisse-epargne.fr:6080/version2/lisa/v2/start/"+t,method:MyWay.Services.MethodEnum.GET,withHeaders:!1}).then(function(e){return n.logger.trace("getConfigLisa",e),e})["catch"](function(t){return n.$q.reject(new e.core.ErreurMyway("getConfigLisa",t))})},i.prototype.getScope=function(e){return e||(e={}),this.$q.all([this.agentService.getAuthentificationInfo().then(function(t){return e.auth=e.auth||t}),this.agentService.getParametresComptables().then(function(t){return e.guichet=e.guichet||t})]).then(function(){return e})},i.prototype.getFromObject=function(e,i){var n=this,r=this.$q.when(),o=new t.ContexteLisa(e);return o.keyValues.forEach(function(e){"string"==typeof e.value&&(r=r.then(function(){return n.tokenService.replaceEnvironmentTokens(e.value)}).then(function(t){e.value!==t&&(e.value=t)})),r=r.then(function(){return n.linkValue(e,i),e.key!==t.ScopeLisa.IDENTIFIANT_PERSONNE||e.value?e.key!==t.ScopeLisa.IDENTIFIANT_ENTITE_TITULAIRE||e.value?void 0:n.getEntiteTitulaire(o):n.getIdentifiantPersonne(o)})}),r.then(function(){var e=_.reduce(o.keyValues,function(e,t){return e.addParam(t.key,t.value),e},new t.ParamLisa);return e})},i.prototype.getIdentifiantPersonne=function(e){return this.$q.reject("pas d'identifiantPersonne fourni !")},i.prototype.getEntiteTitulaire=function(e){return e.identifiantPersonne?this.entiteTitulaireService.selectEntiteTitulaire(e.identifiantPersonne,e.isUndefined(t.ScopeLisa.NUMERO_CHRONO_PROFESSIONNEL)).then(function(i){e.set(t.ScopeLisa.IDENTIFIANT_ENTITE_TITULAIRE,i.identifiantEntiteTitulaire),e.isUndefined(t.ScopeLisa.NUMERO_CHRONO_PROFESSIONNEL)&&e.set(t.ScopeLisa.NUMERO_CHRONO_PROFESSIONNEL,i.identifiantProfessionnel)}):this.$q.reject("pas d'identifiant personne trouvé !")},i.prototype.linkValue=function(e,i){if(e.variable){var n=e.value;n===t.ScopeLisa.IDENTIFIANT_PERSONNE?e.value=t.EdsUtils.getIdentifiantPersonne(i.identifiantPersonne):n===t.ScopeLisa.LIBELLE_PERSONNE?e.value=i.libellePersonne:n===t.ScopeLisa.DATE_JOUR?e.value=moment().format(e.format||"DDMMYYYY"):_.startsWith(n,t.ScopeLisa.AUTHENTIFICATION_INFOS)||_.startsWith(n,t.ScopeLisa.PARAMETRES_COMPTABLES)?e.value=this.$interpolate("{{"+n+"}}")(i):e.value=void 0}},i.$inject=["$q","$parse","$interpolate",e.core.ServiceNames.Logger,e.core.ServiceNames.Agent,t.ServiceNames.Token,t.ServiceNames.EntiteTitulaire],i}();t.ContexteLisaService=i,t.app.service(t.ServiceNames.ContexteLisa,i)}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.normalize=function(t){return _.forEach(t,function(t){t.Key===e.ScopeLisa.IDENTIFIANT_PERSONNE&&(t.Value=e.EdsUtils.getIdentifiantPersonne(t.Value))}),t},t}();e.ContexteLisaUtils=t}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.IDENTIFIANT_PERSONNE="identifiantPersonne",e.IDENTIFIANT_ENTITE_TITULAIRE="identifiantEntiteTitulaire",e.NUMERO_CHRONO_PROFESSIONNEL="numeroChronoProfessionnel",e.LIBELLE_PERSONNE="libellePersonne",e.AUTHENTIFICATION_INFOS="auth.",e.PARAMETRES_COMPTABLES="guichet.",e.DATE_JOUR="dateJour",e.PRODUIT="produit",e}();e.ScopeLisa=t}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){var t=this;this.contextArray=[],this.displayName="",this.idClient="",this.processusAOuvrirDansUneNouvelleInstance=!1,this.subProcessCode="",e&&_.forEach(e,function(e,i){t.addParam(i,e)})}return e.prototype.addParam=function(e,t){var i=_.find(this.contextArray,function(t){return t.Key===e});i?i.Value=t:this.contextArray.push({Key:e,Value:t})},e.prototype.getParam=function(e){return _.find(this.contextArray,function(t){return t.Key===e})},e}();e.ParamLisa=t}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t;!function(e){e.$q="$q",e.$http="$http"}(t=e.Angular||(e.Angular={}));var i;!function(e){e.modalService="modalService"}(i=e.MyWay||(e.MyWay={}));var n;!function(e){e.personneService="myway.portail.api.Media.PersonneService",e.mediaService="myway.portail.api.Media.MediaService",e.agentService="agentService-core",e.boiteOutilService="myway.portail.api.Media.BoiteOutilService",e.telephoneService="myway.portail.api.Media.TelephoneService"}(n=e.Services||(e.Services={}));var r;!function(e){e.urlTiersMedia="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v3/media/",e.urlETAdresse="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v3/adresse/",e.urlServiceTelephonie="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/boiteoutil/v1/urlServiceTelephonie"}(r=e.UrlRest||(e.UrlRest={}));var o;!function(e){e.ctrlTemplateUrl="typescript/media/media.html",e.ctrlName="MediaControleur",e.ctrlAs="ctrlMedia"}(o=e.Controleur||(e.Controleur={}));var a;!function(e){e.codeDistributionNPAI="1"}(a=e.Medias||(e.Medias={}))}(t=e.Constantes||(e.Constantes={}))}(t=e.Media||(e.Media={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,i){this.indicateurPreference=e,this.libelleTypeMedia=t,this.libelleTypeUsageMedia=i}return Object.defineProperty(e.prototype,"libelle",{get:function(){return this.libelleTypeMedia+" ("+this.libelleTypeUsageMedia+")"},enumerable:!0,configurable:!0}),e}();e.Media=t;var i=function(e){function t(t,i,n,r,o){e.call(this,t,i,n),this.isMobile=o,this.numero=r}return __extends(t,e),t}(t);e.Telephone=i;var n=function(e){function t(t,i,n,r){e.call(this,t,i,n),this.mail=r}return __extends(t,e),t}(t);e.Mail=n;var r=function(){function e(){}return e}();e.IAdresse=r}(t=e.Modeles||(e.Modeles={}))}(t=e.Media||(e.Media={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){function e(e,i,n,r,o,a,s){var c=this;this.telephoneService=e,this.mwNotificationService=i,this.$modalInstance=n,this.medias=r,this.identifiantPersonne=o,this.adresse=s,this.title="Moyens de contact",a&&(this.title+=" de "+a),this.telephones=[],this.mails=[],_.forEach(this.medias,function(e){e instanceof t.Modeles.Telephone?c.telephones.push(e):e instanceof t.Modeles.Mail&&c.mails.push(e)})}return e.prototype.composerAppel=function(e){var t=this,i=new RegExp("[^0-9]","gi"),n=e.numero;n=n.replace(i,""),this.telephoneService.composerAppel(n).then(function(){t.mwNotificationService.showNotification("Appel actif")})["catch"](function(e){var i="Erreur technique lors de l'appel: "+JSON.stringify(e);t.mwNotificationService.showNotification(i,"information")})},e.prototype.closeModale=function(){this.$modalInstance.close()},e.$inject=[t.Constantes.Services.telephoneService,"MwNotificationService","$modalInstance","medias","identifiantPersonne","libellePersonne","adresse"],e}();t.MediaControleur=i,e.app.controller(t.Constantes.Controleur.ctrlName,i)}(t=e.Media||(e.Media={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){function e(e,t,i){this.modalService=e,this.personneRestService=t,this.agentService=i}return e.prototype.ouvrirModaleMedias=function(e,i){var n=this;return this.modalService.showModal({templateUrl:t.Constantes.Controleur.ctrlTemplateUrl,controller:t.Constantes.Controleur.ctrlName,controllerAs:t.Constantes.Controleur.ctrlAs,windowClass:"app-modal-window-MEG",backdrop:"true",keyboard:!0,size:"lg",resolve:{identifiantPersonne:function(){return e},libellePersonne:function(){return i},medias:function(){return n.getMedias(e)},adresse:function(){return n.getAdressePostale(e)}}})},e.prototype.getMedias=function(e){var i=this;return this.agentService.getAuthentificationInfo().then(function(n){return i.personneRestService.getMedia(n.codeEtablissement,e).then(function(e){var i=[];return _.forEach(e.listeMedia,function(e){switch(e.codeTypeMedia){case"01":i.push(new t.Modeles.Telephone(e.indicateurPreferenceMedia,e.libelleTypeMedia,e.libelleTypeUsageMedia,e.referenceAccesMedia,!1));break;case"02":i.push(new t.Modeles.Telephone(e.indicateurPreferenceMedia,e.libelleTypeMedia,e.libelleTypeUsageMedia,e.referenceAccesMedia,!0));break;case"03":i.push(new t.Modeles.Mail(e.indicateurPreferenceMedia,e.libelleTypeMedia,e.libelleTypeUsageMedia,e.referenceAccesMedia));
}}),i})})},e.prototype.getAdressePostale=function(e){var i=this;return this.agentService.getAuthentificationInfo().then(function(n){return i.personneRestService.getAdressePostale(n.codeEtablissement,e).then(function(e){var i=_.first(e);return i?{ligne1adresseAfnor:i.ligne1AdresseAFNOR||null,ligne2adresseAfnor:i.ligne2AdresseAFNOR||null,ligne3adresseAfnor:i.ligne3AdresseAFNOR||null,ligne4adresseAfnor:i.ligne4AdresseAFNOR||null,ligne5adresseAfnor:i.ligne5AdresseAFNOR||null,ligne6adresseAfnor:i.ligne6AdresseAFNOR||null,npai:i.codeRetourDistribution===t.Constantes.Medias.codeDistributionNPAI}:null})})},e.$inject=[t.Constantes.MyWay.modalService,t.Constantes.Services.personneService,t.Constantes.Services.agentService],e}();t.MediaService=i,e.app.service(t.Constantes.Services.mediaService,i)}(t=e.Media||(e.Media={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){function e(e,t,i,n){this.$q=e,this.agentService=t,this.boiteOutilService=i,this.$http=n}return e.prototype.composerAppel=function(e){var t=this;return this.getUrlTelephonie().then(function(i){return t.call(i.url,e)}).then(function(e){var t=e.match("CTC\\d{2}");if(!t)throw new Error(e)})},e.prototype.call=function(e,t){var i=this;return this.$http.get(e,{params:{dest:t},withCredentials:!0}).then(function(e){return e.data},function(e){return 0===e.status?i.$q.reject("Erreur http (timeout, crossdomain, ou dns)"):i.$q.reject(e.data)})},e.prototype.getUrlTelephonie=function(){var e=this;return this.agentService.getAuthentificationInfo().then(function(t){return e.boiteOutilService.getUrlServiceTelephonie(t.codeEtablissement)})},e.$inject=[t.Constantes.Angular.$q,t.Constantes.Services.agentService,t.Constantes.Services.boiteOutilService,t.Constantes.Angular.$http],e}();t.TelephoneService=i,e.app.service(t.Constantes.Services.telephoneService,i)}(t=e.Media||(e.Media={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";e.DOMAINE="http://myway-dua.sigcesie.caisse-epargne.fr:6080/version2";var t=function(){function e(){}return e.START_URL="startUrl",e.START_URL_WITH_PARAMS="startUrlWithParams",e.START_PROCESS="startProcess",e.STOP_CURRENT_PROCESS="stopCurrentProcess",e.START_APPLICATION="startApplication",e.START_STORE="startStore",e.SWITCH_PROCESS="switchProcess",e.START_SYNTHESE_CLIENT="startSyntheseClient",e.START_CONNAISSANCE_CLIENT_PART="startConnaissanceClientPart",e.START_CONNAISSANCE_CLIENT_PRO="startConnaissanceClientPro",e.APPLICATION_CONTEXT="applicationContext",e.USER_PREFERENCES="userPreferences",e.RELOAD_APPLICATION_CONTEXT="reloadApplicationContext",e.RESET_FAVORIS_APPLICATION="resetFavorisApplication",e.CHECK_PRECONISATIONS_ETABLISSEMENTS="checkPreconisationsEtablissements",e.IS_VUE_CLIENT="isVueClient",e.SET_VUE_CLIENT="setVueClient",e.CHANGEMENT_VUE="changementVue",e.WRITE_FAVORIS="writeFavoris",e.WRITE_LIENS="writeLiens",e.TOGGLE_TOTEM_PORTAIL="toggleTotemPortail",e.TOGGLE_LOADER="toggleLoader",e.TOGGLE_LOCK_PORTAIL="toggleLockPortail",e.TERMINER_DEBUT_JOURNEE="terminerDebutJournee",e}();e.MessageNames=t}(t=e.message||(e.message={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.message||(e.message={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function t(e,t,i,n,r,o,a){this.$q=e,this.$window=t,this.$rootScope=i,this.agentService=n,this.erreurService=r,this.loaderService=o,this.logger=a,this.init()}return Object.defineProperty(t.prototype,"sharedContext",{get:function(){return parent.myway.portail.sharedContext},enumerable:!0,configurable:!0}),t.prototype.subscribeRequest=function(e){this.subscribes.push({eventName:e.eventName,request:e.request})},t.prototype.sendRequestToIFrames=function(e){var t=this;this.sendRequest({eventName:e.eventName,params:e.params,source:window}),_.forEach(frames,function(i){try{"about:blank"!==i.location.href&&(t.sendRequest({eventName:e.eventName,params:e.params,source:i}),t.logger.trace("message sent to iframe",i.location))}catch(n){t.logger.error(n)}})},t.prototype.sendRequest=function(e){try{e.source=e.source||parent;var t={type:0,event:e.eventName,params:e.params};e.source.postMessage(t,i.DOMAINE)}catch(n){this.logger.error(n)}},t.prototype.sendRequestWithResponse=function(t){try{var n={type:0,event:t.eventName,uuid:e.core.Utils.generateUUID(),params:t.params},r=this.$q.defer();return this.responseDeferred[n.uuid]=r,parent.postMessage(n,i.DOMAINE),r.promise}catch(o){return this.logger.error(o),this.$q.reject(o)}},t.prototype.sendResponse=function(e,t,i){try{this.sharedContext.addValue(t.data.uuid,i);var n={type:1,event:e,uuid:t.data.uuid};t.source.postMessage(n,t.origin)}catch(r){this.logger.error(r)}},t.prototype.init=function(){var e=this;this.subscribes=[],this.responseDeferred={},this.$window.addEventListener("message",function(t){var i=t.data;("http://myway-dua.sigcesie.caisse-epargne.fr:6080"===t.origin||_.startsWith(t.origin,"http://localhost:"))&&i&&null!=i.event&&e.onMessageEvent(t,i)})},t.prototype.onMessageEvent=function(e,t){var i=this;1===t.type&&this.responseDeferred[t.uuid]?this.$rootScope.$apply(function(){return i.responseDeferred[t.uuid].resolve(i.sharedContext.getValue(t.uuid))}):0===t.type&&this.subscribes.forEach(function(n){t.event===n.eventName&&i.$rootScope.$apply(function(){var r=function(t){return i.sendResponse(n.eventName,e,t)};n.request({answer:r,params:t.params,event:e})})})},t.$inject=["$q","$window","$rootScope",e.core.ServiceNames.Agent,e.core.ServiceNames.Erreur,e.core.ServiceNames.Loader,e.core.ServiceNames.Logger],t}();i.MessageService=n,t.app.service(t.ServiceNames.Message,n)}(i=t.message||(t.message={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){this.values={}}return e.prototype.getValue=function(e){var t=this.values[e];return delete this.values[e],t},e.prototype.addValue=function(e,t){this.values[e]=t},e}();e.SharedContext=t}(t=e.message||(e.message={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,i){this.codeVisibiliteApplication=i,null==t&&(t=""),this.resolutionMinimaleMyway="O"===this.extractValue(t,"R","N"),this.ecranTactile="O"===this.extractValue(t,"T","N");var n=this.extractValue(t,"P",this.getCodesPlateformes(e.ApplicationList.PLATEFORMES));this.plateformes=_.map(e.ApplicationList.PLATEFORMES,function(e){var t={id:e.id,code:e.code,libelle:e.libelle,selected:-1!==n.indexOf(e.code)};return t})}return Object.defineProperty(t.prototype,"selectedPlateformes",{get:function(){return _.filter(this.plateformes,function(e){return e.selected})},enumerable:!0,configurable:!0}),t.prototype.testPlateforme=function(e){return _.any(this.plateformes,function(t){return t.code===e.code&&t.selected})},t.prototype.init=function(e){this.resolutionCompatible=!this.resolutionMinimaleMyway||null==e.ecranCompatibleMyway||e.ecranCompatibleMyway,this.plateformeCompatible=null==e.plateforme||this.testPlateforme(e.plateforme),this.touchCompatible=!this.ecranTactile||e.infoMachine.ecranTactile,0===e.typeReseau?this.reseauCompatible=!1:1===this.codeVisibiliteApplication?this.reseauCompatible=-1===[10].indexOf(e.typeReseau):2===this.codeVisibiliteApplication?this.reseauCompatible=-1===[30,20].indexOf(e.typeReseau):this.reseauCompatible=!0},Object.defineProperty(t.prototype,"isCompatible",{get:function(){return this.plateformeCompatible&&this.reseauCompatible&&this.touchCompatible&&this.resolutionCompatible},enumerable:!0,configurable:!0}),t.prototype.toString=function(){var e="";return e+="P("+this.getCodesPlateformes(this.selectedPlateformes)+")",e+="R("+(this.resolutionMinimaleMyway?"O":"N")+")",e+="T("+(this.ecranTactile?"O":"N")+")"},t.prototype.extractValue=function(e,t,i){var n=e.match(t+"\\(([\\w]+)\\)");return n&&n.length>1?n[1]:i},t.prototype.getCodesPlateformes=function(e){return _.reduce(e,function(e,t){return e+=t.code},"")},t}();e.DeviceCompatible=t}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){"use strict";var i=function(){function t(e){this.items=e}return Object.defineProperty(t.prototype,"hasPendingModifications",{get:function(){return _.some(this.items,function(e){return-1!==[4,5,3].indexOf(e.statut)})},enumerable:!0,configurable:!0}),t.prototype.addAll=function(e){[].push.apply(this.items,e)},t.prototype.createSavePoint=function(){this.backupItems=angular.copy(this.items)},t.prototype.deleteSavePoint=function(){this.backupItems=void 0},t.prototype.restoreSavePoint=function(){if(!this.backupItems)throw"Pas de point de sauvegarde défini, restauration impossible !";this.items.length=0,[].push.apply(this.items,this.backupItems),this.deleteSavePoint()},t.prototype.filteredBy=function(e){var t=_.filter(this.items,function(t){return e(t)});this.items.length=0,[].push.apply(this.items,t)},t.prototype.removeBy=function(e){var t=_.filter(this.items,function(t){return!e(t)});this.items.length=0,[].push.apply(this.items,t)},t.prototype.removeById=function(e){var t=_.findIndex(this.items,function(t){return t.id===e});-1!==t&&this.items.splice(t,1)},t.prototype.getDeltaWithSavePoint=function(t){return e.core.ArrayUtils.differenceWith(this.items,this.backupItems,function(e,i){return e.id===i.id&&t(e,i)})},t.prototype.getById=function(e){return _.find(this.items,function(t){return t.id===e})},t.prototype.getIndexById=function(e){return _.findIndex(this.items,function(t){return t.id===e})},t.prototype.checkIntegrity=function(){var e=this,t=!1;return this.items.forEach(function(i){i.id||(t=!0,e.generateItemId(i))}),t},t}();t.ItemList=i}(i=t.modele||(t.modele={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.v1||(e.v1={}))}(t=e.preference||(e.preference={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.v2||(e.v2={}))}(t=e.preference||(e.preference={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.v1||(e.v1={}))}(t=e.preference||(e.preference={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t){this.$q=e,this.preferenceService=t}return e.prototype.initFromContainer=function(e){this.itemContainer=e,this.loadPromise=this.$q.when()},e.prototype.getList=function(){var e=this;return this.load().then(function(){return e.itemContainer})},e.prototype.checkIntegrity=function(){var e=this.itemContainer.checkIntegrity();return e?this.write():this.$q.when()},e.prototype.write=function(){var e=this;if(!this.itemContainer)throw"write preferences: il faut charger les données avant de faire une écriture !";this.itemContainer.removeBy(function(e){return 3===e.statut}),this.itemContainer.items.forEach(function(t){4!==t.statut||t.id||e.itemContainer.generateItemId(t)});var t=_.map(this.itemContainer.items,function(t){return e.createObjectPreference(t)});return this.preferenceService.write(this.PREFERENCE_KEY,t).then(function(){e.itemContainer.items.forEach(function(e){(4===e.statut||5===e.statut)&&(e.statut=1)})})},e.prototype.deleteAll=function(){return this.preferenceService.write(this.PREFERENCE_KEY,[])},e.prototype.read=function(){var e=this;return this.preferenceService.readArray(this.PREFERENCE_KEY).then(function(t){var i=_.map(t,function(t){return e.createDTO(t)});return i})},e}();e.PreferenceInstance=t}(t=e.preference||(e.preference={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.preference||(e.preference={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function t(e,t,i,n){this.$q=e,this.$filter=t,this.agentService=i,this.logger=n,this.USER_PREFERENCES_KEY="portailUserPreferences"}return t.prototype.getUserPreferences=function(){return this.readObject(this.USER_PREFERENCES_KEY).then(function(e){return _.merge({},i.DEFAULT_USER_PREFERENCES,e)})},t.prototype.writeUserPreferences=function(e){return this.write(this.USER_PREFERENCES_KEY,e)},t.prototype.readArray=function(e){var t=this;return this.readDescripteur(e).then(function(i){return i&&i.countRecords?t.readData(e,i):void 0})["catch"](function(i){return t.logger.info("Lecture préférences:",e,"=>",i),[]})},t.prototype.readObject=function(e){var t=this;return this.readDescripteur(e).then(function(i){return i&&i.countRecords?t.readData(e,i):void 0})["catch"](function(i){return t.logger.info("Lecture préférences:",e,"=>",i),{}})},t.prototype.write=function(e,t){var i=this.splitValue(JSON.stringify(t)),n={timestamp:moment().format("YYYYMMDDhhmmssSSS"),countRecords:i.length},r=[{cle:this.getKeyDescripteur(e),valeur:JSON.stringify(n)}];return i.forEach(function(t,i){r.push({cle:e+"."+(i+1),valeur:t})}),this.agentService.ecrirePreferences(r)},t.prototype.readDescripteur=function(e){var t=this;return this.agentService.lirePreference(this.getKeyDescripteur(e)).then(function(e){try{return e?JSON.parse(e):t.$q.reject("pas de préférences")}catch(i){return t.$q.reject("descripteur invalide: "+e)}})},t.prototype.readData=function(e,t){var i=this;if(!t.countRecords)return this.$q.when(null);for(var n=[],r=1;r<=t.countRecords;r++)n.push(e+"."+r);return this.agentService.lirePreferences(n).then(function(e){var t=_.map(e,function(e){return e.valeur}).join("");try{return JSON.parse(t)}catch(n){return i.$q.reject("données invalides: "+t)}})},t.prototype.splitValue=function(e){var t=[];return null!=e&&(t=e.match(/.{1,480}/g)),t},t.prototype.getKeyDescripteur=function(e){return e+".0"},t.$inject=["$q","$filter",e.core.ServiceNames.Agent,e.core.ServiceNames.Logger],t}();i.PreferenceService=n,t.app.service(t.ServiceNames.Preference,n)}(i=t.preference||(t.preference={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";e.DEFAULT_USER_PREFERENCES={version:void 0,afficherCategorieStore:!0,filtrerPrecoStore:!0,vueStore:0}}(t=e.preference||(e.preference={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.SYNTHESE_CLIENT="SYNTH_CLI",e.SYNTHESE_CLIENT_PM="CONS_SYNTH_PM",e.CONNAISSANCE_CLIENT_PART="GererPersonnePhysiqu",e.CONNAISSANCE_CLIENT_PRO="ModifPersonneMorale",e.SERVICE_RECHERCHE="SERV_RECH",e.AGENDA="CSULT_AGND",e.IDENTIFICATION_PERSONNE="IDNT_UNE_PERS",e.CLASSEUR_CLIENT="CONS_DOSS_ACQR_DOCM",e.SOUSCRIRE_EPARGNE_SALARIALE="SOUS_EPAR_SALR",e}();e.CodesProcessus=t;var i=function(){function e(){}return e.MA_JOURNEE={name:"Ma journée",url:"http://myway-dua.sigcesie.caisse-epargne.fr:6080/version2/myway.portail.ma-journee",code:"myway.portail.ma-journee"},e.DEBUT_JOURNEE={name:"Début de journée",url:"http://myway-dua.sigcesie.caisse-epargne.fr:6080/version2/myway.portail.debut-journee",code:"myway.portail.debut-journee"},e.STORE={name:"My Store",url:"http://myway-dua.sigcesie.caisse-epargne.fr:6080/version2/myway.portail.processus-applications",code:"myway.portail.processus-applications"},e}();e.ApplicationPortail=i}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){function i(e,t,i){this.$q=e,this.logger=t,this.agentService=i}return i.prototype.getEtablissementMysys=function(e){return e=e||{typeListe:"2"},this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/structure-v2/etablissementMysys",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:e}).then(function(e){return e.Etablissement})},i.prototype.getCaracteristiqueEDS=function(e){var t=this;return this.agentService.getAuthentificationInfo().then(function(i){return null==e.codeEtablissement&&(e.codeEtablissement=i.codeEtablissement),t.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/structure-v2/caracteristiqueEDS",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:e})})},i.prototype.getCaracteristiqueAgence=function(e){return null!=e.referenceExterneEDS&&(e.typeEDS=t.TypeEds.AGENCE),this.getCaracteristiqueEDS(e)},i.$inject=["$q",e.core.ServiceNames.Logger,e.core.ServiceNames.Agent],i}();t.EdsService=i,t.app.service(t.ServiceNames.Eds,i)}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){function e(e){this.$q=e}return e.prototype.setHook=function(e){this.hook=e},e.prototype.clearHook=function(){this.hook=void 0},e.prototype.getHook=function(){return this.hook?this.hook():this.$q.when()},e.$inject=["$q"],e}();t.HookService=i,e.app.service(e.ServiceNames.Hook,i)}(t=e.service||(e.service={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){function i(e,t,i,n,r,o,a,s,c,l){this.$q=e,this.$window=t,this.$rootScope=i,this.agentService=n,this.erreurService=r,this.loaderService=o,this.logger=a,this.messageService=s,this.applicationService=c,this.tiersService=l}return i.prototype.startUrl=function(e,i){var n={name:e,url:i};this.messageService.sendRequest({eventName:t.message.MessageNames.START_URL,params:n})},i.prototype.startUrlWithParams=function(e,i){var n={name:e,url:i};this.messageService.sendRequest({eventName:t.message.MessageNames.START_URL_WITH_PARAMS,params:n})},i.prototype.lancerApplication=function(e,i){void 0===i&&(i=t.Zone.PORTAIL);var n={id:e.codeApplication,zoneId:i};return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.START_APPLICATION,params:n})},i.prototype.lancerSyntheseClient=function(e,i){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.START_SYNTHESE_CLIENT,params:{identifiantPersonne:e,codePersonnaliteJuridique:i}})},i.prototype.lancerSyntheseClientPersonnePhysique=function(e){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.START_SYNTHESE_CLIENT,params:{identifiantPersonne:e,codePersonnaliteJuridique:t.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE}})},i.prototype.lancerSyntheseClientPersonneMorale=function(e){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.START_SYNTHESE_CLIENT,params:{identifiantPersonne:e,codePersonnaliteJuridique:t.CodesPersonnaliteJuridique.PERSONNE_MORALE}})},i.prototype.lancerConnaissanceClientPersonnePhysique=function(e){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.START_CONNAISSANCE_CLIENT_PART,params:{identifiantPersonne:e}})},i.prototype.lancerConnaissanceClientPersonneMorale=function(e){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.START_CONNAISSANCE_CLIENT_PRO,params:{identifiantPersonne:e}})},i.prototype.lancerProcessusClient=function(e,i){var n=this,r=i?this.$q.when(i+""):this.agentService.getFromContext("identifiantPersonne");return r.then(function(i){return i?(e.initData||(e.initData=new t.ParamLisa),e.initData.addParam("identifiantPersonne",i),e.idPersonne=parseInt(i,10),n.lancerProcessus(e)):n.$q.reject("pas de client trouvé!")})},i.prototype.lancerProcessus=function(e){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.START_PROCESS,params:e})},i.prototype.lancerStore=function(){this.messageService.sendRequest({eventName:t.message.MessageNames.START_STORE})},i.prototype.terminerDebutJournee=function(){this.messageService.sendRequest({eventName:t.message.MessageNames.TERMINER_DEBUT_JOURNEE})},i.prototype.getApplicationContext=function(){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.APPLICATION_CONTEXT})},i.prototype.isVueClient=function(){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.IS_VUE_CLIENT})},i.prototype.setVueClient=function(e){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.SET_VUE_CLIENT,params:e})},i.prototype.onChangementVue=function(e){this.messageService.subscribeRequest({eventName:t.message.MessageNames.CHANGEMENT_VUE,request:function(t){e(t.params)}})},i.prototype.getUserPreferences=function(){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.USER_PREFERENCES})},i.prototype.resetFavorisApplication=function(){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.RESET_FAVORIS_APPLICATION})},i.prototype.reloadApplicationContext=function(){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.RELOAD_APPLICATION_CONTEXT})},i.prototype.checkPreconisationsEtablissements=function(){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.CHECK_PRECONISATIONS_ETABLISSEMENTS})},i.prototype.toggleLoader=function(e){this.messageService.sendRequest({eventName:t.message.MessageNames.TOGGLE_LOADER,params:e})},i.prototype.toggleTotem=function(e){this.messageService.sendRequest({eventName:t.message.MessageNames.TOGGLE_TOTEM_PORTAIL,params:e})},i.prototype.toggleLockPortail=function(e){this.messageService.sendRequest({eventName:t.message.MessageNames.TOGGLE_LOCK_PORTAIL,params:e})},i.prototype.writeFavoris=function(){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.WRITE_FAVORIS})},i.prototype.writeLiens=function(){return this.messageService.sendRequestWithResponse({eventName:t.message.MessageNames.WRITE_LIENS})},i.$inject=["$q","$window","$rootScope",e.core.ServiceNames.Agent,e.core.ServiceNames.Erreur,e.core.ServiceNames.Loader,e.core.ServiceNames.Logger,t.ServiceNames.Message,t.ServiceNames.Application,t.ServiceNames.Tiers],i}();t.PortailService=i,t.app.service(t.ServiceNames.Portail,i)}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){function i(e,t,i,n){this.$q=e,this.logger=t,this.modalService=i,this.agentService=n}return i.prototype.getTiersLiesAdministratifs=function(e){var t=this;return this.agentService.getAuthentificationInfo().then(function(i){return t.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v1/tiersLiesAdministratifs",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{idPersonne:e,codeEtablissement:i.codeEtablissement}})})},i.prototype.getRelationEco=function(e){return this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v1/relationEconomique",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{idPersonne:e,typeCompositionRelation:"3"}})},i.prototype.getClient=function(e){var t=this;return this.agentService.getAuthentificationInfo().then(function(i){return t.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v1/client",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{idPersonne:e,codeEtablissement:i.codeEtablissement,typeCompositionRelation:"3"}})})},i.prototype.getMedia=function(e){var t=this;return this.agentService.getAuthentificationInfo().then(function(i){return t.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v1/media",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{idPersonne:e,codeEtablissement:i.codeEtablissement}})})},i.prototype.getIdentification=function(e){var t=this;return this.agentService.getAuthentificationInfo().then(function(i){return t.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v1/identification",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{idPersonne:e,codeEtablissement:i.codeEtablissement}})})},i.prototype.getSuiviCommercial=function(e){var t=this;return this.agentService.getAuthentificationInfo().then(function(i){return t.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v2/identification",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{identifiantPersonne:e,codeEtablissement:i.codeEtablissement}})}).then(function(e){return e.suiviComercial||t.$q.reject({codeErreur:1,libelle:"Pas de suivi commercial"})})},i.prototype.getParticulierInformation=function(e){var i=this;return this.agentService.getAuthentificationInfo().then(function(n){return i.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v1/particulierInformation",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{idPersonne:t.EdsUtils.getIdentifiantPersonne(e),codeEtablissement:n.codeEtablissement}})})},i.prototype.getCorporateInformation=function(e){var t=this;return this.agentService.getAuthentificationInfo().then(function(i){return t.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v2/corporateInformation",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{identifiantTiers:e,codeEtablissement:i.codeEtablissement}})})},i.prototype.getPortefeuille=function(e){var t=this;return this.agentService.getAuthentificationInfo().then(function(i){return t.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v2/portefeuille",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{identifiantTiers:e,codeEtablissement:i.codeEtablissement}})})},i.$inject=["$q",e.core.ServiceNames.Logger,"modalService",e.core.ServiceNames.Agent],i}();t.TiersService=i,t.app.service(t.ServiceNames.Tiers,i)}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function i(i,n,r,o,a){this.$q=i,this.$parse=n,this.$interpolate=r,this.logger=o,this.agentService=a,this.TOKENS=[{name:"URL-REST",value:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083"},{name:"PRESPMM",value:"PMMPres"},{name:"ENVPMM",value:"DUA"},{name:"DOMPMM",value:".sigcesie.caisse-epargne.fr"},{name:t.ContextKeys.URL_CULTURE_NET,value:void 0},{name:e.core.ConstantesSiglesCaisses.TOKEN,value:void 0}]}return i.prototype.replaceEnvironmentTokens=function(i){var n=this;return this.$q.all([this.agentService.getInfosCaisse().then(function(t){return _.find(n.TOKENS,function(t){return t.name===e.core.ConstantesSiglesCaisses.TOKEN}).value=t.sigle}),this.agentService.getFromContext(t.ContextKeys.URL_CULTURE_NET).then(function(e){return _.find(n.TOKENS,function(e){return e.name===t.ContextKeys.URL_CULTURE_NET}).value=e})]).then(function(){var e=i;return n.TOKENS.forEach(function(t){e=e.replace(n.formatEnvironmentToken(t.name),t.value)}),e})},i.prototype.replaceScopeTokens=function(e,i){var n=e;return n=n.replace(this.formatScopeToken(t.ScopeLisa.IDENTIFIANT_PERSONNE),t.EdsUtils.getIdentifiantPersonne(i.identifiantPersonne)),n=n.replace(this.formatScopeToken(t.ScopeLisa.LIBELLE_PERSONNE),i.libellePersonne),n=this.$interpolate(n)(i)},i.prototype.formatEnvironmentToken=function(e){return"["+e+"]"},i.prototype.formatScopeToken=function(e){return"{{"+e+"}}"},i.$inject=["$q","$parse","$interpolate",e.core.ServiceNames.Logger,e.core.ServiceNames.Agent],i}();i.TokenService=n,t.app.service(t.ServiceNames.Token,n)}(i=t.token||(t.token={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){function t(e,t){this.$q=e,this.agentService=t,this.RECHERCHE_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/rechercheWidget",this.RECHERCHE_JOURNEE_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/rechercheWidgetJourneeFO",this.WIDGET_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/widget"}return t.prototype.rechercherWidgets=function(){return this.agentService.sendRequest({url:this.RECHERCHE_URL,method:MyWay.Services.MethodEnum.GET,withHeaders:!0})},t.prototype.rechercherWidgetsJournee=function(){var e=this;return this.agentService.getAuthentificationInfo().then(function(t){var i={codeEtablissement:t.codeEtablissement,identifiantTypePosteFonctionnel:t.agentConnecte.typeFonction};return e.agentService.sendRequest({url:e.RECHERCHE_JOURNEE_URL,method:MyWay.Services.MethodEnum.GET,params:i,withHeaders:!0})})},t.prototype.getWidget=function(e,t){var i={identifiantWidget:e,versionMySys:t};return this.agentService.sendRequest({url:this.WIDGET_URL,method:MyWay.Services.MethodEnum.GET,params:i,withHeaders:!0}).then(function(e){return e})},t.prototype.getNewWidget=function(){var e={codePrepilote:0,versionDebutPublication:"",versionFinPublication:"",codeTailleWidget:void 0,identifiantWidget:void 0,libelleHabilitationWidget:"",libelleWidget:""};return this.$q.when(e)},t.prototype.enregistrerWidget=function(e){return this.agentService.sendRequest({url:this.WIDGET_URL,method:e.identifiantWidget?MyWay.Services.MethodEnum.PUT:MyWay.Services.MethodEnum.POST,data:e,withHeaders:!0})},t.$inject=["$q",e.core.ServiceNames.Agent],t}();t.WidgetService=i,t.app.service(t.ServiceNames.Widget,i)}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.prototype.init=function(){this.bindFavoris()},e.prototype.bindFavoris=function(){var e=this;this.favoriList.favorisLien.forEach(function(t){t.lien=e.lienList.getById(t.idLien),t.lien||(t.statut=6)}),this.favoriList.favorisApplication.forEach(function(t){t.application=_.find(e.applicationList.applications,function(e){return e.codeApplication===t.codeApplication}),t.application||(t.statut=6)})},e.prototype.getLibelleCategorieApplication=function(e){var t=_.find(this.familleList.familles,function(t){return t.codeFamille===e.codeFamille});return t?t.libelleFamille:""},e}();e.Context=t}(t=e.application||(e.application={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){"use strict";var i={onlyApplicationsPreconisees:!1,includeNonHabilite:!1,byCodeApplication:!1,byCodeProcessus:!1,byLibelle:!0,byMotsCles:!0,sort:1},n=function(){function n(e){this.allApplications=e,this.applicationsPersonnelles=[],this.hideApplication=function(){return!1},this.fadeApplication=function(){return!1},this.sortByLibelle()}return Object.defineProperty(n.prototype,"applications",{get:function(){var e=this;return _.filter(this.allApplications,function(t){return t.isHabilite&&!e.hideApplication(t)}).concat(this.applicationsPersonnelles)},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preconisationEtablissements",{get:function(){return _.filter(this.applications,function(e){return e.isFavoriMetier})},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"preconisationEtablissementsToFavoris",{get:function(){return _.filter(this.applications,function(e){return e.isFavoriMetier&&e.pushToFavoris})},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"processus",{get:function(){return _.filter(this.applications,function(e){return 4===e.application.codeTypeApplication})},enumerable:!0,configurable:!0}),n.prototype.generateApplicationsPersonnelles=function(){
return this.lienList?this.applicationsPersonnelles=_.map(this.lienList.items,function(e){var i=new t.Application;return i.origine=1,i.device=new t.DeviceCompatible(null,void 0),i.application={},i.application.libelleValeurParametre4=t.application.FamilleList.FAMILLE_APPLI_PERSO.codeFamille,i.application.codeApplication=e.id,i.application.libelleNomApplication=e.titre,i.application.libelleCheminExecution=e.url,i.application.codeExecutableConteneurMyway="O"===e.containerPortail?1:0,i}):[]},n.prototype.sortAndGroupByCategories=function(e,i){var n=this,r=_.groupBy(e,function(e){return e.codeFamille}),o=_.chain(r).map(function(e,t){var r=_.find(i,function(e){return e.codeFamille===t});return r||console.warn("categorie non trouvée",t),{applications:n.sortByPertinence(e),categorie:r,visible:!0}}).sortBy(function(e){return e.categorie?e.categorie.libelleFamille:t.application.FamilleList.FAMILLE_NON_AFFECTE.libelleFamille}).value();return o},n.prototype.search=function(e,n){n=_.merge({},i,n),e=t.StringUtils.stripAccents((e||"").toUpperCase());var r=n.includeNonHabilite?this.allApplications:this.applications;n.onlyApplicationsPreconisees&&(r=r.filter(function(e){return e.isFavoriMetier}));var o=n.byCodeApplication&&/(AC|AE)\d+/.test(e),a=_.filter(r,function(i){var r;return r=o?i.codeApplication===e:n.byLibelle&&t.StringUtils.contains(i.getLibelleProcessus(),e)||n.byMotsCles&&_.some(i.motCles,function(i){return t.StringUtils.contains(i,e)})||n.byCodeProcessus&&i.application.libelleCheminExecution===e});return 1===n.sort?this.sortByPertinence(a):this.sortByLibelle(a),a},n.prototype.filterByZone=function(e){return _.filter(this.applications,function(t){return t.isVisible(e)})},n.prototype.filterBy=function(e){return _.filter(this.applications,function(t){return e(t)})},n.prototype.getByCodeProcessus=function(e,i){return void 0===i&&(i=t.Zone.PORTAIL),_.find(this.applications,function(t){return t.getCodeProcessus(i)===e})},n.prototype.getByCodeApplication=function(e){return _.find(this.applications,function(t){return t.codeApplication===e})},n.prototype.sortByLibelle=function(t){var i=t||this.applications;return i.sort(function(t,i){var n=e.core.StringUtils.stripAccents(t.getLibelleProcessus().toLowerCase()),r=e.core.StringUtils.stripAccents(i.getLibelleProcessus().toLowerCase());return r>n?-1:n>r?1:0}),i},n.prototype.sortByPertinence=function(t){var i=t||this.applications;return i.sort(function(t,i){var n=e.core.StringUtils.stripAccents(t.getLibelleProcessus().toLowerCase()),r=e.core.StringUtils.stripAccents(i.getLibelleProcessus().toLowerCase());return t.isFavoriMetier&&!i.isFavoriMetier?-1:!t.isFavoriMetier&&i.isFavoriMetier?1:r>n?-1:n>r?1:0}),i},n}();t.ApplicationList=n}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){this.application=e,this.device=t,this.origine=0,this.application=this.application||{},this.isFavoriMetier=!1,this.pushToFavoris=!1}return Object.defineProperty(t.prototype,"ordreCompteur",{get:function(){return this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.ORDRE,e.Zone.MA_JOURNEE_COMPTEURS)},enumerable:!0,configurable:!0}),t.prototype.getUrlCompteur=function(t){return this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.URL_COMPTEUR,t)},t.prototype.getQueryParamsCompteur=function(t){return this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.QUERY_PARAMS_CPT,t)},t.prototype.getLibelleCompteur=function(t){return this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.LIBELLE_COMPTEUR,t)},Object.defineProperty(t.prototype,"isVueClient",{get:function(){return"O"===this.application.libelleDescriptionTechnique},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isPersonnelle",{get:function(){return 1===this.origine},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEtablissement",{get:function(){return _.startsWith(this.application.codeApplication.toUpperCase(),"AE")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isProcessus",{get:function(){return 4===this.application.codeTypeApplication},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isUrl",{get:function(){return 1===this.application.codeTypeApplication},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"codeApplication",{get:function(){return this.application.codeApplication},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"descriptionApplication",{get:function(){return this.application.libelleDescriptionApplication},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isAfficherBoutonFermer",{get:function(){return"1"===this.application.libelleSoumisALicence},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isClient",{get:function(){var t=this.getContexteEntreeLisa();return t&&null!=t[e.ScopeLisa.IDENTIFIANT_PERSONNE]},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"paramUrls",{get:function(){return this.application.listeApplicationUrlValeur},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"codeFamille",{get:function(){return this.application.libelleValeurParametre4||e.application.FamilleList.FAMILLE_NON_AFFECTE.codeFamille},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isConteneurMyway",{get:function(){return 1===this.application.codeExecutableConteneurMyway},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"listeElementsConfiguration",{get:function(){return this.application.listeElementConfiguration},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"motCles",{get:function(){return(this.application.libelleMotClef||"").split(";")},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"libelleType",{get:function(){var e="";switch(this.application.codeTypeApplication){case 5:e="CultureNet";break;case 2:e="Fichier";break;case 4:e="Processus";break;case 1:e="URL";break;case 3:e="Windows"}return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isVisibleStore",{get:function(){return this.isPersonnelle||this.isVisible(e.Zone.PROCESS_APP)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isVisibleBandeauClientIcone",{get:function(){return this.isPersonnelle||this.isVisible(e.Zone.BANDEAU_CLIENT_ICONE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isVisibleStoreContextuelClient",{get:function(){return this.isPersonnelle||this.isVisible(e.Zone.BANDEAU_CLIENT_STORE)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isContextuelClient",{get:function(){return this.isPersonnelle||this.isVisibleBandeauClientIcone||this.isVisibleStoreContextuelClient},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isContextuelProduit",{get:function(){return this.isPersonnelle||this.isVisible(e.Zone.SYNTHESE_CLIENT)},enumerable:!0,configurable:!0}),t.prototype.getHabilitation=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=this.isPersonnelle?"":this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.HABILITATION,t);return i||this.application.libelleHabilitation},t.prototype.isVisible=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=this.isPersonnelle||this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.VISIBLE,t);return i},t.prototype.getLibelleProcessus=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=this.isPersonnelle?"":this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.LIBELLE_PROCESSUS,t);return i||this.application.libelleNomApplication},t.prototype.getIcone=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=this.isPersonnelle?"":this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.ICONE,t);return i},t.prototype.getCodeProcessus=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=this.isPersonnelle?"":this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.CODE_PROCESSUS,t);return i||this.application.libelleCheminExecution},t.prototype.getOrdre=function(t){void 0===t&&(t=e.Zone.BANDEAU_CLIENT_ICONE);var i=this.isPersonnelle?0:this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.ORDRE,t);return i||999},t.prototype.containsCodeProcessus=function(t){var i=_.chain(this.listeElementsConfiguration).filter(function(t){return t.identifiantElement===e.ElementConfiguration.CODE_PROCESSUS}).map(function(e){return e.valeurElement}).value();return this.application.libelleCheminExecution&&i.push(this.application.libelleCheminExecution),-1!==i.indexOf(t)},t.prototype.getValeurEntreeLisa=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=this.isPersonnelle?0:this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.VALEUR_ENTREE_LISA,t);return i},t.prototype.getContexteEntreeLisa=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=this.isPersonnelle?void 0:this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.CONTEXTE_ENTREE_LISA,t);return i},t.prototype.hasContexteEntreeLisa=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=this.getContexteEntreeLisa(t);return!!i&&!_.isEmpty(i)},t.prototype.getAllContexteEntreeLisa=function(){var e=this;return _.chain(this.application.listeElementConfiguration).filter(function(e){return!0}).map(function(t){return e.castValeurElementConfiguration(t.valeurElement,4)}).value()},t.prototype.isExclusPersonnePhysique=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=!this.isPersonnelle&&this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.BDD,t);return i},t.prototype.isExclusPersonneMorale=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=!this.isPersonnelle&&this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.BDR,t);return i},t.prototype.isExclusActivitePro=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=!this.isPersonnelle&&this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.PRO,t);return i},t.prototype.isExclusAgentLaHenin=function(t){void 0===t&&(t=e.Zone.PORTAIL);var i=!this.isPersonnelle&&this.getValueElementByIdZoneAndIdElement(e.ElementConfiguration.HENIN,t);return i},t.prototype.getValueElementByIdZoneAndIdElement=function(e,t){var i,n=this.getElementConfigurationById(e),r=this.getValeurElementByIdAndZone(e,t),o=this.getValeurDefautByElementAndZone(e,t);i=r?r.valeurElement:o?o.valeurDefaut:void 0;var a=this.castValeurElementConfiguration(i,n.typeElement);return a},t.prototype.getValeurElementByIdAndZone=function(e,t){var i=_.find(this.listeElementsConfiguration,function(i){return i.identifiantElement===e&&i.identifiantZone===t}),n=this.getIdZoneParente(t);return n&&!i?this.getValeurElementByIdAndZone(e,n):i},t.prototype.getValeurDefautByElementAndZone=function(t,i){var n=_.find(e.ApplicationList.LISTE_ELEMENTS_ZONE,function(e){return e.idElementConfigurationPortail===t&&e.idZone===i}),r=this.getIdZoneParente(i);return!r||n&&null!=n.valeurDefaut?n:this.getValeurDefautByElementAndZone(t,r)},t.prototype.getIdZoneParente=function(t){var i=_.find(e.ApplicationList.LISTE_ZONE_PORTAIL,function(e){return e.identifiant===t});return i?i.idZoneParent:null},t.prototype.getElementConfigurationById=function(t){return _.find(e.ApplicationList.LISTE_ELEMENTS_CONF,function(e){return e.identifiant===t})},t.prototype.castValeurElementConfiguration=function(e,t){if(!e)return e;var i;switch(t){case 1:i=Number(e);break;case 2:i=e;break;case 3:i="1"===e;break;case 4:i=JSON.parse(e)}return i},t}();e.Application=t}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.application||(e.application={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.HABILITATION="HABILITATION",e.MULTI_INSTANCE="MULTI_INSTANCE",e.VISIBLE="VISIBLE",e.LIBELLE_PROCESSUS="LIBELLE_PROCESSUS",e.CODE_PROCESSUS="CODE_PROCESSUS",e.ORDRE="ORDRE",e.VALEUR_ENTREE_LISA="VALEUR_ENTREE_LISA",e.CONTEXTE_ENTREE_LISA="CONTEXTE_ENTREE_LISA",e.ICONE="ICONE",e.BDD="BDD",e.BDR="BDR",e.PRO="PRO",e.HENIN="HENIN",e.AGENT_BDR="AGENT_BDR",e.URL_COMPTEUR="URL_COMPTEUR",e.QUERY_PARAMS_CPT="QUERY_PARAMS_CPT",e.LIBELLE_COMPTEUR="LIBELLE_COMPTEUR",e}();e.ElementConfiguration=t}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t={onlyApplicationsPreconisees:!1},i=function(){function e(e,t,i,n){this.hidden=!1,"object"==typeof e?(this.codeFamille=e.codeSousFamille,this.libelleFamille=e.libelleSousFamille,this.position=e.positionSousFamille):(this.codeFamille=e,this.libelleFamille=t,this.position=i,this.hidden=n)}return e.prototype.getApplications=function(e){var t=this;return _.filter(e,function(e){return e.codeFamille===t.codeFamille})},e}();e.Famille=i;var n=function(){function e(t){this.familles=_.chain(t).map(function(e){return new i(e)}).sortBy(function(e){return e.libelleFamille}).value(),this.familles.push(e.FAMILLE_APPLI_PERSO),this.familles.push(e.FAMILLE_NON_AFFECTE)}return e.prototype.filtrerFamilles=function(e,i){i=_.merge({},t,i);var n=i.onlyApplicationsPreconisees?e.filter(function(e){return e.isFavoriMetier}):e,r=_.filter(this.familles,function(e){return!e.hidden&&_.some(n,function(t){return t.codeFamille===e.codeFamille})});return r},e.FAMILLE_APPLI_PERSO=new i("APPLI_PERSO","Mes applications personnelles",9998,!0),e.FAMILLE_NON_AFFECTE=new i("undefined","Non affecté",9999,!1),e}();e.FamilleList=n}(t=e.application||(e.application={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.PORTAIL="PORTAIL",e.TOTEM_GAUCHE="TOTEM_GAUCHE",e.BANDEAU_CLIENT="BANDEAU_CLIENT",e.BANDEAU_CLIENT_ICONE="BANDEAU_CLIENT_ICONE",e.BANDEAU_CLIENT_STORE="BANDEAU_CLIENT_STORE",e.PROCESS_APP="PROCESS_APP",e.SYNTHESE_CLIENT="SYNTHESE_CLIENT",e.MA_JOURNEE="MA_JOURNEE",e.MA_JOURNEE_INFOS="MA_JOURNEE_INFOS",e.MA_JOURNEE_COMPTEURS="MA_JOURNEE_COMPTEURS",e.COMPTEUR1="COMPTEUR1",e.COMPTEUR2="COMPTEUR2",e}();e.Zone=t}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){var n;!function(n){"use strict";var r=function(){function n(e,t,i,n,r,o,a,s){var c=this;this.$scope=e,this.$timeout=t,this.$q=i,this.$element=n,this.notificationService=r,this.logger=o,this.preferenceService=a,this.lienService=s,this.CONTENEUR_CATALOGUE_ID="conteneur-catalogue",this.SEACH_TEXT_ID="search-text",this.SEARCH_TEXT_MINLENGTH=0,this.INFINITE_SCROLL_NUMBER=60,this.applications=[],this.categorieApplications=[],this.initFiltres(),this.initTotemNavigation(),this.initConfigTuiles(),this.initApplicationsPersonnelles(),this.onAfficherCategories(),this.afficherAppliPerso=!1,this.$scope.$watch(function(){return c.settings.userPreferences.vueStore},function(){return c.setHeight()}),this.$scope.$watch(function(){return c.settings.heights},function(){return c.setHeight()}),this.$scope.$watch(function(){return c.settings.heights.favorisHeight},function(){return c.setHeight()}),this.$scope.$watch(function(){return c.settings.applicationList.hideApplication},function(){c.initTotemNavigation(),c.onAfficherCategories()})}return Object.defineProperty(n.prototype,"hasPrecos",{get:function(){return this.settings.applicationList.preconisationEtablissements.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"titre",{get:function(){return this.afficherAppliPerso?t.application.FamilleList.FAMILLE_APPLI_PERSO.libelleFamille:this.settings.titre},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isMaxView",{get:function(){return 2===this.settings.userPreferences.vueStore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isMinView",{get:function(){return 1===this.settings.userPreferences.vueStore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isConsultation",{get:function(){return 0===this.mode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isEditionCatalogue",{get:function(){return this.isAjoutFavoris||this.isEditionAppliPerso},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isAjoutFavoris",{get:function(){return 1===this.mode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isEditionAppliPerso",{get:function(){return 3===this.mode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"allCategories",{get:function(){return _.every(this.categorieApplications,function(e){return e.visible})},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isTotemNavigation",{get:function(){return this.afficherCategories&&!this.searchText&&!this.afficherAppliPerso},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isActiveSearch",{get:function(){return!!this.searchText||!this.afficherCategories},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"searchTextMinLength",{get:function(){return this.SEARCH_TEXT_MINLENGTH},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"nombreResultatRecherche",{get:function(){if(this.searchText&&this.searchText.length<this.SEARCH_TEXT_MINLENGTH)return"";var e;return e=this.applications.length?1===this.applications.length?this.applications.length+" résultat":this.applications.length+" résultats":"aucun résultat"},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"libelleFiltreCategorie",{get:function(){if(!this.searchText||!this.afficherCategories)return"";var e=_.filter(this.categorieApplications,function(e){return e.visible}),t="aucune";return 1===e.length?t=e[0].categorie.libelleFamille:e.length===this.categorieApplications.length?t="toutes":e.length>1&&(t="plusieurs"),t},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"libelleCategorieEnCours",{get:function(){return this.navigationSettings.activeItem.libelleFamille},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"applicationsPersonnelles",{get:function(){return this.settings.applicationList.applicationsPersonnelles},enumerable:!0,configurable:!0}),n.prototype.toggleView=function(){this.settings.userPreferences.vueStore=2===this.settings.userPreferences.vueStore?0:2,this.preferenceService.writeUserPreferences(this.settings.userPreferences)},n.prototype.toggleAppliPerso=function(){this.afficherAppliPerso=!this.afficherAppliPerso},n.prototype.gererAppliPerso=function(){this.onStartEdition({mode:3})},n.prototype.afficherAide=function(){e.core.PopupUtils.openMaxSize("http://myway-dua.sigcesie.caisse-epargne.fr:6080/version2/myway.portail.lib-portail/aide-catalogue.pdf","Aide")},n.prototype.annuler=function(){this.onCancelEdition()},n.prototype.enregistrer=function(){this.onUpdate()},n.prototype.setHeight=function(){var e=this;this.$timeout(function(){var t=e.$element[0].querySelector("#"+e.CONTENEUR_CATALOGUE_ID);t.style.maxHeight=e.settings.heights.catalogueMaxHeight+"px"})},n.prototype.getCategorieApplicationsParColonne=function(e){var t=this.categorieApplications.slice(10*e,10*(e+1));return t},n.prototype.isFirstCategorieAffichee=function(e){return _.every(this.categorieApplications.slice(0,e),function(e){return!e.visible})},n.prototype.toggleAllCategories=function(){var e=!this.allCategories;this.categorieApplications.forEach(function(t){return t.visible=e})},n.prototype.getApplicationsByCategorie=function(e){return this.afficherCategories?e.applications:e.applicationsPartials},n.prototype.loadMore=function(){if(!this.afficherCategories&&this.categorieApplications&&this.categorieApplications[0]&&!this.afficherAppliPerso){var e=this.categorieApplications[0],t=e.applicationsPartials.length,i=t+this.INFINITE_SCROLL_NUMBER;t<e.applications.length&&([].push.apply(e.applicationsPartials,e.applications.slice(t,i)),this.logger.trace("loadMore",t,i,"total affiché:",e.applicationsPartials.length))}},n.prototype.clearFilters=function(){this.searchText=void 0,this.afficherCategories?this.onSelectCategorie():this.onChangeSearchText()},n.prototype.onChangeSearchText=function(){if(!this.isActiveSearch)return this.clearFilters();var e,t=this.settings.applicationList.search(this.searchText,{onlyApplicationsPreconisees:this.filtrerPrecos});e=this.afficherCategories?this.settings.applicationList.sortAndGroupByCategories(t,this.settings.familleList.familles):[{categorie:null,applications:t,applicationsPartials:t.slice(0,this.INFINITE_SCROLL_NUMBER),visible:!0}],this.logger.trace("onChangeSearchText",e,"application count:",t.length),this.refreshApplications(t,e)},n.prototype.ajouterAppliPerso=function(){var e=this,t=this.settings.applicationList.lienList.createLien("","");this.lienService.editerLien(t).then(function(t){e.settings.applicationList.lienList.items.push(t),e.onUpdate()})},n.prototype.modifierAppliPerso=function(e){var t=this.settings.applicationList.lienList.getById(e);return this.lienService.editerLien(t).then(function(){t.statut=5})},n.prototype.supprimerAppliPerso=function(e){var t=this.settings.favoriList.getByIdLienAndContexte(e,this.settings.contexteLancement);return t&&this.settings.favoriList.removeById(t.id),this.settings.applicationList.lienList.removeById(e),this.settings.applicationList.generateApplicationsPersonnelles(),this.$q.when()},n.prototype.onDropModifierAppliPerso=function(e){var t=this;this.modifierAppliPerso(e).then(function(){0===t.mode&&t.onUpdate()})},n.prototype.onDropSupprimerAppliPerso=function(e){var t=this;this.supprimerAppliPerso(e).then(function(){0===t.mode&&t.onUpdate(),t.notificationService.showNotification("L'application personnelle a été supprimée")})},n.prototype.onSelectCategorie=function(){var e=this,t=this.settings.applicationList.filterBy(function(t){return t.codeFamille===e.navigationSettings.activeItem.codeFamille&&(t.isFavoriMetier||!e.filtrerPrecos)}),i=this.settings.applicationList.sortAndGroupByCategories(t,this.settings.familleList.familles);this.refreshApplications(t,i)},n.prototype.onAfficherCategories=function(){this.settings.userPreferences.afficherCategorieStore!==this.afficherCategories&&(this.settings.userPreferences.afficherCategorieStore=this.afficherCategories,this.preferenceService.writeUserPreferences(this.settings.userPreferences)),this.isActiveSearch?this.onChangeSearchText():this.onSelectCategorie()},n.prototype.onFiltrerPrecos=function(){this.initTotemNavigation(),this.settings.userPreferences.filtrerPrecoStore!==this.filtrerPrecos&&(this.settings.userPreferences.filtrerPrecoStore=this.filtrerPrecos,this.preferenceService.writeUserPreferences(this.settings.userPreferences)),this.isActiveSearch?this.onChangeSearchText():this.onSelectCategorie()},n.prototype.refreshApplications=function(e,t){this.applications.length=0,this.categorieApplications.length=0,this.applications=e,this.categorieApplications=t,this.scrollTop()},n.prototype.startApplication=function(e){this.onStartApplication({application:e})},n.prototype.initTotemNavigation=function(){var e=this;this.navigationSettings||(this.navigationSettings={itemSettings:{id:function(e){return e.codeFamille},libelle:function(e){return e.libelleFamille},action:function(t){return e.onSelectCategorie()}}}),this.categories=this.settings.familleList.filtrerFamilles(this.settings.applicationList.applications,{onlyApplicationsPreconisees:this.filtrerPrecos}),this.navigationSettings.items=this.categories,this.navigationSettings.activeItem&&-1!==this.categories.indexOf(this.navigationSettings.activeItem)||(this.navigationSettings.activeItem=this.categories[0])},n.prototype.initFiltres=function(){var e=this;this.filtreCategorieSettings={id:"boutonFiltreCategorie",icone:function(){return"itce-filter"},libelle:function(){return"Par catégorie: "+e.libelleFiltreCategorie},modele:"secondaire",showIconAndText:!0,rightAlign:!0,disabled:function(){return!e.searchText},mouseOver:!0},this.searchText=void 0,this.afficherCategories=this.settings.userPreferences.afficherCategorieStore,this.filtrerPrecos=!1,this.colonnesCategories=[0]},n.prototype.initConfigTuiles=function(){var e=this;this.tuileApplicationConfig={taille:0,titre:function(t){return t.getLibelleProcessus(e.settings.zone)},iconeMarquage:function(t){var i=e.settings.favoriList.getByOrigineAndIdAndContexte(t.origine,t.codeApplication,e.settings.contexteLancement);return i?"itce-star":""},bordureMarquage:function(t){var i=e.settings.favoriList.getByOrigineAndIdAndContexte(t.origine,t.codeApplication,e.settings.contexteLancement);return!!i},couleur:"couleur-jaune",isFaded:function(t){return e.settings.applicationList.fadeApplication(t)||!!i.applicationsFavoris.ApplicationUtils.getIconeContexteLancementApplicationByZone(t,e.settings.zone)},onAction:function(t){return e.startApplication(t)},dragDropSettings:{dataId:function(e){return e.codeApplication},isDisabled:function(t){var i=e.settings.favoriList.getByOrigineAndIdAndContexte(t.origine,t.codeApplication,e.settings.contexteLancement);return 0===t.origine&&!!i||0!==e.mode},dragSettings:{id:i.applicationsFavoris.DragDropId.CATALOGUE}}},this.initConfigTuilesApplications(),this.initConfigTuilesApplicationsPersonnelles()},n.prototype.initConfigTuilesApplications=function(){var e=this;this.tuileApplicationConfig.iconeBottomLeft=function(e){return e.isFavoriMetier?"itce-thumb-up":""},this.tuileApplicationConfig.iconeBottomRight=function(t){return i.applicationsFavoris.ApplicationUtils.getIconeContexteLancementApplicationByZone(t,e.settings.zone)},this.tuileApplicationConfig.isEdition=function(){return e.isAjoutFavoris},this.tuileApplicationConfig.action2={icone:function(t){var i=e.settings.favoriList.getByOrigineAndIdAndContexte(t.origine,t.codeApplication,e.settings.contexteLancement);return i?"itce-minus":"itce-plus"},libelle:function(t){var i=e.settings.favoriList.getByOrigineAndIdAndContexte(t.origine,t.codeApplication,e.settings.contexteLancement);return i?"Supprimer":"Ajouter"},action:function(t){if(0===t.origine)e.settings.favoriList.toggleFavoriApplication(t,e.settings.contexteLancement);else{var i=e.settings.applicationList.lienList.getById(t.codeApplication);e.settings.favoriList.toggleFavoriLien(i,e.settings.contexteLancement)}}},this.tuileApplicationConfig.backdrop=!0,this.tuileApplicationConfig.onActionBackdrop=this.tuileApplicationConfig.action2.action,this.tuileApplicationConfig.dragDropSettings={dataId:function(e){return e.codeApplication},isDisabled:function(t){var i=e.settings.favoriList.getByOrigineAndIdAndContexte(t.origine,t.codeApplication,e.settings.contexteLancement);return 0===t.origine&&!!i||0!==e.mode},dragSettings:{id:i.applicationsFavoris.DragDropId.CATALOGUE}}},n.prototype.initConfigTuilesApplicationsPersonnelles=function(){var e=this;this.tuileAppliPersoConfig=angular.copy(this.tuileApplicationConfig),this.tuileAppliPersoConfig.isEdition=function(){return e.isEditionAppliPerso},this.tuileAppliPersoConfig.action1={icone:function(e){return"itce-pencil"},libelle:function(e){return"Modifier"},action:function(t){return e.modifierAppliPerso(t.codeApplication)}},this.tuileAppliPersoConfig.action2={icone:function(e){return"itce-trash"},libelle:function(e){return"Supprimer"},action:function(t){return e.supprimerAppliPerso(t.codeApplication)}},this.tuileAppliPersoConfig.dragDropSettings={dataId:function(e){return e.codeApplication},isDisabled:function(t){var i=e.settings.favoriList.getByOrigineAndIdAndContexte(t.origine,t.codeApplication,e.settings.contexteLancement);return 0===t.origine&&!!i||0!==e.mode},dragSettings:{id:i.applicationsFavoris.DragDropId.CATALOGUE}}},n.prototype.scrollTop=function(){var e=this;this.$timeout(function(){var t=document.getElementById(e.CONTENEUR_CATALOGUE_ID);t.scrollTop=0})},n.prototype.initApplicationsPersonnelles=function(){var e=this;this.boutonAjouterAppliPersoSettings={titre:function(){return"Créer"},icone:function(){return"itce-plus"},onAction:function(){return e.ajouterAppliPerso()}},this.editionDropsSettings={cibleId:function(){return"edition"},dropTargetMarkerClass:i.tuile.DROP_TARGET_MARKER_CLASS,dropTargetMouseOverClass:"icon-drop-mouseover",drops:{}},this.editionDropsSettings.drops[i.applicationsFavoris.DragDropId.CATALOGUE]={onDropAction:function(t){return e.onDropModifierAppliPerso(t)},disableOnDrag:function(t){var i=e.settings.applicationList.getByCodeApplication(t);return 0===i.origine}},this.corbeilleDropsSettings={cibleId:function(){return"corbeille"},dropTargetMarkerClass:i.tuile.DROP_TARGET_MARKER_CLASS,dropTargetMouseOverClass:"icon-drop-mouseover",drops:{}},this.corbeilleDropsSettings.drops[i.applicationsFavoris.DragDropId.CATALOGUE]={onDropAction:function(t){return e.onDropSupprimerAppliPerso(t)}}},n.$inject=["$scope","$timeout","$q","$element","MwNotificationService",e.core.ServiceNames.Logger,t.ServiceNames.Preference,t.ServiceNames.Lien],n}();n.ApplicationsCatalogueControleur=r}(n=i.applicationsCatalogue||(i.applicationsCatalogue={}))}(i=t.ui||(t.ui={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){return{restrict:"E",require:"^portailApplicationsFavoris",templateUrl:"typescript/directives/applications-catalogue/applications-catalogue.html",controller:t.ApplicationsCatalogueControleur,controllerAs:"ctrl",bindToController:!0,scope:{settings:"=",mode:"=",onStartApplication:"&",onStartEdition:"&?",onCancelEdition:"&?",onUpdate:"&?"}}};i.$inject=[],e.app.directive("portailApplicationsCatalogue",i)}(i=t.applicationsCatalogue||(t.applicationsCatalogue={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){var n;!function(i){"use strict";var n=function(){function n(e,t,i,n,r,o,a,s,c,l,u,p,d,f){var h=this;this.$q=e,this.$element=t,this.$scope=i,this.notificationService=n,this.modalService=r,this.logger=o,this.loaderService=a,this.erreurService=s,this.applicationService=c,this.portailService=l,this.lienService=u,this.favoriPersoService=p,this.hintService=d,this.hookService=f,this.mode=0,this.settings.applicationList.lienList=this.settings.lienList,this.settings.applicationList.generateApplicationsPersonnelles(),this.favorisSettings={titre:"Mes favoris",zone:this.settings.zone,contexteLancement:this.settings.contexteLancement,favoriList:this.settings.favoriList,applicationList:this.settings.applicationList,lienList:this.settings.lienList,userPreferences:this.settings.userPreferences},this.applicationsCatalogueSettings={titre:"Catalogue des applications",zone:this.settings.zone,favoriList:this.settings.favoriList,applicationList:this.settings.applicationList,familleList:this.settings.familleList,contexteLancement:this.settings.contexteLancement,userPreferences:this.settings.userPreferences},this.resize(),window.onresize=function(){return h.$scope.$apply(function(){return h.resize()})},this.toggleLockPortail(!1)}return n.prototype.startApplication=function(e){1===e.origine?this.startLien(this.settings.lienList.getById(e.codeApplication)):this.onStartApplication({application:e})},n.prototype.startLien=function(e){this.onStartLien({lien:e})},n.prototype.onStartEdition=function(e){this.toggleLockPortail(!0),this.mode=e,this.previousVueStore=this.settings.userPreferences.vueStore,this.settings.userPreferences.vueStore=2===e?1:2,this.settings.favoriList.createSavePoint(),this.settings.lienList.createSavePoint(),this.logger.trace("onStartEdition",e)},n.prototype.onCancelEdition=function(){this.logger.trace("onCancelEdition"),this.mode=0,this.settings.userPreferences.vueStore=this.previousVueStore,this.settings.favoriList.restoreSavePoint(),
this.settings.lienList.restoreSavePoint(),this.settings.applicationList.generateApplicationsPersonnelles(),this.toggleLockPortail(!1)},n.prototype.onUpdate=function(){var e=this;this.logger.trace("onUpdate"),this.mode=0,this.settings.userPreferences.vueStore=this.previousVueStore,this.settings.applicationList.generateApplicationsPersonnelles(),this.saveFavorisEtLiens()["catch"](function(t){e.logger.error("erreur enregistrement des favoris et liens",t)})["finally"](function(){return e.toggleLockPortail(!1)})},n.prototype.saveFavorisEtLiens=function(){var e=this;return this.settings.favoriList.removeBy(function(t){return 0===t.type&&!_.some(e.settings.lienList.items,function(e){return e.id===t.idLien})}),this.settings.favoriList.items.forEach(function(t){1===t.type&&3===t.statut&&t.application.isFavoriMetier&&(t.statut=2,e.logger.trace("saveFavorisEtLiens",t.application.getLibelleProcessus(),"soft delete"))}),this.$q.all([this.portailService.writeFavoris(),this.portailService.writeLiens()])},n.prototype.toggleLockPortail=function(e){var t=this;this.portailService.toggleLockPortail(e),e?this.hookService.setHook(function(){return t.modalService.showConfirm({actionButtonText:"Confirmer",closeButtonText:"Annuler",headerText:"Modifications en cours",bodyText:"Êtes vous sûr de vouloir fermer le store ? Les modifications en cours seront perdues",iconName:"itce-question",size:"md"}).then(function(){t.portailService.toggleLockPortail(!1),0!==t.mode&&t.onCancelEdition()})}):this.hookService.clearHook()},n.prototype.resize=function(){var e=this,n=t.Utils.mediaHeight-(this.settings.unavailableHeight||0),r=new i.Heights(function(){return n},function(){return e.settings.userPreferences.vueStore});this.favorisSettings.heights=r,this.applicationsCatalogueSettings.heights=r},n.$inject=["$q","$element","$scope","MwNotificationService","modalService",e.core.ServiceNames.Logger,e.core.ServiceNames.Loader,e.core.ServiceNames.Erreur,t.ServiceNames.Application,t.ServiceNames.Portail,t.ServiceNames.Lien,t.ServiceNames.FavoriPerso,t.ServiceNames.Hint,t.ServiceNames.Hook],n}();i.ApplicationsFavorisControleur=n}(n=i.applicationsFavoris||(i.applicationsFavoris={}))}(i=t.ui||(t.ui={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){return{restrict:"E",templateUrl:"typescript/directives/applications-favoris/applications-favoris.html",controller:t.ApplicationsFavorisControleur,controllerAs:"ctrl",bindToController:!0,scope:{settings:"=",onStartApplication:"&",onStartLien:"&"}}};i.$inject=[],e.app.directive("portailApplicationsFavoris",i)}(i=t.applicationsFavoris||(t.applicationsFavoris={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.FAVORIS="FAVORIS",e.CATALOGUE="CATALOGUE",e}();e.DragDropId=t;var i=function(){function e(e,t){this.containerHeight=e,this.vue=t,this.FAVORIS_FILLER_HEIGHT=43}return Object.defineProperty(e.prototype,"favorisMaxHeight",{get:function(){var e=1===this.vue()?this.containerHeight():this.containerHeight()/2,t=e-this.FAVORIS_FILLER_HEIGHT;return t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"catalogueMaxHeight",{get:function(){var e=2===this.vue()?this.containerHeight()-129:this.containerHeight()-150-this.favorisHeight-this.FAVORIS_FILLER_HEIGHT;return e},enumerable:!0,configurable:!0}),e}();e.Heights=i}(t=e.applicationsFavoris||(e.applicationsFavoris={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.getIconeContexteLancementApplication=function(e){var t="";return e&&e.isContextuelProduit?t="itce-product-category-circle":e&&e.isContextuelClient&&(t="itce-undefined"),t},e.getIconeContexteLancementApplicationByZone=function(e,t){var i="";return e&&!e.isVisible(t)&&(i=this.getIconeContexteLancementApplication(e)),i},e}();e.ApplicationUtils=t}(t=e.applicationsFavoris||(e.applicationsFavoris={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){function t(t,i,n,r){var o=this;this.$scope=t,this.$element=i,this.$timeout=n,this.$document=r,this.MENU_CLASS="menu-contextuel",this.watcherIsOpen=function(e,t){e!==t&&(e?o.open():o.close())},this.escapeKeyBind=function(e){27===e.which&&o.closeDropdown()},this.closeDropdown=function(t){e.Utils.isModaleBoostrapOpened()||t&&o.$element[0].contains(t.target)||o.$scope.$apply(function(){o.settings.ouvert=!1})},this.settings.ouvert=!!this.settings.ouvert,this.settings.showIconAndText=!!this.settings.showIconAndText,this.settings.mouseOver=!!this.settings.mouseOver,this.settings.mouseOver&&this.initMouseOver(),this.$scope.$watch(function(){return o.settings.ouvert},this.watcherIsOpen,!0)}return Object.defineProperty(t.prototype,"libelle",{get:function(){return this.settings.libelle?this.settings.libelle():""},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"icone",{get:function(){return this.settings.icone?this.settings.icone():""},enumerable:!0,configurable:!0}),t.prototype.open=function(){this.resizeDropdown(),this.$document.bind("keydown",this.escapeKeyBind),this.$document.bind("click",this.closeDropdown)},t.prototype.close=function(){this.$document.unbind("keydown",this.escapeKeyBind),this.$document.unbind("click",this.closeDropdown)},t.prototype.resizeDropdown=function(){var e=this.$element[0].querySelector("."+this.MENU_CLASS);this.settings.width&&(e.style.width=this.settings.width)},t.prototype.initMouseOver=function(){var e=this;this.$element.bind("mouseover",function(){return e.$scope.$apply(function(){e.closeTimeoutPromise&&e.$timeout.cancel(e.closeTimeoutPromise),e.settings.ouvert=!0})}),this.$element.bind("mouseleave",function(t){return e.$scope.$apply(function(){e.closeTimeoutPromise=e.$timeout(function(){e.closeTimeoutPromise=void 0,e.settings.ouvert=!1},100)})})},t.$inject=["$scope","$element","$timeout","$document"],t}();e.app.controller("boutonMenuContextuelController",i)}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){return{restrict:"E",transclude:!0,templateUrl:"typescript/directives/bouton-menu-contextuel/bouton-menu-contextuel.html",controller:"boutonMenuContextuelController",controllerAs:"ctrl",bindToController:!0,scope:{settings:"="}}};i.$inject=[],e.app.directive("pmBoutonMenuContextuel",i)}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){var i;!function(t){"use strict";var i=function(){function i(e,i,n,r,o,a){var s=this;this.$scope=e,this.$rootScope=i,this.$timeout=n,this.$element=r,this.$attrs=o,this.logger=a,this.initSettings=function(e){s.initDeregisterFunction(),s.disable(),s.settings=s.$scope.$eval(e),s.settings&&"function"==typeof s.settings.disable&&s.$scope.$watch(function(){return s.settings.disable()},s.onDisableChange)},this.onDisableChange=function(e){e?s.disable():s.enable()},this.dragStart=function(e){var i={dragId:s.settings.id,sourceId:s.settings.sourceId()};s.$rootScope.$emit(t.Events.DRAG_START,i)},this.dragEnd=function(e){var i={dragId:s.settings.id};s.$rootScope.$emit(t.Events.DRAG_END,i)},this.$scope.$on("$destroy",function(){s.disable()}),this.isEnabled=!1,this.initDeregisterFunction=o.$observe(t.DIRECTIVE_DRAGGABLE,this.initSettings)}return i.prototype.enable=function(){this.isEnabled||(this.$element.attr("draggable","true"),this.$element.bind("dragstart",this.dragStart),this.$element.bind("dragend",this.dragEnd),this.isEnabled=!0)},i.prototype.disable=function(){this.isEnabled&&(this.$element.attr("draggable","false"),this.$element.unbind("dragstart",this.dragStart),this.$element.unbind("dragend",this.dragEnd),this.isEnabled=!1)},i.$inject=["$scope","$rootScope","$timeout","$element","$attrs",e.core.ServiceNames.Logger],i}();t.DragControleur=i}(i=t.dragdrop||(t.dragdrop={}))}(i=t.ui||(t.ui={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";t.DIRECTIVE_DRAGGABLE="coreDraggable";var i=function(){return{restrict:"A",controller:t.DragControleur}};e.app.directive(t.DIRECTIVE_DRAGGABLE,i)}(i=t.dragdrop||(t.dragdrop={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";e.DRAGGING_TYPE="text/plain";var t=function(){function e(){}return e.DRAG_START="CORE-DRAG-START",e.DRAG_END="CORE-DRAG-END",e}();e.Events=t}(t=e.dragdrop||(e.dragdrop={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){var i;!function(t){"use strict";var i=function(){function i(e,i,n,r,o,a){var s=this;this.$scope=e,this.$rootScope=i,this.$timeout=n,this.$element=r,this.$attrs=o,this.logger=a,this.initSettings=function(e){s.initDeregisterFunction(),s.disable(),s.settings=s.$scope.$eval(e),s.settings&&(_.forEach(s.settings.drops,function(e){return e.disableOnDrag=e.disableOnDrag||function(){return!1}}),_.all(s.settings.drops,function(e){return!e.disable})?s.enable():s.initSettingsWatchers())},this.onDisableChange=function(){_.all(s.settings.drops,function(e,t){return"function"==typeof e.disable&&e.disable()})?s.disable():s.enable()},this.onDragStart=function(e,t){s.settings.drops[t.dragId]&&t.sourceId!==s.settings.cibleId()&&!s.settings.drops[t.dragId].disableOnDrag(t.sourceId)&&(s.$element.addClass(s.settings.dropTargetMarkerClass),s.dragParams=t)},this.onDragEnd=function(e,t){s.settings.drops[t.dragId]&&t.sourceId!==s.settings.cibleId()&&(s.$element.removeClass(s.settings.dropTargetMarkerClass),s.settings.dropTargetMouseOverClass&&s.$element.removeClass(s.settings.dropTargetMouseOverClass),s.dragParams=void 0)},this.dragenter=function(e){s.settings.dropTargetMouseOverClass&&s.$element.addClass(s.settings.dropTargetMouseOverClass),e.preventDefault()},this.dragleave=function(e){s.settings.dropTargetMouseOverClass&&s.$element.removeClass(s.settings.dropTargetMouseOverClass)},this.dragover=function(e){s.dragParams&&s.settings.drops[s.dragParams.dragId]&&s.dragParams.sourceId!==s.settings.cibleId()&&e.preventDefault()},this.drop=function(e){if(e.preventDefault(),e.stopPropagation(),s.settings.drops[s.dragParams.dragId]){var i={dragId:s.dragParams.dragId};s.$scope.$apply(function(){s.settings.drops[s.dragParams.dragId].onDropAction(s.dragParams.sourceId,s.settings.cibleId()),s.$rootScope.$emit(t.Events.DRAG_END,i)})}},this.listenerDeregisterFunctions=[],e.$on("$destroy",function(){s.disable()}),this.isEnabled=!1,this.initDeregisterFunction=o.$observe(t.DIRECTIVE_DROP_TARGET,this.initSettings)}return i.prototype.initSettingsWatchers=function(){var e=this;_.forEach(this.settings.drops,function(t){"function"==typeof t.disable&&e.$scope.$watch(function(){return t.disable()},e.onDisableChange)})},i.prototype.enable=function(){this.isEnabled||(this.listenerDeregisterFunctions.push(this.$rootScope.$on(t.Events.DRAG_START,this.onDragStart)),this.listenerDeregisterFunctions.push(this.$rootScope.$on(t.Events.DRAG_END,this.onDragEnd)),this.$element.bind("dragover",this.dragover),this.$element.bind("dragenter",this.dragenter),this.$element.bind("dragleave",this.dragleave),this.$element.bind("drop",this.drop),this.isEnabled=!0)},i.prototype.disable=function(){this.isEnabled&&(this.listenerDeregisterFunctions.forEach(function(e){return e()}),this.listenerDeregisterFunctions.length=0,this.$element.unbind("dragover",this.dragover),this.$element.unbind("dragenter",this.dragenter),this.$element.unbind("dragleave",this.dragleave),this.$element.unbind("drop",this.drop),this.isEnabled=!1)},i.$inject=["$scope","$rootScope","$timeout","$element","$attrs",e.core.ServiceNames.Logger],i}();t.DropControleur=i}(i=t.dragdrop||(t.dragdrop={}))}(i=t.ui||(t.ui={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";t.DIRECTIVE_DROP_TARGET="coreDropTarget";var i=function(){return{restrict:"A",controller:t.DropControleur}};e.app.directive(t.DIRECTIVE_DROP_TARGET,i)}(i=t.dragdrop||(t.dragdrop={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){function t(t,i,n,r,o,a,s,c){var l=this;this.$scope=t,this.$timeout=i,this.$attrs=n,this.$parse=r,this.$animate=o,this.$element=a,this.$document=s,this.hookService=c,this.OPEN_CLASS="open",this.setIsOpen=angular.noop,this.watcherIsOpen=function(e,t){e!==t&&(l.$animate[e?"addClass":"removeClass"](l.$element,l.OPEN_CLASS),e?l.open():(l.close(),l.focusToggleElement()),l.setIsOpen(l.$scope,e),e&&l.$timeout(function(){return l.openInvoker(l.$scope,{})}),angular.isDefined(e)&&e!==t&&l.toggleInvoker(l.$scope,{open:!!e}))},this.closeDropdown=function(t){e.Utils.isModaleBoostrapOpened()||t&&l.toggleElement&&l.$element[0].contains(t.target)||l.$scope.$apply(function(){l.hookService.getHook().then(function(){return l.isOpen=!1})})},this.escapeKeyBind=function(e){27===e.which&&l.closeDropdown()},this.toggleInvoker=n.onToggle?r(n.onToggle):angular.noop,this.openInvoker=n.onOpen?r(n.onOpen):angular.noop,this.$attrs.isOpen&&(this.getIsOpen=this.$parse(this.$attrs.isOpen),this.setIsOpen=this.getIsOpen.assign,this.$scope.$watch(this.getIsOpen,function(e){return l.isOpen=!!e})),this.getExternalClose=this.$parse(this.$attrs.externalClose),this.$scope.$watch(this.getExternalClose,function(e){return l.externalClose=!!e}),this.getEscapeClose=this.$parse(this.$attrs.escapeClose),this.$scope.$watch(this.getEscapeClose,function(e){return l.escapeClose=!!e}),this.$scope.$watch(function(){return l.isOpen},this.watcherIsOpen)}return t.prototype.toggle=function(){this.isOpen=!this.isOpen},t.prototype.focusToggleElement=function(){this.toggleElement&&this.toggleElement[0].focus()},t.prototype.open=function(){this.escapeClose&&this.$document.bind("keydown",this.escapeKeyBind),this.externalClose&&this.$document.bind("click",this.closeDropdown)},t.prototype.close=function(){this.escapeClose&&this.$document.unbind("keydown",this.escapeKeyBind),this.externalClose&&this.$document.unbind("click",this.closeDropdown)},t.$inject=["$scope","$timeout","$attrs","$parse","$animate","$element","$document",e.ServiceNames.Hook],t}();t.PortailDropdownController=i,e.app.controller("PortailDropdownController",i)}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){return{restrict:"A",controller:"PortailDropdownController"}};i.$inject=[],e.app.directive("pmDropdown",i);var n=function(){return{require:"^pmDropdown",link:function(e,t,i,n){n.toggleElement=t;var r=function(r){r.preventDefault(),t.hasClass("disabled")||i.disabled||e.$apply(function(){return n.toggle()})};t.bind("click",r),t.attr({"aria-haspopup":!0,"aria-expanded":!1}),e.$watch(function(){return n.isOpen},function(e){t.attr("aria-expanded",!!e+"")}),e.$on("$destroy",function(){t.unbind("click",r)})}}};n.$inject=[],e.app.directive("pmDropdownToggle",n)}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){var n;!function(n){"use strict";var r=function(){function n(e,t,i,n,r,o){var a=this;this.$scope=e,this.$timeout=t,this.$element=i,this.notificationService=n,this.logger=r,this.preferenceService=o,this.CONTENEUR_FAVORIS_ID="conteneur-favoris",this.boutonActionSettings={id:"btn-gerer-favoris",libelle:function(){return"Gérer mes favoris"},modele:"secondaire",rightAlign:!0,mouseOver:!0,width:"20rem"},this.boutonAjouterSettings={titre:function(){return"Ajouter"},icone:function(){return"itce-plus"},onAction:function(){return a.basculerModeAjout()}},this.initConfigTuiles(),this.initDragDrops(),this.$scope.$watch(function(){return a.settings.userPreferences.vueStore},function(){return a.setHeight()}),this.$scope.$watch(function(){return a.settings.heights},function(){return a.setHeight()})}return Object.defineProperty(n.prototype,"isMaxView",{get:function(){return 1===this.settings.userPreferences.vueStore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isMinView",{get:function(){return 2===this.settings.userPreferences.vueStore},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"favoris",{get:function(){var e=this;return _.filter(this.settings.favoriList.getFavorisActifsByContexte(this.settings.contexteLancement),function(t){return 0===t.type?!0:_.some(e.settings.applicationList.applications,function(e){return e.codeApplication===t.codeApplication})})},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isEdition",{get:function(){return 2===this.mode},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isAjout",{get:function(){return 1===this.mode},enumerable:!0,configurable:!0}),n.prototype.toggleView=function(){this.settings.userPreferences.vueStore=1===this.settings.userPreferences.vueStore?0:1,this.preferenceService.writeUserPreferences(this.settings.userPreferences),this.setHeight()},n.prototype.setHeight=function(){var e=this;this.$timeout(function(){var t=e.$element[0].querySelector("#"+e.CONTENEUR_FAVORIS_ID);t.style.maxHeight=e.settings.heights.favorisMaxHeight+"px",e.$timeout(function(){return e.settings.heights.favorisHeight=t.clientHeight})})},n.prototype.gerer=function(){this.onStartEdition({mode:2})},n.prototype.basculerModeAjout=function(){this.onStartEdition({mode:1})},n.prototype.annuler=function(){this.onCancelEdition()},n.prototype.enregistrer=function(){this.onUpdate()},n.prototype.afficherAide=function(){e.core.PopupUtils.openMaxSize("http://myway-dua.sigcesie.caisse-epargne.fr:6080/version2/myway.portail.lib-portail/aide-favoris.pdf","Aide")},n.prototype.startFavori=function(e){0===e.type?this.onStartLien({lien:e.lien}):this.onStartApplication({application:e.application})},n.prototype.supprimerFavori=function(e){e.statut=3,0!==e.type||_.some(this.settings.favoriList.favorisLien,function(t){return t.idLien===e.idLien&&3!==t.statut})||(this.logger.trace("suppression du lien",e.lien.titre),this.settings.lienList.removeById(e.idLien))},n.prototype.moveLeft=function(e,t){this.settings.favoriList.swapFavoris(this.favoris[t],this.favoris[t-1])},n.prototype.moveRight=function(e,t){this.settings.favoriList.swapFavoris(this.favoris[t],this.favoris[t+1])},n.prototype.onDropAjout=function(e,t){var i,n=this.settings.lienList.getById(e),r=this.settings.applicationList.getByCodeApplication(e);if(i=n?this.settings.favoriList.createFavoriLien(n.id,this.settings.contexteLancement,n):this.settings.favoriList.createFavoriApplication(r.codeApplication,this.settings.contexteLancement,r),t===this.CONTENEUR_FAVORIS_ID)this.settings.favoriList.items.push(i);else{var o=this.settings.favoriList.getById(t);this.settings.favoriList.insertBefore(i,o)}this.onUpdate(),this.notificationService.showNotification("Le nouveau favori a été enregistré")},n.prototype.onDropSuppression=function(e){var t=this.settings.favoriList.getById(e);this.supprimerFavori(t),0===this.mode&&(this.onUpdate(),this.notificationService.showNotification("Le favori a été supprimé"))},n.prototype.onDropDeplace=function(e,t){var i=this.settings.favoriList.getById(e),n=this.settings.favoriList.getById(t);this.settings.favoriList.movePositionBefore(i,n),0===this.mode&&this.onUpdate()},n.prototype.initConfigTuiles=function(){var e=this,t=(new Date).getTime(),n={dropTargetMarkerClass:i.tuile.DROP_TARGET_MARKER_CLASS,drops:{}};n.drops[i.applicationsFavoris.DragDropId.CATALOGUE]={onDropAction:function(t,i){return e.onDropAjout(t,i)},disableOnDrag:function(t){var i=e.settings.applicationList.getByCodeApplication(t),n=e.settings.favoriList.getByOrigineAndIdAndContexte(i.origine,i.codeApplication,e.settings.contexteLancement);return!!n}},n.drops[i.applicationsFavoris.DragDropId.FAVORIS]={onDropAction:function(t,i){return e.onDropDeplace(t,i)}},this.tuilePersoConfig={taille:0,titre:function(t){return 0===t.type?t.lien.titre:t.application.getLibelleProcessus(e.settings.zone)},texteMarquage:function(e){return e.timestampFinNouveaute>t?"nouveau":""},iconeBottomLeft:function(e){return 1===e.type&&e.application.isFavoriMetier?"itce-thumb-up":""},iconeBottomRight:function(t){return i.applicationsFavoris.ApplicationUtils.getIconeContexteLancementApplicationByZone(t.application,e.settings.zone)},couleur:"couleur-rouge",isFaded:function(t){return 1===t.type&&(e.settings.applicationList.fadeApplication(t.application)||!!i.applicationsFavoris.ApplicationUtils.getIconeContexteLancementApplicationByZone(t.application,e.settings.zone))},onAction:function(t){return e.startFavori(t)},isEdition:function(){return e.isEdition},action2:{icone:function(e){return"itce-trash"},libelle:function(e){return"Retirer des favoris"},action:function(t){return e.supprimerFavori(t)}},actionGauche:{icone:function(e){return"itce-arrow-left"},libelle:function(e){return"Déplacer à gauche"},visible:function(e,t){return t>0},action:function(t,i){return e.moveLeft(t,i)}},actionDroite:{icone:function(e){return"itce-arrow-right"},libelle:function(e){return"Déplacer à droite"},visible:function(t,i){return i<e.settings.favoriList.favorisActifs.length-1},action:function(t,i){return e.moveRight(t,i)}},dragDropSettings:{dragSettings:{id:i.applicationsFavoris.DragDropId.FAVORIS},dropsSettings:n,dataId:function(e){return e.id}}}},n.prototype.initDragDrops=function(){var e=this;this.conteneurFavorisDropsSettings={cibleId:function(){return e.CONTENEUR_FAVORIS_ID},dropTargetMarkerClass:i.tuile.DROP_TARGET_MARKER_CLASS,drops:{}},this.conteneurFavorisDropsSettings.drops[i.applicationsFavoris.DragDropId.CATALOGUE]={onDropAction:function(t,i){return e.onDropAjout(t,i)},disableOnDrag:function(t){var i=e.settings.applicationList.getByCodeApplication(t),n=e.settings.favoriList.getByOrigineAndIdAndContexte(i.origine,i.codeApplication,e.settings.contexteLancement);return!!n}},this.corbeilleDropsSettings={cibleId:function(){return"corbeille"},dropTargetMarkerClass:i.tuile.DROP_TARGET_MARKER_CLASS,dropTargetMouseOverClass:"icon-drop-mouseover",drops:{}},this.corbeilleDropsSettings.drops[i.applicationsFavoris.DragDropId.FAVORIS]={onDropAction:function(t){return e.onDropSuppression(t)},disableOnDrag:function(){return e.isEdition}}},n.$inject=["$scope","$timeout","$element","MwNotificationService",e.core.ServiceNames.Logger,t.ServiceNames.Preference],n}();n.FavorisControleur=r}(n=i.favoris||(i.favoris={}))}(i=t.ui||(t.ui={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){return{restrict:"E",require:"^portailApplicationsFavoris",templateUrl:"typescript/directives/favoris/favoris.html",controller:t.FavorisControleur,controllerAs:"ctrl",bindToController:!0,scope:{settings:"=",mode:"=",onStartApplication:"&",onStartLien:"&",onStartEdition:"&?",onCancelEdition:"&?",onUpdate:"&?"}}};i.$inject=[],e.app.directive("portailFavoris",i)}(i=t.favoris||(t.favoris={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,i,n,r){this.$scope=e,this.$timeout=t,this.$element=i,this.$attrs=n,this.modalService=r}return e.prototype.voirErreur=function(){this.erreur&&this.modalService.showErreur(MyWay.UI.TYPE_POPUP_ERREUR.NON_BLOQUANT,"",JSON.stringify(this.erreur))},e.$inject=["$scope","$timeout","$element","$attrs","modalService"],e}();e.IconeStatutControleur=t}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){return{restrict:"E",templateUrl:"typescript/directives/icone-statut/icone-statut.html",controller:t.IconeStatutControleur,controllerAs:"ctrl",bindToController:!0,scope:{value:"=",erreur:"="}}};i.$inject=[],e.app.directive("portailIconeStatut",i)}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,n){var r=this;this.$scope=e,this.$timeout=t,this.$element=i,this.$attrs=n,this.$scope.$watch(function(){return r.settings},function(){return r.initSettings()}),this.initSettings()}return Object.defineProperty(t.prototype,"titre",{get:function(){return this.settings.titre(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texteMarquage",{get:function(){return this.settings.texteMarquage(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bordureMarquage",{get:function(){return this.settings.bordureMarquage(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iconeMarquage",{get:function(){return this.settings.iconeMarquage(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iconeTopRight",{get:function(){return this.settings.iconeTopRight(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iconeBottomLeft",{get:function(){return this.settings.iconeBottomLeft(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iconeBottomRight",{get:function(){return this.settings.iconeBottomRight(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMarked",{get:function(){return!!this.texteMarquage||!!this.iconeMarquage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFaded",{get:function(){return this.settings.isFaded(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootClasses",{get:function(){var e=["pm-tuile-root","no-edition","pm-tuile-md"];return e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonClasses",{get:function(){var e=["pm-tuile-main-button",this.settings.couleur];return this.isFaded&&e.push("tuile-faded"),this.bordureMarquage&&this.isMarked&&e.push("pm-tuile-avec-marquage"),e},enumerable:!0,configurable:!0}),t.prototype.onMainAction=function(){this.settings.onAction(this.data,this.index)},t.prototype.onBoutonAction=function(e){e.onAction(this.data,this.index)},t.prototype.initSettings=function(){this.settings.couleur=this.settings.couleur||"couleur-defaut",this.settings.taille=this.settings.taille||0,this.settings.iconeMarquage=this.settings.iconeMarquage||function(){return""},this.settings.texteMarquage=this.settings.texteMarquage||function(){return""},this.settings.bordureMarquage=this.settings.bordureMarquage||function(){return!0},this.settings.iconeTopRight=this.settings.iconeTopRight||function(){return""},this.settings.iconeBottomLeft=this.settings.iconeBottomLeft||function(){return""},this.settings.iconeBottomRight=this.settings.iconeBottomRight||function(){return""},this.settings.isFaded=this.settings.isFaded||function(){return!1},this.settings.onAction=this.settings.onAction||function(){},this.initDragDrop()},t.prototype.initDragDrop=function(){var e=this.settings.dragDropSettings;e&&(e.dragSettings&&this.initDrag(e),e.dropsSettings&&this.initDrops(e))},t.prototype.initDrag=function(e){var t=this;this.dragSettings=angular.copy(e.dragSettings),this.dragSettings.disable=function(){return e.isDisabled&&e.isDisabled(t.data)},e.dataId&&!this.dragSettings.sourceId&&(this.dragSettings.sourceId=function(){return e.dataId(t.data)})},t.prototype.initDrops=function(t){var i=this;this.dropsSettings=angular.copy(t.dropsSettings),this.dropsSettings.dropTargetMarkerClass=this.dropsSettings.dropTargetMarkerClass||e.DROP_TARGET_MARKER_CLASS,t.dataId&&!this.dropsSettings.cibleId&&(this.dropsSettings.cibleId=function(){return t.dataId(i.data)})},t.$inject=["$scope","$timeout","$element","$attrs"],t}();e.TuileControleur=t}(t=e.tuile||(e.tuile={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){return{restrict:"E",templateUrl:"typescript/directives/tuile/tuile.html",controller:t.TuileControleur,controllerAs:"ctrl",bindToController:!0,scope:{id:"@",settings:"=",data:"=",index:"=?",onAction:"&?",onActionEdition:"&?",onActionBackdrop:"&",onAction1:"&?",onAction2:"&?",onAction3:"&?",onAction4:"&?",onActionGauche:"&?",onActionDroite:"&?"}}};i.$inject=[],e.app.directive("pmTuile",i)}(i=t.tuile||(t.tuile={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";e.DROP_TARGET_MARKER_CLASS="pm-tuile-drop-target-marker"}(t=e.tuile||(e.tuile={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){var i;!function(t){"use strict";var i=function(){function t(e,t){this.$scope=e,this.logger=t}return t.prototype.selectItem=function(e){this.logger.trace("selectItem",this.settings.itemSettings.id(e),this.settings.itemSettings.libelle(e),e),e!==this.settings.activeItem&&(this.settings.activeItem=e,this.settings.itemSettings.action&&this.settings.itemSettings.action(e))},t.prototype.getIdItem=function(e){return this.settings.itemSettings.id(e)},t.prototype.getLibelleItem=function(e){return this.settings.itemSettings.libelle(e)},t.prototype.isItemActive=function(e){return e===this.settings.activeItem},t.$inject=["$scope",e.core.ServiceNames.Logger],t}();t.TotemNavigationControleur=i}(i=t.navigation||(t.navigation={}))}(i=t.ui||(t.ui={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){return{restrict:"E",templateUrl:"typescript/directives/totem-navigation/totem-navigation.html",controller:t.TotemNavigationControleur,controllerAs:"ctrl",bindToController:!0,scope:{settings:"="}}};i.$inject=[],e.app.directive("pmTotemNavigation",i)}(i=t.navigation||(t.navigation={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,i,n){var r=this;this.$scope=e,this.$timeout=t,this.$element=i,this.$attrs=n,this.$scope.$watch(function(){return r.settings},function(){r.settings.taille=r.settings.taille||0})}return Object.defineProperty(e.prototype,"titre",{
get:function(){return this.settings.titre()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icone",{get:function(){return this.settings.icone?this.settings.icone():void 0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonClasses",{get:function(){var e=["pm-tuile-main-button","couleur-vert"];return 1===this.settings.taille?e.push("pm-tuile-lg"):e.push("pm-tuile-md"),e},enumerable:!0,configurable:!0}),e.$inject=["$scope","$timeout","$element","$attrs"],e}();e.TuileActionControleur=t}(t=e.tuile||(e.tuile={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){return{restrict:"E",templateUrl:"typescript/directives/tuile-action/tuile-action.html",controller:t.TuileActionControleur,controllerAs:"ctrl",bindToController:!0,scope:{id:"@",settings:"="}}};i.$inject=[],e.app.directive("pmTuileAction",i)}(i=t.tuile||(t.tuile={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.tuile||(e.tuile={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,i,n){var r=this;this.$scope=e,this.$timeout=t,this.$element=i,this.$attrs=n,this.$scope.$watch(function(){return r.settings},function(){return r.initSettings()}),this.initSettings()}return Object.defineProperty(t.prototype,"titre",{get:function(){return this.settings.titre(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"texteMarquage",{get:function(){return this.settings.texteMarquage(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bordureMarquage",{get:function(){return this.settings.bordureMarquage(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iconeMarquage",{get:function(){return this.settings.iconeMarquage(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iconeTopRight",{get:function(){return this.settings.iconeTopRight(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iconeBottomLeft",{get:function(){return this.settings.iconeBottomLeft(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"iconeBottomRight",{get:function(){return this.settings.iconeBottomRight(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isBackdropAction",{get:function(){return"function"==typeof this.settings.onActionBackdrop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isMarked",{get:function(){return!!this.texteMarquage||!!this.iconeMarquage},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isFaded",{get:function(){return this.settings.isFaded(this.data,this.index)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"rootClasses",{get:function(){var e=["pm-tuile-root"];return e.push(this.settings.isEdition()?"edition":"no-edition"),1===this.settings.taille?e.push("pm-tuile-lg"):e.push("pm-tuile-md"),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"buttonClasses",{get:function(){var e=["pm-tuile-main-button",this.settings.couleur];return this.isFaded&&e.push("tuile-faded"),this.bordureMarquage&&this.isMarked&&e.push("pm-tuile-avec-marquage"),this.settings.isEdition()&&e.push("edition"),e},enumerable:!0,configurable:!0}),t.prototype.onClickBackdrop=function(){"function"==typeof this.settings.onActionBackdrop&&this.settings.onActionBackdrop(this.data,this.index)},t.prototype.onMainAction=function(){this.settings.isEdition()?this.settings.onActionEdition(this.data,this.index):this.settings.onAction(this.data,this.index)},t.prototype.onBoutonAction=function(e){e.onAction(this.data,this.index)},t.prototype.initSettings=function(){this.settings.isEdition=this.settings.isEdition||function(){return!1},this.settings.backdrop=!!this.settings.backdrop,this.settings.backdropOpacity=!!this.settings.backdropOpacity,this.settings.couleur=this.settings.couleur||"couleur-defaut",this.settings.taille=this.settings.taille||0,this.settings.iconeMarquage=this.settings.iconeMarquage||function(){return""},this.settings.texteMarquage=this.settings.texteMarquage||function(){return""},this.settings.bordureMarquage=this.settings.bordureMarquage||function(){return!0},this.settings.iconeTopRight=this.settings.iconeTopRight||function(){return""},this.settings.iconeBottomLeft=this.settings.iconeBottomLeft||function(){return""},this.settings.iconeBottomRight=this.settings.iconeBottomRight||function(){return""},this.settings.isFaded=this.settings.isFaded||function(){return!1},this.initDragDrop(),this.initActions()},t.prototype.initActions=function(){var e=this;this.boutonsActions=[],this.settings.onAction=this.settings.onAction||function(){},this.settings.onActionEdition=this.settings.onActionEdition||function(){},this.settings.action1&&this.boutonsActions.push({id:this.id+"-action-1",libelle:function(){return e.settings.action1.libelle(e.data,e.index)},cssClass:function(){return"pm-tuile-bouton-action pm-tuile-action1 icon "+e.settings.action1.icone(e.data,e.index)},visible:this.settings.action1.visible||function(){return!0},onAction:this.settings.action1.action||function(){}}),this.settings.action2&&this.boutonsActions.push({id:this.id+"-action-2",libelle:function(){return e.settings.action2.libelle(e.data,e.index)},cssClass:function(){return"pm-tuile-bouton-action pm-tuile-action2 icon "+e.settings.action2.icone(e.data,e.index)},visible:this.settings.action2.visible||function(){return!0},onAction:this.settings.action2.action||function(){}}),this.settings.action3&&this.boutonsActions.push({id:this.id+"-action-3",libelle:function(){return e.settings.action3.libelle(e.data,e.index)},cssClass:function(){return"pm-tuile-bouton-action pm-tuile-action3 icon "+e.settings.action3.icone(e.data,e.index)},visible:this.settings.action3.visible||function(){return!0},onAction:this.settings.action3.action||function(){}}),this.settings.action4&&this.boutonsActions.push({id:this.id+"-action-4",libelle:function(){return e.settings.action4.libelle(e.data,e.index)},cssClass:function(){return"pm-tuile-bouton-action pm-tuile-action4 icon "+e.settings.action4.icone(e.data,e.index)},visible:this.settings.action4.visible||function(){return!0},onAction:this.settings.action4.action||function(){}}),this.settings.actionGauche&&this.boutonsActions.push({id:this.id+"-action-gauche",libelle:function(){return e.settings.actionGauche.libelle(e.data,e.index)},cssClass:function(){return"pm-tuile-bouton-action pm-tuile-action-gauche icon "+e.settings.actionGauche.icone(e.data,e.index)},visible:this.settings.actionGauche.visible||function(){return!0},onAction:this.settings.actionGauche.action||function(){}}),this.settings.actionDroite&&this.boutonsActions.push({id:this.id+"-action-droite",libelle:function(){return e.settings.actionDroite.libelle(e.data,e.index)},cssClass:function(){return"pm-tuile-bouton-action pm-tuile-action-droite icon "+e.settings.actionDroite.icone(e.data,e.index)},visible:this.settings.actionDroite.visible||function(){return!0},onAction:this.settings.actionDroite.action||function(){}})},t.prototype.initDragDrop=function(){var e=this.settings.dragDropSettings;e&&(e.dragSettings&&this.initDrag(e),e.dropsSettings&&this.initDrops(e))},t.prototype.initDrag=function(e){var t=this;this.dragSettings=angular.copy(e.dragSettings),this.dragSettings.disable=function(){return e.isDisabled&&e.isDisabled(t.data)},e.dataId&&!this.dragSettings.sourceId&&(this.dragSettings.sourceId=function(){return e.dataId(t.data)})},t.prototype.initDrops=function(t){var i=this;this.dropsSettings=angular.copy(t.dropsSettings),this.dropsSettings.dropTargetMarkerClass=this.dropsSettings.dropTargetMarkerClass||e.DROP_TARGET_MARKER_CLASS,t.dataId&&!this.dropsSettings.cibleId&&(this.dropsSettings.cibleId=function(){return t.dataId(i.data)})},t.$inject=["$scope","$timeout","$element","$attrs"],t}();e.TuileEditableControleur=t}(t=e.tuile||(e.tuile={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){return{restrict:"E",templateUrl:"typescript/directives/tuile-editable/tuile-editable.html",controller:t.TuileEditableControleur,controllerAs:"ctrl",bindToController:!0,scope:{id:"@",settings:"=",data:"=",index:"=?",onAction:"&?",onActionEdition:"&?",onActionBackdrop:"&",onAction1:"&?",onAction2:"&?",onAction3:"&?",onAction4:"&?",onActionGauche:"&?",onActionDroite:"&?"}}};i.$inject=[],e.app.directive("pmTuileEditable",i)}(i=t.tuile||(t.tuile={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.tuile||(e.tuile={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.SYNTHESE_CLIENT_PART="SYNTH_PART",e.SYNTHESE_CLIENT_PM="SYNTH_PM",e.SYNTHESE_VARIO="VARIO",e}();e.ContexteLancement=t}(t=e.lanceur||(e.lanceur={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){var n;!function(i){"use strict";var n=function(){function n(e,t,i,n){this.$scope=e,this.$q=t,this.$element=i,this.portailService=n,this.voletOuvert=!1}return n.prototype.debrancherApplication=function(t){this.contexte===i.ContexteLancement.SYNTHESE_CLIENT_PART?t&&t.paramsLisa&&this.portailService.lancerProcessusClient({codeProcessus:t.codeProcessus,initData:new e.portail.api.ParamLisa(t.paramsLisa)}):this.onStartApplication(t)},n.$inject=["$scope","$q","$element",t.ServiceNames.Portail],n}();i.VoletLancementMultiple=n,t.app.controller("VoletLancementMultiple",n)}(n=i.lanceur||(i.lanceur={}))}(i=t.ui||(t.ui={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){var i;!function(t){"use strict";var i=function(){return{restrict:"E",templateUrl:"typescript/directives/volet-lancement-multiple/volet-lancement-multiple-vue.html",controller:t.VoletLancementMultiple,controllerAs:"ctrl",bindToController:!0,scope:{voletOuvert:"=",tabIndex:"=",donneesProcessus:"=",contexte:"=",onStartApplication:"&"}}};i.$inject=[],e.app.directive("voletLancementMultiple",i)}(i=t.lanceur||(t.lanceur={}))}(t=e.ui||(e.ui={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.favori||(e.favori={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function i(e,t,i,n){this.$q=e,this.$filter=t,this.agentService=i,this.preferenceService=n}return i.prototype.getUserFavoris=function(){return this.getUserCategories().then(function(e){return _.chain(e).map(function(e){return e.listeFavori}).flatten().value()})},i.prototype.getUserCategories=function(){var e=this;return this.agentService.getAuthentificationInfo().then(function(t){return e.searchFavorites({codeEtablissement:t.codeEtablissement,typePosteFonctionnel:t.agentConnecte.typeFonction})})},i.prototype.searchFavorites=function(t){var i=this;return this.agentService.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portailmyway-v1/rechercheFavori",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:t}).then(function(e){return _.sortBy(e,function(e){return e.numeroPosition})})["catch"](function(t){return 404===t.codeHttp?[]:i.$q.reject(new e.core.ErreurMyway("Erreur technique lors de la recherche des applications",t))})},i.prototype.getCategorie=function(e){return this.getUserCategories().then(function(t){return _.find(t,function(t){return t.codeCategorie===e})})},i.$inject=["$q","$filter",e.core.ServiceNames.Agent,t.ServiceNames.Preference],i}();i.FavoriMetierService=n,t.app.service(t.ServiceNames.FavoriMetier,n)}(i=t.favori||(t.favori={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.favori||(e.favori={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function i(e,t,i,n,r,o){this.$q=e,this.modalService=t,this.notificationService=i,this.logger=n,this.favoriInstance=r,this.migrationService=o}return i.prototype.getList=function(){return this.favoriInstance.getList()},i.prototype.resetFavorisApplication=function(){var e=this;return this.modalService.showConfirm({actionButtonText:"Oui",closeButtonText:"Non",headerText:"Confirmation de la réinitialisation de mes favoris",bodyText:"Êtes-vous sûr de vouloir réinitialiser vos favoris ?<br/>Vos liens personnels seront conservés et les applications préconisées par votre établissement seront remises en favoris.<br/>Attention, cette action est irréversible !",iconName:"itce-question",size:"md"}).then(function(){return e.getList()}).then(function(t){return t.removeBy(function(e){return 1===e.type}),e.favoriInstance.write()}).then(function(){e.notificationService.showNotification("Vos favoris ont été réinitialisé")})},i.prototype.write=function(){return this.favoriInstance.write()},i.prototype.logFavoris=function(){this.migrationService.logPreferences()},i.$inject=["$q","modalService","MwNotificationService",e.core.ServiceNames.Logger,t.ServiceNames.FavoriPersoV2,t.ServiceNames.MigrationPreference1811],i}();i.FavoriPersoService=n,t.app.service(t.ServiceNames.FavoriPerso,n)}(i=t.favori||(t.favori={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.load=function(){var e=this;return this.loadPromise||(this.loadPromise=this.read().then(function(t){e.itemContainer=new r(t)})),this.loadPromise},t}(t.preference.PreferenceInstance);i.LienInstance=n;var r=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),i.prototype.getByUrl=function(e){return _.find(this.items,function(t){return t.url===e})},i.prototype.addLien=function(e,t,i){var n=this.createLien(e,t);return n.id=i||n.id,this.items.push(n),n},i.prototype.createLien=function(e,t){var i={id:void 0,titre:e,url:t,statut:4};return this.generateItemId(i),i},i.prototype.generateItemId=function(t){t.id=e.core.Utils.generateUUID()},i}(t.modele.ItemList);i.LienList=r}(i=t.lien||(t.lien={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(t){function i(e,i){t.call(this,e,i),this.$q=e,this.preferenceService=i,this.PREFERENCE_KEY="portail.liens"}return __extends(i,t),i.prototype.read=function(){return t.prototype.read.call(this).then(function(e){return _.sortBy(e,function(e){return e.titre})})},i.prototype.createDTO=function(e){var t={id:e.id,titre:e.titre,url:e.url,containerPortail:e.containerPortail,statut:1};return t},i.prototype.createObjectPreference=function(e){var t={id:e.id,titre:e.titre,url:e.url,containerPortail:e.containerPortail};return t},i.$inject=["$q",e.ServiceNames.Preference],i}(t.LienInstance);t.LienInstanceV1=i,e.app.service(e.ServiceNames.LienV1,i)}(t=e.lien||(e.lien={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(t){"use strict";var i=function(){function t(t,i,n){this.$modalInstance=t,this.erreurService=i,this.lien=n,this.isAjout=4===this.lien.statut,this.isAjout&&(this.lien.containerPortail="N"),this.urlRegexp=e.core.CommonRegExp.URL}return Object.defineProperty(t.prototype,"titre",{get:function(){return this.isAjout?"Ajouter un lien personnel":"Modifier un lien personnel"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"labelBoutonValider",{get:function(){return"Valider"},enumerable:!0,configurable:!0}),t.prototype.afficherAide=function(){e.core.PopupUtils.openMaxSize("http://myway-dua.sigcesie.caisse-epargne.fr:6080/version2/myway.portail.lib-portail/aide-appli-perso.pdf","Aide")},t.prototype.valider=function(){this.$modalInstance.close(this.lien)},t.$inject=["$modalInstance",e.core.ServiceNames.Erreur,"lien"],t}();t.ModaleEditerLienControleur=i}(i=t.lien||(t.lien={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){function e(e){this.agentService=e}return e.prototype.getUrlServiceTelephonie=function(e){var i={codeEtablissement:e};return this.agentService.sendRequest({url:t.Constantes.UrlRest.urlServiceTelephonie,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:i})},e.$inject=[t.Constantes.Services.agentService],e}();t.BoiteOutilService=i,e.app.service(t.Constantes.Services.boiteOutilService,i)}(t=e.Media||(e.Media={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(){function e(e){this.agentService=e}return e.prototype.getMedia=function(e,i){var n={identifiantPersonne:i,codeEtablissement:e};return this.agentService.sendRequest({url:t.Constantes.UrlRest.urlTiersMedia,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:n})},e.prototype.getAdressePostale=function(e,i){var n={idPersonne:i,codeEtablissement:e};return this.agentService.sendRequest({url:t.Constantes.UrlRest.urlETAdresse,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:n})},e.$inject=[t.Constantes.Services.agentService],e}();t.PersonneService=i,e.app.service(t.Constantes.Services.personneService,i)}(t=e.Media||(e.Media={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function i(e,t,i){this.$q=e,this.logger=t,this.favoriV1=i,this.VERSION="v18.03"}return i.prototype.getApplicationContext=function(){var e=new t.application.Context;return this.$q.all([this.favoriV1.getList().then(function(t){return e.favoriList=t})]).then(function(){return e})},i.prototype.logPreferences=function(e){var t=this;return void 0===e&&(e=this.VERSION),this.getApplicationContext().then(function(i){t.logLineSeparator("-"),t.logger.trace("favoris "+e,i.favoriList.items),t.logLineSeparator("-")})},i.prototype.logLineSeparator=function(e){void 0===e&&(e="="),this.logger.trace(Array(151).join(e))},i.$inject=["$q",e.core.ServiceNames.Logger,t.ServiceNames.FavoriPersoV1],i}();i.MigrationPreference1803Service=n,t.app.service(t.ServiceNames.MigrationPreference1803,n)}(i=t.favori||(t.favori={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function i(e,t,i,n,r,o){this.$q=e,this.logger=t,this.preferenceService=i,this.migrationPreference1803=n,this.favoriV2=r,this.lienV1=o,this.VERSION="v18.06",this.ANCIENNE_VERSION="v18.03"}return i.prototype.start=function(e){var t=this;this.logLineSeparator(),this.logger.trace("Migration des préférences utilisateur de la version "+this.ANCIENNE_VERSION+" vers "+this.VERSION);var i,n;return this.$q.all([this.migrationPreference1803.logPreferences(),this.migrationPreference1803.getApplicationContext().then(function(e){return i=e}),this.getApplicationContext().then(function(e){return n=e})]).then(function(){return t.migrerFavoris(i,n)}).then(function(){e.version=1806,t.preferenceService.writeUserPreferences(e),t.logLineSeparator()})},i.prototype.getApplicationContext=function(){var e=new t.application.Context;return this.$q.all([this.favoriV2.getList().then(function(t){return e.favoriList=t}),this.lienV1.getList().then(function(t){return e.lienList=t})]).then(function(){return e})},i.prototype.logPreferences=function(e){var t=this;return void 0===e&&(e=this.VERSION),this.getApplicationContext().then(function(i){t.logLineSeparator("-"),t.logger.trace("favoris application "+e,i.favoriList.favorisApplication),t.logger.trace("favoris lien "+e,i.favoriList.favorisLien),t.logger.trace("liens "+e,i.lienList.items),t.logLineSeparator("-")})},i.prototype.migrerFavoris=function(e,t){return this.migrerFavoriApplications(e,t),this.migrerFavoriLiens(e,t),this.$q.all([this.favoriV2.write(),this.lienV1.write()]).then(function(){})},i.prototype.migrerFavoriApplications=function(t,i){var n=e.core.ArrayUtils.differenceBy(t.favoriList.favorisApplication,i.favoriList.favorisApplication,function(e){return e.codeApplication});n.forEach(function(e){return i.favoriList.addFavoriApplication(e.codeApplication,void 0)}),this.logger.trace("migrerFavoriApplications",n)},i.prototype.migrerFavoriLiens=function(e,t){var i=_.reduce(e.favoriList.favorisLien,function(e,i){return t.lienList.getByUrl(i.idLien)||e.push(i),e},[]);i.forEach(function(e){var i=t.lienList.addLien(e.codeApplication,e.idLien);t.favoriList.addFavoriLien(i.id,void 0)}),this.logger.trace("migrerFavoriLiens",i)},i.prototype.logLineSeparator=function(e){void 0===e&&(e="="),this.logger.trace(Array(151).join(e))},i.$inject=["$q",e.core.ServiceNames.Logger,t.ServiceNames.Preference,t.ServiceNames.MigrationPreference1803,t.ServiceNames.FavoriPersoV2,t.ServiceNames.LienV1],i}();i.MigrationPreference1806Service=n,t.app.service(t.ServiceNames.MigrationPreference1806,n)}(i=t.favori||(t.favori={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function i(e,t,i,n,r){this.$q=e,this.logger=t,this.preferenceService=i,this.favoriV2=n,this.lienV1=r,this.VERSION="v18.11",this.ANCIENNE_VERSION="v18.06"}return i.prototype.start=function(e){var t=this;this.logLineSeparator(),this.logger.trace("Migration des préférences utilisateur de la version "+this.ANCIENNE_VERSION+" vers "+this.VERSION);var i;return this.$q.all([this.logPreferencesAncienneVersion(),this.getApplicationContext().then(function(e){return i=e})]).then(function(){return t.migrerFavoris(i)}).then(function(){e.version=1811,t.preferenceService.writeUserPreferences(e),t.logLineSeparator()})},i.prototype.getApplicationContext=function(){var e=new t.application.Context;return this.$q.all([this.favoriV2.getList().then(function(t){return e.favoriList=t}),this.lienV1.getList().then(function(t){return e.lienList=t})]).then(function(){return e})},i.prototype.logPreferences=function(e){var t=this;return void 0===e&&(e=this.VERSION),this.getApplicationContext().then(function(i){t.logLineSeparator("-"),t.logger.trace("store  - favoris application "+e,i.favoriList.getByContexteAndType(0,1)),t.logger.trace("store  - favoris lien "+e,i.favoriList.getByContexteAndType(0,0)),t.logLineSeparator("-"),t.logger.trace("client - favoris application "+e,i.favoriList.getByContexteAndType(1,1)),t.logger.trace("client - favoris lien "+e,i.favoriList.getByContexteAndType(1,0)),t.logLineSeparator("-"),t.logger.trace("liens "+e,i.lienList.items),t.logLineSeparator("-")})},i.prototype.logPreferencesAncienneVersion=function(e){var t=this;return void 0===e&&(e=this.ANCIENNE_VERSION),this.getApplicationContext().then(function(i){t.logLineSeparator("-"),t.logger.trace("favoris application "+e,i.favoriList.getByContexteAndType(void 0,1)),t.logger.trace("favoris lien "+e,i.favoriList.getByContexteAndType(void 0,0)),t.logLineSeparator("-"),t.logger.trace("liens "+e,i.lienList.items),t.logLineSeparator("-")})},i.prototype.migrerFavoris=function(e){var t=_.filter(e.favoriList.items,function(e){return void 0===e.contexteLancement});return this.logger.trace("migrerFavoris",t),t.forEach(function(t){t.contexteLancement=0,t.statut=5,1===t.type?e.favoriList.addFavoriApplication(t.codeApplication,1):0===t.type&&e.favoriList.addFavoriLien(t.idLien,1)}),this.favoriV2.write()},i.prototype.logLineSeparator=function(e){void 0===e&&(e="="),this.logger.trace(Array(151).join(e))},i.$inject=["$q",e.core.ServiceNames.Logger,t.ServiceNames.Preference,t.ServiceNames.FavoriPersoV2,t.ServiceNames.LienV1],i}();i.MigrationPreference1811Service=n,t.app.service(t.ServiceNames.MigrationPreference1811,n)}(i=t.favori||(t.favori={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(){function i(e,t,i,n,r){this.$q=e,this.logger=t,this.preferenceService=i,this.migrationPreference1806=n,this.migrationPreference1811=r}return i.prototype.check=function(e){var t=this;this.logger.trace("check des préférences de l'utilisateur");var i;return this.preferenceService.getUserPreferences().then(function(e){return i=e,i.version?t.$q.when():t.checkVersion(i)}).then(function(){return t.$q.when().then(function(){return 1803===i.version?t.migrationPreference1806.start(i):void 0}).then(function(){return 1806===i.version?t.migrationPreference1811.start(i):void 0})}).then(function(){return t.logger.trace(Array(151).join("=")),t.logger.trace("preferences",i),t.logger.trace(Array(151).join("=")),e.bindFavoris(),t.migrationPreference1811.logPreferences()})},i.prototype.checkVersion=function(e){var t,i,n=this;return this.$q.all([this.migrationPreference1806.getApplicationContext().then(function(e){return t=e}),this.migrationPreference1811.getApplicationContext().then(function(e){return i=e})]).then(function(){i.favoriList.items.length&&i.favoriList.items[0].contexteLancement?e.version=1811:t.favoriList.items.length?e.version=1806:e.version=1803,n.logger.trace("checkVersion",e.version)})},i.$inject=["$q",e.core.ServiceNames.Logger,t.ServiceNames.Preference,t.ServiceNames.MigrationPreference1806,t.ServiceNames.MigrationPreference1811],i}();i.MigrationPreferenceService=n,t.app.service(t.ServiceNames.MigrationPreference,n)}(i=t.favori||(t.favori={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var i;!function(t){var i;!function(i){"use strict";var n=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.prototype.load=function(){var e=this;return this.loadPromise||(this.loadPromise=this.read().then(function(t){return e.itemContainer=new r(t),e.checkIntegrity()})),this.loadPromise},t}(t.preference.PreferenceInstance);i.FavoriPersoInstance=n;var r=function(t){function i(){t.apply(this,arguments)}return __extends(i,t),Object.defineProperty(i.prototype,"favorisApplication",{get:function(){return _.filter(this.items,function(e){return 1===e.type})},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"favorisLien",{get:function(){return _.filter(this.items,function(e){return 0===e.type})},enumerable:!0,configurable:!0}),Object.defineProperty(i.prototype,"favorisActifs",{get:function(){return _.filter(this.items,function(e){return-1===[3,2,6].indexOf(e.statut)})},enumerable:!0,configurable:!0}),i.prototype.generateItemId=function(t){t.id=e.core.Utils.generateUUID()},i.prototype.getByContexte=function(e){return _.filter(this.items,function(t){return t.contexteLancement===e})},i.prototype.getByContexteAndType=function(e,t){return _.filter(this.items,function(i){return i.contexteLancement===e&&i.type===t})},i.prototype.getFavorisActifsByContexte=function(e){return _.filter(this.favorisActifs,function(t){return t.contexteLancement===e})},i.prototype.getByOrigineAndIdAndContexte=function(e,t,i){return 0===e?this.getByCodeApplicationAndContexte(t,i):this.getByIdLienAndContexte(t,i)},i.prototype.getByCodeApplicationAndContexte=function(e,t,i){return void 0===i&&(i=!1),_.find(this.items,function(n){return n.codeApplication===e&&n.contexteLancement===t&&(-1===[3,2].indexOf(n.statut)||i)})},i.prototype.getByIdLienAndContexte=function(e,t,i){return void 0===i&&(i=!1),_.find(this.items,function(n){return n.idLien===e&&n.contexteLancement===t&&(-1===[3,2].indexOf(n.statut)||i)})},i.prototype.insertBefore=function(e,t){e.position=t.position;for(var i=_.findIndex(this.items,function(e){return e.id===t.id}),n=i;n<this.items.length;n++)this.items[n].position++;this.items.splice(i,0,e)},i.prototype.movePositionBefore=function(e,t){e.position=t.position;var i=this.items.indexOf(e),n=this.items.indexOf(t);this.items.splice(i,1),this.items.splice(n,0,e);for(var r=n+1;r<this.items.length;r++)this.items[r].position=e.position+r-n},i.prototype.addFavoriApplication=function(e,t,i){var n=this.createFavoriApplication(e,t,i);return this.items.push(n),n},i.prototype.removeFavoriApplication=function(e){this.removeBy(function(t){return t.codeApplication===e})},i.prototype.addFavoriLien=function(e,t,i){var n=this.createFavoriLien(e,t,i);return this.items.push(n),n},i.prototype.removeFavoriLien=function(e){this.removeBy(function(t){return t.idLien===e})},i.prototype.toggleFavoriApplication=function(e,t){var i=!1,n=this.getByCodeApplicationAndContexte(e.codeApplication,t,!0);return n?-1!==[3,2].indexOf(n.statut)?(n.statut=1,i=!0):4===n.statut?this.removeFavoriApplication(e.codeApplication):n.statut=3:(this.addFavoriApplication(e.codeApplication,t,e),i=!0),i},i.prototype.toggleFavoriLien=function(e,t){var i=!1,n=this.getByIdLienAndContexte(e.id,t,!0);return n?-1!==[3,2].indexOf(n.statut)?(n.statut=1,i=!0):4===n.statut?this.removeFavoriLien(e.id):n.statut=3:(this.addFavoriLien(e.id,t,e),i=!0),i},i.prototype.createFavoriApplication=function(e,t,i){var n={id:void 0,type:1,statut:4,contexteLancement:t,timestampFinNouveaute:moment().add(1,"days").toDate().getTime(),position:this.getNextAvailablePosition(t),codeApplication:e,application:i};return this.generateItemId(n),n},i.prototype.createFavoriLien=function(e,t,i){var n={id:void 0,type:0,statut:4,contexteLancement:t,timestampFinNouveaute:moment().add(1,"days").toDate().getTime(),position:this.getNextAvailablePosition(t),idLien:e,lien:i};return this.generateItemId(n),n},i.prototype.getNextAvailablePosition=function(e){var t=_.sortBy(this.getByContexte(e),function(e){return e.position}).slice(-1).pop();return t?t.position+1:1},i.prototype.swapFavoris=function(t,i){var n=this.items.indexOf(t),r=this.items.indexOf(i),o=t.position;t.position=i.position,i.position=o,e.core.ArrayUtils.swapItems(this.items,n,r)},i}(t.modele.ItemList);i.FavoriPersoList=r}(i=t.favori||(t.favori={}))}(i=t.api||(t.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(t){function i(e,i){t.call(this,e,i),this.$q=e,this.preferenceService=i,this.PREFERENCE_KEY="portail.favoris"}return __extends(i,t),i.prototype.write=function(){throw"Ecriture désactivée dans les favoris v1"},i.prototype.read=function(){var e=this;return this.preferenceService.readObject(this.PREFERENCE_KEY).then(function(t){var i=_.chain(t).map(function(e){return e}).flatten().map(function(t){return e.createDTO(t)}).sortBy(function(e){return e.position}).value();return i})},i.prototype.createDTO=function(e){var t={id:e.id,type:e.cApp?1:0,statut:1,
contexteLancement:void 0,position:e.p,codeApplication:e.cApp||e.t,idLien:e.l};return t},i.prototype.createObjectPreference=function(e){throw"Ecriture désactivée dans les favoris v1"},i.$inject=["$q",e.ServiceNames.Preference],i}(t.FavoriPersoInstance);t.FavoriPersoInstanceV1=i,e.app.service(e.ServiceNames.FavoriPersoV1,i)}(t=e.favori||(e.favori={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(t){"use strict";var i=function(t){function i(e,i){t.call(this,e,i),this.$q=e,this.preferenceService=i,this.PREFERENCE_KEY="portail.favoris.v2"}return __extends(i,t),i.prototype.read=function(){return t.prototype.read.call(this).then(function(e){return _.sortBy(e,function(e){return e.position})})},i.prototype.createDTO=function(e){var t={id:e.id,type:e.idApplication?1:0,statut:e.statut,contexteLancement:e.contexteLancement,position:e.position,codeApplication:e.idApplication,idLien:e.idLien};return t},i.prototype.createObjectPreference=function(e){var t={id:e.id,statut:e.statut,contexteLancement:e.contexteLancement,position:e.position,idApplication:1===e.type?e.codeApplication:void 0,idLien:e.idLien};return t},i.$inject=["$q",e.ServiceNames.Preference],i}(t.FavoriPersoInstance);t.FavoriPersoInstanceV2=i,e.app.service(e.ServiceNames.FavoriPersoV2,i)}(t=e.favori||(e.favori={}))}(t=e.api||(e.api={}))}(t=e.portail||(e.portail={}))}(myway||(myway={})),angular.module("libPortail").run(["$templateCache",function(e){e.put("typescript/choix-entite-titulaire/selection-entite-titulaire.html",'<div class="modal-header">\r\n    <button type="button" ng-click="ctrl.$modalInstance.dismiss()" class="close" aria-hidden="true" aria-label="Fermeture modale" id="btn-fermer-modale">\r\n        <span class="icon itce-times" aria-hidden="true"></span>\r\n    </button>\r\n    <h3 class="modal-title">Veuillez sélectionner une entité titulaire</h3>\r\n</div>\r\n<div class="modal-body texte-gros row">\r\n    <mw-panel niveau="1" id="panel-entite-titulaire" titre="">\r\n        <div mw-chargement="ctrl.loading">\r\n            <mw-table options="ctrl.tableauOptions" id="tableau-entite-titulaire"></mw-table>\r\n        </div>\r\n    </mw-panel>\r\n</div>\r\n<div class="modal-footer">\r\n    <div class="col-sm-12 col-md-2 pull-right">\r\n        <button id="btn-valider" class="btn btn-primary" ng-disabled="!ctrl.entiteSelectionnee" ng-click="ctrl.valider()">Sélectionner</button>\r\n    </div>\r\n    <div class="col-sm-12 col-md-2 pull-right">\r\n        <button id="btn-annuler" class="btn btn-default" ng-click="ctrl.$modalInstance.dismiss()">Annuler</button>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/media/media.html",'<div class="modal-header">\r\n    <button ng-click="ctrlMedia.closeModale()" class="close" aria-hidden="true" id="btn-close" aria-label="Fermer"><span class="icon itce-times" aria-hidden="true"></span></button>\r\n    <h3 class="modal-title"><span ng-bind="::ctrlMedia.title"></span></h3>\r\n</div>\r\n<div class="modal-body">\r\n    <div ng-if="(ctrlMedia.telephones.length + ctrlMedia.mails.length) > 0">\r\n        <section ng-repeat="tel in ctrlMedia.telephones | orderBy: \'-indicateurPreferenceMedia\':O track by $index" class="row">\r\n            <div class="moyens-contacts">\r\n                <div class="control-label col-sm-4">\r\n                    <span class="icon" ng-class="{\'itce-phone\': !tel.isMobile, \'itce-mobile\' : tel.isMobile}" aria-hidden="true"></span>\r\n                    <span ng-bind="tel.libelle"></span>\r\n                </div>\r\n                <div class="control-label col-sm-2">\r\n                    <span ng-bind="tel.numero"></span>\r\n                </div>\r\n                <div class="col-md-4">\r\n                    <a href="javascript:;" ng-click="ctrlMedia.composerAppel(tel)" id="telephone">\r\n                        <span class="icon itce-outgoing-call" aria-hidden="true"></span>\r\n                    </a>\r\n                </div>\r\n                <span class="col-md-2">\r\n                    <span ng-show="tel.indicateurPreference === \'O\'" class="label label-success">Préféré</span>\r\n                </span>\r\n            </div>\r\n        </section>\r\n        <section ng-repeat="mail in ctrlMedia.mails | orderBy: \'-indicateurPreferenceMedia\':O  track by mail.mail" class="row">\r\n            <div class="form-group moyens-contacts">\r\n                <div class="control-label col-sm-4">\r\n                    <span class="icon itce-enveloppe" aria-hidden="true"></span>\r\n                    <span ng-bind="mail.libelle"></span>\r\n                </div>\r\n                <div class="control-label col-sm-6 label-ref">\r\n                    <a href="mailto:{{mail.mail}}" target="_top" class="line-mail" ng-bind="mail.mail | limitTo:38" ng-attr-id="lien-mail-{{$index}}" aria-label="mailto"></a>\r\n                </div>\r\n                <span class="col-md-2">\r\n                    <span ng-show="mail.indicateurPreference === \'O\'" class="label label-success">Préféré</span>\r\n                </span>\r\n            </div>\r\n        </section>\r\n        <section ng-if="ctrlMedia.adresse" class="row moyens-contacts">\r\n            <div class="form-group moyens-contacts">\r\n                <div class="control-label col-sm-4">\r\n                    <span class="icon itce-home" aria-hidden="true"></span>\r\n                    <span>Adresse principale</span>\r\n                </div>\r\n                <div class="control-label">\r\n                    <span class="col-lg-8 col-md-8 col-sm-8" ng-bind="ctrlMedia.adresse.ligne1adresseAfnor"></span>\r\n                    <span class="col-lg-8 col-md-8 col-sm-8" ng-bind="ctrlMedia.adresse.ligne2adresseAfnor"></span>\r\n                    <span class="col-lg-8 col-md-8 col-sm-8" ng-bind="ctrlMedia.adresse.ligne3adresseAfnor"></span>\r\n                    <span ng-bind="ctrlMedia.adresse.ligne4adresseAfnor" ng-class="{\'col-lg-offset-4 col-md-offset-4 col-sm-offset-4\' : (ctrlMedia.adresse.ligne2adresseAfnor || ctrlMedia.adresse.ligne3adresseAfnor),\r\n                          \'col-lg-6 col-md-6 col-sm-6\' : ctrlMedia.adresse.npai,\r\n                          \'col-lg-8 col-md-8 col-sm-8\' : !ctrlMedia.adresse.npai}"></span>\r\n                    <span class="col-lg-2 col-md-2 col-sm-2" ng-show="ctrlMedia.adresse.npai">\r\n                        <span class="label label-primary">NPAI</span>\r\n                    </span>\r\n                    <span class="col-lg-8 col-lg-offset-4 col-md-offset-4 col-md-8 col-sm-offset-4 col-sm-8" ng-bind="ctrlMedia.adresse.ligne5adresseAfnor"></span>\r\n                    <span class="col-lg-8 col-lg-offset-4 col-md-offset-4 col-md-8 col-sm-offset-4 col-sm-8" ng-bind="ctrlMedia.adresse.ligne6adresseAfnor"></span>\r\n                </div>\r\n\r\n            </div>\r\n        </section>\r\n    </div>\r\n    <div ng-if="(ctrlMedia.telephones.length + ctrlMedia.mails.length) === 0">\r\n        Aucun moyen de contact\r\n    </div>\r\n\r\n</div>\r\n\r\n\r\n'),e.put("typescript/directives/bouton-menu-contextuel/bouton-menu-contextuel.html",'<div class="portail-menu-contextuel dropdown">\r\n    <!-- Bouton -->\r\n    <button class="dropdown-button btn btn-zone badge-notification" ng-attr-id="{{ctrl.settings.id}}" ng-attr-title="{{ctrl.libelle}}" ng-attr-aria-controls="{{::ctrl.settings.id}}-dropdown" ng-disabled="ctrl.settings.disabled()" ng-click="ctrl.settings.ouvert=!ctrl.settings.ouvert">\r\n        <span ng-show="ctrl.icone" ng-aria-label="{{ctrl.libelle}}" ng-attr-class="icon {{ctrl.icone}}"></span>\r\n        <span ng-show="!ctrl.icone || ctrl.settings.showIconAndText" ng-bind="ctrl.libelle"></span>\r\n        <span ng-hide="ctrl.settings.disabled()" aria-hidden="true" class="icon chevron" ng-class="ctrl.settings.ouvert ? \'itce-chevron-up\' : \'itce-chevron-down\'"></span>\r\n        <span class="badge badge-primary top right" ng-show="!!ctrl.settings.compteur" ng-bind="ctrl.settings.compteur()"></span>\r\n    </button>\r\n\r\n    <!-- Menu contextuel -->\r\n    <div ng-attr-class="{{ctrl.MENU_CLASS}} animated" ng-class="{\'top\': ctrl.settings.topDirection, \'right\': ctrl.settings.rightAlign}" ng-attr-id="{{::ctrl.settings.id}}-dropdown" ng-show="ctrl.settings.ouvert">\r\n        <ng-transclude></ng-transclude>\r\n    </div>\r\n</div>'),e.put("typescript/directives/applications-catalogue/applications-catalogue.html",'<div class="panel panel-primary" ng-hide="ctrl.isMinView">\r\n    <div class="panel-heading panel-actif">\r\n        <h2 class="panel-title">\r\n            <span class="icon itce-process-and-application" aria-hidden="true"></span> <span ng-bind="ctrl.titre"></span>\r\n            <a href="javascript:void(0);" class="toggle-view" ng-click="ctrl.toggleView()" id="catalogue-toggle-view" ng-bind="ctrl.isMaxView ? \'Réduire\' : \'Agrandir\'" ng-show="ctrl.isConsultation"></a>\r\n            <button id="btn-astuces-catalogue" class="btn btn-default pull-right" ng-click="ctrl.afficherAide()">\r\n                <span class="icon itce-question" aria-hidden="true" title="Aide"></span>\r\n            </button>\r\n            <button ng-show="ctrl.afficherAppliPerso && !ctrl.isEditionCatalogue" id="btn-gerer-appli-perso" class="btn btn-default" ng-click="ctrl.gererAppliPerso()">\r\n                Gérer mes applications\r\n            </button>\r\n            <button ng-show="ctrl.isEditionCatalogue" id="applications-liens-enregistrer" class="btn btn-primary" ng-click="ctrl.enregistrer()">Enregistrer</button>\r\n            <button ng-show="ctrl.isEditionCatalogue" id="applications-liens-annuler" class="btn btn-default" ng-click="ctrl.annuler()">Annuler</button>\r\n            <button ng-hide="ctrl.isEditionAppliPerso" id="btn-toggle-appli-perso" class="btn btn-default" ng-click="ctrl.toggleAppliPerso()">\r\n                <span ng-hide="ctrl.afficherAppliPerso">Mes applications personnelles</span>\r\n                <span ng-show="ctrl.afficherAppliPerso" class="icon itce-arrow-left" aria-hidden="true"></span> <span ng-show="ctrl.afficherAppliPerso">Retour au catalogue</span>\r\n            </button>\r\n            <span ng-show="ctrl.afficherAppliPerso && !ctrl.isEditionAppliPerso && !ctrl.isAjoutFavoris" class="icon itce-trash icon-drop pull-right" core-drop-target="ctrl.corbeilleDropsSettings" title="Glisser-déposer une application personnelle dessus pour la supprimer"></span>\r\n            <span ng-show="ctrl.afficherAppliPerso && !ctrl.isEditionAppliPerso && !ctrl.isAjoutFavoris" class="icon itce-pencil icon-drop pull-right" core-drop-target="ctrl.editionDropsSettings" title="Glisser-déposer une application personnelle dessus pour la modifier"></span>\r\n        </h2>\r\n    </div>\r\n    <div class="panel-body" ng-class="{\'with-categories-names\': ctrl.searchText && ctrl.afficherCategories}" core-drop-target="ctrl.globalDropsSettings">\r\n        <div class="form-horizontal">\r\n            <div class="form-group" ng-hide="ctrl.afficherAppliPerso">\r\n                <!-- filtres de recherche -->\r\n                <div class="col-md-3 col-lg-3 has-feedback">\r\n                    <input type="text" placeholder="Rechercher" ng-attr-id="{{ ctrl.SEACH_TEXT_ID }}" name="search-text" class="form-control search-text" autocomplete="off" ng-model="ctrl.searchText" ng-minlength="ctrl.searchTextMinLength" ng-model-options="{ debounce: 400 }" ng-change="ctrl.onChangeSearchText()">\r\n                    <span class="btn btn-success form-control-feedback" ng-click="ctrl.clearFilters()">\r\n                        <button class="btn btn-icone icodate sm" id="btn-clear-recherche" title="Effacer"><span class="icon itce-times" aria-hidden="true"></span></button>\r\n                    </span>\r\n                </div>\r\n                <div class="col-md-2 col-lg-1">\r\n                    <p class="form-control-static" ng-bind="ctrl.nombreResultatRecherche"></p>\r\n                </div>\r\n                <div class="col-md-5 col-lg-5">\r\n                    <div class="slide-toggle">\r\n                        <input type="checkbox" id="toggle-categories" name="toggle-categories" ng-model="ctrl.afficherCategories" ng-change="ctrl.onAfficherCategories()">\r\n                        <label for="toggle-categories"></label>\r\n                        <span>Affichage des catégories</span>\r\n                    </div>\r\n                    <div class="slide-toggle" ng-show="ctrl.hasPrecos">\r\n                        <input type="checkbox" id="filtre-precos" name="filtre-precos" ng-model="ctrl.filtrerPrecos" ng-change="ctrl.onFiltrerPrecos()">\r\n                        <label for="filtre-precos"></label>\r\n                        <span>Affichage réduit aux applications préconisées</span>\r\n                        <span class="icon itce-thumb-up" aria-hidden="true"></span>\r\n                    </div>\r\n                </div>\r\n                <div class="col-md-2 col-lg-offset-1 col-lg-2">\r\n                    <span class="sous-titre pull-right" ng-bind="ctrl.libelleCategorieEnCours" ng-show="ctrl.afficherCategories && !ctrl.searchText"></span>\r\n                    <pm-bouton-menu-contextuel settings="ctrl.filtreCategorieSettings" class="pull-right" ng-show="ctrl.afficherCategories && ctrl.searchText">\r\n                        <div class="select-all-categories mw-input-check vertical-alignement">\r\n                            <label for="select-all-categories" id="label-select-all-categories">\r\n                                <input id="select-all-categories" type="checkbox" ng-attr-aria-checked="ctrl.allCategories" ng-click="ctrl.toggleAllCategories()" aria-labelledby="label-select-all-categories">\r\n                                <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\':ctrl.allCategories}"></span>\r\n                                Sélectionner tout\r\n                            </label>\r\n                        </div>\r\n                        <hr>\r\n                        <div ng-repeat="colonne in ctrl.colonnesCategories track by colonne" ng-attr-class="col-md-{{ 12 / ctrl.colonnesCategories.length }}">\r\n                            <div class="mw-input-check filtre-categorie" ng-repeat="ca in ctrl.getCategorieApplicationsParColonne(colonne) track by ca.categorie.codeFamille">\r\n                                <label ng-attr-for="{{ \'categorie-\' + ca.categorie.codeFamille }}" ng-attr-id="{{ \'label-categorie-\' + ca.categorie.codeFamille }}">\r\n                                    <input ng-attr-id="{{ \'categorie-\' + ca.categorie.codeFamille }}" type="checkbox" ng-model="ca.visible" ng-attr-aria-checked="ca.visible" aria-labelledby="{{ \'label-categorie-\' + ca.categorie.codeFamille }}">\r\n                                    <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\':ca.visible}"></span>\r\n                                    <span ng-bind="ca.categorie.libelleFamille"></span>\r\n                                </label>\r\n                            </div>\r\n                        </div>\r\n                    </pm-bouton-menu-contextuel>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <hr class="separateur-filtres" ng-hide="ctrl.afficherAppliPerso">\r\n\r\n        <div ng-attr-id="{{ ctrl.CONTENEUR_CATALOGUE_ID }}" class="conteneur-catalogue">\r\n            <div class="col-md-2" ng-show="ctrl.isTotemNavigation">\r\n                <pm-totem-navigation settings="ctrl.navigationSettings"></pm-totem-navigation>\r\n            </div>\r\n            <div ng-class="ctrl.isTotemNavigation ? \'col-md-10\': \'col-md-12\'" infinite-scroll="ctrl.loadMore()" infinite-scroll-container="\'.conteneur-catalogue\'" infinite-scroll-disabled="ctrl.afficherCategories" infinite-scroll-throttle-milliseconds="200">\r\n                <!-- Applications -->\r\n                <div ng-if="!ctrl.afficherAppliPerso" ng-repeat="ca in ctrl.categorieApplications track by ca.categorie.codeFamille" class="row bloc-catalogue-applications" ng-show="ca.visible">\r\n                    <hr class="separateur-filtres" ng-show="ctrl.searchText && !ctrl.isFirstCategorieAffichee($index)">\r\n                    <div class="categorie" ng-show="ctrl.searchText && ctrl.afficherCategories">\r\n                        <span ng-bind="ca.categorie.libelleFamille"></span> (<span ng-bind="ca.applications.length"></span>)\r\n                    </div>\r\n                    <div ng-repeat="application in ctrl.getApplicationsByCategorie(ca) track by $index">\r\n                        <pm-tuile ng-if="ctrl.isConsultation" ng-attr-id="app-{{ $index }}" settings="ctrl.tuileApplicationConfig" data="application" index="$index"></pm-tuile>\r\n                        <pm-tuile-editable ng-if="ctrl.isAjoutFavoris" ng-attr-id="app-{{ $index }}" settings="ctrl.tuileApplicationConfig" data="application" index="$index"></pm-tuile-editable>\r\n                    </div>\r\n                </div>\r\n\r\n                <!-- Applications personnelles -->\r\n                <div ng-if="ctrl.afficherAppliPerso">\r\n                    <div ng-repeat="application in ctrl.applicationsPersonnelles track by application.codeApplication">\r\n                        <pm-tuile ng-if="!ctrl.isEditionCatalogue" ng-attr-id="app-{{ $index }}" settings="ctrl.tuileAppliPersoConfig" data="application" index="$index"></pm-tuile>\r\n                        <pm-tuile-editable ng-if="ctrl.isAjoutFavoris" ng-attr-id="app-{{ $index }}" settings="ctrl.tuileApplicationConfig" data="application" index="$index"></pm-tuile-editable>\r\n                        <pm-tuile-editable ng-if="ctrl.isEditionAppliPerso" ng-attr-id="app-{{ $index }}" settings="ctrl.tuileAppliPersoConfig" data="application" index="$index"></pm-tuile-editable>\r\n                    </div>\r\n                    <pm-tuile-action id="btn-ajouter-appli-perso" settings="ctrl.boutonAjouterAppliPersoSettings" ng-hide="ctrl.isEditionCatalogue"></pm-tuile-action>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/directives/applications-favoris/applications-favoris.html",'<div>\r\n    <portail-favoris settings="ctrl.favorisSettings" on-start-application="ctrl.startApplication(application)" on-start-lien="ctrl.startLien(lien)" on-start-edition="ctrl.onStartEdition(mode)" on-cancel-edition="ctrl.onCancelEdition()" on-update="ctrl.onUpdate()" mode="ctrl.mode">\r\n    </portail-favoris>\r\n\r\n    <portail-applications-catalogue settings="ctrl.applicationsCatalogueSettings" on-start-application="ctrl.startApplication(application)" on-start-edition="ctrl.onStartEdition(mode)" on-cancel-edition="ctrl.onCancelEdition()" on-update="ctrl.onUpdate()" mode="ctrl.mode">\r\n    </portail-applications-catalogue>\r\n</div>\r\n'),e.put("typescript/directives/favoris/favoris.html",'<div class="panel panel-primary" ng-hide="ctrl.isMinView">\r\n    <div class="panel-heading panel-actif">\r\n        <h2 class="panel-title">\r\n            <span class="icon itce-star couleur-favoris" aria-hidden="true"></span> <span ng-bind="ctrl.settings.titre"></span>\r\n            <a href="javascript:void(0);" class="toggle-view" ng-click="ctrl.toggleView()" id="favoris-toggle-view" ng-bind="ctrl.isMaxView ? \'Réduire\' : \'Agrandir\'" ng-hide="ctrl.isEdition"></a>\r\n            <button id="btn-astuces-favoris" class="btn btn-default" ng-click="ctrl.afficherAide()">\r\n                <span class="icon itce-question" aria-hidden="true" title="Aide"></span>\r\n            </button>\r\n            <button ng-hide="ctrl.isEdition" id="btn-gerer-favori" class="btn btn-default" ng-click="ctrl.gerer()">Gérer mes favoris</button>\r\n            <button ng-show="ctrl.isEdition" id="enregistrer-favoris" class="btn btn-primary" ng-click="ctrl.enregistrer()">Enregistrer</button>\r\n            <button ng-show="ctrl.isEdition" id="annuler-favoris" class="btn btn-default" ng-click="ctrl.annuler()">Annuler</button>\r\n            <span ng-hide="ctrl.isEdition" class="icon itce-trash icon-drop pull-right" core-drop-target="ctrl.corbeilleDropsSettings" title="Glisser-déposer un favori dessus pour le supprimer"></span>\r\n        </h2>\r\n    </div>\r\n    <div ng-attr-id="{{ ctrl.CONTENEUR_FAVORIS_ID }}" class="panel-body conteneur-favoris" core-drop-target="ctrl.conteneurFavorisDropsSettings">\r\n        <div id="favori-list" ng-repeat="favori in ctrl.favoris track by favori.id">\r\n            <pm-tuile ng-if="!ctrl.isEdition" ng-attr-id="fav-{{ favori.id }}" settings="ctrl.tuilePersoConfig" data="favori" index="$index"></pm-tuile>\r\n            <pm-tuile-editable ng-if="ctrl.isEdition" ng-attr-id="fav-{{ favori.id }}" settings="ctrl.tuilePersoConfig" data="favori" index="$index"></pm-tuile-editable>\r\n        </div>\r\n        <pm-tuile-action id="btn-ajouter-favori" settings="ctrl.boutonAjouterSettings" ng-hide="ctrl.isEdition"></pm-tuile-action>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/directives/icone-statut/icone-statut.html",'<div class="portail-icone-statut" ng-class="{\'rotate\': ctrl.value == null}" ng-click="ctrl.voirErreur()">\r\n    <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\': ctrl.value === true, \r\n                  \'itce-times\': ctrl.value === false, \r\n                  \'itce-refresh-circle\': ctrl.value == null,\r\n                  \'pointer\': !!ctrl.erreur}"></span>\r\n</div>\r\n'),e.put("typescript/directives/totem-navigation/totem-navigation.html",'<nav class="totem-accessible" role="navigation">\r\n    <ul class="panel-contextual liste-pages">\r\n        <li ng-repeat="item in ctrl.settings.items track by $index">\r\n            <div class="totem-page totem-page-v2">\r\n                <a ng-attr-id="mw-navigation-page-{{ctrl.getIdItem(item)}}" href="javascript:void(0)" ng-click="ctrl.selectItem(item)" ng-bind="ctrl.getLibelleItem(item)" class="lien-page one-level-totem" ng-class="{ \'pageActive\': ctrl.isItemActive(item) }">\r\n                </a>\r\n            </div>\r\n        </li>\r\n    </ul>\r\n</nav>\r\n'),e.put("typescript/directives/tuile/tuile.html",'<div ng-class="ctrl.rootClasses" core-drop-target="ctrl.dropsSettings">\r\n\r\n    <button ng-class="ctrl.buttonClasses" ng-click="ctrl.onMainAction()" core-draggable="ctrl.dragSettings">\r\n\r\n        <div ng-attr-id="{{ctrl.id}}-conteneur" class="pm-tuile-main-button-container">\r\n            <span ng-show="ctrl.texteMarquage" class="pm-tuile-marqueur pm-tuile-marqueur-texte" ng-bind="ctrl.texteMarquage"></span>\r\n            <span ng-show="ctrl.iconeMarquage" ng-attr-class="pm-tuile-marqueur pm-tuile-marqueur-picto icon {{ctrl.iconeMarquage}}"></span>\r\n            <span ng-show="ctrl.iconeTopRight" ng-attr-class="pm-tuile-corner-icon top-right icon {{ctrl.iconeTopRight}}"></span>\r\n            <span ng-show="ctrl.iconeBottomLeft" ng-attr-class="pm-tuile-corner-icon bottom-left icon {{ctrl.iconeBottomLeft}}"></span>\r\n            <span ng-show="ctrl.iconeBottomRight" ng-attr-class="pm-tuile-corner-icon bottom-right icon {{ctrl.iconeBottomRight}}"></span>\r\n            <span class="pm-tuile-titre" ng-bind="ctrl.titre"></span>\r\n        </div>\r\n    </button>\r\n</div>'),e.put("typescript/directives/tuile-action/tuile-action.html",'<div class="pm-tuile-root no-edition pm-tuile-action" core-drop-target="ctrl.settings.dropsSettings">\r\n    <button ng-class="ctrl.buttonClasses" ng-click="ctrl.settings.onAction()">\r\n        <div class="pm-tuile-main-button-container">\r\n            <span ng-attr-class="pm-tuile-picto icon {{ctrl.icone}}" ng-show="ctrl.icone" aria-hidden="true"></span>\r\n            <span class="pm-tuile-titre-action" ng-bind="ctrl.titre"></span>\r\n        </div>\r\n    </button>\r\n</div>\r\n'),e.put("typescript/directives/tuile-editable/tuile-editable.html",'<div ng-class="ctrl.rootClasses" core-drop-target="ctrl.dropsSettings">\r\n\r\n    <div ng-show="ctrl.settings.isEdition()">\r\n        <div class="pm-tuile-backdrop" ng-class="{ \'backdrop-action\': ctrl.isBackdropAction, \r\n                         \'pm-tuile-backdrop-opacity\': ctrl.settings.backdropOpacity,\r\n                         \'cursor-grab\': !ctrl.isBackdropAction }" ng-show="ctrl.settings.backdrop" core-draggable="ctrl.dragSettings" ng-click="ctrl.onClickBackdrop()"></div>\r\n\r\n        <button ng-repeat="bouton in ctrl.boutonsActions track by bouton.id" ng-attr-id="{{bouton.id}}" ng-show="bouton.visible(ctrl.data, ctrl.index)" ng-attr-class="{{bouton.cssClass()}}" ng-click="ctrl.onBoutonAction(bouton)" aria-describedby="{{ctrl.id}}-conteneur">\r\n            <p class="hide-a11y" aria-live="assertive" ng-bind="bouton.libelle()"></p>\r\n        </button>\r\n    </div>\r\n\r\n    <button ng-class="ctrl.buttonClasses" ng-click="ctrl.onMainAction()" core-draggable="ctrl.dragSettings">\r\n\r\n        <div ng-attr-id="{{ctrl.id}}-conteneur" class="pm-tuile-main-button-container">\r\n            <span ng-show="ctrl.texteMarquage" class="pm-tuile-marqueur pm-tuile-marqueur-texte" ng-bind="ctrl.texteMarquage"></span>\r\n            <span ng-show="ctrl.iconeMarquage" ng-attr-class="pm-tuile-marqueur pm-tuile-marqueur-picto icon {{ctrl.iconeMarquage}}"></span>\r\n            <span ng-show="ctrl.iconeTopRight" ng-attr-class="pm-tuile-corner-icon top-right icon {{ctrl.iconeTopRight}}"></span>\r\n            <span ng-show="ctrl.iconeBottomLeft" ng-attr-class="pm-tuile-corner-icon bottom-left icon {{ctrl.iconeBottomLeft}}"></span>\r\n            <span ng-show="ctrl.iconeBottomRight" ng-attr-class="pm-tuile-corner-icon bottom-right icon {{ctrl.iconeBottomRight}}"></span>\r\n            <span class="pm-tuile-titre" ng-bind="ctrl.titre"></span>\r\n        </div>\r\n    </button>\r\n</div>'),e.put("typescript/directives/volet-lancement-multiple/volet-lancement-multiple-vue.html",'<mw-volet ouvert="ctrl.voletOuvert" position="droite" ng-attr-id="volet-{{ctrl.tabIndex}}" ng-mouseleave="ctrl.voletOuvert = false">\r\n    <div class="volet-contentieux">\r\n        <div class="volet-tuile">\r\n            <ul>\r\n                <li ng-repeat="action in ctrl.donneesProcessus track by $index">\r\n                    <span class="btn btn-block btn-default mw-troncature" ng-attr-id="btn-{{action.nom}}" ng-click="ctrl.debrancherApplication(action)" ng-class="{\'first-btn\': $index == 0}">\r\n                        <span ng-bind="::action.titre"></span>\r\n                    </span>\r\n                </li>\r\n            </ul>\r\n        </div>\r\n    </div>\r\n</mw-volet>'),e.put("typescript/hint/modale-store-catalogue/hint-store.html",'<div class="modal-header">\r\n    <button type="button" ng-click="ctrl.$modalInstance.close()" class="close" aria-hidden="true"><span class="icon itce-times"></span></button>\r\n    <h3 class="modal-title">Le saviez-vous ?</h3>\r\n</div>\r\n<div class="modal-body">\r\n    <ul>\r\n        <li>Les applications peuvent être trouvées via la zone Rechercher ou en affichant les catégories.</li>\r\n    </ul>\r\n</div>\r\n<div class="modal-footer">\r\n    <div class="col-md-offset-9 col-md-3">\r\n        <button id="btn-fermer" class="btn btn-primary" ng-click="ctrl.$modalInstance.close()">Fermer</button>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/hint/modale-store-favori-ajout/store-favori-ajout.html",'<div class="modal-header">\r\n    <button type="button" ng-click="ctrl.$modalInstance.close()" class="close" aria-hidden="true"><span class="icon itce-times"></span></button>\r\n    <h3 class="modal-title">Le saviez-vous ?</h3>\r\n</div>\r\n<div class="modal-body">\r\n    <ul>\r\n        <li>Le store gère le glisser-déposer (ou plus connu sous l\'appellation drag & drop).</li>\r\n        <li>Il peut être utilisé à tout moment, qu\'on soit en édition ou non.</li>\r\n        <li>La zone de dépôt est toujours celle des favoris ainsi que les icônes corbeille et crayon.</li>\r\n        <li>Vous pouvez utiliser le glisser-déposer pour ajouter un favori à partir du catalogue</li>\r\n        <li>Vous pouvez utiliser le glisser-déposer pour réordonner vos favoris.</li>\r\n        <li>Vous pouvez utiliser le glisser-déposer pour supprimer un favori en le déposant sur la corbeille.</li>\r\n        <li>Vous pouvez utiliser le glisser-déposer pour modifier un lien personnel en le déposant sur le crayon.</li>\r\n    </ul>\r\n</div>\r\n<div class="modal-footer">\r\n    <div class="col-md-offset-9 col-md-3">\r\n        <button id="btn-fermer" class="btn btn-primary" ng-click="ctrl.$modalInstance.close()">Fermer</button>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/hint/modale-store-favori/hint-store.html",'<div class="modal-header">\r\n    <button type="button" ng-click="ctrl.$modalInstance.close()" class="close" aria-hidden="true"><span class="icon itce-times"></span></button>\r\n    <h3 class="modal-title">Le saviez-vous ?</h3>\r\n</div>\r\n<div class="modal-body">\r\n    <ul>\r\n        <li>Le store gère le glisser-déposer (ou plus connu sous l\'appellation drag & drop).</li>\r\n        <li>Il peut être utilisé à tout moment, qu\'on soit en édition ou non.</li>\r\n        <li>La zone de dépôt est toujours celle des favoris ainsi que les icônes corbeille et crayon.</li>\r\n        <li>Vous pouvez utiliser le glisser-déposer pour ajouter un favori à partir du catalogue</li>\r\n        <li>Vous pouvez utiliser le glisser-déposer pour réordonner vos favoris.</li>\r\n        <li>Vous pouvez utiliser le glisser-déposer pour supprimer un favori en le déposant sur la corbeille.</li>\r\n        <li>Vous pouvez utiliser le glisser-déposer pour modifier un lien personnel en le déposant sur le crayon.</li>\r\n    </ul>\r\n</div>\r\n<div class="modal-footer">\r\n    <div class="col-md-offset-9 col-md-3">\r\n        <button id="btn-fermer" class="btn btn-primary" ng-click="ctrl.$modalInstance.close()">Fermer</button>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/lien/modale-edition/editer-lien.html",'<div class="modal-header">\r\n    <button type="button" ng-click="ctrl.$modalInstance.dismiss()" class="close">\r\n        <span class="icon itce-times" aria-hidden="true"></span>\r\n        <span class="adobe-blank">Fermer la modale</span>\r\n    </button>\r\n    <h3 class="modal-title" ng-bind="ctrl.titre"></h3>\r\n</div>\r\n<div class="modal-body texte-gros row">\r\n    <form class="form-horizontal" name="formLien" novalidate>\r\n        <div class="form-group">\r\n            <label class="col-md-4 control-label" for="titre-lien">Titre</label>\r\n            <div class="col-md-6">\r\n                <input id="titre-lien" name="titre" type="text" maxlength="100" ng-model="ctrl.lien.titre" class="form-control" autofocus required="true" aria-required="true">\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="col-md-4 control-label" for="url-lien">Url</label>\r\n            <div class="col-md-6">\r\n                <textarea id="url-lien" name="url" rows="5" ng-model="ctrl.lien.url" ng-trim="true" class="form-control" required="true" aria-required="true"></textarea>\r\n                <span class="error-msg col-md-12" ng-show="formLien.url.$error.pattern">L\'url est incorrecte</span>\r\n            </div>\r\n            <div class="col-md-2">\r\n                <button id="btn-astuces-catalogue" class="btn btn-default" ng-click="ctrl.afficherAide()">\r\n                    <span class="icon itce-question" aria-hidden="true" title="Aide"></span>\r\n                </button>\r\n            </div>\r\n        </div>\r\n        <fieldset class="form-group mw-radio-group">\r\n            <legend class="col-md-4 control-label asterisque">Ouvrir l\'url dans le portail</legend>\r\n            <ul class="col-md-6 list-inline">\r\n                <li class="mw-radio-btn">\r\n                    <input id="radio-btn-1" type="radio" name="radio-btn" value="O" ng-model="ctrl.lien.containerPortail">\r\n                    <label for="radio-btn-1">\r\n                        Oui\r\n                    </label>\r\n                </li>\r\n                <li class="mw-radio-btn">\r\n                    <input id="radio-btn-2" type="radio" name="radio-btn" value="N" ng-model="ctrl.lien.containerPortail">\r\n                    <label for="radio-btn-2">\r\n                        Non\r\n                    </label>\r\n                </li>\r\n            </ul>\r\n        </fieldset>\r\n    </form>\r\n</div>\r\n<div class="modal-footer">\r\n    <div class="col-lg-offset-6 col-lg-3 col-md-offset-6 col-md-3">\r\n        <button id="btn-annuler" class="btn btn-default" ng-click="ctrl.$modalInstance.dismiss()">Annuler</button>\r\n    </div>\r\n    <div class="col-lg-3 col-md-3">\r\n        <button id="btn-valider" class="btn btn-primary" ng-disabled="formLien.$invalid" ng-click="ctrl.valider()" ng-bind="ctrl.labelBoutonValider"></button>\r\n    </div>\r\n</div>');
}]);