/**
 * Généré par : SIGCESIE\ct-tfsbuild
 * Changeset TFS : C623100
 * Etiquette TFS : api-segmentation-risque-v21.05-Build_20210721.1
 * Déclenchement : Manual
 */
var myway;!function(e){var t;!function(e){"use strict";e.app=angular.module("myway.apiSegmentationRisque",["myway.ui","ui.bootstrap","moduleAgent"])}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083";e.SEGMENTATION_CLIENTELE=t+"/risqueclient-v1/segmentationClientele",e.DEMANDE_SEGMENTATION=t+"/risqueclientservice-v1/demandeSegmentation",e.CARACTERISTIQUE_AGENT=t+"/agent-v2/caracteristique",e.HISTORIQUE_BILAN=t+"/tierscorporate/v1/histoChiffreAffaire"}(t=e.urlRest||(e.urlRest={}));var n;!function(e){e.SOCIAL="Social",e.CONSOLIDE="Consolidé",e.AUTRE="Autre"}(n=e.typeBilan||(e.typeBilan={})),e.DATE_REST_INVALIDE="0001-01-01"}(t=e.constantes||(e.constantes={}))}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.dto||(e.dto={}))}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.dto||(e.dto={}))}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.dto||(e.dto={}))}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";!function(e){e[e.AUTOMATIQUE="Automatique"]="AUTOMATIQUE",e[e.CALCULEE="Calculée"]="CALCULEE",e[e.FORCEE="Forcée"]="FORCEE",e[e.ASSERVIE="Asservie"]="ASSERVIE",e[e.REPRISE="Reprise"]="REPRISE"}(e.TypeAffectation||(e.TypeAffectation={}));e.TypeAffectation;!function(e){e[e.A="Re-segmentation de masse toutes Caisses"]="A",e[e.X="Re-segmentation de masse par Caisse"]="X",e[e.D="Affectation automatique par défaut (TP)"]="D",e[e.T="Affectation manuelle (TP)"]="T",e[e.G="Affectation par grappage (TP)"]="G"}(e.OrigineAffectation||(e.OrigineAffectation={}));e.OrigineAffectation}(t=e.Enum||(e.Enum={}))}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.model||(e.model={}))}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e}();e.app.controller("mwListGroupController",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";function t(){return{restrict:"E",templateUrl:"typescript/mw-list-group/mw-list-group-vue.html",controller:"mwListGroupController",controllerAs:"mwListGroup",bindToController:!0,scope:{heading:"@?",data:"=",bind:"@",selectedItem:"=?"},link:function(e,t,n){if(!("data"in n))throw new Error("directive mwListGroup: l'attribut data est obligatoire !");if(!("bind"in n))throw new Error("directive mwListGroup: l'attribut bind est obligatoire !")}}}e.app.directive("mwListGroup",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){this.colonneDateExercice={title:"Date d'exercice",bind:"dateFinExercice",filter:" | date: 'dd/MM/yyyy'",cssClass:"col-md-2",disableFilter:!0},this.colonneMontantChiffreAffaires={title:"Chiffre d'affaires",bind:"montantChiffreAffaireExercice",cssClass:"col-md-2",filter:"| currency: 'k€':0",disableFilter:!0},this.colonneDuree={title:"Durée",bind:"dureeExercice + ' mois'",cssClass:"col-md-2",disableFilter:!0},this.colonneType={title:"Type",bind:"typeBilan",cssClass:"col-md-2",disableFilter:!0},this.width="col-md-12 col-lg-12",this.reserve=!1,this.perPage=10,this.multiSelect=!1,this.filterEnable=!0,this.sortEnable=!0,this.moreEnable=!1,this.columns=[this.colonneDateExercice,this.colonneMontantChiffreAffaires,this.colonneDuree,this.colonneType],this.data=[],this.selectedItems=[],this.disabledItems=[],this.templateUrl="",this.caption="Chiffres d'affaires",this.selectionChangeHandler=e}return e}();e.TableauHistoriqueBilans=t}(t=e.Tableaux||(e.Tableaux={}))}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){this.serviceAgent=e,this.srDTOService=t}return t.prototype.sendRequestGetHistoriqueChiffreAffaires=function(t){return this.serviceAgent.sendRequest({url:e.constantes.urlRest.HISTORIQUE_BILAN,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeAction:2,identifiantPersonne:t}})},t.prototype.getHistoChiffreAffaires=function(e){var t=this;return this.sendRequestGetHistoriqueChiffreAffaires(e).then(function(e){return t.srDTOService.convertHistoriqueChiffreAffaireRestToApp(e)})},t.$inject=["serviceAgent","srDTOService"],t}();e.HistoriqueBilanRestService=t,e.app.service("historiqueBilanRestService",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function e(){this.tabTitre="col-md-9",this.tabAction="col-md-3"}return e}();e.ParamSegmentationRisqueScope=t;var n=function(){function n(e,t,n,i,r){var o=this;return this.modalService=e,this.serviceAgent=t,this.srRestService=n,this.srLabelService=i,this.errorService=r,null==this.codeEtablissement||0===this.codeEtablissement.length?void this.errorService.displayError("L'attribut code-etablissement est obligatoire"):null==this.identifiantTiers?void this.errorService.displayError("L'attribut identifiant-tiers est obligatoire"):(this.srLabelService.init().then(function(){o.srRestService.getSegmentationActuelle(o.codeEtablissement,o.identifiantTiers,o.identifiantEntiteTitulaire).then(function(e){o.segmentationRisque=e})["catch"](function(e){o.errorService.displayError(e.libelle,e)})}),console.log("constructor identifiantEntiteTitulaire"),console.log(this.identifiantEntiteTitulaire),void this.srRestService.getDetail(this.codeEtablissement,this.identifiantTiers,this.identifiantEntiteTitulaire).then(function(e){o.modeSegmentationRisque=e.srActuelle.modeSegmentation,o.serviceAgent.Habilitation.EstHabilite("SHMFCC").then(function(e){o.estHabilite=e,o.setDataListeActions(e)})["catch"](function(e){o.errorService.displayError("Erreur lors de la récupération de l'habilitation"),o.estHabilite=!1,o.setDataListeActions(!1)})}))}return n.prototype.setDataListeActions=function(t){var n=this;this.dataListeActions=[{titreAction:"Voir détail",clicAction:function(){n.voirDetail()}}],console.log("SegmentationRisqueControlle esthabiliteAuForcage - ",t),this.modeSegmentationRisque&&(this.modeSegmentationRisque!==e.Enum.TypeAffectation.ASSERVIE&&this.dataListeActions.push({titreAction:"Calculer",clicAction:function(){n.calculer()}}),t&&this.modeSegmentationRisque!==e.Enum.TypeAffectation.ASSERVIE&&this.dataListeActions.push({titreAction:"Forcer",clicAction:function(){n.forcer()}})),this.dataListeActions.push({titreAction:"Voir historique",clicAction:function(){n.voirHistorique()}})},n.prototype.getTabTitre=function(){return null==this.param&&(this.param=new t),this.param.tabTitre},n.prototype.getTabAction=function(){return null==this.param&&(this.param=new t),this.param.tabAction},n.prototype.voirDetail=function(){var e={codeEtablissement:this.codeEtablissement,identifiantTiers:this.identifiantTiers};this.identifiantEntiteTitulaire&&(e.identifiantEntiteTitulaire=this.identifiantEntiteTitulaire);var t={templateUrl:"typescript/segmentation-risque/modale-detail/modale-detail-vue.html",controller:"DetailModaleControleur",controllerAs:"modaleCtrl",windowClass:"mw-segmentation-risque-modale",backdrop:!0,keyboard:!0,size:"lg",resolve:{params:function(){return e}}};this.modalService.showModal(t)},n.prototype.calculer=function(){var e=this,t={codeEtablissement:this.codeEtablissement,identifiantTiers:this.identifiantTiers,estHabilite:this.estHabilite};this.identifiantEntiteTitulaire&&(t.identifiantEntiteTitulaire=this.identifiantEntiteTitulaire);var n={templateUrl:"typescript/segmentation-risque/modale-calculer/modale-calculer-vue.html",controller:"CalculerModaleControleur",controllerAs:"modaleCtrl",windowClass:"mw-segmentation-risque-modale",backdrop:!0,keyboard:!0,size:"lg",resolve:{params:function(){return t}}};this.modalService.showModal(n).then(function(t){e.segmentationRisque=t})},n.prototype.forcer=function(){var e=this,t={codeEtablissement:this.codeEtablissement,identifiantTiers:this.identifiantTiers,segmentationActuelle:this.segmentationRisque};this.identifiantEntiteTitulaire&&(t.identifiantEntiteTitulaire=this.identifiantEntiteTitulaire);var n={templateUrl:"typescript/segmentation-risque/modale-forcer/modale-forcer-vue.html",controller:"ForcerModaleControleur",controllerAs:"modaleCtrl",windowClass:"mw-segmentation-risque-modale",backdrop:!0,keyboard:!0,size:"lg",resolve:{params:function(){return t}}};this.modalService.showModal(n).then(function(t){e.segmentationRisque=t})},n.prototype.voirHistorique=function(){var e={codeEtablissement:this.codeEtablissement,identifiantTiers:this.identifiantTiers};this.identifiantEntiteTitulaire&&(e.identifiantEntiteTitulaire=this.identifiantEntiteTitulaire);var t={templateUrl:"typescript/segmentation-risque/modale-historique/modale-historique-vue.html",controller:"HistoriqueModaleControleur",controllerAs:"modaleCtrl",windowClass:"mw-segmentation-risque-modale",backdrop:!0,keyboard:!0,size:"lg",resolve:{params:function(){return e}}};this.modalService.showModal(t)},n.$inject=["modalService","serviceAgent","srRestService","srLabelService","errorService"],n}();e.app.controller("mwSegmentationRisqueController",n)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";function t(){return{restrict:"E",templateUrl:"typescript/segmentation-risque/segmentation-risque-vue.html",controller:"mwSegmentationRisqueController",controllerAs:"srCtrl",bindToController:!0,scope:{codeEtablissement:"@",identifiantTiers:"@",identifiantEntiteTitulaire:"@?",param:"=?"}}}e.app.directive("mwSegmentationRisque",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function t(e){this.srLabelService=e}return t.prototype.convertDTOtoSemengtationRisque=function(e){if(null!=e&&null!=e.informationSegmentationRisqueActuelle){var t={codeCategorieClientPart:e.informationSegmentationRisqueActuelle.codeCategorieClientActuelPart,typeCategorieClientPart:e.informationSegmentationRisqueActuelle.typeCategorieClientActuelPart,descriptionCategorieClientPart:this.srLabelService.getLabel(e.informationSegmentationRisqueActuelle.codeCategorieClientActuelPart),codeCategorieClientPro:e.informationSegmentationRisqueActuelle.codeCategorieClientActuelPro,typeCategorieClientPro:e.informationSegmentationRisqueActuelle.typeCategorieClientActuelPro,descriptionCategorieClientPro:this.srLabelService.getLabel(e.informationSegmentationRisqueActuelle.codeCategorieClientActuelPro),codeSegmentRisquePart:e.informationSegmentationRisqueActuelle.codeSegmentRisqueActuelPart,typeSegmentRisquePart:e.informationSegmentationRisqueActuelle.typeSegmentRisqueActuelPart,descriptionSegmentRisquePart:this.srLabelService.getLabel(e.informationSegmentationRisqueActuelle.codeSegmentRisqueActuelPart),codeSegmentRisquePro:e.informationSegmentationRisqueActuelle.codeSegmentRisqueActuelPro,typeSegmentRisquePro:e.informationSegmentationRisqueActuelle.typeSegmentRisqueActuelPro,descriptionSegmentRisquePro:this.srLabelService.getLabel(e.informationSegmentationRisqueActuelle.codeSegmentRisqueActuelPro)};return t}return null},t.prototype.convertDTOtoDetailSegmentationRisque=function(t){if(null!=t){var n=this.convertDTOtoSemengtationRisque(t);null!=n&&(n.modeSegmentation=e.Enum.TypeAffectation[t.informationSegmentationRisqueActuelle.typeAffectationSegmentation],n.codeMacDonough=t.informationSegmentationRisqueActuelle.codeMacDonough,n.libelleMacDonough=t.informationSegmentationRisqueActuelle.libelleMacDonough);var i=null!=t.InformationTiers?t.InformationTiers.montantEngagementTiers:null,r=null==t.InformationTiers||this.isDateNullOrDefault(t.InformationTiers.dateArreteEngagement)?null:t.InformationTiers.dateArreteEngagement,o=null!=t.InformationTiers?t.InformationTiers.montantCAConsolide:null,a=null==t.InformationTiers||this.isDateNullOrDefault(t.InformationTiers.dateArreteBilan)?null:t.InformationTiers.dateArreteBilan,s={srActuelle:n,montantEngagementTiers:i,dateArreteEngagement:this.formatDate(r),montantCAConsolide:o,dateArreteBilan:this.formatDate(a)};return s}return null},t.prototype.convertDTOtoHistoSegmentationRisque=function(t){var n=[];if(null!=t&&null!=t.informationSegmentationRisqueHistoriques)for(var i=0;i<t.informationSegmentationRisqueHistoriques.length;i++){var r=t.informationSegmentationRisqueHistoriques[i],o={codeSRCCAncien:r.codeSRCCAncien,codeSRCCActuel:r.codeSRCCActuel,descriptionSRCCAncien:this.srLabelService.getLabelHisto(r.codeSRCCAncien),descriptionSRCCActuel:this.srLabelService.getLabelHisto(r.codeSRCCActuel),dateMAJSegmentation:this.formatDate(r.dateMAJSegmentation),origineAffectationSegmentation:e.Enum.OrigineAffectation[r.origineAffectationSegmentation],typeAffectationSegmentation:e.Enum.TypeAffectation[r.typeAffectationSegmentation],indicateurSegmentationGrappage:r.indicateurSegmentationGrappage,agentMAJSegmentation:r.agentMAJSegmentation,commentaireForcageSegmentation:r.commentaireForcageSegmentation};n.push(o)}return n},t.prototype.convertDTOtoCategorieClient=function(e,t){if(null!=e){var n=[];if(null!=e.categorieClientCalculee&&null!=e.categorieClientCalculee.segmentation&&(null!=t&&(e.categorieClientCalculee.segmentation.codePartSR=t.codeSegmentRisquePart,e.categorieClientCalculee.segmentation.typePartSR=t.typeSegmentRisquePart,e.categorieClientCalculee.segmentation.codeProSR=t.codeSegmentRisquePro,e.categorieClientCalculee.segmentation.typeProSR=t.typeSegmentRisquePro),n.push(this.convertISegmentationToICategorieClient(e.categorieClientCalculee.segmentation))),null!=e.listeCategorieClientPossible)for(var i=0;i<e.listeCategorieClientPossible.length;i++)n.push(this.convertISegmentationToICategorieClient(e.listeCategorieClientPossible[i]));return n}return null},t.prototype.convertCategorieClientToDTO=function(e,t,n,i){var r={informationForcageSegmentation:{codeForcage:null,typeMiseAJour:null,motifForcage:null},InformationTiers:{codeEtablissement:e,identifiantTiers:t,montantEngagementTiers:null,dateArreteEngagement:null,montantCAConsolide:null,dateArreteBilan:null,typeGroupe:null,identifiantEntiteTitulaire:i},informationSegmentationRisqueActuelle:{codeCategorieClientActuelPart:null!=n.categorieClientPart?n.categorieClientPart.codeCategorieClient:null,typeCategorieClientActuelPart:null!=n.categorieClientPart?n.categorieClientPart.typeCategorieClient:null,codeCategorieClientActuelPro:null!=n.categorieClientPro?n.categorieClientPro.codeCategorieClient:null,typeCategorieClientActuelPro:null!=n.categorieClientPro?n.categorieClientPro.typeCategorieClient:null,codeSegmentRisqueActuelPart:null!=n.segmentRisquePart?n.segmentRisquePart.codeSegmentRisque:null,typeSegmentRisqueActuelPart:null!=n.segmentRisquePart?n.segmentRisquePart.typeSegmentRisque:null,codeSegmentRisqueActuelPro:null!=n.segmentRisquePro?n.segmentRisquePro.codeSegmentRisque:null,typeSegmentRisqueActuelPro:null!=n.segmentRisquePro?n.segmentRisquePro.typeSegmentRisque:null,codeMacDonough:null,libelleMacDonough:null,typeAffectationSegmentation:null},informationSegmentationRisqueHistoriques:null};return r},t.prototype.convertISegmentationToICategorieClient=function(e){var t=[],n=null;null!=e.codePart&&(n={codeCategorieClient:e.codePart,typeCategorieClient:e.typePart,descriptionCategeorieClient:this.srLabelService.getLabel(e.codePart)},t.push(n.codeCategorieClient+" - "+n.descriptionCategeorieClient));var i=null;null!=e.codePro&&(i={codeCategorieClient:e.codePro,typeCategorieClient:e.typePro,descriptionCategeorieClient:this.srLabelService.getLabel(e.codePro)},t.push(i.codeCategorieClient+" - "+i.descriptionCategeorieClient));var r=null;null!=e.codePartSR&&(r={codeSegmentRisque:e.codePartSR,typeSegmentRisque:e.typePartSR,descriptionSegmentRisque:this.srLabelService.getLabel(e.codePartSR)});var o=null;null!=e.codeProSR&&(o={codeSegmentRisque:e.codeProSR,typeSegmentRisque:e.typeProSR,descriptionSegmentRisque:this.srLabelService.getLabel(e.codeProSR)});var a={categorieClientPart:n,categorieClientPro:i,segmentRisquePart:r,segmentRisquePro:o};return a.labelComplet=t.join("\n"),a},t.prototype.formatDate=function(e){if(null==e)return null;var t=e.split("-");return 3!==t.length?e:t[2]+"/"+t[1]+"/"+t[0]},t.prototype.isDateNullOrDefault=function(e){return null==e||"0001-01-01"===e},t.prototype.convertHistoriqueChiffreAffaireRestToApp=function(t){var n=this,i=null;if(t){i={},i.montantChiffreAffaireMoyen=t.montantChiffreAffaireMoyen,i.montantChiffreAffaireReference=t.montantChiffreAffaireReference;var r=[];_.forEach(t.listeBilans,function(t){if(null!=t.dateFinExerciceBilan&&t.dateFinExerciceBilan!==e.constantes.DATE_REST_INVALIDE){var i={};i.dateFinExercice=t.dateFinExerciceBilan,i.dureeExercice=t.dureeExercice,i.montantChiffreAffaireExercice=t.montantChiffreAffaireExercice,i.typeBilan=n.getLibelleTypeBilan(t.typeBilan),r.push(i)}}),i.listeBilans=r}return i},t.prototype.getLibelleTypeBilan=function(t){var n;switch(t){case"S":n=e.constantes.typeBilan.SOCIAL;break;case"C":n=e.constantes.typeBilan.CONSOLIDE;break;case"A":n=e.constantes.typeBilan.AUTRE;break;default:n=""}return n},t.$inject=["srLabelService"],t}();e.SRDTOService=t,e.app.service("srDTOService",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n){this.serviceAgent=e,this.$q=t,this.errorService=n}return e.prototype.init=function(){var t=this;return this.serviceAgent.Trace.debug("Chargement des données délocalisées ..."),this.serviceAgent.DonneesDelocalisees.getDonneesDelocalisees(null,e.TABLE_DELOC).then(function(n){return t.donnees=n.donnees,t.serviceAgent.Trace.debug("Données délocalisées chargées à 50%"),t.serviceAgent.DonneesDelocalisees.getDonneesDelocalisees(null,e.TABLE_DELOC_HISTO).then(function(e){t.donneesHisto=e.donnees,t.serviceAgent.Trace.debug("Données délocalisées chargées à 100%")})})["catch"](function(e){t.errorService.displayError("Erreur de chargement des données délocalisées.",e)})},e.prototype.getLabel=function(e){if(null!=this.donnees&&null!=e)for(var t=0;t<this.donnees.length;t++)if(this.donnees[t].CDMBSR===e)return this.donnees[t].LI3SEG;return null},e.prototype.getLabelHisto=function(e){if(null!=this.donneesHisto&&null!=e)for(var t=0;t<this.donneesHisto.length;t++)if(this.donneesHisto[t].CG3CLT===e)return this.donneesHisto[t].LI3CLT;return null},e.$inject=["serviceAgent","$q","errorService"],e.TABLE_DELOC="MY7A",e.TABLE_DELOC_HISTO="S95B",e}();e.SRLabelService=t,e.app.service("srLabelService",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t,n){this.serviceAgent=e,this.srDTOService=t,this.agentCaracteristiqueService=n}return t.prototype.getSegmentationActuelle=function(e,n,i){var r=this;return this.sendRequestGetSegmentationClientele(e,n,t.TYPE_CONSULTATION_CONSULTATION,i).then(function(e){return r.srDTOService.convertDTOtoSemengtationRisque(e)})},t.prototype.getHistorique=function(e,n,i){var r=this;return this.sendRequestGetSegmentationClientele(e,n,t.TYPE_CONSULTATION_HISTORIQUE,i).then(function(t){var n=r.srDTOService.convertDTOtoHistoSegmentationRisque(t),i=n.map(function(e){return e.agentMAJSegmentation});return r.agentCaracteristiqueService.getUniqueAgentNoms(e,i).then(function(e){for(var t=0;t<n.length;t++)if(null!=n[t].agentMAJSegmentation)for(var i=0;i<e.length;i++)if(e[i].id===n[t].agentMAJSegmentation){null!=e[i].nom&&(n[t].agentMAJSegmentation=e[i].nom+" ("+n[t].agentMAJSegmentation+")");break}return n})})},t.prototype.getDetail=function(e,n,i){var r=this;return this.sendRequestGetSegmentationClientele(e,n,t.TYPE_CONSULTATION_DETAIL,i).then(function(e){return r.srDTOService.convertDTOtoDetailSegmentationRisque(e)})},t.prototype.getCategoriesApprochantesPourCalcul=function(e,n){var i=this;return this.sendRequestGetDemandeSegmentation(e,n,t.TYPE_DEMANDE_CALCUL).then(function(e){return i.srDTOService.convertDTOtoCategorieClient(e,null)})},t.prototype.getCategoriesApprochantesPourForcage=function(e,n,i){var r=this;return this.sendRequestGetDemandeSegmentation(e,n,t.TYPE_DEMANDE_FORCAGE).then(function(e){return r.srDTOService.convertDTOtoCategorieClient(e,i)})},t.prototype.putCalculCategorieClient=function(e,n,i,r,o,a){var s,l=this;s=o>1?r?t.CODE_FORCAGE_FORCEE_GESTION_HABILITE:t.CODE_FORCAGE_FORCEE_GESTION:r?t.CODE_FORCAGE_CALCUL_AUTO_HABILITE:t.CODE_FORCAGE_CALCUL_AUTO;var c=this.srDTOService.convertCategorieClientToDTO(e,n,i,a);return this.sendRequestPutSegmentationClientele(t.TYPE_DEMANDE_CALCUL,s,null,c).then(function(e){return l.srDTOService.convertDTOtoSemengtationRisque(e)})},t.prototype.putForcageCategorieClient=function(e,n,i,r,o,a){var s,l=this;s=r>1?t.CODE_FORCAGE_FORCEE_GESTION_HABILITE:t.CODE_FORCAGE_CALCUL_AUTO_HABILITE;var c=this.srDTOService.convertCategorieClientToDTO(e,n,i,a);return this.sendRequestPutSegmentationClientele(t.TYPE_DEMANDE_FORCAGE,s,o,c).then(function(e){return l.srDTOService.convertDTOtoSemengtationRisque(e)})},t.prototype.getPrecedentForcage=function(n,i,r){var o=this;return this.sendRequestGetSegmentationClientele(n,i,t.TYPE_CONSULTATION_HISTORIQUE,r).then(function(t){for(var i=o.srDTOService.convertDTOtoHistoSegmentationRisque(t),r=0;r<i.length;r++)if(i[r].typeAffectationSegmentation===e.Enum.TypeAffectation.FORCEE)return o.agentCaracteristiqueService.getAgentNom(n,i[r].agentMAJSegmentation).then(function(e){return null!=e.nom&&(i[r].agentMAJSegmentation=e.nom+" ("+i[r].agentMAJSegmentation+")"),i[r]})})},t.prototype.sendRequestGetSegmentationClientele=function(t,n,i,r){console.log("sendRequestGetSegmentationClientele identifiantEntiteTitulaire"),console.log(r);var o=e.constantes.urlRest.SEGMENTATION_CLIENTELE+"?codeEtablissement="+t+"&identifiantTiers="+n+"&typeMiseAJour="+i+(r?"&identifiantEntiteTitulaire="+r:"");return this.serviceAgent.sendRequest({url:o,withHeaders:!0,method:MyWay.Services.MethodEnum.GET})},t.prototype.sendRequestGetDemandeSegmentation=function(t,n,i){var r=e.constantes.urlRest.DEMANDE_SEGMENTATION+"?codeEtablissement="+t+"&identifiantTiers="+n+"&typeDemande="+i;return this.serviceAgent.sendRequest({url:r,withHeaders:!0,method:MyWay.Services.MethodEnum.GET})},t.prototype.sendRequestPutSegmentationClientele=function(t,n,i,r){r.informationForcageSegmentation.codeForcage=n,r.informationForcageSegmentation.typeMiseAJour=t,r.informationForcageSegmentation.motifForcage=i;var o=e.constantes.urlRest.SEGMENTATION_CLIENTELE;return this.serviceAgent.sendRequest({url:o,withHeaders:!0,method:MyWay.Services.MethodEnum.PUT,data:r})},t.$inject=["serviceAgent","srDTOService","agentCaracteristiqueService"],t.TYPE_CONSULTATION_CONSULTATION="C",t.TYPE_CONSULTATION_DETAIL="D",t.TYPE_CONSULTATION_HISTORIQUE="H",t.TYPE_DEMANDE_CALCUL="C",t.TYPE_DEMANDE_FORCAGE="F",t.CODE_FORCAGE_FORCEE_GESTION="1",t.CODE_FORCAGE_FORCEE_GESTION_HABILITE="3",t.CODE_FORCAGE_CALCUL_AUTO=" ",t.CODE_FORCAGE_CALCUL_AUTO_HABILITE="2",t}();e.SRRestService=t,e.app.service("srRestService",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){this.serviceAgent=e,this.$q=t}return t.prototype.getUniqueAgentNoms=function(e,t){var n=this,i=_.uniq(t);return this.$q.all(i.map(function(t){return n.getAgentNom(e,t)}))},t.prototype.getAgentNom=function(t,n){var i=parseInt(n,10);if(null==i||isNaN(i))return this.$q.when({id:n,nom:null});var r=e.constantes.urlRest.CARACTERISTIQUE_AGENT+"?codeEtablissement="+t+"&identifiantAgent="+i;return this.serviceAgent.sendRequest({url:r,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){var t=null;return null==e.prenomAgent?t=e.nomAgent:null!=e.nomAgent&&(t=e.nomAgent+" "+e.prenomAgent),{id:n,nom:t}})},t.$inject=["serviceAgent","$q"],t}();e.AgentCaracteristiqueService=t,e.app.service("agentCaracteristiqueService",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n){this.serviceAgent=e,this.mwNotificationService=t,this.modaleService=n}return e.prototype.displayError=function(e,t){(null==e||0===e.length)&&(e="erreur non renseignée"),this.modaleService.showErreur(MyWay.UI.TYPE_POPUP_ERREUR.BLOQUANT,"",e,"Fermer"),this.serviceAgent.Trace.error(e,null,t)},e.$inject=["serviceAgent","MwNotificationService","modalService"],e}();e.ErrorService=t,e.app.service("errorService",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function t(t,n,i,r,o,a){var s=this;this.$modalInstance=t,this.params=n,this.srRestService=i,this.errorService=r,this.historiqueBilanRestService=o,this.$q=a,this.loading=!0,this.tableauHistoriqueBilans=new e.Tableaux.TableauHistoriqueBilans(this);var l=this.srRestService.getDetail(this.params.codeEtablissement,this.params.identifiantTiers,this.params.identifiantEntiteTitulaire),c=this.historiqueBilanRestService.getHistoChiffreAffaires(this.params.identifiantTiers);this.$q.all([l,c]).then(function(e){e&&(s.data=e[0],s.donneesHistoriqueBilan=e[1],e[1]&&(s.tableauHistoriqueBilans.data=e[1].listeBilans))})["catch"](function(e){s.errorService.displayError(e.libelle,e)})["finally"](function(){return s.loading=!1})}return t.prototype.cancel=function(){this.$modalInstance.close()},t.prototype.onSelectionChange=function(e){},t.$inject=["$modalInstance","params","srRestService","errorService","historiqueBilanRestService","$q"],t}();e.app.controller("DetailModaleControleur",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n,i){var r=this;this.$modalInstance=e,this.params=t,this.srRestService=n,this.errorService=i,this.categorieValide=!0,this.loading=!0,this.step=1,this.srRestService.getCategoriesApprochantesPourCalcul(this.params.codeEtablissement,this.params.identifiantTiers).then(function(e){r.categoriesDisponibles=e,e.length>0&&(r.selectedCategorie=e[0])})["catch"](function(e){r.errorService.displayError(e.libelle,e),r.$modalInstance.dismiss("error")})["finally"](function(){return r.loading=!1})}return e.prototype.goToNextStep=function(){if(!this.selectedCategorie)throw this.categorieValide=!1,new Error("La catégorie est olbigatoire");if(this.categorieValide=!0,1!==this.step)throw new Error("Il n'y as pas d'étape suivant l'étape n°:"+this.step);this.step=2},e.prototype.goToPreviousStep=function(){if(2!==this.step)throw new Error("Il n'y as pas d'étape précédent l'étape n°:"+this.step);this.step=1},e.prototype.ok=function(){var e=this;return this.selectedCategorie?void this.srRestService.putCalculCategorieClient(this.params.codeEtablissement,this.params.identifiantTiers,this.selectedCategorie,this.params.estHabilite,this.categoriesDisponibles.length,this.params.identifiantEntiteTitulaire).then(function(t){e.$modalInstance.close(t)})["catch"](function(t){e.errorService.displayError(t.libelle,t),e.$modalInstance.dismiss("error")}):void(this.categorieValide=!1)},e.prototype.cancel=function(){this.$modalInstance.dismiss("cancel")},e.$inject=["$modalInstance","params","srRestService","errorService"],e}();e.app.controller("CalculerModaleControleur",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n,i,r){var o=this;this.$modalInstance=e,this.params=t,this.srRestService=n,this.errorService=i,this.$timeout=r,this.motifForcageValide=!0,this.categorieValide=!0,this.loading=!0,this.step=1,this.segmentationActuelle=this.params.segmentationActuelle,this.srRestService.getPrecedentForcage(this.params.codeEtablissement,this.params.identifiantTiers,this.params.identifiantEntiteTitulaire).then(function(e){return null!=e&&(o.precedentForcage=e.dateMAJSegmentation+"\n"+e.agentMAJSegmentation),o.srRestService.getCategoriesApprochantesPourForcage(o.params.codeEtablissement,o.params.identifiantTiers,o.segmentationActuelle)}).then(function(e){o.categoriesDisponibles=e,null!=e&&e.length>0&&(o.selectedCategorie=e[0])})["catch"](function(e){o.errorService.displayError(e.libelle,e),o.$modalInstance.dismiss("error")})["finally"](function(){return o.loading=!1})}return e.prototype.goToNextStep=function(){if(!this.selectedCategorie)throw this.categorieValide=!1,new Error("La catégorie est olbigatoire");if(this.categorieValide=!0,1!==this.step)throw new Error("Il n'y as pas d'étape suivant l'étape n°:"+this.step);this.step=2,this.$timeout(function(){var e=document.getElementById("motif-forcage");e.focus()},200)},e.prototype.goToPreviousStep=function(){if(2!==this.step)throw new Error("Il n'y as pas d'étape précédent l'étape n°:"+this.step);this.step=1},e.prototype.ok=function(){var e=this;return this.motifForcage?void this.srRestService.putForcageCategorieClient(this.params.codeEtablissement,this.params.identifiantTiers,this.selectedCategorie,this.categoriesDisponibles.length,this.motifForcage,this.params.identifiantEntiteTitulaire).then(function(t){e.$modalInstance.close(t)})["catch"](function(t){e.errorService.displayError(t.libelle,t),e.$modalInstance.dismiss("error")}):void(this.motifForcageValide=!1)},e.prototype.cancel=function(){this.$modalInstance.dismiss("cancel")},e.$inject=["$modalInstance","params","srRestService","errorService","$timeout"],e}();e.app.controller("ForcerModaleControleur",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n,i){var r=this;this.$modalInstance=e,this.params=t,this.srRestService=n,this.errorService=i,this.loading=!0,this.titreNbElement="",this.tableauColonneOptionsAvant={title:"Avant",bind:"codeSRCCAncien",cssClass:"col-md-1"},this.tableauColonneOptionsApres={title:"Après",bind:"codeSRCCActuel",cssClass:"col-md-1"},this.tableauColonneOptionsDateMAJ={title:"Mise à jour le",bind:"dateMAJSegmentation",cssClass:"col-md-2"},this.tableauColonneOptionsOrigine={title:"Origine de la modification",bind:"origineAffectationSegmentation",cssClass:"col-md-6"},this.tableauColonneOptionsAffectation={title:"Type d'affectation",bind:"typeAffectationSegmentation",cssClass:"col-md-2"},this.tableauOptionsHistorique={data:null,width:"col-md-12",reserve:!0,perPage:15,tableHandler:this,multiSelect:!1,filterEnable:!1,sortEnable:!1,moreEnable:!0,templateUrl:"typescript/segmentation-risque/modale-historique/historique-tr-detail-vue.html",selectedItems:[],columns:[this.tableauColonneOptionsAvant,this.tableauColonneOptionsApres,this.tableauColonneOptionsDateMAJ,this.tableauColonneOptionsOrigine,this.tableauColonneOptionsAffectation]},this.srRestService.getHistorique(this.params.codeEtablissement,this.params.identifiantTiers,this.params.identifiantEntiteTitulaire).then(function(e){r.setTableData(e)})["catch"](function(e){r.errorService.displayError(e.libelle,e),r.$modalInstance.dismiss("error")})["finally"](function(){return r.loading=!1})}return e.prototype.setTableData=function(e){e.length>0&&(this.titreNbElement=" - ("+e.length+")",this.tableauOptionsHistorique.data=e)},e.prototype.cancel=function(){this.$modalInstance.close()},e.$inject=["$modalInstance","params","srRestService","errorService"],
e}();e.app.controller("HistoriqueModaleControleur",t)}(t=e.apiSegmentationRisque||(e.apiSegmentationRisque={}))}(myway||(myway={})),angular.module("myway.apiSegmentationRisque").run(["$templateCache",function(e){e.put("typescript/mw-list-group/mw-list-group-vue.html",'<div class="list-group">\r\n    <div class="list-group-heading" ng-if="mwListGroup.heading" ng-bind="mwListGroup.heading"></div>\r\n    <div class="list-group-item" ng-if="!mwListGroup.trackBy" ng-repeat="item in mwListGroup.data track by $index" ng-click="mwListGroup.selectedItem = item" ng-class="{active: mwListGroup.selectedItem === item}" ng-bind="item[mwListGroup.bind]" ng-attr-id="{{\'list-group-item-\' + $index}}">\r\n    </div>\r\n    <div class="list-group-item" ng-if="!mwListGroup.data || mwListGroup.data.length === 0">Aucun élément</div>\r\n</div>\r\n'),e.put("typescript/segmentation-risque/segmentation-risque-view.html",'<div class="mw-segmentation-risque">\r\n    <form class="form-horizontal" novalidate>\r\n        <div class="form-group">\r\n            <div class="col-md-9">\r\n                <h4>Segmentation Risque</h4>\r\n            </div>\r\n            <div class="col-md-3">\r\n                <mw-bouton-liste-actions titre="Actions" data="mwSegmentationRisque.dataListeActions" modele="contextuel"></mw-bouton-liste-actions>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="col-md-3 control-label">Catégorie Client</label>\r\n            <div class="col-md-9 control-div">\r\n                <p><strong ng-bind="mwSegmentationRisque.segmentationRisque.categorieClientCode"></strong></p>\r\n                <p><strong ng-bind="mwSegmentationRisque.segmentationRisque.categorieClientDescription"></strong></p>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="col-md-3 control-label">Segment Risque</label>\r\n            <div class="col-md-9 control-div">\r\n                <p><strong ng-bind="mwSegmentationRisque.segmentationRisque.segmentRisqueCode"></strong></p>\r\n                <p><strong ng-bind="mwSegmentationRisque.segmentationRisque.segmentRisqueDescription"></strong></p>\r\n            </div>\r\n        </div>\r\n    </form>\r\n</div>\r\n'),e.put("typescript/segmentation-risque/segmentation-risque-vue.html",'<div class="mw-segmentation-risque">\r\n    <form class="form-horizontal" novalidate>\r\n        <div class="form-group">\r\n            <div ng-class="srCtrl.getTabTitre()">\r\n                <h4>Segmentation Risque</h4>\r\n            </div>\r\n             <div class="mw-bouton-liste-actions" ng-class="srCtrl.getTabAction()">\r\n                <mw-bouton-liste-actions id="liste-actions" class="col-xs-12" titre="Actions" data="srCtrl.dataListeActions" modele="contextuel"></mw-bouton-liste-actions>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <span class="col-md-3 control-label">Catégorie Client</span>\r\n            <div class="col-md-9 control-div">\r\n                <p ng-if="srCtrl.segmentationRisque.codeCategorieClientPart">\r\n                    <strong ng-bind="srCtrl.segmentationRisque.codeCategorieClientPart + \' - \' + srCtrl.segmentationRisque.descriptionCategorieClientPart"></strong>\r\n                </p>\r\n                <p ng-if="srCtrl.segmentationRisque.codeCategorieClientPro">\r\n                    <strong ng-bind="srCtrl.segmentationRisque.codeCategorieClientPro + \' - \' + srCtrl.segmentationRisque.descriptionCategorieClientPro"></strong>\r\n                </p>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <span class="col-md-3 control-label">Segment Risque</span>\r\n            <div class="col-md-9 control-div">\r\n                <p ng-if="srCtrl.segmentationRisque.codeSegmentRisquePart">\r\n                    <strong ng-bind="srCtrl.segmentationRisque.codeSegmentRisquePart + \' - \' + srCtrl.segmentationRisque.descriptionSegmentRisquePart"></strong>\r\n                </p>\r\n                <p ng-if="srCtrl.segmentationRisque.codeSegmentRisquePro">\r\n                    <strong ng-bind="srCtrl.segmentationRisque.codeSegmentRisquePro + \' - \' + srCtrl.segmentationRisque.descriptionSegmentRisquePro"></strong>\r\n                </p>\r\n            </div>\r\n        </div>\r\n    </form>\r\n</div>\r\n'),e.put("typescript/segmentation-risque/modale-calculer/modale-calculer-vue.html",'<div class="modal-header">\r\n    <button type="button" id="btn-croix" ng-click="modaleCtrl.cancel()" class="close" aria-hidden="true"><span class="icon itce-times"></span></button>\r\n    <h1 class="modal-title" ng-if="modaleCtrl.step === 1">1 - Calculer Segmentation Risque : choisir une catégorie client</h1>\r\n    <h1 class="modal-title" ng-if="modaleCtrl.step === 2">2 - Calculer Segmentation Risque</h1>\r\n</div>\r\n<div class="modal-body texte-gros row" mw-chargement="modaleCtrl.loading">\r\n    <div ng-show="modaleCtrl.step === 1">\r\n\r\n        <form class="form-list-group" novalidate>\r\n            <div class="form-group" ng-class="{\'has-error\': !modaleCtrl.categorieValide}">\r\n                <div class="col-md-12">\r\n                    <span class="control-label" for="calculer-liste-categorie">Choisissez une catégorie client</span>\r\n                </div>\r\n                <div class="col-md-12">\r\n                    <div class="control-div" id="calculer-liste-categorie">\r\n                        <mw-list-group heading="Liste des catégories client disponibles" data="modaleCtrl.categoriesDisponibles" bind="labelComplet" selected-item="modaleCtrl.selectedCategorie">\r\n                        </mw-list-group>\r\n                    </div>\r\n                    <span class="col-md-12 error-msg" role="alert" ng-show="!modaleCtrl.categorieValide">La catégorie est obligatoire</span>\r\n                </div>\r\n            </div>\r\n        </form>\r\n    </div>\r\n    <div ng-show="modaleCtrl.step === 2">\r\n\r\n        <div class="col-md-12">\r\n            <div class="mw-bloc-contenu">\r\n                <p>Nouvelle catégorie client :</p>\r\n                <strong ng-bind="modaleCtrl.selectedCategorie.labelComplet"></strong>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="modal-footer">\r\n    <div ng-show="modaleCtrl.step === 1">\r\n        <div class="col-sm-offset-6 col-sm-3">\r\n            <button type="button" id="btn-annuler1" class="btn btn-contextuel" ng-click="modaleCtrl.cancel()">Annuler</button>\r\n        </div>\r\n        <div class="col-lg-3 col-md-3 col-sm-3">\r\n            <button type="button" id="btn-suivant" class="btn btn-primary" ng-click="modaleCtrl.goToNextStep()">Suivant</button>\r\n        </div>\r\n    </div>\r\n    <div ng-show="modaleCtrl.step === 2">\r\n        <div class="col-sm-offset-3 col-sm-3">\r\n            <button type="button" id="btn-annuler2" class="btn btn-contextuel" ng-click="modaleCtrl.cancel()">Annuler</button>\r\n        </div>\r\n        <div class="col-lg-3 col-md-3 col-sm-3">\r\n            <button type="button" id="btn-precedent" class="btn btn-default" ng-click="modaleCtrl.goToPreviousStep()">Précédent</button>\r\n        </div>\r\n        <div class="col-lg-3 col-md-3 col-sm-3">\r\n            <button type="button" id="btn-valider" class="btn btn-primary" ng-click="modaleCtrl.ok()">Calculer</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/segmentation-risque/modale-forcer/modale-forcer-vue.html",'<div class="modal-header">\r\n    <button type="button" id="btn-croix" ng-click="modaleCtrl.cancel()" class="close" aria-hidden="true"><span class="icon itce-times"></span></button>\r\n    <h1 class="modal-title" ng-if="modaleCtrl.step === 1">1 - Forcer Segmentation Risque : choisir une nouvelle catégorie client</h1>\r\n    <h1 class="modal-title" ng-if="modaleCtrl.step === 2">2 - Forcer Segmentation Risque : choisir un motif de forçage</h1>\r\n</div>\r\n<div class="modal-body texte-gros row" mw-chargement="modaleCtrl.loading">\r\n    <div ng-show="modaleCtrl.step === 1">\r\n        <form class="form-horizontal form-small-spacing" novalidate>\r\n            <div class="row">\r\n                <div class="col-md-5">\r\n                    <div class="form-group">\r\n                        <span class="col-md-8 control-label">Catégorie Client actuelle</span>\r\n                        <div class="col-md-4 control-div">\r\n                            <p ng-if="modaleCtrl.segmentationActuelle.codeCategorieClientPart">\r\n                                <strong ng-bind="modaleCtrl.segmentationActuelle.codeCategorieClientPart"></strong>\r\n                            </p>\r\n                            <p ng-if="modaleCtrl.segmentationActuelle.codeCategorieClientPro">\r\n                                <strong ng-bind="modaleCtrl.segmentationActuelle.codeCategorieClientPro"></strong>\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                    <div class="form-group">\r\n                        <span class="col-md-8 control-label">Catégorie Client proposée</span>\r\n                        <div class="col-md-4 control-div">\r\n                            <p ng-if="modaleCtrl.selectedCategorie.categorieClientPart">\r\n                                <strong ng-bind="modaleCtrl.selectedCategorie.categorieClientPart.codeCategorieClient"></strong>\r\n                            </p>\r\n                            <p ng-if="modaleCtrl.selectedCategorie.categorieClientPro">\r\n                                <strong ng-bind="modaleCtrl.selectedCategorie.categorieClientPro.codeCategorieClient"></strong>\r\n                            </p>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n                <div class="col-md-7">\r\n                    <div class="form-group">\r\n                        <span class="col-md-4 control-label">Précédent forçage</span>\r\n                        <div class="col-md-8 control-div white-space-pre">\r\n                            <strong ng-bind="::modaleCtrl.precedentForcage"></strong>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </form>\r\n        <form class="form-list-group" novalidate>\r\n            <div class="form-group" ng-class="{\'has-error\': !modaleCtrl.categorieValide}">\r\n                <div class="col-md-12">\r\n                    <span class="control-label" for="forcer-liste-categorie">Catégorie client</span>\r\n                </div>\r\n                <div class="col-md-12">\r\n                    <div class="control-div" id="forcer-liste-categorie">\r\n                        <mw-list-group data="modaleCtrl.categoriesDisponibles" bind="labelComplet" selected-item="modaleCtrl.selectedCategorie">\r\n                        </mw-list-group>\r\n                    </div>\r\n                    <span class="col-md-12 error-msg" role="alert" ng-show="!modaleCtrl.categorieValide">La catégorie est obligatoire</span>\r\n                </div>\r\n            </div>\r\n        </form>\r\n    </div>\r\n\r\n    <div ng-show="modaleCtrl.step === 2">\r\n        <form class="form-horizontal" novalidate>\r\n            <div class="form-title">\r\n                <h3>Nouvelle Segmentation Client</h3>\r\n            </div>\r\n            <div class="form-group">\r\n                <span class="col-md-3 control-label">Catégorie client</span>\r\n                <div class="col-md-9 control-div"><strong ng-bind="modaleCtrl.selectedCategorie.labelComplet"></strong></div>\r\n            </div>\r\n            <div class="form-group">\r\n                <span class="col-md-3 control-label">Segment Risque</span>\r\n                <div class="col-md-9 control-div">\r\n                    <p ng-if="modaleCtrl.selectedCategorie.segmentRisquePart">\r\n                        <strong ng-bind="modaleCtrl.selectedCategorie.segmentRisquePart.codeSegmentRisque + \' - \' + modaleCtrl.selectedCategorie.segmentRisquePart.descriptionSegmentRisque"></strong>\r\n                    </p>\r\n                    <p ng-if="modaleCtrl.selectedCategorie.segmentRisquePro">\r\n                        <strong ng-bind="modaleCtrl.selectedCategorie.segmentRisquePro.codeSegmentRisque + \' - \' + modaleCtrl.selectedCategorie.segmentRisquePro.descriptionSegmentRisque"> </strong>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n            <!--<div class="form-group" ng-class="{\'has-error\': !modaleCtrl.motifForcageValide}">\r\n                <label class="col-md-3 control-label" for="motif-forcage">Motif de forçage</label>\r\n                <div class="col-md-9">\r\n                    <input id="motif-forcage" name="motif-forcage" type="text" class="form-control" ng-model="modaleCtrl.motifForcage" required aria-required="true" />\r\n                    <span class="col-md-12 error-msg" role="alert" ng-show="!modaleCtrl.motifForcageValide">Le motif de forçage est obligatoire</span>\r\n                </div>\r\n            </div>-->\r\n            <div class="form-group">\r\n                <label class="col-md-3 control-label" for="motif-forcage">Motif de forçage</label>\r\n                <div class="col-md-9">\r\n                    <input id="motif-forcage" name="motif-forcage" type="text" class="form-control" ng-model="modaleCtrl.motifForcage" required aria-required="true">\r\n                    \r\n                </div>\r\n            </div>\r\n        </form>\r\n    </div>\r\n</div>\r\n<div class="modal-footer">\r\n    <div ng-show="modaleCtrl.step === 1">\r\n        <div class="col-sm-offset-6 col-sm-3">\r\n            <button type="button" id="btn-annuler1" class="btn btn-contextuel" ng-click="modaleCtrl.cancel()">Annuler</button>\r\n        </div>\r\n        <div class="col-lg-3 col-md-3 col-sm-3">\r\n            <button type="button" id="btn-suivant" class="btn btn-primary" ng-click="modaleCtrl.goToNextStep()">Suivant</button>\r\n        </div>\r\n    </div>\r\n    <div ng-show="modaleCtrl.step === 2">\r\n        <div class="col-sm-offset-3 col-sm-3">\r\n            <button type="button" id="btn-annuler2" class="btn btn-contextuel" ng-click="modaleCtrl.cancel()">Annuler</button>\r\n        </div>\r\n        <div class="col-lg-3 col-md-3 col-sm-3">\r\n            <button type="button" id="btn-precedent" class="btn btn-default" ng-click="modaleCtrl.goToPreviousStep()">Précédent</button>\r\n        </div>\r\n        <div class="col-lg-3 col-md-3 col-sm-3">\r\n            <button type="button" id="btn-valider" class="btn btn-primary" ng-click="modaleCtrl.ok()">Forcer</button>\r\n        </div>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/segmentation-risque/modale-detail/modale-detail-vue.html",'<div class="modal-header">\r\n    <button type="button" id="btn-croix" ng-click="modaleCtrl.cancel()" class="close" aria-hidden="true"><span class="icon itce-times"></span></button>\r\n    <h1 class="modal-title">Détail Segmentation Risque</h1>\r\n</div>\r\n<div class="modal-body texte-gros row" mw-chargement="modaleCtrl.loading">\r\n    <mw-panel niveau="2" titre="Segmentation en cours">\r\n        <form class="form-horizontal form-small-spacing" novalidate>\r\n            <div class="form-group">\r\n                <span class="col-md-4 control-label">Catégorie Client</span>\r\n                <div class="col-md-8 control-div">\r\n                    <p ng-if="modaleCtrl.data.srActuelle.codeCategorieClientPart">\r\n                        <strong ng-bind="modaleCtrl.data.srActuelle.codeCategorieClientPart + \' - \' + modaleCtrl.data.srActuelle.descriptionCategorieClientPart"></strong>\r\n                    </p>\r\n                    <p ng-if="modaleCtrl.data.srActuelle.codeCategorieClientPro">\r\n                        <strong ng-bind="modaleCtrl.data.srActuelle.codeCategorieClientPro + \' - \' + modaleCtrl.data.srActuelle.descriptionCategorieClientPro"></strong>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n            <div class="form-group">\r\n                <span class="col-md-4 control-label">Segment Risque</span>\r\n                <div class="col-md-8 control-div">\r\n                    <p ng-if="modaleCtrl.data.srActuelle.codeSegmentRisquePart">\r\n                        <strong ng-bind="modaleCtrl.data.srActuelle.codeSegmentRisquePart + \' - \' + modaleCtrl.data.srActuelle.descriptionSegmentRisquePart"></strong>\r\n                    </p>\r\n                    <p ng-if="modaleCtrl.data.srActuelle.codeSegmentRisquePro">\r\n                        <strong ng-bind="modaleCtrl.data.srActuelle.codeSegmentRisquePro + \' - \' + modaleCtrl.data.srActuelle.descriptionSegmentRisquePro"></strong>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n            <div class="form-group" ng-if="modaleCtrl.data.srActuelle.codeMacDonough">\r\n                <span class="col-md-4 control-label">Segment Risque SPLS</span>\r\n                <div class="col-md-8 control-div">\r\n                    <strong ng-bind="modaleCtrl.data.srActuelle.codeMacDonough + \' - \' + modaleCtrl.data.srActuelle.libelleMacDonough"></strong>\r\n                </div>\r\n            </div>\r\n            <div class="form-group">\r\n                <span class="col-md-4 control-label">Mode de segmentation</span>\r\n                <div class="col-md-8 control-div"><strong ng-bind="::modaleCtrl.data.srActuelle.modeSegmentation"></strong></div>\r\n            </div>\r\n        </form>\r\n    </mw-panel>\r\n    <mw-panel id="panel-chiffre-affaires" niveau="2" titre="Chiffre d\'affaires">\r\n        <form class="form-horizontal form-small-spacing" novalidate>\r\n            <div class="form-group">\r\n                <span class="col-md-4 control-label">Chiffre d\'affaires de référence</span>\r\n                <div class="col-md-8 control-div">\r\n                    <p>\r\n                        <strong ng-show="modaleCtrl.donneesHistoriqueBilan.montantChiffreAffaireReference" ng-bind="modaleCtrl.donneesHistoriqueBilan.montantChiffreAffaireReference + \' k€\'"></strong>\r\n                        <strong ng-show="!modaleCtrl.donneesHistoriqueBilan.montantChiffreAffaireReference">-</strong>\r\n                    </p>\r\n                </div>\r\n            </div><br>\r\n            <div class="form-group">\r\n                <mw-table options="modaleCtrl.tableauHistoriqueBilans" id="tableau-historique-bilans"></mw-table>\r\n            </div>\r\n            <div class="form-group">\r\n                <span class="col-md-4 control-label">Chiffre d\'affaires moyenné</span>\r\n                <div class="col-md-8 control-div">\r\n                    <p>\r\n                        <strong ng-show="modaleCtrl.donneesHistoriqueBilan.montantChiffreAffaireMoyen" ng-bind="modaleCtrl.donneesHistoriqueBilan.montantChiffreAffaireMoyen + \' k€\'"></strong>\r\n                        <strong ng-show="!modaleCtrl.donneesHistoriqueBilan.montantChiffreAffaireMoyen">-</strong>\r\n                    </p>\r\n                </div>\r\n            </div>\r\n        </form>\r\n    </mw-panel>\r\n    <mw-panel niveau="2" titre="Engagements" ng-if="modaleCtrl.data.dateArreteEngagement">\r\n        <form class="form-horizontal form-small-spacing" novalidate>\r\n            <div class="form-group">\r\n                <span class="col-md-7 control-label">Montant des engagements de segmentation</span>\r\n                <div class="col-md-5 control-div">\r\n                    <strong ng-bind="::modaleCtrl.data.montantEngagementTiers | number:2"></strong>\r\n                    <strong> €</strong>\r\n                </div>\r\n            </div>\r\n            <div class="form-group">\r\n                <span class="col-md-7 control-label">Date d\'arrêté dernière variation du montant des engagements</span>\r\n                <div class="col-md-5 control-div"><strong ng-bind="::modaleCtrl.data.dateArreteEngagement"></strong></div>\r\n            </div>\r\n        </form>\r\n    </mw-panel>\r\n    <mw-panel niveau="2" titre="CA consolidé du groupe formel" ng-if="modaleCtrl.data.dateArreteBilan">\r\n        <form class="form-horizontal form-small-spacing" novalidate>\r\n            <div class="form-group">\r\n                <span class="col-md-4 control-label">Chiffre d\'affaire</span>\r\n                <div class="col-md-8 control-div">\r\n                    <strong ng-bind="::modaleCtrl.data.montantCAConsolide | number:2"></strong>\r\n                    <strong> €</strong>\r\n                </div>\r\n            </div>\r\n            <div class="form-group">\r\n                <span class="col-md-4 control-label">Date d\'arrêté de bilan</span>\r\n                <div class="col-md-8 control-div"><strong ng-bind="::modaleCtrl.data.dateArreteBilan"></strong></div>\r\n            </div>\r\n        </form>\r\n    </mw-panel>\r\n</div>\r\n<div class="modal-footer">\r\n    <div class="col-sm-offset-9 col-sm-3">\r\n        <button type="button" id="btn-fermer" class="btn btn-primary" ng-click="modaleCtrl.cancel()">Fermer</button>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/segmentation-risque/modale-historique/historique-tr-detail-vue.html",'<div collapse="!mwTableRow.expanded">\r\n    <div class="detail-tr">\r\n        <form class="form-horizontal form-small-spacing" novalidate>\r\n            <div class="form-group">\r\n                <span class="col-md-3 control-label">Libellé segmentation avant</span>\r\n                <div class="col-md-9 control-div"><strong ng-bind="::mwTableRow.descriptionSRCCAncien"></strong></div>\r\n            </div>\r\n            <div class="form-group">\r\n                <span class="col-md-3 control-label">Libellé segmentation après</span>\r\n                <div class="col-md-9 control-div"><strong ng-bind="::mwTableRow.descriptionSRCCActuel"></strong></div>\r\n            </div>\r\n            <div class="form-group">\r\n                <span class="col-md-3 control-label">Grappage</span>\r\n                <div class="col-md-9 control-div">\r\n                    <strong ng-if="mwTableRow.indicateurSegmentationGrappage">Oui</strong>\r\n                    <strong ng-if="!mwTableRow.indicateurSegmentationGrappage">Non</strong>\r\n                </div>\r\n            </div>\r\n            <div class="form-group" ng-if="mwTableRow.agentMAJSegmentation">\r\n                <span class="col-md-3 control-label">Agent</span>\r\n                <div class="col-md-9 control-div"><strong ng-bind="::mwTableRow.agentMAJSegmentation"></strong></div>\r\n            </div>\r\n            <div class="form-group" ng-if="mwTableRow.commentaireForcageSegmentation">\r\n                <span class="col-md-3 control-label">Commentaire forçage</span>\r\n                <div class="col-md-9 control-div"><strong ng-bind="::mwTableRow.commentaireForcageSegmentation"></strong></div>\r\n            </div>\r\n        </form>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/segmentation-risque/modale-historique/modale-historique-vue.html",'<div class="modal-header">\r\n    <button type="button" id="btn-croix" ng-click="modaleCtrl.cancel()" class="close" aria-hidden="true"><span class="icon itce-times"></span></button>\r\n    <h1 class="modal-title">Historique Catégorie Client / Segmentation Risque{{modaleCtrl.titreNbElement}}</h1>\r\n</div>\r\n<div class="modal-body texte-gros row" mw-chargement="modaleCtrl.loading">\r\n    <mw-table options="modaleCtrl.tableauOptionsHistorique" id="tableau-historique"></mw-table>\r\n</div>\r\n<div class="modal-footer">\r\n    <div class="col-sm-offset-9 col-sm-3">\r\n        <button type="button" id="btn-fermer" class="btn btn-primary" ng-click="modaleCtrl.cancel()">Fermer</button>\r\n    </div>\r\n</div>\r\n')}]);