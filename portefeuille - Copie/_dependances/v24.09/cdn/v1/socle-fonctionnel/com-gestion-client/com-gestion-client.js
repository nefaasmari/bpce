/**
 * Généré par : SIGCESIE\ct-tfsbuild
 * Changeset TFS : C635385
 * Etiquette TFS : com-gestion-client-v21.11_20211206.1
 * Déclenchement : IndividualCI
 */
"use strict";var myway;!function(e){var t;!function(e){e.app=angular.module("myway.comGestionClient",["ui.bootstrap","myway.comInterdomaine","moduleAgent","myway.comEds","ngSanitize"])}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){function t(e,t){return{restrict:"A",scope:{clickOutMenuGestionClient:"&"},link:function(n,r,i){t(function(){angular.element(e).on("click",function(e){r[0].contains(e.target)||(n.clickOutMenuGestionClient(),n.$apply())})},200),n.$on("$destroy",function(){angular.element(e).off("click")})}}}e.clickOutMenuGestionClient=t,e.app.directive("clickOutMenuGestionClient",["$window","$timeout",t])}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){e.capaciteJuridiquePP=["00","03","04","05","06","08","10","11","12","13","14","15","16","17","18","19","20"]}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t=function(){function e(){}return e.SELECT_CLIENT="select-client",e.RECH_PM="rech-pm",e.CACHER_DROPDOWN="cacher-dropdown",e.AFFICHER_DROPDOWN="afficher-dropdown",e}();e.CustomEvents=t}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t=function(){function e(){}return e.PERSONNEL="P",e.PROFESSIONNEL="T",e.SOL="A",e}();e.CodeTypeUsageMedia=t}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t=function(){function t(e,t,n,r,i){this.$q=e,this.$templateCache=t,this.$interpolate=n,this.$document=r,this.$timeout=i,this.minDelay=0,this.BACKGROUND_ZINDEX=1e4,this.POSITION="fixed",this.SPINNER_HEIGHT=2,this.PROGRESS_HEIGHT=14,this.SPINNER_WIDTH=2,this.TEXT_WIDTH=30,this.BACKGROUND="rgba(255, 255, 255, 0)",this.backgroundStack=0}return t.prototype.start=function(t){if(!this.startLoaderPromise){t=_.merge({},e.loaderDefaultSettings,t);var n=this.getRootElement(t.rootElementId);this.startLoaderPromise=this.$timeout(function(){},this.minDelay),this.addLoader(n,t.text),t.background&&this.addBackground(n)}},t.prototype.stop=function(e){var t=this;this.startLoaderPromise&&(e=_.merge({},{},e),this.startLoaderPromise.then(function(){t.startLoaderPromise=void 0,t.removeLoader(),t.removeBackground()}))},t.prototype.startProgress=function(t){if(!this.progressPromise){if(this.progressSettings=_.merge({},e.progressDefaultSettings,t),!t.steps.stepCount)return void console.warn("LoaderService","Barre de progression désactivée: nombre d'étapes non spécifié");if(!this.progressSettings.steps.stepWeights){this.progressSettings.steps.stepWeights=[];for(var n=100/this.progressSettings.steps.stepCount,r=0;r<this.progressSettings.steps.stepCount;r++)this.progressSettings.steps.stepWeights.push(n)}var i=this.getRootElement(this.progressSettings.rootElementId);this.progressPromise=this.$timeout(function(){}),this.addProgress(i),this.progressSettings.steps.currentStep--,this.goToNextProgressStep(),this.progressSettings.background&&this.addBackground(i)}},t.prototype.restartProgress=function(e){return this.progressSettings?void(this.progressPromise||(e&&(this.progressSettings.steps.currentStep=e),this.startProgress(this.progressSettings))):void console.warn("LoaderService","Barre de progression jamais activée, impossible de la relancer sans configuration")},t.prototype.stopProgress=function(){var e=this;this.progressPromise&&(this.progressPromise=this.progressPromise.then(function(){return e.$timeout(function(){e.progressPromise=void 0,e.removeProgress(),e.removeBackground()},e.progressSettings.stopTimeout)}))},t.prototype.goToNextProgressStep=function(){var e=this;this.progressPromise&&this.progressBarElement&&this.progressStepElement&&(this.progressPromise=this.progressPromise.then(function(){var t=e.progressSettings.steps.lastStepTime?(new Date).getTime()-e.progressSettings.steps.lastStepTime:0,n=t>=e.progressSettings.steps.stepTimeout?0:e.progressSettings.steps.stepTimeout;return e.$timeout(function(){e.progressSettings.steps.currentStep=Math.min(++e.progressSettings.steps.currentStep,e.progressSettings.steps.stepCount+1);var t=_.reduce(e.progressSettings.steps.stepWeights.slice(0,e.progressSettings.steps.currentStep-1),function(e,t){return e+t},0),n=Math.min(e.progressSettings.steps.currentStep,e.progressSettings.steps.stepCount),r="Etape "+n+" sur "+e.progressSettings.steps.stepCount;e.progressBarElement.setAttribute("aria-valuenow",t+""),e.progressBarElement.setAttribute("aria-valuetext",r),e.progressBarElement.style.width=t+"%",e.progressStepElement.innerText=r,e.progressSettings.steps.lastStepTime=(new Date).getTime(),100===t&&e.stopProgress()},n)}))},t.prototype.addLoader=function(e,t){this.loaderElement||(this.loaderElement=document.createElement("div"),this.loaderElement.appendChild(this.getSpinnerElement()),t&&this.loaderElement.appendChild(this.getTextElement(t)),e.appendChild(this.loaderElement))},t.prototype.getSpinnerElement=function(){var e=document.createElement("div");return e.setAttribute("role","status"),e.style.zIndex=this.BACKGROUND_ZINDEX+1+"",e.style.position=this.POSITION,e.style.height=this.SPINNER_HEIGHT+"rem",e.style.width=this.SPINNER_WIDTH+"rem",e.style.fontSize="2rem",e.style.top="calc(50% - "+this.SPINNER_HEIGHT/2+"rem)",e.style.left="calc(50% - "+this.SPINNER_WIDTH/2+"rem)",e.style.background=this.BACKGROUND,e.style.animation="cssload-roto 1.15s infinite linear",e.innerHTML='<span aria-hidden="true" class="icon itce-spinner"></span>',e},t.prototype.getTextElement=function(e){var t=document.createElement("div");return t.style.zIndex=this.BACKGROUND_ZINDEX+1+"",t.style.position=this.POSITION,t.style.height=this.SPINNER_HEIGHT+"rem",t.style.width=this.TEXT_WIDTH+"rem",t.style.fontSize="1.5rem",t.style.color="#067b15",t.style.top="calc(50% + "+this.SPINNER_HEIGHT+"rem)",t.style.left="calc(50% - "+this.TEXT_WIDTH/2+"rem)",t.style.background=this.BACKGROUND,t.style.textAlign="center",t.innerText=e,t},t.prototype.removeLoader=function(){this.loaderElement&&(this.loaderElement.parentNode.removeChild(this.loaderElement),this.loaderElement=void 0)},t.prototype.addBackground=function(e){this.backgroundStack++,this.backgroundElement||(this.backgroundElement=this.getBackgroundElement(),e.appendChild(this.backgroundElement))},t.prototype.removeBackground=function(){this.backgroundElement&&(this.backgroundStack--,0===this.backgroundStack&&(this.backgroundElement.parentNode.removeChild(this.backgroundElement),this.backgroundElement=void 0))},t.prototype.getBackgroundElement=function(){var e=document.createElement("div");return e.style.zIndex=this.BACKGROUND_ZINDEX+"",e.style.position=this.POSITION,e.style.background="black",e.style.top="0",e.style.bottom="0",e.style.left="0",e.style.right="0",e.style.opacity="0.25",e},t.prototype.addProgress=function(e){this.progressElement||(this.progressElement=this.getProgressContainerElement(),this.progressElement.appendChild(this.getSimpleRowElement(this.progressSettings.title)),this.progressElement.appendChild(document.createElement("hr")),this.progressElement.appendChild(this.getSimpleRowElement(this.progressSettings.text)),this.progressElement.appendChild(this.getProgressBarElement()),this.progressStepElement=this.getProgressStepElement(),this.progressElement.appendChild(this.progressStepElement),e.appendChild(this.progressElement))},t.prototype.removeProgress=function(){this.progressElement&&(this.progressElement.parentNode.removeChild(this.progressElement),this.progressElement=void 0,this.progressBarElement=void 0,this.progressStepElement=void 0)},t.prototype.getProgressContainerElement=function(){var e=document.createElement("div");return e.style.zIndex=this.BACKGROUND_ZINDEX+10+"",e.style.position=this.POSITION,e.style.height=this.PROGRESS_HEIGHT+"rem",e.style.top="35%",e.style.left=this.progressSettings.horizontalMargins,e.style.right=this.progressSettings.horizontalMargins,e.style.padding="1.5625rem",e.style.backgroundColor="white",e.style.font="normal small-caps 2em arial, helvetica, sans-serif",e.style.letterSpacing="2pt",e.style.wordSpacing="2pt",e.style.textAlign="center",e.style.lineHeight="1",e.style.border="solid 5px #c8c8c8",e.style.borderRadius="1.25rem",e},t.prototype.getSimpleRowElement=function(e){var t=document.createElement("div");return t.setAttribute("class","row"),t.innerText=e,t},t.prototype.getProgressBarElement=function(){var e=function(e){e.style.marginTop="20px",e.style.height="0.375rem",e.style.background="#efefef",e.style.borderRadius="0"},t=document.createElement("div");e(t),t.style.backgroundColor="#D00019",t.style.transition="width 0.05s ease-in-out",t.setAttribute("role","progressbar"),t.setAttribute("aria-valuemin","0"),t.setAttribute("aria-valuemax","100"),t.style.width="0",this.progressBarElement=t;var n=document.createElement("div");return e(n),n.appendChild(t),n},t.prototype.getProgressStepElement=function(){var e=document.createElement("div");return e.style.color="#D00019",e.style.fontSize="0.7em",e.style.letterSpacing="3pt",e.style.wordSpacing="-3pt",e.style.textAlign="left",e.style.lineHeight="1",e},t.prototype.getRootElement=function(e){return document.getElementById(e)||document.getElementsByTagName("body")[0]},t.$inject=["$q","$templateCache","$interpolate","$document","$timeout"],t}();e.LoaderService=t,e.app.service("mwgcLoaderService",t)}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){e.loaderDefaultSettings={background:!0},e.progressDefaultSettings={background:!0,text:"Chargement des données de l'application en cours...",horizontalMargins:"2.5rem",stopTimeout:400,steps:{currentStep:1,stepTimeout:300}}}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t=function(){function e(){}return e}();e.ComplementPersonnePhysique=t;var n=function(){function e(){}return e}();e.GestionPriveeComplementPersonnePhysique=n;var r=function(){function e(){}return e}();e.StatutProComplementPersonnePhysique=r;var i=function(){function e(){}return e}();e.ComplementPersonneMorale=i;var s=function(){function e(){}return e}();e.SituationFinanciereComplementPersonneMorale=s;var o=function(){function e(){}return e}();e.AdresseComplementPersonneMorale=o;var c=function(){function e(){}return e}();e.EtablissementComplementPersonneMorale=c}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t=function(){function e(e,t){this.codeEtablissement=e,this.identifiantPersonne=t}return e}();e.ConfidentialiteClient=t}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t=function(){function e(e,t,n){this.creationPersonne=e,this.creationProspect=n,this.creationTiers=t}return e}();e.ParametrageBouton=t}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t=function(){function e(e){e&&(this.siren=e.siren,this.raisonSocial=e.raisonSocial,this.villeSiege=e.villeSiege,this.bureauRattachement=e.bureauRattachement)}return e}();e.PersonneMorale=t}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t=function(){function e(e){e&&(this.nom=e.nom,this.prenom=e.prenom,this.dateNaissance=e.dateNaissance,this.sexe=e.sexe,this.bureauRattachement=e.bureauRattachement)}return e}();e.PersonnePhysique=t;var n=function(){function e(){}return e.getDesignation=function(t,n,r,i){var s=e.getCivilite(t);return _.compact([s,n||r,i]).join(" ")},e.getDesignationCourte=function(e,t,n){return _.compact([e||t,n]).join(" ")},e.getDesignationHistorique=function(t,n,r,i){var s=[n||r,i];return n&&n!==r&&s.push("né"+(e.estFemme(t)?"e":"")+" "+r),_.compact(s).join(" ")},e.getCivilite=function(t){var n=_.find(e.CIVILITES,function(e){return e.code===t||e.label===t});return n?n.label:t},e.estHomme=function(t){var n=_.find(e.CIVILITES,function(e){return e.code===t||e.label===t});return"3"===(n?n.code:t)},e.estFemme=function(t){var n=_.find(e.CIVILITES,function(e){return e.code===t||e.label===t});return"3"!==(n?n.code:t)},e.CIVILITES=[{code:"1",label:"MME"},{code:"2",label:"MLLE"},{code:"3",label:"M"}],e}();e.ClientUtils=n}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t=function(){function e(){}return e.PERSONNE_PHYSIQUE="1",e.PERSONNE_MORALE="2",e}();e.CodesPersonnaliteJuridique=t;var n=function(){function e(){}return e.PERSONNE_PHYSIQUE="personne-physique",e.PERSONNE_MORALE="personne-morale",e}();e.ModesAppelRecherche=n}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t=function(){function e(e,t){this.codeQualite=e,this.libelle=t}return e}();e.Qualite=t;var n=function(){function e(){}return e}();e.RecherchePersonneRetour=n;var r=function(){function e(){this.criteres=new MyWay.Model.Client,this.criteres.bureauRatachement=new MyWay.Model.Agence,this.criteres.numeroTelephone=new MyWay.Model.NumTelephone,this.etat=0}return e.prototype.isPersonneSelectionnee=function(){return null!=this.personnes&&this.personnes.length>0},e.prototype.isNoSelectedCriteria=function(){return null==this.type},e.prototype.isTypeRechercheIdentite=function(){return 0===this.type},e.prototype.isTypeRechercheRaisonSociale=function(){return 5===this.type},e.prototype.isTypeRechercheSIREN=function(){return 4===this.type},e.prototype.isTypeRechercheCompte=function(){return 1===this.type},e.prototype.isTypeRechercheCarteBleu=function(){return 3===this.type},e.prototype.isTypeRechercheEmail=function(){return 7===this.type},e.prototype.isTypeRechercheTelephone=function(){return 8===this.type},e.prototype.isTypeRechercheCredit=function(){return 9===this.type},e.prototype.isTypeRechercheNumeroPersonne=function(){return 2===this.type},e.prototype.isTypeRechercheIdentifiantClient=function(){return 6===this.type},e.prototype.isNoSearch=function(){return 0===this.etat},e.prototype.isSearchRequest=function(){return 1===this.etat},e.prototype.isNoResult=function(){return 2===this.etat},e.prototype.isSearchError=function(){return 4===this.etat},e.prototype.isSearchSuccessful=function(){return 3===this.etat},e}();e.RecherchePersonneResult=r}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var MyWay;!function(e){var t;!function(e){var t=function(){function e(e){this.$scope=e,this.sens="haut"===this.position?"up":"down",this.ouvert=!1}return e.prototype.afficherDropdown=function(){this.sens="haut"===this.position?"down":"up",this.ouvert=!0,this.$scope.$emit(myway.comGestionClient.CustomEvents.AFFICHER_DROPDOWN)},e.prototype.cacherDropdown=function(){this.sens="haut"===this.position?"up":"down",this.ouvert=!1,this.$scope.$emit(myway.comGestionClient.CustomEvents.CACHER_DROPDOWN)},e.prototype.getSens=function(){return this.sens},e.prototype.toggle=function(e){e?this.afficherDropdown():this.cacherDropdown()},e.$inject=["$scope"],e}();e.MwBoutonListeActionsControllerGestionClient=t,e.module.controller("MwBoutonListeActionsControllerGestionClient",t)}(t=e.UI||(e.UI={}))}(MyWay||(MyWay={}));var MyWay;!function(e){var t;!function(t){function n(){return{restrict:"E",transclude:!0,templateUrl:"typescript/mw-bouton-liste-actions/mw-bouton-liste-actions-view.html",controller:"MwBoutonListeActionsControllerGestionClient",controllerAs:"mwBoutonListeActionsCtrl",bindToController:!0,scope:{titre:"@",data:"=",modele:"@",position:"@?",disabled:"=?mwDisabled"},compile:function(t,n){function r(e){var t=angular.element(e);t.attr("id",s+"-"+t.attr("id"))}function i(e){angular.element(e).removeAttr("id")}var s=n.id;return angular.forEach(t[0].querySelectorAll("[id]"),s?r:i),function(t,n){function r(t){function r(){var e=n.find("a");t.preventDefault(),t.stopPropagation(),i=(i+e.length)%e.length,e[i].focus()}switch(t.keyCode){case e.UI.Constants.CLAVIER_KEYCODE.FLECHE_HAUT:i--,r();break;case e.UI.Constants.CLAVIER_KEYCODE.FLECHE_BAS:i++,r();break;case e.UI.Constants.CLAVIER_KEYCODE.TAB:t.shiftKey?i--:i++}}var i=-1;t.$watch("mwBoutonListeActionsCtrl.ouvert",function(e){e||(i=-1)}),t.focusSuivant=r}}}}t.module.directive("mwBoutonListeActionsGestionClient",["$timeout","$document",n])}(t=e.UI||(e.UI={}))}(MyWay||(MyWay={}));var myway;!function(e){var t;!function(e){e.app.directive("mwsfNumCreditInput",function(){return{require:"ngModel",link:function(e,t,n,r){r.$parsers.push(function(e){if(void 0===e||!e)return"";var t=e.replace(/[^a-zA-Z0-9\s\/\-\.\_\ ]/g,"");return t!==e&&(r.$setViewValue(t),r.$render()),t})}}})}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n=function(){function n(e,t,n,r,i,s,o){var c=this;this.$scope=e,this.$attrs=t,this.serviceAgentExtended=n,this.mwgcRechercherPersonneService=r,this.agentConnecteService=i,this.$timeout=s,this.$q=o,this.RECHERCHE_TAB_ID="onglet-recherche",this.HISTORY_TAB_ID="onglet-historique",this.btnNatureQualiteDetail=!1,this.recherchePersonnePhysique=!1,this.recherchePersonneMorale=!1,this.raisonSocialeRequired=!1,this.nomRequired=!1,this.loading=!1,this.ongletActiverPM=!1,this.ongletActiverPP=!1,this.esSirenReferencer=!1,this.isNotSirenMySysAndNotSiren=!1,this.rechercheRaisonSociale=!1,this.isAgentHenin=void 0,this.initConstructor(),this.initHistory(),this.$scope.$watch(function(){return c.lancerRecherche},function(e,t){e===!0&&c.result.criteres.raisonSociale&&!c.result.criteres.bureauRatachement?(c.rechercher(),c.lancerRecherche=!1):e===!0&&c.result.criteres.siren&&c.result.criteres.siren.length<9&&(c.result.criteres.siren=_.padLeft(c.result.criteres.siren,9,"0"))}),this.$scope.$watch(function(){return c.sirenValid&&c.lancerRecherche},function(e,t){e===!0&&(c.rechercher(),c.lancerRecherche=!1)}),this.$scope.$watch(function(){return c.result.criteres.bureauRatachement&&c.result.criteres.bureauRatachement.id&&c.lancerRecherche},function(e,t){e===!0&&(c.rechercher(),c.lancerRecherche=!1)})}return n.prototype.initConstructor=function(){var e=this;angular.isUndefined(this.filtreRecherche)&&(this.filtreRecherche=!1),angular.isUndefined(this.afficherNumPersonne)&&(this.afficherNumPersonne=!0),this.$attrs.$observe("afficherNumPersonne",function(){"string"==typeof e.afficherNumPersonne&&(e.afficherNumPersonne="true"===e.afficherNumPersonne)}),this.$scope.$watch(function(){return e.esSirenReferencer},function(t,n){e.$scope.$emit("esSirenReferencer",t)}),this.$scope.$watch(function(){return e.isNotSirenMySysAndNotSiren},function(t,n){e.$scope.$emit("isNotSirenMySysAndNotSiren",t)}),this.$scope.$watch(function(){return e.btnNatureQualiteDetail},function(t,n){e.$scope.$emit("btnNatureQualiteDetail",t)}),this.$scope.$watch(function(){return e.personneMoraleSelectionnee&&e.personneMoraleSelectionnee.length>0},function(t,n){t&&(e.result.personnes=e.personneMoraleSelectionnee)}),this.agentConnecteService.estAgenceConnecteLaHenin().then(function(t){e.setIsAgentHenin(t)}),this.mwgcRechercherPersonneService.setAppelRechercheModeNormal(!0),this.mwgcRechercherPersonneService.getAppelRechercheModeModale()&&(this.mwgcRechercherPersonneService.getCreationPersonneBtnVisibilityBool()?this.cacherBtnQualiterNature="false":this.cacherBtnQualiterNature="true"),angular.isUndefined(this.cacherBtnQualiterNature)&&(this.cacherBtnQualiterNature="false"),this.init(),this.construitListeHistorique(),this.$scope.$on(MyWay.CustomEvents.ENTER_KEYPRESS,function(e){e.stopPropagation()}),this.$scope.$watch(function(){return e.result.critereIsEmpty},function(t,n){t&&(e.result.etat=0,e.result.type=999)}),this.$scope.$watch(function(){return e.result.critereIsEmpty},function(t,n){t&&(e.isLaHeninNomFamille=e.isLaHeninPrenom=e.isLaHeninDateNaissance=!1)}),this.$scope.$watch(function(){return e.result.criteres.raisonSociale},function(t,n){t?e.result.critereIsEmpty=!1:e.result.critereIsEmpty=!0,e.esSirenReferencer=!1,e.isNotSirenMySysAndNotSiren=!1}),this.$scope.$watch(function(){return e.result.criteres.raisonSociale&&(e.result.clientListe&&e.result.clientListe.length>0||e.result.personnes&&e.result.personnes.length>0)},function(t,n){t?e.rechercheRaisonSociale=!0:e.rechercheRaisonSociale=!1}),this.$scope.$watch(function(){return e.result.criteres.raisonSociale&&e.result.errorMessage},function(t,n){t?e.rechercheRaisonSociale=!0:e.rechercheRaisonSociale=!1}),this.$scope.$watch(function(){return e.result.criteres.siren&&e.result.errorMessage&&e.result.errorMessage.length>0&&0!==e.result.etat},function(t,n){t&&e.rechercherSiretAsync(parseInt(e.result.criteres.siren))}),this.$scope.$watch(function(){return e.getClientListe()&&e.getClientListe().length>0},function(t,n){t&&1===e.getClientListe().length&&8===e.result.type&&(e.loading=!1,e.result.clientListe=e.clientListe)}),this.$scope.$watch(function(){return e.restitutionListePM&&e.restitutionListePM.length>0},function(t,n){t?e.setPersonnesMoraleList(e.restitutionListePM):e.setPersonnesMoraleList([])}),this.$scope.$watch(function(){return e.restitutionListePP&&e.restitutionListePP.length>0},function(t,n){t?e.setPersonnesPhysiqueList(e.restitutionListePP):e.setPersonnesPhysiqueList([])}),this.$scope.$watch(function(){return e.getPersonnesMoraleList()&&e.getPersonnesMoraleList().length>0},function(t,n){t?(e.result.personnes=[],e.clientListe=e.getPersonnesMoraleList(),e.result.clientListe=e.clientListe,e.result.personnes=[e.clientListe[0]]):e.result.personnes=[]}),this.$scope.$watch(function(){return e.getPersonnesPhysiqueList()&&e.getPersonnesPhysiqueList().length>0},function(t,n){e.ongletActiverPP=!0,t?(e.result.personnes=[],e.clientListe=e.getPersonnesPhysiqueList(),e.result.clientListe=e.clientListe,e.result.personnes=[e.clientListe[0]]):e.result.personnes=[]}),this.$scope.$watch(function(){return e.getPersonnesPhysiqueList()&&e.getPersonnesPhysiqueList().length>0&&e.getPersonnesMoraleList()&&e.getPersonnesMoraleList().length>0&&e.ongletActiverPM},function(t,n){t&&(e.clientListe=e.getPersonnesMoraleList(),e.result.personnes=[],e.result.personnes=e.getPersonnesMoraleList())}),this.$scope.$watch(function(){return e.getPersonnesPhysiqueList()&&e.getPersonnesPhysiqueList().length>0&&e.getPersonnesMoraleList()&&e.getPersonnesMoraleList().length>0&&e.ongletActiverPP},function(t,n){t&&(e.clientListe=e.getPersonnesPhysiqueList(),e.result.personnes=[],e.result.personnes=e.getPersonnesPhysiqueList())}),this.$scope.$watch(function(){return e.modeAppel},function(n,r){e.mwgcRechercherPersonneService.setModeAppel(n),angular.isUndefined(r)&&(e.mwgcRechercherPersonneService.setModeAppel(null),e.recherchePersonnePhysique=!0,e.recherchePersonneMorale=!0),angular.isDefined(e.modeAppel)&&n&&(n===t.ModesAppelRecherche.PERSONNE_PHYSIQUE&&(e.recherchePersonnePhysique=!0),n===t.ModesAppelRecherche.PERSONNE_MORALE&&(e.recherchePersonneMorale=!0)),e.rechercheAvancee=e.recherchePersonneMorale&&e.recherchePersonnePhysique?!0:!1,e.afficherMiniRechercheNumPersonne=e.recherchePersonneMorale&&!e.recherchePersonnePhysique||e.recherchePersonnePhysique&&!e.recherchePersonneMorale}),this.$scope.$watch(function(){return e.filtreRecherche},function(t,n){e.mwgcRechercherPersonneService.setFiltreRecherche(t)}),this.$scope.$watch(function(){return e.mwgcRechercherPersonneService.getCreationPersonneBtnVisibilityBool()},function(t,n){angular.isDefined(t)&&(e.creationPersonneBtnVisibilityBool=t),angular.isUndefined(t)&&(e.creationPersonneBtnVisibilityBool=!0,e.mwgcRechercherPersonneService.setCreationPersonneBtnVisibilityBool(!0))}),this.$scope.$watch(function(){return e.result.criteres.email},function(t,n){t?(e.initTypeRecherche(),e.selectTypeRecherche(7),e.result.critereIsEmpty=!1):(e.result.critereIsEmpty=!0,e.loading=!1,e.initTypeRecherche())}),this.$scope.$watch(function(){return e.result.criteres.numeroTelephone.toString()},function(t,n){t&&t.length>10?(e.initTypeRecherche(),e.selectTypeRecherche(8),e.result.critereIsEmpty=!1):(e.result.critereIsEmpty=!0,e.loading=!1,e.initTypeRecherche())}),this.$scope.$watch(function(){return e.result.criteres.sexe},function(t,n){t&&(e.initTypeRecherche(),0!==t.toLowerCase().localeCompare("m")&&0!==t.toLocaleLowerCase().localeCompare("f")?e.result.criteres.sexe=null:(e.result.critereIsEmpty=!0,e.initTypeRecherche(),e.result.criteres.sexe=t.toUpperCase()))}),this.$scope.$watch(function(){return e.result.criteres.nomFamille},function(t,n){t?(e.initValueListe(),e.initTypeRecherche(),e.selectTypeRecherche(0),e.result.critereIsEmpty=!1):(e.result.critereIsEmpty=!0,e.loading=!1,e.initTypeRecherche())}),this.$scope.$watch(function(){return e.result.criteres.prenom},function(t,n){t?(e.initValueListe(),e.initTypeRecherche(),e.selectTypeRecherche(0),e.result.critereIsEmpty=!1):(e.result.critereIsEmpty=!0,e.initTypeRecherche())}),this.$scope.$watch(function(){return e.result.criteres.dateNaissance},function(t,n){t?(e.initValueListe(),e.initTypeRecherche(),e.selectTypeRecherche(0),e.result.critereIsEmpty=!1):(e.initTypeRecherche(),e.result.critereIsEmpty=!0)}),this.$scope.$watch(function(){return e.result.criteres.sexe},function(t,n){t?(e.initValueListe(),e.initTypeRecherche(),e.selectTypeRecherche(0),e.result.critereIsEmpty=!1):(e.initTypeRecherche(),e.result.critereIsEmpty=!0)}),this.$scope.$watch(function(){return e.result.criteres.numeroPersonne},function(t,n){t?(e.result.critereIsEmpty=!1,e.initTypeRecherche(),e.selectTypeRecherche(2)):(e.result.critereIsEmpty=!0,e.loading=!1,e.initTypeRecherche())}),this.$scope.$watch(function(){return e.result.criteres.numeroCarte},function(t,n){t.isNotEmpty()?(e.initTypeRecherche(),e.selectTypeRecherche(3),e.result.critereIsEmpty=!1):(e.result.critereIsEmpty=!0,e.loading=!1,e.initTypeRecherche())},!0),this.$scope.$watch(function(){return e.result.criteres.rice.codeActiviteCompte},function(t,n){t?(e.initTypeRecherche(),e.selectTypeRecherche(1),e.result.critereIsEmpty=!1):(e.result.critereIsEmpty=!0,e.initTypeRecherche())}),this.$scope.$watch(function(){return e.result.criteres.numeroCredit},function(t,n){t&&(e.result.criteres.numeroCredit=t.toUpperCase(),e.selectTypeRecherche(9),e.result.critereIsEmpty=!1)}),this.$scope.$watch(function(){return e.result.criteres.rice.radical},function(t,n){t?(e.initTypeRecherche(),e.selectTypeRecherche(1),e.result.critereIsEmpty=!1):(e.result.critereIsEmpty=!0,e.loading=!1,e.initTypeRecherche())},!0),this.$scope.$watch(function(){return e.result.criteres.rice.codeGuichet},function(t,n){t&&(e.result.errorMessage="")}),this.$scope.$watch(function(){return e.result.criteres.siren},function(t,n){t?(e.initTypeRecherche(),e.selectTypeRecherche(4),e.result.critereIsEmpty=!1,e.isNotSirenMySysAndNotSiren=null,e.esSirenReferencer=null):(e.result.critereIsEmpty=!0,e.isNotSirenMySysAndNotSiren=!1,e.esSirenReferencer=!1,e.loading=!1,e.initTypeRecherche())},!0),this.$scope.$watch(function(){return e.result.criteres.raisonSociale},function(t,n){t?(e.loading=!0,e.initTypeRecherche(),e.result.criteres.raisonSociale=e.result.criteres.raisonSociale.toUpperCase(),e.selectTypeRecherche(5),e.result.critereIsEmpty=!1):(e.result.critereIsEmpty=!0,e.loading=!1,e.initTypeRecherche())}),this.$scope.$watch(function(){return e.result.criteres.villeSiege},function(t,n){t?(e.initTypeRecherche(),e.selectTypeRecherche(5),e.result.critereIsEmpty=!1):(e.initTypeRecherche(),e.result.critereIsEmpty=!0)}),this.$scope.$watch(function(){return e.result.criteres.bureauRatachement},function(t,n){t&&angular.isDefined(t.id)||angular.isString(t)?(e.clearTelephone(),e.clearEmail(),e.clearIdentifiantBad(),e.clearCompte(),e.clearNumeroCarte(),e.clearNumeroPersonne(),e.clearSiren(),e.initTypeRecherche(),e.recherchePersonnePhysique&&e.recherchePersonneMorale&&(e.raisonSocialeRequired=!1,e.nomRequired=!1),e.recherchePersonneMorale&&!e.recherchePersonnePhysique&&(e.raisonSocialeRequired=!0),e.recherchePersonnePhysique&&!e.recherchePersonneMorale&&(e.nomRequired=!0)):(e.loading=!1,e.raisonSocialeRequired=!1,e.nomRequired=!1)}),this.$scope.$watch(function(){return e.result.criteres.identifiantPersonne},function(t,n){t?(e.initTypeRecherche(),e.selectTypeRecherche(6),e.result.critereIsEmpty=!1):(e.result.critereIsEmpty=!0,e.loading=!1,e.initTypeRecherche())})},n.prototype.construitListeHistorique=function(){var e=this;this.listeRecherches=[];for(var t=[],n=1;100>n;n++)t.push("historiqueRecherche"+n);this.serviceAgentExtended.Preferences.lireMultiPreference(t).then(function(t){for(var n=0;n<t.length;n++)t[n]&&t[n].valeur&&(t[n].valeur=JSON.parse(t[n].valeur),e.listeRecherches.push(t[n]))})},n.prototype.rechercherSiretAsync=function(e){var t=this,n="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/referentiel-v1/referentielSIREN";return this.serviceAgentExtended.sendRequest({url:n,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{numeroSIREN:e}}).then(function(e){angular.forEach(e,function(e,n){return"1"!==e.codeStatutLieuActivite||e.libelleMessageErreur?void 0:(t.result.errorMessage=null,t.esSirenReferencer=!0,t.isNotSirenMySysAndNotSiren=!1,t.result.clientListe=[e],t.result.personnes=[e],e)})},function(e){t.result.errorMessage&&t.result.errorMessage.length>0&&(t.esSirenReferencer=!1,t.isNotSirenMySysAndNotSiren=!0)})},n.prototype.toggleBtnNatureQualite=function(){this.btnNatureQualiteDetail=!this.btnNatureQualiteDetail},n.prototype.selectionnerQualite=function(t,r,i){var s=this;this.btnNatureQualiteDetail=!1,t.codeNature=r.codeNature,t.codeQualite=new e.comGestionClient.Qualite(i.codeQualite,i.libelle),"PRO"===t.codeNature&&"AUT"===t.codeQualite.codeQualite?this.serviceAgentExtended.addToContext(MyWay.Context.DataKey.client,t).then(function(){s.serviceAgentExtended.Lisa.Next(1)}):(this.mwgcRechercherPersonneService.getAppelRechercheModeNormal()&&!this.mwgcRechercherPersonneService.getAppelRechercheModeModale()&&this.serviceAgentExtended.addToContext(MyWay.Context.DataKey.client,t).then(function(){s.serviceAgentExtended.Lisa.Next(13)}),this.mwgcRechercherPersonneService.getAppelRechercheModeNormal()&&this.mwgcRechercherPersonneService.getAppelRechercheModeModale()&&this.serviceAgentExtended.addToContext(MyWay.Context.DataKey.client,t).then(function(){s.$scope.$emit(n.EMIT_QUALITE_NATURE_DIRECTIVE)}))},n.prototype.rechercher=function(){var e=this;if(this.initValueListe(),!this.result.criteres.siren||this.sirenValid)switch(this.result.type=this.type,this.result.etat=0,this.result.personnes=[],this.result.errorMessage=null,this.result.type){case 8:this.loading=!0,this.mwgcRechercherPersonneService.rechercheGroupeTelephone(this.result.criteres).then(function(t){e.processSearchResults(t,!0),e.rechercheAvancee=!1,e.recherchePersonneMorale=!1,e.recherchePersonnePhysique=!1,e.rechercheAvancee2=!0,e.afficherBoutonModifierRecherche=!0},function(t){e.processError(t,e.$scope)});break;case 7:this.loading=!0,this.mwgcRechercherPersonneService.rechercheGroupeEmail(this.result.criteres).then(function(t){e.processSearchResults(t,!0),e.rechercheAvancee=!1,e.recherchePersonneMorale=!1,e.recherchePersonnePhysique=!1,e.rechercheAvancee2=!0,e.afficherBoutonModifierRecherche=!0},function(t){e.processError(t,e.$scope)});break;case 6:this.loading=!0,this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(t){e.mwgcRechercherPersonneService.rechercheGroupeIdentifiantBad(e.result.criteres).then(function(n){e.processSearchResults(n,!1),"1"===n[0].donneeCommune.codePersonnaliteJuridique?e.estUnClientPhysique=!0:e.estUnClientPhysique=!1,n[0].donneeCommune.identifiantPersonne&&e.mwgcRechercherPersonneService.getMedia(n[0].donneeCommune.identifiantPersonne,t.codeEtablissement).then(function(t){e.mwgcRechercherPersonneService.completerClientParMedia(e.clientListe[0],t)})},function(t){e.processError(t,e.$scope)})});break;case 5:this.loading=!0,angular.isDefined(this.result.criteres.raisonSociale)?this.result.criteres.raisonSociale.length<41?this.mwgcRechercherPersonneService.rechercheGroupeRaisonSociale(this.result.criteres).then(function(t){e.processSearchResults(t,!1),
e.rechercheAvancee=!1,e.recherchePersonneMorale=!0,e.recherchePersonnePhysique=!1,e.afficherMiniRechercheNumPersonne=!1,e.rechercheAvancee2=!1,e.afficherBoutonModifierRecherche=!0},function(t){e.processError(t,e.$scope)}):this.loading=!1:this.result.errorMessage=n.DEFAULT_PLUS_CRITERE,this.$scope.$emit(t.CustomEvents.RECH_PM);break;case 0:var r=this.getIsAgentHenin();(r&&this.result.criteres.nomFamille&&this.result.criteres.prenom&&this.result.criteres.dateNaissance||this.result.criteres.nomFamille)&&(r&&(this.isLaHeninNomFamille=this.isLaHeninPrenom=this.isLaHeninDateNaissance=!0),this.loading=!0,this.mwgcRechercherPersonneService.rechercheGroupeNom(this.result.criteres).then(function(t){e.processSearchResults(t,!1),console.log("liste des clients remonté",t),e.processComplementPersonnePhysique(t),e.rechercheAvancee=!1,e.recherchePersonneMorale=!1,e.recherchePersonnePhysique=!0,e.afficherMiniRechercheNumPersonne=!1,e.rechercheAvancee2=!1,e.afficherBoutonModifierRecherche=!0},function(t){e.processError(t,e.$scope)}));break;case 1:if(this.loading=!0,!this.result.criteres.rice.codeGuichet)return void this.processError(new MyWay.Services.Erreur("Erreur",["Le champ 'Guichet' doit être renseigné."]),this.$scope);this.mwgcRechercherPersonneService.rechercheGroupeRice(this.result.criteres.rice).then(function(t){e.processSearchResults(t,!1),e.result.criteres.rice&&"08"===e.result.criteres.rice.codeActiviteCompte?e.estUnClientPhysique=!1:e.estUnClientPhysique=!0,e.rechercheAvancee=!0,e.afficherMiniRechercheNumPersonne=e.recherchePersonnePhysique&&!e.recherchePersonneMorale||!e.recherchePersonnePhysique&&e.recherchePersonneMorale,e.recherchePersonneMorale=!1,e.recherchePersonnePhysique=!1,e.rechercheAvancee2=!1,e.afficherBoutonModifierRecherche=!0},function(t){e.processError(t,e.$scope)});break;case 2:this.loading=!0,this.mwgcRechercherPersonneService.getPersonneByIdentifiant(this.result.criteres.numeroPersonne,this.recherchePersonnePhysique,this.recherchePersonneMorale).then(function(n){e.estUnClientPhysique=n.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE,e.result.personnes=[n],e.processSearchResults(e.result.personnes,!1),e.result.etat=3,e.rechercheAvancee=!0,e.recherchePersonneMorale=!1,e.recherchePersonnePhysique=!1,e.rechercheAvancee2=!1,e.afficherBoutonModifierRecherche=!0,e.afficherMiniRechercheNumPersonne=e.recherchePersonnePhysique&&!e.recherchePersonneMorale||!e.recherchePersonnePhysique&&e.recherchePersonneMorale})["catch"](function(t){e.processError(t,e.$scope)});break;case 4:this.loading=!0,this.mwgcRechercherPersonneService.rechercheGroupeSiren(this.result.criteres).then(function(t){t&&1===t.length&&(e.processSearchResults(t,!1),e.rechercheAvancee=!1,e.recherchePersonneMorale=!0,e.recherchePersonnePhysique=!1,e.afficherMiniRechercheNumPersonne=!1,e.rechercheAvancee2=!1,e.afficherBoutonModifierRecherche=!0,e.loading=!1),t&&t.length>1&&(e.processSearchResults(t,!1),e.rechercheAvancee=!1,e.recherchePersonneMorale=!0,e.recherchePersonnePhysique=!1,e.afficherMiniRechercheNumPersonne=!1,e.rechercheAvancee2=!1,e.afficherBoutonModifierRecherche=!0)},function(t){e.processError(t,e.$scope)}),this.$scope.$emit(t.CustomEvents.RECH_PM);break;case 3:this.loading=!0,this.mwgcRechercherPersonneService.rechercheGroupeCarteBleu(this.result.criteres).then(function(t){if(e.result.personnes=[],!(t&&t.length>0))throw new MyWay.Services.Erreur("COM.ERREUR_INTERNE",["Le n° de la carte est introuvable."]);e.processSearchResults(t,!1),e.rechercheAvancee=!0,e.afficherMiniRechercheNumPersonne=e.recherchePersonnePhysique&&!e.recherchePersonneMorale||!e.recherchePersonnePhysique&&e.recherchePersonneMorale,e.recherchePersonneMorale=!1,e.recherchePersonnePhysique=!1,e.rechercheAvancee2=!1,e.afficherBoutonModifierRecherche=!0,e.loading=!1})["catch"](function(t){e.processError(t,e.$scope)});break;case 9:this.loading=!0,this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(t){e.mwgcRechercherPersonneService.rechercheGroupeNumeroCredit(e.result.criteres).then(function(r){if(!r||!r.length)return e.processError(new MyWay.Services.Erreur("Aucun résultat",[n.NO_RESULT]),e.$scope);if(!r[0].donneeCommune.identifiantPersonne||r[0].donneePersonnePhysique||r[0].donneePersonneMorale)e.processSearchResults(r,!0),e.rechercheAvancee=!1,e.recherchePersonneMorale=!1,e.recherchePersonnePhysique=!1,e.rechercheAvancee2=!0,e.afficherBoutonModifierRecherche=!0,e.loading=!1;else{var i=r[0].donneeCommune.identifiantPersonne;e.mwgcRechercherPersonneService.getInformationParticulier(i,t.codeEtablissement).then(function(n){e.mwgcRechercherPersonneService.getMedia(i,t.codeEtablissement).then(function(t){var r=e.mwgcRechercherPersonneService.completerClientParComplementInformationParticulier(n);e.mwgcRechercherPersonneService.completerClientParMedia(r,t),r.identifiantPersonne=i,e.processSearchResults([r],!0),e.rechercheAvancee=!1,e.recherchePersonneMorale=!1,e.recherchePersonnePhysique=!1,e.rechercheAvancee2=!0,e.afficherBoutonModifierRecherche=!0,e.loading=!1})})}},function(t){e.processError(t,e.$scope)})});break;default:this.result.etat=1}},n.prototype.keydown=function(t){t.keyCode===e.comInterdomaine.KeyCode.ENTER&&(t.preventDefault(),this.rechercher())},n.prototype.processSearchResults=function(e,r){this.getIsAgentHenin()&&5===this.result.type&&!this.result.criteres.siren&&(e=_.remove(e,function(e){return e.donneePersonneMorale.numeroSiren&&0!==e.donneePersonneMorale.numeroSiren.substr(0,1).indexOf("F")&&0!==e.donneePersonneMorale.numeroSiren.substr(0,1).indexOf("Z")?e:void 0}),0===e.length&&(this.result.errorMessage=n.DEFAULT_NO_RESULT_MESSAGE)),r?(e&&e.length>0&&e[0].donneeCommune?this.processMediaSearchTrieResults(this.mwgcRechercherPersonneService.transformeListe(e),this.$scope):this.processMediaSearchTrieResults(e,this.$scope),this.ongletActiverPM||this.ongletActiverPP||(this.getPersonnesMoraleList()&&this.getPersonnesMoraleList().length>0?(this.clientListe=this.getPersonnesMoraleList(),this.result.clientListe=this.getPersonnesMoraleList()):this.getPersonnesPhysiqueList()&&this.getPersonnesPhysiqueList().length>0&&(this.clientListe=this.getPersonnesPhysiqueList(),this.result.clientListe=this.getPersonnesPhysiqueList())),this.result.etat=3,this.loading=!1):(1===e.length&&2===this.result.type?(e[0].identifiantPersonne=t.RechercherPersonneService.getIdentifiantPersonne(e[0].identifiantPersonne),this.clientListe=e,this.result.personnes=[this.clientListe[0]]):this.clientListe=this.mwgcRechercherPersonneService.transformeListe(e),this.setClientListe(this.clientListe,this.$scope),this.result.etat=3,this.loading=!1),this.modelePrincipaleBoutonRechercher=!1,this.autoSelect&&1===e.length&&this.isTypeRechercheNumeroPersonne()&&(this.loading=!0,this.onSelectPersonne({personne:e[0]}))},n.prototype.processComplementPersonnePhysique=function(e){var t=this;this.getIsAgentHenin()&&5===this.result.type&&!this.result.criteres.siren&&(e=_.remove(e,function(e){return e.donneePersonneMorale.numeroSiren&&0!==e.donneePersonneMorale.numeroSiren.substr(0,1).indexOf("F")&&0!==e.donneePersonneMorale.numeroSiren.substr(0,1).indexOf("Z")?e:void 0}),0===e.length&&(this.result.errorMessage=n.DEFAULT_NO_RESULT_MESSAGE));var r={};_.forEach(e,function(e){var n=t.mockComplementPersonnePhysique();for(var i in n)e.adresse.hasOwnProperty(i)&&(n[i]=e.adresse[i]),e.donneeCommune.hasOwnProperty(i)&&(n[i]=e.donneeCommune[i]),e.donneePersonnePhysique.hasOwnProperty(i)&&(n[i]=e.donneePersonnePhysique[i]),e.listMedia.hasOwnProperty(i)&&(n[i]=e.listMedia[i]);for(var i in n.gestionPrivee)e.adresse.hasOwnProperty(i)&&(n.gestionPrivee[i]=e.adresse[i]),e.donneeCommune.hasOwnProperty(i)&&(n.gestionPrivee[i]=e.donneeCommune[i]),e.donneePersonnePhysique.hasOwnProperty(i)&&(n.gestionPrivee[i]=e.donneePersonnePhysique[i]),e.listMedia.hasOwnProperty(i)&&(n.gestionPrivee[i]=e.listMedia[i]);for(var i in n.statutPro)e.adresse.hasOwnProperty(i)&&(n.statutPro[i]=e.adresse[i]),e.donneeCommune.hasOwnProperty(i)&&(n.statutPro[i]=e.donneeCommune[i]),e.donneePersonnePhysique.hasOwnProperty(i)&&(n.statutPro[i]=e.donneePersonnePhysique[i]),e.listMedia.hasOwnProperty(i)&&(n.statutPro[i]=e.listMedia[i]);r[Number(e.donneeCommune.identifiantPersonne)]=n}),this.result.complementPersonnePhysique=r},n.prototype.mockComplementPersonnePhysique=function(){var e=new t.ComplementPersonnePhysique;e.autresPrenom=null,e.categorieSocioprofessionnelle=null,e.codeAccesMinitel=null,e.codeAppartenanceReseau=null,e.codeBlocageVAO=null,e.codeCapaciteJuridique=null,e.codeCategorieJuridiqueDeuxDern=null,e.codeCivilite=null,e.codeCommuneNaissance=null,e.codeDepartementNaissance=null,e.codeEtablissement=null,e.codeExistenceListeRouge=null,e.codeFamilleCategorieJuridique=null,e.codeFamilleNAFINSEE=null,e.codeGuichetRisque=null,e.codeISOPays=null,e.codeInseeLocalite=null,e.codeInseePays=null,e.codeInseePaysDoubleNationalite=null,e.codeInseePaysNationnalite=null,e.codePaysNaissance=null,e.codePieceJustif=null,e.codePostalFranceEtEtranger=null,e.codePostalPTT=null,e.codeQuartier=null,e.codeRegimeMatrimonial=null,e.codeResident=null,e.codeRetourDistribution=null,e.codeSecteurEmploi=null,e.codeSexe=null,e.codeSituationFamiliale=null,e.codeTypeAdresse=null,e.codeTypeContratTravail=null,e.codeTypeNIF=null,e.commentaireTelephone=null,e.dateAttributionFATCA=null,e.dateDeces=null,e.dateDecesPresume=null,e.dateEffetCSP=null,e.dateEffetOptionResidence=null,e.dateEffetSituationFamiliale=null,e.dateEmbaucheEmployeurActuel=null,e.dateFinContratTravail=null,e.dateNaissance=null,e.dateNaissanceConjoint=null,e.dateNaturalisation=null,e.dateObtentionPieceJustificative=null,e.designationCourte=null,e.domiciliationRevenu=null,e.droitAuCompte=null,e.edsDomiciliation=null,e.edsInterneDomiciliation=null,e.eligibiliteFGDR=null,e.email=null,e.horsPresenceClient=null,e.identifiantAdresse=null,e.identifiantPersonne=null,e.identifiantRelationtEconomique=null,e.indicDecesPresume=null,e.indicDonationEntreEpoux=null,e.indicateurActiviteProfessionnel=null,e.indicateurAutoEntrepreneur=null,e.indicateurDetentionTelephone=null,e.indicateurEnvoiCourrier=null,e.indicateurPPE=null,e.indicateurSocietaire=null,e.indiceAmericaniteFATCA=null,e.isPersonneProtegee=null,e.libelleAppartenanceReseau=null,e.libelleCapaciteJuridique=null,e.libelleCategorieSocioprofessionnelle=null,e.libelleCivilite=null,e.libelleCommuneNaissance=null,e.libelleDepartementNaissance=null,e.libelleInseeLocalite=null,e.libelleInseePaysDoubleNationalite=null,e.libelleNAFInsee=null,e.libellePaysNaissance=null,e.libellePaysNationnalite=null,e.libelleProfession=null,e.libelleRegimeMatirimonial=null,e.libelleSexe=null,e.libelleSituationFamiliale=null,e.libelleSocietaire=null,e.libelleStatutFATCA=null,e.libelleTypeContratTravail=null,e.ligne2AdresseAFNOR=null,e.ligne3AdresseAFNOR=null,e.ligne4AdresseAFNOR=null,e.ligne5AdresseAFNOR=null,e.ligne6AdresseAFNOR=null,e.nif=null,e.nomEmployeur=null,e.nomFamillePersonnePhysique=null,e.nomMarital=null,e.nombreEnfantACharge=null,e.numeroFax=null,e.numeroTelephoneAdresse=null,e.numeroTelephoneCorrespondancePerso=null,e.numeroTelephoneCorrespondancePro=null,e.numeroTourneeFacteur=null,e.numeroVoieHexavia=null,e.numeroVoiePTT=null,e.oppositionTelephonePerso=null,e.oppositionTelephonePro=null,e.prenom=null,e.refPieceJustificative=null,e.sirenAutoEntrepreneur=null,e.sirenEmployeur=null,e.troisDerniersCaracteresNAF=null,e.typeClauseMatrimoniale=null;var n=new t.GestionPriveeComplementPersonnePhysique;n.codeActnMajSuivSpclGp=null,n.codeEtablissement=null,n.codeEtatSuiviGP=null,n.codeMotivationMarquageGP=null,n.commentaireMarquageProspect=null,n.dateDebutValiditeGP=null,n.dateFinValiditeGP=null,n.identifiantEDS=null,n.identifiantEDS2=null,n.identifiantExterneEDS=null,n.identifiantExterneEDS2=null,n.identifiantPersonne=null,n.libelleCalculeEDS=null,n.libelleCalculeEDS2=null,n.libelleEDS=null,n.libelleFonctionPF=null,n.typeEDS=null,e.gestionPrivee=n;var r=new t.StatutProComplementPersonnePhysique;return r.codeEtablissement=null,r.codeEtatStatutPro=null,r.dateFinValiditeStatutPro=null,r.dateModificationStatutPro=null,r.identifiantExterneAgentModification=null,r.identifiantInterneAgentModification=null,r.identifiantPersonne=null,r.libelleCalculeEDS=null,r.libelleEDS=null,r.libelleFonctionPF=null,e.statutPro=r,e},n.prototype.processMediaSearchTrieResults=function(e,t){var n=this;angular.forEach(e,function(e,t){e.personneMorale&&angular.isDefined(e.personneMorale)&&(n.loading=!1,n.restitutionListePM.push(e)),e.personnePhysique&&angular.isDefined(e.personnePhysique)&&(n.loading=!1,n.restitutionListePP.push(e))}),this.setPersonnesMoraleList(this.restitutionListePM),this.setPersonnesPhysiqueList(this.restitutionListePP),this.$timeout(function(){t.$apply()},10)},n.prototype.isHistoriqueAffichable=function(e){var t=this,n=!1;return e.valeur.forEach(function(e){"codeEtablissement"===e.key&&e.value===t.result.criteres.rice.codeEtablissement&&(n=!0)}),n},n.prototype.processError=function(e,t){var r=this;if(this.loading=!1,this.setClientListe([],t),this.result.clientListe=[],this.result.personnes=[],this.result.etat=4,this.result.errorMessage=n.DEFAULT_ERROR_MESSAGE,e&&e.valeurs&&1===e.valeurs.length){if(e.valeurs&&e.valeurs[0]&&e.valeurs[0].split(":")){var i=e.valeurs[0].split(":"),s=0;i.forEach(function(e){s<e.length&&(s=e.length,r.result.errorMessage=e)})}e.valeurs[0]&&-1!==e.valeurs[0].indexOf(n.NO_RESULT)&&(this.result.etat=2)}e&&e.valeurs&&2===e.valeurs.length&&(this.result.errorMessage=e.libelle.split("-")[1]),this.$timeout(function(){t.$digest()},10)},n.prototype.setClientListe=function(e,t){e&&e.length>0&&(this.result.clientListe=e,this.$timeout(function(){t.$apply()},10))},n.prototype.getClientListe=function(){return this.result.clientListe},n.prototype.setPersonnesMoraleList=function(e){this.result.personnesMorale=e},n.prototype.getPersonnesMoraleList=function(){return this.result.personnesMorale},n.prototype.setPersonnesPhysiqueList=function(e){this.result.personnesPhysique=e},n.prototype.getPersonnesPhysiqueList=function(){return this.result.personnesPhysique},n.prototype.getIsAgentHenin=function(){return this.isAgentHenin},n.prototype.setIsAgentHenin=function(e){this.isAgentHenin=e},n.prototype.init=function(){var e=this;this.restitutionListePM=[],this.restitutionListePP=[],this.result instanceof t.RecherchePersonneResult||(this.result=new t.RecherchePersonneResult),(angular.isUndefined(this.result.criteres.rice)||angular.isUndefined(this.result.criteres.rice.codeEtablissement))&&(this.result.criteres.rice=new MyWay.Model.Rice,this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(t){e.result.criteres.rice.codeEtablissement=t.codeEtablissement})),angular.isUndefined(this.result.criteres.numeroTelephone)&&(this.result.criteres.numeroTelephone=new MyWay.Model.NumTelephone),angular.isUndefined(this.result.criteres.numeroCarte)&&(this.result.criteres.numeroCarte=new MyWay.Model.NumCarte),this.initTypeRecherche(),this.result.etat=0,this.rechercheAvancee=this.recherchePersonneMorale&&this.recherchePersonnePhysique?!0:!1,this.rechercheAvancee2=!0,this.afficherMiniRechercheNumPersonne=this.recherchePersonneMorale&&!this.recherchePersonnePhysique||this.recherchePersonnePhysique&&!this.recherchePersonneMorale,this.modelePrincipaleBoutonRechercher=!0},n.prototype.reinit=function(){this.result=new t.RecherchePersonneResult,this.afficherBoutonModifierRecherche=!1,this.initConstructor()},n.prototype.initTypeRecherche=function(){this.initValueListe(),this.result.criteres.numeroTelephone&&this.result.criteres.numeroTelephone.toString().length>10?this.selectTypeRecherche(8):this.result.criteres.email?this.selectTypeRecherche(7):this.result.criteres.identifiantPersonne?this.selectTypeRecherche(6):this.result.criteres.raisonSociale||this.result.criteres.villeSiege?this.selectTypeRecherche(5):this.result.criteres.nomFamille||this.result.criteres.prenom||this.result.criteres.dateNaissance||this.result.criteres.sexe?this.selectTypeRecherche(0):this.result.criteres.rice.isNotEmpty()?this.selectTypeRecherche(1):this.result.criteres.numeroPersonne?this.selectTypeRecherche(2):this.result.criteres.siren?this.selectTypeRecherche(4):this.result.criteres.numeroCarte.isNotEmpty()?this.selectTypeRecherche(3):this.result.criteres.numeroCredit?this.selectTypeRecherche(9):this.type=null},n.prototype.selectTypeRecherche=function(e){null!=e&&e!==this.type&&(this.type=e,0!==this.type&&(this.result.critereIsEmpty=!1,this.clearIdentite()),1!==this.type&&(this.result.critereIsEmpty=!1,this.clearCompte()),2!==this.type&&(this.result.critereIsEmpty=!1,this.clearNumeroPersonne()),4!==this.type&&(this.result.critereIsEmpty=!1,this.clearSiren()),3!==this.type&&(this.result.critereIsEmpty=!1,this.clearNumeroCarte()),5!==this.type&&(this.result.critereIsEmpty=!1,this.clearRaisonSociale()),5!==this.type&&0!==this.type&&this.clearAgence(),6!==this.type&&(this.result.critereIsEmpty=!1,this.clearIdentifiantBad()),7!==this.type&&(this.result.critereIsEmpty=!1,this.clearEmail()),8!==this.type&&(this.result.critereIsEmpty=!1,this.clearTelephone()),9!==this.type&&(this.result.critereIsEmpty=!1,this.clearNumeroCredit()))},n.prototype.initValueListe=function(){this.loading=!1,this.result.errorMessage=null,this.result.personnes=[],this.result.clientListe=[],this.setPersonnesMoraleList([]),this.setPersonnesPhysiqueList([]),this.clientListe=[],this.restitutionListePP=[],this.restitutionListePM=[],this.ongletActiverPM=this.ongletActiverPP=!1,this.modelePrincipaleBoutonRechercher=!0},n.prototype.clearNumeroCredit=function(){this.result.criteres.numeroCredit&&(this.result.criteres.numeroCredit=null,this.initValueListe(),this.loading=!1)},n.prototype.clearTelephone=function(){this.result.criteres.numeroTelephone&&this.result.criteres.numeroTelephone.toString().length>10&&(this.result.criteres.numeroTelephone.numero=null,this.initValueListe(),this.loading=!1)},n.prototype.clearEmail=function(){this.result.criteres.email&&(this.result.criteres.email=null,this.initValueListe(),this.loading=!1)},n.prototype.clearIdentifiantBad=function(){this.result.criteres.identifiantPersonne&&(this.result.criteres.identifiantPersonne=null,this.initValueListe(),this.loading=!1)},n.prototype.clearAgence=function(){this.result.criteres.bureauRatachement&&(this.result.criteres.bureauRatachement=new MyWay.Model.Agence,this.initValueListe(),this.loading=!1)},n.prototype.clearRaisonSociale=function(){this.result.criteres.raisonSociale&&(this.result.criteres.raisonSociale=null,this.initValueListe(),this.loading=!1),this.result.criteres.villeSiege&&(this.result.criteres.villeSiege=null,this.initValueListe(),this.loading=!1)},n.prototype.clearIdentite=function(){this.loading=!1,this.result.criteres.nomFamille&&(this.result.criteres.nomFamille=null,this.initValueListe()),this.result.criteres.prenom&&(this.result.criteres.prenom=null,this.initValueListe()),this.result.criteres.dateNaissance&&(this.result.criteres.dateNaissance=null,this.initValueListe()),this.result.criteres.sexe&&(this.result.criteres.sexe=null,this.initValueListe())},n.prototype.clearCompte=function(){this.result.criteres.rice.isNotEmpty()&&(this.result.criteres.rice.clear(),this.initValueListe(),this.loading=!1)},n.prototype.clearNumeroCarte=function(){this.result.criteres.numeroCarte.isNotEmpty()&&(this.result.criteres.numeroCarte=new MyWay.Model.NumCarte,this.initValueListe(),this.loading=!1)},n.prototype.clearNumeroPersonne=function(){this.result.criteres.numeroPersonne&&(this.result.criteres.numeroPersonne=null,this.initValueListe(),this.loading=!1)},n.prototype.clearSiren=function(){this.result.criteres.siren&&(this.result.criteres.siren=null,this.initValueListe(),this.loading=!1)},n.prototype.toggleModeAvance=function(){this.rechercheAvancee=!this.rechercheAvancee,this.rechercheAvancee2=!this.rechercheAvancee2},n.prototype.isTypeRechercheIdentite=function(){return 0===this.type},n.prototype.isTypeRechercheRaisonSociale=function(){return 5===this.type},n.prototype.isTypeRechercheSIREN=function(){return 4===this.type},n.prototype.isTypeRechercheCompte=function(){return 1===this.type},n.prototype.isTypeRechercheCarteBleu=function(){return 3===this.type},n.prototype.isTypeRechercheEmail=function(){return 7===this.type},n.prototype.isTypeRechercheTelephone=function(){return 8===this.type},n.prototype.isTypeRechercheCredit=function(){return 9===this.type},n.prototype.isTypeRechercheNumeroPersonne=function(){return 2===this.type},n.prototype.isTypeRechercheIdentifiantClient=function(){return 6===this.type},n.prototype.modifierRecherche=function(){this.afficherBoutonModifierRecherche=!1,this.initConstructor()},n.prototype.onSelectHistoryTab=function(){this.reinit()},n.prototype.onSelectHistoryEntry=function(e){this.onSelectHistory({entry:e})},Object.defineProperty(n.prototype,"isRestitutionPP",{get:function(){if(this.loading||!this.result.isSearchSuccessful()||!this.clientListe.length)return!1;var e=this.isTypeRechercheIdentite()||this.isTypeRechercheCarteBleu()||this.isTypeRechercheNumeroPersonne()&&this.estUnClientPhysique||this.isTypeRechercheCompte()&&this.estUnClientPhysique||this.isTypeRechercheIdentifiantClient()&&this.estUnClientPhysique;return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isRestitutionPM",{get:function(){if(this.loading||!this.result.isSearchSuccessful()||!this.clientListe.length)return!1;var e=this.isTypeRechercheSIREN()||this.isTypeRechercheRaisonSociale()&&this.clientListe.length>1||this.isTypeRechercheNumeroPersonne()&&!this.estUnClientPhysique||this.isTypeRechercheCompte()&&!this.estUnClientPhysique||this.isTypeRechercheIdentifiantClient()&&!this.estUnClientPhysique;return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isRestitution2PM",{get:function(){if(this.loading||!this.result.isSearchSuccessful()||!this.clientListe.length)return!1;var e=this.isTypeRechercheRaisonSociale()&&1===this.clientListe.length;return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isRestitutionMediaPP",{get:function(){if(this.loading||!this.restitutionListePP.length||this.restitutionListePM.length)return!1;var e=this.isTypeRechercheEmail()||this.isTypeRechercheTelephone()||this.isTypeRechercheCredit();return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isRestitutionMediaPM",{get:function(){if(this.loading||!this.restitutionListePM.length||this.restitutionListePP.length)return!1;var e=this.isTypeRechercheEmail()||this.isTypeRechercheTelephone()||this.isTypeRechercheCredit();return e},enumerable:!0,configurable:!0}),Object.defineProperty(n.prototype,"isRestitutionMediaPPEtPM",{get:function(){if(this.loading||!this.restitutionListePP.length||!this.restitutionListePM.length)return!1;var e=this.isTypeRechercheEmail()||this.isTypeRechercheTelephone()||this.isTypeRechercheCredit();return e},enumerable:!0,configurable:!0}),n.prototype.initHistory=function(){var e=this;this.historiqueRechercheSettings={recherche:function(){return e.result},active:!1,hideAction:!this.showHistoryAction,resetRecherche:function(){return e.reinit()}},this.modeAppel===t.ModesAppelRecherche.PERSONNE_PHYSIQUE?this.historiqueRechercheSettings.codePersonnaliteJuridique=t.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE:this.modeAppel===t.ModesAppelRecherche.PERSONNE_MORALE&&(this.historiqueRechercheSettings.codePersonnaliteJuridique=t.CodesPersonnaliteJuridique.PERSONNE_MORALE)},n.DEFAULT_ERROR_MESSAGE="Erreur technique lors de la recherche.",n.DEFAULT_NO_RESULT_MESSAGE="0 résultat.",n.DEFAULT_PLUS_CRITERE="Vous devez saisir plus d'un critère.",n.EMIT_QUALITE_NATURE_DIRECTIVE="event-click-directive-qualite-nature",n.NO_RESULT="Aucun client ne correspond à votre requete",n.$inject=["$scope","$attrs","serviceAgentExtended","mwgcRechercherPersonneService","agentConnecteService","$timeout","$q"],n}();t.RechercherPersonneController=n,t.app.controller("RechercherPersonneController",n)}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){function t(){return{restrict:"E",templateUrl:"typescript/rechercher-personne/rechercher-personne-view.html",scope:{result:"=?",modeAppel:"@?",modale:"=",autoSelect:"=?",cacherBtnQualiterNature:"@?",afficherNumPersonne:"@",lancerRecherche:"=?",filtreRecherche:"=?",onSelectPersonne:"&?",onSelectHistory:"&?",showHistoryAction:"=?"},controller:"RechercherPersonneController",controllerAs:"ctrl",bindToController:!0}}e.app.directive("mwsfRecherchePersonne",t)}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n=function(){function n(e,t,n){this.serviceAgentExtended=e,this.modalService=t,this.$q=n,this.paramFiltreRecherche=!1}return n.getIdentifiantPersonne=function(e){return null==e||"0"===e||0===e?null:_.padLeft(_.trim(e+""),9,"0")},n.prototype.ajoutDonneePersonneProtegeePersonnes=function(e){var t=this;if(e&&e.length>0){var r=[];return _.forEach(e,function(e){if(e.donneePersonnePhysique){var i=n.getIdentifiantPersonne(e.donneeCommune.identifiantPersonne),s=t.isPersonneProtegee(i).then(function(t){e.donneePersonnePhysique.isPersonneProtegee=t})["catch"](function(){return!1});r.push(s)}}),this.$q.all(r).then(function(){return e})}return this.$q.when(e)},n.prototype.ajoutDonneeCodePersonneProtegee=function(e){var t=this;if(e&&e.length>0){var n=[];return _.forEach(e,function(e){if(e.donneePersonnePhysique){var r=t.isCodePersonneProtegee(e.donneePersonnePhysique.codeTypeCapaciteJuridique).then(function(t){e.donneePersonnePhysique.isPersonneProtegee=t})["catch"](function(){return!1});n.push(r)}}),this.$q.all(n).then(function(){return e})}return this.$q.when(e)},n.prototype.ajoutDonneePersonneProtegee=function(e){var t=n.getIdentifiantPersonne(e.identifiantPersonne),r=this.isPersonneProtegee(t).then(function(t){e.isPersonneProtegee=t})["catch"](function(){return!1});return this.$q.all([r]).then(function(){return e})},n.prototype.isPersonneProtegee=function(t){return this.recupererCapaciteJuridique(t).then(function(t){var n=!1;return t&&t.codeCapaciteJuridique&&(n=e.comGestionClient.capaciteJuridiquePP.some(function(e){return e===t.codeCapaciteJuridique})),n})},n.prototype.isCodePersonneProtegee=function(t){var n=!1;t&&(n=e.comGestionClient.capaciteJuridiquePP.some(function(e){return e===t}));var r=this.$q.defer();return r.resolve(n),r.promise},n.prototype.rechercherPersonneModale=function(e,t,n,r,i,s){n&&this.setCodeNatureCredit(n),angular.isDefined(r)&&this.setAfficherNumPersonne(r),this.setParamBoutonCreationPP(i),this.setParamBoutonCreationPM(s);var o={templateUrl:"typescript/rechercher-personne/modale/rechercher-personne-modal-view.html",controller:"mwgcRechercherPersonneModalController",controllerAs:"ctrl",backdrop:"static",keyboard:!1,size:"lg",resolve:{modeAppel:e,criteres:function(){return angular.copy(t)}}};return this.modalService.showModal(o)},n.prototype.rechercherPersonne=function(e,t,n,r,i,s){return e||(e=new MyWay.Model.Client),this.setCriteres(e),this.setCreationPersonneBtnVisibilityBool(t),this.setModeAppel(null),this.rechercherPersonneModale("null",e,n,r,i,s)},n.prototype.rechercherPersonnePhysique=function(e,n,r,i){return e||(e=new MyWay.Model.Client),this.setCriteres(e),this.setCreationPersonneBtnVisibilityBool(n),this.setModeAppel(t.ModesAppelRecherche.PERSONNE_PHYSIQUE),this.rechercherPersonneModale(t.ModesAppelRecherche.PERSONNE_PHYSIQUE,e,null,r,i)},n.prototype.rechercherPersonneMorale=function(e,n,r,i,s){return e||(e=new MyWay.Model.Client),this.setCriteres(e),this.setCreationPersonneBtnVisibilityBool(n),this.setModeAppel(t.ModesAppelRecherche.PERSONNE_MORALE),this.rechercherPersonneModale(t.ModesAppelRecherche.PERSONNE_MORALE,e,r,i,null,s)},n.prototype.transformeListe=function(e){var t,r,i,s,o,c,l,u,a,h,d,p,m,f,g,y,P,E,v,C,A,R,S,w,M,b,N,T,F=this,L=0,q=[];return angular.forEach(e,function(e,I){if(o="",L++,t=L?L:0,r=e.donneePersonneMorale?!0:!1,i=e.donneePersonnePhysique?!0:!1,e.donneeCommune){if(s=n.getIdentifiantPersonne(e.donneeCommune.identifiantPersonne),a=e.donneeCommune.codePersonnaliteJuridique?e.donneeCommune.codePersonnaliteJuridique:null,m=e.donneeCommune.edsDomiciliation?e.donneeCommune.edsDomiciliation:null,e.donneeCommune.codeTypePersonne)switch(e.donneeCommune.codeTypePersonne){case"1":o="Tiers ";break;case"2":o="Prospect "}N=s,e.donneeCommune.codeStatut&&"1"===e.donneeCommune.codeStatut&&(N="Clôturé"),("O"===e.donneeCommune.indicAccesPersConfidentielle||"F"===e.donneeCommune.indicAccesPersConfidentielle||"N"===e.donneeCommune.indicAccesPersConfidentielle)&&(N="Confidentiel"),T=e.donneeCommune.indicAccesPersConfidentielle}e.donneePersonnePhysique&&(c=e.donneePersonnePhysique.nomFamillePersonnePhysique?e.donneePersonnePhysique.nomFamillePersonnePhysique:null,l=e.donneePersonnePhysique.nomMarital?e.donneePersonnePhysique.nomMarital:null,u=e.donneePersonnePhysique.prenom?e.donneePersonnePhysique.prenom:null,d=e.donneePersonnePhysique.dateNaissance?e.donneePersonnePhysique.dateNaissance:null,b=e.donneePersonnePhysique.codeCivilite?e.donneePersonnePhysique.codeCivilite:null,e.donneePersonnePhysique.indicateurCodeActiviteProfessionnel&&"O"===e.donneePersonnePhysique.indicateurCodeActiviteProfessionnel&&(o+="Pro"),e.donneePersonnePhysique.isPersonneProtegee&&(o="PP")),e.donneePersonneMorale&&(w=e.donneePersonneMorale.numeroSiren?e.donneePersonneMorale.numeroSiren:null,M=e.donneePersonneMorale.raisonSociale?e.donneePersonneMorale.raisonSociale:null),p=m?m:null,m&&m.toString().length<7&&(m=_.padLeft(m.toString(),7,"0")),g=F.getMediaFromListMediaByCodeTypeMediaTiersV3(e.listMedia,1),y=F.getMediaFromListMediaByCodeTypeMediaTiersV3(e.listMedia,3),f=F.getMediaFromListMediaByCodeTypeMediaTiersV3(e.listMedia,11),P=null,E=null,v=null,C=null,A=null,R=null,S=null,e.adresse&&"N"!==e.donneeCommune.indicAccesPersConfidentielle&&"F"!==e.donneeCommune.indicAccesPersConfidentielle?(P=e.adresse.ligne1AdresseAFNOR?e.adresse.ligne1AdresseAFNOR:null,E=e.adresse.ligne2AdresseAFNOR?e.adresse.ligne2AdresseAFNOR:null,v=e.adresse.ligne3AdresseAFNOR?e.adresse.ligne3AdresseAFNOR:null,C=e.adresse.ligne4AdresseAFNOR?e.adresse.ligne4AdresseAFNOR:null,A=e.adresse.ligne5AdresseAFNOR?e.adresse.ligne5AdresseAFNOR:null,R=e.adresse.ligne6AdresseAFNOR?e.adresse.ligne6AdresseAFNOR:null,S=e.adresse.ligne7AdresseAFNOR?e.adresse.ligne7AdresseAFNOR:null):"N"!==e.donneeCommune.indicAccesPersConfidentielle&&"F"!==e.donneeCommune.indicAccesPersConfidentielle||!e.listeMotifsConfidentialite||(R=e.listeMotifsConfidentialite[0]?e.listeMotifsConfidentialite[0].libelleMotifConfidentialite:null,e.listeMotifsConfidentialite[1]?P=e.listeMotifsConfidentialite[1].libelleMotifConfidentialite:E=null,v=e.listeMotifsConfidentialite[2]?e.listeMotifsConfidentialite[2].libelleMotifConfidentialite:null),q.push({id:L,personneMorale:r,personnePhysique:i,identifiantPersonne:s,codeTypePersonne:o,codeCivilite:b,nomFamille:c,nomMarital:l,prenom:u,codePersonnaliteJuridique:a,indicateurActiviteProfessionnelle:h,dateNaissance:d,edsDomiciliation:m,courrierElectronique:f,numTelephoneFixe:g,numTelephonePortable:y,ligne1AdresseAFNOR:P,ligne2AdresseAFNOR:E,ligne3AdresseAFNOR:v,ligne4AdresseAFNOR:C,ligne5AdresseAFNOR:A,ligne6AdresseAFNOR:R,ligne7AdresseAFNOR:S,siren:w,raisonSociale:M,etat:N,confidentialite:T})}),q},n.prototype.rechercheGroupeEmail=function(e){var t=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/recherche";return t.serviceAgentExtended.sendRequest({url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:r.codeEtablissement,codeTypeRecherche:6,identifiantRecherche:e.email.toLowerCase()}}).then(function(e){return t.ajoutDonneePersonneProtegeePersonnes(e)})})},n.prototype.rechercheGroupeTelephone=function(e){var t=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/recherche";return t.serviceAgentExtended.sendRequest({
url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:r.codeEtablissement,codeTypeRecherche:6,identifiantRecherche:e.numeroTelephone.numero}}).then(function(e){return t.ajoutDonneePersonneProtegeePersonnes(e)})})},n.prototype.rechercheGroupeNom=function(e){var t=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/recherche?codeEtablissement="+r.codeEtablissement;return i+="&codeTypeRecherche=3",e.nomFamille?i+="&nom="+e.nomFamille:i=null,angular.isDefined(e.prenom)&&e.prenom&&(i+="&prenom="+e.prenom),angular.isDefined(e.dateNaissance)&&e.dateNaissance&&(i+="&dateNaissance="+t.dateToString(e.dateNaissance,"-")),angular.isDefined(e.sexe)&&e.sexe&&(i+="&sexe="+e.sexe),e.bureauRatachement&&e.bureauRatachement.id&&(i+="&edsDomiciliation="+e.bureauRatachement.id),t.serviceAgentExtended.sendRequest({url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){return t.ajoutDonneeCodePersonneProtegee(e)})})},n.prototype.rechercheGroupeRice=function(e){var t=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/recherche?codeEtablissement="+r.codeEtablissement;return i+="&codeTypeRecherche=1",e.codeGuichet&&"object"==typeof e.codeGuichet?i+="&identifiantRecherche="+e.codeEtablissement+e.codeGuichet.value:e.codeGuichet&&"string"==typeof e.codeGuichet&&(i+="&identifiantRecherche="+e.codeEtablissement+e.codeGuichet),angular.isDefined(e.codeActiviteCompte)&&e.codeActiviteCompte&&(i+=e.codeActiviteCompte),angular.isDefined(e.radical)&&e.radical&&(i+=e.radical),angular.isDefined(e.cleCompte)&&e.cleCompte&&(i+=e.cleCompte),t.serviceAgentExtended.sendRequest({url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){return t.ajoutDonneePersonneProtegeePersonnes(e)})})},n.prototype.rechercheGroupeSiren=function(e){var t=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/recherche";return t.serviceAgentExtended.sendRequest({url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:r.codeEtablissement,codeTypeRecherche:7,identifiantRecherche:e.siren}}).then(function(e){return t.ajoutDonneePersonneProtegeePersonnes(e)})})},n.prototype.rechercheGroupeCarteBleu=function(e){var t=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/recherche";return t.serviceAgentExtended.sendRequest({url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:r.codeEtablissement,codeTypeRecherche:2,identifiantRecherche:e.numeroCarte.concatinate}}).then(function(e){return t.ajoutDonneePersonneProtegeePersonnes(e)})})},n.prototype.rechercheGroupeNumeroPersonne=function(e){var t=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/identification";return t.serviceAgentExtended.sendRequest({url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:r.codeEtablissement,identifiantPersonne:e.numeroPersonne}}).then(function(e){return e})})},n.prototype.rechercheGroupeNumeroCredit=function(e){var t=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/recherche";return t.serviceAgentExtended.sendRequest({url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:r.codeEtablissement,codeTypeRecherche:4,identifiantRecherche:e.numeroCredit}}).then(function(e){return t.ajoutDonneePersonneProtegeePersonnes(e)})})},n.prototype.rechercheGroupeIdentifiantBad=function(e){var t=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/recherche";return t.serviceAgentExtended.sendRequest({url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:r.codeEtablissement,codeTypeRecherche:5,identifiantRecherche:e.identifiantPersonne}}).then(function(e){return t.ajoutDonneePersonneProtegeePersonnes(e)})})},n.prototype.rechercheGroupeRaisonSociale=function(e){var t=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/recherche?codeEtablissement="+r.codeEtablissement;if(i+="&codeTypeRecherche=8",angular.isDefined(e.raisonSociale)&&e.raisonSociale){var s=String(e.raisonSociale).toUpperCase(),o=s.split(" ");if(o&&o.length>=1){var c=o[0].substr(0,15);if(i+="&motCle="+c,o.length>1){var l=_.trimLeft(s.substr(c.length)).substr(0,15);i+="&motCle2="+l}}}return angular.isDefined(e.villeSiege)&&e.villeSiege&&(i+="&communeSiegeSocial="+String(e.villeSiege).toUpperCase()),e.bureauRatachement&&e.bureauRatachement.id&&(i+="&edsDomiciliation="+e.bureauRatachement.id),t.serviceAgentExtended.sendRequest({url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){return t.ajoutDonneePersonneProtegeePersonnes(e)})})},n.prototype.getMediaFromListMediaByCodeTypeMediaTiersV3=function(e,t){var n=e?e.filter(function(e){return parseInt(e.codeTypeMedia)===t}):[];return n&&n.length>0?n[0].referenceAccesMedia:null},n.prototype.getMediasFromListMediaByCodeTypeMedia=function(e,t,n){return void 0===n&&(n=!1),n?e.filter(function(e){return parseInt(e.codeTypeMedia)===t&&e.indicateurPreferenceMedia===!0}):e.filter(function(e){return parseInt(e.codeTypeMedia)===t})},n.prototype.setAppelRechercheModeNormal=function(e){this.appelRechercheModeNormal=e},n.prototype.getAppelRechercheModeNormal=function(){return this.appelRechercheModeNormal},n.prototype.setAppelRechercheModeModale=function(e){this.appelRechercheModeModale=e},n.prototype.getAppelRechercheModeModale=function(){return this.appelRechercheModeModale},n.prototype.setModeAppel=function(e){this.paramModeAppel=e},n.prototype.getModeAppel=function(){return this.paramModeAppel},n.prototype.setFiltreRecherche=function(e){this.paramFiltreRecherche=e},n.prototype.getFiltreRecherche=function(){return this.paramFiltreRecherche},n.prototype.setCodeNatureCredit=function(e){this.paramCodeNatureCredit=e},n.prototype.getCodeNatureCredit=function(){return this.paramCodeNatureCredit},n.prototype.setAfficherNumPersonne=function(e){this.paramAfficherNumPersonne=e},n.prototype.setParamBoutonCreationPP=function(e){this.paramBoutonCreationPP=e},n.prototype.getParamBoutonCreationPM=function(){return this.paramBoutonCreationPM},n.prototype.setParamBoutonCreationPM=function(e){this.paramBoutonCreationPM=e},n.prototype.getParamBoutonCreationPP=function(){return this.paramBoutonCreationPP},n.prototype.getAfficherNumPersonne=function(){return(angular.isUndefined(this.paramAfficherNumPersonne)||null===this.paramAfficherNumPersonne)&&(this.paramAfficherNumPersonne=!0),this.paramAfficherNumPersonne},n.prototype.setCriteres=function(e){this.criteres=e},n.prototype.getCriteres=function(){return this.criteres},n.prototype.setCreationPersonneBtnVisibilityBool=function(e){this.creationPersonneBtnVisibilityBool=e},n.prototype.getCreationPersonneBtnVisibilityBool=function(){return this.creationPersonneBtnVisibilityBool},n.prototype.dateToString=function(e,t){var n=e.getFullYear(),r=(e.getMonth()+1).toString(),i=e.getDate().toString();return n+t+(r[1]?r:"0"+r[0])+t+(i[1]?i:"0"+i[0])},n.prototype.getMedia=function(e,t){return this.serviceAgentExtended.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/media",withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:t,identifiantPersonne:e}})},n.prototype.getInformationParticulier=function(e,t){var r=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(i){return r.serviceAgentExtended.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/particulierInformation",withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:t||i.codeEtablissement,idPersonne:n.getIdentifiantPersonne(e)}})}).then(function(e){return r.ajoutDonneePersonneProtegee(e)})},n.prototype.recupererCapaciteJuridique=function(e){var t=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){return t.serviceAgentExtended.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_3+"/particulierInformation",withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:r.codeEtablissement,idPersonne:n.getIdentifiantPersonne(e)}})})},n.prototype.getInformationCorporate=function(e,t){var r=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(i){return r.serviceAgentExtended.sendRequest({url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+n.TIERS_VERSION_2+"/corporateInformation",withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:t||i.codeEtablissement,identifiantTiers:e}})})},n.prototype.getPersonneByIdentifiant=function(e,n,r){var i=this;void 0===n&&(n=!0),void 0===r&&(r=!0);var s=new MyWay.Model.Client;return s.numeroPersonne=e,n||r||(r=!0,n=!0),this.$q.all([this.serviceAgentExtended.Context.GetAuthentificationInfo(),this.rechercheGroupeNumeroPersonne(s)]).then(function(s){var o=s[0],c=s[1],l=c.donneeIdentification,u=c.motifsConfidentialite;return l.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE&&n?i.$q.all([i.getInformationParticulier(l.identifiantPersonne,o.codeEtablissement),i.getMedia(l.identifiantPersonne,o.codeEtablissement)]).then(function(t){var n=i.completerClientParComplementInformationParticulier(t[0],l.indicAccesPersConfidentielle,u);return i.completerClientParMedia(n,t[1]),n.identifiantPersonne=e,n.codePersonnaliteJuridique=l.codePersonnaliteJuridique,n}):l.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_MORALE&&r?i.getInformationCorporate(l.identifiantPersonne,o.codeEtablissement).then(function(t){var n=i.completerClientParComplementInformationCorporate(t,l.indicAccesPersConfidentielle,u);return n.identifiantPersonne=e,n.codePersonnaliteJuridique=l.codePersonnaliteJuridique,n}):i.$q.reject(new MyWay.Services.Erreur("COM.ERREUR_INTERNE",["Aucun client ne correspond à votre requete"]))})},n.prototype.completerClientParMedia=function(t,n){if(n&&n.listeMedia&&n.listeMedia.length>0){var r=this.getMediasFromListMediaByCodeTypeMedia(n.listeMedia,1);r&&r.length>0&&(1===r.length?t.numTelephoneFixe=r[0].referenceAccesMedia:r[0].codeTypeUsageMedia===e.comGestionClient.CodeTypeUsageMedia.PROFESSIONNEL?t.numTelephoneFixe=r[0].referenceAccesMedia:t.numTelephoneFixe=r[1].referenceAccesMedia);var i=this.getMediasFromListMediaByCodeTypeMedia(n.listeMedia,2,!0);i&&i.length>0&&(t.numTelephonePortable=i[0].referenceAccesMedia);var s=this.getMediasFromListMediaByCodeTypeMedia(n.listeMedia,3,!0);s&&s.length>0&&(t.courrierElectronique=s[0].referenceAccesMedia)}},n.prototype.completerClientParComplementInformationParticulier=function(e,t,n){var r=new MyWay.Model.Client;return r.nomFamille=e.nomFamillePersonnePhysique,r.nomMarital=e.nomMarital,r.prenom=e.prenom,r.indicateurActiviteProfessionnelle=e.indicateurActiviteProfessionnel,r.dateNaissance=new Date(e.dateNaissance),r.codeCivilite=e.codeCivilite,r.nomFamille||r.nomMarital||r.prenom?(r.personneMorale=!1,r.personnePhysique=!0):(r.siren||r.raisonSociale)&&(r.personneMorale=!0,r.personnePhysique=!1),r.designationCourte=e.designationCourte,r.edsDomiciliation=_.padLeft(e.edsDomiciliation.toString(),7,"0"),t&&(r.confidentialite=t),"N"!==t&&"F"!==t?(e.ligne2AdresseAFNOR?r.ligne2AdresseAFNOR=e.ligne2AdresseAFNOR:r.ligne2AdresseAFNOR=null,e.ligne3AdresseAFNOR?r.ligne3AdresseAFNOR=e.ligne3AdresseAFNOR:r.ligne3AdresseAFNOR=null,e.ligne4AdresseAFNOR?r.ligne4AdresseAFNOR=e.ligne4AdresseAFNOR:r.ligne4AdresseAFNOR=null,e.ligne5AdresseAFNOR?r.ligne5AdresseAFNOR=e.ligne5AdresseAFNOR:r.ligne5AdresseAFNOR=null,e.ligne6AdresseAFNOR?r.ligne6AdresseAFNOR=e.ligne6AdresseAFNOR:r.ligne6AdresseAFNOR=null):("N"===t||"F"===t)&&(n[0]?r.ligne6AdresseAFNOR=n[0].libelleMotifConfidentialite:r.ligne6AdresseAFNOR=null,n[1]?r.ligne2AdresseAFNOR=n[1].libelleMotifConfidentialite:r.ligne2AdresseAFNOR=null,n[2]?r.ligne3AdresseAFNOR=n[2].libelleMotifConfidentialite:r.ligne3AdresseAFNOR=null),r.etat=e.identifiantPersonne.toString(),r.etat=_.padLeft(r.etat,9,"0"),("O"===r.confidentialite||"F"===r.confidentialite||"N"===r.confidentialite)&&(r.etat="Confidentiel"),e.indicateurActiviteProfessionnel&&"O"===e.indicateurActiviteProfessionnel&&(r.codeTypePersonne="Pro"),e.isPersonneProtegee&&(r.codeTypePersonne="PP"),r},n.prototype.completerClientParComplementInformationCorporate=function(e,t,n){var r=new MyWay.Model.Client;return r.raisonSociale=e.raisonSociale,r.siren=e.numeroSiren,r.edsDomiciliation=_.padLeft(e.referenceExterneEDS.toString(),7,"0"),"N"!==t&&"F"!==t?(r.ligne2AdresseAFNOR=e.adresse.ligne2AdresseAFNOR,r.ligne3AdresseAFNOR=e.adresse.ligne3AdresseAFNOR,r.ligne4AdresseAFNOR=e.adresse.ligne4AdresseAFNOR,r.ligne5AdresseAFNOR=e.adresse.ligne5AdresseAFNOR,r.ligne6AdresseAFNOR=e.adresse.ligne6AdresseAFNOR):("N"===t||"F"===t)&&(n[0]?r.ligne6AdresseAFNOR=n[0].libelleMotifConfidentialite:r.ligne6AdresseAFNOR=null,n[1]?r.ligne2AdresseAFNOR=n[1].libelleMotifConfidentialite:r.ligne2AdresseAFNOR=null,n[2]?r.ligne3AdresseAFNOR=n[2].libelleMotifConfidentialite:r.ligne3AdresseAFNOR=null),r},n.TIERS_VERSION_2="tiers-v2",n.TIERS_VERSION_3="tiers-v3",n.$inject=["serviceAgentExtended","modalService","$q"],n}();t.RechercherPersonneService=n,t.app.service("mwgcRechercherPersonneService",n)}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n=function(){function n(e,t){var n=this;this.$scope=e,this.mwgcRechercherPersonneService=t,this.initTableOptions(),e.$watch(function(){return n.clientListe&&n.clientListe.length>0},function(e,t){n.initTableOptions()})}return n.prototype.initTableOptions=function(){this.selectedClient=1===this.clientListe.length?[this.clientListe[0]]:[],this.tableOptions={filterEnable:!1,sortEnable:!1,width:"col-md-12",orderBy:"prenom",reserve:!1,perPage:this.clientListe.length,columns:[{title:"Nom de famille",bind:"nomFamille",cssClass:"col-md-2"},{title:"Nom d'usage",bind:"nomMarital",cssClass:"col-md-2"},{title:"Prénom",bind:"prenom",cssClass:"col-md-2"},{title:"N° Pers.",bind:"etat",cssClass:"col-md-1"},{title:"Né(e) le",bind:"dateNaissance",filter:" | date: 'dd/MM/yyyy'",cssClass:"col-md-1"},{title:"Type",bind:"codeTypePersonne",cssClass:"col-md-1"},{title:"Agence",bind:"edsDomiciliation",cssClass:"col-md-1"},{title:"Ville",bind:"ligne6AdresseAFNOR",cssClass:"col-md-4"}],data:this.clientListe,selectedItems:this.selectedClient,openSelected:!0,templateUrl:"typescript/restituer-personne/detail-ligne-tableau-restitution-view.html",multiSelect:!1,moreEnable:!0}},n.prototype.keydown=function(n){n.keyCode===e.comInterdomaine.KeyCode.ENTER&&null!=this.selectedClient&&(n.preventDefault(),this.$scope.$emit(t.CustomEvents.SELECT_CLIENT))},n.$inject=["$scope","mwgcRechercherPersonneService"],n}();t.RestituerPersonneController=n,t.app.controller("mwgcRestituerPersonneController",n)}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){function t(){return{restrict:"E",templateUrl:"typescript/restituer-personne/restituer-personne-view.html",scope:{clientListe:"=",selectedClient:"="},controller:"mwgcRestituerPersonneController",controllerAs:"viewModelRestituerPersonneCtrl",bindToController:!0,link:function(e,t,n){}}}e.app.directive("mwsfRestitutionPersonne",t)}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n=function(){function n(e,t){var n=this;this.$scope=e,this.mwgcRechercherPersonneService=t,this.initTableOptions(),e.$watch(function(){return n.clientListe&&n.clientListe.length>0},function(e,t){n.initTableOptions()})}return n.prototype.initTableOptions=function(){this.selectedClient=1===this.clientListe.length?[this.clientListe[0]]:[],this.tableOptions={filterEnable:!1,sortEnable:!1,width:"col-md-12",orderBy:"raisonSociale",reserve:!1,perPage:this.clientListe.length,columns:[{title:"Raison sociale",bind:"raisonSociale",cssClass:"col-md-5"},{title:"N° Personne",bind:"etat",cssClass:"col-md-2"},{title:"N° SIREN",bind:"siren",cssClass:"col-md-1"},{title:"Type",bind:"codeTypePersonne",cssClass:"col-md-1"},{title:"Agence",bind:"edsDomiciliation",cssClass:"col-md-1"},{title:"Ville",bind:"ligne6AdresseAFNOR",cssClass:"col-md-6"}],data:this.clientListe,selectedItems:this.selectedClient,openSelected:!0,templateUrl:"typescript/restituer-personne/detail-ligne-tableau-restitution-view.html",multiSelect:!1,moreEnable:!0}},n.prototype.keydown=function(n){n.keyCode===e.comInterdomaine.KeyCode.ENTER&&null!=this.selectedClient&&(n.preventDefault(),this.$scope.$emit(t.CustomEvents.SELECT_CLIENT))},n.$inject=["$scope","mwgcRechercherPersonneService"],n}();t.RestituerPersonneMoraleController=n,t.app.controller("mwgcRestituerPersonneMoraleController",n)}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){function t(){return{restrict:"E",templateUrl:"typescript/restituer-personne-morale/restituer-personne-morale-view.html",scope:{clientListe:"=",selectedClient:"="},controller:"mwgcRestituerPersonneMoraleController",controllerAs:"viewModelRestituerPersonneMoraleCtrl",bindToController:!0,link:function(e,t,n){}}}e.app.directive("mwsfRestitutionPersonneMorale",t)}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t=function(){function e(){}return e.stripAccents=function(e){var t={A:/[\u0041\u24B6\uFF21\u00C0\u00C1\u00C2\u1EA6\u1EA4\u1EAA\u1EA8\u00C3\u0100\u0102\u1EB0\u1EAE\u1EB4\u1EB2\u0226\u01E0\u00C4\u01DE\u1EA2\u00C5\u01FA\u01CD\u0200\u0202\u1EA0\u1EAC\u1EB6\u1E00\u0104\u023A\u2C6F]/g,AA:/[\uA732]/g,AE:/[\u00C6\u01FC\u01E2]/g,AO:/[\uA734]/g,AU:/[\uA736]/g,AV:/[\uA738\uA73A]/g,AY:/[\uA73C]/g,B:/[\u0042\u24B7\uFF22\u1E02\u1E04\u1E06\u0243\u0182\u0181]/g,C:/[\u0043\u24B8\uFF23\u0106\u0108\u010A\u010C\u00C7\u1E08\u0187\u023B\uA73E]/g,D:/[\u0044\u24B9\uFF24\u1E0A\u010E\u1E0C\u1E10\u1E12\u1E0E\u0110\u018B\u018A\u0189\uA779]/g,DZ:/[\u01F1\u01C4]/g,Dz:/[\u01F2\u01C5]/g,E:/[\u0045\u24BA\uFF25\u00C8\u00C9\u00CA\u1EC0\u1EBE\u1EC4\u1EC2\u1EBC\u0112\u1E14\u1E16\u0114\u0116\u00CB\u1EBA\u011A\u0204\u0206\u1EB8\u1EC6\u0228\u1E1C\u0118\u1E18\u1E1A\u0190\u018E]/g,F:/[\u0046\u24BB\uFF26\u1E1E\u0191\uA77B]/g,G:/[\u0047\u24BC\uFF27\u01F4\u011C\u1E20\u011E\u0120\u01E6\u0122\u01E4\u0193\uA7A0\uA77D\uA77E]/g,H:/[\u0048\u24BD\uFF28\u0124\u1E22\u1E26\u021E\u1E24\u1E28\u1E2A\u0126\u2C67\u2C75\uA78D]/g,I:/[\u0049\u24BE\uFF29\u00CC\u00CD\u00CE\u0128\u012A\u012C\u0130\u00CF\u1E2E\u1EC8\u01CF\u0208\u020A\u1ECA\u012E\u1E2C\u0197]/g,J:/[\u004A\u24BF\uFF2A\u0134\u0248]/g,K:/[\u004B\u24C0\uFF2B\u1E30\u01E8\u1E32\u0136\u1E34\u0198\u2C69\uA740\uA742\uA744\uA7A2]/g,L:/[\u004C\u24C1\uFF2C\u013F\u0139\u013D\u1E36\u1E38\u013B\u1E3C\u1E3A\u0141\u023D\u2C62\u2C60\uA748\uA746\uA780]/g,LJ:/[\u01C7]/g,Lj:/[\u01C8]/g,M:/[\u004D\u24C2\uFF2D\u1E3E\u1E40\u1E42\u2C6E\u019C]/g,N:/[\u004E\u24C3\uFF2E\u01F8\u0143\u00D1\u1E44\u0147\u1E46\u0145\u1E4A\u1E48\u0220\u019D\uA790\uA7A4]/g,NJ:/[\u01CA]/g,Nj:/[\u01CB]/g,O:/[\u004F\u24C4\uFF2F\u00D2\u00D3\u00D4\u1ED2\u1ED0\u1ED6\u1ED4\u00D5\u1E4C\u022C\u1E4E\u014C\u1E50\u1E52\u014E\u022E\u0230\u00D6\u022A\u1ECE\u0150\u01D1\u020C\u020E\u01A0\u1EDC\u1EDA\u1EE0\u1EDE\u1EE2\u1ECC\u1ED8\u01EA\u01EC\u00D8\u01FE\u0186\u019F\uA74A\uA74C]/g,OI:/[\u01A2]/g,OO:/[\uA74E]/g,OU:/[\u0222]/g,P:/[\u0050\u24C5\uFF30\u1E54\u1E56\u01A4\u2C63\uA750\uA752\uA754]/g,Q:/[\u0051\u24C6\uFF31\uA756\uA758\u024A]/g,R:/[\u0052\u24C7\uFF32\u0154\u1E58\u0158\u0210\u0212\u1E5A\u1E5C\u0156\u1E5E\u024C\u2C64\uA75A\uA7A6\uA782]/g,S:/[\u0053\u24C8\uFF33\u1E9E\u015A\u1E64\u015C\u1E60\u0160\u1E66\u1E62\u1E68\u0218\u015E\u2C7E\uA7A8\uA784]/g,T:/[\u0054\u24C9\uFF34\u1E6A\u0164\u1E6C\u021A\u0162\u1E70\u1E6E\u0166\u01AC\u01AE\u023E\uA786]/g,TZ:/[\uA728]/g,U:/[\u0055\u24CA\uFF35\u00D9\u00DA\u00DB\u0168\u1E78\u016A\u1E7A\u016C\u00DC\u01DB\u01D7\u01D5\u01D9\u1EE6\u016E\u0170\u01D3\u0214\u0216\u01AF\u1EEA\u1EE8\u1EEE\u1EEC\u1EF0\u1EE4\u1E72\u0172\u1E76\u1E74\u0244]/g,V:/[\u0056\u24CB\uFF36\u1E7C\u1E7E\u01B2\uA75E\u0245]/g,VY:/[\uA760]/g,W:/[\u0057\u24CC\uFF37\u1E80\u1E82\u0174\u1E86\u1E84\u1E88\u2C72]/g,X:/[\u0058\u24CD\uFF38\u1E8A\u1E8C]/g,Y:/[\u0059\u24CE\uFF39\u1EF2\u00DD\u0176\u1EF8\u0232\u1E8E\u0178\u1EF6\u1EF4\u01B3\u024E\u1EFE]/g,Z:/[\u005A\u24CF\uFF3A\u0179\u1E90\u017B\u017D\u1E92\u1E94\u01B5\u0224\u2C7F\u2C6B\uA762]/g,a:/[\u0061\u24D0\uFF41\u1E9A\u00E0\u00E1\u00E2\u1EA7\u1EA5\u1EAB\u1EA9\u00E3\u0101\u0103\u1EB1\u1EAF\u1EB5\u1EB3\u0227\u01E1\u00E4\u01DF\u1EA3\u00E5\u01FB\u01CE\u0201\u0203\u1EA1\u1EAD\u1EB7\u1E01\u0105\u2C65\u0250]/g,aa:/[\uA733]/g,ae:/[\u00E6\u01FD\u01E3]/g,ao:/[\uA735]/g,au:/[\uA737]/g,av:/[\uA739\uA73B]/g,ay:/[\uA73D]/g,b:/[\u0062\u24D1\uFF42\u1E03\u1E05\u1E07\u0180\u0183\u0253]/g,c:/[\u0063\u24D2\uFF43\u0107\u0109\u010B\u010D\u00E7\u1E09\u0188\u023C\uA73F\u2184]/g,d:/[\u0064\u24D3\uFF44\u1E0B\u010F\u1E0D\u1E11\u1E13\u1E0F\u0111\u018C\u0256\u0257\uA77A]/g,dz:/[\u01F3\u01C6]/g,e:/[\u0065\u24D4\uFF45\u00E8\u00E9\u00EA\u1EC1\u1EBF\u1EC5\u1EC3\u1EBD\u0113\u1E15\u1E17\u0115\u0117\u00EB\u1EBB\u011B\u0205\u0207\u1EB9\u1EC7\u0229\u1E1D\u0119\u1E19\u1E1B\u0247\u025B\u01DD]/g,f:/[\u0066\u24D5\uFF46\u1E1F\u0192\uA77C]/g,g:/[\u0067\u24D6\uFF47\u01F5\u011D\u1E21\u011F\u0121\u01E7\u0123\u01E5\u0260\uA7A1\u1D79\uA77F]/g,h:/[\u0068\u24D7\uFF48\u0125\u1E23\u1E27\u021F\u1E25\u1E29\u1E2B\u1E96\u0127\u2C68\u2C76\u0265]/g,hv:/[\u0195]/g,i:/[\u0069\u24D8\uFF49\u00EC\u00ED\u00EE\u0129\u012B\u012D\u00EF\u1E2F\u1EC9\u01D0\u0209\u020B\u1ECB\u012F\u1E2D\u0268\u0131]/g,j:/[\u006A\u24D9\uFF4A\u0135\u01F0\u0249]/g,k:/[\u006B\u24DA\uFF4B\u1E31\u01E9\u1E33\u0137\u1E35\u0199\u2C6A\uA741\uA743\uA745\uA7A3]/g,l:/[\u006C\u24DB\uFF4C\u0140\u013A\u013E\u1E37\u1E39\u013C\u1E3D\u1E3B\u017F\u0142\u019A\u026B\u2C61\uA749\uA781\uA747]/g,lj:/[\u01C9]/g,m:/[\u006D\u24DC\uFF4D\u1E3F\u1E41\u1E43\u0271\u026F]/g,n:/[\u006E\u24DD\uFF4E\u01F9\u0144\u00F1\u1E45\u0148\u1E47\u0146\u1E4B\u1E49\u019E\u0272\u0149\uA791\uA7A5]/g,nj:/[\u01CC]/g,o:/[\u006F\u24DE\uFF4F\u00F2\u00F3\u00F4\u1ED3\u1ED1\u1ED7\u1ED5\u00F5\u1E4D\u022D\u1E4F\u014D\u1E51\u1E53\u014F\u022F\u0231\u00F6\u022B\u1ECF\u0151\u01D2\u020D\u020F\u01A1\u1EDD\u1EDB\u1EE1\u1EDF\u1EE3\u1ECD\u1ED9\u01EB\u01ED\u00F8\u01FF\u0254\uA74B\uA74D\u0275]/g,oi:/[\u01A3]/g,ou:/[\u0223]/g,oo:/[\uA74F]/g,p:/[\u0070\u24DF\uFF50\u1E55\u1E57\u01A5\u1D7D\uA751\uA753\uA755]/g,q:/[\u0071\u24E0\uFF51\u024B\uA757\uA759]/g,r:/[\u0072\u24E1\uFF52\u0155\u1E59\u0159\u0211\u0213\u1E5B\u1E5D\u0157\u1E5F\u024D\u027D\uA75B\uA7A7\uA783]/g,s:/[\u0073\u24E2\uFF53\u00DF\u015B\u1E65\u015D\u1E61\u0161\u1E67\u1E63\u1E69\u0219\u015F\u023F\uA7A9\uA785\u1E9B]/g,t:/[\u0074\u24E3\uFF54\u1E6B\u1E97\u0165\u1E6D\u021B\u0163\u1E71\u1E6F\u0167\u01AD\u0288\u2C66\uA787]/g,tz:/[\uA729]/g,u:/[\u0075\u24E4\uFF55\u00F9\u00FA\u00FB\u0169\u1E79\u016B\u1E7B\u016D\u00FC\u01DC\u01D8\u01D6\u01DA\u1EE7\u016F\u0171\u01D4\u0215\u0217\u01B0\u1EEB\u1EE9\u1EEF\u1EED\u1EF1\u1EE5\u1E73\u0173\u1E77\u1E75\u0289]/g,v:/[\u0076\u24E5\uFF56\u1E7D\u1E7F\u028B\uA75F\u028C]/g,vy:/[\uA761]/g,w:/[\u0077\u24E6\uFF57\u1E81\u1E83\u0175\u1E87\u1E85\u1E98\u1E89\u2C73]/g,x:/[\u0078\u24E7\uFF58\u1E8B\u1E8D]/g,y:/[\u0079\u24E8\uFF59\u1EF3\u00FD\u0177\u1EF9\u0233\u1E8F\u00FF\u1EF7\u1E99\u1EF5\u01B4\u024F\u1EFF]/g,z:/[\u007A\u24E9\uFF5A\u017A\u1E91\u017C\u017E\u1E93\u1E95\u01B6\u0225\u0240\u2C6C\uA763]/g},n=e;for(var r in t)n=n.replace(t[r],r);return n},e.contains=function(e,t){var n=e||"",r=t||"";return-1!==this.stripAccents(n.toLowerCase()).indexOf(this.stripAccents(r.toLowerCase()))},e.stripHtml=function(e){var t=document.createElement("div");return t.innerHTML=e,t.innerText},e}();e.StringUtils=t}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n){var r=this;this.$scope=e,this.modalService=t,this.historiqueService=n,this.FILTER_TEXT="historyFilterText",this.$scope.$watch(function(){return r.settings.active},function(e,t){e&&r.resetData()})}return Object.defineProperty(e.prototype,"isEmpty",{get:function(){return!this.historiqueContainer||!this.historiqueContainer.viewedEntries.length},enumerable:!0,configurable:!0}),e.prototype.onFilterChange=function(){var e=this;this.tableOptions.data=_.filter(this.historiqueContainer.viewedEntries,function(t){return t.match(e.historyFilter)})},e.prototype.clearHistory=function(){var e=this;this.modalService.showConfirm({actionButtonText:"Oui",closeButtonText:"Non",headerText:"Confirmation d'effacement",bodyText:"Voulez-vous effacer votre historique ? Cette action est irréversible.",iconName:"itce-question",size:"md"}).then(function(){e.historiqueService.clearHistorique(),e.resetData().then(function(){return e.initTable()})})},e.prototype.selectEntry=function(e){var t=this;this.historiqueService.activateEntry(e).then(function(){return t.onSelect({entry:e})})},e.prototype.resetData=function(){var e=this;return this.initPromise||(this.initPromise=this.historiqueService.readHistorique(this.settings.codePersonnaliteJuridique).then(function(t){e.historiqueContainer=t,e.initTable()})),this.initPromise.then(function(){e.historyFilter="",e.historiqueContainer.viewedEntries.forEach(function(e){return delete e.checked})})},e.prototype.initTable=function(){var e=this;this.tableOptions={width:"col-md-12",perPage:50,multiSelect:!1,filterEnable:!1,sortEnable:!0,moreEnable:!0,orderBy:"date",reserve:!0,columns:[{title:"Date",bind:"date",filter:"|date:'dd/MM/yyyy HH:mm'",cssClass:"timestamp"},{title:"Personne",bind:"",template:"typescript/rechercher-personne/historique/designation.html",cssClass:""},{title:"N° Pers.",bind:"identifiantPersonne",cssClass:""},{title:"Né(e) le / SIREN",bind:"dateNaissanceOuSiren",filter:"|dateNaissanceOuSirenFilter: mwTableRow",cssClass:""},{title:"Type",bind:"type",cssClass:""},{title:"Agence",bind:"agence",cssClass:""},{title:"Ville",bind:"ville",cssClass:""}],data:this.historiqueContainer.viewedEntries,selectedItems:[],templateUrl:"",selectionChangeHandler:{onSelectionChange:function(t){return e.selectEntry(t)}}},this.settings.hideAction||this.tableOptions.columns.push({title:"Action",bind:"action",cssClass:""})},e.$inject=["$scope","modalService","mwgcHistoriqueService"],e}();e.HistoriqueController=t}(t=e.historique||(e.historique={}))}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){function n(){return{restrict:"E",templateUrl:"typescript/rechercher-personne/historique/historique-view.html",scope:{settings:"=",onSelect:"&"},controller:t.HistoriqueController,controllerAs:"ctrl",bindToController:!0}}e.app.directive("mwgcHistoriqueRecherchePersonne",n)}(t=e.historique||(e.historique={}))}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){function n(t){return function(n,r){var i;return i=r.codePersonnaliteJuridique===e.CodesPersonnaliteJuridique.PERSONNE_MORALE?r.siren:r.dateNaissance?t("date")(r.dateNaissance,"dd/MM/yyyy"):"Non renseignée"}}n.$inject=["$filter"],e.app.filter("dateNaissanceOuSirenFilter",n)}(t=e.historique||(e.historique={}))}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){var n=function(){function e(){}return e.LIMITE_MAX_HISTORIQUE_PREFERENCES=50,e.PREFERENCE_KEY_PREFIX="historiqueRecherche_",e}();t.Constantes=n;var r=function(){function e(){}return e.SYNTHESE_CLIENT="Synthèse client",e.CONNAISSANCE_CLIENT_PART="Connaissance client Part",e.CONNAISSANCE_CLIENT_PRO="Connaissance client Pro",e}();t.Actions=r;var i=function(){function e(e,t){this.key=e,this.label=t}return e.nomFamille=new e("nomFamille","Nom"),e.prenom=new e("prenom","Prénom"),e.dateNaissance=new e("dateNaissance","Né(e) le"),e.bureauRatachement=new e("bureauRatachement","Agence"),e.sexe=new e("sexe","Sexe"),e.siren=new e("siren","SIREN"),e.raisonSociale=new e("raisonSociale","Raison sociale"),e.villeSiege=new e("villeSiege","Ville"),e.numeroCarte=new e("numeroCarte","N° de carte"),e.numeroPersonne=new e("numeroPersonne","N° de personne"),e.identifiantPersonne=new e("identifiantPersonne","Identifiant client"),e.rice=new e("rice","Compte"),e.numeroCredit=new e("numeroCredit","Crédit"),e.email=new e("email","Email"),e.numeroTelephone=new e("numeroTelephone","Téléphone"),e}();t.Properties=i;var s=function(){function t(e,t){this.codeEtablissement=e,this.codePersonnaliteJuridique=t,this.entries=[]}return Object.defineProperty(t.prototype,"viewedEntries",{get:function(){var e=this;return _.chain(this.entries).filter(function(t){return!e.codePersonnaliteJuridique||t.codePersonnaliteJuridique===e.codePersonnaliteJuridique}).sortBy(function(e){return e.date}).reverse().value()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isEmpty",{get:function(){return!this.viewedEntries.length},enumerable:!0,configurable:!0}),t.prototype.removeAll=function(){this.entries.length=0},t.prototype.addEntry=function(e){this.entries.length>=n.LIMITE_MAX_HISTORIQUE_PREFERENCES&&this.entries.pop(),this.deleteEntry(e),this.entries.unshift(e)},t.prototype.addPersonEntry=function(t,n,r){var i=new o;i.codePersonnaliteJuridique=n,i.action=r,i.identifiantPersonne=t.identifiantPersonne,i.ville=t.ligne6AdresseAFNOR,i.agence=t.edsDomiciliation,i.type=t.codeTypePersonne,t.dateNaissance&&(i.dateNaissance=new Date(t.dateNaissance)),i.siren=t.siren,t.codePersonnaliteJuridique===e.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE?i.designation=e.ClientUtils.getDesignationHistorique(t.codeCivilite,t.nomMarital,t.nomFamille,t.prenom):i.designation=t.raisonSociale,this.addEntry(i)},t.prototype.toPreferenceUtilisateur=function(){var e=this,t=_.map(this.entries,function(t,n){return{cle:e.getPreferenceKey(n+1),valeur:t.toPreferenceUtilisateur()}});return t.unshift({cle:this.getPreferenceKey(0),valeur:this.entries.length+""}),t},t.prototype.deleteEntry=function(e){for(var t=this.entries.length;t--;){var n=this.entries[t];n.identifiantPersonne===e.identifiantPersonne&&n.action===e.action&&this.entries.splice(t,1)}},t.prototype.getPreferenceKeys=function(){for(var e=[],t=0;t<=n.LIMITE_MAX_HISTORIQUE_PREFERENCES;t++)e.push(this.getPreferenceKey(t));return e},t.prototype.getPreferenceKey=function(e){return[n.PREFERENCE_KEY_PREFIX,this.codeEtablissement,"_",e].join("")},t}();t.Historique=s;var o=function(){function t(){this.date=new Date}return Object.defineProperty(t.prototype,"dateNaissanceOuSiren",{get:function(){return this.dateNaissance||this.siren},enumerable:!0,configurable:!0}),t.prototype.refreshDate=function(){this.date=new Date},t.prototype.match=function(t){var n=e.StringUtils.contains(this.designation,t)||e.StringUtils.contains(this.identifiantPersonne,t)||e.StringUtils.contains(this.agence,t)||e.StringUtils.contains(this.ville,t);return n=n||this.codePersonnaliteJuridique===e.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE&&e.StringUtils.contains(this.dateNaissance.toISOString(),t),n=n||this.codePersonnaliteJuridique===e.CodesPersonnaliteJuridique.PERSONNE_MORALE&&e.StringUtils.contains(this.siren,t)},t.prototype.toPreferenceUtilisateur=function(){var e={date:this.date.toJSON(),designation:this.designation,identifiantPersonne:this.identifiantPersonne,codePersonnaliteJuridique:this.codePersonnaliteJuridique,dateNaissance:this.dateNaissance?this.dateNaissance.toJSON():void 0,siren:this.siren,type:this.type,agence:this.agence,ville:this.ville,action:this.action};return JSON.stringify(e)},t.parseFromPreference=function(e){var n=JSON.parse(e),r=new t;return r.date=n.date?new Date(n.date):void 0,r.codePersonnaliteJuridique=n.codePersonnaliteJuridique,r.designation=n.designation,
r.identifiantPersonne=n.identifiantPersonne,r.dateNaissance=n.dateNaissance?new Date(n.dateNaissance):void 0,r.siren=n.siren,r.type=n.type,r.agence=n.agence,r.ville=n.ville,r.action=n.action,r},t}();t.HistoriqueEntry=o}(t=e.historique||(e.historique={}))}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){var n=function(){function e(e,t){this.$q=e,this.serviceAgentExtended=t}return e.prototype.readHistorique=function(e){var n=this;return this.initPromise?this.initPromise:this.initPromise=this.serviceAgentExtended.getAuthentificationInfo().then(function(r){return n.historiqueContainer=new t.Historique(r.codeEtablissement,e),n.$q.when(n.serviceAgentExtended.Preferences.lireMultiPreference(n.historiqueContainer.getPreferenceKeys()))}).then(function(e){var r=e.shift(),i=r?+r.valeur:0,s=e.filter(function(e){return!!e&&!!e.valeur});return s.forEach(function(e,r){i>r&&n.historiqueContainer.addEntry(t.HistoriqueEntry.parseFromPreference(e.valeur))}),n.historiqueContainer})},e.prototype.writeHistorique=function(){if(!this.initPromise)throw"Historique pas initialisé";var e=this.historiqueContainer.toPreferenceUtilisateur();return this.$q.when(this.serviceAgentExtended.Preferences.ecrireMultiPreference(e))},e.prototype.clearHistorique=function(){if(!this.initPromise)throw"Historique pas initialisé";return this.historiqueContainer.removeAll(),this.writeHistorique()},e.prototype.activateEntry=function(e){if(!this.initPromise)throw"Historique pas initialisé";return e.refreshDate(),this.writeHistorique()},e.prototype.addPersonEntry=function(e,n,r){var i=this;return void 0===r&&(r=t.Actions.SYNTHESE_CLIENT),this.readHistorique().then(function(t){return t.addPersonEntry(e,n,r),i.writeHistorique()})},e.$inject=["$q","serviceAgentExtended"],e}();t.HistoriqueService=n,e.app.service("mwgcHistoriqueService",n)}(t=e.historique||(e.historique={}))}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n=function(){function n(t,n,r,i,s,o,c,l,u,a,h){var d=this;this.$modalInstance=t,this.$scope=n,this.$q=r,this.serviceAgentExtended=i,this.criteres=s,this.rechercherPersonneService=o,this.rechercherPersonneModalService=c,this.agentConnecteService=l,this.loaderService=u,this.historiqueService=a,this.modalService=h,this.esSirenBdSiren=!1,this.esSirenPasConnus=!1,this.afficheListeQualiteNature=!1,this.referentielCorporateList=[],this.setBtnFermerPrincipale=!1,this.parametrageBoutonPP=this.rechercherPersonneService.getParamBoutonCreationPP(),this.parametrageBoutonPM=this.rechercherPersonneService.getParamBoutonCreationPM(),this.isConfidentiel=!1,this.isForcable=!1,this.agentConnecteService.estAgenceConnecteLaHenin().then(function(e){if(d.isAgentLaHenin=e,d.parametrageBoutonPP){d.listeActionsCreerPP=[];var t;d.parametrageBoutonPP.creationPersonne&&(t=d.parametrageBoutonPP.creationProspect||d.parametrageBoutonPP.creationTiers&&!d.isAgentLaHenin?"Personne physique":"Créer Personne physique",d.listeActionsCreerPP.push({titreAction:t,clicAction:function(){d.retour.actionCreation=1,d.creerPersonne()}})),d.parametrageBoutonPP.creationTiers&&!d.isAgentLaHenin&&(t=d.parametrageBoutonPP.creationProspect||d.parametrageBoutonPP.creationPersonne?"Tiers":"Créer Tiers",d.listeActionsCreerPP.push({titreAction:t,clicAction:function(){d.retour.actionCreation=2,d.creerPersonne()}})),d.parametrageBoutonPP.creationProspect&&(t=d.parametrageBoutonPP.creationTiers&&!d.isAgentLaHenin||d.parametrageBoutonPP.creationPersonne?"Prospect":"Créer Prospect",d.listeActionsCreerPP.push({titreAction:t,clicAction:function(){d.retour.actionCreation=3,d.creerPersonne()}}))}else d.listeActionsCreerPP=[{titreAction:"Créer Personne physique",clicAction:function(){d.creerPersonne()}}]}),n.$on(e.comGestionClient.CustomEvents.RECH_PM,function(e){d.afficheListeQualiteNature=!1;var t=d.esSirenBdSiren?"Créer PM : "+d.result.criteres.siren:"Créer PM";d.parametrageBoutonPM?(d.listeActionsCreerPM=[],d.parametrageBoutonPM.creationPersonne&&d.listeActionsCreerPM.push({titreAction:t,clicAction:function(){d.retour.actionCreation=1,d.afficheListeQualiteNature=!0}}),d.parametrageBoutonPM.creationTiers&&!d.isAgentLaHenin&&d.listeActionsCreerPM.push({titreAction:"Créer tiers",clicAction:function(){d.retour.actionCreation=2,d.afficheListeQualiteNature=!0}}),d.parametrageBoutonPM.creationProspect&&d.listeActionsCreerPM.push({titreAction:"Créer prospect",clicAction:function(){d.retour.actionCreation=3,d.afficheListeQualiteNature=!0}})):d.listeActionsCreerPM=[{titreAction:t,clicAction:function(){d.afficheListeQualiteNature=!d.afficheListeQualiteNature}}]}),this.afficherNumPersonne=this.rechercherPersonneService.getAfficherNumPersonne(),this.rechercherPersonneService.setAppelRechercheModeModale(!0),this.modeAppel=this.rechercherPersonneService.getModeAppel(),this.filtreRecherche=this.rechercherPersonneService.getFiltreRecherche(),this.result=new e.comGestionClient.RecherchePersonneResult,this.retour=new e.comGestionClient.RecherchePersonneRetour,this.creationPersonneBtnVisibilityBool=this.rechercherPersonneService.getCreationPersonneBtnVisibilityBool(),this.result.criteres=this.rechercherPersonneService.getCriteres(),n.$watch(function(){return d.result.criteres.siren&&d.result.criteres.siren.length},function(e,t){e?d.result.critereIsEmpty=!1:d.result.critereIsEmpty=!0}),n.$watch(function(){return d.result.personnes&&0===d.result.personnes.length&&d.result.critereIsEmpty&&d.result.clientListe&&0===d.result.clientListe.length},function(e,t){e?d.setBtnFermerPrincipale=!0:d.setBtnFermerPrincipale=!1}),this.criteres instanceof MyWay.Model.Client&&(this.result.criteres=this.criteres),n.$on(e.comGestionClient.CustomEvents.SELECT_CLIENT,function(e){e.stopPropagation(),d.selectionnerPersonne()}),n.$on("esSirenReferencer",function(e,t){d.esSirenBdSiren=t}),n.$on("isNotSirenMySysAndNotSiren",function(e,t){d.esSirenPasConnus=t}),n.$on("btnNatureQualiteDetail",function(e,t){d.btnNatureQualiteDetail=t}),n.$watch(function(){return d.result.criteres.siren},function(e,t){(e&&e.length&&9!==e.length||!e)&&(d.afficheListeQualiteNature=!1)}),n.$watch(function(){return d.rechercherPersonneModalService.getReferentielCorporateList().length},function(e,t){e&&(d.referentielCorporateList=_.sortBy(d.rechercherPersonneModalService.getReferentielCorporateList(),"libelle"))}),n.$watch(function(){return d.result.type},function(e,t){5!==e||4!==e?d.afficheListeQualiteNature=!1:d.referentielCorporateList=[]}),n.$watch(function(){return d.result.critereIsEmpty},function(e,t){e&&(d.afficheListeQualiteNature=!1)})}return n.prototype.creerProspectPM=function(){this.afficheListeQualiteNature=!this.afficheListeQualiteNature,this.retour.actionCreation=3},n.prototype.creerPM=function(){var e=this;this.serviceAgentExtended.addToContext(MyWay.Context.DataKey.client,this.result).then(function(){e.retour.actionCreation=1,e.retour.criteres=angular.copy(e.result.criteres),e.$modalInstance.close(e.retour)})},n.prototype.creerTiersPM=function(){this.afficheListeQualiteNature=!this.afficheListeQualiteNature,this.retour.actionCreation=2},n.prototype.onSelectPersonne=function(){this.selectionnerPersonne()},n.prototype.onSelectHistory=function(e){var t=this;this.loaderService.start(),this.rechercherPersonneService.getPersonneByIdentifiant(e.identifiantPersonne).then(function(e){t.result.personnes=[e],t.selectionnerPersonne()})["catch"](function(){t.loaderService.stop()})},n.prototype.selectionnerPersonne=function(){var e=this;if("N"!==this.result.personnes[0].confidentialite&&"F"!==this.result.personnes[0].confidentialite){this.loaderService.start();var n=this.result.personnes[0];n.personnePhysique=n.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE,n.personneMorale=n.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_MORALE,this.retour.personneSelectionnee=angular.copy(n);var r=this.$q.when();n.identifiantPersonne&&!this.retour.complementPersonnePhysique&&n.personnePhysique?r=this.rechercherPersonneService.getInformationParticulier(n.identifiantPersonne).then(function(t){return e.retour.complementPersonnePhysique=angular.copy(t)}):n.identifiantPersonne&&!this.retour.complementPersonneMorale&&n.personneMorale&&(r=this.rechercherPersonneService.getInformationCorporate(n.identifiantPersonne).then(function(t){return e.retour.complementPersonneMorale=angular.copy(t)})),r.then(function(){return e.historiqueService.addPersonEntry(n,n.codePersonnaliteJuridique,t.historique.Actions.SYNTHESE_CLIENT)}).then(function(){return e.$modalInstance.close(e.retour)})["finally"](function(){return e.loaderService.stop()})}else"N"===this.result.personnes[0].confidentialite?this.isConfidentiel=!0:(this.isConfidentiel=!0,this.isForcable=!0)},n.prototype.forcerConfidentiel=function(){var e=this;this.rechercherPersonneModalService.tracerForcage(this.result.personnes[0]),this.loaderService.start();var n=this.result.personnes[0];n.personnePhysique=n.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_PHYSIQUE,n.personneMorale=n.codePersonnaliteJuridique===t.CodesPersonnaliteJuridique.PERSONNE_MORALE,this.retour.personneSelectionnee=angular.copy(n);var r=this.$q.when();n.identifiantPersonne&&!this.retour.complementPersonnePhysique&&n.personnePhysique?r=this.rechercherPersonneService.getInformationParticulier(n.identifiantPersonne).then(function(t){return e.retour.complementPersonnePhysique=angular.copy(t)}):n.identifiantPersonne&&!this.retour.complementPersonneMorale&&n.personneMorale&&(r=this.rechercherPersonneService.getInformationCorporate(n.identifiantPersonne).then(function(t){return e.retour.complementPersonneMorale=angular.copy(t)})),r.then(function(){return e.historiqueService.addPersonEntry(n,n.codePersonnaliteJuridique,t.historique.Actions.SYNTHESE_CLIENT)}).then(function(){return e.$modalInstance.close(e.retour)})["finally"](function(){return e.loaderService.stop()})},n.prototype.annulerConfidentiel=function(){this.isForcable=!1,this.isConfidentiel=!1,this.result.personnes[0].identifiantPersonne=null},n.prototype.onNavcolRecherche=function(e){this.recherchePersonneMenuSearch=e},n.prototype.creerPersonne=function(){this.retour.criteres=angular.copy(this.result.criteres),this.$modalInstance.close(this.retour)},n.prototype.cacheBoutonCreation=function(){return!(0===this.result.clientListe.length&&!this.result.errorMessage||5===this.result.type||4===this.result.type)||!this.creationPersonneBtnVisibilityBool||5===this.result.type||4===this.result.type&&9===this.result.criteres.siren.length},n.prototype.afficherBoutonCreation=function(){return 5===this.result.type||4===this.result.type||1===this.result.type&&"08"===this.result.criteres.rice.codeActiviteCompte},n.$inject=["$modalInstance","$scope","$q","serviceAgentExtended","criteres","mwgcRechercherPersonneService","rechercherPersonneModalService","agentConnecteService","mwgcLoaderService","mwgcHistoriqueService","modalService"],n}();t.app.controller("mwgcRechercherPersonneModalController",n)}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n=function(){function t(e,t){this.serviceAgentExtended=e,this.$q=t,this.referentielCorporateList=[]}return t.prototype.getSecteurActivite=function(){var e="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083//referentielCorporate-v1/secteurActivite";return this.serviceAgentExtended.sendRequest({url:e,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){return e})},t.prototype.getQualite=function(e){var t="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083//referentielCorporate-v1/qualite?codeSecteurActivite="+e;return this.serviceAgentExtended.sendRequest({url:t,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){return e})},t.prototype.buildReferentielCorporateObject=function(){var e=this,t={id:null,libelle:null,tabQualite:[{codeQualite:null,libelle:null}]},n=[],r=[];this.getSecteurActivite().then(function(i){i&&(angular.forEach(i,function(i,s){i.idSecteurActivite&&r.push(e.getQualite(String(i.idSecteurActivite)).then(function(e){return t={id:i.idSecteurActivite,libelle:i.libelle,tabQualite:e},n.push(t),t}))}),e.$q.all(r).then(function(t){e.setReferentielCorporateList(t)}))})},t.prototype.tracerForcage=function(t){var n=this;this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(r){var i=new e.comGestionClient.ConfidentialiteClient(r.codeEtablissement,t.identifiantPersonne),s="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v3/confidentialite";n.serviceAgentExtended.sendRequest({url:s,withHeaders:!0,method:MyWay.Services.MethodEnum.PUT,data:i,params:{codeAction:"T"}}).then(function(e){return!0},function(e){return e})})},t.prototype.getReferentielCorporateList=function(){return this.referentielCorporateList},t.prototype.setReferentielCorporateList=function(e){this.referentielCorporateList=e},t.$inject=["serviceAgentExtended","$q"],t}();t.RechercherPersonneModalService=n,t.app.service("rechercherPersonneModalService",n)}(t=e.comGestionClient||(e.comGestionClient={}))}(myway||(myway={})),angular.module("myway.comGestionClient").run(["$templateCache",function(e){e.put("typescript/mw-bouton-liste-actions/mw-bouton-liste-actions-view.html",'<div ng-show="!mwBoutonListeActionsCtrl.data.length || mwBoutonListeActionsCtrl.data.length > 1" dropdown on-toggle="mwBoutonListeActionsCtrl.toggle(open)" ng-keydown="focusSuivant($event)">\r\n   <mw-button texte="{{mwBoutonListeActionsCtrl.titre}}" modele="{{mwBoutonListeActionsCtrl.modele}}" taille="col-md-2" id="bouton1" class="dropdown-toggle form-control" ng-disabled="mwBoutonListeActionsCtrl.disabled || !mwBoutonListeActionsCtrl.data.length" icone="itce-chevron-{{mwBoutonListeActionsCtrl.getSens()}} pull-right" dropdown-toggle></mw-button>\r\n    <ul class="dropdown-menu bouton-actions haut" role="menu" data-ng-class="{haut: mwBoutonListeActionsCtrl.position === \'haut\'}">\r\n        <li ng-repeat="action in mwBoutonListeActionsCtrl.data">\r\n            <a href ng-attr-id="lien-{{$index}}" ng-click="action.clicAction()" ng-bind="::action.titreAction"></a>\r\n        </li>\r\n    </ul>\r\n</div>\r\n<mw-button texte="{{mwBoutonListeActionsCtrl.data[0].titreAction}}" modele="{{mwBoutonListeActionsCtrl.modele}}" taille="col-md-2" id="bouton2" class="form-control" ng-disabled="mwBoutonListeActionsCtrl.disabled" ng-click="mwBoutonListeActionsCtrl.data[0].clicAction()" ng-show="mwBoutonListeActionsCtrl.data.length === 1"></mw-button>\r\n'),e.put("typescript/rechercher-personne/rechercher-personne-view.html",'<div class="rechercher-personne">\r\n        <ng-form class="form-horizontal" name="formRecherchePersonne" role="form" novalidate ng-keydown="ctrl.keydown($event)">\r\n            <tabset>\r\n                <tab heading="Recherche" ng-attr-id="{{ctrl.RECHERCHE_TAB_ID}}">\r\n                    <mw-synthese-erreurs titre="">\r\n                        <ul>\r\n                            <li ng-if="ctrl.result.isSearchRequest() && formRecherchePersonne.$invalid && ctrl.result.critereIsEmpty">\r\n                                Veuillez renseigner au moins un critère de recherche\r\n                            </li>\r\n                            <li ng-if="ctrl.result.errorMessage || ctrl.isNotSirenMySysAndNotSiren">\r\n                                {{ctrl.result.errorMessage}}\r\n                            </li>\r\n                        </ul>\r\n                    </mw-synthese-erreurs>\r\n\r\n                    <div class="myway-gestion-client-criteres">\r\n\r\n                        <!--*********************************************************************************-->\r\n                        <div class="row init-padding-margin" ng-if="ctrl.recherchePersonnePhysique">\r\n\r\n                            <div class="col-sm-11 col-md-3">\r\n                                <label class="control-label label-nom width-label">Nom</label>\r\n                                <div class="col-md-11 padding-nom">\r\n                                    <mwsf-saisie-nom required="(ctrl.isTypeRechercheIdentite() || ctrl.nomRequired)" ng-model="ctrl.result.criteres.nomFamille" set-focus="true" agent-la-henin="ctrl.isAgentHenin && ctrl.isLaHeninNomFamille"></mwsf-saisie-nom>\r\n                                </div>\r\n                            </div>\r\n                            <div class="col-sm-11 col-md-3">\r\n                                <label class="control-label label-nom width-label">Prénom</label>\r\n                                <div class="col-md-11 padding-nom">\r\n                                    <mwsf-saisie-prenom ng-model="ctrl.result.criteres.prenom" required="false" agent-la-henin="ctrl.isAgentHenin && ctrl.isLaHeninPrenom" id="prenom">\r\n                                    </mwsf-saisie-prenom>\r\n                                </div>\r\n                            </div>\r\n                            <div class="col-sm-11 col-md-2">\r\n                                <label class="control-label width-label">Né(e) le</label>\r\n                                <mwsf-date-de-naissance ng-model="ctrl.result.criteres.dateNaissance" required="false" agent-la-henin="ctrl.isAgentHenin && ctrl.isLaHeninDateNaissance">\r\n                                </mwsf-date-de-naissance>\r\n                            </div>\r\n                            <div class="col-sm-11 col-md-3">\r\n                                <label class="control-label width-label">Agence</label>\r\n                                <mwsf-saisie-agence-destinataire ng-model="ctrl.result.criteres.bureauRatachement" required="false" chevron-visible="false" not-items-found-text="aucune correspondance" dropdown-set-width="25em" prolongement-liste-vers-gauche="true">\r\n                                </mwsf-saisie-agence-destinataire>\r\n                            </div>\r\n                            <div class="col-sm-5 col-md-1">\r\n                                <label class="control-label width-label" for="Sexe">Sexe</label>\r\n                                <input type="text" class="form-control set-col-md-1-width-sexe" ng-model="ctrl.result.criteres.sexe" mwsf-string-only-input tooltip-placement="bottom" tooltip-trigger="focus blur mouseenter mouseleave" tooltip="Veuillez saisir M ou F">\r\n                            </div>\r\n                        </div>\r\n                        <!--*********************************************************************************-->\r\n                        <div class="row init-padding-margin" ng-class="{\'set-row-espacement\' : !ctrl.modeAppel}" ng-if="ctrl.recherchePersonneMorale">\r\n                            <div class="col-sm-11 col-md-3">\r\n                                <label class="control-label width-label">SIREN</label>\r\n                                <div class="col-md-11 set-init-padding">\r\n                                    <mwsf-siren ng-model="ctrl.result.criteres.siren" is-valid="ctrl.sirenValid" required="false"></mwsf-siren>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class="col-sm-11 col-md-3">\r\n                                <label class="control-label width-label">Raison sociale</label>\r\n                                <div class="col-md-11 set-init-padding" ng-class="{\'has-error\' : ctrl.result.criteres.raisonSociale && ctrl.result.criteres.raisonSociale.length > 40}" style="padding: 0">\r\n                                    <input type="text" class="form-control text-transform-uppercase" ng-model="ctrl.result.criteres.raisonSociale" ng-change="ctrl.bindingDataOnChange(ctrl.result.criteres.raisonSociale)">\r\n                                    <span class="error-msg col-md-12 help-inline" ng-show="(ctrl.isTypeRechercheRaisonSociale() || ctrl.raisonSocialeRequired) && !ctrl.result.criteres.raisonSociale">\r\n                                        Renseigner\r\n                                        la raison sociale.\r\n                                    </span>\r\n                                    <span class="error-msg col-md-12 help-inline" ng-show="ctrl.result.criteres.raisonSociale && ctrl.result.criteres.raisonSociale.length > 40">\r\n                                        Le\r\n                                        nombre de caractères de la raison sociale doit être compris entre 1 et 40.\r\n                                    </span>\r\n                                </div>\r\n                            </div>\r\n                            <div class="col-sm-11 col-md-2">\r\n                                <label class="control-label width-label">Ville du siège</label>\r\n                                <div class="col-md-12 set-init-padding" style="padding: 0">\r\n                                    <ng-form class="form-horizontal">\r\n                                        <div class="form-group">\r\n                                            <div class="col-md-12">\r\n                                                <input type="text" class="form-control text-transform-uppercase" maxlength="32" ng-model="ctrl.result.criteres.villeSiege" mwsf-string-only-input>\r\n                                            </div>\r\n                                        </div>\r\n                                    </ng-form>\r\n                                </div>\r\n                            </div>\r\n                            <div class="col-sm-11 col-md-4" ng-if="!(ctrl.recherchePersonneMorale && ctrl.recherchePersonnePhysique)">\r\n                                <label class="control-label width-label">Agence</label>\r\n                                <mwsf-saisie-agence-destinataire ng-model="ctrl.result.criteres.bureauRatachement" required="false" chevron-visible="false" not-items-found-text="aucune correspondance" dropdown-set-width="25em" prolongement-liste-vers-gauche="true">\r\n                                </mwsf-saisie-agence-destinataire>\r\n                            </div>\r\n                        </div>\r\n                        <!--*********************************************************************************-->\r\n\r\n                        <div ng-show="ctrl.afficherMiniRechercheNumPersonne">\r\n                            <div ng-show="ctrl.afficherNumPersonne">\r\n                                <div class="row init-padding-margin">\r\n                                    <div class="col-sm-11 col-md-3 set-corrective-position-btn-rechercher set-row-espacement-saisie-num-personne-p-m init-margin">\r\n                                        <label class="control-label width-label">N° de personne</label>\r\n\r\n                                        <div class="col-md-11 set-init-padding">\r\n                                            <mwsf-saisie-num-personne required="false" ng-model="ctrl.result.criteres.numeroPersonne"></mwsf-saisie-num-personne>\r\n                                        </div>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                        </div>\r\n                        <div class="row init-padding-margin" ng-class="{ \'set-row-espacement\' : !ctrl.modeAppel}" ng-show="(ctrl.rechercheAvancee || (ctrl.recherchePersonnePhysique && !ctrl.recherchePersonneMorale)) && !ctrl.afficherMiniRechercheNumPersonne">\r\n                            <div class="col-sm-11 col-md-3" ng-hide="ctrl.recherchePersonnePhysique && !ctrl.recherchePersonneMorale">\r\n                                <label class="control-label width-label">N° de carte</label>\r\n\r\n                                <div class="col-md-11 set-init-padding">\r\n                                    <mwsf-numero-carte ng-model="ctrl.result.criteres.numeroCarte" required="false">\r\n                                    </mwsf-numero-carte>\r\n                                </div>\r\n                            </div>\r\n                            <div>\r\n                                <div ng-show="ctrl.afficherNumPersonne" class="col-sm-11 col-md-3 set-corrective-position-btn-rechercher" ng-hide="(ctrl.recherchePersonnePhysique && !ctrl.recherchePersonneMorale) && !this.afficherNumPersonne" ng-class="{ \'set-row-espacement\' : ctrl.recherchePersonnePhysique && !ctrl.recherchePersonneMorale}">\r\n                                    <label class="control-label width-label">N° de personne</label>\r\n\r\n                                    <div class="col-md-11 set-init-padding">\r\n                                        <mwsf-saisie-num-personne required="false" ng-model="ctrl.result.criteres.numeroPersonne"></mwsf-saisie-num-personne>\r\n                                    </div>\r\n                                </div>\r\n                            </div>\r\n                            <div class="col-sm-11 col-md-2 col-lg-2" ng-hide="ctrl.recherchePersonnePhysique && !ctrl.recherchePersonneMorale">\r\n                                <label class="control-label width-label">Identifiant client</label>\r\n                                <!--identifiant BAD-->\r\n                                <mwsf-saisie-identifiant-client ng-model="ctrl.result.criteres.identifiantPersonne" required="false"></mwsf-saisie-identifiant-client>\r\n                            </div>\r\n                            <div class="col-sm-11 col-md-4 decale-rib" ng-hide="ctrl.recherchePersonnePhysique && !ctrl.recherchePersonneMorale">\r\n                                <mwsf-saisie-rib ng-model="ctrl.result.criteres.rice"></mwsf-saisie-rib>\r\n                            </div>\r\n\r\n                        </div>\r\n                        <!--*********************************************************************************-->\r\n                        <div class="row init-padding-margin" ng-class="{ \'set-row-espacement-email\' : !ctrl.modeAppel}" ng-show="ctrl.rechercheAvancee2">\r\n                            <div class="col-sm-11 col-md-3">\r\n                                <label class="control-label width-label">N° de crédit</label>\r\n\r\n                                <div class="col-md-11 set-init-padding">\r\n                                    <input type="text" class="form-control" ng-model="ctrl.result.criteres.numeroCredit" maxlength="27" mwsf-num-credit-input>\r\n                                </div>\r\n                            </div>\r\n\r\n                            <div class="col-sm-11 col-md-3">\r\n                                <label class="control-label width-label" for="idemail">Email</label>\r\n\r\n                                <div class="col-md-11 set-init-padding">\r\n                                    <mwsf-email id="idemail" ng-model="ctrl.result.criteres.email"></mwsf-email>\r\n                                </div>\r\n                            </div>\r\n                            <div class="col-sm-11 col-md-6 col-lg-5">\r\n                                <label class="control-label width-label">Téléphone fixe ou mobile</label>\r\n                                <mwsf-saisie-numero-telephone ng-model="ctrl.result.criteres.numeroTelephone">\r\n                                </mwsf-saisie-numero-telephone>\r\n                            </div>\r\n                        </div>\r\n                        <!--*********************************************************************************-->\r\n                        <div class="row init-padding-margin">\r\n                            <div class="col-xs-2 col-sm-2 col-md-2" style="min-width: 8em">\r\n                                <mw-button texte="Réinitialiser" modele="secondaire" class="btn-criteres-avances" ng-click="ctrl.reinit()">\r\n                                </mw-button>\r\n                            </div>\r\n\r\n                            <div class="col-xs-3 col-sm-4 col-md-3 col-lg-2 init-margin" ng-show="ctrl.recherchePersonneMorale && ctrl.recherchePersonnePhysique">\r\n                            </div>\r\n\r\n                            <div class="col-xs-3 col-sm-4 col-md-3 col-lg-2 set-btn-rechercher-position">\r\n                                <mw-button texte="Rechercher" modele="{{ctrl.modelePrincipaleBoutonRechercher ? \'principale\' : \'zone\' }}" class="btn-criteres-avances" ng-click="ctrl.rechercher()" ng-disabled="ctrl.result.criteres.siren && !ctrl.sirenValid"></mw-button>\r\n                            </div>\r\n                        </div>\r\n                        <!--*********************************************************************************-->\r\n                    </div>\r\n                </tab>\r\n                <tab heading="Historique" ng-attr-id="{{ctrl.HISTORY_TAB_ID}}" active="ctrl.historiqueRechercheSettings.active" select="ctrl.onSelectHistoryTab()">\r\n                    <mwgc-historique-recherche-personne settings="ctrl.historiqueRechercheSettings" on-select="ctrl.onSelectHistoryEntry(entry)"></mwgc-historique-recherche-personne>\r\n                </tab>\r\n            </tabset>\r\n        </ng-form>\r\n        <!--Appel a la directive loader-->\r\n        <mwsf-loader-css load-in-progress="ctrl.loading"></mwsf-loader-css>\r\n\r\n        <div ng-if="ctrl.isRestitutionPP">\r\n            <mwsf-restitution-personne client-liste="ctrl.clientListe" selected-client="ctrl.result.personnes">\r\n            </mwsf-restitution-personne>\r\n        </div>\r\n\r\n        <div ng-if="ctrl.isRestitutionPM">\r\n            <mwsf-restitution-personne-morale client-liste="ctrl.clientListe" selected-client="ctrl.personneMoraleSelectionnee"></mwsf-restitution-personne-morale>\r\n        </div>\r\n\r\n        <div ng-if="ctrl.isRestitution2PM">\r\n            <mwsf-restitution-personne-morale client-liste="ctrl.clientListe" selected-client="ctrl.result.personnes">\r\n            </mwsf-restitution-personne-morale>\r\n        </div>\r\n\r\n        <!--liste restitution recherhce par media Personne Physique-->\r\n        <div ng-if="ctrl.isRestitutionMediaPP">\r\n            <mwsf-restitution-personne client-liste="ctrl.restitutionListePP" selected-client="ctrl.result.personnesPhysique"></mwsf-restitution-personne>\r\n        </div>\r\n        <!--liste restitution recherhce par media Personne Morale-->\r\n        <div ng-if="ctrl.isRestitutionMediaPM">\r\n            <mwsf-restitution-personne-morale client-liste="ctrl.restitutionListePM" selected-client="ctrl.result.personnesMorale"></mwsf-restitution-personne-morale>\r\n        </div>\r\n        <br><br>\r\n        <div ng-if="ctrl.isRestitutionMediaPPEtPM">\r\n            <tabset>\r\n                <tab heading="{{ctrl.restitutionListePP.length <= 1 ? \'Personne physique\' : \'Personnes physique\'}} : ({{ctrl.restitutionListePP.length}}  {{ctrl.restitutionListePP.length <= 1 ? \'résultat\' : \'résultats\'}} )" disabled="{{ctrl.restitutionListePP.length === 0 ? \'true\' : \'false\'}}" ng-click="ctrl.ongletActiverPP = true; ctrl.ongletActiverPM = false;">\r\n                    <mwsf-restitution-personne client-liste="ctrl.restitutionListePP" selected-client="ctrl.result.personnesPhysique"></mwsf-restitution-personne>\r\n                </tab>\r\n                <tab heading="{{ctrl.restitutionListePM.length <= 1 ? \'Personne morale\' : \'Personnes morale\'}} : ({{ctrl.restitutionListePM.length}}  {{ctrl.restitutionListePM.length <= 1 ? \'résultat\' : \'résultats\'}} )" disabled="{{ctrl.restitutionListePM.length === 0 ? \'true\' : \'false\'}}" ng-click="ctrl.ongletActiverPM = true; ctrl.ongletActiverPP = false;">\r\n                    <mwsf-restitution-personne-morale client-liste="ctrl.restitutionListePM" selected-client="ctrl.result.personnesMorale"></mwsf-restitution-personne-morale>\r\n                </tab>\r\n            </tabset>\r\n        </div>\r\n\r\n        <section ng-hide="ctrl.cacherBtnQualiterNature === \'true\'" ng-show="ctrl.cacherBtnQualiterNature !==\'true\'">\r\n            <div class="init-padding-margin" ng-show="(ctrl.result.clientListe.length !== 0 && (ctrl.result.criteres.raisonSociale || ctrl.result.criteres.siren)) || (ctrl.result.clientListe.length === 0 && ctrl.result.errorMessage && ctrl.result.errorMessage.indexOf(\'Aucun client\') !== -1)">\r\n                <h1 class="col-xs-5 col-xs-offset-4"></h1>\r\n                <bouton-creation-personne ng-model="ctrl.result" data-es-siren-bd-siren="ctrl.esSirenReferencer" data-es-siren-pas-connus="ctrl.isNotSirenMySysAndNotSiren"></bouton-creation-personne>\r\n            </div>\r\n        </section>\r\n</div>\r\n'),
e.put("typescript/restituer-personne/detail-ligne-tableau-restitution-view.html",'\r\n\r\n\r\n<div class="detail-tr">\r\n    <div class="row">\r\n        <span class="col-md-2">Adresse</span>\r\n        <div class="col-md-3">\r\n            <p data-ng-bind="::mwTableRow.ligne2AdresseAFNOR"></p>\r\n            <p data-ng-bind="::mwTableRow.ligne3AdresseAFNOR"></p>\r\n            <p data-ng-bind="::mwTableRow.ligne4AdresseAFNOR"></p>\r\n            <p data-ng-bind="::mwTableRow.ligne5AdresseAFNOR"></p>\r\n            <p data-ng-bind="::mwTableRow.ligne6AdresseAFNOR"></p>\r\n        </div>\r\n        <div class="col-md-offset-2 col-md-5">\r\n            <div class="row" data-ng-show="::mwTableRow.numTelephoneFixe">\r\n                <span class="col-md-6">N° de téléphone fixe : </span>\r\n                <span class="col-md-6" data-ng-bind="::mwTableRow.numTelephoneFixe"></span>\r\n            </div>\r\n            <div class="row" data-ng-show="::mwTableRow.numTelephonePortable">\r\n                <span class="col-md-6">N° de téléphone portable : </span>\r\n                <span class="col-md-6" data-ng-bind="::mwTableRow.numTelephonePortable"></span>\r\n            </div>\r\n            <div class="row" data-ng-show="::mwTableRow.courrierElectronique">\r\n                <span class="col-md-6">Courrier électronique : </span>\r\n                <span class="col-md-6" data-ng-bind="::mwTableRow.courrierElectronique"></span>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>   '),e.put("typescript/restituer-personne/restituer-personne-view.html",'<div class="myway-restitution-personne" tabindex="0" ng-keydown="viewModelRestituerPersonneCtrl.keydown($event)" mw-focus data-ng-show="viewModelRestituerPersonneCtrl.clientListe">\r\n    <div class="col-md-12">\r\n        <div class="search-result-count" data-ng-if="viewModelRestituerPersonneCtrl.clientListe.length < 2">{{viewModelRestituerPersonneCtrl.clientListe.length}} résultat</div>\r\n        <div class="search-result-count" data-ng-if="viewModelRestituerPersonneCtrl.clientListe.length > 1">{{viewModelRestituerPersonneCtrl.clientListe.length}} résultats</div>   \r\n    </div>\r\n    <mw-table id="table-restitution-personne" options="viewModelRestituerPersonneCtrl.tableOptions"></mw-table>\r\n</div> \r\n<div>&nbsp;</div>  '),e.put("typescript/restituer-personne-morale/restituer-personne-morale-view.html",'<div class="myway-restitution-personne" tabindex="0" ng-keydown="viewModelRestituerPersonneMoraleCtrl.keydown($event)" mw-focus data-ng-show="viewModelRestituerPersonneMoraleCtrl.clientListe">\r\n    <div class="col-md-12"> \r\n        <div class="search-result-count" data-ng-if="viewModelRestituerPersonneMoraleCtrl.clientListe.length < 2">{{viewModelRestituerPersonneMoraleCtrl.clientListe.length}} résultat</div>\r\n        <div class="search-result-count" data-ng-if="viewModelRestituerPersonneMoraleCtrl.clientListe.length > 1">{{viewModelRestituerPersonneMoraleCtrl.clientListe.length}} résultats</div>   \r\n    </div>\r\n    <mw-table id="table-restitution-personne" options="viewModelRestituerPersonneMoraleCtrl.tableOptions"></mw-table>\r\n</div>\r\n<div>&nbsp;</div> '),e.put("typescript/rechercher-personne/historique/designation.html",'<span ng-if="!mwTableRow.siren" class="icon itce-undefined" aria-hidden="true"></span>\r\n<span ng-if="mwTableRow.siren" class="icon itce-business" aria-hidden="true"></span>\r\n<span ng-bind="mwTableRow.designation"></span>'),e.put("typescript/rechercher-personne/historique/historique-view.html",'<div class="historique-recherche">\r\n    <div class="form-group">\r\n        <div class="col-lg-4 col-md-4">\r\n            <input type="text" ng-attr-id="{{ ctrl.FILTER_TEXT }}" ng-model="ctrl.historyFilter" ng-change="ctrl.onFilterChange()" placeholder="Rechercher dans toutes les données affichées" class="form-control">\r\n        </div>\r\n        <div class="col-lg-offset-6 col-lg-2 col-md-offset-5 col-md-3">\r\n            <button class="btn btn-block btn-zone" ng-click="ctrl.clearHistory()" ng-disabled="ctrl.isEmpty">Effacer l\'historique</button>\r\n        </div>\r\n    </div>\r\n    <div class="form-group">\r\n        <div class="col-md-12">\r\n            <mw-table ng-if="ctrl.tableOptions" options="ctrl.tableOptions" id="tableau-historique"></mw-table>\r\n        </div>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/rechercher-personne/modale/rechercher-personne-modal-view.html",'<div class="myway-recherche-personne-modal">\r\n    <div ng-if="ctrl.isConfidentiel">\r\n        <div class="modal-header">\r\n            <button type="button" data-ng-click="ctrl.annulerConfidentiel()" class="close" aria-hidden="true"><span class="icon itce-times"></span></button>\r\n            <h3 class="modal-title"><span class="icon itce-indefined recherche-personne-title-icon"></span>Client Confidentiel</h3>\r\n        </div>\r\n        <div class="modal-body">\r\n            <div ng-if="ctrl.isForcable">Vous avez la possibilite de forcer l\'accès à ce client. Le forçage sera tracé.</div>\r\n            <div ng-if="!ctrl.isForcable">Vous n\'êtes pas habilité(e) à acceder aux données du client.</div>\r\n        </div>\r\n        <div class="modal-footer">\r\n            <div class="col-xs-3 col-md-2 col-sm-3 col-lg-2 col-xs-offset-3 col-sm-offset-0 espace-btn-fermer">\r\n                <mw-button texte="Annuler" modele="secondaire" data-ng-click="ctrl.annulerConfidentiel()"></mw-button>\r\n            </div>\r\n            <div class="col-xs-3 col-md-3 col-lg-3 col-sm-4" ng-if="ctrl.isForcable">\r\n                    <mw-button texte="Forcer" modele="principale" data-ng-click="ctrl.forcerConfidentiel()"></mw-button>\r\n            </div>\r\n        </div>\r\n    </div>\r\n        <div ng-if="!ctrl.isConfidentiel">\r\n            <div class="modal-header">\r\n                <button type="button" data-ng-click="ctrl.$modalInstance.dismiss()" class="close" aria-hidden="true"><span class="icon itce-times"></span></button>\r\n                <h3 class="modal-title"><span class="icon itce-indefined recherche-personne-title-icon"></span>Recherche Personne</h3>\r\n            </div>\r\n\r\n            <div class="modal-body" data-ng-show="!ctrl.modeAppel">\r\n                <div class="container-recherche">\r\n                    <mwsf-recherche-personne result="ctrl.result" on-select-history="ctrl.onSelectHistory(entry)" on-select-personne="ctrl.onSelectPersonne()" modale="true" afficher-num-personne="{{ ctrl.afficherNumPersonne }}" filtre-recherche="ctrl.filtreRecherche"></mwsf-recherche-personne>\r\n                </div>\r\n            </div>\r\n            <div class="modal-body" data-ng-show="ctrl.modeAppel">\r\n                <div class="container-recherche">\r\n                    <mwsf-recherche-personne result="ctrl.result" on-select-history="ctrl.onSelectHistory(entry)" on-select-personne="ctrl.onSelectPersonne()" mode-appel="{{ ctrl.modeAppel }}" modale="true" afficher-num-personne="{{ ctrl.afficherNumPersonne }}" filtre-recherche="ctrl.filtreRecherche"></mwsf-recherche-personne>\r\n                </div>\r\n            </div>\r\n        <div>\r\n            <div class="modal-footer">\r\n                <div class="col-xs-3 col-md-2 col-sm-3 col-lg-2 col-xs-offset-3 col-sm-offset-0 espace-btn-fermer" data-ng-class="{ \'col-lg-offset-7\' : !ctrl.cacheBoutonCreation(), \'col-md-offset-2  col-lg-offset-4\' : ctrl.cacheBoutonCreation()}">\r\n                    <mw-button texte="Annuler" modele="secondaire" data-ng-click="ctrl.$modalInstance.dismiss()"></mw-button>\r\n                </div>\r\n                <!--                \r\n                Suppression du bouton de création de personne morale INC001981179 \r\n                <div class="col-xs-3 col-md-4 col-lg-3 col-sm-5 espace-btn-cree-personne" data-ng-show="ctrl.afficherBoutonCreation()">\r\n                    <mw-button\r\n                        texte="{{ ctrl.esSirenBdSiren ? \'Créer PM : \' + ctrl.result.criteres.siren : \'Créer Personne Morale\' }}"\r\n                        modele="zone"\r\n                        data-ng-click="ctrl.creerPM()"\r\n                    ></mw-button>\r\n                </div>\r\n                    -->\r\n\r\n                <div class="col-xs-3 col-md-4 col-lg-3 col-sm-5 espace-btn-cree-personne" data-ng-hide="((ctrl.result.clientListe.length === 0 && !ctrl.result.errorMessage) || ctrl.afficherBoutonCreation()) || !ctrl.creationPersonneBtnVisibilityBool">\r\n                    <mw-bouton-liste-actions-gestion-client titre="Créer" data="ctrl.listeActionsCreerPP" position="haut" modele="zone"> </mw-bouton-liste-actions-gestion-client>\r\n                </div>\r\n                <div class="col-xs-3 col-md-3 col-lg-3 col-sm-4">\r\n                    <mw-button texte="Sélectionner" modele="principale" data-ng-disabled="!ctrl.result.isPersonneSelectionnee() || ctrl.result.isNoSearch() || ctrl.result.isNoResult() || ctrl.result.isSearchError()" data-ng-click="ctrl.selectionnerPersonne()"></mw-button>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n</div>\r\n')}]);