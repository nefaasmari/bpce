/**
 * Généré par : SIGCESIE\ct-tfsbuild
 * Changeset TFS : C581521
 * Etiquette TFS : com-echeancier-v20.06_20200831.1
 * Déclenchement : Manual
 */
var myway;!function(e){var i;!function(e){"use strict";e.app=angular.module("myway.comEcheancier",["ui.bootstrap","moduleAgent","myway.ui","myway.comInterdomaine","ngSanitize"])}(i=e.comEcheancier||(e.comEcheancier={}))}(myway||(myway={}));var myway;!function(e){var i;!function(i){var t;!function(i){function t(t){if(console.log("createDocument.entree",[t]),!t.contenu)throw new MyWay.Services.Erreur("L'objet contenant les données pour l'impression n'est pas complet");var n=new i.OrdreVirementPermSepa;n.Nomdemandeur_1=t.nomDemandeur?t.nomDemandeur:"",n.AdrsDO1=t.adresseDemandeur?t.adresseDemandeur:"",n.AdrsDO2=t.complementAdresseDemandeur?t.complementAdresseDemandeur:t.cPVilleDemandeur?t.cPVilleDemandeur:"",n.AdrsDO3=t.complementAdresseDemandeur?t.cPVilleDemandeur:"",n.IdentCli=t.numPersonneDemandeur,n.LibCE_1=t.libelleEtablissement.articleLaLe+" "+t.libelleEtablissement.etablissementLibelleLong,n.BicIban_1=t.bicDonneurOrdre&&t.ibanDonneurOrdre?t.bicDonneurOrdre+" "+t.ibanDonneurOrdre:"",n.CodeEco_1=t.codeEconomique?t.codeEconomique:"",n.Montant_1=t.montant&&t.montant.montant?t.montant.montant.toFixed(2)+" ":"",t.montant&&("EUR"===t.montant.devise.code&&t.montant.montant>1?n.Montant_1+="Euros":n.Montant_1+=t.montant.devise.libelle),n.Periodicite_1=t.periodicite&&t.periodicite.value?t.periodicite.value:"",n.DateDeCreation=t.dateCreation?moment(t.dateCreation).format("DD/MM/YYYY"):"",n.DateDerniereModification=t.dateModificationDossier?moment(t.dateModificationDossier).format("DD/MM/YYYY"):"",n.DatePremEch=t.dateDebut?moment(t.dateDebut).format("DD/MM/YYYY"):"",n.DateDerEch=t.dateFin?moment(t.dateFin).format("DD/MM/YYYY"):"",n.Motif_2=t.libelle?t.libelle:"",n.IdentDO_1=t.identifiantDonneurOrdre?t.identifiantDonneurOrdre:"",n.RefDO_1=t.referenceDonneurOrdre?t.referenceDonneurOrdre:"",n.NomBen_1=t.nomBeneficiaire?t.nomBeneficiaire:"",n.AdrsBen1=t.adresseBeneficiaire?t.adresseBeneficiaire:"",n.PaysResidBen_1=t.paysBeneficiaire?t.paysBeneficiaire:"",n.AdrsBen2=t.complementAdresseBeneficiaire?t.complementAdresseBeneficiaire:t.cPVilleBeneficiaire?t.cPVilleBeneficiaire:"",n.AdrsBen3=t.complementAdresseBeneficiaire?t.cPVilleBeneficiaire:"",n.BicBen_1=t.bicBeneficiaire?t.bicBeneficiaire:"",n.IbanBen_1=t.ibanBeneficiaire?t.ibanBeneficiaire:"",n.BqueBen_3=t.banqueBeneficiaire?t.banqueBeneficiaire:"",n.PaysBque=t.paysBanqueBeneficiaire?t.paysBanqueBeneficiaire:"",n.IdentBen_1=t.identifiantBeneficiaire?t.identifiantBeneficiaire:"";var r={};r.LibCE=t.libelleEtablissement.articleLaLe+" "+t.libelleEtablissement.etablissementLibelleLong,n.TexteOpe=r,n.NomDOInit_1=t.nomDesignationDonneurOrdreInitial?t.nomDesignationDonneurOrdreInitial:"",n.IdentDOInit_1=t.identifiantDonneurOrdreInitial?t.identifiantDonneurOrdreInitial:"",n.NomBenFin_1=t.nomDesignationBeneficiaireFinal?t.nomDesignationBeneficiaireFinal:"",n.IdentBenFin_1=t.identifiantBeneficiaireFinal?t.identifiantBeneficiaireFinal:"",n.NatPaie_1=t.naturePaiement?t.naturePaiement:"",n.CatPaie_1=t.categoriePaiement?t.categoriePaiement:"";var a={};if(a.Nom_Etablissement=t.libelleEtablissement.articleMinusculeLaLe,n.CertifiExact=a,t.nom){var o=n.SignatureSepa2={};t.qualite&&(o.QUALITE_SIGNATAIRE=t.qualite),t.nom&&(o.LIDANM=t.nom),t.prenom&&(o.LIDAPP=t.prenom),o.REF_IDENTITE=t.referenceIdentite?t.referenceIdentite:"",o.NomAgent=t.nomAgent?t.nomAgent:""}else{var s=n.SignatureSepa={};s.NomAgent=t.nomAgent?t.nomAgent:""}var c={};c._attribute_Content=MyWay.Services.Impression.TYPE_IMAGE.Id,c._value_=t.enteteEds.codeEtablissement?t.enteteEds.codeEtablissement+".jpg":"",n.Logo=c,n.DesignationEDS=t.enteteEds.libelleEDS?t.enteteEds.libelleEDS:"";var m,d=t.libelleEtablissement.articleMajusculeLaLe;switch(m=t.nomPrenomParticipant?t.nomPrenomParticipant:n.Nomdemandeur_1.trim(),t.contenu.typeEdition){case e.comEcheancier.impression.TypeDocumentImpression.Creation:case e.comEcheancier.impression.TypeDocumentImpression.Duplicata:n.type_edition="CONTRAT ECHEANCIER",n.PaveSoussigné="Je soussigné(e) "+m+", agissant en qualité d’ayant droit,  prie "+d+" d’effectuer la création du virement référencé ci-dessous :",n.DateDeCreation=moment(t.dateCreation).format("DD/MM/YYYY"),t.dateModificationDossier&&(n.DateDerniereModification=moment(t.dateModificationDossier).format("DD/MM/YYYY"));break;case e.comEcheancier.impression.TypeDocumentImpression.Modification:n.type_edition="AVENANT CONTRAT ECHEANCIER",n.PaveSoussigné="Je soussigné(e) "+m+", agissant en qualité d’ayant droit,  prie "+d+" d’effectuer la modification du virement référencé ci-dessous :",n.DateDeCreation=moment(t.dateCreation).format("DD/MM/YYYY"),t.dateModificationDossier&&(n.DateDerniereModification=moment(t.dateModificationDossier).format("DD/MM/YYYY"));break;case e.comEcheancier.impression.TypeDocumentImpression.Suspension:n.type_edition="AVENANT CONTRAT",t.contenu.decideurClient?n.PaveSoussigné="Demande de suspension d’un échéancier de virement SEPA faite par "+m+" et suivant les caractéristiques ci-dessous:":n.PaveSoussigné="Demande de suspension d’un échéancier de virement SEPA faite par "+t.nomAgent+", "+t.libelleEtablissement.etablissementLibelleLong+" et suivant les caractéristiques ci-dessous:",t.contenu.dateActivation&&(n.PaveSoussigneSpecifique={},n.PaveSoussigneSpecifique.PaveSoussigneSpecifique="Date d’activation de la suspension de l’échéancier: "+moment(t.contenu.dateActivation).format("DD/MM/YYYY")),t.contenu.dateReactivation&&(n.PaveSoussigneSpecifique2={},n.PaveSoussigneSpecifique2.PaveSoussigneSpecifique2="Date de réactivation de l’échéancier :"+moment(t.contenu.dateReactivation).format("DD/MM/YYYY")),t.contenu.motifChangement&&(n.PaveSoussigneSpecifique3={},n.PaveSoussigneSpecifique3.PaveSoussigneSpecifique3="Motif de la suspension : "+t.contenu.motifChangement);break;case e.comEcheancier.impression.TypeDocumentImpression.Reactivation:n.type_edition="AVENANT CONTRAT",t.contenu.decideurClient?n.PaveSoussigné="Je soussigné(e), "+m+" demande la réactivation  de l’échéancier de virement suivant les caractéristiques : ":n.PaveSoussigné="Demande de Réactivation d’un échéancier de virement SEPA faite par "+t.nomAgent+", "+t.libelleEtablissement.etablissementLibelleLong+" et suivant les caractéristiques ci-dessous:",t.contenu.dateReactivation&&(n.PaveSoussigneSpecifique={},n.PaveSoussigneSpecifique.PaveSoussigneSpecifique="Date de réactivation de l’échéancier :"+moment(t.contenu.dateReactivation).format("DD/MM/YYYY")),t.contenu.motifChangement&&(n.PaveSoussigneSpecifique2={},n.PaveSoussigneSpecifique2.PaveSoussigneSpecifique2="Motif de la réactivation : "+t.contenu.motifChangement);break;case e.comEcheancier.impression.TypeDocumentImpression.DoubleValidation:n.type_edition="Avis d'opération pour dossier d'échéancier de virement SEPA",n.PaveSoussigné="Double validation du dossier :",n.PaveSoussigneSpecifique={},n.PaveSoussigneSpecifique.PaveSoussigneSpecifique="Validée par "+t.nomAgent+"  le "+moment(new Date).format("DD/MM/YYYY")+".";break;case e.comEcheancier.impression.TypeDocumentImpression.Cloture:t.contenu.decideurClient?(n.type_edition="CLOTURE CONTRAT ECHEANCIER",n.PaveSoussigné="Je soussigné(e) "+m+", agissant en qualité d’ayant droit,  prie "+d+" d’effectuer la modification du virement référencé ci-dessous :"):(n.PaveSoussigné="Je soussigné(e) "+t.nomAgent+", "+t.libelleEtablissement.etablissementLibelleLong+" déclare avoir envoyé un courrier au client en respectant le préavis de clôture et procède à la clôture du virement référencé ci-dessous : ",n.type_edition="SUPPRESSION CONTRAT ECHEANCIER"),t.contenu.motifChangement&&(n.PaveSoussigneSpecifique={},n.PaveSoussigneSpecifique.PaveSoussigneSpecifique="Motif de la clôture : "+t.contenu.motifChangement),n.CertifiExact=null;break;default:n.type_edition="CONTRAT"}n.AdresseEDS=t.enteteEds.adresse?t.enteteEds.adresse:"",n.Ligne6AdrsAfnr=t.enteteEds.cPVille?t.enteteEds.cPVille:"",n.NumrTelpEDS=t.enteteEds.numeroTelephone?t.enteteEds.numeroTelephone:"",n.RefDossier_1=t.contenu.refDossier?t.contenu.refDossier:"",n.Date_2=moment(new Date).format("DD/MM/YYYY HH:mm:ss");var l={};return l.MentionsLegales=t.mentionsLegales?t.mentionsLegales:"",n.MentionsLegales=l,n}function n(e){return e.forEach(function(e){return"Titulaire"===e.libelleRole?e:void 0}),null}i.createDocument=t,i.getTitulaire=n}(t=i.impression||(i.impression={}))}(i=e.comEcheancier||(e.comEcheancier={}))}(myway||(myway={}));var myway;!function(e){var i;!function(i){var t=function(){function i(e,i,t,n){this.serviceAgentExtended=e,this.versementPeriodiqueService=i,this.mwsfDeviseService=t,this.$q=n}return i.prototype.imprimerEcheancier=function(i,t,n,r,a){var o=this;console.log("imprimerEcheancier");var s,c,m,d=new e.comEcheancier.impression.DonneesEcheancierPourImpression;return this.serviceAgentExtended.getAuthentificationInfo().then(function(e){return e.agentConnecte&&(n&&"VAD"===n||(d.nomAgent=e.agentConnecte.nomUsagePersonnePhysique?e.agentConnecte.nomUsagePersonnePhysique:e.agentConnecte.nomFamillePersonnePhysique,d.nomAgent+=" "+e.agentConnecte.prenom),c=e.agentConnecte.numeroInterneEds),o.getInfoEds(e.codeEtablissement)}).then(function(e){return d.enteteEds=e,d.contenu=i,o.getLibelleEtablissement(e.codeEtablissement)}).then(function(e){return d.libelleEtablissement=e,o.getMentionsLegales(d.enteteEds.codeEtablissement)}).then(function(e){d.mentionsLegales=e.pied.ligne1?e.pied.ligne1:"",d.mentionsLegales+=e.pied.ligne2?e.pied.ligne2:"",d.mentionsLegales+=e.pied.ligne3?e.pied.ligne3:"",d.mentionsLegales+=e.pied.ligne4?e.pied.ligne4:"",d.mentionsLegales+=e.pied.ligne5?e.pied.ligne5:"",d.mentionsLegales+=e.pied.ligne6?e.pied.ligne6:"",d.enteteEds.libelleEtablissement=e.corps.raisonSociale;var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/echeancier/v1/informationEcheancier?codeEtablissement="+e.codeEtablissement+"&identifiantDossierVirSEPA="+d.contenu.refDossier+"&indicateurVirementBQD="+d.contenu.indicateurVirementBQD;return n&&"VAD"===n&&(i+="&codeCanal="+n),o.serviceAgentExtended.sendRequest({url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET})}).then(function(e){return s=new MyWay.Model.Rice(e.codeEtablissement,e.codeGuichet,null,e.numeroCompteClientDonneurOrdre),n&&"VAD"===n&&(d.nomAgent=e.nomCorrespondant+", "+e.fonctionCorrespondant),o.mappeEcheancierRessourcePourImpression(e,d,r,a)}).then(function(){return m=o.estCodePaysFrance(d.bicBeneficiaire),m?o.$q.when(null):o.getInformationBicSepa(d.bicBeneficiaire)}).then(function(e){return e&&(d.banqueBeneficiaire=e.donneesBicPays.libelleBanque),m?o.getInterrogationFIB(d.ibanBeneficiaire.substr(4,5),d.ibanBeneficiaire.substr(9,5),c):o.$q.when(null)}).then(function(e){return e&&(d.banqueBeneficiaire=e.adresseGuichet.libelleDomiciliationGuichet),o.getCodeEconomique(d.paysBanqueBeneficiaire)}).then(function(e){if(d.codeEconomique){var i=e.filter(function(e){return e.codeEconomique===d.codeEconomique});i&&i.length>0&&(d.codeEconomique=d.codeEconomique+" - "+i[0].libelleCodeEconomique)}return o.getCategoriePaiement()}).then(function(e){var i=e.filter(function(e){return e.codeCategoriePaiement===d.categoriePaiement});return i&&i.length>0&&(d.categoriePaiement=i[0].descriptionCategoriePaiement),o.serviceAgentExtended.DonneesDelocalisees.getDonneesDelocalisees(s.codeEtablissement,"H81E")}).then(function(e){if(e.donnees){var i=e.donnees.filter(function(e){return e.COLIPB===d.paysBeneficiaire});d.paysBeneficiaire=i&&i.length>0?i[0].LIDGPY:d.paysBeneficiaire,d.paysBanqueBeneficiaire=!d.paysBanqueBeneficiaire&&d.bicBeneficiaire?d.bicBeneficiaire.substr(4,2):d.paysBanqueBeneficiaire;var t=2===d.paysBanqueBeneficiaire.length?"COLIPB":"CDDDPY",n=e.donnees.filter(function(e){return e[t]===d.paysBanqueBeneficiaire});d.paysBanqueBeneficiaire=n&&n.length>0?n[0].LIDGPY:d.paysBanqueBeneficiaire}return o.getInformationParticulier(s.codeEtablissement,s.codeGuichet.value,s.radical,d)}).then(function(){var i=e.comEcheancier.impression.createDocument(d),n=t?new e.comEcheancier.impression.OrdreVirementPermSepaArchiverParams(t):new e.comEcheancier.impression.OrdreVirementPermSepaGenererParams;return o.serviceAgentExtended.Impression.generer(i,n)}).then(function(e){return e})},i.prototype.imprimerEcheancierUnit=function(i,t,n,r){var a=this;console.log("imprimerEcheancierUnit",[i,t,n,r]);var o,s,c,m=new e.comEcheancier.impression.DonneesEcheancierPourImpression;return this.serviceAgentExtended.getAuthentificationInfo().then(function(e){return e.agentConnecte&&(m.nomAgent=e.agentConnecte.nomUsagePersonnePhysique?e.agentConnecte.nomUsagePersonnePhysique:e.agentConnecte.nomFamillePersonnePhysique,m.nomAgent+=" "+e.agentConnecte.prenom,s=e.agentConnecte.numeroInterneEds),a.getInfoEds(e.codeEtablissement)}).then(function(e){return m.enteteEds=e,m.contenu=i,a.getLibelleEtablissement(e.codeEtablissement)}).then(function(e){return m.libelleEtablissement=e,a.getMentionsLegales(m.enteteEds.codeEtablissement)}).then(function(e){m.mentionsLegales=e.pied.ligne1?e.pied.ligne1:"",m.mentionsLegales+=e.pied.ligne2?e.pied.ligne2:"",m.mentionsLegales+=e.pied.ligne3?e.pied.ligne3:"",m.mentionsLegales+=e.pied.ligne4?e.pied.ligne4:"",m.mentionsLegales+=e.pied.ligne5?e.pied.ligne5:"",m.mentionsLegales+=e.pied.ligne6?e.pied.ligne6:"",m.enteteEds.libelleEtablissement=e.corps.raisonSociale;var i="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/echeancier/v1/informationEcheancier?codeEtablissement="+m.enteteEds.codeEtablissement+"&identifiantDossierVirSEPA="+m.contenu.refDossier+"&indicateurVirementBQD="+m.contenu.indicateurVirementBQD;return a.serviceAgentExtended.sendRequest({url:i,withHeaders:!0,method:MyWay.Services.MethodEnum.GET})}).then(function(e){return o=e,a.mappeEcheancierRessourcePourImpression(e,m,n,r)}).then(function(){return c=a.estCodePaysFrance(m.bicBeneficiaire),c?a.$q.when(null):a.getInformationBicSepa(m.bicBeneficiaire)}).then(function(e){return e&&(m.banqueBeneficiaire=e.donneesBicPays.libelleBanque),c?a.getInterrogationFIB(m.ibanBeneficiaire.substr(4,5),m.ibanBeneficiaire.substr(9,5),s):a.$q.when(null)}).then(function(e){return e&&(m.banqueBeneficiaire=e.adresseGuichet.libelleDomiciliationGuichet),a.getCodeEconomique(m.paysBanqueBeneficiaire)}).then(function(e){if(m.codeEconomique){var i=e.filter(function(e){return e.codeEconomique===m.codeEconomique});i&&i.length>0&&(m.codeEconomique=m.codeEconomique+" - "+i[0].libelleCodeEconomique)}return a.getNaturePaiement()}).then(function(e){var i=e.filter(function(e){return e.codeNaturePaiementEnFrancais===m.naturePaiement});return i&&i.length>0&&(m.naturePaiement=i[0].descriptionNaturePaiement),a.getCategoriePaiement()}).then(function(e){var i=e.filter(function(e){return e.codeCategoriePaiement===m.categoriePaiement});return i&&i.length>0&&(m.categoriePaiement=i[0].descriptionCategoriePaiement),a.serviceAgentExtended.DonneesDelocalisees.getDonneesDelocalisees(m.enteteEds.codeEtablissement,"H81E")}).then(function(e){if(e.donnees){var i=e.donnees.filter(function(e){return e.COLIPB===m.paysBeneficiaire});m.paysBeneficiaire=i&&i.length>0?i[0].LIDGPY:m.paysBeneficiaire,m.paysBanqueBeneficiaire=!m.paysBanqueBeneficiaire&&m.bicBeneficiaire?m.bicBeneficiaire.substr(4,2):m.paysBanqueBeneficiaire;var t=2===m.paysBanqueBeneficiaire.length?"COLIPB":"CDDDPY",n=e.donnees.filter(function(e){return e[t]===m.paysBanqueBeneficiaire});m.paysBanqueBeneficiaire=n&&n.length>0?n[0].LIDGPY:m.paysBanqueBeneficiaire}return a.getInformationParticulier(o.codeEtablissement,o.codeGuichet,o.numeroCompteClientDonneurOrdre,m)}).then(function(){var i=e.comEcheancier.impression.createUnitDocument(m),n=t?new e.comEcheancier.impression.OrdreVirementUnitSepaArchiverParams(t):new e.comEcheancier.impression.OrdreVirementUnitSepaGenererParams;return a.serviceAgentExtended.Impression.generer(i,n)}).then(function(e){return e})},i.prototype.mappeEcheancierRessourcePourImpression=function(e,i,t,n){var r=this;return i.numPersonneDemandeur=e.numeroPersonne?e.numeroPersonne.toString():null,i.identifiantDonneurOrdre=e.identifiantDonneurOrdre,i.referenceDonneurOrdre=e.referenceDonneurOrdre,i.codeEconomique=e.codeEconomique,i.dateCreation=e.dateCreationEcheancier&&"0001"!==e.dateCreationEcheancier.toString().substr(0,4)&&"9999"!==e.dateCreationEcheancier.toString().substr(0,4)?e.dateCreationEcheancier:void 0,i.dateModificationDossier=e.dateModificationEcheancier&&"0001"!==e.dateModificationEcheancier.toString().substr(0,4)&&"9999"!==e.dateModificationEcheancier.toString().substr(0,4)?e.dateModificationEcheancier:void 0,i.dateDebut=e.datePremiereEcheance&&"0001"!==e.datePremiereEcheance.toString().substr(0,4)&&"9999"!==e.datePremiereEcheance.toString().substr(0,4)?e.datePremiereEcheance:void 0,i.dateFin=e.dateDerniereEcheance&&"0001"!==e.dateDerniereEcheance.toString().substr(0,4)&&"9999"!==e.dateDerniereEcheance.toString().substr(0,4)?e.dateDerniereEcheance:void 0,i.ibanDonneurOrdre=e.numeroIbanCompteDonneurOrdre,i.bicDonneurOrdre=e.codeBicBanqueDonneurOrdre,i.nomBeneficiaire=e.libelleCompletBeneficiaire,i.paysBeneficiaire=e.indicatifPaysBeneficiaire,i.bicBeneficiaire=e.codeBicDestinataire,i.ibanBeneficiaire=e.numeroIbanCompteBeneficiaire,i.identifiantBeneficiaire=e.identifiantBeneficiaire,i.paysBanqueBeneficiaire=e.codePaysBanqueBeneficiaire,i.nomDesignationDonneurOrdreInitial=e.libelleDonneurOrdreUltime,i.identifiantDonneurOrdreInitial=e.identifiantDonneurOrdreUltime,i.nomDesignationBeneficiaireFinal=e.libelleBeneficiaireUltime,i.identifiantBeneficiaireFinal=e.identifiantBeneficiaireUltime,i.naturePaiement=e.libelleNaturePaiement,i.categoriePaiement=e.codeCategoriePaiement,i.libelle=e.libelle1VirementImmediat?e.libelle1VirementImmediat:"",i.libelle+=e.libelle2VirementImmediat?" "+e.libelle2VirementImmediat:"",i.libelle+=e.libelle3VirementImmediat?" "+e.libelle3VirementImmediat:"",i.libelle+=e.libelle4VirementImmediat?" "+e.libelle4VirementImmediat:"",i.adresseBeneficiaire=e.adresse1Beneficiaire?e.adresse1Beneficiaire:"",i.complementAdresseBeneficiaire=e.adresse2Beneficiaire?e.adresse2Beneficiaire+" ":"",i.complementAdresseBeneficiaire+=e.adresse3Beneficiaire?e.adresse3Beneficiaire:"",i.cPVilleBeneficiaire=e.adresse4Beneficiaire?e.adresse4Beneficiaire:"",t&&(i.qualite=t.libelleRole,i.nom=t.nomParticipant,i.prenom=t.prenomParticipant,i.nomPrenomParticipant=t.nomPrenomParticipant),i.referenceIdentite=n,i.periodicite=new MyWay.Model.Periodicite(e.codePeriodicite),i.montant=new MyWay.Model.MontantDevise(e.montantMouvementVirmtImmediat,e.codeDevise),this.versementPeriodiqueService.getPeriodicites().then(function(e){return e&&(i.periodicite=e.filter(function(e){return e.key===i.periodicite.key})[0]),r.mwsfDeviseService.getDeviseByCode(i.montant.codeDevise).then(function(e){i.montant.devise=e},function(e){throw e})},function(e){throw e})},i.prototype.getInfoEds=function(i){var t=this;return this.serviceAgentExtended.getParametresComptables().then(function(n){var r="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/structure-v2/caracteristiqueEDS?codeEtablissement="+i+"&identifiantInterneEDS="+n.edsInterneRattachementGuichetComptable+"&typeEDS="+n.edsTypeRattachementGuichetComptable+"&referenceExterneEDS="+n.edsExterneRattachementGuichetComptable+"&typeOrganisation=001",a=new e.comEcheancier.impression.InfoEds;return t.serviceAgentExtended.sendRequest({url:r,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){return a=e.infoEDS,a.adresse=e.infoEDS.ligne2?e.infoEDS.ligne2+" ":"",a.adresse+=e.infoEDS.ligne3?e.infoEDS.ligne3+" ":"",a.adresse+=e.infoEDS.ligne4?e.infoEDS.ligne4+" ":"",a.adresse+=e.infoEDS.ligne5?e.infoEDS.ligne5:"",a.cPVille=e.infoEDS.ligne6,a.codeEtablissement=i,a},function(e){throw e})})},i.prototype.getMentionsLegales=function(e){var i=moment(new Date).format("DD/MM/YYYY"),t="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/structure-v2/MentionsLegales?date="+i+"&codeEtablissement="+e;return this.serviceAgentExtended.sendRequest({url:t,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){return e},function(e){throw e})},i.prototype.getInformationParticulier=function(e,i,t,n){var r="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/entitetitulaire/v2/recherchePersonneRg1?codeEtablissement="+e+"&codeGuichet="+i+"&numeroCompte="+t;return this.serviceAgentExtended.sendRequest({url:r,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){n.nomDemandeur=e.designationBancaireCourte,n.numPersonneDemandeur=_.padLeft(e.numeroPersonne.toString(),9,"0"),e.ligne3Adresse?(n.adresseDemandeur=e.ligne3Adresse,n.complementAdresseDemandeur=e.ligne5Adresse?e.ligne5Adresse:e.ligne4Adresse,n.adresseDemandeur+=e.ligne5Adresse?" "+e.ligne4Adresse:""):(n.adresseDemandeur=e.ligne4Adresse,n.complementAdresseDemandeur=e.ligne5Adresse),n.cPVilleDemandeur=e.ligne6Adresse},function(e){throw e})},i.prototype.getNaturePaiement=function(){var e=this.$q.defer(),i={url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/virementparametre/v1/naturePaiement",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{}};return this.serviceAgentExtended.sendRequest(i).then(function(i){e.resolve(i.listeNaturePaiement)})["catch"](function(i){e.reject(i)}),e.promise},i.prototype.getCategoriePaiement=function(){var e=this.$q.defer(),i={url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/virementparametre/v1/categoriePaiement",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{}};return this.serviceAgentExtended.sendRequest(i).then(function(i){e.resolve(i.listeCategoriePaiement)})["catch"](function(i){e.reject(i)}),e.promise},i.prototype.getCodeEconomique=function(e){var i=this.$q.defer(),t={};e&&(t={codeGroupeAppartenancePays:e});var n={url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/virementparametre/v1/codeEconomique",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:t};return this.serviceAgentExtended.sendRequest(n).then(function(e){i.resolve(e.listeCodeEconomique)})["catch"](function(e){i.reject(e)}),i.promise},i.prototype.getLibelleEtablissement=function(e){var i=this.$q.defer(),t={url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/outilimpression/v1/libelleEtablissement",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{codeEtablissement:e}};return this.serviceAgentExtended.sendRequest(t).then(function(e){i.resolve(e)})["catch"](function(e){i.reject(e)}),i.promise},i.prototype.getInformationBicSepa=function(e){var i=this.$q.defer(),t={url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/opefinanciereservice/v1/informationBicSepa",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{codeBic:e,codeTraitementRechercheBic:6}};return this.serviceAgentExtended.sendRequest(t).then(function(e){i.resolve(e)})["catch"](function(e){i.reject(e)}),i.promise},i.prototype.getInterrogationFIB=function(e,i,t){var n=this.$q.defer(),r={url:"http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/opefinanciereservice/v1/interrogationFIB",method:MyWay.Services.MethodEnum.GET,withHeaders:!0,params:{codeEtablissement:e,codeGuichet:i,codeAgent:t}};return this.serviceAgentExtended.sendRequest(r).then(function(e){n.resolve(e)})["catch"](function(e){n.reject(e)}),n.promise},i.prototype.estCodePaysFrance=function(e){return e&&e.length>=8&&"FR"===e.substr(4,2)},i.$inject=["serviceAgentExtended","versementPeriodiqueService","mwsfDeviseService","$q"],i}();i.EcheancierImpressionService=t,i.app.service("echeancierImpressionService",t)}(i=e.comEcheancier||(e.comEcheancier={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){var i;!function(e){var i=function(){function e(){this._attribute_id="OrdreVirementPermSepa.docx",this._attribute_xmlns="http://comEcheancier_05-DEPOTS-SRV_ECHEAN_05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa.xsd"}return e}();e.OrdreVirementPermSepa=i;var t=function(){function e(e){this.systeme={typeName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa",typeFullName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa",librairie:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa"},this.obligatoires={action:MyWay.Services.Impression.GENERATION_ACTION.archiverAndGetFichier,parametresGenerationFichier:{typeFichier:MyWay.Services.Fichier.TYPE_FICHIER.PDFA_1B,restitutionVersion:MyWay.Services.Impression.RESTITUTION_VERSION.V180,sousRepModele:"05-depots-srv/echean_doc"}},e?this.optionnels={nomFichier:"OrdreVirementPermSepa.pdf",archivage:{aQstnCreerDoc:{donnCntx:{codeEtablissement:e.codeEtablissement,idntCmpstApplf:e.idntCmpstApplf},document:{proprietesDoc:{codeTypeNatrDoc:e.codeTypeNatrDoc,codeTypeAttrb:e.codeTypeAttrb,idntAttrb:e.idntAttrb,dateDeliv:e.dateDeliv?e.dateDeliv:new Date,dateNumr:e.dateNumr?e.dateNumr:new Date,inttAttr:e.inttAttr,codeTypeStck:e.codeTypeStck?e.codeTypeStck:"L",datePerm:moment().add(60,"day").toDate()},fichierDoc:{nomFich:"OrdreVirementPermSepa.pdf"}}}}}:this.optionnels={nomFichier:"OrdreVirementPermSepa.pdf"}}return e}();e.OrdreVirementPermSepaArchiverParams=t;var n=function(){function e(){this.systeme={typeName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa",typeFullName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa",librairie:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa"},this.obligatoires={action:MyWay.Services.Impression.GENERATION_ACTION.getFichier,parametresGenerationFichier:{typeFichier:MyWay.Services.Fichier.TYPE_FICHIER.PDFA_1B,restitutionVersion:MyWay.Services.Impression.RESTITUTION_VERSION.V180,sousRepModele:"05-depots-srv/echean_doc"}},this.optionnels={nomFichier:"OrdreVirementPermSepa.pdf"}}return e}();e.OrdreVirementPermSepaGenererParams=n;var r=function(){function e(){this.systeme={typeName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa",typeFullName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa",librairie:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa"},this.obligatoires={action:MyWay.Services.Impression.GENERATION_IMPRESSION_ACTION.getFichier,nomFichier:"OrdreVirementPermSepa.pdf",parametresGenerationFichier:{typeFichier:MyWay.Services.Fichier.TYPE_FICHIER.PDFA_1B,restitutionVersion:MyWay.Services.Impression.RESTITUTION_VERSION.V180,sousRepModele:"05-depots-srv/echean_doc"}},this.optionnels={}}return e}();e.OrdreVirementPermSepaImpressionParams=r;var a=function(){function e(e){this.systeme={typeName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa",typeFullName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa",librairie:"05-DEPOTS-SRV_ECHEAN_OrdreVirementPermSepa"},this.obligatoires={action:MyWay.Services.Impression.GENERATION_IMPRESSION_ACTION.archiverAndGetFichier,nomFichier:"OrdreVirementPermSepa.pdf",parametresGenerationFichier:{typeFichier:MyWay.Services.Fichier.TYPE_FICHIER.PDFA_1B,restitutionVersion:MyWay.Services.Impression.RESTITUTION_VERSION.V180,sousRepModele:"05-depots-srv/echean_doc"}};var i={annul:!0,enregistrer:!0,voir:!0,maxcop:1,mincop:1,nbcopiesdef:1};e?this.optionnels={parametreActiveX:i,archivage:{aQstnCreerDoc:{donnCntx:{codeEtablissement:e.codeEtablissement,idntCmpstApplf:e.idntCmpstApplf},document:{proprietesDoc:{codeTypeNatrDoc:e.codeTypeNatrDoc,codeTypeAttrb:e.codeTypeAttrb,idntAttrb:e.idntAttrb,dateDeliv:e.dateDeliv?e.dateDeliv:new Date,dateNumr:e.dateNumr?e.dateNumr:new Date,inttAttr:e.inttAttr,codeTypeStck:e.codeTypeStck?e.codeTypeStck:"L",datePerm:moment().add(60,"day").toDate()},fichierDoc:{nomFich:"OrdreVirementPermSepa.pdf"}}}}}:this.optionnels={parametreActiveX:i}}return e}();e.OrdreVirementPermSepaArchiverImpressionParams=a}(i=e.impression||(e.impression={}))}(i=e.comEcheancier||(e.comEcheancier={}))}(myway||(myway={}));var myway;!function(e){var i;!function(i){var t;!function(i){function t(t){console.log("createUnitDocument.entree",[t]);var r=new i.OrdreVirementUnitSepa;if(r.Nomdemandeur_1=t.nomDemandeur?t.nomDemandeur:"",r.BicIban_1=t.bicDonneurOrdre&&t.ibanDonneurOrdre?t.bicDonneurOrdre+" "+n(t.ibanDonneurOrdre):"",r.Montant_1=t.montant&&t.montant.montant?t.montant.montant.toFixed(2)+" ":"",t.montant&&("EUR"===t.montant.devise.code&&t.montant.montant>1?r.Montant_1+="Euros":r.Montant_1+=t.montant.devise.libelle),r.DateDeCreation=t.dateCreation?moment(t.dateCreation).format("DD/MM/YYYY"):"",r.DateDerniereModification=t.dateModificationDossier?moment(t.dateModificationDossier).format("DD/MM/YYYY"):"",r.DateCreaVir=t.dateDebut?moment(t.dateDebut).format("DD/MM/YYYY"):"",r.Motif_1=t.libelle?t.libelle:"",r.CodeEco_2=t.codeEconomique?t.codeEconomique:"",r.IdentDO_1=t.identifiantDonneurOrdre?t.identifiantDonneurOrdre:"",r.RefDO_1=t.referenceDonneurOrdre?t.referenceDonneurOrdre:"",r.NomBen_1=t.nomBeneficiaire?t.nomBeneficiaire:"",r.AdrsBen1_1=t.adresseBeneficiaire?t.adresseBeneficiaire:"",r.PaysResidBen_2=t.paysBeneficiaire?t.paysBeneficiaire:"",r.AdrsBen2=t.complementAdresseBeneficiaire?t.complementAdresseBeneficiaire:t.cPVilleBeneficiaire?t.cPVilleBeneficiaire:"",r.AdrsBen3=t.complementAdresseBeneficiaire?t.cPVilleBeneficiaire:"",r.BicBen_1=t.bicBeneficiaire?t.bicBeneficiaire:"",r.IbanBen_1=t.ibanBeneficiaire?t.ibanBeneficiaire:"",r.BqueBen_1=t.banqueBeneficiaire?t.banqueBeneficiaire:"",r.PaysBque=t.paysBanqueBeneficiaire?t.paysBanqueBeneficiaire:"",r.IdentBen_1=t.identifiantBeneficiaire?t.identifiantBeneficiaire:"",r.NomDOInit_1=t.nomDesignationDonneurOrdreInitial?t.nomDesignationDonneurOrdreInitial:"",r.IdentDOInit_1=t.identifiantDonneurOrdreInitial?t.identifiantDonneurOrdreInitial:"",r.NomBenFin_1=t.nomDesignationBeneficiaireFinal?t.nomDesignationBeneficiaireFinal:"",r.IdentBenFin_1=t.identifiantBeneficiaireFinal?t.identifiantBeneficiaireFinal:"",r.NatPaie_1=t.naturePaiement?t.naturePaiement:"",r.CatPaie_1=t.categoriePaiement?t.categoriePaiement:"",t.nom){var a=r.SignatureSepa2={};t.qualite&&(a.QUALITE_SIGNATAIRE=t.qualite),t.nom&&(a.LIDANM=t.nom),t.prenom&&(a.LIDAPP=t.prenom),a.REF_IDENTITE=t.referenceIdentite?t.referenceIdentite:"",a.NomAgent=t.nomAgent?t.nomAgent:""}else{var o=r.SignatureSepa={};o.NomAgent=t.nomAgent?t.nomAgent:""}var s={};s._attribute_Content=MyWay.Services.Impression.TYPE_IMAGE.Id,s._value_=t.enteteEds.codeEtablissement?t.enteteEds.codeEtablissement+".jpg":"",r.Logo=s,r.DesignationEDS=t.enteteEds.libelleEDS?t.enteteEds.libelleEDS:"";var c,m=t.libelleEtablissement.articleMajusculeLaLe;switch(c=t.nomPrenomParticipant?t.nomPrenomParticipant:r.Nomdemandeur_1.trim(),console.log("createUnitDocument.sousigne",[c]),t.contenu.typeEdition){case e.comEcheancier.impression.TypeDocumentImpression.Creation:case e.comEcheancier.impression.TypeDocumentImpression.Duplicata:r.type_edition="ORDRE DE VIREMENT",t.dateCreation&&(r.DateDeCreation=moment(t.dateCreation).format("DD/MM/YYYY")),t.dateModificationDossier&&(r.DateDerniereModification=moment(t.dateModificationDossier).format("DD/MM/YYYY")),r.PaveSoussigné="Je soussigné(e) "+c+", agissant en qualité d’ayant droit,  prie "+m+" d’effectuer la modification du virement référencé ci-dessous :";break;case e.comEcheancier.impression.TypeDocumentImpression.Modification:r.type_edition="MODIFICATION ORDRE DE VIREMENT",r.PaveSoussigné="Je soussigné(e) "+c+", agissant en qualité d’ayant droit,  prie "+m+" d’effectuer la modification du virement référencé ci-dessous :",t.dateCreation&&(r.DateDeCreation=moment(t.dateCreation).format("DD/MM/YYYY")),t.dateModificationDossier&&(r.DateDerniereModification=moment(t.dateModificationDossier).format("DD/MM/YYYY"));break;case e.comEcheancier.impression.TypeDocumentImpression.Reactivation:r.type_edition="AVENANT CONTRAT",t.contenu.decideurClient?r.PaveSoussigné="Je soussigné(e), "+c+" demande la réactivation  de l’échéancier de virement suivant les caractéristiques : ":r.PaveSoussigné="Demande de Réactivation d’un échéancier de virement SEPA faite par "+t.nomAgent.trim()+", "+t.libelleEtablissement.etablissementLibelleLong+" et suivant les caractéristiques ci-dessous:",t.contenu.dateReactivation&&(r.PaveSoussigneSpecifique={},r.PaveSoussigneSpecifique.PaveSoussigneSpecifique="Date de réactivation de l’échéancier :"+moment(t.contenu.dateReactivation).format("DD/MM/YYYY")),t.contenu.motifChangement&&(r.PaveSoussigneSpecifique2={},r.PaveSoussigneSpecifique2.PaveSoussigneSpecifique2="Motif de la réactivation : "+t.contenu.motifChangement);break;case e.comEcheancier.impression.TypeDocumentImpression.Suspension:r.type_edition="AVENANT CONTRAT",t.contenu.decideurClient?r.PaveSoussigné="Demande de suspension d’un échéancier de virement SEPA faite par "+c+" et suivant les caractéristiques ci-dessous:":r.PaveSoussigné="Demande de suspension d’un échéancier de virement SEPA faite par "+t.nomAgent.trim()+", "+t.libelleEtablissement.etablissementLibelleLong+" et suivant les caractéristiques ci-dessous:",t.contenu.dateActivation&&(r.PaveSoussigneSpecifique={},
r.PaveSoussigneSpecifique.PaveSoussigneSpecifique="Date d’activation de la suspension de l’échéancier: "+moment(t.contenu.dateActivation).format("DD/MM/YYYY")),t.contenu.dateReactivation&&(r.PaveSoussigneSpecifique2={},r.PaveSoussigneSpecifique2.PaveSoussigneSpecifique2="Date de réactivation de l’échéancier :"+moment(t.contenu.dateReactivation).format("DD/MM/YYYY")),t.contenu.motifChangement&&(r.PaveSoussigneSpecifique3={},r.PaveSoussigneSpecifique3.PaveSoussigneSpecifique3="Motif de la suspension : "+t.contenu.motifChangement);break;case e.comEcheancier.impression.TypeDocumentImpression.DoubleValidation:r.type_edition="Avis d'operation pour dossier d'échéancier de virement SEPA",r.PaveSoussigné="Double validation du dossier :",r.PaveSoussigneSpecifique={},r.PaveSoussigneSpecifique.PaveSoussigneSpecifique="Validée par "+t.nomAgent+"  le "+moment(new Date).format("DD/MM/YYYY")+".";break;case e.comEcheancier.impression.TypeDocumentImpression.Cloture:t.contenu.decideurClient?r.type_edition="REVOCATION ORDRE DE VIREMENT":r.type_edition="REFUS D’EXECUTION",r.PaveSoussigné="Je soussigné(e) "+c+", agissant en qualité d’ayant droit,  prie "+m+" d’effectuer la modification du virement référencé ci-dessous :",t.contenu.motifChangement&&(r.PaveSoussigneSpecifique={},r.PaveSoussigneSpecifique.PaveSoussigneSpecifique="Motif de la clôture : "+t.contenu.motifChangement);break;default:r.type_edition="CONTRAT"}r.AdresseEDS=t.enteteEds.adresse?t.enteteEds.adresse:"",r.Ligne6AdrsAfnr=t.enteteEds.cPVille?t.enteteEds.cPVille:"",r.NumrTelpEDS=t.enteteEds.numeroTelephone?t.enteteEds.numeroTelephone:"",r.RefDossier_1=t.contenu.refDossier?t.contenu.refDossier:"",r.Date_2=moment(new Date).format("DD/MM/YYYY HH:mm:ss");var d={};return d.MentionsLegales=t.mentionsLegales?t.mentionsLegales:"",r.MentionsLegales=d,r}function n(e){var i="",t=0;if(e){for(;24>t;)i+=e.substr(t,4)+" ",t+=4;return 24===t&&(i+=e.substr(t,3)+" ",t+=3),27===t&&(i+=e.substr(t)),i}}i.createUnitDocument=t,i.miseEnFormeIban=n}(t=i.impression||(i.impression={}))}(i=e.comEcheancier||(e.comEcheancier={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){var i;!function(e){var i=function(){function e(){this._attribute_id="OrdreVirementUnitSepa.docx",this._attribute_xmlns="http://comEcheancier_05-DEPOTS-SRV_ECHEAN_05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa.xsd"}return e}();e.OrdreVirementUnitSepa=i;var t=function(){function e(e){this.systeme={typeName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa",typeFullName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa",librairie:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa"},this.obligatoires={action:MyWay.Services.Impression.GENERATION_ACTION.archiverAndGetFichier,parametresGenerationFichier:{typeFichier:MyWay.Services.Fichier.TYPE_FICHIER.PDFA_1B,restitutionVersion:MyWay.Services.Impression.RESTITUTION_VERSION.V180,sousRepModele:"05-depots-srv/echean_doc"}},e&&(this.optionnels={nomFichier:"OrdreVirementUnitSepa.pdf",archivage:{aQstnCreerDoc:{donnCntx:{codeEtablissement:e.codeEtablissement,idntCmpstApplf:e.idntCmpstApplf},document:{proprietesDoc:{codeTypeNatrDoc:e.codeTypeNatrDoc,codeTypeAttrb:e.codeTypeAttrb,idntAttrb:e.idntAttrb,dateDeliv:e.dateDeliv?e.dateDeliv:new Date,dateNumr:e.dateNumr?e.dateNumr:new Date,inttAttr:e.inttAttr,codeTypeStck:e.codeTypeStck?e.codeTypeStck:"L"},fichierDoc:{nomFich:"OrdreVirementUnitSepa.pdf"}}}}})}return e}();e.OrdreVirementUnitSepaArchiverParams=t;var n=function(){function e(){this.systeme={typeName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa",typeFullName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa",librairie:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa"},this.obligatoires={action:MyWay.Services.Impression.GENERATION_ACTION.getFichier,parametresGenerationFichier:{typeFichier:MyWay.Services.Fichier.TYPE_FICHIER.PDFA_1B,restitutionVersion:MyWay.Services.Impression.RESTITUTION_VERSION.V180,sousRepModele:"05-depots-srv/echean_doc"}},this.optionnels={nomFichier:"OrdreVirementUnitSepa.pdf"}}return e}();e.OrdreVirementUnitSepaGenererParams=n;var r=function(){function e(){this.systeme={typeName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa",typeFullName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa",librairie:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa"},this.obligatoires={action:MyWay.Services.Impression.GENERATION_IMPRESSION_ACTION.archiverAndGetFichier,nomFichier:"OrdreVirementUnitSepa.pdf",parametresGenerationFichier:{typeFichier:MyWay.Services.Fichier.TYPE_FICHIER.PDFA_1B,restitutionVersion:MyWay.Services.Impression.RESTITUTION_VERSION.V180,sousRepModele:"05-depots-srv/echean_doc"}},this.optionnels={parametreActiveX:{annul:!1,enregistrer:!1,voir:!1,maxcop:2,mincop:1,nbcopiesdef:1}}}return e}();e.OrdreVirementUnitSepaImpressionParams=r;var a=function(){function e(e){this.systeme={typeName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa",typeFullName:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa",librairie:"05-DEPOTS-SRV_ECHEAN_OrdreVirementUnitSepa"},this.obligatoires={action:MyWay.Services.Impression.GENERATION_IMPRESSION_ACTION.archiverAndGetFichier,nomFichier:"OrdreVirementUnitSepa.pdf",parametresGenerationFichier:{typeFichier:MyWay.Services.Fichier.TYPE_FICHIER.PDFA_1B,restitutionVersion:MyWay.Services.Impression.RESTITUTION_VERSION.V180,sousRepModele:"05-depots-srv/echean_doc"}},e&&(this.optionnels={parametreActiveX:{annul:!1,enregistrer:!1,voir:!1,maxcop:2,mincop:1,nbcopiesdef:1},archivage:{aQstnCreerDoc:{donnCntx:{codeEtablissement:e.codeEtablissement,idntCmpstApplf:e.idntCmpstApplf},document:{proprietesDoc:{codeTypeNatrDoc:e.codeTypeNatrDoc,codeTypeAttrb:e.codeTypeAttrb,idntAttrb:e.idntAttrb,dateDeliv:e.dateDeliv?e.dateDeliv:new Date,dateNumr:e.dateNumr?e.dateNumr:new Date,inttAttr:e.inttAttr,codeTypeStck:e.codeTypeStck?e.codeTypeStck:"L"},fichierDoc:{nomFich:"OrdreVirementUnitSepa.pdf"}}}}})}return e}();e.OrdreVirementUnitSepaArchiverImpressionParams=a}(i=e.impression||(e.impression={}))}(i=e.comEcheancier||(e.comEcheancier={}))}(myway||(myway={}));var MyWay;!function(e){var i;!function(e){"use strict"}(i=e.Model||(e.Model={}))}(MyWay||(MyWay={}));var myway;!function(e){var i;!function(e){var i;!function(e){!function(e){e[e.Creation=0]="Creation",e[e.Suspension=1]="Suspension",e[e.Cloture=2]="Cloture",e[e.Modification=3]="Modification",e[e.Reactivation=4]="Reactivation",e[e.DoubleValidation=5]="DoubleValidation",e[e.Duplicata=6]="Duplicata"}(e.TypeDocumentImpression||(e.TypeDocumentImpression={}));var i=(e.TypeDocumentImpression,function(){function e(){}return e.CODE_ETABLISSEMENT_CREDIT_FONCIER="43199",e.LIBELLE_ETABLISSEMENT_CREDIT_FONCIER="le CREDIT FONCIER",e.LIBELLE_ETABLISSEMENT_BCP="la BANQUE BCP",e.CODE_ETABLISSEMENT_BCP="12579",e.LIBELLE_ETABLISSEMENT_CAISSE_EPARGNE="la CAISSE D'EPARGNE",e}());e.Banques=i}(i=e.impression||(e.impression={}))}(i=e.comEcheancier||(e.comEcheancier={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){var i;!function(e){var i=function(){function e(){}return e}();e.ArchivageEcheancier=i;var t=function(){function e(){}return e}();e.DonneesEcheancierPourImpression=t;var n=function(){function e(){}return e}();e.ParametreEcheancierPourImpression=n;var r=function(){function e(){}return e}();e.InfoEds=r;var a=function(){function e(){}return e}();e.EcheancierFromRessource=a;var o=function(){function e(){}return e}();e.PersonneRg1=o}(i=e.impression||(e.impression={}))}(i=e.comEcheancier||(e.comEcheancier={}))}(myway||(myway={}));var MyWay;!function(e){var i;!function(e){var i=function(){function e(e,i,t,n){this.key=e?e:"",this.value=i?i:"",this.seuil=t?t:null,this.plafond=n?n:null}return e}();e.Periodicite=i;var t=function(){function e(e,i,t,n,r,a,o,s,c,m){this.periodicites=e?e:[],this.codePeriodiciteParDefaut=i?i:"",this.parametreListeCompte=r?r:null,this.cacherCompteVirement=n?n:null,this.riceVirement=t?t:null,this.ricePrelevement=a?a:null,this.cacherComptePrelevement=o?o:null,this.codeDevise=s,this.afficheRice=c,this.dateMin=m?m:new Date}return e}();e.ParametreVersementPeriodique=t;var n=function(){function e(){this.$valid=!1}return e}();e.VersementPeriodique=n}(i=e.Model||(e.Model={}))}(MyWay||(MyWay={}));var myway;!function(e){var i;!function(e){var i=function(){function e(e,i,t,n){var r=this;this.$scope=e,this.versementPeriodiqueService=i,this.serviceAgentExtended=t,this.saisieRiceService=n,angular.isUndefined(this.parametre.afficheRice)&&(this.parametre.afficheRice=this.parametre.parametreListeCompte?!1:!0),this.versementPeriodique||(this.versementPeriodique=new MyWay.Model.VersementPeriodique),e.$watch(function(){return r.parametre},function(e,i){e&&r.initIHM()}),e.$watch(function(){return r.versementPeriodique.ricePrelevement.radical&&r.versementPeriodique.ricePrelevement.cleCompte&&r.versementPeriodique.ricePrelevement.codeActiviteCompte&&r.versementPeriodique.ricePrelevement.cleRice},function(e,i){e&&r.calculeCleRiceIbanBic()}),e.$watch(function(){return r.versementPeriodique},function(e,i){e&&(r.versementPeriodique.$valid=r.isValid())},!0)}return e.prototype.isDefinedAndNotNull=function(e){return angular.isDefined(e)&&null!==e},e.prototype.isValid=function(){return this.isDefinedAndNotNull(this.versementPeriodique)&&this.isDefinedAndNotNull(this.versementPeriodique.montant)&&!this.isDefinedAndNotNull(this.versementPeriodique.montant.montant)?!0:this.parametre.afficheRice?this.isDefinedAndNotNull(this.versementPeriodique)&&this.isDefinedAndNotNull(this.versementPeriodique.ricePrelevement)&&this.isDefinedAndNotNull(this.versementPeriodique.ricePrelevement.radical)&&this.isDefinedAndNotNull(this.versementPeriodique.periodicite)&&this.isDefinedAndNotNull(this.versementPeriodique.montant)&&this.isDefinedAndNotNull(this.versementPeriodique.montant.montant)&&this.isDefinedAndNotNull(this.versementPeriodique.libelle)&&""!==this.versementPeriodique.libelle.trim()&&this.isDefinedAndNotNull(this.versementPeriodique.dateDebut)&&this.isDefinedAndNotNull(this.versementPeriodique.dateFin)&&(moment(this.versementPeriodique.dateDebut).isBefore(this.versementPeriodique.dateFin)||moment(this.versementPeriodique.dateDebut).isSame(this.versementPeriodique.dateFin)):this.isDefinedAndNotNull(this.versementPeriodique)&&this.isDefinedAndNotNull(this.versementPeriodique.comptePrelevement)&&this.isDefinedAndNotNull(this.versementPeriodique.periodicite)&&this.isDefinedAndNotNull(this.versementPeriodique.montant)&&this.isDefinedAndNotNull(this.versementPeriodique.montant.montant)&&this.isDefinedAndNotNull(this.versementPeriodique.libelle)&&""!==this.versementPeriodique.libelle.trim()&&this.isDefinedAndNotNull(this.versementPeriodique.dateDebut)&&this.isDefinedAndNotNull(this.versementPeriodique.dateFin)&&(moment(this.versementPeriodique.dateDebut).isBefore(this.versementPeriodique.dateFin)||moment(this.versementPeriodique.dateDebut).isSame(this.versementPeriodique.dateFin))},e.prototype.changePeriodicite=function(){this.versementPeriodique.periodicite?(this.initDateDebutEtLibelleEnFonctionPeriodicite(),this.versementPeriodique.dateFin||(this.versementPeriodique.dateFin="U"===this.versementPeriodique.periodicite.key?moment("0001-01-01T00:00:00.000Z").toDate():new Date("9999-12-31"))):(this.versementPeriodique.libelle="Virement périodique",this.versementPeriodique.dateDebut=null,this.versementPeriodique.dateFin=null)},e.prototype.changeDateDebut=function(){this.versementPeriodique.dateDebut&&this.versementPeriodique.dateFin&&this.versementPeriodique.dateDebut>this.versementPeriodique.dateFin&&!moment("0001-01-01T00:00:00.000Z").isSame(this.versementPeriodique.dateFin)&&(this.versementPeriodique.dateFin=this.versementPeriodique.dateDebut)},e.prototype.onSelectComptePrelevement=function(){this.versementPeriodique.ricePrelevement=new MyWay.Model.Rice(this.versementPeriodique.comptePrelevement.riceContrat.substr(0,5),this.versementPeriodique.comptePrelevement.riceContrat.substr(5,5)),this.versementPeriodique.ricePrelevement.codeActiviteCompte=this.versementPeriodique.comptePrelevement.riceContrat.substr(10,2),this.versementPeriodique.ricePrelevement.radical=this.versementPeriodique.comptePrelevement.riceContrat.substr(12,7),this.versementPeriodique.ricePrelevement.cleCompte=this.versementPeriodique.comptePrelevement.riceContrat.substr(19,2),this.versementPeriodique.ricePrelevement.cleRice=this.saisieRiceService.riceKeyCalculator(this.versementPeriodique.ricePrelevement)},e.prototype.calculeCleRiceIbanBic=function(){var e=this;this.versementPeriodique&&(this.versementPeriodique.riceVirement&&(this.versementPeriodique.riceVirement.cleRice||(this.versementPeriodique.riceVirement.cleRice=this.saisieRiceService.riceKeyCalculator(this.versementPeriodique.riceVirement)),this.versementPeriodique.riceVirement.isComplete()&&this.versementPeriodique.riceVirement.$valid&&this.versementPeriodiqueService.getBicIban(this.versementPeriodique.riceVirement).then(function(i){i&&(e.versementPeriodique.bicVirement=i.codeBic,e.versementPeriodique.ibanVirement=i.numeroIbanCompteBeneficiaire)})),this.versementPeriodique.ricePrelevement&&(this.versementPeriodique.ricePrelevement.cleRice||(this.versementPeriodique.ricePrelevement.codeEtablissement&&this.versementPeriodique.ricePrelevement.codeGuichet&&this.versementPeriodique.ricePrelevement.codeActiviteCompte&&this.versementPeriodique.ricePrelevement.radical&&(this.versementPeriodique.ricePrelevement=this.saisieRiceService.formatteRICE(this.versementPeriodique.ricePrelevement.codeEtablissement,this.versementPeriodique.ricePrelevement.codeGuichet.value,this.versementPeriodique.ricePrelevement.codeActiviteCompte+this.versementPeriodique.ricePrelevement.radical,this.versementPeriodique.ricePrelevement.cleCompte)),this.versementPeriodique.ricePrelevement.$valid=!0),this.versementPeriodique.ricePrelevement.isComplete()&&this.versementPeriodique.ricePrelevement.$valid&&this.versementPeriodiqueService.getBicIban(this.versementPeriodique.ricePrelevement).then(function(i){i&&(e.versementPeriodique.bicPrelevement=i.codeBic,e.versementPeriodique.ibanPrelevement=i.numeroIbanCompteBeneficiaire)})))},e.prototype.initIHM=function(){var e=this;this.parametre&&(this.parametre.ricePrelevement?this.versementPeriodique.ricePrelevement=this.parametre.ricePrelevement:(this.versementPeriodique.ricePrelevement=new MyWay.Model.Rice,this.versementPeriodiqueService.getCurrentCOCXBQ().then(function(i){e.versementPeriodique.ricePrelevement.codeEtablissement=i})),this.versementPeriodique.riceVirement=this.parametre.riceVirement,this.calculeCleRiceIbanBic(),this.parametre.ricePrelevement&&this.versementPeriodique.ricePrelevement.isComplete()&&this.versementPeriodique.ricePrelevement.$valid&&this.versementPeriodiqueService.getBicIban(this.versementPeriodique.ricePrelevement).then(function(i){i&&(e.versementPeriodique.bicPrelevement=i.codeBic,e.versementPeriodique.ibanPrelevement=i.numeroIbanCompteBeneficiaire)})),this.minDate=this.parametre&&this.parametre.dateMin?this.parametre.dateMin:new Date,this.periodicites=[],this.versementPeriodique.montant||(this.versementPeriodique.montant=new MyWay.Model.MontantDevise,this.versementPeriodique.montant.codeDevise=this.parametre.codeDevise?this.parametre.codeDevise:"EUR"),this.parametre.parametreListeCompte&&this.parametre.codeDevise&&!this.parametre.parametreListeCompte.codeDevise&&(this.parametre.parametreListeCompte.codeDevise=this.parametre.codeDevise),this.versementPeriodique.libelle||(this.versementPeriodique.libelle="Virement périodique"),this.versementPeriodiqueService.getPeriodicites(this.parametre).then(function(i){if(e.periodicites=i,e.parametre&&e.parametre.codePeriodiciteParDefaut){var t=e.periodicites.filter(function(i){return i.key===e.parametre.codePeriodiciteParDefaut});t&&t.length>0&&(e.versementPeriodique.periodicite=t[0])}})},e.prototype.initDateDebutEtLibelleEnFonctionPeriodicite=function(){switch(this.versementPeriodique.periodicite.key){case"H":this.versementPeriodique.dateDebut=moment.utc().add("weeks",1).toDate(),this.versementPeriodique.libelle="Virement hebdomadaire";break;case"Q":this.versementPeriodique.dateDebut=moment.utc().add("weeks",2).toDate(),this.versementPeriodique.libelle="Virement quinzaine";break;case"M":this.versementPeriodique.dateDebut=moment.utc().add("months",1).toDate(),this.versementPeriodique.libelle="Virement mensuel";break;case"B":this.versementPeriodique.dateDebut=moment.utc().add("months",2).toDate(),this.versementPeriodique.libelle="Virement bimestriel";break;case"T":this.versementPeriodique.dateDebut=moment.utc().add("months",3).toDate(),this.versementPeriodique.libelle="Virement trimestriel";break;case"S":this.versementPeriodique.dateDebut=moment.utc().add("months",6).toDate(),this.versementPeriodique.libelle="Virement semestriel";break;case"A":this.versementPeriodique.dateDebut=moment.utc().add("years",1).toDate(),this.versementPeriodique.libelle="Virement annuel";break;case"U":this.versementPeriodique.dateDebut=moment.utc().toDate(),this.versementPeriodique.libelle="Virement unique"}},e.prototype.clickSwitchListeComptesRice=function(){this.versementPeriodique.ricePrelevement=new MyWay.Model.Rice(this.versementPeriodique.ricePrelevement.codeEtablissement,this.versementPeriodique.ricePrelevement.codeGuichet),this.versementPeriodique.comptePrelevement=null,this.versementPeriodique.ibanPrelevement=null,this.versementPeriodique.bicPrelevement=null,this.parametre.afficheRice=!this.parametre.afficheRice},e.$inject=["$scope","versementPeriodiqueService","serviceAgentExtended","saisieRiceService"],e}();e.VersementPeriodiqueController=i,e.app.controller("VersementPeriodiqueController",i)}(i=e.comEcheancier||(e.comEcheancier={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){function i(){return{restrict:"E",templateUrl:"typescript/versement-periodique/versement-periodique-view.html",scope:{readOnly:"=readOnly",versementPeriodique:"=ngModel",parametre:"=parametre",required:"=required"},controller:"VersementPeriodiqueController",controllerAs:"ctrl",bindToController:!0,link:function(e,i,t){if(!("ngModel"in t))throw new Error('ng-model est un paramètre obligatoire.   ==>  < mwsf-versement-periodique ng-model="myObject" > \n');if(!("parametre"in t))throw new Error('parametre est un paramètre obligatoire.   ==>  < mwsf-versement-periodique parametre="myObject" > \n')}}}e.mwsfVersementPeriodique=i,e.app.directive("mwsfVersementPeriodique",i)}(i=e.comEcheancier||(e.comEcheancier={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){var i=function(){function e(e,i){this.serviceAgentExtended=e,this.$q=i}return e.prototype.getBicIban=function(i){if(!i||i&&!i.codeEtablissement&&!i.radical){var t=this.$q.defer();return t.reject(!1),t.promise}var n="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083",r=n+"/"+e.OPE_FI_VERSION+"conversionRibBicIban";return r+="?codeEtablissement="+i.codeEtablissement,r+="&codeGuichet="+i.getGuichet(),r+="&numeroCompte="+i.formatRICEPourCompte(),r+="&cleRib="+i.cleRice,this.serviceAgentExtended.sendRequest({url:r,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){return e})},e.prototype.getCurrentCOCXBQ=function(){return this.serviceAgentExtended.getAuthentificationInfo().then(function(e){try{return e.codeEtablissement}catch(i){throw"impossible de récupérer les données depuis le context"}})},e.prototype.getPeriodicites=function(e){var i=this,t=[];return this.serviceAgentExtended.getAuthentificationInfo().then(function(n){return i.serviceAgentExtended.getDonneesDelocalisees(n.codeEtablissement,"PTNEEC").then(function(i){return i?(i.donnees.forEach(function(i){var n=new MyWay.Model.Periodicite(i.Key,i.Value);if(e&&e.periodicites&&e.periodicites.length>0){var r=e&&e.periodicites?e.periodicites.filter(function(e){return e.key===i.Key}):[];r&&1===r.length&&(n.plafond=r[0].plafond,n.seuil=r[0].seuil,t.push(n))}else t.push(n)}),t):void 0})})},e.OPE_FI_VERSION="operationfinanciereservice-v1/",e.$inject=["serviceAgentExtended","$q"],e}();e.VersementPeriodiqueService=i,e.app.service("versementPeriodiqueService",i)}(i=e.comEcheancier||(e.comEcheancier={}))}(myway||(myway={})),angular.module("myway.comEcheancier").run(["$templateCache",function(e){e.put("typescript/versement-periodique/versement-periodique-view.html",'\r\n<data-ng-form class="form-horizontal col-md-12" role="form" novalidate>\r\n    <div ng-show="!ctrl.readOnly">\r\n        <div class="form-group" ng-show="!ctrl.parametre.cacherComptePrelevement">\r\n\r\n            <!--<label class ="col-sm-4 col-md-4 col-lg-4 control-label"  for="mode-financier-id-virement-interne">\r\n                    Mode financier\r\n                    </label>\r\n                    <div class ="center-verticaly-recap col-sm-8 col-md-8 col-lg-8">\r\n                        <label ng-bind ="recapCtrl.modeFinancier"  id="mode-financier-id-virement-interne"></label>\r\n            </div>-->\r\n\r\n            <label class="col-sm-3 col-md-4 col-lg-3 control-label" for="liste-compte" ng-show="!ctrl.parametre.afficheRice && ctrl.parametre.parametreListeCompte" data-ng-class="{ \'has-error\' :  ctrl.required && !ctrl.versementPeriodique.comptePrelevement , \'has-success\': ctrl.versementPeriodique.comptePrelevement }">Compte à débiter</label>\r\n\r\n            <label class="col-sm-3 col-md-4 col-lg-3 control-label" for="rice" ng-show="ctrl.parametre.afficheRice || !ctrl.parametre.parametreListeCompte && ctrl.parametre.ricePrelevement">Compte à débiter</label>\r\n\r\n            <div class="col-sm-9 col-md-8 col-lg-9">\r\n                <div class="padding-left" ng-show="!ctrl.parametre.afficheRice && ctrl.parametre.parametreListeCompte">\r\n                    <mwsf-liste-compte compte-selectionne="ctrl.versementPeriodique.comptePrelevement" id="liste-compte" on-select="ctrl.onSelectComptePrelevement()" parametres="ctrl.parametre.parametreListeCompte">\r\n                    </mwsf-liste-compte>\r\n                </div>\r\n                <div class="padding-left-zero-quatre" ng-if="ctrl.parametre.afficheRice || !ctrl.parametre.parametreListeCompte && ctrl.parametre.ricePrelevement">\r\n                    <mwsf-saisie-rice data-ng-model="ctrl.versementPeriodique.ricePrelevement" data-read-only="false" data-mode-appel="Guichet" required="" id="rice"></mwsf-saisie-rice>\r\n                </div>\r\n                <!--<span class="col-sm-1 col-md-1 col-lg-1" ng-if="ctrl.parametre.parametreListeCompte" data-ng-class="{ \'has-error\' :  ctrl.required && !ctrl.versementPeriodique.comptePrelevement , \'has-success\': ctrl.versementPeriodique.comptePrelevement }">\r\n                    <mw-button class=" boutonSaisirCompte" texte="{{ctrl.parametre.afficheRice ? \'Afficher la liste\' :\'Saisir compte\'}}" modele="zone" ng-click="ctrl.clickSwitchListeComptesRice();" id="idBtnRice"></mw-button>\r\n                </span>-->\r\n            </div>\r\n        </div>\r\n        <div class="form-group" ng-show="!ctrl.parametre.cacherCompteVirement">\r\n            <!--<div class="col-sm-12 col-md-12 col-lg-12" ng-if="ctrl.parametre.parametreListeCompte" data-ng-class="{ \'has-error\' :  ctrl.required && !ctrl.versementPeriodique.comptePrelevement , \'has-success\': ctrl.versementPeriodique.comptePrelevement }">\r\n                <label class="control-label">Compte à créditer</label>\r\n                <mwsf-liste-compte compte-selectionne="ctrl.versementPeriodique.comptePrelevement"\r\n                                   parametres="ctrl.parametre.parametreListeCompte">\r\n                </mwsf-liste-compte>\r\n            </div>-->\r\n            <label class="control-label col-sm-3 col-md-4 col-lg-3" ng-show="ctrl.parametre.riceVirement" for="rice-a-crediter">Compte à créditer</label>\r\n\r\n            <div class="col-sm-9 col-md-8 col-lg-9 rice-lecture-mode-edition" ng-if="ctrl.parametre.riceVirement">\r\n                <mwsf-saisie-rice data-ng-model="ctrl.versementPeriodique.riceVirement" data-read-only="true" data-mode-appel="Guichet" id="rice-a-crediter"></mwsf-saisie-rice>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="col-sm-3 col-md-4 col-lg-3 control-label" for="periodicite">Périodicité</label>\r\n            <div class="col-sm-5 col-md-5 col-lg-6" data-ng-class="{ \'has-error\' :  ctrl.required && !ctrl.versementPeriodique.periodicite}">\r\n                <ui-select id="periodicite" data-ng-model="ctrl.versementPeriodique.periodicite" class="help-block" ng-required="ctrl.required" ng-change="ctrl.changePeriodicite()">\r\n                    <ui-select-match placeholder="Sélectionnez une périodicité" allow-clear="true">{{$select.selected.value}}</ui-select-match>\r\n                    <ui-select-choices repeat="perio in ctrl.periodicites | filter: $select.search">{{perio.value}}</ui-select-choices>\r\n                </ui-select>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="col-sm-3 col-md-4 col-lg-3 control-label" for="montant">Montant</label>\r\n            <div class="col-sm-4 col-md-4 col-lg-5">\r\n                <mwsf-saisie-montant-devise value="ctrl.versementPeriodique.montant" id="montant" required="{{ctrl.required}}" force-positive="true" min="ctrl.versementPeriodique.periodicite.seuil" max="ctrl.versementPeriodique.periodicite.plafond">\r\n                </mwsf-saisie-montant-devise>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="col-sm-3 col-md-4 col-lg-3 control-label" for="libelle">Libellé</label>\r\n            <div class="col-sm-9 col-md-8 col-lg-9" data-ng-class="{ \'has-error\' :  ctrl.required && !ctrl.versementPeriodique.libelle }">\r\n                <input type="text" name="input" class="form-control" maxlength="35" id="libelle" data-ng-model="ctrl.versementPeriodique.libelle" ng-required="ctrl.required" autocomplete="off">\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label col-sm-3 col-md-4 col-lg-3" for="date-debut">Date de début</label>\r\n            <div class="col-sm-4 col-md-4 col-lg-4 has-feedback" data-ng-class="{ \'has-error\' :  ctrl.required && !ctrl.versementPeriodique.dateDebut}">\r\n\r\n                <input type="text" class="form-control" id="date-debut" name="dateDebut" ng-model="ctrl.versementPeriodique.dateDebut" mw-date-legere ng-required="ctrl.required" uib-datepicker-popup="dd/MM/yyyy" is-open="ctrl.openedDate1" datepicker-options="{ showWeeks: false, startingDay:1}" placeholder="jj/mm/aaaa" min-date="ctrl.minDate" ng-change="ctrl.changeDateDebut()">\r\n                <span class="btn btn-success form-control-feedback">\r\n                    <mw-button-icone texte="Calendrier" taille="sm" icone="icone itce-calendar icodate" id="buttndatedebut" ng-click="ctrl.openedDate1 = true"></mw-button-icone>\r\n                </span>\r\n\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label col-sm-3 col-md-4 col-lg-3" for="date-fin">Date de fin</label>\r\n            <div class="col-sm-4 col-md-4 col-lg-4 has-feedback">\r\n\r\n                <input type="text" class="form-control" id="date-fin" name="dateFin" ng-model="ctrl.versementPeriodique.dateFin" mw-date-legere uib-datepicker-popup="dd/MM/yyyy" is-open="ctrl.openedDate2" datepicker-options="{ showWeeks: false, startingDay:1}" placeholder="jj/mm/aaaa" min-date="ctrl.versementPeriodique.dateDebut ? ctrl.versementPeriodique.dateDebut : ctrl.minDate">\r\n                <span class="btn btn-success form-control-feedback">\r\n                    <mw-button-icone texte="Calendrier" taille="sm" icone="icone itce-calendar icodate" id="buttndatefin" ng-click="ctrl.openedDate2 = true"></mw-button-icone>\r\n                </span>\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <!-- READ ONLY -->\r\n    <div ng-show="ctrl.readOnly">\r\n        <div class="form-group" ng-show="!ctrl.parametre.comptePrelevement">\r\n            <label class="control-label col-sm-3 col-md-4 col-lg-3 liste-compte-read-only" for="read-liste-compte" ng-show="!ctrl.parametre.afficheRice && ctrl.parametre.parametreListeCompte && ctrl.versementPeriodique.comptePrelevement">Compte à débiter</label>\r\n\r\n            <div class="col-sm-9 col-md-8 col-lg-9 liste-compte-read-only" ng-show="!ctrl.parametre.afficheRice && ctrl.parametre.parametreListeCompte && ctrl.versementPeriodique.comptePrelevement">\r\n                <mwsf-liste-compte compte-selectionne="ctrl.versementPeriodique.comptePrelevement" parametres="ctrl.parametre.parametreListeCompte" disabled="true" id="read-liste-compte">\r\n                </mwsf-liste-compte>\r\n            </div>\r\n            <label class="control-label col-sm-3 col-md-4 col-lg-3" for="read-rice" ng-show="ctrl.parametre.afficheRice || (!ctrl.parametre.parametreListeCompte && ctrl.parametre.ricePrelevement)">\r\n                Compte à débiter\r\n            </label>\r\n            <div class="col-sm-9 col-md-8 col-lg-9 rice-lecture-mode-consult" ng-if="ctrl.parametre.afficheRice || (!ctrl.parametre.parametreListeCompte && ctrl.parametre.ricePrelevement)">\r\n                <mwsf-saisie-rice data-ng-model="ctrl.versementPeriodique.ricePrelevement" data-read-only="true" data-mode-appel="Guichet" id="read-rice"></mwsf-saisie-rice>\r\n            </div>\r\n        </div>\r\n        <div class="form-group" ng-if="!ctrl.parametre.cacherCompteVirement">\r\n            <label class="control-label col-sm-3 col-md-4 col-lg-3" ng-show="ctrl.versementPeriodique.riceVirement" for="read-a-debiter">Compte à créditer</label>\r\n            <div class="col-sm-9 col-md-8 col-lg-9 rice-lecture-mode-consult" ng-if="ctrl.versementPeriodique.riceVirement">\r\n                <mwsf-saisie-rice id="read-a-debiter" data-ng-model="ctrl.versementPeriodique.riceVirement" data-read-only="true" data-mode-appel=""></mwsf-saisie-rice>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label col-sm-3 col-md-4 col-lg-3" for="read-periodicite">Périodicité</label>\r\n            <div class="col-sm-9 col-md-8 col-lg-9 row-fluid init-row">\r\n                <div class="span-flex" id="read-periodicite" ng-bind="ctrl.versementPeriodique.periodicite.value"></div>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label col-sm-3 col-md-4 col-lg-3" for="read-montant">Montant</label>\r\n            <div class="col-sm-9 col-md-8 col-lg-9">\r\n                <mwsf-saisie-montant-devise value="ctrl.versementPeriodique.montant" required="true" force-positive="false" id="read-montant" read-only="true">\r\n                </mwsf-saisie-montant-devise>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label col-sm-3 col-md-4 col-lg-3" for="read-libelle">Libellé</label>\r\n            <div class="col-sm-9 col-md-8 col-lg-9 row-fluid init-row">\r\n                <div class="span-flex" id="read-libelle" ng-bind="ctrl.versementPeriodique.libelle"></div>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label col-sm-3 col-md-4 col-lg-3" for="read-date-debut">Date de début</label>\r\n            <div class="col-sm-9 col-md-8 col-lg-9 row-fluid init-row">\r\n                <div class="span-flex" id="read-date-debut" ng-cloak>{{ctrl.versementPeriodique.dateDebut | date:"dd/MM/yyyy"}}</div>\r\n            </div>\r\n        </div>\r\n        <div class="form-group">\r\n            <label class="control-label col-sm-3 col-md-4 col-lg-3" for="read-date-fin">Date de fin</label>\r\n            <div class="col-sm-9 col-md-8 col-lg-9 row-fluid init-row">\r\n                <div class="span-flex" id="read-date-fin" ng-cloak><span>{{ctrl.versementPeriodique.dateFin | date:"dd/MM/yyyy"}}</span></div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n\r\n</data-ng-form>\r\n')}]);