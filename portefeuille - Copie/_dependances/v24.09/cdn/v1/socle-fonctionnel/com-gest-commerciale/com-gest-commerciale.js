/**
 * Généré par : SIGCESIE\ct-tfsbuild
 * Changeset TFS : C614114
 * Etiquette TFS : com-gest-commerciale-21.01_20210426.1
 * Déclenchement : Manual
 */
"use strict";var myway;!function(e){var i;!function(e){e.app=angular.module("myway.comGestCommerciale",["ui.bootstrap","myway.comInterdomaine","myway.comEds","moduleAgent","myway.ui","ngSanitize"])}(i=e.comGestCommerciale||(e.comGestCommerciale={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){var i=function(){function e(e,i,t,r,l){this.id=e,this.value=i,this.idSuiviPar=angular.isDefined(t)?t:"",this.libelleSuiviPar=angular.isDefined(r)?r:"",this.libelle=this.libelleSuiviPar?this.libelleSuiviPar+" - "+this.value:this.value,this.type=l}return e}();e.Portefeuille=i;var t=function(){function e(t,r,l){var n=this;this.$scope=t,this.saisieConseillerPortefeuilleService=r,this.serviceAgentExtended=l,t.viewModelConseillerPortefeuillCtrl=this,t.$watch(function(){return n.agence},function(t,r){if(t&&t.id){var l,o=parseInt(n.agence.identifiantElementStructure);n.saisieConseillerPortefeuilleService.getReferenceExterneAgentConnecte().then(function(e){l=e}),n.saisieConseillerPortefeuilleService.getPortefeuilles(o).then(function(o){var a=o.DonneeSignifiante,s=[];n.listPortefeuilles=[],angular.isUndefined(a)&&(a=[]),n.serviceAgentExtended.Habilitation.EstHabilite(["SHDQ25","SHDQ26"]).then(function(e){if(e.some(n.verfication)){var t=new i("H","Hors portefeuille ou liste","","","H"),r=!1;n.listPortefeuilles.forEach(function(e){e.id===t.id&&(r=!0)}),(e[0]||e[1])&&r===!1&&n.listPortefeuilles.push(t)}});for(var c=0;c<a.length;c++){var u=a[c].identifiantElementStructureSuiviPortefeuille;0===parseInt(u)&&(u=e.LIBELLE_NON_AFFECTE);var d=null==a[c].libelleElementStructureSuiviPortefeuille?e.LIBELLE_NON_AFFECTE:a[c].libelleElementStructureSuiviPortefeuille,f=new i(a[c].identifiantPortefeuille,a[c].libellePortefeuille,u,d,a[c].codeTypePortefeuille);angular.isUndefined(n.habilitations)&&("R"===a[c].codeTypePortefeuille?s.push(f):n.listPortefeuilles.push(f)),n.habilitations&&(n.habilitations.tout||n.habilitations.pointDeVenteAgent||n.habilitations.reservoir)&&"R"===a[c].codeTypePortefeuille&&s.push(f),n.habilitations&&n.habilitations.portefeuilleAgent&&parseInt(u)===parseInt(l)?"R"!==a[c].codeTypePortefeuille&&n.listPortefeuilles.push(f):n.habilitations&&(n.habilitations.tout||n.habilitations.pointDeVenteAgent)&&"R"!==a[c].codeTypePortefeuille&&n.listPortefeuilles.push(f)}if(angular.isDefined(s)&&s.length>0){var m=s[0];m.libelle+=" - "+MyWay.Context.OriginePortefeuille.autresMotifs,n.listPortefeuilles.push(m);var v;v=1===s.length?new i(s[0].id,s[0].value,s[0].idSuiviPar,s[0].libelleSuiviPar,s[0].type):s[1],v.libelle+=" - "+MyWay.Context.OriginePortefeuille.propPtf,n.listPortefeuilles.push(v)}if(r&&t&&r.id!==t.id&&(n.portefeuille=null),angular.isDefined(n.portefeuille)&&n.listPortefeuilles){var h;null!=n.portefeuille?h=n.portefeuille.id:n.ngModel&&n.ngModel.id&&(h=n.ngModel.id);var g=n.listPortefeuilles.filter(function(e){return e.id===h});angular.isUndefined(g)||0===g.length?n.portefeuille=null:g.length>0&&(n.portefeuille=g[0])}},function(e){n.processError(e)})}})}return e.prototype.verfication=function(e){return e===!0?!0:void 0},e.prototype.onSelectPTF=function(){this.portefeuille&&this.portefeuille.id&&(this.ngModel=this.portefeuille)},e.prototype.processError=function(e){this.listPortefeuilles=[],this.portefeuille=null,e&&e.libelle.length>0&&(this.errorMessage=e.libelle)},e.$inject=["$scope","saisieConseillerPortefeuilleService","serviceAgentExtended"],e.LIBELLE_NON_AFFECTE="Non affecté",e.DEFAULT_ERROR_MESSAGE="Erreur technique lors de la récupération des portefeuilles",e}();e.SaisieConseillerPortefeuilleController=t,e.app.controller("SaisieConseillerPortefeuilleController",t)}(i=e.comGestCommerciale||(e.comGestCommerciale={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){function i(){return{restrict:"E",templateUrl:"typescript/conseiller-portefeuille/saisie-conseiller-portefeuille-view.html",scope:{portefeuille:"=ngModel",required:"=",agence:"=ngModelAgence",habilitations:"="},controller:"SaisieConseillerPortefeuilleController",controllerAs:"viewModelConseillerPortefeuillCtrl",bindToController:!0,link:function(e,i,t){if(!("ngModel"in t))throw new Error('ng-model est un paramètre obligatoire.   ==>  < mwsf-saisie-conseiller-portefeuille ng-model="myObject" > \n');if(!("required"in t))throw new Error('required est un paramètre obligatoire.   ==>  < mwsf-saisie-conseiller-portefeuille required="true or false" > \n')}}}e.app.directive("mwsfSaisieConseillerPortefeuille",i)}(i=e.comGestCommerciale||(e.comGestCommerciale={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){var i=function(){function e(e,i,t){this.$q=e,this.$http=i,this.serviceAgentExtended=t}return e.prototype.getPortefeuilles=function(e){var i=this;return this.serviceAgentExtended.getAuthentificationInfo().then(function(t){var r="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/portefeuille-v1/recherche?codeEtablissement="+t.codeEtablissement+"&IdentifianElementStructure="+e;return i.serviceAgentExtended.sendRequest({url:r,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){return e})})},e.prototype.getReferenceExterneAgentConnecte=function(){return this.serviceAgentExtended.getAuthentificationInfo().then(function(e){return e.agentConnecte?e.agentConnecte.numeroExterneEds:""})},e.$inject=["$q","$http","serviceAgentExtended"],e}();e.SaisieConseillerPortefeuilleService=i,e.app.service("saisieConseillerPortefeuilleService",i)}(i=e.comGestCommerciale||(e.comGestCommerciale={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){var i=function(){function i(i,t){var r=this;this.$scope=i,this.restitueSuiviCommercialService=t,this.horsPortefeuille="",this.restitueSuiviCommercialService.getInfoSuiviCommercial(this.idPersonne).then(function(i){if(angular.isUndefined(i))return r.portefeuille=null,r.agence=null,void(r.conseiller=null);var t=i.portefeuilleRattachement;r.agence={id:"",value:t.libelleElementStructurePortefeuille,identifiantElementStructure:t.identifiantElementStructurePortefeuille},r.portefeuille={value:t.libellePortefeuille,id:t.identifiantPortefeuille,idSuiviPar:t.identifiantElementStructureSuiviPortefeuille},r.conseiller={value:t.libelleElementStructureSuiviPortefeuille,id:t.identifiantElementStructureSuiviPortefeuille},"H"===t.codeTypePortefeuille?r.horsPortefeuille="Hors portefeuille ou liste":0===parseInt(r.conseiller.id)&&(r.conseiller.value=e.SaisieConseillerPortefeuilleController.LIBELLE_NON_AFFECTE)},function(e){r.processError(e)}),i.$watch(function(){return r.agence},function(e,i){e&&e.value&&(r.valueAgence=e.value)}),i.$watch(function(){return r.conseiller},function(e,i){e&&e.value&&(r.valueConseiller=e.value)},!0),i.$watch(function(){return r.portefeuille},function(e,i){e&&e.value&&(r.valuePortefeuille=e.value)})}return i.prototype.processError=function(e){this.conseiller=null,this.agence=null,this.portefeuille=null,e&&(e.valeurs&&e.valeurs.length>0?this.errorMessage=e.valeurs[0]:this.errorMessage=e.libelle)},i.$inject=["$scope","restitueSuiviCommercialService"],i.DEFAULT_ERROR_MESSAGE="Erreur technique lors de la récupération des portefeuilles",i}();e.RestitueSuiviCommercialController=i,e.app.controller("RestitueSuiviCommercialController",i)}(i=e.comGestCommerciale||(e.comGestCommerciale={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){function i(){return{restrict:"E",templateUrl:"typescript/suivi-commercial/restitue-suivi-commercial-view.html",scope:{libellePortefeuille:"@",libelleConseiller:"@",libelleAgence:"@",setLabelWidth:"@",conseiller:"=conseiller",portefeuille:"=portefeuille",agence:"=agence",ngModelAgence:"@",setWidth:"@",idPersonne:"=idPersonne"},controller:"RestitueSuiviCommercialController",controllerAs:"viewModelSuiviCommercialCtrl",bindToController:!0,link:function(e,i,t){}}}e.app.directive("mwsfRestitueSuiviCommercial",i)}(i=e.comGestCommerciale||(e.comGestCommerciale={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){var i=function(){function e(e,i){this.$q=e,this.serviceAgentExtended=i}return e.prototype.getInfoSuiviCommercial=function(e){var i=this;return this.serviceAgentExtended.getAuthentificationInfo().then(function(t){if(e&&null!=e){var r="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v2/portefeuille?codeEtablissement="+t.codeEtablissement+"&identifiantTiers="+e;return i.appelleRessourceREST(r)}return i.serviceAgentExtended.getFromContext("identifiantPersonne").then(function(e){if(angular.isDefined(e)&&null!=e){var r="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v2/portefeuille?codeEtablissement="+t.codeEtablissement+"&identifiantTiers="+e;return i.appelleRessourceREST(r)}})})},e.prototype.appelleRessourceREST=function(e){return this.serviceAgentExtended.sendRequest({url:e,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(e){return e})},e.$inject=["$q","serviceAgentExtended"],e}();e.RestitueSuiviCommercialService=i,e.app.service("restitueSuiviCommercialService",i)}(i=e.comGestCommerciale||(e.comGestCommerciale={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){var i=function(){function e(e,i,t,r,l,n){var o=this;this.$scope=e,this.suiviParModificationService=i,this.modalService=t,this.serviceAgentExtended=r,this.mwNotificationService=l,this.$q=n,this.TIERS_VERSION="tiers-v1",this.visibleLink=!0,this.getHabilitationSHDQ38().then(function(e){o.envoiManager=e,o.cacheEnvoiManager=o.modeCreationPmProspect?o.modeCreationPmProspect:!e,o.peutModifierSuivi().then(function(e){o.visibleLink=e,o.peutModifier=e,o.initModale()})})["catch"](function(e){o.envoiManager=!1,o.cacheEnvoiManager=!0,o.peutModifierSuivi().then(function(e){o.visibleLink=e,o.peutModifier=e,o.initModale()})}),e.$watch(function(){return o.agenceDestinataire},function(e,i){e&&o.rechercheEDS&&(o.rechercheEDS.agenceDestinataire=e),i&&e&&i.id!==e.id&&(o.portefeuilleDestinataire=null)}),e.$watch(function(){return o.agenceOrigine},function(e,i){e&&e.id&&o.rechercheEDS&&(o.rechercheEDS.agenceOrigine=e)}),e.$watch(function(){return o.conseillerOrigine},function(e,i){e&&e.id&&o.rechercheEDS&&(o.rechercheEDS.conseillerOrigine=e)}),e.$watch(function(){return o.portefeuilleOrigine},function(e,i){e&&e.id&&o.rechercheEDS&&(o.rechercheEDS.portefeuilleOrigine=e)}),e.$watch(function(){return o.portefeuilleDestinataire},function(e,i){o.rechercheEDS&&(o.rechercheEDS.portefeuilleDestinataire=e)}),e.$watch(function(){return o.idPersonne},function(e,i){e&&o.rechercheEDS&&(o.rechercheEDS.idPersonne=e)}),e.$watch(function(){return o.rechercheEDS&&o.rechercheEDS.agenceOrigine},function(e,i){e&&e.identifiantElementStructure&&o.rechercheEDS.agenceDestinataire&&o.rechercheEDS.agenceDestinataire.identifiantElementStructure===e.identifiantElementStructure&&(null===o.rechercheEDS.portefeuilleDestinataire||o.rechercheEDS.portefeuilleDestinataire&&0===o.rechercheEDS.portefeuilleDestinataire.length)&&(o.portefeuilleDestinataire=o.rechercheEDS.portefeuilleOrigine)})}return e.prototype.initModale=function(){var e=!1;this.habilitations&&(((this.habilitations.portefeuilleAgent||this.habilitations.pointDeVenteAgent)&&!this.habilitations.tout||!this.habilitations.portefeuilleAgent&&!this.habilitations.pointDeVenteAgent&&!this.habilitations.tout)&&(e=!0),this.habilitations.portefeuilleAgent||this.habilitations.pointDeVenteAgent||this.habilitations.tout||this.habilitations.reservoir||(this.visibleLink=!1)),this.rechercheEDS={agenceOrigine:this.agenceOrigine,conseillerOrigine:this.conseillerOrigine,portefeuilleOrigine:this.portefeuilleOrigine,agenceDestinataire:this.agenceDestinataire,portefeuilleDestinataire:this.portefeuilleDestinataire,requiredPortefeuille:this.requiredPortefeuille,requiredAgence:this.requiredAgence,chevronVisible:this.chevronVisible,notItemsFoundText:this.notItemsFoundText,libellePortefeuilleOrigine:this.libellePortefeuilleOrigine,libelleConseillerOrigine:this.libelleConseillerOrigine,libelleAgenceOrigine:this.libelleAgenceOrigine,libellePortefeuilleDestinataire:this.libellePortefeuilleDestinataire,libelleAgenceDestinataire:this.libelleAgenceDestinataire,errorMessage:null,idPersonne:this.idPersonne,habilitations:this.habilitations,disableAgence:e,informationMessage:this.informationMessage,envoiManager:this.envoiManager,cacheEnvoiManager:this.cacheEnvoiManager,nonEnregistrement:this.nonEnregistrement,peutModifier:this.peutModifier,agentId:this.agentId,tableauHabilitation:this.tableauHabilitation}},e.prototype.getHabilitationSHDQ38=function(){var e=this,i=this.$q.defer();return this.serviceAgentExtended.Habilitation.EstHabilite("SHDQ38").then(function(e){i.resolve(e)})["catch"](function(t){e.serviceAgentExtended.Trace.warning("Suivi commercial ---- Une erreur est survenue lors de la récupération de l'habilitation SHDQ38","habilitationSHDQ38",t),i.resolve(!1)}),i.promise},e.prototype.peutModifierSuivi=function(){var e,i,t=this,r=this.$q.defer();return this.serviceAgentExtended.Habilitation.EstHabilite(["SHDQ23","SHDQ24","SHDQ25","SHDQ26"]).then(function(l){return l.some(t.verfication)?(t.tableauHabilitation=l,t.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(l){e=l,t.codeMarche=t.getCodeMarche(e.codeEtablissement,t.idPersonne),t.serviceAgentExtended.Context.GetParametresComptables().then(function(e){return i=e,t.agentId=l.agentConnecte.numeroExterneEds,"MN"!==t.codeMarche.codeTypeSegmentation||"1013"!==t.codeMarche.codeTypeSegmentation.substring(0,4)?(console.log(t.verfication),r.resolve(!0)):void t.serviceAgentExtended.Habilitation.EstHabilite("SHOMW2").then(function(e){return e?r.resolve(!1):void 0})})["catch"](function(e){return t.serviceAgentExtended.Trace.warning("Suivi commercial ---- Une erreur est survenue lors de la récupération des droits de modification","peutModifierSuivi",e),r.resolve(!1)})})["catch"](function(e){return t.serviceAgentExtended.Trace.warning("Suivi commercial ---- Une erreur est survenue lors de la récupération des droits de modification","peutModifierSuivi",e),r.resolve(!1)})):(console.log("Suivi commercial ---- Vous ne disposez pas des habilitations nécessaire pour modifier un porte-feuille"),r.resolve(!1))})["catch"](function(e){t.serviceAgentExtended.Trace.warning("Suivi commercial ---- Une erreur est survenue lors de la récupération des droits de modification","peutModifierSuivi",e),r.resolve(!1)}),r.promise},e.prototype.verfication=function(e){return e===!0?!0:void 0},e.prototype.getCodeMarche=function(e,i){var t="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/"+this.TIERS_VERSION+"/identification";return this.serviceAgentExtended.sendRequest({url:t,withHeaders:!0,method:MyWay.Services.MethodEnum.GET,params:{codeEtablissement:e,idPersonne:i}}).then(function(e){return e.codeMarche})},e.prototype.openRechercheEDS=function(){var e=this,i={closeButtonText:"Annuler",actionButtonText:"Valider",headerText:"Suivi Par",iconName:"",bodyText:"",model:this.rechercheEDS},t={templateUrl:"typescript/suivi-par-modification/myModalContent-view.html",controller:"SuiviParModaleController",size:"lg",resolve:{data:function(){return i}}};this.modalService.showModal(t).then(function(i){e.agenceDestinataire=i.agenceDestinataire,e.portefeuilleDestinataire=i.portefeuilleDestinataire,e.nonEnregistrement||e.mwNotificationService.showNotification("La mise à jour du portefeuille a bien été effectuée")})},e.$inject=["$scope","suiviParModificationService","modalService","serviceAgentExtended","MwNotificationService","$q"],e}();e.SuiviParModificationController=i;var t=function(){function e(e,i,t,r,l){var n=this;this.$scope=e,this.$modalInstance=i,this.suiviParModificationService=t,this.data=r,this.$modal=l,e.modalDatas=r,e.modalDatas.ok=function(){console.log(e.modalDatas.model),e.modalDatas.model.nonEnregistrement===!0?(e.modalDatas.model.errorMessage=null,i.close(e.modalDatas.model)):t.savePortefeuilles(e.modalDatas.model).then(function(t){angular.isDefined(t)&&angular.isDefined(t.libelle)?e.modalDatas.model.errorMessage=t.libelle:angular.isUndefined(t)?e.modalDatas.model.errorMessage="Une erreur est survenue lors de l'affection du portefeuille.":(e.modalDatas.model.errorMessage=null,i.close(e.modalDatas.model))},function(i){i.valeurs&&i.valeurs.length>0?e.modalDatas.model.errorMessage=i.valeurs[0]:i.libelle?e.modalDatas.model.errorMessage=i.libelle:e.modalDatas.model.errorMessage=i.toString()})},e.$watch(function(){return e.modalDatas.model.agenceDestinataire},function(i,t){e.modalDatas.model.errorMessage=null}),e.$watch(function(){return e.modalDatas.model.portefeuilleDestinataire},function(i,t){if(e.modalDatas.model.tableauHabilitation[3]===!1&&e.modalDatas.model.tableauHabilitation[2]===!1){if(e.modalDatas.model.tableauHabilitation[0]===!1&&e.modalDatas.model.tableauHabilitation[1]===!0){var r=e.modalDatas.model.portefeuilleDestinataire.idSuiviPar;e.modalDatas.model.peutModifier=n.verificationSHDQ24(r,e.modalDatas.model.portefeuilleOrigine.idSuiviPar,e.modalDatas.model.agentId)}if(e.modalDatas.model.tableauHabilitation[0]===!0&&e.modalDatas.model.tableauHabilitation[1]===!1&&(e.modalDatas.model.peutModifier=n.verificationSHDQ23(e.modalDatas.model.portefeuilleOrigine.value,e.modalDatas.model.portefeuilleDestinataire)),e.modalDatas.model.tableauHabilitation[0]===!0&&e.modalDatas.model.tableauHabilitation[1]===!0){var l,o;l=n.verificationSHDQ24(e.modalDatas.model.portefeuilleDestinataire.idSuiviPar,e.modalDatas.model.portefeuilleOrigine.idSuiviPar,e.modalDatas.model.agentId),o=n.verificationSHDQ23(e.modalDatas.model.portefeuilleOrigine.value,e.modalDatas.model.portefeuilleDestinataire),o===!0||l===!0?e.modalDatas.model.peutModifier=!0:e.modalDatas.model.peutModifier=!1}}e.modalDatas.model.errorMessage=null}),e.$watch(function(){return e.modalDatas.model.errorMessage},function(i,t){e.modalDatas.model.errorMessage=i}),e.modalDatas.close=function(t){e.modalDatas.model.errorMessage=null,i.dismiss("cancel")}}return e.prototype.verificationSHDQ24=function(e,i,t){return parseInt(e)===parseInt(t)&&parseInt(i)===parseInt(t)?!0:!1},e.prototype.verificationSHDQ23=function(e,i){return e.indexOf("COLLECTIF")>-1&&e.indexOf("RESERVOIR")>-1&&e.indexOf("Hors portefeuille")>-1||"R"===i.type&&i.libelle.indexOf("Autres motifs")<0?!0:!1},e.$inject=["$scope","$modalInstance","suiviParModificationService","data","$modal"],e}();e.SuiviParModaleController=t,e.app.controller("SuiviParModificationController",i),e.app.controller("SuiviParModaleController",t)}(i=e.comGestCommerciale||(e.comGestCommerciale={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){function i(){return{restrict:"E",templateUrl:"typescript/suivi-par-modification/suivi-par-modification-view.html",scope:{libellePortefeuilleOrigine:"@",libelleConseillerOrigine:"@",libelleAgenceOrigine:"@",libellePortefeuilleDestinataire:"@",libelleAgenceDestinataire:"@",setLabelWidth:"@",conseillerOrigine:"=ngModelConseillerOrigine",portefeuilleOrigine:"=ngModelPortefeuilleOrigine",agenceOrigine:"=ngModelAgenceOrigine",portefeuilleDestinataire:"=ngModelPortefeuilleDestinataire",agenceDestinataire:"=ngModelAgenceDestinataire",requiredPortefeuille:"=",requiredAgence:"=",notItemsFoundText:"@",linkText:"@",styleButton:"@",idPersonne:"=idPersonne",habilitations:"=habilitations",informationMessage:"@",modeCreationPmProspect:"@",nonEnregistrement:"=?"},controller:"SuiviParModificationController",controllerAs:"viewModelSuiviParModificationCtrl",bindToController:!0,link:function(e,i,t){}}}e.app.directive("mwsfSuiviParModification",i)}(i=e.comGestCommerciale||(e.comGestCommerciale={}))}(myway||(myway={}));var myway;!function(e){var i;!function(e){var i=function(){function e(e){this.serviceAgentExtended=e}return e.prototype.savePortefeuilles=function(e){var i=this;return this.serviceAgentExtended.getAuthentificationInfo().then(function(t){if(e.idPersonne){var r="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v2/portefeuille?codeEtablissement="+t.codeEtablissement+"&identifiantTiers="+e.idPersonne;return i.serviceAgentExtended.sendRequest({url:r,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(t){if(e.portefeuilleDestinataire){if("H"!==e.portefeuilleDestinataire.id?t.portefeuilleTransfert.identifiantPortefeuilleTransfert=e.portefeuilleDestinataire.id:t.portefeuilleTransfert.codeTypeMotifTransfert="H","R"===e.portefeuilleDestinataire.type){var l=e.portefeuilleDestinataire.libelle.split(" - ");3===l.length&&l[2]===MyWay.Context.OriginePortefeuille.propPtf&&(t.portefeuilleTransfert.codeTypeMotifTransfert="P"),3===l.length&&l[2]===MyWay.Context.OriginePortefeuille.autresMotifs&&(t.portefeuilleTransfert.codeTypeMotifTransfert="A")}else"H"===e.portefeuilleDestinataire.id?t.portefeuilleTransfert.codeTypeMotifTransfert="H":t.portefeuilleTransfert.codeTypeMotifTransfert=" ";return t.portefeuilleTransfert.indicateurEnvoiMessage=e.envoiManager&&"H"!==t.portefeuilleTransfert.codeTypeMotifTransfert?"O":"N",i.serviceAgentExtended.sendRequest({url:r,withHeaders:!0,method:MyWay.Services.MethodEnum.PUT,data:t}).then(function(e){return e},function(e){return e})}},function(e){return e})}return i.serviceAgentExtended.getFromContext("identifiantPersonne").then(function(l){if(angular.isDefined(l)&&null!=l){var n="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers-v2/portefeuille?codeEtablissement="+t.codeEtablissement+"&identifiantTiers="+l;return i.serviceAgentExtended.sendRequest({url:n,withHeaders:!0,method:MyWay.Services.MethodEnum.GET}).then(function(t){if(e.portefeuilleDestinataire){if(t.portefeuilleTransfert.identifiantPortefeuilleTransfert=e.portefeuilleDestinataire.id,"R"===e.portefeuilleDestinataire.type){var l=e.portefeuilleDestinataire.libelle.split(" - ");3===l.length&&l[2]===MyWay.Context.OriginePortefeuille.propPtf&&(t.portefeuilleTransfert.codeTypeMotifTransfert="P"),3===l.length&&l[2]===MyWay.Context.OriginePortefeuille.autresMotifs&&(t.portefeuilleTransfert.codeTypeMotifTransfert="A")}else t.portefeuilleTransfert.codeTypeMotifTransfert=" ";return t.portefeuilleTransfert.indicateurEnvoiMessage=e.envoiManager?"O":"N",i.serviceAgentExtended.sendRequest({url:r,withHeaders:!0,method:MyWay.Services.MethodEnum.PUT,data:t}).then(function(e){return e},function(e){return e})}},function(e){return e})}throw new MyWay.Services.Erreur("Echec de lecture dans le contexte de identifiantPersonne")},function(e){return e})})},e.$inject=["serviceAgentExtended"],e}();e.SuiviParModificationService=i,e.app.service("suiviParModificationService",i)}(i=e.comGestCommerciale||(e.comGestCommerciale={}))}(myway||(myway={})),angular.module("myway.comGestCommerciale").run(["$templateCache",function(e){e.put("typescript/conseiller-portefeuille/saisie-conseiller-portefeuille-view.html",'\r\n<data-ng-form class="form-horizontal" name="formPortefeuille" role="form" novalidate>\r\n    <div class="form-group col-md-12" data-ng-class="{\'has-error\' : viewModelConseillerPortefeuillCtrl.required && !viewModelConseillerPortefeuillCtrl.portefeuille}">\r\n        <ui-select ng-model="viewModelConseillerPortefeuillCtrl.portefeuille" theme="bootstrap" id="conseiller-ptf" ng-change="viewModelConseillerPortefeuillCtrl.onSelectPTF()">\r\n            <ui-select-match>{{$select.selected.libelle}}</ui-select-match>\r\n            <ui-select-choices repeat="portefeuille in viewModelConseillerPortefeuillCtrl.listPortefeuilles | filter: { libelle: $select.search }">{{portefeuille.libelle}}</ui-select-choices>\r\n        </ui-select>\r\n    </div>\r\n</data-ng-form> '),e.put("typescript/suivi-commercial/restitue-suivi-commercial-view.html",'\r\n<data-ng-form novalidate>\r\n    <div class="row" data-ng-show="!viewModelSuiviCommercialCtrl.horsPortefeuille">\r\n        <p class="col-sm-6 col-md-4 text-right" data-ng-show="viewModelSuiviCommercialCtrl.libelleAgence" ng-style="{\'width\':viewModelSuiviCommercialCtrl.setLabelWidth}" ng-bind="::viewModelSuiviCommercialCtrl.libelleAgence"> : </p>\r\n        <p class="col-md-8" data-ng-show="viewModelSuiviCommercialCtrl.agence" ng-style="{\'width\':viewModelSuiviCommercialCtrl.setWidth}" ng-bind="viewModelSuiviCommercialCtrl.valueAgence"></p>\r\n    </div>\r\n    <div class="row" data-ng-show="!viewModelSuiviCommercialCtrl.horsPortefeuille">\r\n        <p class="col-sm-6 col-md-4 text-right" data-ng-show="viewModelSuiviCommercialCtrl.libelleConseiller" ng-style="{\'width\':viewModelSuiviCommercialCtrl.setLabelWidth}" ng-bind="::viewModelSuiviCommercialCtrl.libelleConseiller"> : </p>\r\n        <p class="col-md-8" data-ng-show="viewModelSuiviCommercialCtrl.conseiller" ng-style="{\'width\':viewModelSuiviCommercialCtrl.setWidth}" ng-bind="viewModelSuiviCommercialCtrl.valueConseiller"></p>\r\n    </div>\r\n    <div class="row" data-ng-show="!viewModelSuiviCommercialCtrl.horsPortefeuille">\r\n        <p class="col-sm-6 col-md-4 text-right" data-ng-show="viewModelSuiviCommercialCtrl.libellePortefeuille" ng-style="{\'width\':viewModelSuiviCommercialCtrl.setLabelWidth}" ng-bind="::viewModelSuiviCommercialCtrl.libellePortefeuille"> : </p>\r\n        <p class="col-md-8" data-ng-show="viewModelSuiviCommercialCtrl.portefeuille" ng-style="{\'width\':viewModelSuiviCommercialCtrl.setWidth}" ng-bind="viewModelSuiviCommercialCtrl.valuePortefeuille"></p>\r\n    </div>\r\n    <div class="row" data-ng-show="viewModelSuiviCommercialCtrl.horsPortefeuille">\r\n        <p class="col-sm-6 col-md-4 text-right"></p>\r\n        <p class="col-md-8" data-ng-show="viewModelSuiviCommercialCtrl.horsPortefeuille" ng-style="{\'width\':viewModelSuiviCommercialCtrl.setWidth}" ng-bind="viewModelSuiviCommercialCtrl.horsPortefeuille"></p>\r\n    </div>\r\n    <div class="row">\r\n        <div class="col-md-12">\r\n            <div class="alert alert-danger text-center" role="alert" data-ng-show="viewModelSuiviCommercialCtrl.errorMessage" data-ng-bind="viewModelSuiviCommercialCtrl.errorMessage"></div>\r\n        </div>\r\n    </div>\r\n</data-ng-form>'),e.put("typescript/suivi-par-modification/myModalContent-view.html",'<div class="modal-header">\r\n    <button type="button" ng-click="modalDatas.close()" class="close" aria-hidden="true"><span class="icon itce-times"></span></button>\r\n    <h3 class="modal-title" ng-bind="modalDatas.headerText"></h3>\r\n</div>\r\n<div class="modal-body">\r\n\r\n    <p class="col-md-12 alert alert-warning" data-ng-show="modalDatas.model.informationMessage" ng-bind="modalDatas.model.informationMessage">\r\n        <span class="icon itce-warning"></span>\r\n    </p>\r\n    <mwsf-restitue-suivi-commercial libelle-agence="{{::modalDatas.model.libelleAgenceOrigine}}" libelle-conseiller="{{::modalDatas.model.libelleConseillerOrigine}}" libelle-portefeuille="{{::modalDatas.model.libellePortefeuilleOrigine}}" conseiller="modalDatas.model.conseillerOrigine" agence="modalDatas.model.agenceOrigine" portefeuille="modalDatas.model.portefeuilleOrigine" id-personne="modalDatas.model.idPersonne" id="restitue"></mwsf-restitue-suivi-commercial>\r\n    <hr>\r\n    <ng-form class="form-horizontal">\r\n        <div class="row">\r\n            <div class="col-sm-12">\r\n                <label class="control-label label-correctif-position" data-ng-show="modalDatas.model.libelleAgenceDestinataire" for="agence" data-ng-bind="::modalDatas.model.libelleAgenceDestinataire"></label>\r\n                <mwsf-saisie-agence-destinataire ng-model="modalDatas.model.agenceDestinataire" required="modalDatas.model.requiredAgence" disable="modalDatas.model.disableAgence" id="agence">\r\n                </mwsf-saisie-agence-destinataire>\r\n            </div>\r\n        </div>\r\n        <div class="row">\r\n            <div class="col-sm-12">\r\n                <div ng-show="modalDatas.model.agenceDestinataire.id">\r\n                    <label class="control-label label-correctif-position" data-ng-show="modalDatas.model.libellePortefeuilleDestinataire" data-ng-bind="::modalDatas.model.libellePortefeuilleDestinataire" for="conseiller"></label>\r\n                    <mwsf-saisie-conseiller-portefeuille ng-model-agence="modalDatas.model.agenceDestinataire" ng-model="modalDatas.model.portefeuilleDestinataire" required="modalDatas.model.requiredPortefeuille" habilitations="modalDatas.model.habilitations" id="conseiller">\r\n                    </mwsf-saisie-conseiller-portefeuille>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        <div class="row" ng-hide="modalDatas.model.cacheEnvoiManager"> \r\n            <div class="col-sm-4 col-md-3">\r\n                <label class="control-label label-correctif-position position-checkbox" for="rien">Information au manager :</label>\r\n            </div>\r\n            <div class="col-sm-4 col-md-3 col-lg-3">\r\n                <div class="mw-input-check vertical-alignement">\r\n                    <label for="ac-envoi-manager" id="lbl-envoi-manager">\r\n                        <input id="ac-envoi-manager" type="checkbox" ng-model="modalDatas.model.envoiManager" class="col-md-2" ng-attr-aria-checked="{{modalDatas.model.envoiManager}}" aria-labelledby="lbl-envoi-manager">\r\n                        <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\':modalDatas.model.envoiManager}"></span>\r\n                        Envoi d\'un message\r\n                    </label>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n    </ng-form>\r\n    <div data-ng-show="modalDatas.model.errorMessage" class="row">\r\n        <div class="col-md-12">\r\n            <div class="alert alert-danger text-center" role="alert" ng-bind="modalDatas.model.errorMessage"></div>\r\n        </div>\r\n    </div>\r\n</div>\r\n<div class="modal-footer">\r\n    <div class="col-sm-6">\r\n        <button type="button" class="btn btn-default" ng-click="modalDatas.close()" ng-bind="::modalDatas.closeButtonText" id="btn-close"></button>\r\n    </div>\r\n    <div class="col-sm-6">\r\n        <button type="button" class="btn btn-primary" id="btn-save" data-ng-disabled="!modalDatas.model.agenceDestinataire || !modalDatas.model.agenceDestinataire.id || !modalDatas.model.portefeuilleDestinataire || !modalDatas.model.portefeuilleDestinataire.id || !modalDatas.model.peutModifier" ng-click="modalDatas.ok()" ng-bind="::modalDatas.actionButtonText"></button>\r\n    </div>\r\n</div>\r\n'),e.put("typescript/suivi-par-modification/suivi-par-modification-view.html",'<!--<div ng-show="viewModelSuiviParModificationCtrl.visibleLink">\r\n    <button class="btn btn-block" data-ng-class="viewModelSuiviParModificationCtrl.styleButton ? \'btn-{{viewModelSuiviParModificationCtrl.styleButton}}\' : \'btn-contextuel\'" data-ng-click="viewModelSuiviParModificationCtrl.openRechercheEDS()">\r\n        {{viewModelSuiviParModificationCtrl.linkText}}\r\n    </button>\r\n</div>-->\r\n<div ng-show="viewModelSuiviParModificationCtrl.visibleLink">\r\n    <a href="" data-ng-click="viewModelSuiviParModificationCtrl.openRechercheEDS()" id="a-suivi" ng-bind="viewModelSuiviParModificationCtrl.linkText">\r\n    </a>\r\n</div>\r\n')}]);