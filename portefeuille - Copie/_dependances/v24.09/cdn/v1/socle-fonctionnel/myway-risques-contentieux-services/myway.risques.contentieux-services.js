/**
 * Généré par : SIGCESIE\ct-tfsbuild
 * Changeset TFS : undefined
 * Etiquette TFS : undefined
 * Déclenchement : undefined
 */
var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t;!function(e){e.$location="$location",e.$q="$q",e.$window="$window",e.$scope="$scope",e.$timeout="$timeout",e.$filter="$filter"}(t=e.Angular||(e.Angular={}));var n;!function(e){e.serviceAgentExtended="serviceAgentExtended",e.serviceAgent="serviceAgent",e.modalService="modalService"}(n=e.MyWay||(e.MyWay={}));var i;!function(e){e.identifiantBordereauService="identifiantBordereauService",e.saisieRiceService="saisieRiceService"}(i=e.SocleFonctionnel||(e.SocleFonctionnel={}));var r;!function(e){e.consoleLoggerService="ContentieuxCommun.Logger.ConsoleLoggerService",e.fullLoggerService="ContentieuxCommun.Logger.FullLoggerService",e.myWayLoggerService="ContentieuxCommun.Logger.MyWayLoggerService",e.applicationLoggerName=ContentieuxCommun.Constantes.Inject.Logger.fullLoggerService}(r=e.Logger||(e.Logger={}));var o;!function(e){e.entiteTitulaireUtils="ContentieuxCommun.Metier.EntiteTitulaireUtils"}(o=e.Metier||(e.Metier={}));var a;!function(e){e.actionPlanifieeService="ContentieuxServices.Services.ActionPlanifieeService",e.cacheService="ContentieuxServices.Services.CacheService",e.communService="ContentieuxServices.Services.CommunService",e.creanceService="ContentieuxServices.Services.CreanceService",e.creanceParametre="ContentieuxServices.Services.CreanceParametre",e.dossierNumeriqueService="ContentieuxServices.Services.DossierNumeriqueService",e.dossierService="ContentieuxServices.Services.DossierService",e.dossierSyntheseService="ContentieuxServices.Services.DossierSyntheseService",e.echeancierService="ContentieuxServices.Services.EcheancierService",e.echeancierBDFService="ContentieuxServices.Services.EcheancierBDFService",e.edsService="ContentieuxServices.Services.EDSService",e.entiteTitulaireService="ContentieuxServices.Services.EntiteTitulaireService",e.garantieService="ContentieuxServices.Services.GarantieService",e.garantiePGEService="ContentieuxServices.Services.GarantiePGEService",e.habilitationsService="ContentieuxServices.Services.HabilitationsService",e.noteAlerteService="ContentieuxServices.Services.NoteAlerteService",e.operationDiverseService="ContentieuxServices.Services.OoperationDiverseService",e.personneService="ContentieuxServices.Services.PersonneService",e.pointBudgetService="ContentieuxServices.Services.PointBudgetService",e.portefeuilleService="ContentieuxServices.Services.PortefeuilleService",e.processusService="ContentieuxServices.Services.ProcessusService",e.paiement="ContentieuxServices.Services.Paiement",e.paiementCbUnique="ContentieuxServices.Services.Paiement.PaiementCbUnique",e.paiementCheque="ContentieuxServices.Services.Paiement.PaiementCheque",e.paiementPrelevement="ContentieuxServices.Services.Paiement.PaiementPrelevement",e.rechercheBDFService="ContentieuxServices.Services.RechercheBDFService",e.siegeService="ContentieuxServices.Services.Siege",e.soldeService="ContentieuxServices.Services.SoldeService",e.smsService="ContentieuxServices.Services.SmsService",e.tiersService="ContentieuxServices.Services.TiersService"}(a=e.Services||(e.Services={}))}(t=e.Inject||(e.Inject={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){"use strict";e.app=angular.module("ContentieuxServices",["ngRoute","moduleAgent","ContentieuxRestServices","ContentieuxCommun","myway.comInterdomaine","ContentieuxParametrage"])}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t;!function(e){e.libellePlusieursAlertesSurDossier="Plusieurs alertes sur ce dossier"}(t=e.NoteAlerte||(e.NoteAlerte={}));var n;!function(e){e.numeroEvenementNoteSuivie="06",e.numeroSousTypeEvenementMyVario="99"}(n=e.typeEvenement||(e.typeEvenement={}))}(t=e.Agenda||(e.Agenda={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";e.TYPE_CONSULTATION_OUVERT="1"}(t=e.CreditGestion||(e.CreditGestion={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t;!function(e){e.contexteCodeFournisseur="CODE_FOURNISSEUR",e.contexteReferenceRegroupement="REFERENCE_REGROUPEMENT"}(t=e.Lisa||(e.Lisa={}));var n;!function(e){e.formatageEspace=["     "]}(n=e.dossierNumeriqueCredit||(e.dossierNumeriqueCredit={}));var i;!function(e){e.creditInstruction="INCR",e.vario="VRIO"}(i=e.codeFournisseur||(e.codeFournisseur={}));var r;!function(e){e.codeNatureAcquisition="",e.critereInjection="A",e.metaDonnee="",e.indicateurEnvoiDossierPartage="0",e.libelleRegroupement=" - Dossier MyVario N° ",e.typeAttributaireContrat="1",e.typeAttributairePersonne="2",e.typeAttributaireEntiteTitulaire="7",e.listeCodeProduitServiceAutorise=["P000","P001","0004","0008","PCTX","F003"],e.listeCodeProduitServiceFormatageEspace=["P000","P001","F003"],e.listeCodeProduitServiceFormatageGuichet=["0004","0008","PCTX"],e.formatageEspace=["     "];var t;!function(e){e.libelleTheme="Clients",e.ordreTheme=1,e.listeCodesContrat=["INAR"],e.listeCodesPersonne=["JIDN","JDMC","JPEM","SFAM","SFIN"]}(t=e.ThemeClients||(e.ThemeClients={}));var n;!function(e){e.libelleTheme="Procédures",e.ordreTheme=2,e.listeCodesContrat=["ASIP","DCHD","MEPS","MDEM","MJOC","PROE","SIMM","ACPR","SIMT","SIMC"],e.listeCodesEntiteTitulaire=["PENL","PCOL","SRDT","MADH","SUCC"],e.listeCodesPersonne=["MEDB"],e.listeCodeProduitAutorisesMEPS=["P001","PCTX"],e.listeCodeProduitAutorisesMJOC=["P000","PCTX"]}(n=e.ThemeProcedures||(e.ThemeProcedures={}));var i;!function(e){e.libelleTheme="Docs internes",e.ordreTheme=3,e.listeCodesContrat=["FPER","FPRV","EXPT","FDCN","DEVF","NCTX","NADD"],e.listeCodesPersonne=["CNTP"],e.listeCodesEntiteTitulaire=["FACR","DMYV"]}(i=e.ThemeDocsInternes||(e.ThemeDocsInternes={}));var r;!function(e){e.libelleTheme="Contrats",e.ordreTheme=4,e.listeCodesContrat=["OACL","GRNT"]}(r=e.ThemeContrats||(e.ThemeContrats={}))}(r=e.dossierNumeriqueRecouvrement||(e.dossierNumeriqueRecouvrement={}))}(t=e.DossierNumerique||(e.DossierNumerique={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t;!function(e){e.ETIQUETTE_CEDE="CEDE",e.ETIQUETTE_ARCHIVE="ARCHIVE",e.ETIQUETTE_CLOTURE="CLOTURE",e.ETIQUETTE_SURENDETTEMENT="SURENDETTEMENT",e.ETIQUETTE_LIEN_ETAT_DATE=" le "}(t=e.Etiquette||(e.Etiquette={}));var n;!function(e){e.TITRE_POPUP_PAS_DE_DOSSIER="Information",e.MESSAGE_POPUP_PAS_DE_DOSSIER="Pas de dossier pour cette personne. <BR/>Voulez-vous créer un dossier ?",e.BOUTON_CREER_DOSSIER="Créer un dossier"}(n=e.Commun||(e.Commun={}))}(t=e.Dossier||(e.Dossier={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){e.CODE_TAUX_PENALITE_CREANCE_OUI="O",e.CODE_TAUX_PENALITE_CREANCE_NON="N",e.CODE_APUREMENT_TOTAL_OUI="O",e.CODE_APUREMENT_TOTAL_NON="N",e.CODE_MORATOIRE_OUI="O",e.CODE_MORATOIRE_NON="N",e.DATE_DEFAULT="0001-01-01"}(t=e.EcheancierBDF||(e.EcheancierBDF={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){e.MODE_COMPLET="C",e.MODE_OPTIMISE="O",e.MODE_UNITAIRE="U",e.LIBELLE_STATUT_RESPECTE="RESPECTE",e.LIBELLE_STATUT_NON_RESPECTE="NON RESPECTE",e.LIBELLE_STATUT_EN_RETARD="EN RETARD",e.LIBELLE_STATUT_ATTENTE_SIGNATURE="ATTENTE SIGNATURE",e.LIBELLE_STATUT_CADUC="CADUC",e.LIBELLE_STATUT_SUPPRIME="SUPPRIME",e.LIBELLE_STATUT_TERMINE="TERMINE",e.CODE_ACTION_CREATION="C",e.CODE_ACTION_SIMULER="S",e.CODE_ACTION_LECTURE="L",e.CODE_TYPE_ECHEANCIER_APUREMENT="A",e.CODE_TYPE_ECHEANCIER_REGLEMENT="R",e.CODE_TYPE_ECHEANCIER_SURVEILLANCE="S",e.CODE_TYPE_ECHEANCIER_SURVEILLANCE_CREDIT_NON_DECHU="S",e.CODE_TYPE_ECHEANCIER_POINT_BUDGET="PBT",e.CODE_PERIODICITE_MENSUELLE="M",e.CODE_PERIODICITE_TRIMESTRIEL="T",e.CODE_PERIODICITE_ANNUELLE="A",e.CODE_ORIGNE_FLUX_DEBITEUR="1",e.CODE_ORIGNE_FLUX_GARANTIE="D",e.CODE_ORIGNE_FLUX_AUTRE="7",e.CODE_ETAT_PLAN_APUREMENT_ATTENTE_SIGNATURE="B",e.CODE_ETAT_PLAN_APUREMENT_ACTIF="A",e.CODE_ETAT_PLAN_APUREMENT_EN_RETARD="R",e.CODE_ETAT_PLAN_APUREMENT_NON_RESPECT="N",e.CODE_ETAT_PLAN_APUREMENT_CADUC="C",e.CODE_ETAT_PLAN_APUREMENT_SUPPRIME="S",e.CODE_ETAT_PLAN_APUREMENT_TERMINE="T",e.CODE_APUREMENT_TOTAL_OUI="O",e.CODE_APUREMENT_TOTAL_NON="N",e.CODE_TAUX_PENALITE_CREANCE_OUI="O",e.CODE_TAUX_PENALITE_CREANCE_NON="N",e.CODE_NEIERTZ_OUI="O",e.CODE_NEIERTZ_NON="N",e.CODE_MORATOIRE_OUI="O",e.CODE_MORATOIRE_NON="N",e.CODE_COURRIER_RELANCE_OUI="O",e.CODE_COURRIER_RELANCE_NON="N",e.CODE_COURRIER_MISE_EN_DEMEURE_OUI="O",e.CODE_COURRIER_MISE_EN_DEMEURE_NON="N",e.CODE_PRESENCE_HISTORIQUE_OUI="O",e.CODE_PRESENCE_HISTORIQUE_NON="N",e.CODE_SMS_NON_PAIEMENT_OUI="O",e.CODE_SMS_NON_PAIEMENT_NON="N",e.CODE_SMS_ECHEANCE_OUI="O",e.CODE_SMS_ECHEANCE_NON="N",e.CODE_COMPTE_INTERNE="I",e.CODE_COMPTE_EXTERNE="E",e.CODE_ACTION_SMS="E",e.CODE_EVENEMENT_SMS_RELANCE_IMPAYE="SMSRELNP",e.CODE_EVENEMENT_SMS_ECHEANCE_A_VENIR="SMSALECV",e.INDICATEUR_CALCUL_AUTO_OUI="O",e.INDICATEUR_CALCUL_AUTO_NON="N",e.INDICATEUR_PLAN_PRELEVEMENT_OUI="O",e.INDICATEUR_PLAN_PRELEVEMENT_NON="N",e.DATE_DEFAULT="0001-01-01",e.NUMERO_COMPTE_DEFAULT=3,e.DELAI_SMS=3,e.MODE_SIMULATION="S",e.MODE_VISUALISATION="V",e.MODE_CREATION_LIEN_GARANTIE="C",e.TOP_CREATION_LIEN_HISTO_GARANTIE_OUI="O",e.TOP_CREATION_LIEN_HISTO_GARANTIE_NON="N",e.TOP_LIEN_COMPTE_GARANTIE_OUI="O",e.TOP_LIEN_COMPTE_GARANTIE_NON="N",e.ECHEANCIER_VAD_STATUT_ACTIF="A"}(t=e.Echeancier||(e.Echeancier={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";e.ETABLISSEMENT_MYSYS_TYPE_LISTE="2"}(t=e.Eds||(e.Eds={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t;!function(e){e.sansDetail="N",e.avecDetail="O",e.codeCategorieGarantieAutre="A",e.CODE_NATURE_GARANTIE_PERSONNE_PHYSIQUE="026",e.CODE_NATURE_GARANTIE_PERSONNE_MORALE="025",e.INDICATEUR_GARANTIE_EN_TAUX_OUI="O",e.INDICATEUR_GARANTIE_EN_TAUX_NON="N",e.LIBELLE_CHOIX_LISTE="Garantie",e.LIBELLE_GARANTIE_PERSONNE_PHYSIQUE="Caution personne physique",e.LIBELLE_GARANTIE_PERSONNE_MORALE="Caution personne morale",e.LIBELLE_GARANTIE_CAUTION="Caution",e.INDICATEUR_GARANTIE_ETAT_PGE_OUI="O",e.INDICATEUR_GARANTIE_ETAT_PGE_NON="N",e.CALCUL_VERSEMENT_GARANTIE_PGE="V",e.CALCUL_REMBOURSEMENT_GARANTIE_PGE="R"}(t=e.Garantie||(e.Garantie={}))}(t=e.Garantie||(e.Garantie={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){"use strict";var t;!function(e){e.superviseur="SHMXGV",e.consultation="SHMXGW",e.gestionnaire="SHMXGX",e.codeAccesConsultationPortefeuille="C",e.codeAccesGestionPortefeuille="G",e.codeAccesIdentificationPortefeuille="I",e.codeAccesTous="",e.DECOMPTES_GESTION="SHMXKD",e.DECOMPTES_CONSULTATION="SHMXKC",e.GARANTIE_GESTION="SHMXKF",e.GARANTIE_CONSULTATION="SHMXKE",e.PROVISION_GESTION="SHMXKH",e.PROVISION_CONSULTATION="SHMXKG",e.CREANCE_DOSSIER_GESTION="SHMXKI",e.CREANCE_DOSSIER_CONSULTATION="SHMXKJ",e.ACCES_EDG="SHMXKK"}(t=e.ContentieuxHabilitations||(e.ContentieuxHabilitations={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";e.CODE_ACTION_RECHERCHE_RICE=2}(t=e.Offre||(e.Offre={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){e.DATE_DEFAUT="0001-01-01",e.CODE_DEVISE_EUR="EUR",e.TYPE_PARTICIPANT="P",e.TITRE_POPUP_ERREUR_PAIEMENT="lors de l'envoi du paiement",e.MESSAGE_POPUP_ERREUR_PAIEMENT="L'envoi du paiement n'a pas pu s'exectuer correctement";var t;!function(e){e.CODE_SENS_AGGRAVATION="D",e.LIBELLE_MOUVEMENT_CREANCE_POUR_AGGRAVATION="AGGRAVATION SUITE PAIEMENT CHQ"}(t=e.AggravationNonComptable||(e.AggravationNonComptable={}));var n;!function(e){e.CODE_SENS_RECUPERATION="C",e.CODE_TYPE_ORIGINE_FLUX_RECUPERATION="1",e.CODE_TYPE_ORIGINE_FLUX_RECUPERATION_GARANTIE="D",e.INDICATEUR_EVT_DECLENCHEMENT_AUTO_RECUPERATION="O"}(n=e.Recuperation||(e.Recuperation={}));var i;!function(e){e.SANS_DETAIL="N",e.AVEC_DETAIL="O",e.TYPE_GARANTIE="G",e.CODE_ACTION_MISE_A_JOUR_GARANTIE="M",e.CODE_ACTION="C",e.CODE_TYPE_MEMO="GA",e.LIBELLE_MISE_EN_JEU_TOTALE="Mise en jeu totale",e.LIBELLE_MISE_EN_JEU_PARTIELLE="Mise en jeu partielle",e.DATE_DEFAUT="0001-01-01",e.MISE_EN_JEU_TOTALE="O",e.TOP_CREATION_LIEN_HISTO_FINANCIER_GARANTIE="O"}(i=e.Garantie||(e.Garantie={}))}(t=e.Commun||(e.Commun={}));var n;!function(e){var t;!function(e){e.NUMERO_MODELE_SMS_VALIDATION_PAIEMENT={numeroModeleSMS:3},e.TYPE_RELANCE_02="02",e.TYPE_ENVOI_RELANCE="U",e.TAILLE_MAX_SMS=160}(t=e.SMS||(e.SMS={}))}(n=e.PaiementEnLigne||(e.PaiementEnLigne={}));var i;!function(e){var t;!function(e){e.TYPE_SORTIE_ORDINAIRE="",e.CODE_TYPE_ORIGINE_FLUX_DEBITEUR="1",e.CODE_TYPE_ORIGINE_FLUX_GARANTIE="D",e.CODE_TYPE_ORIGINE_FLUX_AUTRE="7"}(t=e.PrelevementPonctuel||(e.PrelevementPonctuel={}));var n;!function(e){e.CODE_RETOUR_999=999,e.TOP_VALIDATION_MESSAGE_INFORMATION_OUI="O",e.TOP_VALIDATION_MESSAGE_INFORMATION_NON="N",e.INDICATEUR_FORCAGE_OPERATION_FALSE=!1,e.CODE_SENS_OPERATION_DEBIT="D",e.CODE_MODE_FINANCIER_VIREMENT_OPERATION_DIVERSE="00",e.CODE_INTICATEUR_ANNULATION="",e.LIBELLE_MODE_FINANCIER="VIREMENT OPERATION DIVERSE",e.CODE_FONCTIONNALITE_ORIGINE_OPE_RETRAIT="RETRAIT",e.LIBELLE_RELEVE_COMPTE_1="VIREMENT SUR CREANCE ",e.LIBELLE_RELEVE_COMPTE_2="DOSSIER ",e.EST_SIGNATAIRE_REPRESENTANT_LEGAL_FALSE=!1,e.ELIGIBILITE_SAG_FALSE=!1;var t;!function(e){e.ERREUR_FORCAGE=" lors du paiement",e.MESSAGE_ERREUR="L'envoi du paiement n'a pas pu s'exectuer correctement",e.ENTETE_CONFIRMATION_FORCAGE_CREATION_OPERATION_FINANCIERE_DEPOT_RETRAIT="Forcer la création d'une opération financière",e.TEXTE_BOUTON_OUI="Oui",e.TEXTE_BOUTON_NON="Non",e.TAILLE_MODALE_MD="md",e.CODE_RETOUR_ERREUR=0,e.CODE_RETOUR_MOTIF_PRESENT=1,e.CODE_RETOUR_MOTIF_ABSENT=2}(t=e.Forcage||(e.Forcage={}))}(n=e.OperationFinanciere||(e.OperationFinanciere={}));var i;!function(e){e.TYPE_OPERATION_DIVERSE="PPVA",e.LIBELLE_2_OPERATION_DIVERSE="",e.LIBELLE_OPERATION_DIVERSE="PRELEVEMENT PONCTUEL VARIO",e.PREFIXE_CODE_FAMILLE="  "}(i=e.OperationDiverse||(e.OperationDiverse={}))}(i=e.Prelevement||(e.Prelevement={}));var r;!function(e){e.CODE_TYPE_ORIGINE_FLUX_SURPLUS_CHEQUE="7",e.INDICATEUR_EVT_DECLENCHEMENT_AUTO_SURPLUS_CHEQUE="N";var t;!function(e){e.TYPE_OPERATION_DIVERSE="RCVA",e.LIBELLE_OPERATION_DIVERSE="CHEQUE VARIO",e.PREFIXE_CODE_FAMILLE="  ",e.CODE_MODE_APPARITION_FAMILLE="CL",e.CODE_SENS_TRANSACTION="1",e.CODE_ANNULATION_OPERATION=" ",e.MODE_FINANCIER="CHQ",e.TYPE_CHEQUE="0",e.CODE_FAMILLE_OPERATION_DIVERSE_PGE="PGE"}(t=e.OperationDiverse||(e.OperationDiverse={}))}(r=e.Cheque||(e.Cheque={}))}(t=e.Paiement||(e.Paiement={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){e.CODE_MODE_REGLEMENT_PRELEVEMENT_INTERNE="PIN",e.CODE_MODE_REGLEMENT_PRELEVEMENT_EXTERNE="PSP",e.CODE_CRITERE_TOUS="T",e.CODE_CRITERE_SELECTION="S"}(t=e.Reglement||(e.Reglement={}))}(t=e.Parametre||(e.Parametre={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){"use strict";var t;!function(e){e.ERREUR_DESIGNATION_ABSENTE="[ERREUR DU7A]"}(t=e.Participant||(e.Participant={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t;!function(e){e.mesPortefeuillesLibelle="Mes portefeuilles",e.mesPortefeuillesIdentifiant="000",e.mesPortefeuillesIdentifiantEDS=0,e.mesPortefeuillesIdentifiantEDSsuperieur=0,e.mesPortefeuillesNbDossiersActifs=0,e.mesPortefeuillesComboDebut="<span class='mesPortefeuilles'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;",e.mesPortefeuillesComboFin="</span>"}(t=e.Affichage||(e.Affichage={}))}(t=e.Portefeuille||(e.Portefeuille={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";e.listeCodeProduitServiceDNC=["P000","P001"],e.listeCodeProduitServiceNonDechuPlanApurement=["P000","P001"],e.listeCodeProduitServiceNonDechuPlanReglement=["PCTX","0004","0008"],e.listecodeProduitServicePGE=["X01258","X01454"],e.listeCodeProduitServiceDecheanceTerme=["P000"],e.creditOrigineGECCO="A",e.listeCodeProduitServiceNonAutoriseDecheanceContrat=["P000","P001","F0003"],e.decheanceTermeTypeTerme="T",e.decheanceTermeTypeRetour="R",e.decheanceTermeTypeContrat="C",e.creanceEDG="E",e.listeCodeProduitServiceEDG=["P000"],e.etiquetteEcheancier="ECHEANCIER"}(t=e.Processus||(e.Processus={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";e.etiquetteDechu="DECHU",e.etiquetteDebiteur="DEBITEUR",e.etiquetteSousSurveillance="SOUS SURVEILLANCE",e.estDechu="déchu",e.estSousTraitance="sous-traitance",e.codeDecheanceDechu=1,e.codeDecheanceActive=0;var t;!function(e){e.listeCodeProduitService=["0004"],e.libelleMontant1="SOLDE",e.libelleMontant2="AUTOR"}(t=e.CDD||(e.CDD={}));var n;!function(e){e.listeCodeProduitService=["0008"],e.codeActionSoldeMinute=1,e.codeActionSoldeDispo=2,e.codeActionSoldeDefault=3,e.libelleMontant1="SOLDE",e.libelleMontant2="AUTOR"}(n=e.CCE||(e.CCE={}));var i;!function(e){e.listeCodeProduitService=["P000","P001"],e.libelleMontant1="EXIGIBLE",e.libelleMontant2="CRD",e.libelleMontant3="GEL"}(i=e.CreditGestion||(e.CreditGestion={}));var r;!function(e){e.listeCodeProduitService=["F004","FAUR"],e.libelleMontant1="CRD",e.libelleMontant2="IMPAYE",e.codeCreditNormaux="FFI",e.codeCreditRestructure="NFI",e.libelleCreditNormaux="PPI NFI",e.libelleCreditRestructure="PPI NFI RESTR"}(r=e.CreditConso||(e.CreditConso={}));var o;!function(e){e.listeCodeProduitService=["C402","C406","0000","0001","0005","0006","0009","0010","0011","0017","0018","0020"]}(o=e.Epargne||(e.Epargne={}));var a;!function(e){e.listeCodeProduitService=["0002"]}(a=e.CompteDInstance||(e.CompteDInstance={}));var s;!function(e){e.typeRechercheEntiteTitulaire="E",e.typeRestitutionMiniProfil="M",e.libelleMontant1="SOLDE"}(s=e.MiniProfil||(e.MiniProfil={}));var u;!function(e){e.listeCodeProduitService=["PCTX"],e.libelleMontant1="SOLDE",e.libelleMontant2="AUTOR",e.listeCodeProduitServiceBilletsFinanciers=["EBF004"]}(u=e.PCTX||(e.PCTX={}))}(t=e.Solde||(e.Solde={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t;!function(e){e.listeCodeNotificationRecevabilite=["BF002","BF015","BF016"],e.listeCodeNotificationPlan=["BF004","BF005"]}(t=e.BDF||(e.BDF={}))}(t=e.Surendettement||(e.Surendettement={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";e.TABLE_DELOC_TYPES_OD_JU2B="JU2B";var t;!function(e){e.PROPRIETE_TABLE_DELOC_YNOXCE="YNOXCE",e.PROPRIETE_TABLE_DELOC_COJXHD="COJXHD",e.PROPRIETE_TABLE_DELOC_COJOFA="COJOFA"}(t=e.JU2B||(e.JU2B={}))}(t=e.TablesDelocalisees||(e.TablesDelocalisees={}))}(t=e.Constantes||(e.Constantes={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){}(t=e.Commun||(e.Commun={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){}(t=e.Dossier||(e.Dossier={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n,i,r){this.designation=e,this.idPersonne=t,this.titulaire=n,this.estPro=i,this.role=r?r:"Titulaire",this.libelle=this.role+" - "+this.designation,this.isGarantie=!1,this.infoGarantie=null}return e}();e.Participant=t}(t=e.Participant||(e.Participant={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(e,t,n,i){this.montantRevenusSalaire=e,this.montantRevenusLocatifs=t,this.montantRevenusAutres=n,this.montantCharges=i}return e}();e.PointBudget=t}(t=e.PointBudget||(e.PointBudget={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function e(e,t){this.code=ContentieuxParametrage.Constantes.Processus.processusCreance.codeGererDetail,this.libelle=ContentieuxParametrage.Constantes.Processus.processusCreance.libelleGererDetail,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusCreance.valeurDepartGererDetail,this.initData={},this.numeroDossier=e,this.identifiantCreance=t,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"numeroDossierVario",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance}]}return e}();t.ProcessusCreanceGererDetail=n;var i=function(){function e(e,t){this.code=ContentieuxParametrage.Constantes.Processus.processusCreance.codePreparerProvision,this.libelle=ContentieuxParametrage.Constantes.Processus.processusCreance.libellePreparerProvision,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusCreance.valeurDepartPreparerProvision,this.initData={},this.numeroDossier=e,this.identifiantCreance=t,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"numeroDossierVario",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance}]}return e}();t.ProcessusCreancePreparerProvision=i;var r=function(){function t(t,n,i){switch(this.code=ContentieuxParametrage.Constantes.Processus.processusCreance.codeDechoir,i){case e.Constantes.Processus.decheanceTermeTypeTerme:this.libelle=ContentieuxParametrage.Constantes.Processus.processusCreance.libelleDechoirDecheanceTerme;break;case e.Constantes.Processus.decheanceTermeTypeRetour:this.libelle=ContentieuxParametrage.Constantes.Processus.processusCreance.libelleDechoirDecheanceRetour;break;case e.Constantes.Processus.decheanceTermeTypeContrat:this.libelle=ContentieuxParametrage.Constantes.Processus.processusCreance.libelleDechoirDecheanceContrat;break;default:this.libelle="INCONNU"}this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusCreance.valeurDepartDechoir,this.initData={},this.numeroDossier=t,this.identifiantCreance=n,this.typeContrat=i,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"numeroDossierVario",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance},{Key:"typeContrat",Value:this.typeContrat}]}return t}();t.ProcessusCreanceDechoir=r;var o=function(){function e(e,t,n){this.code=ContentieuxParametrage.Constantes.Processus.processusCreance.codeDechoir,this.libelle=ContentieuxParametrage.Constantes.Processus.processusCreance.libelleEDG,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusCreance.valeurDepartDechoir,this.initData={},this.numeroDossier=e,this.identifiantCreance=t,this.typeContrat=n,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"numeroDossierVario",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance},{Key:"typeContrat",Value:this.typeContrat}]}return e}();t.ProcessusCreanceEDG=o}(n=t.Processus||(t.Processus={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n){this.code=ContentieuxParametrage.Constantes.Processus.processusDebrancherVARIO.code,this.libelle=ContentieuxParametrage.Constantes.Processus.processusDebrancherVARIO.libelleEcheancier,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusDebrancherVARIO.valeurDepart,this.initData={},this.numDossierVario=e,this.identifiantCreanceVario=t,this.ecranVario=n,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"numDossierVario",Value:this.numDossierVario},{Key:"identifiantCreanceVario",Value:this.identifiantCreanceVario},{Key:"ecranVario",Value:this.ecranVario}]}return e}();e.ProcessusDebrancherVario=t}(t=e.Processus||(e.Processus={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t){this.code=ContentieuxParametrage.Constantes.Processus.processusDossierNumeriqueCredit.code,this.libelle=ContentieuxParametrage.Constantes.Processus.processusDossierNumeriqueCredit.libelle,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusDossierNumeriqueCredit.valeurDepart,this.initData={},this.codeFournisseur=e,this.reference=t,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"CODE_FOURNISSEUR",Value:this.codeFournisseur},{Key:"REFERENCE_REGROUPEMENT",Value:this.reference}]}return e}();e.ProcessusDossierNumeriqueCredit=t}(t=e.Processus||(e.Processus={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n){this.code=ContentieuxParametrage.Constantes.Processus.processusEffectuerPaiement.code,this.libelle=ContentieuxParametrage.Constantes.Processus.processusEffectuerPaiement.libelle,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusEffectuerPaiement.valeurDepart,this.initData={},this.identifiantEntiteTitulaire=e,this.numeroDossier=t,this.identifiantCreance=n,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"identifiantEntiteTitulaire",Value:this.identifiantEntiteTitulaire},{Key:"numeroDossier",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance}]}return e}();e.ProcessusEffectuerPaiement=t}(t=e.Processus||(e.Processus={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){this.code=ContentieuxParametrage.Constantes.Processus.processusGererCreditSynchro.code,this.libelle=ContentieuxParametrage.Constantes.Processus.processusGererCreditSynchro.libelle,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusGererCreditSynchro.valeurDepart,this.initData={},this.identifiantCredit=e,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"identifiantCredit",Value:this.identifiantCredit}]}return e}();e.ProcessusGererCreditSynchro=t}(t=e.Processus||(e.Processus={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t){this.code=ContentieuxParametrage.Constantes.Processus.processusGererDecomptes.code,this.libelle=ContentieuxParametrage.Constantes.Processus.processusGererDecomptes.libelle,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusGererDecomptes.valeurDepart,this.initData={},this.numeroDossier=e,this.identifiantCreance=t,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"numeroDossierVario",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance},{Key:"topVue",Value:"C"}]}return e}();e.ProcessusGererDecomptes=t}(t=e.Processus||(e.Processus={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n,i,r){this.code=ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.code,"C"===i?this.createProcessusCreation(e,t,n):"V"===i?this.createProcessusVisualisation(e,t,n,r):"CBV"===i?this.createProcessusVisualisationCB(e,t,n,!1,r):"CBClosV"===i&&this.createProcessusVisualisationCB(e,t,n,!0,r)}return e.prototype.createProcessusCreation=function(e,t,n){this.code=ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.code,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.valeurDepartCreation,this.libelle=ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.libelleGestion,this.initData={},this.identifiantEntiteTitulaire=e,this.numeroDossier=t,this.identifiantCreance=n,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"identifiantEntiteTitulaire",Value:this.identifiantEntiteTitulaire},{Key:"numeroDossier",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance},{Key:"action",Value:ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.modeCreation}]},e.prototype.createProcessusVisualisation=function(e,t,n,i){this.code=ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.code,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.valeurDepartVisualisation,this.libelle=ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.libelleGestion,this.initData={},this.identifiantEntiteTitulaire=e,this.numeroDossier=t,this.identifiantCreance=n,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"identifiantEntiteTitulaire",Value:this.identifiantEntiteTitulaire},{Key:"numeroDossier",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance},{Key:"action",Value:ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.modeVisualisation},{Key:"typeEcheancier",Value:i}]},e.prototype.createProcessusVisualisationCB=function(e,t,n,i,r){this.code=ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.code,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.valeurDepartVisualisationCB,this.libelle=i?ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.libelleVisualisationCBCLos:ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.libelleVisualisationCB,this.initData={},this.identifiantEntiteTitulaire=e,this.numeroDossier=t,this.identifiantCreance=n,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"identifiantEntiteTitulaire",Value:this.identifiantEntiteTitulaire},{Key:"numeroDossier",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance},{Key:"action",Value:""}]},e}();e.ProcessusGererEcheancier=t}(t=e.Processus||(e.Processus={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e){this.code=ContentieuxParametrage.Constantes.Processus.processusPGE.codeConsulterDonnees,this.libelle=ContentieuxParametrage.Constantes.Processus.processusPGE.libelleConsulterDonnees,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusPGE.valeurDepartConsulterDonnees,this.initData={},this.identifiantCredit=e,
this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"identifiantCredit",Value:this.identifiantCredit}]}return e}();e.ProcessusPGEConsulterDonnees=t;var n=function(){function e(e){this.code=ContentieuxParametrage.Constantes.Processus.processusPGE.codeSaisieProvisionnel,this.libelle=ContentieuxParametrage.Constantes.Processus.processusPGE.libelleSaisieProvisionnel,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusPGE.valeurDepartSaisieProvisionnel,this.initData={},this.identifiantCredit=e,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"identifiantCredit",Value:this.identifiantCredit}]}return e}();e.ProcessusPGESaisieProvisionnel=n;var i=function(){function e(e,t,n,i){this.code=ContentieuxParametrage.Constantes.Processus.processusPGE.codeMejGarantie,this.libelle=ContentieuxParametrage.Constantes.Processus.processusPGE.libelleMejGarantie,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusPGE.valeurDepartMejGarantie,this.initData={},this.identifiantEntiteTitulaire=e,this.numeroDossier=t,this.identifiantCreance=n,this.identifiantCredit=i,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"identifiantEntiteTitulaire",Value:this.identifiantEntiteTitulaire},{Key:"numeroDossier",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance},{Key:"identifiantCredit",Value:this.identifiantCredit}]}return e}();e.ProcessusPGEGarantie=i;var r=function(){function e(e,t,n,i){this.code=ContentieuxParametrage.Constantes.Processus.processusPGE.codeMejGarantie,this.libelle=ContentieuxParametrage.Constantes.Processus.processusPGE.libelleMejGarantieVisualisation,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusPGE.valeurDepartMejGarantieVisualisation,this.initData={},this.identifiantEntiteTitulaire=e,this.numeroDossier=t,this.identifiantCreance=n,this.identifiantCredit=i,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"identifiantEntiteTitulaire",Value:this.identifiantEntiteTitulaire},{Key:"numeroDossier",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance},{Key:"identifiantCredit",Value:this.identifiantCredit}]}return e}();e.ProcessusPGEGarantieVisualisation=r}(t=e.Processus||(e.Processus={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t){this.code=ContentieuxParametrage.Constantes.Processus.processusSuivreGarantiesCreance.codeListerGaranties,this.libelle=ContentieuxParametrage.Constantes.Processus.processusSuivreGarantiesCreance.libelleListerGaranties,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusSuivreGarantiesCreance.valeurDepartListerGaranties,this.initData={},this.numeroDossier=e,this.identifiantCreance=t,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"numeroDossierVario",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance}]}return e}();e.ProcessusSuivreGarantiesCreance=t;var n=function(){function e(e,t,n){this.code=ContentieuxParametrage.Constantes.Processus.processusSuivreGarantiesCreance.codeGererGarantieCreance,this.libelle=ContentieuxParametrage.Constantes.Processus.processusSuivreGarantiesCreance.libelleGererGarantieCreance,this.valeurDepart=ContentieuxParametrage.Constantes.Processus.processusSuivreGarantiesCreance.valeurDepartGererGarantieCreance,this.initData={},this.numeroDossier=e,this.identifiantCreance=t,this.identifiantGarantie=n,this.initData.displayName=this.libelle,this.initData.contextArray=[{Key:"numeroDossierVario",Value:this.numeroDossier},{Key:"identifiantCreance",Value:this.identifiantCreance},{Key:"identifiantGarantie",Value:this.identifiantGarantie},{Key:"topAcces",Value:"2"}]}return e}();e.ProcessusGererGarantiesCreance=n}(t=e.Processus||(e.Processus={}))}(t=e.Modeles||(e.Modeles={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n,i){this.serviceAgent=e,this.alerteRestService=t,this.entitetitulaireService=n,this.$q=i}return t.prototype.getActionsPlanifiees=function(e,t){var n,i=this;return this.serviceAgent.getAuthentificationInfo().then(function(e){return n=e.codeEtablissement,i.alerteRestService.getActionsPlanifiees(e.codeEtablissement,parseInt(t))}).then(function(t){var n=_.map(t,function(e){return parseInt(e.identifiantEntiteTitulaire)}),r={listeInterrogationDesignation:_.map(n,function(t){return{codeEtablissement:e,numeroEntiteTitulaire:t}})};return i.$q.all([i.entitetitulaireService.getEntitesTitulairesDesignation(r),i.$q.when(t)])}).then(function(e){var t=e[0],n=e[1];return _.map(n,function(e){return{numeroDossier:e.numeroDossier,dateEvenement:e.dateAlerte,portefeuille:e.portefeuille,identifiantEntiteTitulaire:e.identifiantEntiteTitulaire,entiteTitulaire:_.find(t,function(t){return t.identifiantEntiteTitulaire===parseInt(e.identifiantEntiteTitulaire)}),libelle:e.libelleAlerte,commentaire:e.commentaire,prioriteAlerte:e.prioriteAlerte}})})},t.$inject=[ContentieuxCommun.Constantes.Inject.MyWay.serviceAgentExtended,Contentieux.RestServices.Commun.Constantes.Inject.Service.alerteService,e.Constantes.Inject.Services.entiteTitulaireService,"$q"],t}();t.ActionPlanifieeService=n,e.app.service(e.Constantes.Inject.Services.actionPlanifieeService,n)}(n=t.Agenda||(t.Agenda={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Agenda||(e.Agenda={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n,i,r){this.serviceAgent=e,this.alerteRestService=t,this.entitetitulaireService=n,this.garantieService=i,this.$q=r}return t.prototype.getAlertesAffectations=function(e,t){var n=this;return this.alerteRestService.getAlertesAffectations(e,parseInt(t)).then(function(t){var i=_.map(t,function(e){return parseInt(e.identifiantEntiteTitulaire)}),r={listeInterrogationDesignation:_.map(i,function(t){return{codeEtablissement:e,numeroEntiteTitulaire:t}})};return n.$q.all([n.entitetitulaireService.getEntitesTitulairesDesignation(r),n.$q.when(t)])}).then(function(t){var i=_.chain(t[1]).map(function(e){return e.numeroPersonneGarantie}).compact().uniq().value(),r=_.map(i,function(t){return{codeEtablissement:e,numeroPersonne:t}}),o={listeInterrogationDesignation:r};return n.$q.all([i.length?n.garantieService.getListeGarantiesPersonnesMorales(o):n.$q.when(null),n.$q.when(t[0]),n.$q.when(t[1])])}).then(function(e){var t=e[0],n=e[1],i=e[2];return _.map(i,function(e){return{numeroDossier:e.numeroDossier,dateEvenement:e.dateAffectation,portefeuille:e.portefeuille,identifiantEntiteTitulaire:e.identifiantEntiteTitulaire,entiteTitulaire:_.find(n,function(t){return t.identifiantEntiteTitulaire===parseInt(e.identifiantEntiteTitulaire)}),montantTotal:e.montantTotal,montantExigible:e.exigible,motif:e.motif,numeroPersonneGarantie:e.numeroPersonneGarantie,garantiePersonneMorale:_.find(t,function(t){return t.numeroPersonneGarantie===e.numeroPersonneGarantie})}})})},t.prototype.getAlertesProceduresCollectives=function(e,t){var n=this;return this.alerteRestService.getAlertesProceduresCollectives(e,parseInt(t)).then(function(t){var i=_.map(t,function(e){return parseInt(e.identifiantEntiteTitulaire)}),r={listeInterrogationDesignation:_.map(i,function(t){return{codeEtablissement:e,numeroEntiteTitulaire:t}})};return n.$q.all([n.entitetitulaireService.getEntitesTitulairesDesignation(r),n.$q.when(t)])}).then(function(t){var i=_.chain(t[1]).map(function(e){return e.numeroPersonneGarantie}).compact().uniq().value(),r={listeInterrogationDesignation:_.map(i,function(t){return{codeEtablissement:e,numeroPersonne:t}})};return n.$q.all([i.length?n.garantieService.getListeGarantiesPersonnesMorales(r):n.$q.when(null),n.$q.when(t[0]),n.$q.when(t[1])])}).then(function(e){var t=e[0],n=e[1],i=e[2];return _.map(i,function(e){return{numeroDossier:e.numeroDossier,dateEvenement:e.dateAlerte,portefeuille:e.portefeuille,identifiantEntiteTitulaire:e.identifiantEntiteTitulaire,entiteTitulaire:_.find(n,function(t){return t.identifiantEntiteTitulaire===parseInt(e.identifiantEntiteTitulaire)}),libelleAlerte:e.libelleAlerte,montantTotal:e.montantTotal,montantExigible:e.exigible,motif:e.motif,numeroPersonneGarantie:e.numeroPersonneGarantie,garantiePersonneMorale:_.find(t,function(t){return t.numeroPersonneGarantie===e.numeroPersonneGarantie})}})})},t.prototype.getAlertesSurendettement=function(e,t){var n=this;return this.alerteRestService.getAlertesSurendettement(e,parseInt(t)).then(function(t){var i=_.map(t,function(e){return parseInt(e.identifiantEntiteTitulaire)}),r={listeInterrogationDesignation:_.map(i,function(t){return{codeEtablissement:e,numeroEntiteTitulaire:t}})};return n.$q.all([n.entitetitulaireService.getEntitesTitulairesDesignation(r),n.$q.when(t)])}).then(function(e){var t=e[0],n=e[1];return _.map(n,function(e){return{numeroDossier:e.numeroDossier,dateEvenement:e.dateAlerte,portefeuille:e.portefeuille,identifiantEntiteTitulaire:e.identifiantEntiteTitulaire,entiteTitulaire:_.find(t,function(t){return t.identifiantEntiteTitulaire===parseInt(e.identifiantEntiteTitulaire)}),libelleAlerte:e.libelleAlerte,motifRejet:e.motifRejet}})})},t.prototype.getAlertesEcheanciers=function(t,n){var i=this;return this.alerteRestService.getAlertesEcheanciers(t,parseInt(n)).then(function(e){var n=_.map(e,function(e){return parseInt(e.identifiantEntiteTitulaire)}),r={listeInterrogationDesignation:_.map(n,function(e){return{codeEtablissement:t,numeroEntiteTitulaire:e}})};return i.$q.all([i.entitetitulaireService.getEntitesTitulairesDesignation(r),i.$q.when(e)])}).then(function(e){var n=_.chain(e[1]).map(function(e){return e.numeroPersonneGarantie}).compact().uniq().value(),r={listeInterrogationDesignation:_.map(n,function(e){return{codeEtablissement:t,numeroPersonne:e}})};return i.$q.all([n.length?i.garantieService.getListeGarantiesPersonnesMorales(r):i.$q.when(null),i.$q.when(e[0]),i.$q.when(e[1])])}).then(function(t){var n=t[0],i=t[1],r=t[2];return _.map(r,function(t){return{numeroDossier:t.numeroDossier,dateEvenement:t.dateAlerte,portefeuille:t.portefeuille,identifiantEntiteTitulaire:t.identifiantEntiteTitulaire,entiteTitulaire:_.find(i,function(e){return e.identifiantEntiteTitulaire===parseInt(t.identifiantEntiteTitulaire)}),libelleAlerte:t.libelleAlerte,nombreAlertesDossier:t.nombreAlerteDossier,libelleAlertePourListe:1===t.nombreAlerteDossier?t.libelleAlerte:e.Constantes.Agenda.NoteAlerte.libellePlusieursAlertesSurDossier,numeroPersonneGarantie:t.numeroPersonneGarantie,garantiePersonneMorale:_.find(n,function(e){return e.numeroPersonneGarantie===t.numeroPersonneGarantie})}})})},t.prototype.validerAlerte=function(e){var t={codeAgent:e.donneesDossierEvenementAgenda.codeAgent,codeEtablissement:e.donneesDossierEvenementAgenda.codeEtablissement,codeEtape:e.codeEtape,codeProcedure:e.codeProcedure,codeSousTypeEvenement:e.codeSousTypeEvenement,codeTypeEvenement:e.codeTypeEvenement,codeValidationNote:e.codeValidationNote,dateEvenement:e.dateEvenement,identifiantCreance:e.donneesContratEvenementAgenda.identifiantCreance,identifiantPortefeuille:e.donneesDossierEvenementAgenda.identifiantPortefeuille,numeroDossier:e.donneesDossierEvenementAgenda.numeroDossier,numeroEvenementSousType:e.numeroSousTypeEvenement,codeAction:e.codeAction,ancienSousTypeEvenement:e.codeSousTypeEvenement,libelleEvenement:e.commentaire,indicateurPresenceDetail:e.indicateurPresenceDetail,numeroPriorite:e.numeroPriorite};return this.alerteRestService.putAlerte(t)},t.prototype.supprimerAlerte=function(e){var t={codeEtablissement:e.donneesDossierEvenementAgenda.codeEtablissement,identifiantPortefeuille:e.donneesDossierEvenementAgenda.identifiantPortefeuille,codeTypeEvenement:e.codeTypeEvenement,codeSousTypeEvenement:e.codeSousTypeEvenement,dateEvenement:e.dateEvenement,numeroSousTypeEvenement:e.numeroSousTypeEvenement};return this.alerteRestService.deleteAlerte(t)},t.prototype.afficherAlerte=function(e){var t={codeAction:e.codeAction,codeAgent:e.donneesDossierEvenementAgenda.codeAgent,codeEtablissement:e.donneesDossierEvenementAgenda.codeEtablissement,codeEtape:null,codeProcedure:null,codeSousTypeEvenement:e.codeSousTypeEvenement,codeTypeEvenement:e.codeTypeEvenement,codeValidationNote:null,dateEvenement:e.dateEvenement,identifiantCreance:e.donneesContratEvenementAgenda.identifiantCreance,identifiantPortefeuille:e.donneesDossierEvenementAgenda.identifiantPortefeuille,numeroDossier:e.donneesDossierEvenementAgenda.numeroDossier,numeroEvenementSousType:e.numeroSousTypeEvenement,ancienSousTypeEvenement:e.codeSousTypeEvenement,libelleEvenement:e.commentaire,indicateurPresenceDetail:e.indicateurPresenceDetail,numeroPriorite:e.numeroPriorite};return this.alerteRestService.postAlerte(t)},t.prototype.modifierAlerte=function(e){var t={codeAgent:e.donneesDossierEvenementAgenda.codeAgent,codeEtablissement:e.donneesDossierEvenementAgenda.codeEtablissement,codeEtape:e.codeEtape,codeProcedure:e.codeProcedure,codeSousTypeEvenement:e.codeSousTypeEvenement,codeTypeEvenement:e.codeTypeEvenement,codeValidationNote:e.codeValidationNote,dateEvenement:e.dateEvenement,identifiantCreance:e.donneesContratEvenementAgenda.identifiantCreance,identifiantPortefeuille:e.donneesDossierEvenementAgenda.identifiantPortefeuille,numeroDossier:e.donneesDossierEvenementAgenda.numeroDossier,numeroEvenementSousType:e.numeroSousTypeEvenement,codeAction:e.codeAction,ancienSousTypeEvenement:e.codeSousTypeEvenement,libelleEvenement:e.commentaire,indicateurPresenceDetail:e.indicateurPresenceDetail,numeroPriorite:e.numeroPriorite};return this.alerteRestService.putAlerte(t)},t.$inject=[ContentieuxCommun.Constantes.Inject.MyWay.serviceAgentExtended,Contentieux.RestServices.Commun.Constantes.Inject.Service.alerteService,e.Constantes.Inject.Services.entiteTitulaireService,e.Constantes.Inject.Services.garantieService,"$q"],t}();t.NoteAlerteService=n,e.app.service(e.Constantes.Inject.Services.noteAlerteService,n)}(n=t.Agenda||(t.Agenda={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n,i){this.$q=e,this.creanceRestService=t,this.$filter=n,this.cacheService=i}return t.prototype.getParametreReglement=function(){var t=this;return this.cacheService.get("ParametreReglement",function(){return t.creanceRestService.getParametreReglement(e.Constantes.Parametre.Reglement.CODE_CRITERE_TOUS,"").then(function(e){var t=_.map(e,function(e){return{codeModeReglement:e.codeModeReglement,dateReglement:ContentieuxCommun.Tools.DateUtils.parse(e.dateReglement),delaisExecutionModeReglement:e.delaisExecutionModeReglement,libelleCourtModeReglement:e.libelleCourtModeReglement,libelleLongModeReglement:e.libelleLongModeReglement}});return t})},this.cacheService.defaultTimeToLiveDay,!0)},t.prototype.getDateReglement=function(e){return this.getParametreReglement().then(function(t){var n=_.first(_.filter(t,function(t){return t.codeModeReglement===e}));return n.dateReglement})},t.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,Contentieux.RestServices.Commun.Constantes.Inject.Service.creanceParametre,e.Constantes.Inject.Angular.$filter,e.Constantes.Inject.Services.cacheService],t}();t.CreanceParametreService=n,e.app.service(e.Constantes.Inject.Services.creanceParametre,n)}(n=t.Creance||(t.Creance={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n,i){this.$q=e,this.creanceRestService=t,this.$filter=n,this.cacheService=i}return t.prototype.getListeComptesSupport=function(e,t){var n=this;return this.creanceRestService.getComptesSupport(e,t).then(function(e){var t=_.map(e,function(e){return{bic:e.bic,codeEtablissement:e.codeEtablissement,iban:e.iban,identifiantCreance:e.identifiantCreance,ordre:e.numeroOrdreCompteCre,libelleAffichage:n.formate(e.bic,e.iban)}});return t})},t.prototype.getListeEcheanciersClosVAD=function(t,n){return this.creanceRestService.getEcheancierVAD(t,n).then(function(t){var n;return n=_.filter(t,function(t){return t.codeStatut!==e.Constantes.Echeancier.ECHEANCIER_VAD_STATUT_ACTIF}),n.length})["catch"](function(){return 0})},t.prototype.formate=function(e,t){var n=this.$filter("ibanFilter")(t);return e+" / "+n},t.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,Contentieux.RestServices.Commun.Constantes.Inject.Service.creanceService,e.Constantes.Inject.Angular.$filter,e.Constantes.Inject.Services.cacheService],t}();t.CreanceService=n,e.app.service(e.Constantes.Inject.Services.creanceService,n)}(n=t.Creance||(t.Creance={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Creance||(e.Creance={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Creance||(e.Creance={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t){this.$q=e,this.logger=t,this.cache={}}return Object.defineProperty(t.prototype,"defaultTimeToLive",{get:function(){return 9e5},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"defaultTimeToLiveDay",{get:function(){return 288e5},enumerable:!0,configurable:!0}),t.prototype.setToCache=function(e,t,n){if(e&&!_.isUndefined(t)){var i={data:t,timeToLive:n,instantiatedTime:performance.now()};this.cache[e]=i}},t.prototype.setToCacheFromPromise=function(e,t,n){var i=this;return t.then(function(t){return i.setToCache(e,t,n),t})},t.prototype.getFromCache=function(e){return _.isUndefined(this.cache[e])?void 0:this.isExpired(this.cache[e])?void delete this.cache[e]:this.cache[e].data},t.prototype.get=function(e,t,n,i){void 0===i&&(i=!0);var r=this.getFromCache(e);return!_.isUndefined(r)&&i?(this.logger.debug("'key: "+e+"' : resolving result from cache"),this.$q.when(r)):this.setToCacheFromPromise(e,t(),n)},t.prototype.set=function(e,t,n){this.setToCache(e,t,n)},t.prototype.isExpired=function(e){return-1===e.timeToLive?!1:e.instantiatedTime+e.timeToLive<performance.now()},t.$inject=[e.Constantes.Inject.Angular.$q,e.Constantes.Inject.Logger.applicationLoggerName],t}();t.CacheService=n,e.app.service(e.Constantes.Inject.Services.cacheService,n)}(n=t.Commun||(t.Commun={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function e(e,t){this.$q=e,this.operationFinanciereRestService=t}return e.prototype.getBic=function(e,t,n,i){return this.operationFinanciereRestService.getBicIban(e,t,n,+i).then(function(e){var t={bic:e.codeBic};return t})},e.prototype.getIban=function(e,t,n,i){return this.operationFinanciereRestService.getBicIban(e,t,n,+i).then(function(e){var t={iban:e.numeroIbanCompteBeneficiaire};return t})},e.prototype.getBicIban=function(e,t,n,i){return this.operationFinanciereRestService.getBicIban(e,t,n,+i).then(function(e){var t={bic:{bic:e.codeBic},iban:{iban:e.numeroIbanCompteBeneficiaire}};return t})},e.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,Contentieux.RestServices.Commun.Constantes.Inject.Service.operationFinanciereService],e}();t.CommunService=n,e.app.service(e.Constantes.Inject.Services.communService,n)}(n=t.Commun||(t.Commun={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Commun||(e.Commun={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Commun||(e.Commun={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n,i){this.dossierRestService=e,this.$q=t,this.entiteTitulaireService=n,this.garantieService=i}return t.prototype.getDossiersActifsPortefeuille=function(e,t){var n=this;return this.dossierRestService.getDossiersActifsPortefeuille(e,t).then(function(t){var i=t.dossiers,r=_.map(i,function(e){return parseInt(e.identifiantEntiteTitulaire)}),o={listeInterrogationDesignation:_.map(r,function(t){return{codeEtablissement:e,numeroEntiteTitulaire:t}})};return n.$q.all([n.entiteTitulaireService.getEntitesTitulairesDesignation(o),n.$q.when(i)])}).then(function(t){var i=_.chain(t[1]).map(function(e){return e.numeroPersonneGarantie}).compact().uniq().value(),r={listeInterrogationDesignation:_.map(i,function(t){return{codeEtablissement:e,numeroPersonne:t}})};return n.$q.all([i.length?n.garantieService.getListeGarantiesPersonnesMorales(r):n.$q.when(null),n.$q.when(t[0]),n.$q.when(t[1])])}).then(function(e){var n=e[0],i=e[1],r=e[2];return _.map(r,function(e){return{dateAffectation:e.dateAffectation,numeroDossier:e.numeroDossier,identifiantEntiteTitulaire:e.identifiantEntiteTitulaire,portefeuille:e.portefeuille,identifiantPortefeuille:t,motif:e.motif,exigible:e.exigible,montantTotal:e.montantTotal,montantGel:e.montantGel,montantPerteRecouvrable:e.montantPerteRecouvrable,nombreCreances:e.nombreCreance,montantDecouvert:e.montantDecouvert,numeroPersonneGarantie:e.numeroPersonneGarantie,entiteTitulaire:_.find(i,function(t){return t.identifiantEntiteTitulaire===parseInt(e.identifiantEntiteTitulaire)}),garantiePersonneMorale:_.find(n,function(t){return t.numeroPersonneGarantie===e.numeroPersonneGarantie})}})})},t.prototype.isDossierSurendettement=function(t,n,i){var r=[];return r.push(n),this.dossierRestService.getDossiers(t,r).then(function(t){var n=_.first(_.filter(t.dossierET,function(e){return e.numeroDossier.toString()===i}));return n.etiquette===e.Constantes.Dossier.Etiquette.ETIQUETTE_SURENDETTEMENT})},t.prototype.getIdentifiantPortefeuille=function(e,t,n){var i=[];return i.push(t),this.dossierRestService.getDossiers(e,i).then(function(e){var t=_.first(_.filter(e.dossierET,function(e){return e.numeroDossier.toString()===n}));return t.identifiantPortefeuille})},t.prototype.getCodeMotif=function(e,t,n){var i=[];return i.push(t),this.dossierRestService.getDossiers(e,i).then(function(e){var t=_.first(_.filter(e.dossierET,function(e){return e.numeroDossier.toString()===n}));return t.codeFamille})},t.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Service.dossierService,ContentieuxCommun.Constantes.Inject.Angular.$q,e.Constantes.Inject.Services.entiteTitulaireService,e.Constantes.Inject.Services.garantieService],t}();t.DossierService=n,e.app.service(e.Constantes.Inject.Services.dossierService,n)}(n=t.Dossier||(t.Dossier={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n,i,r,o,a,s,u,c){this.dossierRestService=e,this.creanceRestService=t,this.serviceAgent=n,this.$q=i,this.entiteTitulaireService=r,this.cacheService=o,this.logger=a,this.soldeService=s,this.offreRestService=u,this.garantieService=c}return t.prototype.getDossiersSynthese=function(e,t){var n=this;return this.logger.debug("DossierSyntheseService getDossiersSynthese (idPersonne: "+t),this.entiteTitulaireService.getEntitesTitulairesFromIdPersonne(e,t,!0).then(function(t){return n.$q.all([n.dossierRestService.getDossiers(e,_.map(t,function(e){return n.extractIdEntiteTitulaire(e).toString()})),n.entiteTitulaireService.getEntitesTitulaires(e,_.map(t,function(e){return parseInt(n.extractIdEntiteTitulaire(e))})),n.$q.when(t)])}).then(function(e){return n.createDossierSynthese(e[0],e[1],e[2])})},t.prototype.createDossierSynthese=function(t,n,i){return _.map(t.dossierET,function(t){var r,o,a=parseInt(t.identifiantEntiteTitulaire||"0");r=ContentieuxCommun.Tools.ObjectUtils.nullToEmpty(_.find(i,function(e){return e.identifiantEntiteTitulaire===a})),o=ContentieuxCommun.Tools.ObjectUtils.nullToEmpty(_.find(n,function(e){return e.identifiantEntiteTitulaire===a}));var s={typeUsageEntiteTitulaire:ContentieuxCommun.Metier.EntiteTitulaireUtils.getLibelleTypeUsageEntiteTitulaire(r.codeUsage,r.modeComposition,r.modeCompositionIndivision),gerePar:o.gerePar,domiciliation:o.domiciliation,numeroDossier:t.numeroDossier,statutDossierConsultable:t.statutDossierConsultable,etiquette:t.etiquette,identifiantPortefeuille:t.identifiantPortefeuille,idEDSGerePar:o.idGerePar};return t.statutDossierConsultable===ContentieuxParametrage.Constantes.Dossier.consultable||t.statutDossierConsultable===ContentieuxParametrage.Constantes.Dossier.consultableDesarchive?(s.montantTotal=t.montantTotal,s.exigible=t.exigible,s.portefeuille=t.portefeuille,s.identifiantEntiteTitulaire=t.identifiantEntiteTitulaire,s.cedeA=t.cedeA,s.motif=t.motif,s.dateCession=t.dateCession,s.dateClotureDossier=t.dateCloture,s.etiquette===e.Constantes.Dossier.Etiquette.ETIQUETTE_CEDE?s.etiquette=s.etiquette.concat(e.Constantes.Dossier.Etiquette.ETIQUETTE_LIEN_ETAT_DATE,moment(t.dateCession).format(ContentieuxCommun.Constantes.Generique.formatDate)):s.etiquette===e.Constantes.Dossier.Etiquette.ETIQUETTE_CLOTURE&&(s.etiquette=s.etiquette.concat(e.Constantes.Dossier.Etiquette.ETIQUETTE_LIEN_ETAT_DATE,moment(t.dateCloture).format(ContentieuxCommun.Constantes.Generique.formatDate)))):(s.dateBlocageConsultation=t.dateBlocageConsultation,s.dateSuppressionPrevisionelle=t.dateSuppressionPrevisionelle,s.etiquette=s.etiquette.concat(e.Constantes.Dossier.Etiquette.ETIQUETTE_LIEN_ETAT_DATE,moment(t.dateBlocageConsultation).format(ContentieuxCommun.Constantes.Generique.formatDate))),s})},t.prototype.getDossierRecherche=function(e,t){return this.dossierRestService.getIdET(e,t).then(function(e){return{codeStatutDossier:e.codeStatutDossier,dateBlocageConsultation:e.dateDeBlocageConsultationPrevis,dateClotureDossier:e.dateClotureDossierCreance,dateSuppressionPrevisionelle:e.dateSuppressionPrevisionelle,identifiantEntiteTitulaire:e.identifiantEntiteTitulaire,numeroDossier:e.numeroDossierContentieux,identifiantPortefeuille:e.identifiantPortefeuille}})},t.prototype.getDossierRechercheEtParticipants=function(e,t){var n=this;return this.getDossierRecherche(e,t).then(function(t){return t&&t.codeStatutDossier!==ContentieuxParametrage.Constantes.Dossier.etatDossierArchive?n.$q.all([n.$q.when(t),n.entiteTitulaireService.getParticipants(e,_.parseInt(t.identifiantEntiteTitulaire))]):n.$q.all([n.$q.when(t),null])})},t.prototype.getInfosDossierHisto=function(e,t,n,i){var r=this;return void 0===i&&(i=!1),this.cacheService.get("DossierSyntheseService-getInfosDossierHisto"+t+n,function(){return r.dossierRestService.getInfosDossierHisto(e,t,!1,n).then(function(e){return{listeEvenementsATraiter:_.map(e.evenementATraiter,function(e){return r.mappingEvenementCalendrier(e)}),listeEvenementsRealises:_.map(e.evenementRealises,function(e){return r.mappingEvenementRealise(e)}),listeEvenementsFuturs:_.map(e.evenementFutur,function(e){return r.mappingEvenementCalendrier(e)})}})},this.cacheService.defaultTimeToLive,i)},t.prototype.getContratsVario=function(t,n,i,r,o){var a=this;void 0===o&&(o=!1);var s=[],u=[];return this.cacheService.get("DossierSyntheseService-getContratsVario"+n,function(){return a.creanceRestService.getCaracteristique(t,n,parseInt(i)).then(function(i){return _.each(i.listeCreance,function(i){var o={codeEtablissement:t,nature:i.nature,reference:i.reference,etiquetteContrat:i.etiquetteContrat,dettes:i.dettes,etatEcheancier:i.etatEcheancier,dateDefaillance:i.codeEtatGestionSousTraitance===ContentieuxParametrage.Constantes.ContentieuxMetier.ContentieuxSousTraitance.CODE_ENVOYE_SOUS_TRAITANT?i.dateDebutLien:ContentieuxCommun.Metier.ContratUtils.isDechu(i.codeDecheanceDuTerme)?i.dateDecheanceTerme:i.dateDefaillance,topSynchro:"O"===i.topSynchro,dateRegularisation:i.dateRegularisation,identifiantContrat:i.identifiantContrat,identifiantCreance:i.identifiantCreance,codeActiviteCreance:i.codeActiviteCreance,codeDecheanceDuTerme:i.codeDecheanceDuTerme,codePassageCreditStatutDouteux:i.codePassageCreditStatutDouteux,codeGuichetInterbancaire:i.codeGuichetInterbancaire,codeOrigineCreditDossier:i.codeOrigineCreditDossier,mtProvisionIFRS:0,nombreGarantie:i.nombreGarantie,topSolde:"O"===i.topSolde,libelleTypeContrat:i.libelleTypeContrat,codeTypeProduitService:i.codeTypeProduitService,isContratMysys:!1,montantMySysAfficheLigne1:null,montantMySysAfficheLigne2:null,topDNC:i.identifiantDossierInstruction?!0:!1,identifiantDossierInstruction:i.identifiantDossierInstruction,tauxActualisationCRC:i.tauxActualisationCRC,tauxActualisationIFRS:i.tauxActualisationIFRS,tauxPenaliteRetard:i.tauxPenaliteRetard,typeEcheancier:a.getTypeEcheancier(i.typeEcheancier),detailCredit:a.mappeDetailCredit(i.detailCredit),codeProduitService:i.codeProduitService,indicateurPerteIrrecouvrable:ContentieuxCommun.Metier.ContratUtils.isPerteIrrecouvrable(i.indicateurPerteRecouvrable)},c=a.getCodeEtatCreance(i.codeActiviteCreance,i.codeDecheanceDuTerme,i.codePassageCreditStatutDouteux);a.isProduitSpecifique(e.Constantes.Solde.PCTX.listeCodeProduitService,i.codeTypeProduitService)&&-1!==e.Constantes.Solde.PCTX.listeCodeProduitServiceBilletsFinanciers.indexOf(i.codeProduitService)&&(o.montantMySysAfficheLigne1={type:e.Constantes.Solde.PCTX.libelleMontant2,montant:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(i.montantOrigine),codeDevise:"EUR"},o.montantMySysAfficheLigne2={type:e.Constantes.Solde.PCTX.libelleMontant1,montant:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(i.soldeActualise),codeDevise:"EUR"}),s.push(a.affecterMontantIFRS(o,c).then(function(e){return o=e,a.affecterMontantMySysContratTuile(o).then(function(e){return o=e,o.etiquetteContrat=o.indicateurPerteIrrecouvrable&&o.etiquetteContrat===ContentieuxParametrage.Constantes.ContentieuxMetier.etiquetteRegularise?ContentieuxParametrage.Constantes.ContentieuxMetier.etiquettePerteIrrecouvrable:o.etiquetteContrat,a.miseAJourLibelleCCE(o,r).then(function(e){return o=e,a.affecterIdentifiantProduitService(o).then(function(e){return o=e,a.affecterGarantiePGE(o,n).then(function(e){o=e})})})})})["finally"](function(){u.push(o)}))}),a.$q.all(s).then(function(){return u})})},this.cacheService.defaultTimeToLive,o)},t.prototype.getContratsVarioNonDechusLeves=function(e,t,n,i,r){var o=this;void 0===r&&(r=!1);var a=[],s=[];return this.cacheService.get("DossierSyntheseService-getContratsVario"+t,function(){return o.creanceRestService.getCaracteristiqueNonDechusLeves(e,t,parseInt(n)).then(function(n){return _.each(n.listeCreance,function(n){var r={codeEtablissement:e,nature:n.nature,reference:n.reference,etiquetteContrat:n.etiquetteContrat,dettes:n.dettes,etatEcheancier:n.etatEcheancier,dateDefaillance:n.codeEtatGestionSousTraitance===ContentieuxParametrage.Constantes.ContentieuxMetier.ContentieuxSousTraitance.CODE_ENVOYE_SOUS_TRAITANT?n.dateDebutLien:ContentieuxCommun.Metier.ContratUtils.isDechu(n.codeDecheanceDuTerme)?n.dateDecheanceTerme:n.dateDefaillance,topSynchro:"O"===n.topSynchro,dateRegularisation:n.dateRegularisation,identifiantContrat:n.identifiantContrat,identifiantCreance:n.identifiantCreance,codeActiviteCreance:n.codeActiviteCreance,codeDecheanceDuTerme:n.codeDecheanceDuTerme,codePassageCreditStatutDouteux:n.codePassageCreditStatutDouteux,
codeGuichetInterbancaire:n.codeGuichetInterbancaire,codeOrigineCreditDossier:n.codeOrigineCreditDossier,mtProvisionIFRS:0,nombreGarantie:n.nombreGarantie,topSolde:"O"===n.topSolde,libelleTypeContrat:n.libelleTypeContrat,codeTypeProduitService:n.codeTypeProduitService,isContratMysys:!1,montantMySysAfficheLigne1:null,montantMySysAfficheLigne2:null,topDNC:n.identifiantDossierInstruction?!0:!1,identifiantDossierInstruction:n.identifiantDossierInstruction,tauxActualisationCRC:n.tauxActualisationCRC,tauxActualisationIFRS:n.tauxActualisationIFRS,tauxPenaliteRetard:n.tauxPenaliteRetard,typeEcheancier:o.getTypeEcheancier(n.typeEcheancier),detailCredit:o.mappeDetailCredit(n.detailCredit),codeProduitService:n.codeProduitService,indicateurPerteIrrecouvrable:ContentieuxCommun.Metier.ContratUtils.isPerteIrrecouvrable(n.indicateurPerteRecouvrable)},u=o.getCodeEtatCreance(n.codeActiviteCreance,n.codeDecheanceDuTerme,n.codePassageCreditStatutDouteux);a.push(o.affecterMontantIFRS(r,u).then(function(e){return r=e,o.affecterMontantMySysContratTuile(r).then(function(e){return r=e,r.etiquetteContrat=r.indicateurPerteIrrecouvrable&&r.etiquetteContrat===ContentieuxParametrage.Constantes.ContentieuxMetier.etiquetteRegularise?ContentieuxParametrage.Constantes.ContentieuxMetier.etiquettePerteIrrecouvrable:r.etiquetteContrat,o.miseAJourLibelleCCE(r,i).then(function(e){return r=e,o.affecterIdentifiantProduitService(r).then(function(e){return r=e,o.affecterGarantiePGE(r,t).then(function(e){r=e})})})})})["finally"](function(){s.push(r)}))}),o.$q.all(a).then(function(){return s})})},this.cacheService.defaultTimeToLive,r)},t.prototype.getContratsMySys=function(e,t,n){var i=this;return void 0===n&&(n=!1),this.cacheService.get("DossierSyntheseService-getContratsMySys"+t,function(){return i.dossierRestService.getContratsMySys(e,t,!0).then(function(n){return i.soldeService.getSyntheseMiniProfilParEntiteTitulaire(e,parseInt(t)).then(function(e){var t=_.map(n.listeContrats,function(t){return i.mappingContrat(t,e)});return i.$q.all(t).then(function(e){var t=_.chain(n.listeContrats).uniq(function(e){return e.identifiantPersonneContrat}).filter(function(e){return"03"===e.codeRolePersonneContrat||"02"===e.codeRolePersonneContrat}).map(function(e){return i.mappingContratParticipants(e)}).value(),r={contratMySys:e,participants:t};return i.$q.all([i.$q.when(r)])})})})["catch"](function(e){var t={contratMySys:[],participants:[]};return i.$q.all([i.$q.when(t)])})},this.cacheService.defaultTimeToLive,n)},t.prototype.getContratsProduitsMySys=function(e,t,n){var i=this;return void 0===n&&(n=!1),this.cacheService.get("DossierSyntheseService-getContratsProduitsMySys"+e+t,function(){return i.dossierRestService.getContratsProduitsMySys(e,t).then(function(e){return 1===e.length&&null===e[0].identifiantContrat?!1:!0})},this.cacheService.defaultTimeToLive,n)},t.prototype.mappingContratParticipants=function(t){return"03"===t.codeRolePersonneContrat?new e.Modeles.Participant.Participant(null==t.designationPPContrat?t.raisonSocialePMContrat:t.designationPPContrat,t.identifiantPersonneContrat,!1,null!==t.raisonSocialePMContrat,"Caution"):"02"===t.codeRolePersonneContrat?new e.Modeles.Participant.Participant(null==t.designationPPContrat?t.raisonSocialePMContrat:t.designationPPContrat,t.identifiantPersonneContrat,!1,null!==t.raisonSocialePMContrat,"Mandataire"):void 0},t.prototype.mappingContrat=function(e,t){var n,i,r={codeEtablissement:e.codeEtablissement,codeGuichet:e.codeGuichet,codeRolePersonneContrat:e.codeRolePersonneContrat,codeTypeProduitService:e.codeTypeProduitService,estOuvert:"O"===e.codeEtatContrat,identifiantPersonneContrat:e.identifiantPersonneContrat,libelleTypeProduitService:e.libelleTypeProduitService,numeroEntiteTitulaireContrat:e.numeroEntiteTitulaireContrat,referenceProduitService:e.referenceProduitService,nomPersonnePhysiqueContrat:e.nomPPContrat,prenomPersonnePhysiqueContrat:e.prenomPPContrat,designationPersonnePhysiqueContrat:e.designationPPContrat,raisonSocialePersonneMoraleContrat:e.raisonSocialePMContrat,montantAfficheLigne1:n,montantAfficheLigne2:i,isImpayeSynchro:!1};return this.affecterMontantMySysContratMySys(r,t)},t.prototype.isProduitSpecifique=function(e,t){var n=_.filter(e,function(e){return e===t});return 0!==n.length?!0:!1},t.prototype.getCodeEtatCreance=function(e,t,n){if(e===ContentieuxCommun.Constantes.Metier.Contrat.CREANCE_ACTIVE){if(1===t)return ContentieuxParametrage.Constantes.Dossier.codeEtatCreanceEchu;if(0===t&&("O"===n||"C"===n))return ContentieuxParametrage.Constantes.Dossier.codeEtatCreanceDouteux}return null},t.prototype.getProvision=function(e,t,n,i){return this.dossierRestService.getProvision(e,i,t,n).then(function(e){return e.mtProvisionIFRS})["catch"](function(e){return null})},t.prototype.affecterIdentifiantProduitService=function(t){var n;return n=t,this.offreRestService.getOffre(t.codeEtablissement,t.codeGuichetInterbancaire,t.codeTypeProduitService,t.reference,e.Constantes.Offre.CODE_ACTION_RECHERCHE_RICE).then(function(e){if(null!==e){var t=e.listeOffres[0];n.identifiantProduitService=t.identifiantProduitServiceAss.toString()}return n})["catch"](function(e){return null})},t.prototype.affecterMontantMySysContratTuile=function(t){var n,i=this;return n=t,t.codeDecheanceDuTerme===e.Constantes.Solde.codeDecheanceActive?this.isProduitSpecifique(e.Constantes.Solde.CDD.listeCodeProduitService,t.codeTypeProduitService)?this.getMontantsCDD(t.codeEtablissement,t.codeGuichetInterbancaire,t.reference).then(function(i){return n.montantMySysAfficheLigne1=i[0],n.montantMySysAfficheLigne2=i[1],"#"!==n.montantMySysAfficheLigne1.type&&t.etiquetteContrat===e.Constantes.Solde.etiquetteDebiteur&&n.montantMySysAfficheLigne1.montant>=0&&(n.etiquetteContrat=e.Constantes.Solde.etiquetteSousSurveillance),n}):this.isProduitSpecifique(e.Constantes.Solde.CCE.listeCodeProduitService,t.codeTypeProduitService)?this.getMontantsCCE(t.codeEtablissement,t.codeGuichetInterbancaire,t.reference).then(function(i){return n.montantMySysAfficheLigne1=i[0],n.montantMySysAfficheLigne2=i[1],t.etiquetteContrat===e.Constantes.Solde.etiquetteDebiteur&&n.montantMySysAfficheLigne1.montant>=0&&(n.etiquetteContrat=e.Constantes.Solde.etiquetteSousSurveillance),n}):this.isProduitSpecifique(e.Constantes.Solde.CreditGestion.listeCodeProduitService,t.codeTypeProduitService)&&t.reference.length<8?this.soldeService.getCreanceGeleeCreditGestion(t.codeEtablissement,t.reference).then(function(r){var o={type:e.Constantes.Solde.CreditGestion.libelleMontant3,montant:r.montantGelCreance};return n.montantGelCreance=o,i.getMontantsCreditGestion(t.codeEtablissement,t.reference).then(function(e){return n.isImpayeSynchro=e[2],n})})["catch"](function(e){return n.messageErreur="Erreur lors de la récupération du montant GEL ( "+e.libelle+" ) ",n}):this.$q.when(n):this.$q.when(n)},t.prototype.miseAJourLibelleCCE=function(t,n){var i;return i=t,this.isProduitSpecifique(e.Constantes.Solde.CCE.listeCodeProduitService,t.codeTypeProduitService)?this.dossierRestService.getContratsMySys(t.codeEtablissement,n,!0).then(function(e){var n=e.listeContrats.filter(function(e){return e.referenceProduitService===t.reference});return n.length>0&&(i.nature=n[0].libelleTypeProduitService),i}):this.$q.when(i)},t.prototype.affecterMontantMySysContratMySys=function(t,n){var i,r;if(r=t,this.isProduitSpecifique(e.Constantes.Solde.CDD.listeCodeProduitService,t.codeTypeProduitService))return this.getMontantsCDD(t.codeEtablissement,t.codeGuichet,t.referenceProduitService).then(function(e){return null!==e[0]&&null!==e[0]&&(r.montantAfficheLigne1=e[0],r.montantAfficheLigne2=e[1]),r});if(this.isProduitSpecifique(e.Constantes.Solde.CCE.listeCodeProduitService,t.codeTypeProduitService))return this.getMontantsCCE(t.codeEtablissement,t.codeGuichet,t.referenceProduitService).then(function(e){return r.montantAfficheLigne1=e[0],r.montantAfficheLigne2=e[1],r});if(this.isProduitSpecifique(e.Constantes.Solde.CreditGestion.listeCodeProduitService,t.codeTypeProduitService))return t.referenceProduitService.length<8?this.getMontantsCreditGestion(t.codeEtablissement,t.referenceProduitService).then(function(e){return r.montantAfficheLigne1=e[0],r.montantAfficheLigne2=e[1],r}):this.$q.when(r);if(this.isProduitSpecifique(e.Constantes.Solde.CreditConso.listeCodeProduitService,t.codeTypeProduitService))return this.getMontantsCreditConso(t.codeEtablissement,t.numeroEntiteTitulaireContrat.toString(),t.codeGuichet,t.referenceProduitService,t.codeTypeProduitService).then(function(e){return r.montantAfficheLigne1=e[0],r.montantAfficheLigne2=e[1],r.referenceProduitService=e[2],r.libelleTypeProduitService=e[3],r});var o=_.find(n,function(e){return e.referenceProduitService===t.referenceProduitService});return o&&(i={type:e.Constantes.Solde.MiniProfil.libelleMontant1,montant:o.soldeMinuteCompte,codeDevise:null},r.montantAfficheLigne1=i),this.$q.when(r)},t.prototype.getMontantsCDD=function(t,n,i){var r,o,a=this;return this.soldeService.getDetailSoldeCDD(t,n,i).then(function(t){return null!==t?(r={type:e.Constantes.Solde.CDD.libelleMontant1,montant:t.soldeReel,codeDevise:t.codeDevise},o={type:e.Constantes.Solde.CDD.libelleMontant2,montant:t.montantDecouvertAutorise,codeDevise:t.codeDevise}):(r={type:"#",montant:0},o={type:"#",montant:0}),a.$q.all([a.$q.when(r),a.$q.when(o)])})},t.prototype.getMontantsCCE=function(t,n,i){var r,o,a=this;return this.soldeService.getDetailSoldeMinuteCCE(t,n,i).then(function(t){return r={type:e.Constantes.Solde.CCE.libelleMontant1,montant:t.soldeFusionneEuro},o={type:e.Constantes.Solde.CCE.libelleMontant2,montant:t.montantDecouvertEuro},a.$q.all([a.$q.when(r),a.$q.when(o)])})},t.prototype.getMontantsCreditGestion=function(t,n){var i,r,o=this;return this.soldeService.getDetailSoldeCreditGestion(t,n).then(function(t){return i={type:e.Constantes.Solde.CreditGestion.libelleMontant1,montant:t.montantImpayeCredit},r={type:e.Constantes.Solde.CreditGestion.libelleMontant2,montant:t.montantEcheanceMER},o.$q.all([o.$q.when(i),o.$q.when(r),o.$q.when(t.isImpaye)])})},t.prototype.getMontantsCreditConso=function(t,n,i,r,o){var a,s,u,c,l=this;return this.soldeService.getDetailSoldeCreditConso(t,n,i,r,o).then(function(t){return a={type:e.Constantes.Solde.CreditConso.libelleMontant1,montant:t.capitalRestantOuEncours},s={type:e.Constantes.Solde.CreditConso.libelleMontant2,montant:t.montantSoldeRecouvrement},u=t.numeroDossierContratProducteur,c=t.libelle,l.$q.all([l.$q.when(a),l.$q.when(s),l.$q.when(u),l.$q.when(c)])})},t.prototype.affecterMontantIFRS=function(e,t){var n;return n=e,null!==t?this.getProvision(e.codeEtablissement,e.identifiantCreance,t,e.codeGuichetInterbancaire).then(function(e){return n.mtProvisionIFRS=e,n}):this.$q.when(n)},t.prototype.isPGE=function(t){return-1!==e.Constantes.Processus.listecodeProduitServicePGE.indexOf(t)},t.prototype.affecterGarantiePGE=function(t,n){var i;return i=t,this.isPGE(t.codeProduitService)?this.garantieService.getListeGarantiesContrat(t.codeEtablissement,n,t.identifiantCreance,e.Constantes.Garantie.Garantie.avecDetail).then(function(t){var n=_.filter(t,function(t){return t?t.detailGarantie.indicateurGarantieEtatPGE===e.Constantes.Garantie.Garantie.INDICATEUR_GARANTIE_ETAT_PGE_OUI:void 0});if(n.length>0){var r=n[0];r.detailGarantie.datePremiereMiseEnJeuGarantie===e.Constantes.Echeancier.DATE_DEFAULT?i.topMiseEnJeuGarantiePGE=!1:i.topMiseEnJeuGarantiePGE=!0}else i.topMiseEnJeuGarantiePGE=!0;return i})["catch"](function(e){return null}):this.$q.when(i)},t.prototype.mappingEvenementRealise=function(e){var t=this.mappingEvenementCalendrier(e);return t.dateValidation=e.dateValidation,t},t.prototype.mappingEvenementCalendrier=function(t){var n={commentaire:t.commentaire,dateCreationEvenement:t.dateCreationEvenement,dateEvenement:t.dateEvenement,donneesContratEvenementAgenda:{identifiantContrat:t.identifiantContrat,identifiantCreance:t.identifiantCreance},donneesDossierEvenementAgenda:{codeAgent:null,codeEtablissement:null,identifiantPortefeuille:null,numeroDossier:null},codeEtape:null,codeProcedure:null,codeValidationNote:null,libelleEvenementEtapeProcedure:null,libelleEvenement:t.identifiantContrat?t.sousTypeEvenement+" sur "+t.identifiantContrat:t.sousTypeEvenement,codeSousTypeEvenement:t.codeSousTypeEvenement,codeTypeEvenement:t.codeTypeEvenement,numeroSousTypeEvenement:t.numeroSousTypeEvenement,codeAction:null,numeroPriorite:t.numeroPriorite,indicateurPresenceDetail:null};if("PROCEDURE"===t.sousTypeEvenement){var i=t;n.libelleEvenement=i.libelleProcedure,n.libelleEvenementEtapeProcedure=t.identifiantContrat?i.libelleEtape+" sur "+t.identifiantContrat:i.libelleEtape,n.codeEtape=i.codeEtape,n.codeProcedure=i.codeProcedure}return t.codeSousTypeEvenement===e.Constantes.Agenda.typeEvenement.numeroSousTypeEvenementMyVario&&t.codeTypeEvenement===e.Constantes.Agenda.typeEvenement.numeroEvenementNoteSuivie&&(t.commentaire?n.libelleEvenement=t.identifiantContrat?t.commentaire.substring(0,35)+" sur "+t.identifiantContrat:t.commentaire.substring(0,35):n.libelleEvenement=t.identifiantContrat?"MyVario sur "+t.identifiantContrat:"MyVario"),n},t.prototype.extractIdEntiteTitulaire=function(e){return _.padLeft(e.identifiantEntiteTitulaire.toString(),11,"0")},t.prototype.getTypeEcheancier=function(t){return t===e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_SURVEILLANCE?"PaiementTotal":t===e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_APUREMENT?"PaiementPartiel":t===e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_REGLEMENT?"Degressivite":t===e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_SURVEILLANCE_CREDIT_NON_DECHU?"PaiementTotal":void 0},t.prototype.mappeDetailCredit=function(e){if(null===e)return null;var t={dateDerniereEcheance:e.dateDerniereEcheance,dateFinContrat:ContentieuxCommun.Tools.DateUtils.parse(e.dateFinContrat,"YYYYMMDD"),dureeTotalCredit:e.dureeTotalCredit,montantAllegement:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantAllegement),montantAPLContentieux:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantAPLContentieux),montantCapitalRestantDu:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantCapitalRestantDu),montantGelCreance:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantGelCreance),montantProchaineEcheance:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantProchaineEcheance),soldeActualise:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.soldeActualise),tauxCalculInteretsEnCours:e.tauxCalculInteretsEnCours,tauxPenaliteRetard:e.tauxPenaliteRetard};return t},t.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Service.dossierService,Contentieux.RestServices.Commun.Constantes.Inject.Service.creanceService,ContentieuxCommun.Constantes.Inject.MyWay.serviceAgentExtended,ContentieuxCommun.Constantes.Inject.Angular.$q,e.Constantes.Inject.Services.entiteTitulaireService,e.Constantes.Inject.Services.cacheService,e.Constantes.Inject.Logger.applicationLoggerName,e.Constantes.Inject.Services.soldeService,Contentieux.RestServices.Commun.Constantes.Inject.Service.offreService,e.Constantes.Inject.Services.garantieService],t}();t.DossierSyntheseService=n,e.app.service(e.Constantes.Inject.Services.dossierSyntheseService,n)}(n=t.Dossier||(t.Dossier={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Dossier||(e.Dossier={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e){this.dossierNumeriqueRestService=e}return t.prototype.dossierNumeriqueExiste=function(e,t){var n;return this.dossierNumeriqueRestService.getConsulterDossierNumeriquePourIHM(e,t,!0).then(function(e){return n=e.listeRegroupement.length>0?!0:!1})},t.prototype.creerEnveloppeDossierNumerique=function(e,t,n){var i=this.creerEnveloppeDocumentContrat(n.listeContrats),r=this.creerEnveloppeDocumentPersonne(n.listeParticipants),o=this.creerEnveloppeDocumentEntiteTitulaire(n.identifiantEntiteTitulaire,n.designationEntiteTitulaire);return this.mettreAJourDossierNumerique(e,t,n,i,r,o)},t.prototype.creerEnveloppeDocumentContrat=function(t){var n=this,i=[];return t.forEach(function(t){e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeClients.listeCodesContrat.forEach(function(r){var o=n.formatterReference(t.codeProduitService,t.codeEtablissement,t.codeGuichet,t.reference),a={typeDocument:r,numeroContrat:o,libelleContrat:t.nature+" - "+o,classementNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeClients.libelleTheme,ordreNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeClients.ordreTheme};i.push(a)}),e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeProcedures.listeCodesContrat.forEach(function(r){if("MEPS"===r&&n.isAutoriseMEPS(t.codeProduitService)||"MJOC"===r&&n.isAutoriseMJOC(t.codeProduitService)||"MEPS"!==r&&"MJOC"!==r){var o=n.formatterReference(t.codeProduitService,t.codeEtablissement,t.codeGuichet,t.reference),a={typeDocument:r,numeroContrat:o,libelleContrat:t.nature+" - "+o,classementNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeProcedures.libelleTheme,ordreNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeProcedures.ordreTheme};i.push(a)}}),e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeDocsInternes.listeCodesContrat.forEach(function(r){var o=n.formatterReference(t.codeProduitService,t.codeEtablissement,t.codeGuichet,t.reference),a={typeDocument:r,numeroContrat:o,libelleContrat:t.nature+" - "+o,classementNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeDocsInternes.libelleTheme,ordreNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeDocsInternes.ordreTheme};i.push(a)}),e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeContrats.listeCodesContrat.forEach(function(r){var o=n.formatterReference(t.codeProduitService,t.codeEtablissement,t.codeGuichet,t.reference),a={typeDocument:r,numeroContrat:o,libelleContrat:t.nature+" - "+o,classementNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeContrats.libelleTheme,ordreNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeContrats.ordreTheme};i.push(a)})}),i},t.prototype.creerEnveloppeDocumentPersonne=function(t){var n=[];return t.forEach(function(t){e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeClients.listeCodesPersonne.forEach(function(i){var r={typeDocument:i,numeroPersonne:_.padLeft(t.idPersonne.toString(),9,"0"),designationPersonne:t.designation,classementNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeClients.libelleTheme,ordreNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeClients.ordreTheme};n.push(r)}),e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeProcedures.listeCodesPersonne.forEach(function(i){var r={typeDocument:i,numeroPersonne:_.padLeft(t.idPersonne.toString(),9,"0"),designationPersonne:t.designation,classementNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeProcedures.libelleTheme,ordreNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeProcedures.ordreTheme};n.push(r)}),e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeDocsInternes.listeCodesPersonne.forEach(function(i){var r={typeDocument:i,numeroPersonne:_.padLeft(t.idPersonne.toString(),9,"0"),designationPersonne:t.designation,classementNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeDocsInternes.libelleTheme,ordreNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeDocsInternes.ordreTheme};n.push(r)})}),n},t.prototype.creerEnveloppeDocumentEntiteTitulaire=function(t,n){var i=[];return e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeProcedures.listeCodesEntiteTitulaire.forEach(function(r){var o={typeDocument:r,identifiantEntiteTitulaire:t.slice(1),designationEntiteTitulaire:n,classementNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeProcedures.libelleTheme,ordreNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeProcedures.ordreTheme};i.push(o)}),e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeDocsInternes.listeCodesEntiteTitulaire.forEach(function(r){var o={typeDocument:r,identifiantEntiteTitulaire:t.slice(1),designationEntiteTitulaire:n,classementNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeDocsInternes.libelleTheme,ordreNiveau1:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeDocsInternes.ordreTheme};i.push(o)}),i},t.prototype.formatterReference=function(t,n,i,r){return-1!==e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.listeCodeProduitServiceFormatageEspace.indexOf(t)?""+n+e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.formatageEspace+r:-1!==e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.listeCodeProduitServiceFormatageGuichet.indexOf(t)?""+n+i+r:void 0},t.prototype.isAutoriseMEPS=function(t){return-1!==e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeProcedures.listeCodeProduitAutorisesMEPS.indexOf(t)},t.prototype.isAutoriseMJOC=function(t){return-1!==e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.ThemeProcedures.listeCodeProduitAutorisesMJOC.indexOf(t)},t.prototype.mettreAJourDossierNumerique=function(t,n,i,r,o,a){var s=this,u={identifiantRegroupement:null},c=[];null!==r&&r.forEach(function(e){c=s.ajouterDocumentContrat(c,e)}),null!==o&&o.forEach(function(e){c=s.ajouterDocumentPersonne(c,e)}),null!==a&&a.forEach(function(e){c=s.ajouterDocumentEntiteTitulaire(c,e)});var l={codeFour:e.Constantes.DossierNumerique.codeFournisseur.vario,idEtabGce:t,agent:n,referenceRegr:i.numeroDossier,libelleRegr:""+i.designationEntiteTitulaire+e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.libelleRegroupement+i.numeroDossier,metadonnee:null,indiceEnvoiDossierPartg:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.indicateurEnvoiDossierPartage,listeDoc:c};return this.dossierNumeriqueRestService.postCreerOuMAJDossierNumerique(l).then(function(e){return u.identifiantRegroupement=e.idRegr,u})},t.prototype.ajouterDocumentContrat=function(t,n){var i={typeDoc:n.typeDocument,codeNatureAcq:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.codeNatureAcquisition,typeAttrb:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.typeAttributaireContrat,codeAttrb:n.numeroContrat,libelleAttrb:n.libelleContrat,metadonnee:null,critereInjc:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.critereInjection,classementNiveau1:n.classementNiveau1,ordreNiveau1:n.ordreNiveau1,classementNiveau2:n.classementNiveau2,ordreNiveau2:n.ordreNiveau2,indiceEnvoiDossierPartg:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.indicateurEnvoiDossierPartage,aideDoc:n.aide};return t.push(i),t},t.prototype.ajouterDocumentPersonne=function(t,n){var i={typeDoc:n.typeDocument,codeNatureAcq:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.codeNatureAcquisition,typeAttrb:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.typeAttributairePersonne,codeAttrb:n.numeroPersonne,libelleAttrb:n.designationPersonne,metadonnee:null,critereInjc:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.critereInjection,classementNiveau1:n.classementNiveau1,ordreNiveau1:n.ordreNiveau1,classementNiveau2:n.classementNiveau2,ordreNiveau2:n.ordreNiveau2,indiceEnvoiDossierPartg:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.indicateurEnvoiDossierPartage,aideDoc:n.aide};return t.push(i),t},t.prototype.ajouterDocumentEntiteTitulaire=function(t,n){var i={typeDoc:n.typeDocument,codeNatureAcq:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.codeNatureAcquisition,typeAttrb:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.typeAttributaireEntiteTitulaire,codeAttrb:n.identifiantEntiteTitulaire,libelleAttrb:n.designationEntiteTitulaire,metadonnee:null,critereInjc:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.critereInjection,classementNiveau1:n.classementNiveau1,ordreNiveau1:n.ordreNiveau1,classementNiveau2:n.classementNiveau2,ordreNiveau2:n.ordreNiveau2,indiceEnvoiDossierPartg:e.Constantes.DossierNumerique.dossierNumeriqueRecouvrement.indicateurEnvoiDossierPartage,aideDoc:n.aide};return t.push(i),t},t.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Service.dossierNumeriqueService],t}();t.DossierNumeriqueService=n,e.app.service(e.Constantes.Inject.Services.dossierNumeriqueService,n)}(n=t.DossierNumerique||(t.DossierNumerique={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.DossierNumerique||(e.DossierNumerique={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.mappeListePaliers=function(t){var n=[];return _.forEach(t,function(t){n.push(e.mappePalier(t))}),n},e.mappePalier=function(e){var t={duree:e.duree,montant:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantEcheance),numero:e.numeroPalier,taux:e.taux};return t},e}();e.Mappage=t}(t=e.EcheancierBDF||(e.EcheancierBDF={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function n(e){this.echeancierRestService=e}return n.prototype.getEcheancier=function(e,t,n){var i=this;return this.echeancierRestService.getEcheancierBDF(e,n,t).then(function(e){return i.mappeEcheancier(e)})},n.prototype.mappeEcheancier=function(n){if(null===n.paliers)return null;var i={periodicite:n.codePeriodiciteEcheancier,datePremiereEcheance:ContentieuxCommun.Tools.DateUtils.parse(n.datePremiereEcheance.toString(),"YYYYMMDD"),isTauxPenaliteCreance:n.indicateurTauxPenaliteCreance===e.Constantes.EcheancierBDF.CODE_TAUX_PENALITE_CREANCE_OUI?!0:!1,isApurementTotalCreance:n.indicateurApurementTotalCreance===e.Constantes.EcheancierBDF.CODE_APUREMENT_TOTAL_OUI?!0:!1,isMoratoire:n.codeIndicateurMoratoire===e.Constantes.EcheancierBDF.CODE_MORATOIRE_OUI?!0:!1,isDetteEffacee:null===n.indicateurDetteEffacee?!1:!0,montantAbandon:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(n.montantAbandon),soldeActualise:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(n.soldeActualise),paliers:t.Mappage.mappeListePaliers(n.paliers)};return i},n.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Service.echeancierBDFService],n}();t.EcheancierBDFService=n,e.app.service(e.Constantes.Inject.Services.echeancierBDFService,n)}(n=t.EcheancierBDF||(t.EcheancierBDF={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function n(){}return n.mappeDossier=function(e,t){var n={codeEtablissement:e.codeEtablissement,numeroDossier:e.numeroDossier,identifiantEntiteTitulaire:t,idGerePar:null,isDossierSurendettement:null};return n},n.mappeContrat=function(e,t){var n={identifiantContrat:e.identifiantContrat,codeProduitService:e.codeProduitService,codeTypeProduitService:e.codeTypeProduitService,isDechu:t.isContratDechu,isTypeCompte:!1,dateFinContrat:t.dateFinContrat};return n},n.mappeDonnees=function(n){var i={numeroTitulaire:n.numeroPersonTitulaireEcheancier,montantEcheance:0,identifiantCreance:n.identifiantCreance,numeroHistoAccord:n.numeroHistoAccord,montantAccord:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(n.montantAccord),adresseWebUrl:n.adresseWebUrl,smsEcheanceAVenir:n.indicateurAlerteSmsSurEcheance===e.Constantes.Echeancier.CODE_SMS_ECHEANCE_OUI?!0:!1,smsRelanceNonPaiment:n.indicateurSmsRelanceNonPaiement===e.Constantes.Echeancier.CODE_SMS_NON_PAIEMENT_OUI?!0:!1,editionLettreRelance:n.indicGestionAutoCourrierRelance===e.Constantes.Echeancier.CODE_COURRIER_RELANCE_OUI?!0:!1,editionLettreMiseEnDemeure:n.indicGestionAutoMiseEnDemeure===e.Constantes.Echeancier.CODE_COURRIER_MISE_EN_DEMEURE_OUI?!0:!1,tauxApplicable:n.indicateurTauxPenaliteCreance===e.Constantes.Echeancier.CODE_TAUX_PENALITE_CREANCE_OUI?n.tauxPenaliteRetard/100:n.palier?n.palier[0].taux:0,tauxCreance:null,montantTotal:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(n.montantTotal),montantRetard:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(n.montantImpayeAccordRecouvrement),soldeActualise:n.infosCreance?ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(n.infosCreance.soldeActualise):null,periodicite:t.Tools.getLibellePeriodicite(n.periodicite),datePremiereEcheance:ContentieuxCommun.Tools.DateUtils.parse(n.datePremiereEcheance.toString(),"YYYYMMDD"),dureeEcheancier:n.periode?n.periode[n.periode.length-1].echeance.reduce(function(e,t){return e.numero>t.numero?e:t}).numero:null};return i},n.mappeDonneesInput=function(e,t){var i;i=n.mappeDonnees(t);var r=0;return r=e.contrat.isDechu?ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(t.palier[0].montant):e.donnees.montantEcheance,i.montantEcheance=r,i.tauxCreance=e.donnees.tauxCreance,i},n.mappePayeur=function(e){var t={smsPayeur:e.numeroTelephoneSms,smsPayeurIndicatif:"",smsPayeurNumero:"",isNouveauPayeur:!1,isNouveauSMS:!1,payeur:null};return t},n.mappePointBudget=function(e){var t={montantCharges:e.pointBudget.montantCharges,montantRevenusAutres:e.pointBudget.montantAutresRevenus,montantRevenusLocatifs:e.pointBudget.montantRevenusLocatifs,montantRevenusSalaire:e.pointBudget.montantSalaire};return t},n.mappeStatut=function(t){switch(t){case e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_ACTIF:return e.Constantes.Echeancier.LIBELLE_STATUT_RESPECTE;case e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_EN_RETARD:return e.Constantes.Echeancier.LIBELLE_STATUT_EN_RETARD;case e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_NON_RESPECT:return e.Constantes.Echeancier.LIBELLE_STATUT_NON_RESPECTE;case e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_ATTENTE_SIGNATURE:return e.Constantes.Echeancier.LIBELLE_STATUT_ATTENTE_SIGNATURE;case e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_CADUC:return e.Constantes.Echeancier.LIBELLE_STATUT_CADUC;case e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_SUPPRIME:return e.Constantes.Echeancier.LIBELLE_STATUT_SUPPRIME;case e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_TERMINE:return e.Constantes.Echeancier.LIBELLE_STATUT_TERMINE;default:return t}},n.mappeListePaliers=function(e,t,i,r){var o=[];return _.forEach(e,function(e){e.duree>0&&o.push(n.mappePalier(e,t,i,r))}),o},n.mappePalier=function(e,i,r,o){var a=e.periode[0],s=a.echeance[0],u=e.periode[e.periode.length-1],c=u.echeance[u.echeance.length-1],l=0!==e.montantRemboursementGel&&null!==e.montantRemboursementGel,m={duree:e.duree,montant:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montant),numero:e.numero,taux:e.taux,montantRemboursementGel:null===e.montantRemboursementGel?0:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantRemboursementGel),isEnCours:t.Tools.isPalierEnCours(s.date,c.date)&&r,tableauEcheances:n.mappeTableau(e.periode,i.typeEcheancier,o,i.isCreditNonDechu,l)};return m},n.mappeTableau=function(e,t,i,r,o){var a={listePeriodes:[],isTypeDegressivite:"Degressivite"===t?!0:!1,isTypePaiement:"PaiementTotal"===t||"PaiementPartiel"===t?!0:!1};if(a.isTypePaiement){var s=_.map(e,function(e){return n.mappePeriodePaiement(e,i,r,o)});return a.listePeriodes=s,a}if(a.isTypeDegressivite){var s=_.map(e,function(e){return n.mappePeriodeDegressivite(e,i)});return a.listePeriodes=s,a}return a},n.mappePeriodePaiement=function(e,t,i,r){var o=_.map(e.echeance,function(e){return n.mappeEcheancePaiement(e);
}),a=[];a="S"===t?i?r?ContentieuxParametrage.Constantes.Echeancier.Tableau.ENTETE_TABLEAU_PAIEMENT_SIMULATION_CREDIT_NON_DECHU_GEL:ContentieuxParametrage.Constantes.Echeancier.Tableau.ENTETE_TABLEAU_PAIEMENT_SIMULATION_CREDIT_NON_DECHU:ContentieuxParametrage.Constantes.Echeancier.Tableau.ENTETE_TABLEAU_PAIEMENT_SIMULATION:i?r?ContentieuxParametrage.Constantes.Echeancier.Tableau.ENTETE_TABLEAU_PAIEMENT_VISUALISATION_CREDIT_NON_DECHU_GEL:ContentieuxParametrage.Constantes.Echeancier.Tableau.ENTETE_TABLEAU_PAIEMENT_VISUALISATION_CREDIT_NON_DECHU:ContentieuxParametrage.Constantes.Echeancier.Tableau.ENTETE_TABLEAU_PAIEMENT_VISUALISATION;var s={listeEntetes:a,totalInterets:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.totalInteret),listeEcheances:o};return s},n.mappePeriodeDegressivite=function(e,t){var i=_.map(e.echeance,function(e){return n.mappeEcheanceDegressivite(e)}),r={listeEntetes:"S"===t?ContentieuxParametrage.Constantes.Echeancier.Tableau.ENTETE_TABLEAU_DEGRESSIVITE_SIMULATION:ContentieuxParametrage.Constantes.Echeancier.Tableau.ENTETE_TABLEAU_DEGRESSIVITE_VISUALISATION,totalInterets:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.totalInteret),listeEcheances:i};return r},n.mappeEcheancePaiement=function(e){var t={rang:e.numero.toString(),date:ContentieuxCommun.Tools.DateUtils.parse(e.date),montant:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montant),interet:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantInteretRetardNonEchus),restantDu:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.solde),montantGel:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantGel),soldeCreanceGelee:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.soldeCreanceGelee),etat:e.codeEtatEcheance};return t},n.mappeEcheanceDegressivite=function(e){var t={rang:e.numero.toString(),date:ContentieuxCommun.Tools.DateUtils.parse(e.date),montant:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montant),soldeDebiteur:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.solde),etat:e.codeEtatEcheance,montantGel:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantGel),soldeCreanceGelee:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.soldeCreanceGelee)};return t},n}();t.Mappage=n}(n=t.Echeancier||(t.Echeancier={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function n(e,t,n,i,r,o,a,s,u,c){this.$q=e,this.cacheService=t,this.echeancierRestService=n,this.riceService=i,this.entiteTitulaireService=r,this.tiersService=o,this.smsService=a,this.garantieService=s,this.communService=u,this.creanceParametre=c}return n.prototype.simulerMontantTotalEcheancier=function(t,n,i){var r=this;void 0===i&&(i=!1);var o;return"Simple"!==t.modeEcheancier||"PaiementTotal"!==t.typeEcheancier&&"PaiementPartiel"!==t.typeEcheancier?"Simple"===t.modeEcheancier&&"Degressivite"===t.typeEcheancier&&(o=this.initEcheancierSimpleDegressivitePourCalculMontantTotal(t,e.Constantes.Echeancier.CODE_ACTION_SIMULER)):o=this.initEcheancierSimplePaiementPourCalculMontantTotal(t,e.Constantes.Echeancier.CODE_ACTION_SIMULER),this.echeancierRestService.postEcheancier(o).then(function(e){return r.mappeEcheancier(e,n,t)})},n.prototype.simulerEcheancier=function(t,n,i){var r=this;void 0===i&&(i=!1);var o;return"Simple"!==t.modeEcheancier||"PaiementTotal"!==t.typeEcheancier&&"PaiementPartiel"!==t.typeEcheancier?"Simple"===t.modeEcheancier&&"Degressivite"===t.typeEcheancier?o=this.initEcheancierSimpleDegressivite(t,e.Constantes.Echeancier.CODE_ACTION_SIMULER):"Expert"!==t.modeEcheancier||"PaiementTotal"!==t.typeEcheancier&&"PaiementPartiel"!==t.typeEcheancier||(o=this.initEcheancierExpertPaiement(t,e.Constantes.Echeancier.CODE_ACTION_SIMULER)):o=this.initEcheancierSimplePaiement(t,e.Constantes.Echeancier.CODE_ACTION_SIMULER),this.cacheService.get("EcheancierService-simulerEcheancier"+o.numeroDossier+o.identifiantCreance,function(){return r.echeancierRestService.postEcheancier(o).then(function(e){return r.mappeEcheancier(e,n,t)})},this.cacheService.defaultTimeToLive,i)},n.prototype.creerEcheancier=function(n){var i,r,o=this;return"Simple"!==n.modeEcheancier||"PaiementTotal"!==n.typeEcheancier&&"PaiementPartiel"!==n.typeEcheancier?"Simple"===n.modeEcheancier&&"Degressivite"===n.typeEcheancier?i=this.initEcheancierSimpleDegressivite(n,e.Constantes.Echeancier.CODE_ACTION_CREATION):"Expert"!==n.modeEcheancier||"PaiementTotal"!==n.typeEcheancier&&"PaiementPartiel"!==n.typeEcheancier||(i=this.initEcheancierExpertPaiement(n,e.Constantes.Echeancier.CODE_ACTION_CREATION)):i=this.initEcheancierSimplePaiement(n,e.Constantes.Echeancier.CODE_ACTION_CREATION),this.echeancierRestService.postEcheancier(i).then(function(e){return o.getIBAN(n).then(function(i){return o.garantieService.ajouterLienCompteRecouvrementGarantie(t.Tools.getLienCompteGarantie(n,i)).then(function(){return o.smsService.definirSMSEcheancier(n).then(function(){return null!==n.pointBudget?(r=o.initEcheancierPointBudget(e,n.pointBudget),o.echeancierRestService.postEcheancier(r).then(function(e){return o.$q.when([!0,!0])})):o.$q.when([!0,!0])})["catch"](function(){return o.$q.when([!0,!1])})})})})},n.prototype.supprimerEcheancier=function(t){var n,i=null;return"PaiementTotal"===t.typeEcheancier?i=e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_SURVEILLANCE:"PaiementPartiel"===t.typeEcheancier?i=e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_APUREMENT:"Degressivite"===t.typeEcheancier&&(i=e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_REGLEMENT),n=t.payeur.payeur.isGarantie?t.payeur.payeur.infoGarantie.numeroGarantieDossierCTX:null,this.echeancierRestService.deleteEcheancier(t.dossier.codeEtablissement,t.dossier.numeroDossier,t.donnees.identifiantCreance,i,t.donnees.numeroHistoAccord,n).then(function(e){return null})},n.prototype.getEcheancier=function(n){var i=this;return this.echeancierRestService.getEcheancier(n.codeEtablissement,n.numeroDossier,n.identifianCreance,n.codeProduitService,t.Tools.getCodeTypeEcheancier(n.typeEcheancier),n.numeroHistoAccord,e.Constantes.Echeancier.MODE_UNITAIRE,n.isContratDechu).then(function(e){return i.mappeEcheancier(e[0],n)})},n.prototype.getListeEcheanciers=function(n){var i=this;return this.echeancierRestService.getEcheancier(n.codeEtablissement,n.numeroDossier,n.identifianCreance,n.codeProduitService,t.Tools.getCodeTypeEcheancier(n.typeEcheancier),0,e.Constantes.Echeancier.MODE_OPTIMISE,n.isContratDechu).then(function(e){var r=e.filter(function(e){return t.Tools.isEcheancierActif(e.codeEtatPlanApurement)}),o=e.filter(function(e){return t.Tools.isEcheancierClos(e.codeEtatPlanApurement)});return i.$q.all([i.mappeListeEcheanciers(r,n),i.mappeListeEcheanciers(o,n)])})},n.prototype.getPointBudget=function(n){var i=this;return 0===n.numeroHistoAccord||null===n.numeroHistoAccord?this.$q.when(null):this.echeancierRestService.getEcheancier(n.codeEtablissement,n.numeroDossier,n.identifianCreance,n.codeProduitService,e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_POINT_BUDGET,n.numeroHistoAccord,e.Constantes.Echeancier.MODE_COMPLET,n.isContratDechu).then(function(e){return null!==e?t.Mappage.mappePointBudget(e[0]):i.$q.when(null)})},n.prototype.setModeMontantDuree=function(e){var t=angular.copy(e);return(t.contrat.isDechu&&t.isAccordPartiel||!t.contrat.isDechu&&!t.contrat.isTypeCompte)&&(t.isCalculParMontant?t.donnees.dureeEcheancier=0:t.isCalculParDuree&&(t.donnees.montantEcheance=0)),t},n.prototype.initEcheancierPointBudget=function(t,n){var i;return i=this.initPointBudget(n),t={typeEcheancier:e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_POINT_BUDGET,codeEtablissement:t.codeEtablissement,numeroDossier:t.numeroDossier,identifiantCreance:t.identifiantCreance,numeroHistoAccord:t.numeroHistoAccord,pointBudget:i,codeAction:null,codeEtatPlanApurement:null,codeProduitService:null,codeTypeOrigineFlux:null,codeTypeProduitService:null,compte:null,dateConclusionAccord:null,dateFin:null,dateMiseEnPlace:null,datePremiereEcheance:null,dateProchaineEcheance:null,dureeInitiale:null,dureeResiduelle:null,identifiantContrat:null,indicateurAlerteSmsSurEcheance:null,indicateurApurementTotalCreance:null,indicateurMoratoire:null,indicateurPlanNeiertz:null,indicateurPresenceHistoPlan:null,indicateurSmsRelanceNonPaiement:null,indicateurTauxPenaliteCreance:null,indicGestionAutoCourrierRelance:null,indicGestionAutoMiseEnDemeure:null,libelleProduitCredit:null,montantAccord:null,montantImpayeAccordRecouvrement:null,montantProchaineEcheance:null,montantTotal:null,palier:null,periode:null,periodicite:null,tauxPenaliteRetard:null,numeroPersonTitulaireEcheancier:null,numeroTelephoneSms:null,adresseWebUrl:null,indicateurCalculAuto:null,indicateurPlanAvecPrelevement:null,infosCreance:null}},n.prototype.initPointBudget=function(e){var t;return t={montantAutresRevenus:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(e.montantRevenusAutres),montantCharges:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(e.montantCharges),montantRevenusLocatifs:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(e.montantRevenusLocatifs),montantSalaire:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(e.montantRevenusSalaire)}},n.prototype.initEcheancierSimplePaiement=function(t,n){t=this.setModeMontantDuree(t);var i=[],r=this.initPalier(1,t.donnees);i.push(r[0]);var o=null,a=[];t.paiement&&"Prélèvement"===t.paiement.typePaiement&&(o=this.initCompte(100,0,t.paiement.prelevement,t.payeur.payeur.isGarantie),a.push(o));var s={libelleProduitCredit:null,dateConclusionAccord:n===e.Constantes.Echeancier.CODE_ACTION_CREATION||n===e.Constantes.Echeancier.CODE_ACTION_SIMULER?parseInt(ContentieuxCommun.Tools.DateUtils.format(moment().toDate(),"YYYYMMDD")):null,dateProchaineEcheance:null,dureeResiduelle:null,dateFin:null,codeEtatPlanApurement:e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_ACTIF,montantTotal:0,numeroHistoAccord:0,montantImpayeAccordRecouvrement:0,montantProchaineEcheance:0,tauxPenaliteRetard:100*t.donnees.tauxApplicable,codeTypeOrigineFlux:e.Services.Echeancier.Tools.getCodeTypeOrigineFlux(t.payeur.payeur.isGarantie),indicateurPlanNeiertz:t.dossier.isDossierSurendettement?e.Constantes.Echeancier.CODE_NEIERTZ_OUI:e.Constantes.Echeancier.CODE_NEIERTZ_NON,indicateurMoratoire:e.Constantes.Echeancier.CODE_MORATOIRE_NON,indicGestionAutoCourrierRelance:e.Constantes.Echeancier.CODE_COURRIER_RELANCE_OUI,indicGestionAutoMiseEnDemeure:e.Constantes.Echeancier.CODE_COURRIER_MISE_EN_DEMEURE_OUI,indicateurPresenceHistoPlan:e.Constantes.Echeancier.CODE_PRESENCE_HISTORIQUE_NON,indicateurSmsRelanceNonPaiement:t.donnees.smsRelanceNonPaiment?e.Constantes.Echeancier.CODE_SMS_NON_PAIEMENT_OUI:e.Constantes.Echeancier.CODE_SMS_NON_PAIEMENT_NON,codeAction:n,codeEtablissement:t.dossier.codeEtablissement,numeroDossier:t.dossier.numeroDossier,identifiantCreance:t.donnees.identifiantCreance,codeTypeProduitService:t.contrat.codeTypeProduitService,codeProduitService:t.contrat.codeProduitService,identifiantContrat:t.contrat.identifiantContrat,numeroPersonTitulaireEcheancier:t.donnees.numeroTitulaire,numeroTelephoneSms:t.payeur.smsPayeur,typeEcheancier:e.Services.Echeancier.Tools.getCodeTypeEcheancier(t.typeEcheancier),indicateurApurementTotalCreance:t.isAccordPartiel?e.Constantes.Echeancier.CODE_APUREMENT_TOTAL_NON:e.Constantes.Echeancier.CODE_APUREMENT_TOTAL_OUI,montantAccord:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(t.donnees.montantAccord),datePremiereEcheance:parseInt(ContentieuxCommun.Tools.DateUtils.format(t.donnees.datePremiereEcheance,"YYYYMMDD")),dateMiseEnPlace:ContentieuxCommun.Tools.DateUtils.format(t.donnees.datePremiereEcheance,"YYYY-MM-DD"),dureeInitiale:t.donnees.dureeEcheancier,periodicite:e.Services.Echeancier.Tools.getCodePeriodicite(t.donnees.periodicite),indicateurAlerteSmsSurEcheance:t.donnees.smsEcheanceAVenir?e.Constantes.Echeancier.CODE_SMS_ECHEANCE_OUI:e.Constantes.Echeancier.CODE_SMS_ECHEANCE_NON,palier:i,indicateurTauxPenaliteCreance:r[1],compte:a,periode:null,pointBudget:null,adresseWebUrl:null,indicateurCalculAuto:t.isCalculAuto?e.Constantes.Echeancier.INDICATEUR_CALCUL_AUTO_OUI:e.Constantes.Echeancier.INDICATEUR_CALCUL_AUTO_NON,indicateurPlanAvecPrelevement:null!==o?e.Constantes.Echeancier.INDICATEUR_PLAN_PRELEVEMENT_OUI:e.Constantes.Echeancier.INDICATEUR_PLAN_PRELEVEMENT_NON,infosCreance:{dateFinContrat:t.contrat.isDechu||t.contrat.isTypeCompte||null===t.contrat.dateFinContrat?e.Constantes.Echeancier.DATE_DEFAULT:ContentieuxCommun.Tools.DateUtils.format(t.contrat.dateFinContrat,"YYYY-MM-DD"),soldeActualise:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(t.donnees.soldeActualise),etatDecheance:t.contrat.isDechu,dureeTotaleCredit:0,montantGelCreance:0,dateDerniereEcheance:e.Constantes.Echeancier.DATE_DEFAULT}};return s},n.prototype.initEcheancierExpertPaiement=function(t,n){var i=this,r=!1;t=this.setModeMontantDuree(t);var o=[];_.forEach(t.paliers,function(e){o.push(i.initPalierModeExpert(e))});var a=_.find(o,function(e){return 0===e.montant});a&&(r=!0);var s=null,u=[];t.paiement&&"Prélèvement"===t.paiement.typePaiement&&(s=this.initCompte(100,0,t.paiement.prelevement,t.payeur.payeur.isGarantie),u.push(s));var c={libelleProduitCredit:null,dateConclusionAccord:n===e.Constantes.Echeancier.CODE_ACTION_CREATION||n===e.Constantes.Echeancier.CODE_ACTION_SIMULER?parseInt(ContentieuxCommun.Tools.DateUtils.format(moment().toDate(),"YYYYMMDD")):null,dateProchaineEcheance:null,dureeResiduelle:null,dateFin:null,codeEtatPlanApurement:e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_ACTIF,montantTotal:0,numeroHistoAccord:0,montantImpayeAccordRecouvrement:0,montantProchaineEcheance:0,tauxPenaliteRetard:100*t.donnees.tauxApplicable,codeTypeOrigineFlux:e.Services.Echeancier.Tools.getCodeTypeOrigineFlux(t.payeur.payeur.isGarantie),indicateurPlanNeiertz:t.dossier.isDossierSurendettement?e.Constantes.Echeancier.CODE_NEIERTZ_OUI:e.Constantes.Echeancier.CODE_NEIERTZ_NON,indicateurMoratoire:r?e.Constantes.Echeancier.CODE_MORATOIRE_OUI:e.Constantes.Echeancier.CODE_MORATOIRE_NON,indicGestionAutoCourrierRelance:e.Constantes.Echeancier.CODE_COURRIER_RELANCE_OUI,indicGestionAutoMiseEnDemeure:e.Constantes.Echeancier.CODE_COURRIER_MISE_EN_DEMEURE_OUI,indicateurPresenceHistoPlan:e.Constantes.Echeancier.CODE_PRESENCE_HISTORIQUE_NON,indicateurSmsRelanceNonPaiement:t.donnees.smsRelanceNonPaiment?e.Constantes.Echeancier.CODE_SMS_NON_PAIEMENT_OUI:e.Constantes.Echeancier.CODE_SMS_NON_PAIEMENT_NON,codeAction:n,codeEtablissement:t.dossier.codeEtablissement,numeroDossier:t.dossier.numeroDossier,identifiantCreance:t.donnees.identifiantCreance,codeTypeProduitService:t.contrat.codeTypeProduitService,codeProduitService:t.contrat.codeProduitService,identifiantContrat:t.contrat.identifiantContrat,numeroPersonTitulaireEcheancier:t.donnees.numeroTitulaire,numeroTelephoneSms:t.payeur.smsPayeur,typeEcheancier:e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_APUREMENT,indicateurApurementTotalCreance:t.isAccordPartiel?e.Constantes.Echeancier.CODE_APUREMENT_TOTAL_NON:e.Constantes.Echeancier.CODE_APUREMENT_TOTAL_OUI,montantAccord:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(t.donnees.montantAccord),datePremiereEcheance:parseInt(ContentieuxCommun.Tools.DateUtils.format(t.donnees.datePremiereEcheance,"YYYYMMDD")),dateMiseEnPlace:ContentieuxCommun.Tools.DateUtils.format(t.donnees.datePremiereEcheance,"YYYY-MM-DD"),dureeInitiale:t.donnees.dureeEcheancier,periodicite:e.Services.Echeancier.Tools.getCodePeriodicite(t.donnees.periodicite),indicateurAlerteSmsSurEcheance:t.donnees.smsEcheanceAVenir?e.Constantes.Echeancier.CODE_SMS_ECHEANCE_OUI:e.Constantes.Echeancier.CODE_SMS_ECHEANCE_NON,palier:o,indicateurTauxPenaliteCreance:e.Constantes.Echeancier.CODE_TAUX_PENALITE_CREANCE_NON,compte:u,periode:null,pointBudget:null,adresseWebUrl:null,indicateurCalculAuto:t.isCalculAuto?e.Constantes.Echeancier.INDICATEUR_CALCUL_AUTO_OUI:e.Constantes.Echeancier.INDICATEUR_CALCUL_AUTO_NON,indicateurPlanAvecPrelevement:null!==s?e.Constantes.Echeancier.INDICATEUR_PLAN_PRELEVEMENT_OUI:e.Constantes.Echeancier.INDICATEUR_PLAN_PRELEVEMENT_NON,infosCreance:{dateFinContrat:t.contrat.isDechu||t.contrat.isTypeCompte||null===t.contrat.dateFinContrat?e.Constantes.Echeancier.DATE_DEFAULT:ContentieuxCommun.Tools.DateUtils.format(t.contrat.dateFinContrat,"YYYY-MM-DD"),soldeActualise:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(t.donnees.soldeActualise),etatDecheance:t.contrat.isDechu,dureeTotaleCredit:0,montantGelCreance:0,dateDerniereEcheance:e.Constantes.Echeancier.DATE_DEFAULT}};return c},n.prototype.initEcheancierSimpleDegressivite=function(t,n){var i=[],r=this.initPalier(1,t.donnees);i.push(r[0]);var o=null,a={libelleProduitCredit:null,dateProchaineEcheance:null,dureeResiduelle:null,dateFin:null,codeEtatPlanApurement:null,montantTotal:0,numeroHistoAccord:0,montantImpayeAccordRecouvrement:0,montantProchaineEcheance:0,tauxPenaliteRetard:0,dateConclusionAccord:n===e.Constantes.Echeancier.CODE_ACTION_CREATION?parseInt(ContentieuxCommun.Tools.DateUtils.format(moment().toDate(),"YYYYMMDD")):null,indicateurPlanNeiertz:t.dossier.isDossierSurendettement?e.Constantes.Echeancier.CODE_NEIERTZ_OUI:e.Constantes.Echeancier.CODE_NEIERTZ_NON,indicateurSmsRelanceNonPaiement:t.donnees.smsRelanceNonPaiment?e.Constantes.Echeancier.CODE_SMS_NON_PAIEMENT_OUI:e.Constantes.Echeancier.CODE_SMS_NON_PAIEMENT_NON,indicateurApurementTotalCreance:e.Constantes.Echeancier.CODE_APUREMENT_TOTAL_OUI,codeTypeOrigineFlux:e.Services.Echeancier.Tools.getCodeTypeOrigineFlux(t.payeur.payeur.isGarantie),indicateurMoratoire:e.Constantes.Echeancier.CODE_MORATOIRE_NON,indicGestionAutoCourrierRelance:e.Constantes.Echeancier.CODE_COURRIER_RELANCE_OUI,indicGestionAutoMiseEnDemeure:e.Constantes.Echeancier.CODE_COURRIER_MISE_EN_DEMEURE_OUI,indicateurPresenceHistoPlan:e.Constantes.Echeancier.CODE_PRESENCE_HISTORIQUE_NON,codeAction:n,codeEtablissement:t.dossier.codeEtablissement,numeroDossier:t.dossier.numeroDossier,identifiantCreance:t.donnees.identifiantCreance,codeTypeProduitService:t.contrat.codeTypeProduitService,codeProduitService:t.contrat.codeProduitService,identifiantContrat:t.contrat.identifiantContrat,numeroPersonTitulaireEcheancier:t.donnees.numeroTitulaire,numeroTelephoneSms:t.payeur.smsPayeur,typeEcheancier:e.Services.Echeancier.Tools.getCodeTypeEcheancier(t.typeEcheancier),montantAccord:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(t.donnees.montantAccord),datePremiereEcheance:parseInt(ContentieuxCommun.Tools.DateUtils.format(t.donnees.datePremiereEcheance,"YYYYMMDD")),dateMiseEnPlace:ContentieuxCommun.Tools.DateUtils.format(t.donnees.datePremiereEcheance,"YYYY-MM-DD"),dureeInitiale:t.donnees.dureeEcheancier,periodicite:e.Services.Echeancier.Tools.getCodePeriodicite(t.donnees.periodicite),indicateurAlerteSmsSurEcheance:t.donnees.smsEcheanceAVenir?e.Constantes.Echeancier.CODE_SMS_ECHEANCE_OUI:e.Constantes.Echeancier.CODE_SMS_ECHEANCE_NON,palier:i,indicateurTauxPenaliteCreance:r[1],compte:o,periode:null,pointBudget:null,adresseWebUrl:null,indicateurCalculAuto:e.Constantes.Echeancier.INDICATEUR_CALCUL_AUTO_OUI,indicateurPlanAvecPrelevement:e.Constantes.Echeancier.INDICATEUR_PLAN_PRELEVEMENT_NON,infosCreance:{dateFinContrat:e.Constantes.Echeancier.DATE_DEFAULT,soldeActualise:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(t.donnees.soldeActualise),etatDecheance:t.contrat.isDechu,dureeTotaleCredit:0,montantGelCreance:0,dateDerniereEcheance:e.Constantes.Echeancier.DATE_DEFAULT}};return a},n.prototype.initEcheancierSimplePaiementPourCalculMontantTotal=function(t,n){t=this.setModeMontantDuree(t);var i=[],r=this.initPalier(1,t.donnees);i.push(r[0]);var o=null,a=[];"Prélèvement"===t.paiement.typePaiement&&(o=this.initCompteTemporaire(t.payeur.payeur.isGarantie),a.push(o));var s={palier:i,compte:a,libelleProduitCredit:null,dateProchaineEcheance:null,dureeResiduelle:null,dateFin:null,periode:null,pointBudget:null,numeroPersonTitulaireEcheancier:null,numeroTelephoneSms:null,adresseWebUrl:null,montantTotal:0,numeroHistoAccord:0,montantImpayeAccordRecouvrement:0,montantProchaineEcheance:0,dateConclusionAccord:n===e.Constantes.Echeancier.CODE_ACTION_CREATION||n===e.Constantes.Echeancier.CODE_ACTION_SIMULER?parseInt(ContentieuxCommun.Tools.DateUtils.format(moment().toDate(),"YYYYMMDD")):null,codeEtatPlanApurement:e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_ACTIF,tauxPenaliteRetard:100*t.donnees.tauxApplicable,indicateurApurementTotalCreance:t.isAccordPartiel?e.Constantes.Echeancier.CODE_APUREMENT_TOTAL_NON:e.Constantes.Echeancier.CODE_APUREMENT_TOTAL_OUI,codeTypeOrigineFlux:e.Services.Echeancier.Tools.getCodeTypeOrigineFlux(t.payeur.payeur.isGarantie),indicateurPlanNeiertz:t.dossier.isDossierSurendettement?e.Constantes.Echeancier.CODE_NEIERTZ_OUI:e.Constantes.Echeancier.CODE_NEIERTZ_NON,indicateurMoratoire:e.Constantes.Echeancier.CODE_MORATOIRE_NON,indicGestionAutoCourrierRelance:e.Constantes.Echeancier.CODE_COURRIER_RELANCE_OUI,indicGestionAutoMiseEnDemeure:e.Constantes.Echeancier.CODE_COURRIER_MISE_EN_DEMEURE_OUI,indicateurPresenceHistoPlan:e.Constantes.Echeancier.CODE_PRESENCE_HISTORIQUE_NON,indicateurSmsRelanceNonPaiement:t.donnees.smsRelanceNonPaiment?e.Constantes.Echeancier.CODE_SMS_NON_PAIEMENT_OUI:e.Constantes.Echeancier.CODE_SMS_NON_PAIEMENT_NON,indicateurTauxPenaliteCreance:r[1],codeAction:n,codeEtablissement:t.dossier.codeEtablissement,numeroDossier:t.dossier.numeroDossier,identifiantCreance:t.donnees.identifiantCreance,codeTypeProduitService:t.contrat.codeTypeProduitService,codeProduitService:t.contrat.codeProduitService,identifiantContrat:t.contrat.identifiantContrat,typeEcheancier:e.Services.Echeancier.Tools.getCodeTypeEcheancier(t.typeEcheancier),montantAccord:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(t.donnees.montantAccord),datePremiereEcheance:parseInt(ContentieuxCommun.Tools.DateUtils.format(t.donnees.datePremiereEcheance,"YYYYMMDD")),dateMiseEnPlace:ContentieuxCommun.Tools.DateUtils.format(t.donnees.datePremiereEcheance,"YYYY-MM-DD"),dureeInitiale:t.donnees.dureeEcheancier,periodicite:e.Services.Echeancier.Tools.getCodePeriodicite(t.donnees.periodicite),indicateurAlerteSmsSurEcheance:t.donnees.smsEcheanceAVenir?e.Constantes.Echeancier.CODE_SMS_ECHEANCE_OUI:e.Constantes.Echeancier.CODE_SMS_ECHEANCE_NON,indicateurCalculAuto:t.isCalculAuto?e.Constantes.Echeancier.INDICATEUR_CALCUL_AUTO_OUI:e.Constantes.Echeancier.INDICATEUR_CALCUL_AUTO_NON,indicateurPlanAvecPrelevement:"Prélèvement"===t.paiement.typePaiement?e.Constantes.Echeancier.INDICATEUR_PLAN_PRELEVEMENT_OUI:e.Constantes.Echeancier.INDICATEUR_PLAN_PRELEVEMENT_NON,infosCreance:{dateFinContrat:t.contrat.isDechu||t.contrat.isTypeCompte||null===t.contrat.dateFinContrat?e.Constantes.Echeancier.DATE_DEFAULT:ContentieuxCommun.Tools.DateUtils.format(t.contrat.dateFinContrat,"YYYY-MM-DD"),soldeActualise:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(t.donnees.soldeActualise),etatDecheance:t.contrat.isDechu,dureeTotaleCredit:0,montantGelCreance:0,dateDerniereEcheance:e.Constantes.Echeancier.DATE_DEFAULT}};return s},n.prototype.initEcheancierSimpleDegressivitePourCalculMontantTotal=function(t,n){var i=[],r=this.initPalier(1,t.donnees);i.push(r[0]);var o=null,a={palier:i,compte:o,libelleProduitCredit:null,dateProchaineEcheance:null,dureeResiduelle:null,dateFin:null,codeEtatPlanApurement:null,periode:null,pointBudget:null,numeroPersonTitulaireEcheancier:null,numeroTelephoneSms:null,adresseWebUrl:null,montantTotal:0,numeroHistoAccord:0,montantImpayeAccordRecouvrement:0,montantProchaineEcheance:0,tauxPenaliteRetard:0,dateConclusionAccord:n===e.Constantes.Echeancier.CODE_ACTION_CREATION?parseInt(ContentieuxCommun.Tools.DateUtils.format(moment().toDate(),"YYYYMMDD")):null,indicateurApurementTotalCreance:e.Constantes.Echeancier.CODE_APUREMENT_TOTAL_OUI,codeTypeOrigineFlux:e.Services.Echeancier.Tools.getCodeTypeOrigineFlux(t.payeur.payeur.isGarantie),indicateurPlanNeiertz:t.dossier.isDossierSurendettement?e.Constantes.Echeancier.CODE_NEIERTZ_OUI:e.Constantes.Echeancier.CODE_NEIERTZ_NON,indicateurMoratoire:e.Constantes.Echeancier.CODE_MORATOIRE_NON,indicGestionAutoCourrierRelance:e.Constantes.Echeancier.CODE_COURRIER_RELANCE_OUI,indicGestionAutoMiseEnDemeure:e.Constantes.Echeancier.CODE_COURRIER_MISE_EN_DEMEURE_OUI,indicateurPresenceHistoPlan:e.Constantes.Echeancier.CODE_PRESENCE_HISTORIQUE_NON,indicateurSmsRelanceNonPaiement:t.donnees.smsRelanceNonPaiment?e.Constantes.Echeancier.CODE_SMS_NON_PAIEMENT_OUI:e.Constantes.Echeancier.CODE_SMS_NON_PAIEMENT_NON,indicateurTauxPenaliteCreance:r[1],codeAction:n,codeEtablissement:t.dossier.codeEtablissement,numeroDossier:t.dossier.numeroDossier,identifiantCreance:t.donnees.identifiantCreance,codeTypeProduitService:t.contrat.codeTypeProduitService,codeProduitService:t.contrat.codeProduitService,identifiantContrat:t.contrat.identifiantContrat,typeEcheancier:e.Services.Echeancier.Tools.getCodeTypeEcheancier(t.typeEcheancier),montantAccord:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(t.donnees.montantAccord),datePremiereEcheance:parseInt(ContentieuxCommun.Tools.DateUtils.format(t.donnees.datePremiereEcheance,"YYYYMMDD")),dateMiseEnPlace:ContentieuxCommun.Tools.DateUtils.format(t.donnees.datePremiereEcheance,"YYYY-MM-DD"),dureeInitiale:t.donnees.dureeEcheancier,periodicite:e.Services.Echeancier.Tools.getCodePeriodicite(t.donnees.periodicite),indicateurAlerteSmsSurEcheance:t.donnees.smsEcheanceAVenir?e.Constantes.Echeancier.CODE_SMS_ECHEANCE_OUI:e.Constantes.Echeancier.CODE_SMS_ECHEANCE_NON,indicateurCalculAuto:e.Constantes.Echeancier.INDICATEUR_CALCUL_AUTO_OUI,indicateurPlanAvecPrelevement:e.Constantes.Echeancier.INDICATEUR_PLAN_PRELEVEMENT_NON,infosCreance:{dateFinContrat:e.Constantes.Echeancier.DATE_DEFAULT,soldeActualise:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(t.donnees.soldeActualise),etatDecheance:t.contrat.isDechu,dureeTotaleCredit:0,montantGelCreance:0,dateDerniereEcheance:e.Constantes.Echeancier.DATE_DEFAULT}};return a},n.prototype.initPalier=function(t,n){var i=n.tauxApplicable===n.tauxCreance,r={numero:t,duree:n.dureeEcheancier,montant:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(n.montantEcheance),taux:n.tauxApplicable,periode:null,montantRemboursementGel:0};return i?[r,e.Constantes.Echeancier.CODE_TAUX_PENALITE_CREANCE_OUI]:[r,e.Constantes.Echeancier.CODE_TAUX_PENALITE_CREANCE_NON]},n.prototype.initPalierModeExpert=function(e){var t={numero:e.numero,duree:null===e.duree||void 0===e.duree||""===e.duree.toString()?1:e.duree,montant:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(e.montant),taux:e.taux,periode:null,montantRemboursementGel:0};return t},n.prototype.initCompte=function(t,n,i,r){var o={numeroCompte:e.Constantes.Echeancier.NUMERO_COMPTE_DEFAULT,montantImpayesPrelevement:n,quotitePrelevee:t,codeTypeOrigineFlux:e.Services.Echeancier.Tools.getCodeTypeOrigineFlux(r),codeTypeCompte:"",numeroIBAN:"",codeBIC:"",compteSupportRecouvrement:0,eaCompteSupportRecouvrement:"00000",guichetCompteSupport:"00000"};return i.isInterne?(o.codeTypeCompte=e.Constantes.Echeancier.CODE_COMPTE_INTERNE,o.compteSupportRecouvrement=parseInt(i.rice.formatRICEPourCompte()),o.eaCompteSupportRecouvrement=i.rice.codeEtablissement,o.guichetCompteSupport=i.rice.getGuichet(),i.compteMySys&&(o.numeroIBAN=i.iban,o.codeBIC=i.bic),o):(o.codeTypeCompte=e.Constantes.Echeancier.CODE_COMPTE_EXTERNE,o.numeroIBAN=i.iban,o.codeBIC=i.bic,o.numeroCompte=i.ordre,o)},n.prototype.initCompteTemporaire=function(t){var n={numeroCompte:e.Constantes.Echeancier.NUMERO_COMPTE_DEFAULT,montantImpayesPrelevement:0,quotitePrelevee:100,codeTypeOrigineFlux:e.Services.Echeancier.Tools.getCodeTypeOrigineFlux(t),codeTypeCompte:e.Constantes.Echeancier.CODE_COMPTE_INTERNE,numeroIBAN:"",codeBIC:"",compteSupportRecouvrement:0,eaCompteSupportRecouvrement:"",guichetCompteSupport:""};return n},n.prototype.initPrelevementInterne=function(e){var t=null,n={rice:this.riceService.formatteRICE(e.eaCompteSupportRecouvrement,e.guichetCompteSupport,_.padLeft(e.compteSupportRecouvrement.toString(),11,"0").substring(0,9)),isInterne:!0,ordre:e.numeroCompte},i={typePaiement:"Prélèvement",modePrelevement:"Interne",parametreListeComptes:t,isNouveauCompte:!1,prelevement:n,listeComptesExternes:null};return i},n.prototype.initPrelevementExterne=function(e){var t=null,n={rice:this.riceService.formatteRICE(e.eaCompteSupportRecouvrement,e.guichetCompteSupport,_.padLeft(e.compteSupportRecouvrement.toString(),11,"0").substring(0,9)),isInterne:!1,ordre:e.numeroCompte};n.bic=e.codeBIC,n.iban=e.numeroIBAN;var i={typePaiement:"Prélèvement",modePrelevement:"Externe",parametreListeComptes:t,isNouveauCompte:!1,prelevement:n,listeComptesExternes:null};return i},n.prototype.mappePaiementPrelevement=function(e){var t=null;return"I"===e.codeTypeCompte?t=this.initPrelevementInterne(e):"E"===e.codeTypeCompte?t=this.initPrelevementExterne(e):null},n.prototype.mappeListeEcheanciers=function(e,t){var n=this,i=[];return _.forEach(e,function(e){i.push(n.mappeEcheancier(e,t))}),this.$q.all(i)},n.prototype.mappeEcheancier=function(n,i,r){var o=this,a=t.Tools.getTypeEcheancier(n.typeEcheancier);i.typeEcheancier=a[0];var s=null;null!==n.compte&&n.compte.length>0&&(s=n.compte.filter(function(e){return 100===e.quotitePrelevee}));var u={panel:null,modeEcheancier:r?r.modeEcheancier:null,pointBudget:r?r.pointBudget:null,isCalculAuto:r?r.isCalculAuto:!1,isCalculParDuree:r?r.isCalculParDuree:!1,isCalculParMontant:r?r.isCalculParMontant:!1,isTauxApplicable:r?r.isTauxApplicable:a[1],isAccordPartiel:r?r.isAccordPartiel:!1,typeEcheancier:a[0],isTypeDegressivite:a[2],isTypePaiement:a[1],dossier:r?r.dossier:t.Mappage.mappeDossier(n,i.identifiantEntiteTitulaire),contrat:t.Mappage.mappeContrat(n,i),paiement:null!==s&&s.length>0?this.mappePaiementPrelevement(s[0]):null,payeur:r?r.payeur:t.Mappage.mappePayeur(n),donnees:r?t.Mappage.mappeDonneesInput(r,n):t.Mappage.mappeDonnees(n),paliers:r?t.Mappage.mappeListePaliers(n.palier,i,!1,e.Constantes.Echeancier.MODE_SIMULATION):t.Mappage.mappeListePaliers(n.palier,i,t.Tools.isEcheancierActif(n.codeEtatPlanApurement),e.Constantes.Echeancier.MODE_VISUALISATION)},c={codeEtablissement:n.codeEtablissement,numeroDossier:n.numeroDossier,identifianCreance:n.identifiantCreance,codeProduitService:n.codeProduitService,typeEcheancier:u.typeEcheancier,numeroHistoAccord:n.numeroHistoAccord,identifiantEntiteTitulaire:i.identifiantEntiteTitulaire,isContratDechu:i.isContratDechu,isCreditNonDechu:i.isCreditNonDechu,listeParticipantsContrats:i.listeParticipantsContrats,dateFinContrat:i.dateFinContrat};return this.getPointBudget(c).then(function(e){return r?u.pointBudget=r.pointBudget:(e.montantCharges=ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantCharges),e.montantRevenusAutres=ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantRevenusAutres),e.montantRevenusLocatifs=ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantRevenusLocatifs),e.montantRevenusSalaire=ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantRevenusSalaire),u.pointBudget=e),r?(u.panel=o.mappePanel(r,r.payeur.payeur,""),u):o.getPayeur(i.codeEtablissement,n.numeroPersonTitulaireEcheancier,i).then(function(e){return u.panel=o.mappePanel(null,e,t.Mappage.mappeStatut(n.codeEtatPlanApurement)),u.payeur.payeur=e,u})})},n.prototype.mappePanel=function(t,n,i){var r="",o={id:"1",isOpen:!0,titre:r,statut:i};if(t){var a=void 0;return t.payeur.payeur.role?(a="Garantie"===t.payeur.payeur.role?e.Services.Garantie.Tools.formatLibelleTypeGarantie(t.payeur.payeur.libelle):t.payeur.payeur.role,o.titre=a+" - "+t.payeur.payeur.designation):o.titre=""+t.payeur.payeur.designation,o}if(null!==n){if(n)if(n.role){var a=void 0;a="Garantie"===n.role?e.Services.Garantie.Tools.formatLibelleTypeGarantie(n.libelle):n.role,
r=a+" - "+n.designation}else r=""+n.designation;return o.titre=r,o}return o.titre="Autre",o},n.prototype.getPersonne=function(e,t){return this.tiersService.getDesignationPersonne(e,t).then(function(e){return{designation:e,idPersonne:t,estPro:!1,libelle:e,role:"Autre",titulaire:!0,isGarantie:!1,infoGarantie:null}})},n.prototype.getParticipant=function(e,t,n){return this.entiteTitulaireService.getParticipants(e,t,!1).then(function(e){return _.find(e,function(e){return e.idPersonne===n})})},n.prototype.getPayeur=function(t,n,i){var r=this;return 0!==n?this.getParticipant(t,i.identifiantEntiteTitulaire,n).then(function(o){return o?o:r.garantieService.getGarantiesContratMappeParticipants(t,i.numeroDossier,i.identifianCreance,i.identifiantEntiteTitulaire,!1).then(function(o){var a=_.find(o,function(e){return e.idPersonne===n}),s=_.find(i.listeParticipantsContrats,function(e){return e.idPersonne===n});return a?s?(a.role=s.role,a):a:r.getPersonne(t,n).then(function(t){return t&&t.designation!==e.Constantes.Participant.ERREUR_DESIGNATION_ABSENTE?t:r.$q.when(null)})})}):this.entiteTitulaireService.getEntiteTitulaire(t,i.identifiantEntiteTitulaire).then(function(e){return""!==e.codeUsage?{designation:e.designation,idPersonne:n,estPro:!1,libelle:e.designation,role:"Client Bancaire",titulaire:!0,isGarantie:!1,infoGarantie:null}:r.$q.when(null)})},n.prototype.getDatePremiereEcheancePrelevementInterne=function(){return this.creanceParametre.getDateReglement(e.Constantes.Parametre.Reglement.CODE_MODE_REGLEMENT_PRELEVEMENT_INTERNE).then(function(e){return e})},n.prototype.getDatePremiereEcheancePrelevementExterne=function(){return this.creanceParametre.getDateReglement(e.Constantes.Parametre.Reglement.CODE_MODE_REGLEMENT_PRELEVEMENT_EXTERNE).then(function(e){return e})},n.prototype.getIBAN=function(e){if(e.paiement){if(e.paiement.prelevement.isInterne){var t=e.paiement.prelevement,n=t.rice;return this.communService.getIban(n.codeEtablissement,n.codeGuichet.value,""+n.codeActiviteCompte+n.radical+n.cleCompte,n.cleRice).then(function(e){return e.iban})}return this.$q.when("")}return this.$q.when("")},n.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,e.Constantes.Inject.Services.cacheService,Contentieux.RestServices.Commun.Constantes.Inject.Service.echeancierService,e.Constantes.Inject.SocleFonctionnel.saisieRiceService,e.Constantes.Inject.Services.entiteTitulaireService,e.Constantes.Inject.Services.tiersService,e.Constantes.Inject.Services.smsService,e.Constantes.Inject.Services.garantieService,e.Constantes.Inject.Services.communService,e.Constantes.Inject.Services.creanceParametre],n}();t.EcheancierService=n,e.app.service(e.Constantes.Inject.Services.echeancierService,n)}(n=t.Echeancier||(t.Echeancier={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(){}return t.getLibellePeriodicite=function(t){return t===e.Constantes.Echeancier.CODE_PERIODICITE_MENSUELLE?"Mensuelle":t===e.Constantes.Echeancier.CODE_PERIODICITE_TRIMESTRIEL?"Trimestrielle":t===e.Constantes.Echeancier.CODE_PERIODICITE_ANNUELLE?"Annuelle":void 0},t.getCodePeriodicite=function(t){return"Mensuelle"===t?e.Constantes.Echeancier.CODE_PERIODICITE_MENSUELLE:"Trimestrielle"===t?e.Constantes.Echeancier.CODE_PERIODICITE_TRIMESTRIEL:"Annuelle"===t?e.Constantes.Echeancier.CODE_PERIODICITE_ANNUELLE:void 0},t.getCodeTypeEcheancier=function(t){return"PaiementTotal"===t?e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_SURVEILLANCE:"PaiementPartiel"===t?e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_APUREMENT:"Degressivite"===t?e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_REGLEMENT:void 0},t.getTypeEcheancier=function(t){return t===e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_SURVEILLANCE?["PaiementTotal",!0,!1]:t===e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_APUREMENT?["PaiementPartiel",!0,!1]:t===e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_REGLEMENT?["Degressivite",!1,!0]:t===e.Constantes.Echeancier.CODE_TYPE_ECHEANCIER_SURVEILLANCE_CREDIT_NON_DECHU?["PaiementTotal",!0,!1]:void 0},t.isPalierEnCours=function(e,t){var n=moment();return n.isBetween(moment(e),moment(t))},t.isEcheancierActif=function(t){return t!==e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_SUPPRIME&&t!==e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_CADUC&&t!==e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_TERMINE},t.isEcheancierClos=function(t){return t===e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_SUPPRIME||t===e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_CADUC||t===e.Constantes.Echeancier.CODE_ETAT_PLAN_APUREMENT_TERMINE},t.getLienCompteGarantie=function(t,n){if(t.payeur.payeur.isGarantie){var i={codeAction:e.Constantes.Echeancier.MODE_CREATION_LIEN_GARANTIE,codeEtablissement:t.dossier.codeEtablissement,identifiantCreance:t.donnees.identifiantCreance,numeroGarantie:t.payeur.payeur.infoGarantie.numeroGarantieDossierCTX,numeroIBAN:n,dateCreationLien:ContentieuxCommun.Tools.DateUtils.format(moment().toDate(),"YYYY-MM-DD"),dateFinLien:t.payeur.payeur.infoGarantie.dateFinGarantie};return i}return null},t.getCodeTypeOrigineFlux=function(t){return t?e.Constantes.Echeancier.CODE_ORIGNE_FLUX_GARANTIE:e.Constantes.Echeancier.CODE_ORIGNE_FLUX_DEBITEUR},t.isTitulaireGarantie=function(t){return t===e.Constantes.Echeancier.CODE_ORIGNE_FLUX_GARANTIE},t}();t.Tools=n}(n=t.Echeancier||(t.Echeancier={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.EcheancierBDF||(e.EcheancierBDF={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Echeancier||(e.Echeancier={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n){this.$q=e,this.edsRestService=t,this.entiteTitulaireService=n}return t.prototype.getInformationEDSInterne=function(e,t){return this.edsRestService.getInformationEDSInterne(e,t).then(function(e){var t="";e.infoEDS.adresse3SiteCorrespondance&&(t=e.infoEDS.adresse3SiteCorrespondance),e.infoEDS.adresse4SiteCorrespondance&&(t+=" "+e.infoEDS.adresse4SiteCorrespondance);var n={telephone2:e.infoEDS.numeroTelephone2,telephoneAdresse:e.infoEDS.numeroTelephoneAdresse,designation:e.infoEDS.nomAgentTraitement,fax:e.infoEDS.numeroFax,email:e.infoEDS.adresseEMail,adresseCaisseEpargne:t,codePostalCaisseEpargne:e.infoEDS.adresse5SiteCorrespondance,gestionnaire:e.infoEDS.nomAgentTraitement,service:e.infoEDS.designationEDSRattachement,libelleTarifTel:e.infoEDS.libelleTarifTelEDS1,identifiantSite:e.infoEDS.identifiantSite,libelleFonctionGestionnaire:e.infoEDS.libelleFonction};return n})},t.prototype.getInformationSiege=function(e,t,n){return this.edsRestService.getInfosSiege(e,t,n).then(function(e){var t={lieuEnregistrement:e.MentionLegaleCorps.lieuEnregistrement,raisonSociale:e.MentionLegaleCorps.raisonSociale};return t})},t.prototype.getLibelleEtablissementLong=function(t){return this.edsRestService.getLibelleEtablissementLong(e.Constantes.Eds.ETABLISSEMENT_MYSYS_TYPE_LISTE).then(function(e){var n;return n=_.first(_.filter(e.Etablissement,function(e){return e.codeEtablissement===t})),n.libelleEtablissement})},t.prototype.getNumeroEdsGerePar=function(e,t){return this.entiteTitulaireService.getEntiteTitulaire(e,t,!1).then(function(e){return e.idGerePar})},t.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,Contentieux.RestServices.Commun.Constantes.Inject.Service.edsService,e.Constantes.Inject.Services.entiteTitulaireService],t}();t.EDSService=n,e.app.service(e.Constantes.Inject.Services.edsService,n)}(n=t.EDS||(t.EDS={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.EDS||(e.EDS={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n){this.personneRestService=e,this.$q=t,this.cacheService=n}return t.prototype.getEntiteTitulaire=function(e,t,n){var i=this;return void 0===n&&(n=!1),this.cacheService.get("PersonneServicegetEntiteTitulaire"+t,function(){return i.personneRestService.getInformationEntiteTitulaire(e,t).then(function(e){return{identifiantEntiteTitulaire:t,designation:e.caracteristiqueEntiteTitulaire.designationEntiteTitulaire,domiciliation:e.caracteristiqueEntiteTitulaire.libelleEDSDomiciliationEntiteTitulaire,gerePar:e.caracteristiqueEntiteTitulaire.libelleEDSGestionEntiteTitulaire,idDomiciliation:e.caracteristiqueEntiteTitulaire.identifiantEDSDomiciliationEntiteTitulaire,idGerePar:e.caracteristiqueEntiteTitulaire.identifiantEDSGestionEntiteTitulaire,modeComposition:e.caracteristiqueEntiteTitulaire.modeCompositionEntiteTitulaire,listePersonnesTitulaires:i.getListePersonnesPE(e.compositionEntiteTitulaire.listePersonneTitulaire),typeUsage:ContentieuxCommun.Metier.EntiteTitulaireUtils.getLibelleTypeUsageEntiteTitulaire(e.caracteristiqueEntiteTitulaire.codeUsageEntiteTitulaire,e.caracteristiqueEntiteTitulaire.modeCompositionEntiteTitulaire,e.caracteristiqueEntiteTitulaire.sousCodeModeCompositionET),codeUsage:e.caracteristiqueEntiteTitulaire.codeUsageEntiteTitulaire,libelleEDSGestionEntiteTitulaire:e.caracteristiqueEntiteTitulaire.libelleEDSGestionEntiteTitulaire}})["catch"](function(e){var n={identifiantEntiteTitulaire:t,designation:"Erreur : "+e.libelle,domiciliation:"",gerePar:"",idDomiciliation:0,idGerePar:0,modeComposition:"",codeUsage:"",libelleEDSGestionEntiteTitulaire:""};return i.$q.when(n)})},this.cacheService.defaultTimeToLive,n)},t.prototype.getParticipants=function(e,t,n){var i=this;return void 0===n&&(n=!1),this.cacheService.get("PersonneServicegetEntiteTitulaire"+t,function(){return i.personneRestService.getInformationEntiteTitulaire(e,t).then(function(e){return i.getListePersonnesPE(e.compositionEntiteTitulaire.listePersonneTitulaire)})},this.cacheService.defaultTimeToLive,n)},t.prototype.getParticipantsAvecEntiteTitulaire=function(e,t,n){var i=this;return void 0===n&&(n=!1),this.cacheService.get("PersonneServicegetEntiteTitulaire"+t,function(){return i.personneRestService.getInformationEntiteTitulaire(e,t).then(function(e){var t=i.mappeDesignationEntiteTitulaireToParticipant(e.caracteristiqueEntiteTitulaire),n=[];return n=i.getListePersonnesPE(e.compositionEntiteTitulaire.listePersonneTitulaire),n.length>1&&n.unshift(t),n})},this.cacheService.defaultTimeToLive,n)},t.prototype.mappeDesignationEntiteTitulaireToParticipant=function(t){return new e.Modeles.Participant.Participant(t.designationEntiteTitulaire,t.identifiantEntiteTitulaire,!1,"2"===t.codeUsageEntiteTitulaire,"Client Bancaire")},t.prototype.getListePersonnesPE=function(t){return _.chain(t).filter(function(e){return e.natureLienET===ContentieuxParametrage.Constantes.Dossier.codeNatureLienEntiteTitulairePE}).map(function(n){return new e.Modeles.Participant.Participant(n.designationTiers,n.identifiantTiers,!n.typeMandat,_.any(t,function(e){return e.identifiantTiers===n.identifiantTiers&&e.natureLienET===ContentieuxParametrage.Constantes.Dossier.codeNatureLienEntiteTitulaireProLA}))}).value()},t.prototype.getEntitesTitulaires=function(e,t,n){var i=this;return void 0===n&&(n=!1),this.$q.all(_.map(t,function(t){return i.getEntiteTitulaire(e,t,n)}))},t.prototype.getEntitesTitulairesDesignation=function(e){var t=this;if(0===e.listeInterrogationDesignation.length){var n=[];return this.$q.when(n)}return this.personneRestService.getInformationsEntitesTitulaires(e).then(function(e){return _.map(e.listeDesignation,function(e){return t.conversionIDesignationToIEntiteTitulaire(e)})})},t.prototype.conversionIDesignationToIEntiteTitulaire=function(e){return{designation:e.designationET,identifiantEntiteTitulaire:e.numeroEntiteTitulaire,domiciliation:null,idDomiciliation:null,modeComposition:null}},t.prototype.getEntitesTitulairesFromIdPersonne=function(e,t,n){var i=this;return void 0===n&&(n=!1),this.cacheService.get("PersonneServicegetEntitesTitulairesFromIdPersonne"+t,function(){return i.personneRestService.getRechercheEntiteTitulaire(e,t).then(function(e){return _.map(e.listeEntiteTitulaire,function(e){return{codeUsage:e.codeUsageEntiteTitulaire,designation:e.designationEntiteTitulaire,domiciliation:e.libelleEDSDomiciliation,idDomiciliation:e.identifiantEDSDomiciliation,identifiantEntiteTitulaire:e.identifiantEntiteTitulaire,modeComposition:e.modeCompositionEntiteTitulaire,modeCompositionIndivision:e.modeCompositionIndivision}})})},this.cacheService.defaultTimeToLive,n)},t.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Service.personneService,"$q",e.Constantes.Inject.Services.cacheService],t}();t.EntiteTitulaireService=n,e.app.service(e.Constantes.Inject.Services.entiteTitulaireService,n)}(n=t.EntiteTitulaire||(t.EntiteTitulaire={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.EntiteTitulaire||(e.EntiteTitulaire={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t){this.garantieRestService=e,this.creanceRestService=t}return t.prototype.getInformationGarantie=function(t,n){return this.garantieRestService.getInformationGarantie(t,n).then(function(t){var n={dateVersementProvisionnel:ContentieuxCommun.Tools.DateUtils.parse(t.dateVerstAppelProvisionnel),montantProvisionnelInitial:t.montantProvisionnelInitial,montantEcretageProvisionnel:t.montantEcretageProvisionnel,type:t.libelleTypeGarantie,dateAffectationGarantie:ContentieuxCommun.Tools.DateUtils.parse(t.dateAffectationGarantie),dateFinAffectationGarantie:ContentieuxCommun.Tools.DateUtils.parse(t.dateFinAffectationGarantie),codeSens:t.codeSensOperation===e.Constantes.Garantie.Garantie.CALCUL_VERSEMENT_GARANTIE_PGE?"Versement":"Remboursement",montantAppelFinal:t.montantAppelFinalGarantie,dateVersementFinal:ContentieuxCommun.Tools.DateUtils.parse(t.dateVerstAppelFinal),identifiant:t.identifiantExterneGarantie,dateVersementEcretage:ContentieuxCommun.Tools.DateUtils.parse(t.dateEcretageProvisionnel)};return n})},t.prototype.calculerMontantGarantiePGE=function(t,n){var i={codeEtablissement:t,codeSens:"Versement"===n.codeSens?e.Constantes.Garantie.Garantie.CALCUL_VERSEMENT_GARANTIE_PGE:e.Constantes.Garantie.Garantie.CALCUL_REMBOURSEMENT_GARANTIE_PGE,identifiantCreance:n.identifiantCreance,montantAppelFinal:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(n.montantAppelFinal),montantAppelProvisionnel:ContentieuxCommun.Tools.Montant.montantEuroVersCentimesArrondi(n.montantAppelProvisionnel),numeroDossier:n.numeroDossier,referenceExterneGarantie:n.referenceExterneGarantie,montantTotalMisEnJeu:0};return this.creanceRestService.calculerGarantiePGE(i).then(function(e){return ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(e.montantTotalMisEnJeu)})},t.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Service.informationGarantiePGEService,Contentieux.RestServices.Commun.Constantes.Inject.Service.creanceService],t}();t.GarantiePGEService=n,e.app.service(e.Constantes.Inject.Services.garantiePGEService,n)}(n=t.GarantiePGE||(t.GarantiePGE={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n,i,r,o){this.$q=e,this.serviceAgent=t,this.tiersRestService=n,this.dossierRestService=i,this.creanceRestService=r,this.entiteTitulaireService=o}return t.prototype.getDesignationPersonneGarantie=function(e,t){var n=this;return void 0===t&&(t=!1),this.serviceAgent.getAuthentificationInfo().then(function(t){var i={listeInterrogationDesignation:[{codeEtablissement:t.codeEtablissement,numeroPersonne:e}]};return n.tiersRestService.getDesignationsPersonnes(i).then(function(e){return{numeroPersonneGarantie:_.first(e.listeDesignation).numeroPersonne,designationLongue:_.first(e.listeDesignation).designationPersonne}})})},t.prototype.getListeGarantiesPersonnesMorales=function(e){var t=this;if(0===e.listeInterrogationDesignation.length){var n=[];return this.$q.when(n)}return this.tiersRestService.getDesignationsPersonnes(e).then(function(e){return _.map(e.listeDesignation,function(e){return t.conversionIDesignationPersonneToIGarantiePersonneMorale(e)})})},t.prototype.conversionIDesignationPersonneToIGarantiePersonneMorale=function(e){return{designationLongue:e.designationPersonne,numeroPersonneGarantie:e.numeroPersonne}},t.prototype.getListeGarantiesContrat=function(e,t,n,i,r){return this.dossierRestService.getGarantie(e,t,n,i,r)},t.prototype.getGarantiesContratMappeParticipants=function(t,n,i,r,o){var a=this;return this.entiteTitulaireService.getParticipantsAvecEntiteTitulaire(t,r,!1).then(function(r){return a.getListeGarantiesContrat(t,n,i,e.Constantes.Garantie.Garantie.avecDetail).then(function(t){if(t.length>0&&null!==t[0]){var n=_.filter(t,function(t){return t.detailGarantie.codeNatureGarantieMySys===e.Constantes.Garantie.Garantie.CODE_NATURE_GARANTIE_PERSONNE_PHYSIQUE||t.detailGarantie.codeNatureGarantieMySys===e.Constantes.Garantie.Garantie.CODE_NATURE_GARANTIE_PERSONNE_MORALE});return a.$q.all(_.map(n,function(e){return a.mappeGarantieToParticipant(e,r,o)}))}return a.$q.when([])})})},t.prototype.mappeGarantieToParticipant=function(t,n,i){var r="Garantie",o=_.find(n,function(e){return e.idPersonne===t.surete.numeroPersonne}),a={designation:"",estPro:t.codeGarantie===e.Constantes.Garantie.Garantie.CODE_NATURE_GARANTIE_PERSONNE_MORALE,idPersonne:t.identifiantPersonneGarant,libelle:"",role:r,titulaire:!1,isGarantie:!0,infoGarantie:t};return t.surete.numeroPersonne?this.getDesignationPersonneGarantie(t.surete.numeroPersonne).then(function(n){return o?(a.designation=o.designation,a.role=o.role):a.designation=n.designationLongue,a.libelle=e.Services.Garantie.Tools.formatLibelleGarantieSuretePersonnelle(t,n,i),a}):0!==t.detailGarantie.identifiantPersonneGarant?this.getDesignationPersonneGarantie(t.detailGarantie.identifiantPersonneGarant).then(function(n){return a.designation=n.designationLongue,a.libelle=e.Services.Garantie.Tools.formatLibelleGarantieSureteReelle(t,n,i),o&&(a.designation=o.designation,a.role=o.role),a}):(a.libelle=e.Services.Garantie.Tools.formatLibelleGarantieDefault(t,i),this.$q.when(a))},t.prototype.ajouterLienCompteRecouvrementGarantie=function(t){if(null===t)return this.$q.when();var n=this.initPostGarantie(t);return this.creanceRestService.postGarantie(e.Constantes.Echeancier.TOP_CREATION_LIEN_HISTO_GARANTIE_NON,e.Constantes.Echeancier.TOP_LIEN_COMPTE_GARANTIE_OUI,n).then(function(){})},t.prototype.initPostGarantie=function(e){var t={detailGarantie:null,codeGarantie:null,dateFinGarantie:null,identifiantPersonneGarant:null,indicateurGarantieEnTaux:null,numeroDossier:null,numeroGarantieDossierCTX:null,surete:null};return t.detailGarantie=this.initRestDetailGarantie(e),t},t.prototype.initRestDetailGarantie=function(e){var t={lienCpteRecvGaranti:null,codeAction:null,codeCategorieGarantie:null,codeEtablissement:null,codeGarantie:null,codeNatureGarantieMySys:null,dateAffectationGarantie:null,dateFinAffectationGarantie:null,datePremiereMiseEnJeuGarantie:null,datePublication:null,identifiantAgent:null,identifiantCreance:null,identifiantPersonneGarant:null,indicateurAlerteActivee:null,indicateurContreGarantieRisque:null,indicateurDecoteGarantie:null,indicateurEditionCaution:null,indicateurMisEnJeuGarantieTotal:null,indicateurValorisatTauxCouvertu:null,libelleGarantie:null,libelleTypeGarantie:null,lienHistoFinanceGarantie:null,montantActuelGarantie:null,montantCouvertureCreanceGar:null,montantInitialCouvertParGaranti:null,montantInitialGarantie:null,numeroDossier:null,numeroGarantieDossierCTX:null,objetGarantie:null,rangGarantie:null,rangHypotheque:null,referenceExterneGarantie:null,tauxDecoteGarantie:null,tauxGarantie:null,topGarantieUtiliseeCalcul:null,typeGarantieGCE:null,indicateurGarantieEtatPGE:null};return t.lienCpteRecvGaranti=this.initRestLienCompteRecouvrementGarantie(e),t},t.prototype.initRestLienCompteRecouvrementGarantie=function(e){var t={codeAction:e.codeAction,codeEtablissement:e.codeEtablissement,identifiantCreance:e.identifiantCreance,numeroGarantie:e.numeroGarantie,numeroIBAN:e.numeroIBAN,dateCreationLienRecouvGarantie:e.dateCreationLien,dateFinLienRecouvGarantie:e.dateFinLien};return t},t.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,ContentieuxCommun.Constantes.Inject.MyWay.serviceAgentExtended,Contentieux.RestServices.Commun.Constantes.Inject.Service.tiersService,Contentieux.RestServices.Commun.Constantes.Inject.Service.dossierService,Contentieux.RestServices.Commun.Constantes.Inject.Service.creanceService,e.Constantes.Inject.Services.entiteTitulaireService],t}();t.GarantieService=n,e.app.service(e.Constantes.Inject.Services.garantieService,n)}(n=t.Garantie||(t.Garantie={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(){}return t.formatLibelleGarantieSuretePersonnelle=function(t,n,i){var r="";return i?(r=""+e.Constantes.Garantie.Garantie.LIBELLE_CHOIX_LISTE,r+=" - "+t.detailGarantie.libelleTypeGarantie,r+=" - "+n.designationLongue,t.surete.indicateurGarantieEnTaux===e.Constantes.Garantie.Garantie.INDICATEUR_GARANTIE_EN_TAUX_OUI?r+=" - "+t.surete.quotite+"%":t.surete.indicateurGarantieEnTaux===e.Constantes.Garantie.Garantie.INDICATEUR_GARANTIE_EN_TAUX_NON&&(r+=" - "+t.surete.montant+"€"),r+=" - "+moment(t.dateFinGarantie,ContentieuxCommun.Constantes.Generique.formatDateRecouvrement).format(ContentieuxCommun.Constantes.Generique.formatDate)):(r=""+t.detailGarantie.libelleTypeGarantie,r+=" - "+n.designationLongue),r},t.formatLibelleGarantieSureteReelle=function(t,n,i){var r="";return i?(r=""+e.Constantes.Garantie.Garantie.LIBELLE_CHOIX_LISTE,r+=" - "+t.detailGarantie.libelleTypeGarantie,r+=" - "+n.designationLongue,r+=" -"+t.surete.montant+"€",r+=" - "+moment(t.dateFinGarantie,ContentieuxCommun.Constantes.Generique.formatDateRecouvrement).format(ContentieuxCommun.Constantes.Generique.formatDate)):(r=""+t.detailGarantie.libelleTypeGarantie,r+=" - "+n.designationLongue),r},t.formatLibelleGarantieDefault=function(t,n){var i="";return n?(i=""+e.Constantes.Garantie.Garantie.LIBELLE_CHOIX_LISTE,i+=" - "+t.detailGarantie.libelleTypeGarantie,i+=" - "+t.surete.montant+"€",i+=" - "+moment(t.dateFinGarantie,ContentieuxCommun.Constantes.Generique.formatDateRecouvrement).format(ContentieuxCommun.Constantes.Generique.formatDate)):i=""+t.detailGarantie.libelleTypeGarantie,i},t.formatLibelleTypeGarantie=function(t){var n=t;return(-1!==t.indexOf(e.Constantes.Garantie.Garantie.LIBELLE_GARANTIE_PERSONNE_PHYSIQUE)||-1!==t.indexOf(e.Constantes.Garantie.Garantie.LIBELLE_GARANTIE_PERSONNE_MORALE))&&(n=e.Constantes.Garantie.Garantie.LIBELLE_GARANTIE_CAUTION),n},t}();t.Tools=n}(n=t.Garantie||(t.Garantie={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.GarantiePGE||(e.GarantiePGE={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Garantie||(e.Garantie={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n){this.serviceAgent=e,this.$q=t,this.portefeuilleRestService=n}return t.prototype.isRoleSuperviseur=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.superviseur)},t.prototype.isRoleConsultation=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.consultation)},t.prototype.isRoleGestionnaire=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.gestionnaire)},t.prototype.isHabiliteDecompteGestion=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.DECOMPTES_GESTION)},t.prototype.isHabiliteDecompteConsultation=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.DECOMPTES_CONSULTATION)},t.prototype.isHabiliteGarantieGestion=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.GARANTIE_GESTION)},t.prototype.isHabiliteGarantieConsultation=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.GARANTIE_CONSULTATION)},t.prototype.isHabiliteProvisionGestion=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.PROVISION_GESTION)},t.prototype.isHabiliteProvisionConsultation=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.PROVISION_CONSULTATION)},t.prototype.isHabiliteCreanceDossierGestion=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.CREANCE_DOSSIER_GESTION)},t.prototype.isHabiliteCreanceDossierConsultation=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.CREANCE_DOSSIER_CONSULTATION)},t.prototype.isHabiliteAccesEDG=function(){return this.serviceAgent.Habilitation.EstHabilite(e.Constantes.ContentieuxHabilitations.ACCES_EDG)},t.prototype.isHabilite=function(e){switch(e){case"superviseur":return this.isRoleSuperviseur();case"consultation":return this.isRoleConsultation();case"gestionnaire":return this.isRoleGestionnaire();default:return this.$q.when(!1)}},t.prototype.isHabiliteFonction=function(e){switch(e){case"decomptesGestion":return this.isHabiliteDecompteGestion();case"decomptesConsultation":return this.isHabiliteDecompteConsultation();case"garantiesGestion":return this.isHabiliteGarantieGestion();case"garantiesConsultation":return this.isHabiliteGarantieConsultation();case"provisionGestion":return this.isHabiliteProvisionGestion();case"provisionConsultation":return this.isHabiliteProvisionConsultation();case"creanceDossierGestion":return this.isHabiliteCreanceDossierGestion();case"creanceDossierConsultation":return this.isHabiliteCreanceDossierConsultation();case"accesEdg":return this.isHabiliteAccesEDG();default:return this.$q.when(!1)}},t.prototype.getHabilitationsPortefeuilles=function(t,n){return this.portefeuilleRestService.getHabilitationsPortefeuille(t,n,e.Constantes.ContentieuxHabilitations.codeAccesTous).then(function(e){var t=_.map(e,function(e){return{codeEtablissement:e.codeEtablissement,codeAgence:e.codeAgence,identifiantPortefeuille:e.identifiantPortefeuille.toString(),libellePortefeuille:e.libellePortefeuille1+" "+e.libellePortefeuille2,libelleMesPortefeuilles:e.libellePortefeuille1+" "+e.libellePortefeuille2,identifiantEDS:e.identifiantEDS,codeModeAcces:e.codeModeAcces,codeTypeRattachement:e.codeTypeRattachement}});return t})},t.prototype.isPortefeuilleHabiliteGestion=function(t,n){var i=_.find(n,function(e){return e.identifiantPortefeuille===t.toString()});return i.codeModeAcces===e.Constantes.ContentieuxHabilitations.codeAccesGestionPortefeuille},t.prototype.isPortefeuilleHabiliteConsultation=function(t,n){var i=_.find(n,function(e){return e.identifiantPortefeuille===t.toString()});return i.codeModeAcces===e.Constantes.ContentieuxHabilitations.codeAccesConsultationPortefeuille},t.prototype.isPortefeuilleHabiliteIdentification=function(t,n){var i=_.find(n,function(e){return e.identifiantPortefeuille===t.toString()});return[i.codeModeAcces===e.Constantes.ContentieuxHabilitations.codeAccesIdentificationPortefeuille,i.libellePortefeuille]},t.$inject=[e.Constantes.Inject.MyWay.serviceAgent,e.Constantes.Inject.Angular.$q,Contentieux.RestServices.Commun.Constantes.Inject.Service.portefeuilleService],t}();t.HabilitationsService=n,e.app.service(e.Constantes.Inject.Services.habilitationsService,n)}(n=t.Habilitations||(t.Habilitations={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Habilitations||(e.Habilitations={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.OperationDiverse||(e.OperationDiverse={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t){this.$q=e,this.serviceAgentExtended=t}return t.prototype.getCodeFamilleParCodeType=function(t,n){var i=this.$q.defer(),r=[{propriete:e.Constantes.TablesDelocalisees.JU2B.PROPRIETE_TABLE_DELOC_COJXHD,valeur:n,operateur:MyWay.Services.DonneesDelocalisees.CRITERES_OPERATEUR.EGAL},{propriete:e.Constantes.TablesDelocalisees.JU2B.PROPRIETE_TABLE_DELOC_YNOXCE,valeur:t,operateur:MyWay.Services.DonneesDelocalisees.CRITERES_OPERATEUR.EGAL}];return this.serviceAgentExtended.DonneesDelocalisees.getDonneesParCriteres(t,e.Constantes.TablesDelocalisees.TABLE_DELOC_TYPES_OD_JU2B,r).then(function(e){i.resolve(e[0])}),i.promise},t.$inject=[e.Constantes.Inject.Angular.$q,e.Constantes.Inject.MyWay.serviceAgentExtended],t}();t.OperationDiverseService=n,e.app.service(e.Constantes.Inject.Services.operationDiverseService,n)}(n=t.OperationDiverse||(t.OperationDiverse={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){var n=function(){function t(e,t,n,i,r,o,a){this.$q=e,this.paiementService=t,this.dossierSyntheseService=n,this.garantieService=i,this.dossierService=r,this.entiteTitulaireService=o,this.compteCCIEService=a}return t.prototype.getEligibiliteModePaiement=function(e,t,n){return this.paiementService.getEligibiteModePaiement(e,n,t).then(function(e){var t={topPaiementCB:"O"===e.topPaiementCB?!0:!1,topPaiementCheque:"O"===e.topPaiementCheque?!0:!1,topPaiementPrelevement:"O"===e.topPaiementPrelevement?!0:!1,motifCBNonAutorisee:e.motifCBNonAutorisee,motifChequeNonAutorise:e.motifChequeNonAutorise,motifPrelevementNonAutorise:e.motifPrelevementNonAutorise};return t})},t.prototype.getlistePayeurChqPrelev=function(t,n,i,r,o){var a=this,s=[];return this.entiteTitulaireService.getParticipants(t,r,!1).then(function(u){var c=[];return c.push(function(){return a.dossierSyntheseService.getContratsMySys(t,_.padLeft(r.toString(),12,"0"),!0).then(function(e){var t=e[0].participants;return u=u?u.concat(t):u,_.forEach(u,function(e){"Caution"!==e.role&&s.push(a.mappeParticipantEnPayeur(e))}),s})}),o?(c.push(function(){return a.dossierService.getGarantie(t,n,i,e.Constantes.Paiement.Commun.Garantie.AVEC_DETAIL).then(function(t){return _.forEach(t,function(t){t.detailGarantie.codeCategorieGarantie!==e.Constantes.Garantie.Garantie.codeCategorieGarantieAutre&&s.push(a.mappeGarantieEnPayeur(t))}),s})}),c[0]().then(function(){return c.length>1?c[1]():void 0})):c[0]()})},t.prototype.getlistePayeurCB=function(t,n,i,r,o){var a=this,s=[];return this.entiteTitulaireService.getParticipants(t,r,!1).then(function(u){var c=[];return c.push(function(){return a.dossierSyntheseService.getContratsMySys(t,_.padLeft(r.toString(),12,"0"),!0).then(function(e){
var t=e[0].participants;return u=u?u.concat(t):u,_.forEach(u,function(e){"Caution"!==e.role&&s.push(a.mappeParticipantEnPayeur(e))}),s})}),o?(c.push(function(){return a.dossierService.getGarantie(t,n,i,e.Constantes.Paiement.Commun.Garantie.AVEC_DETAIL).then(function(t){return _.forEach(t,function(t){t.detailGarantie.codeCategorieGarantie!==e.Constantes.Garantie.Garantie.codeCategorieGarantieAutre&&t.detailGarantie.codeNatureGarantieMySys===e.Constantes.Garantie.Garantie.CODE_NATURE_GARANTIE_PERSONNE_PHYSIQUE&&s.push(a.mappeGarantieEnPayeur(t))}),s})}),c[0]().then(function(){return c.length>1?c[1]():void 0})):c[0]()})},t.prototype.getCompteCCIE=function(e){return this.compteCCIEService.getCompteCCIE(e).then(function(e){var t={codeEtablissement:e.codeEtablissement,codeGuichet:e.codeGuichet,referenceProduit:e.referenceProduit};return t})},t.prototype.mappeGarantieEnPayeur=function(t){var n={typePayeur:e.Constantes.Paiement.Commun.Garantie.TYPE_GARANTIE,codeGarantie:t.codeGarantie,dateFinGarantie:t.dateFinGarantie,numeroDossier:t.numeroDossier,numeroGarantie:t.numeroGarantieDossierCTX,identifiantPersonneGarant:t.identifiantPersonneGarant,detailGarantie:t.detailGarantie,surete:t.surete};return t.surete.numeroPersonne?this.garantieService.getDesignationPersonneGarantie(t.surete.numeroPersonne).then(function(e){"O"===t.surete.indicateurGarantieEnTaux?n.libelle="Garantie - "+t.detailGarantie.libelleTypeGarantie+" - "+e.designationLongue+" - "+t.surete.quotite+"% - "+moment(t.dateFinGarantie,ContentieuxCommun.Constantes.Generique.formatDateRecouvrement).format("DD/MM/YYYY"):"N"===t.surete.indicateurGarantieEnTaux&&(n.libelle="Garantie - "+t.detailGarantie.libelleTypeGarantie+" - "+e.designationLongue+" - "+t.surete.montant+"€ - "+moment(t.dateFinGarantie,ContentieuxCommun.Constantes.Generique.formatDateRecouvrement).format("DD/MM/YYYY")),n.referencePayeur="G - "+e.designationLongue}):0!==t.detailGarantie.identifiantPersonneGarant?this.garantieService.getDesignationPersonneGarantie(t.detailGarantie.identifiantPersonneGarant).then(function(e){n.libelle="Garantie - "+t.detailGarantie.libelleTypeGarantie+" - "+e.designationLongue+" - "+t.surete.montant+"€ - "+moment(t.dateFinGarantie,ContentieuxCommun.Constantes.Generique.formatDateRecouvrement).format("DD/MM/YYYY"),n.referencePayeur="G - "+e.designationLongue}):(n.libelle="Garantie - "+t.detailGarantie.libelleTypeGarantie+" - "+t.surete.montant+"€ - "+moment(t.dateFinGarantie,ContentieuxCommun.Constantes.Generique.formatDateRecouvrement).format("DD/MM/YYYY"),n.referencePayeur="G - "+t.detailGarantie.libelleTypeGarantie),n},t.prototype.mappeParticipantEnPayeur=function(t){var n={typePayeur:e.Constantes.Paiement.Commun.TYPE_PARTICIPANT,libelle:t.libelle,designation:t.designation,estPro:t.estPro,idPersonne:t.idPersonne,role:t.role,titulaire:t.titulaire};return n},t.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Angular.$q,Contentieux.RestServices.Commun.Constantes.Inject.Service.paiementService,e.Constantes.Inject.Services.dossierSyntheseService,e.Constantes.Inject.Services.garantieService,Contentieux.RestServices.Commun.Constantes.Inject.Service.dossierService,e.Constantes.Inject.Services.entiteTitulaireService,Contentieux.RestServices.Commun.Constantes.Inject.Service.compteCCIEService],t}();t.Paiement=n,e.app.service(e.Constantes.Inject.Services.paiement,n)}(n=t.Paiement||(t.Paiement={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Personne||(e.Personne={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n){this.$q=e,this.personneRestService=t,this.cacheService=n}return t.prototype.getNoteBale2=function(e,t){return this.personneRestService.getNoteBale2(e,t).then(function(e){var t=e.listeNoteBale2&&e.listeNoteBale2.length>0?e.listeNoteBale2[0].noteBale2calculee:null;return t?t.slice(1):null})},t.prototype.getListeTelsMobile=function(e,t){return this.personneRestService.getMedia(e,t).then(function(e){var t=[];return _.forEach(e.listeMedia,function(e){if("02"===e.codeTypeMedia){var n=ContentieuxCommun.Tools.Telephone.formatterTelephone(e.indicatifTelephone,e.referenceAccesMedia);""!==n&&t.push(n)}}),t})},t.prototype.getMail=function(e,t){return this.personneRestService.getMedia(e,t).then(function(e){var t=[];return _.forEach(e.listeMedia,function(e){"03"===e.codeTypeMedia&&t.push(e.referenceAccesMedia)}),t.length>0?t[0]:"Non renseigné"})},t.prototype.getAdressePostale=function(e,t){var n=this;return this.personneRestService.getAdressePostale(e,t).then(function(e){var t=_.find(e,function(e){return"4"===e.codeTypeAdresse}),i=_.find(e,function(e){return"1"===e.codeTypeAdresse});return t?n.mappeAdresse(t):n.mappeAdresse(i)})},t.prototype.mappeAdresse=function(e){var t={ligneDestinataire:"",ligne1AdresseAFNOR:e.ligne1AdresseAFNOR,ligne2AdresseAFNOR:e.ligne2AdresseAFNOR,ligne3AdresseAFNOR:e.ligne3AdresseAFNOR,ligne4AdresseAFNOR:e.ligne4AdresseAFNOR,ligne5AdresseAFNOR:e.ligne5AdresseAFNOR,ligne6AdresseAFNOR:e.ligne6AdresseAFNOR,ligne7AdresseAFNOR:e.ligne7AdresseAFNOR,libelleISOPays:e.libelleISOPays,typeAdresse:e.typePersonne};return t},t.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,Contentieux.RestServices.Commun.Constantes.Inject.Service.personneService,e.Constantes.Inject.Services.cacheService],t}();t.PersonneService=n,e.app.service(e.Constantes.Inject.Services.personneService,n)}(n=t.Personne||(t.Personne={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.PointBudget||(e.PointBudget={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n){this.$q=e,this.pointBudgetRestService=t,this.cacheService=n}return t.prototype.getPointBudget=function(t,n,i,r,o,a){return this.pointBudgetRestService.getEcheancier(t,n,i,r,o,a,e.Constantes.Echeancier.MODE_COMPLET,!1).then(function(e){var t={montantCharges:e[0].pointBudget.montantCharges,montantRevenusAutres:e[0].pointBudget.montantAutresRevenus,montantRevenusLocatifs:e[0].pointBudget.montantRevenusLocatifs,montantRevenusSalaire:e[0].pointBudget.montantSalaire};return t})},t.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,Contentieux.RestServices.Commun.Constantes.Inject.Service.echeancierService,e.Constantes.Inject.Services.cacheService],t}();t.PointBudgetService=n,e.app.service(e.Constantes.Inject.Services.pointBudgetService,n)}(n=t.PointBudget||(t.PointBudget={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Portefeuille||(e.Portefeuille={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(t,n){this.portefeuilleRestService=t,this.$q=n,this.mesPortefeuilles={identifiantPortefeuille:e.Constantes.Portefeuille.Affichage.mesPortefeuillesIdentifiant,libellePortefeuille:e.Constantes.Portefeuille.Affichage.mesPortefeuillesLibelle,libelleMesPortefeuilles:e.Constantes.Portefeuille.Affichage.mesPortefeuillesLibelle,identifiantEDS:e.Constantes.Portefeuille.Affichage.mesPortefeuillesIdentifiantEDS,identifiantEDSSuperieur:e.Constantes.Portefeuille.Affichage.mesPortefeuillesIdentifiantEDSsuperieur,nombreDossiersActifs:e.Constantes.Portefeuille.Affichage.mesPortefeuillesNbDossiersActifs,typePortefeuille:"Collaborateur",codeAgence:"",codeEtablissement:"",codeModeAcces:"",codeTypeRattachement:""}}return t.prototype.getPortefeuillesByEtablissement=function(e,t){var n=this;return this.portefeuilleRestService.recherchePortefeuilleParEtablissement(e).then(function(e){var i=_.map(e.portefeuilleEtablissement,function(e){return{identifiantPortefeuille:e.identifiantRedacteur.toString(),libellePortefeuille:e.libelle,libelleMesPortefeuilles:e.libelle,identifiantEDS:e.identifiantEDS,identifiantEDSSuperieur:e.identifiantEDSSuperieur,nombreDossiersActifs:e.nombreDeDossierActif}});return i=_.chain(i).sortBy("libellePortefeuille").value(),t&&(n.mesPortefeuilles.nombreDossiersActifs=i.reduce(function(e,t,n,i){return e+t.nombreDossiersActifs},0),i.unshift(n.mesPortefeuilles)),i})},t.prototype.getPortefeuillesByEDS=function(e,t,n){var i=this;return this.portefeuilleRestService.recherchePortefeuilleParEDS(e,t).then(function(e){var t=_.map(e.mesPortefeuilles,function(e){return{identifiantPortefeuille:e.identifiantRedacteur.toString(),libellePortefeuille:e.libelle,libelleMesPortefeuilles:e.libelle,identifiantEDS:e.identifiantEDS,identifiantEDSSuperieur:e.identifiantEDSSuperieur,nombreDossiersActifs:e.nombreDeDossierActif,typePortefeuille:"MesPortefeuilles",codeAgence:"",codeEtablissement:"",codeModeAcces:"",codeTypeRattachement:""}});t=_.chain(t).sortBy("libellePortefeuille").value(),n&&(i.mesPortefeuilles.nombreDossiersActifs=t.reduce(function(e,t,n,i){return e+t.nombreDossiersActifs},0),t.unshift(i.mesPortefeuilles));var r=_.map(e.portefeuilleCollaborateur,function(e){return{identifiantPortefeuille:e.identifiantRedacteur.toString(),libellePortefeuille:e.libelle,libelleMesPortefeuilles:e.libelle,identifiantEDS:e.identifiantEDS,identifiantEDSSuperieur:e.identifiantEDSSuperieur,nombreDossiersActifs:e.nombreDeDossierActif,typePortefeuille:"Collaborateur",codeAgence:"",codeEtablissement:"",codeModeAcces:"",codeTypeRattachement:""}});r=_.chain(r).sortBy("libellePortefeuille").value();var o=_.map(e.portefeuilleEtablissement,function(e){return{identifiantPortefeuille:e.identifiantRedacteur.toString(),libellePortefeuille:e.libelle,libelleMesPortefeuilles:e.libelle,identifiantEDS:e.identifiantEDS,identifiantEDSSuperieur:e.identifiantEDSSuperieur,nombreDossiersActifs:e.nombreDeDossierActif,typePortefeuille:"Etablissement",codeAgence:"",codeEtablissement:"",codeModeAcces:"",codeTypeRattachement:""}});return o=_.chain(o).sortBy("libellePortefeuille").value(),i.$q.all([i.$q.when(t),i.$q.when(r),i.$q.when(o)])})},t.prototype.filtrerHabilitationsPortefeuille=function(t,n){var i;return t.forEach(function(e){var t=_.find(n,function(t){return t.identifiantPortefeuille===e.identifiantPortefeuille});t&&(e.codeModeAcces=t.codeModeAcces)}),i=t.filter(function(t){return t.codeModeAcces!==e.Constantes.ContentieuxHabilitations.codeAccesIdentificationPortefeuille})},t.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Service.portefeuilleService,ContentieuxCommun.Constantes.Inject.Angular.$q],t}();t.PortefeuilleService=n,e.app.service(e.Constantes.Inject.Services.portefeuilleService,n)}(n=t.Portefeuille||(t.Portefeuille={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Processus||(e.Processus={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n){this.$q=e,this.dossierNumeriqueService=t,this.habilitationsService=n}return t.prototype.getListeProcessusPourContratMySys=function(t,n,i){var r,o=this,a=[];return this.isAutoriseDNC(i.codeTypeProduitService)&&(r=""+i.codeEtablissement+e.Constantes.DossierNumerique.dossierNumeriqueCredit.formatageEspace+i.reference,this.dossierNumeriqueService.dossierNumeriqueExiste(e.Constantes.DossierNumerique.codeFournisseur.creditInstruction,r).then(function(e){e&&a.push(o.getProcessusDossierNumeriqueCredit(i.codeEtablissement,n,r))})),a},t.prototype.getListeProcessusPourContratMyVario=function(t,n,i){var r,o,a,s,u,c,l,m,C,E,d,v=this,f=[];if((t.gestionnaire||t.superviseur)&&this.habilitationsService.isPortefeuilleHabiliteGestion(n.identifiantPortefeuille,t.portefeuilles)&&this.isExigible(i.dettes)&&(r=this.getProcessusEffectuerPaiement(n,i),f.push(r)),this.isPerteTotal(i.dettes)?i.etiquetteContrat===ContentieuxParametrage.Constantes.ContentieuxMetier.etiquetteEcheancierCB?(o=this.getProcessusGererEcheancierCB(n,i,!1),f.push(o)):(i.etatEcheancier===ContentieuxParametrage.Constantes.ContentieuxMetier.echeancierCBTermine||i.etatEcheancier===ContentieuxParametrage.Constantes.ContentieuxMetier.echeancierCBSupprime||i.etatEcheancier===ContentieuxParametrage.Constantes.ContentieuxMetier.echeancierCBCaduc)&&(o=this.getProcessusGererEcheancierCB(n,i,!0),f.push(o)):i.etiquetteContrat===ContentieuxParametrage.Constantes.ContentieuxMetier.etiquetteEcheancier?(o=this.getProcessusGererEcheancierVisualisation(n,i),f.push(o)):i.etiquetteContrat===ContentieuxParametrage.Constantes.ContentieuxMetier.etiquetteEcheancierCB?(o=this.getProcessusGererEcheancierCB(n,i,!1),f.push(o)):i.etatEcheancier===ContentieuxParametrage.Constantes.ContentieuxMetier.echeancierEnAttenteSignature||i.etatEcheancier===ContentieuxParametrage.Constantes.ContentieuxMetier.echeancierCaduc||i.etatEcheancier===ContentieuxParametrage.Constantes.ContentieuxMetier.echeancierSupprime||i.etatEcheancier===ContentieuxParametrage.Constantes.ContentieuxMetier.echeancierTermine?(o=this.getProcessusGererEcheancierVisualisation(n,i),f.push(o)):(i.etiquetteContrat!==ContentieuxParametrage.Constantes.ContentieuxMetier.etiquetteRegularise&&(t.gestionnaire||t.superviseur)&&this.habilitationsService.isPortefeuilleHabiliteGestion(n.identifiantPortefeuille,t.portefeuilles)&&(o=this.getProcessusGererEcheancierCreation(n,i),f.push(o)),(i.etatEcheancier===ContentieuxParametrage.Constantes.ContentieuxMetier.echeancierCBTermine||i.etatEcheancier===ContentieuxParametrage.Constantes.ContentieuxMetier.echeancierCBSupprime||i.etatEcheancier===ContentieuxParametrage.Constantes.ContentieuxMetier.echeancierCBCaduc)&&(o=this.getProcessusGererEcheancierCB(n,i,!0),f.push(o))),(t.decomptesGestion||t.decomptesConsultation)&&f.push(this.getProcessusGererDecomptes(n,i)),this.isPGE(i.codeProduitService)){a=this.getProcessusPGEConsulterDonnees(n,i),f.push(a),s=this.getProcessusPGESaisieProvisionnel(n,i),f.push(s);var p=ContentieuxCommun.Metier.ContratUtils.isDechu(i.codeDecheanceDuTerme);p&&(i.topMiseEnJeuGarantiePGE?(u=this.getProcessusPGEGarantieVisualisation(n,i),f.push(u)):(t.gestionnaire||t.superviseur)&&this.habilitationsService.isPortefeuilleHabiliteGestion(n.identifiantPortefeuille,t.portefeuilles)&&(u=this.getProcessusPGEGarantieMiseEnJeu(n,i),f.push(u)))}c=this.getProcessusCreanceGererDetail(n,i),f.push(c);var S=ContentieuxCommun.Metier.ContratUtils.isDechu(i.codeDecheanceDuTerme),P=ContentieuxCommun.Metier.ContratUtils.isActive(i.codeActiviteCreance),h=ContentieuxCommun.Metier.ContratUtils.isNonSaine(i.codePassageCreditStatutDouteux);(t.gestionnaire||t.superviseur)&&this.habilitationsService.isPortefeuilleHabiliteGestion(n.identifiantPortefeuille,t.portefeuilles)&&(S?this.isAutoriseDecheanceTerme(i.codeTypeProduitService,i.codeOrigineCreditDossier)&&P&&(l=this.getProcessusCreanceDechoir(n,i,e.Constantes.Processus.decheanceTermeTypeRetour),f.push(l)):this.isAutoriseDecheanceTerme(i.codeTypeProduitService,i.codeOrigineCreditDossier)&&P?(l=this.getProcessusCreanceDechoir(n,i,e.Constantes.Processus.decheanceTermeTypeTerme),f.push(l)):this.isAutoriseDecheanceContrat(i.codeTypeProduitService)&&h&&(l=this.getProcessusCreanceDechoir(n,i,e.Constantes.Processus.decheanceTermeTypeContrat),f.push(l))),t.accesEdg&&P&&S&&this.isAutoriseEDG(i.codeTypeProduitService,i.codeOrigineCreditDossier)&&(d=this.getProcessusCreanceEDG(n,i),f.push(d)),(t.provisionConsultation||t.provisionGestion)&&(m=this.getProcessusCreancePreparerProvision(n,i),f.push(m)),i.topSynchro&&(C=this.getProcessusCreditSynchro(n,i),f.push(C));var T;return this.isAutoriseDNC(i.codeTypeProduitService)&&i.topDNC&&(T=""+i.codeEtablissement+e.Constantes.DossierNumerique.dossierNumeriqueCredit.formatageEspace+i.identifiantDossierInstruction,this.dossierNumeriqueService.dossierNumeriqueExiste(e.Constantes.DossierNumerique.codeFournisseur.creditInstruction,T).then(function(e){e&&(E=v.getProcessusDossierNumeriqueCredit(i.codeEtablissement,n,T),f.push(E))})),f},t.prototype.isPerteTotal=function(e){return e&&e.length>1&&e[1].type===ContentieuxParametrage.Constantes.ContentieuxMetier.typeDettePertes&&e[0].type===ContentieuxParametrage.Constantes.ContentieuxMetier.typeDetteExigible?e[0].montant===e[1].montant:!1},t.prototype.isExigible=function(t){var n=_.filter(t,function(t){return t.type===e.Constantes.Solde.CreditGestion.libelleMontant1})[0];return n&&0===n.montant?!1:!0},t.prototype.getProcessusEffectuerPaiement=function(t,n){var i=new e.Modeles.Processus.ProcessusEffectuerPaiement(t.identifiantEntiteTitulaire,t.numeroDossier.toString(),n.identifiantCreance),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersEffectuerPaiement};return r},t.prototype.getProcessusGererEcheancierCreation=function(t,n){var i=new e.Modeles.Processus.ProcessusGererEcheancier(t.identifiantEntiteTitulaire,t.numeroDossier.toString(),n.identifiantCreance,ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.modeCreation),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersGererEcheancierCreation};return r},t.prototype.getProcessusGererEcheancierVisualisation=function(t,n){var i=new e.Modeles.Processus.ProcessusGererEcheancier(t.identifiantEntiteTitulaire,t.numeroDossier.toString(),n.identifiantCreance,ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.modeVisualisation,n.typeEcheancier),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersGererEcheancierVisualisation};return r},t.prototype.getProcessusGererEcheancierCB=function(t,n,i){var r;r=i?new e.Modeles.Processus.ProcessusGererEcheancier(t.identifiantEntiteTitulaire,t.numeroDossier.toString(),n.identifiantCreance,ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.modeVisualisationCBClos,n.typeEcheancier):new e.Modeles.Processus.ProcessusGererEcheancier(t.identifiantEntiteTitulaire,t.numeroDossier.toString(),n.identifiantCreance,ContentieuxParametrage.Constantes.Processus.processusGererEcheancier.modeVisualisationCB,n.typeEcheancier);var o={libelleDebranchement:r.libelle,processus:r,initData:r.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersGererEcheancierCB};return o},t.prototype.getProcessusGererDecomptes=function(t,n){var i=new e.Modeles.Processus.ProcessusGererDecomptes(t.numeroDossier.toString(),n.identifiantCreance),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersGererDecomptes};return r},t.prototype.getProcessusCreditSynchro=function(t,n){var i=new e.Modeles.Processus.ProcessusGererCreditSynchro(n.reference),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersCreditSynchro};return r},t.prototype.getProcessusPGEConsulterDonnees=function(t,n){var i=new e.Modeles.Processus.ProcessusPGEConsulterDonnees(n.reference),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersPGEConsulterDonnees};return r},t.prototype.getProcessusPGESaisieProvisionnel=function(t,n){var i=new e.Modeles.Processus.ProcessusPGESaisieProvisionnel(n.reference),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersPGESaisieProvisionnel};return r},t.prototype.getProcessusPGEGarantieMiseEnJeu=function(t,n){var i=new e.Modeles.Processus.ProcessusPGEGarantie(t.identifiantEntiteTitulaire,t.numeroDossier.toString(),n.identifiantCreance,n.reference),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersMettreEnJeuGarantiePGE};return r},t.prototype.getProcessusPGEGarantieVisualisation=function(t,n){var i=new e.Modeles.Processus.ProcessusPGEGarantieVisualisation(t.identifiantEntiteTitulaire,t.numeroDossier.toString(),n.identifiantCreance,n.reference),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersMettreEnJeuGarantiePGEVisualisation};return r},t.prototype.getProcessusCreanceGererDetail=function(t,n){var i=new e.Modeles.Processus.ProcessusCreanceGererDetail(t.numeroDossier.toString(),n.identifiantCreance),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersCreanceGererDetail};return r},t.prototype.getProcessusCreancePreparerProvision=function(t,n){var i=new e.Modeles.Processus.ProcessusCreancePreparerProvision(t.numeroDossier.toString(),n.identifiantCreance),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersCreancePreparerProvision};return r},t.prototype.getProcessusCreanceDechoir=function(t,n,i){var r=new e.Modeles.Processus.ProcessusCreanceDechoir(t.numeroDossier.toString(),n.identifiantCreance,i),o={libelleDebranchement:r.libelle,processus:r,initData:r.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersCreanceDechoir};return o},t.prototype.getProcessusCreanceEDG=function(t,n){var i=new e.Modeles.Processus.ProcessusCreanceEDG(t.numeroDossier.toString(),n.identifiantCreance,e.Constantes.Processus.creanceEDG),r={libelleDebranchement:i.libelle,processus:i,initData:i.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersCreanceDechoir};return r},t.prototype.isAutoriseDecheanceTerme=function(t,n){return-1!==e.Constantes.Processus.listeCodeProduitServiceDecheanceTerme.indexOf(t)&&n!==e.Constantes.Processus.creditOrigineGECCO},t.prototype.isAutoriseDecheanceContrat=function(t){return!(-1!==e.Constantes.Processus.listeCodeProduitServiceNonAutoriseDecheanceContrat.indexOf(t))},t.prototype.isAutoriseEDG=function(t,n){return-1!==e.Constantes.Processus.listeCodeProduitServiceEDG.indexOf(t)&&n!==e.Constantes.Processus.creditOrigineGECCO},t.prototype.isAutoriseDNC=function(t){return-1!==e.Constantes.Processus.listeCodeProduitServiceDNC.indexOf(t)},t.prototype.isPGE=function(t){return-1!==e.Constantes.Processus.listecodeProduitServicePGE.indexOf(t)},t.prototype.getProcessusDossierNumeriqueCredit=function(t,n,i){var r=new e.Modeles.Processus.ProcessusDossierNumeriqueCredit(e.Constantes.DossierNumerique.codeFournisseur.creditInstruction,i),o={libelleDebranchement:r.libelle,processus:r,initData:r.initData,isLancementLisa:!0,nextLisa:ContentieuxParametrage.Constantes.Processus.Lisa.syntheseVersDossierNumeriqueCreditHorsPortail};return o},t.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,e.Constantes.Inject.Services.dossierNumeriqueService,e.Constantes.Inject.Services.habilitationsService],t}();t.ProcessusService=n,e.app.service(e.Constantes.Inject.Services.processusService,n)}(n=t.Processus||(t.Processus={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.SMS||(e.SMS={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n){this.$q=e,this.smsService=t,this.edsService=n}return t.prototype.envoyerSMSEcheancier=function(t,n,i){var r=this,o={codeAction:e.Constantes.Echeancier.CODE_ACTION_SMS,codeEtablissement:t.dossier.codeEtablissement,numeroDossier:t.dossier.numeroDossier,identifiantCreanceCTX:t.donnees.identifiantCreance,identifiantPersonne:t.payeur.payeur.idPersonne,identifiantEntiteTitulaire:t.dossier.identifiantEntiteTitulaire,identifiantContrat:t.contrat.identifiantContrat,numeroTelephoneRelanceSms:t.payeur.smsPayeur,dateEnvoiSmsMail:i,heureEnvoiSmsMail:0,designationLonguePersonne:t.payeur.payeur.libelle,codeEvenement:n,designationLongueAgent:null,adresseMessagerieAgent:null,designationClientBancaireCourte:null,raisonSocialeEtablissement:null,numeroModeleSms:null,numeroVersionModeleSms:null,indicateurGestionRetourClient:null,identifiantAgent:null,contenuMessageEmis:null,typeEnvoiRelance:null,numeroTelAgent:null};return this.edsService.getNumeroEdsGerePar(t.dossier.codeEtablissement,t.dossier.identifiantEntiteTitulaire).then(function(e){return r.getTelEDS(t.dossier.codeEtablissement,e).then(function(e){return o.numeroTelAgent=e,r.smsService.postEnvoiSmsUnitaire(o).then(function(e){})})})},t.prototype.envoyerSMSEcheancierRelanceImpaye=function(t){if(t.donnees.smsRelanceNonPaiment){var n=void 0;return n=moment(t.donnees.datePremiereEcheance).format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),this.envoyerSMSEcheancier(t,e.Constantes.Echeancier.CODE_EVENEMENT_SMS_RELANCE_IMPAYE,n)}return this.$q.when(null)},t.prototype.envoyerSMSEcheancierEcheanceAVenir=function(t){if(t.donnees.smsEcheanceAVenir){var n=void 0,i=void 0,r=this.getDifferenceDateEcheanceDateJour(t);return r>e.Constantes.Echeancier.DELAI_SMS?(n=this.getDateEnvoiSMS(t.donnees.datePremiereEcheance),i=moment(n).format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),this.envoyerSMSEcheancier(t,e.Constantes.Echeancier.CODE_EVENEMENT_SMS_ECHEANCE_A_VENIR,i)):(i=moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),this.envoyerSMSEcheancier(t,e.Constantes.Echeancier.CODE_EVENEMENT_SMS_ECHEANCE_A_VENIR,i))}return this.$q.when(null)},t.prototype.definirSMSEcheancier=function(e){var t=this;return""!==e.payeur.smsPayeur?this.envoyerSMSEcheancierEcheanceAVenir(e).then(function(){return t.envoyerSMSEcheancierRelanceImpaye(e)}):this.$q.when(null)},t.prototype.getTelEDS=function(e,t){return this.edsService.getInformationEDSInterne(e,t).then(function(e){var t=null===e.telephone2?e.telephoneAdresse:e.telephone2;return t})},t.prototype.getDateEnvoiSMS=function(t){var n;return n=moment(t).subtract(e.Constantes.Echeancier.DELAI_SMS,"day").toDate()},t.prototype.getDifferenceDateEcheanceDateJour=function(e){var t,n=moment(Date.now()).startOf("day"),i=e.donnees.datePremiereEcheance;return t=moment(i).startOf("day").diff(n,"days")},t.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,Contentieux.RestServices.Commun.Constantes.Inject.Service.smsService,e.Constantes.Inject.Services.edsService],t}();t.SMSService=n,e.app.service(e.Constantes.Inject.Services.smsService,n)}(n=t.SMS||(t.SMS={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(e,t,n,i,r,o){this.$q=e,this.soldeRestService=t,this.cddRestService=n,this.cceRestService=i,this.creditGestionRestService=r,this.creditConsoRestService=o}return t.prototype.getDetailSoldeCDD=function(t,n,i){var r="00"+i.substring(0,2);return this.cddRestService.getDetailSoldeCDD(t,n,r,i).then(function(t){return null!==t.informationsCDD?{soldeReel:t.informationsCDD.codeDevise===e.Constantes.Paiement.Commun.CODE_DEVISE_EUR?t.informationsCDD.soldeMinuteCompte:t.informationsCDD.montantSoldeReelEnFrancs,ecartes:t.informationsCDD.montantCumuleOperationEcartee,fondsMisADisposition:t.informationsCDD.cumulFondsMisADispoINSTP,fondsReserves:t.informationsCDD.cumulReservesFondsINSTPAY,impayesSurPret:t.informationsCDD.montantCumuleImpayePret,montantDecouvertAutorise:t.informationsCDD.montantDecouvert,planReglement:t.informationsCDD.soldeDebiteurAttenduDeviseOrig,reservesEncaissement:t.informationsCDD.cumulReservesEncaissement,soldeDisponible:t.informationsCDD.codeDevise===e.Constantes.Paiement.Commun.CODE_DEVISE_EUR?t.informationsCDD.montantSoldeDisponibleCDD:t.informationsCDD.montantSoldeReelEnFrancs,codeDevise:t.informationsCDD.codeDevise}:null})},t.prototype.getDetailSoldeCCE=function(t,n,i){var r="00"+i.substring(0,2);return this.cceRestService.getDetailSoldeCCE(t,n,r,i,e.Constantes.Solde.CCE.codeActionSoldeDefault).then(function(e){return{soldeReel:e.solde.soldeCompteDeviseCpte,montantDecouvertAutorise:e.solde.montantDecouvertDeviseCpte,ecartes:e.solde.cumulMontantOpeEcarDeviseCpte,reservesEncaissement:e.solde.cumulRemiseCheque,blocageProvisions:e.solde.cumulBlocageProvisions,impayesSurPret:e.solde.cumulMontantImpayeDeviseCpte,planReglement:e.solde.soldeDebiteurAttenduDeviseOrigi,soldeDisponible:e.solde.soldeDisponibleDeviseCpte,codeDevise:e.solde.codeDevise,soldeFusionneEuro:e.solde.montantSoldeFusionneEuro,soldeCompteDevise:e.solde.soldeCompteDeviseCpte,montantDecouvertEuro:e.solde.montantAutoDecouvertEuro,montantDecouvertDevise:e.solde.montantDecouvertDeviseCpte}})},t.prototype.getDetailSoldeMinuteCCE=function(t,n,i){var r="00"+i.substring(0,2);return this.cceRestService.getDetailSoldeCCE(t,n,r,i,e.Constantes.Solde.CCE.codeActionSoldeMinute).then(function(e){return{soldeReel:e.solde.soldeCompteDeviseCpte,montantDecouvertAutorise:e.solde.montantDecouvertDeviseCpte,ecartes:e.solde.cumulMontantOpeEcarDeviseCpte,reservesEncaissement:e.solde.cumulRemiseCheque,blocageProvisions:e.solde.cumulBlocageProvisions,impayesSurPret:e.solde.cumulMontantImpayeDeviseCpte,planReglement:e.solde.soldeDebiteurAttenduDeviseOrigi,soldeDisponible:e.solde.soldeDisponibleDeviseCpte,codeDevise:e.solde.codeDevise,soldeFusionneEuro:e.solde.montantSoldeFusionneEuro,soldeCompteDevise:e.solde.soldeCompteDeviseCpte,montantDecouvertEuro:e.solde.montantAutoDecouvertEuro,montantDecouvertDevise:e.solde.montantDecouvertDeviseCpte}})},t.prototype.getDetailSoldeDisponibleCCE=function(t,n,i){var r="00"+i.substring(0,2);return this.cceRestService.getDetailSoldeCCE(t,n,r,i,e.Constantes.Solde.CCE.codeActionSoldeDispo).then(function(e){return{soldeReel:e.solde.soldeCompteDeviseCpte,montantDecouvertAutorise:e.solde.montantDecouvertDeviseCpte,ecartes:e.solde.cumulMontantOpeEcarDeviseCpte,reservesEncaissement:e.solde.cumulRemiseCheque,blocageProvisions:e.solde.cumulBlocageProvisions,impayesSurPret:e.solde.cumulMontantImpayeDeviseCpte,planReglement:e.solde.soldeDebiteurAttenduDeviseOrigi,soldeDisponible:e.solde.soldeDisponibleDeviseCpte,codeDevise:e.solde.codeDevise,soldeFusionneEuro:e.solde.montantSoldeFusionneEuro,soldeCompteDevise:e.solde.soldeCompteDeviseCpte,montantDecouvertEuro:e.solde.montantAutoDecouvertEuro,montantDecouvertDevise:e.solde.montantDecouvertDeviseCpte}})},t.prototype.getDetailSoldeCreditGestion=function(e,t){var n=moment().format("YYYY-MM-DD");return this.creditGestionRestService.getListeImpayes(e,n,t,null).then(function(e){var t="0"===e.codeSituationImpayeCredit?0:e.montantImpayeCredit;return{montantImpayeCredit:t,montantEcheanceMER:e.montantEcheanceMER,isImpaye:"1"===e.codeSituationImpayeCredit?!0:!1}})},t.prototype.getCreanceGeleeCreditGestion=function(t,n){var i=moment().format("YYYY-MM-DD");return this.creditGestionRestService.getCreanceGelee(t,i,n,e.Constantes.CreditGestion.TYPE_CONSULTATION_OUVERT).then(function(e){var t=0;if(e.creances.length>0){var n=e.creances.reduce(function(e,t,n,i){return e+t.montantGelCreance},0);t=n}return{montantGelCreance:t}})},t.prototype.getLibelleCreditConso=function(t,n){var i,r,o;return i=t.substring(0,3)===e.Constantes.Solde.CreditConso.codeCreditNormaux,
r=t.substring(0,3)===e.Constantes.Solde.CreditConso.codeCreditRestructure,o="",i?o=e.Constantes.Solde.CreditConso.libelleCreditNormaux+" "+n:r&&(o=e.Constantes.Solde.CreditConso.libelleCreditRestructure+" "+n),o},t.prototype.getDetailSoldeCreditConso=function(e,t,n,i,r){var o=this;return this.creditConsoRestService.getCreditAmortissable(e,t,n,i,r).then(function(e){var t=o.getLibelleCreditConso(e[0].identifiantContratCefi,e[0].codeOffreCefiPretConso);return{capitalRestantOuEncours:e[0].capitalRestantOuEncours,montantSoldeRecouvrement:e[0].mtSoldeRecouvrement,numeroDossierContratProducteur:e[0].numeroDossierContratProducteur,libelle:t}})},t.prototype.getSyntheseMiniProfilParEntiteTitulaire=function(t,n){var i=this;return this.soldeRestService.getMiniProfil(t,null,null,null,null,n,null,e.Constantes.Solde.MiniProfil.typeRechercheEntiteTitulaire,e.Constantes.Solde.MiniProfil.typeRestitutionMiniProfil).then(function(e){return i.getListeSoldeProduit(e)})},t.prototype.getListeSoldeProduit=function(e){var t=[];_.forEach(_.first(e).identificationProduit,function(e){t.push({codeProduitService:e.codeProduitService,referenceProduitService:e.referenceProduitService})});for(var n=0;n<_.first(e).donneeCommuneProduit.length;n++)t[n]={codeProduitService:t[n].codeProduitService,referenceProduitService:t[n].referenceProduitService,deviseTenueCompte:_.first(e).donneeCommuneProduit[n].deviseTenueCompte,soldeMinuteCompte:ContentieuxCommun.Tools.Montant.montantCentimesVersEuro(_.first(e).donneeCommuneProduit[n].soldeMinuteCompte)};return t},t.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,Contentieux.RestServices.Commun.Constantes.Inject.Service.syntheseService,Contentieux.RestServices.Commun.Constantes.Inject.Service.cddService,Contentieux.RestServices.Commun.Constantes.Inject.Service.cceService,Contentieux.RestServices.Commun.Constantes.Inject.Service.creditGestionService,Contentieux.RestServices.Commun.Constantes.Inject.Service.creditConsoService],t}();t.SoldeService=n,e.app.service(e.Constantes.Inject.Services.soldeService,n)}(n=t.Solde||(t.Solde={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Tiers||(e.Tiers={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function e(e,t){this.$q=e,this.tiersService=t}return e.prototype.getDesignationPersonne=function(e,t){var n={listeInterrogationDesignation:[{codeEtablissement:e,numeroPersonne:t}]};return this.tiersService.getDesignationsPersonnes(n).then(function(e){return _.first(e.listeDesignation).designationPersonne})},e.prototype.getIdentificationTiers=function(e,t){var n={isPersonneMorale:!1,isPersonnePhysique:!1};return this.tiersService.getIdentification(e,t).then(function(e){return n.isPersonnePhysique="1"===e.donneeIdentification.codePersonnaliteJuridique,n.isPersonneMorale="2"===e.donneeIdentification.codePersonnaliteJuridique,n})},e.$inject=[ContentieuxCommun.Constantes.Inject.Angular.$q,Contentieux.RestServices.Commun.Constantes.Inject.Service.tiersService],e}();t.TiersService=n,e.app.service(e.Constantes.Inject.Services.tiersService,n)}(n=t.Tiers||(t.Tiers={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.RechercheBDF||(e.RechercheBDF={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function e(e){this.rechercheRestService=e}return e.prototype.getRechercheBDF=function(e,t){return this.rechercheRestService.getRechercheBDF(e,t).then(function(e){var t=_.map(e,function(e){return{codeNotification:e.codeNotification,dateRecevabilite:e.dateRecevabilite,numeroDossierBDF:e.numeroDossierBDF}});return t})},e.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Service.rechercheBDFService],e}();t.RechercheBDFService=n,e.app.service(e.Constantes.Inject.Services.rechercheBDFService,n)}(n=t.RechercheBDF||(t.RechercheBDF={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=function(){function t(e,t){this.paiementService=e,this.smsService=t}return t.prototype.effectuerPaiementUniqueCb=function(t){var n={codeEtablissement:t.codeEtablissement,numeroDossier:t.numeroDossier,numeroEntiteTitulaire:t.numeroEntiteTitulaire,montantPaiementERecouvrement:t.montantPaiementERecouvrement,codeReseauCarteProsodie:t.codeReseauCarteProsodie,dateFinValidite:moment(t.dateFinValidite,"MMYY").format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),numeroCarteBancaire:t.numeroCarteBancaire,codeCVVCarte:t.codeCVVCarte,identifiantPersonne:t.identifiantPersonne,codeEnvironnement:t.codeEnvironnement,nombreTotalEcheance:1,referenceExternePersonne:t.referenceExternePersonne,identifiantElementStructure:t.identifiantElementStructure,dateEcheancePaiementDiffere:moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),dateValeurOperationContentieux:moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),codeMonnaiePriseOrdre:e.Constantes.Paiement.Commun.CODE_DEVISE_EUR,identifiantContrat:t.identifiantContrat,codeCivilitePersonnePhysique:t.codeCivilitePersonnePhysique,codePersonnaliteJuridique:t.codePersonnaliteJuridique,designationLonguePersonne:t.designationLonguePersonne,adresseEmail:t.adresseEmail,identifiantCreance:t.identifiantCreance};return this.paiementService.postPaiementEnLigne(n)},t.prototype.getModeleSmsPaiement=function(t,n,i){return this.smsService.getModeleSms(t,e.Constantes.Paiement.PaiementEnLigne.SMS.TYPE_RELANCE_02,e.Constantes.Paiement.PaiementEnLigne.SMS.TYPE_ENVOI_RELANCE,n,i).then(function(t){return _.filter(t,e.Constantes.Paiement.PaiementEnLigne.SMS.NUMERO_MODELE_SMS_VALIDATION_PAIEMENT)})},t.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Service.paiementService,Contentieux.RestServices.Commun.Constantes.Inject.Service.smsService],t}();t.PaiementCbUnique=n,e.app.service(e.Constantes.Inject.Services.paiementCbUnique,n)}(n=t.PaiementCbUnique||(t.PaiementCbUnique={}))}(n=t.Paiement||(t.Paiement={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=function(){function t(e){this.creanceService=e}return t.prototype.effectuerPaiementCheque=function(t){var n=null,i=null,r=null,o=null,a=null,s=null,u=null,c=null,l=null,m=null,C=null,E=null,d=null,v=null,f=null,p=null;t.infosCommunes.isGarantie&&(t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?(t.infosCommunes.garantie.detailGarantie.montantActuelGarantie=0,t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar=0,t.infosCommunes.garantie.detailGarantie.indicateurAlerteActivee="N",t.infosCommunes.garantie.detailGarantie.indicateurEditionCaution="N"):"N"===t.infosCommunes.garantie.surete.indicateurGarantieEnTaux&&(t.infosCommunes.garantie.detailGarantie.montantActuelGarantie=ContentieuxCommun.Tools.Montant.soustractionMontant(t.infosCommunes.garantie.detailGarantie.montantActuelGarantie,t.infosCommunes.montantPaiement),t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar=ContentieuxCommun.Tools.Montant.soustractionMontant(t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar,t.infosCommunes.montantPaiement),t.infosCommunes.garantie.detailGarantie.montantActuelGarantie=t.infosCommunes.garantie.detailGarantie.montantActuelGarantie<0?0:t.infosCommunes.garantie.detailGarantie.montantActuelGarantie,t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar=t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar<0?0:t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar),(t.infosCommunes.garantie.detailGarantie.datePremiereMiseEnJeuGarantie===e.Constantes.Paiement.Commun.Garantie.DATE_DEFAUT||null===t.infosCommunes.garantie.detailGarantie.datePremiereMiseEnJeuGarantie)&&(t.infosCommunes.garantie.detailGarantie.datePremiereMiseEnJeuGarantie=moment(t.infosCommunes.dateValeurOperationContentieux).format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement)),t.infosCommunes.garantie.detailGarantie.objetGarantie[0]&&(a=_.filter(t.infosCommunes.garantie.detailGarantie.objetGarantie[0].valeurObjet,function(e){return"A"===e.codeTypeEstimation})[0],s=_.filter(t.infosCommunes.garantie.detailGarantie.objetGarantie[0].valeurObjet,function(e){return"V"===e.codeTypeEstimation})[0],u=_.filter(t.infosCommunes.garantie.detailGarantie.objetGarantie[0].valeurObjet,function(e){return"S"===e.codeTypeEstimation})[0],c=_.filter(t.infosCommunes.garantie.detailGarantie.objetGarantie[0].valeurObjet,function(e){return"P"===e.codeTypeEstimation})[0],a&&"0001-01-01"!==a.dateEstimation&&(n=a.dateEstimation),s&&"0001-01-01"!==s.dateEstimation&&(i=s.dateEstimation),u&&"0001-01-01"!==u.dateEstimation&&(r=u.dateEstimation),c&&"0001-01-01"!==c.dateEstimation&&(o=c.dateEstimation),l=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].codeObjetGarantie,m=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].adresseLigne1,C=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].adresseLigne2,E=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].adresseLigne3,d=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].codePostale,v=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].commune,f=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].adresseLigne1Suite,p=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].identifiantObjetCtx));var S={codeEtablissement:t.infosCommunes.codeEtablissement,numeroDossier:parseInt(t.infosCommunes.numeroDossier),identifiantCreance:t.infosCommunes.identifiantCreance,numeroAvantV2:0,codeAction:e.Constantes.Paiement.Commun.Garantie.CODE_ACTION,dateCreationMemo:t.infosCommunes.isGarantie?moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement):null,codeTypeMemo:t.infosCommunes.isGarantie?e.Constantes.Paiement.Commun.Garantie.CODE_TYPE_MEMO:null,libelleCourtMemo:null,libelleLongMemo:null,libelleLongMemoBis:"",numeroMemo:0,libelleLongMemoCreance:null,libelleLongComplementMemo:null,dateEffetMemo:null,codeGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.codeGarantie:null,numeroGarantieDossier:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.numeroGarantieDossierCTX:null,identifiantContrat:t.infosCommunes.identifiantContrat,dateJourneeBancaireEvt:moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),numeroHistoComptable:0,datePassageContentieuxDossier:moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),montantOperation:t.infosCommunes.montantPaiement,montantRecupereAffecteAuDossier:t.infosCommunes.pertes,motifRecuperationSurPerte:_.padRight(t.infosCommunes.referencePayeur,32," ").slice(0,32),codeActionGarantie:t.infosCommunes.isGarantie?e.Constantes.Paiement.Commun.Garantie.CODE_ACTION_MISE_A_JOUR_GARANTIE:null,identifiantPersonneGarant:t.infosCommunes.isGarantie?t.infosCommunes.garantie.identifiantPersonneGarant:null,dateAffectationGarantieCredit:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.dateAffectationGarantie:null,dateFinAffectationGarantieCredi:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.dateFinAffectationGarantie:null,montantCouvertureCreanceGaranti:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar:null,montantActuelGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.montantActuelGarantie:null,montantInitialCouvertGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.montantInitialCouvertParGaranti:null,montantInitialGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.montantInitialGarantie:null,tauxGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.tauxGarantie:null,codeNatureGarantieMySys:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.codeNatureGarantieMySys:null,datePublication:null,datePremiereMisEnJeuGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.datePremiereMiseEnJeuGarantie:null,indicateurMisEnJeuGarantieTotal:t.infosCommunes.indicateurMisEnJeuGarantieTotale,indicateurAlerteActivee:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.indicateurAlerteActivee:null,topGarantieUtiliseeCalcul:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.topGarantieUtiliseeCalcul:null,indicateurEditionCaution:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.indicateurEditionCaution:null,rangHypotheque:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.rangHypotheque:null,rangGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.rangGarantie:null,typeGarantieGCE:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.typeGarantieGCE:null,codeCategorieGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.codeCategorieGarantie:null,indicateurValorTauxCouverture:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.indicateurValorisatTauxCouvertu:null,dateEstimationObjetAmiable:n,dateEstimationObjetJuridique:r,dateEstimationObjetPrudentiel:o,dateEstimationObjetVenale:i,codeMonnaiePriseOrdre:e.Constantes.Paiement.Commun.CODE_DEVISE_EUR,montantTotal:t.infosCommunes.montantPaiement,montantCapitalCreance:null,montantInteretsDossier:null,montantFraisDossier:null,montantAssuranceCreance:null,montantInteretsRetardDossier:null,montantPartCreanceEnAPL:null,montantBonificationAcquiseOrdre:null,dateValeurOperationContentieux:moment(t.infosCommunes.dateValeurOperationContentieux).format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),dateEntreeEnContentieux:moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),codeTypeProduitService:t.codeTypeProduitService,libelleMouvementSurCreance:_.padRight(t.infosCommunes.referencePayeur,32," ").slice(0,32),montantInteretsRetardComptabili:null,montantInteretsRetardNonComptab:0,dateValeurDecompte:null,codeOperationCredit:null,indicateurOrigineSST:null,codeTypeMouvementFinancier:null,identifiantInternePartenaire:null,montantExigibleDossierMyVario:t.infosCommunes.exigibleMyVario,codeGuichetInterbancaire:t.codeGuichetInterbancaire,codeFamilleOperationDiverse:t.codeFamilleOD,codeOperationDiverse:e.Constantes.Paiement.Cheque.OperationDiverse.TYPE_OPERATION_DIVERSE,libelleOperationDiverse:t.infosCommunes.numeroDossier,codeModeApparitionFamille:e.Constantes.Paiement.Cheque.OperationDiverse.CODE_MODE_APPARITION_FAMILLE,codeSensTransaction:e.Constantes.Paiement.Cheque.OperationDiverse.CODE_SENS_TRANSACTION,modeFinancier:e.Constantes.Paiement.Cheque.OperationDiverse.MODE_FINANCIER,libelleOperation:t.infosCommunes.numeroDossier,libelleOperationComplementaire:t.infosCommunes.numeroDossier,dateOperation:t.infosCommunes.dateValeurOperationContentieux,codeAgent:t.infosCommunes.codeAgent,codeObjetGarantie:l,adresseLigne1:m,adresseLigne2:C,adresseLigne3:E,adresseLigne4:d,adresseLigne5:v,adresseLigne1Suite:f,indicValorEstimationJuridiq:null!=u?u.codeTypeEstimation:null,mtEstimationObjetJuridique:null!=u?u.montantEstimation:null,codeModaliteEstimationJurid:null!=u?u.codeModaliteEstimation:null,codeMotifReestimationJurid:null!=u?u.codeMotifReestimation:null,indicValeurObjetUtilJurid:null!=u?u.indicValeurObjetUtilise:null,indicValorEstimationPrudent:null!=c?c.codeTypeEstimation:null,mtEstimationObjetPrudentiel:null!=c?c.montantEstimation:null,codeModeEstimationPrudentie:null!=c?c.codeModaliteEstimation:null,codeMotifReestimationPrude:null!=c?c.codeMotifReestimation:null,indicValeurObjetUtilPrude:null!=c?c.indicValeurObjetUtilise:null,indicValorEstimationAmiable:null!=a?a.codeTypeEstimation:null,mtEstimationObjetAmiable:null!=a?a.montantEstimation:null,codeModeEstimationAmiable:null!=a?a.codeModaliteEstimation:null,codeMotifReestimationAmiab:null!=a?a.codeMotifReestimation:null,topValeurObjetUtilAmiable:null!=a?a.indicValeurObjetUtilise:null,indicValorEstimationVenale:null!=s?s.codeTypeEstimation:null,mtEstimationObjetVenale:null!=s?s.montantEstimation:null,codeModaliteEstimationVenal:null!=s?s.codeModaliteEstimation:null,codeMotifReestimationVenal:null!=s?s.codeMotifReestimation:null,topValeurObjetUtilVenale:null!=s?s.indicValeurObjetUtilise:null,identifiantObjetCtx:t.infosCommunes.isGarantie?p:null,codeTypeOrigineFlux:t.codeTypeOrigineFlux,typeElementStructure:null,typeFonction:null};return t.infosCommunes.isGarantie&&(S.libelleCourtMemo=t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_TOTALE:e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_PARTIELLE,S.libelleLongMemo=t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_TOTALE:e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_PARTIELLE,S.libelleLongMemoCreance=t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_TOTALE:e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_PARTIELLE,S.libelleLongComplementMemo=t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_TOTALE:e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_PARTIELLE,S.dateFinAffectationGarantieCredi=t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?moment(t.infosCommunes.dateValeurOperationContentieux).format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement):S.dateFinAffectationGarantieCredi),this.creanceService.postPaiementCheque(S)},t.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Service.creanceService],t}();t.PaiementCheque=n,e.app.service(e.Constantes.Inject.Services.paiementCheque,n)}(n=t.PaiementCheque||(t.PaiementCheque={}))}(n=t.Paiement||(t.Paiement={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));var ContentieuxServices;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n=function(){function t(e,t,n,i,r){this.operationFinanciereRestService=e,this.identifiantBordereauService=t,this.modalService=n,this.paiementRestService=i,this.$q=r}return t.prototype.effectuerPrelevementPonctuel=function(t){var n=this,i=null,r=null,o=null,a=null,s=null,u=null,c=null,l=null,m=null,C=null,E=null,d=null,v=null,f=null,p=null,S=null,P=parseInt(ContentieuxCommun.Tools.Montant.montantEuroVersCentimes(t.infosCommunes.montantPaiement).toFixed(2));t.infosCommunes.isGarantie&&(t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?(t.infosCommunes.garantie.detailGarantie.montantActuelGarantie=0,t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar=0,t.infosCommunes.garantie.detailGarantie.indicateurAlerteActivee="N",t.infosCommunes.garantie.detailGarantie.indicateurEditionCaution="N"):"N"===t.infosCommunes.garantie.surete.indicateurGarantieEnTaux&&(t.infosCommunes.garantie.detailGarantie.montantActuelGarantie=ContentieuxCommun.Tools.Montant.soustractionMontant(t.infosCommunes.garantie.detailGarantie.montantActuelGarantie,P),t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar=ContentieuxCommun.Tools.Montant.soustractionMontant(t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar,P),t.infosCommunes.garantie.detailGarantie.montantActuelGarantie=t.infosCommunes.garantie.detailGarantie.montantActuelGarantie<0?0:t.infosCommunes.garantie.detailGarantie.montantActuelGarantie,t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar=t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar<0?0:t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar),(t.infosCommunes.garantie.detailGarantie.datePremiereMiseEnJeuGarantie===e.Constantes.Paiement.Commun.Garantie.DATE_DEFAUT||null===t.infosCommunes.garantie.detailGarantie.datePremiereMiseEnJeuGarantie)&&(t.infosCommunes.garantie.detailGarantie.datePremiereMiseEnJeuGarantie=moment(t.infosCommunes.dateValeurOperationContentieux).format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement)),t.infosCommunes.garantie.detailGarantie.objetGarantie[0]&&(s=_.filter(t.infosCommunes.garantie.detailGarantie.objetGarantie[0].valeurObjet,function(e){return"A"===e.codeTypeEstimation})[0],u=_.filter(t.infosCommunes.garantie.detailGarantie.objetGarantie[0].valeurObjet,function(e){return"V"===e.codeTypeEstimation})[0],c=_.filter(t.infosCommunes.garantie.detailGarantie.objetGarantie[0].valeurObjet,function(e){return"S"===e.codeTypeEstimation})[0],l=_.filter(t.infosCommunes.garantie.detailGarantie.objetGarantie[0].valeurObjet,function(e){return"P"===e.codeTypeEstimation})[0],s&&"0001-01-01"!==s.dateEstimation&&(i=s.dateEstimation),u&&"0001-01-01"!==u.dateEstimation&&(r=u.dateEstimation),c&&"0001-01-01"!==c.dateEstimation&&(o=c.dateEstimation),l&&"0001-01-01"!==l.dateEstimation&&(a=l.dateEstimation),m=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].codeObjetGarantie,C=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].adresseLigne1,E=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].adresseLigne2,d=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].adresseLigne3,v=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].codePostale,f=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].commune,p=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].adresseLigne1Suite,S=t.infosCommunes.garantie.detailGarantie.objetGarantie[0].identifiantObjetCtx));var h=t.riceCompte.getGuichet(),T={codeEtablissement:t.infosCommunes.codeEtablissement,numeroDossier:parseInt(t.infosCommunes.numeroDossier),identifiantCreance:t.infosCommunes.identifiantCreance,montantPrelevePremierCompte:P,dateValeur:parseInt(moment(t.infosCommunes.dateValeurOperationContentieux).format("YYYYMMDD")),typeSortieOrdinaire:e.Constantes.Paiement.Prelevement.PrelevementPonctuel.TYPE_SORTIE_ORDINAIRE,entiteAdministrativeCptSupp:t.riceCompte.codeEtablissement,guichetCompteSupport:t.riceCompte.getGuichet(),compteSupportRecouvrement:parseInt(t.riceCompte.formatRICEPourCompte()),numeroIbanCompte:"",codeAgent:t.infosCommunes.codeAgent,numeroAvantV2:0,codeAction:e.Constantes.Paiement.Commun.Garantie.CODE_ACTION,dateCreationMemo:t.infosCommunes.isGarantie?moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement):null,codeTypeMemo:t.infosCommunes.isGarantie?e.Constantes.Paiement.Commun.Garantie.CODE_TYPE_MEMO:null,libelleCourtMemo:null,libelleLongMemo:null,libelleLongMemoBis:"",numeroMemo:0,libelleLongMemoCreance:null,libelleLongComplementMemo:null,dateEffetMemo:null,codeGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.codeGarantie:null,numeroGarantieDossier:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.numeroGarantieDossierCTX:null,identifiantContrat:t.infosCommunes.identifiantContrat,dateJourneeBancaireEvt:moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),numeroHistoComptable:0,datePassageContentieuxDossier:moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),montantOperation:P,montantRecupereAffecteAuDossier:t.infosCommunes.pertes,motifRecuperationSurPerte:_.padRight(t.infosCommunes.referencePayeur,32," ").slice(0,32),codeActionGarantie:t.infosCommunes.isGarantie?e.Constantes.Paiement.Commun.Garantie.CODE_ACTION_MISE_A_JOUR_GARANTIE:null,codeTypeOrigineFlux:t.infosCommunes.isGarantie?e.Constantes.Paiement.Commun.Recuperation.CODE_TYPE_ORIGINE_FLUX_RECUPERATION_GARANTIE:e.Constantes.Paiement.Commun.Recuperation.CODE_TYPE_ORIGINE_FLUX_RECUPERATION,identifiantPersonneGarant:t.infosCommunes.isGarantie?t.infosCommunes.garantie.identifiantPersonneGarant:null,dateAffectationGarantieCredit:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.dateAffectationGarantie:null,dateFinAffectationGarantieCredi:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.dateFinAffectationGarantie:null,montantCouvertureCreanceGaranti:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.montantCouvertureCreanceGar:null,montantActuelGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.montantActuelGarantie:null,montantInitialCouvertGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.montantInitialCouvertParGaranti:null,montantInitialGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.montantInitialGarantie:null,tauxGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.tauxGarantie:null,codeNatureGarantieMySys:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.codeNatureGarantieMySys:null,datePublication:null,datePremiereMisEnJeuGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.datePremiereMiseEnJeuGarantie:null,indicateurMisEnJeuGarantieTotal:t.infosCommunes.indicateurMisEnJeuGarantieTotale,indicateurAlerteActivee:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.indicateurAlerteActivee:null,topGarantieUtiliseeCalcul:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.topGarantieUtiliseeCalcul:null,indicateurEditionCaution:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.indicateurEditionCaution:null,rangHypotheque:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.rangHypotheque:null,rangGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.rangGarantie:null,typeGarantieGCE:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.typeGarantieGCE:null,codeCategorieGarantie:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.codeCategorieGarantie:null,indicateurValorTauxCouverture:t.infosCommunes.isGarantie?t.infosCommunes.garantie.detailGarantie.indicateurValorisatTauxCouvertu:null,dateEstimationObjetAmiable:i,dateEstimationObjetJuridique:o,dateEstimationObjetPrudentiel:a,dateEstimationObjetVenale:r,codeMonnaiePriseOrdre:e.Constantes.Paiement.Commun.CODE_DEVISE_EUR,montantTotal:P,montantCapitalCreance:null,montantInteretsDossier:null,montantFraisDossier:null,montantAssuranceCreance:null,montantInteretsRetardDossier:null,montantPartCreanceEnAPL:null,montantBonificationAcquiseOrdre:null,dateValeurOperationContentieux:moment(t.infosCommunes.dateValeurOperationContentieux).format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),dateEntreeEnContentieux:moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),codeTypeProduitService:t.compte?t.compte.identifiantContrat.substring(0,4):_.padLeft(t.riceCompte.codeActiviteCompte,4,"0"),libelleMouvementSurCreance:_.padRight(t.infosCommunes.referencePayeur,32," ").slice(0,32),montantInteretsRetardComptabili:null,montantInteretsRetardNonComptab:0,dateValeurDecompte:null,codeOperationCredit:null,indicateurOrigineSST:null,codeTypeMouvementFinancier:null,identifiantInternePartenaire:null,montantExigibleDossierMyVario:t.infosCommunes.exigibleMyVario,deviseOperation:e.Constantes.Paiement.Commun.CODE_DEVISE_EUR,montantOperationUnitaire:P,montantTotalOperation:P,codeEtablissementCompte:t.riceCompte.codeEtablissement,codeGuichetCompte:h,referenceProduitServiceCompte:t.compte?t.compte.riceContrat.substring(10,21):t.riceCompte.codeActiviteCompte+t.riceCompte.radical+t.riceCompte.cleCompte,dateValeurOperation:moment(t.infosCommunes.dateValeurOperationContentieux).format("YYYY-MM-DD"),codeIndicateurAnnulation:e.Constantes.Paiement.Prelevement.OperationFinanciere.CODE_INTICATEUR_ANNULATION,libelleReveleCompte1:""+e.Constantes.Paiement.Prelevement.OperationFinanciere.LIBELLE_RELEVE_COMPTE_1+t.referenceContrat,libelleReleveCompte2:""+e.Constantes.Paiement.Prelevement.OperationFinanciere.LIBELLE_RELEVE_COMPTE_2+t.infosCommunes.numeroDossier,topValidationMessageInformation:e.Constantes.Paiement.Prelevement.OperationFinanciere.TOP_VALIDATION_MESSAGE_INFORMATION_NON,typeOperationDiverse:e.Constantes.Paiement.Prelevement.OperationDiverse.TYPE_OPERATION_DIVERSE,libelle1OperationDiverse:t.referenceContrat||"",libelle2OperationDiverse:e.Constantes.Paiement.Prelevement.OperationDiverse.LIBELLE_2_OPERATION_DIVERSE,familleOperationDiverse:t.codeFamilleOD,libelleModeFinancier:e.Constantes.Paiement.Prelevement.OperationFinanciere.LIBELLE_MODE_FINANCIER,identifiantPersonne:parseInt(t.numeroPersonne),nomUsagePersonne:t.nomUsagePersonne,prenomPersonne:t.prenomPersonne,identifiantBordereauJab:"",codeFonctionnaliteOrigineOpe:e.Constantes.Paiement.Prelevement.OperationFinanciere.CODE_FONCTIONNALITE_ORIGINE_OPE_RETRAIT,codeObjetGarantie:m,adresseLigne1:C,adresseLigne2:E,adresseLigne3:d,adresseLigne4:v,adresseLigne5:f,adresseLigne1Suite:p,indicValorEstimationJuridiq:null!=c?c.codeTypeEstimation:null,mtEstimationObjetJuridique:null!=c?c.montantEstimation:null,codeModaliteEstimationJurid:null!=c?c.codeModaliteEstimation:null,codeMotifReestimationJurid:null!=c?c.codeMotifReestimation:null,indicValeurObjetUtilJurid:null!=c?c.indicValeurObjetUtilise:null,indicValorEstimationPrudent:null!=l?l.codeTypeEstimation:null,mtEstimationObjetPrudentiel:null!=l?l.montantEstimation:null,codeModeEstimationPrudentie:null!=l?l.codeModaliteEstimation:null,codeMotifReestimationPrude:null!=l?l.codeMotifReestimation:null,indicValeurObjetUtilPrude:null!=l?l.indicValeurObjetUtilise:null,indicValorEstimationAmiable:null!=s?s.codeTypeEstimation:null,mtEstimationObjetAmiable:null!=s?s.montantEstimation:null,codeModeEstimationAmiable:null!=s?s.codeModaliteEstimation:null,codeMotifReestimationAmiab:null!=s?s.codeMotifReestimation:null,topValeurObjetUtilAmiable:null!=s?s.indicValeurObjetUtilise:null,indicValorEstimationVenale:null!=u?u.codeTypeEstimation:null,mtEstimationObjetVenale:null!=u?u.montantEstimation:null,codeModaliteEstimationVenal:null!=u?u.codeModaliteEstimation:null,codeMotifReestimationVenal:null!=u?u.codeMotifReestimation:null,topValeurObjetUtilVenale:null!=u?u.indicValeurObjetUtilise:null,identifiantObjetCtx:t.infosCommunes.isGarantie?S:null,codeInterneTarification:null,heureOperation:null,montantAppelProvisionnel:null,dateVersementProvisionnel:null,montantAppelFinal:null,dateVersementFinal:null,codeSens:null,dateEcretageProvisionnel:null,montantEcretageProvisionnel:null};if(t.infosCommunes.isGarantie&&(T.libelleCourtMemo=t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_TOTALE:e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_PARTIELLE,T.libelleLongMemo=t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_TOTALE:e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_PARTIELLE,T.libelleLongMemoCreance=t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_TOTALE:e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_PARTIELLE,T.libelleLongComplementMemo=t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_TOTALE:e.Constantes.Paiement.Commun.Garantie.LIBELLE_MISE_EN_JEU_PARTIELLE,
T.dateFinAffectationGarantieCredi=t.infosCommunes.indicateurMisEnJeuGarantieTotale===e.Constantes.Paiement.Commun.Garantie.MISE_EN_JEU_TOTALE?moment().format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement):T.dateFinAffectationGarantieCredi),"0004"===t.codeTypeProduitServiceCreance||"0008"===t.codeTypeProduitServiceCreance){var D=T.libelle1OperationDiverse;T.libelle1OperationDiverse=_.padLeft(D,12,"0")}return this.identifiantBordereauService.getIdentifiantBordereau(t.numeroPersonne,!1).then(function(e){return T.identifiantBordereauJab=e,n.paiementRestService.postPrelevementPonctuel(T)}).then(function(){})},t.prototype.controlerForcages=function(t){var n=this,i=t.riceCompte.getGuichet(),r={codeBanque:t.infosCommunes.codeEtablissement,codeGuichet:i,codeDevise:"EUR",codeSens:"R",dateValeur:t.infosCommunes.dateValeurOperationContentieux,modeExtourne:!1,modeFinancier:"VIO",montantBrutOperation:t.infosCommunes.montantPaiement,montantTotalPriseOrdre:t.infosCommunes.montantPaiement,referenceProduitService:t.compte?t.compte.riceContrat.substring(10,21):t.riceCompte.codeActiviteCompte+t.riceCompte.radical+t.riceCompte.cleCompte};return this.operationFinanciereRestService.getControleForcageImputation(r).then(function(t){var i="",r=!1;return t.listeCodeForcage&&t.listeCodeForcage.length>0?(r=!0,t.listeCodeForcage.forEach(function(t){t&&t.codeRetourForcageImputation===e.Constantes.Paiement.Prelevement.OperationFinanciere.CODE_RETOUR_999&&(i+=t.libelleForcageImputation+" - "+t.codeBanque+" "+t.codeGuichet+" "+t.referenceProduit+"<br />")}),n.$q.all([n.$q.when(e.Constantes.Paiement.Prelevement.OperationFinanciere.Forcage.CODE_RETOUR_MOTIF_PRESENT),n.$q.when(i)])):n.$q.all([n.$q.when(e.Constantes.Paiement.Prelevement.OperationFinanciere.Forcage.CODE_RETOUR_MOTIF_ABSENT),n.$q.when(i)])})["catch"](function(t){return n.$q.all([n.$q.when(e.Constantes.Paiement.Prelevement.OperationFinanciere.Forcage.CODE_RETOUR_ERREUR),n.$q.when(t.libelle)])})},t.prototype.effectuerPaiementParPrelevement=function(e){return this.effectuerPrelevementPonctuel(e)},t.prototype.effectuerPaiementParPrelevementPGE=function(t){var n=t.riceCompte.getGuichet(),i={codeAgent:t.infosCommunes.codeAgent,codeEtablissement:t.infosCommunes.codeEtablissement,numeroDossier:parseInt(t.infosCommunes.numeroDossier),identifiantContrat:t.infosCommunes.identifiantContrat,identifiantCreance:t.infosCommunes.identifiantCreance,codeEtablissementCompte:t.riceCompte.codeEtablissement,codeGuichetCompte:n,referenceProduitServiceCompte:t.riceCompte.codeActiviteCompte+t.riceCompte.radical+t.riceCompte.cleCompte,codeTypeProduitService:_.padLeft(t.riceCompte.codeActiviteCompte,4,"0"),montantAppelProvisionnel:t.pge.montantAppelProvisionnel,dateVersementProvisionnel:null===t.pge.dateVersementProvisionnel?null:moment(t.pge.dateVersementProvisionnel).format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),montantAppelFinal:t.pge.montantAppelFinal,dateVersementFinal:null===t.pge.dateVersementFinal?null:moment(t.pge.dateVersementFinal).format(ContentieuxCommun.Constantes.Generique.formatDateRecouvrement),codeSens:"Versement"===t.pge.codeSens?e.Constantes.Garantie.Garantie.CALCUL_VERSEMENT_GARANTIE_PGE:e.Constantes.Garantie.Garantie.CALCUL_REMBOURSEMENT_GARANTIE_PGE,montantEcretageProvisionnel:0,dateEcretageProvisionnel:null,montantPrelevePremierCompte:null,dateValeur:null,typeSortieOrdinaire:null,entiteAdministrativeCptSupp:null,guichetCompteSupport:null,compteSupportRecouvrement:null,numeroIbanCompte:null,numeroAvantV2:0,codeAction:null,dateCreationMemo:null,codeTypeMemo:null,libelleCourtMemo:null,libelleLongMemo:null,libelleLongMemoBis:"",numeroMemo:0,libelleLongMemoCreance:null,libelleLongComplementMemo:null,dateEffetMemo:null,codeGarantie:null,numeroGarantieDossier:null,dateJourneeBancaireEvt:null,numeroHistoComptable:0,datePassageContentieuxDossier:null,montantOperation:0,montantRecupereAffecteAuDossier:0,motifRecuperationSurPerte:null,codeActionGarantie:null,codeTypeOrigineFlux:null,identifiantPersonneGarant:null,dateAffectationGarantieCredit:null,dateFinAffectationGarantieCredi:null,montantCouvertureCreanceGaranti:null,montantActuelGarantie:null,montantInitialCouvertGarantie:null,montantInitialGarantie:null,tauxGarantie:null,codeNatureGarantieMySys:null,datePublication:null,datePremiereMisEnJeuGarantie:null,indicateurMisEnJeuGarantieTotal:null,indicateurAlerteActivee:null,topGarantieUtiliseeCalcul:null,indicateurEditionCaution:null,rangHypotheque:null,rangGarantie:null,typeGarantieGCE:null,codeCategorieGarantie:null,indicateurValorTauxCouverture:null,dateEstimationObjetAmiable:null,dateEstimationObjetJuridique:null,dateEstimationObjetPrudentiel:null,dateEstimationObjetVenale:null,codeMonnaiePriseOrdre:e.Constantes.Paiement.Commun.CODE_DEVISE_EUR,montantTotal:0,montantCapitalCreance:null,montantInteretsDossier:null,montantFraisDossier:null,montantAssuranceCreance:null,montantInteretsRetardDossier:null,montantPartCreanceEnAPL:null,montantBonificationAcquiseOrdre:null,dateValeurOperationContentieux:null,dateEntreeEnContentieux:null,libelleMouvementSurCreance:null,montantInteretsRetardComptabili:null,montantInteretsRetardNonComptab:0,dateValeurDecompte:null,codeOperationCredit:null,indicateurOrigineSST:null,codeTypeMouvementFinancier:null,identifiantInternePartenaire:null,montantExigibleDossierMyVario:t.infosCommunes.exigibleMyVario,deviseOperation:e.Constantes.Paiement.Commun.CODE_DEVISE_EUR,montantOperationUnitaire:0,montantTotalOperation:0,dateValeurOperation:null,codeIndicateurAnnulation:null,libelleReveleCompte1:null,libelleReleveCompte2:null,topValidationMessageInformation:null,typeOperationDiverse:null,libelle1OperationDiverse:"",libelle2OperationDiverse:null,familleOperationDiverse:null,libelleModeFinancier:null,identifiantPersonne:null,nomUsagePersonne:null,prenomPersonne:null,identifiantBordereauJab:"",codeFonctionnaliteOrigineOpe:null,codeObjetGarantie:null,adresseLigne1:null,adresseLigne2:null,adresseLigne3:null,adresseLigne4:null,adresseLigne5:null,adresseLigne1Suite:null,indicValorEstimationJuridiq:null,mtEstimationObjetJuridique:null,codeModaliteEstimationJurid:null,codeMotifReestimationJurid:null,indicValeurObjetUtilJurid:null,indicValorEstimationPrudent:null,mtEstimationObjetPrudentiel:null,codeModeEstimationPrudentie:null,codeMotifReestimationPrude:null,indicValeurObjetUtilPrude:null,indicValorEstimationAmiable:null,mtEstimationObjetAmiable:null,codeModeEstimationAmiable:null,codeMotifReestimationAmiab:null,topValeurObjetUtilAmiable:null,indicValorEstimationVenale:null,mtEstimationObjetVenale:null,codeModaliteEstimationVenal:null,codeMotifReestimationVenal:null,topValeurObjetUtilVenale:null,identifiantObjetCtx:null,codeInterneTarification:null,heureOperation:null};return this.paiementRestService.postPrelevementPonctuelPGE(i).then(function(){})},t.$inject=[Contentieux.RestServices.Commun.Constantes.Inject.Service.operationFinanciereService,e.Constantes.Inject.SocleFonctionnel.identifiantBordereauService,e.Constantes.Inject.MyWay.modalService,Contentieux.RestServices.Commun.Constantes.Inject.Service.paiementService,ContentieuxCommun.Constantes.Inject.Angular.$q],t}();t.PaiementPrelevement=n,e.app.service(e.Constantes.Inject.Services.paiementPrelevement,n)}(n=t.PaiementPrelevement||(t.PaiementPrelevement={}))}(n=t.Paiement||(t.Paiement={}))}(t=e.Services||(e.Services={}))}(ContentieuxServices||(ContentieuxServices={}));