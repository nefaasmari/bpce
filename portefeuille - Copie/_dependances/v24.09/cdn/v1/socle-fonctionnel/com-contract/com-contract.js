/**
 * Généré par : SIGCESIE\ct-tfsbuild
 * Changeset TFS : 36aaaf147bacf86ce67fcdc133d1db18cfe91084
 * Etiquette TFS : 24.09.01-rc.6
 * Déclenchement : Manual
 */
var myway;!function(e){var t;!function(e){"use strict";e.app=angular.module("myway.comContract",["ui.bootstrap","moduleAgent","myway.comInterdomaine","myway.comEditiqueNumerisation"])}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(e){var t=e.capacites;return function(e){if(e){var n=_.find(t,function(t){return t.Key===_.padLeft(e,2,"0")});return n?n.Value:""}return"Personne morale"}};n.$inject=["contractCommunService"],e.app.filter("capacite",n)}(n=t.filters||(t.filters={}))}(t=e.signataire||(e.signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(e){return function(t){if(t){var n=_.find(e.civilites,function(e){return e.Key===t+""});return n?n.Value:""}return""}};n.$inject=["contractCommunService"],e.app.filter("civilite",n)}(n=t.filters||(t.filters={}))}(t=e.signataire||(e.signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){return function(t){var n;switch(t){case e.modeles.TypeLienPersonne.GESTIONNAIRE_MESURE_PROTECTION:n="Gestionnaire Mesures Protection";break;default:n="Représentant Légal"}return n}};e.app.filter("typelienPersonne",n)}(n=t.filters||(t.filters={}))}(t=e.signataire||(e.signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){"use strict";var n=function(){return function(t){var n;switch(t){case e.modeles.CodeTypePersonne.MORALE:n="Morale";break;case e.modeles.CodeTypePersonne.PHYSIQUE:n="Physique";break;default:n=""}return n}};e.app.filter("typePersonne",n)}(t=e.filters||(e.filters={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict"}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t=function(){function e(){}return e.PHYSIQUE="P",e.MORALE="M",e}();e.CodeTypePersonne=t;var n=function(){function e(){}return e.GESTIONNAIRE_MESURE_PROTECTION="813",e}();e.TypeLienPersonne=n,function(e){e[e.PHYSIQUE=0]="PHYSIQUE",e[e.MORALE=1]="MORALE"}(e.TypePersonne||(e.TypePersonne={}));e.TypePersonne;!function(e){e[e.TITULAIRE=1]="TITULAIRE",e[e.REPRESENTANT_LEGAL=2]="REPRESENTANT_LEGAL",e[e.MANDATAIRE=3]="MANDATAIRE",e[e.AUTRE=4]="AUTRE",e[e.DELEGATAIRE=5]="DELEGATAIRE",e[e.SIGNATAIRE_LEGAL=6]="SIGNATAIRE_LEGAL",e[e.GESTIONNAIRE_MESURE_PROTECTION=11]="GESTIONNAIRE_MESURE_PROTECTION",e[e.REPRESENTANT_LEGAL_PRO=12]="REPRESENTANT_LEGAL_PRO",e[e.VISA_COLLABORATEUR=13]="VISA_COLLABORATEUR"}(e.TypeSignataire||(e.TypeSignataire={}));e.TypeSignataire;!function(e){e[e.TITULAIRE=1]="TITULAIRE",e[e.REPRESENTANT_LEGAL=2]="REPRESENTANT_LEGAL",e[e.SIGNATAIRE_LEGAL=3]="SIGNATAIRE_LEGAL",e[e.DELEGATAIRE=4]="DELEGATAIRE",e[e.MANDATAIRE=5]="MANDATAIRE",e[e.AUTRE=99]="AUTRE"}(e.TypeSignatairePro||(e.TypeSignatairePro={}));e.TypeSignatairePro;!function(e){e[e.TITULAIRE=1]="TITULAIRE",e[e.REPRESENTANT_LEGAL=2]="REPRESENTANT_LEGAL",e[e.EMPRUNTEUR=3]="EMPRUNTEUR",e[e.Co_EMPRUNTEUR=4]="Co_EMPRUNTEUR",e[e.Co_TITULAIRE=5]="Co_TITULAIRE",e[e.CAUTION=6]="CAUTION",e[e.MANDATAIRE=7]="MANDATAIRE",e[e.AUTRE=8]="AUTRE",e[e.DELEGATAIRE=9]="DELEGATAIRE",e[e.SIGNATAIRE_LEGAL=10]="SIGNATAIRE_LEGAL",e[e.GESTIONNAIRE_MESURE_PROTECTION=11]="GESTIONNAIRE_MESURE_PROTECTION",e[e.REPRESENTANT_LEGAL_PRO=12]="REPRESENTANT_LEGAL_PRO",e[e.VISA_COLLABORATEUR=13]="VISA_COLLABORATEUR"}(e.CodeRoleDossierVente||(e.CodeRoleDossierVente={}));e.CodeRoleDossierVente}(t=e.modeles||(e.modeles={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict"}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.toBinary=function(e){return"object"==typeof e&&(e=JSON.stringify(e)),btoa(e)},e.binaryToObject=function(t){return JSON.parse(e.binaryToString(t))},e.binaryToString=function(e){return atob(e)},e}();e.BinaryUtils=t}(t=e.utils||(e.utils={}))}(t=e.sagOpc||(e.sagOpc={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.info=function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=e.getLogMessage(t,n,r),s=JSON.parse(JSON.stringify(i));console.log.apply(console,[a].concat(s)),e.kibanaLogger(t).info(e.parseAndStringify.apply(e,[a].concat(i)))},e.warn=function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=e.getLogMessage(t,n,r),s=JSON.parse(JSON.stringify(i));console.warn.apply(console,[a].concat(s)),e.kibanaLogger(t).warn(e.parseAndStringify.apply(e,[a].concat(i)))},e.error=function(t,n,r){for(var i=[],o=3;o<arguments.length;o++)i[o-3]=arguments[o];var a=e.getLogMessage(t,n,r),s=JSON.parse(JSON.stringify(i));console.error.apply(console,[a].concat(s)),e.kibanaLogger(t).error(e.parseAndStringify.apply(e,[a].concat(i)))},e.kibanaLogger=function(e){return MyWay.Services.Loggers.LoggerFactory.INSTANCE.getClass(e)},e.getLogMessage=function(e,t,n){return"@"+t+" *** "+n+" *** @SIGNCONT@com-contract@"+e.replace("myway.comContract.Services.","").replace("myway.comContract.","")},e.parseAndStringify=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=[].slice.call(arguments,1),i=0;return e.replace(/%o/g,function(){return JSON.stringify(r[i++])})},e.APP_VERSION="@24.02",e}();e.Loggers=t}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){"use strict";var n=function(){function t(e,t){this.$q=e,this.serviceAgentExtended=t}return t.prototype.get=function(n,r){var i=this,o=Date.now(),a=this.getRequestSettings();return a.method=MyWay.Services.MethodEnum.GET,a.url=n,a.params=r,e.comContract.Loggers.info(t.CLASS_NAME,"get","request %o",a),this.serviceAgentExtended.sendRequest(a).then(function(n){return e.comContract.Loggers.info(t.CLASS_NAME,"get","response %o elapsedTime %o",n,Date.now()-o),n})["catch"](function(n){return e.comContract.Loggers.error(t.CLASS_NAME,"get","error %o",n),i.$q.reject(n)})},t.prototype.getRequestSettings=function(){return{withHeaders:!0,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON,timeout:7e4}},t.CLASS_NAME="myway.comContract.RestClient",t.$inject=["$q","serviceAgentExtended"],t}();t.RestClient=n,t.app.service("restClient",n)}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.updateURLParameter=function(e,t,n){var r="",i=e.split("?"),o=i[0],a=i[1],s="";if(a){i=a.split("&");for(var c=0;c<i.length;c++)i[c].split("=")[0]!==t&&(r+=s+i[c],s="&")}var u=s+""+t+"="+n;return o+"?"+r+u},e}();e.UrlUtils=t}(t=e.utils||(e.utils={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.isVisaCollaborateur=function(t){return t.filter(function(t){return t.role===e.modeles.TypeSignataire.VISA_COLLABORATEUR}).length>0},t}();e.VisaCollaborateurUtils=t}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=!0,n=function(){function e(e,t){if(null==e)throw new Error("Root element needs a name");this.xmldec=new o,this.rootObject=new r(this,e,t)}return e.create=function(t,n){return new e(t,n).rootObject},e.prototype.toString=function(){var e,n,r,i;return r=t,e="  ",n="\n",i="",null!=this.xmldec&&(i+=this.xmldec.toString()),i+=this.rootObject.toString(),r&&i.slice(-n.length)===n&&(i=i.slice(0,-n.length)),i},e}();e.XMLBuilder=n;var r=function(){function e(t,n,r){if(null==n)throw new Error("Missing element name");this.name=c.eleName(n),t instanceof e?this.parent=t:this.builder=t,this.children=[],this.attributes={},null!=r&&this.attribute(r)}return e.prototype.element=function(t,n,r){null==n&&(n={});var i=new e(this,t,n);return this.children.push(i),i},e.prototype.attribute=function(e,t){if("string"==typeof e&&null==t)return this;if("string"==typeof e)this.attributes[e]=new i(this,e,t);else for(var n in e)e.hasOwnProperty(n)&&this.attribute(n,e[n]);return this},e.prototype.text=function(e){if(null!=e){var t=new a(this,e);this.children.push(t)}return this},e.prototype.cdata=function(e){if(null!=e){var t=new s(this,e);this.children.push(t)}return this},e.prototype.end=function(){return this.document().toString()},e.prototype.document=function(){return this.root().builder},e.prototype.root=function(){if(!this.parent)return this;for(var e=this.parent;e;)e=e.parent;return e},e.prototype.toString=function(e){var n,r,i,o,a,s,c;i=t,n="  ",r="\n",e=e||0,a=new Array(e+1).join(n),o="",i&&(o+=a),o+="<"+this.name;for(name in this.attributes)this.attributes.hasOwnProperty(name)&&(o+=this.attributes[name].toString());if(c=_.every(this.children,function(e){return""===e.value}),0===this.children.length||c)o+="/>",i&&(o+=r);else if(i&&1===this.children.length&&null!=this.children[0].value)o+=">",o+=this.children[0].value,o+="</"+this.name+">",o+=r;else{for(o+=">",i&&(o+=r),s=0;s<this.children.length;s++)o+=this.children[s].toString(e+1);i&&(o+=a),o+="</"+this.name+">",i&&(o+=r)}return o},e}();e.XMLElement=r;var i=function(){function e(e,t,n){if(null==t)throw new Error("Missing attribute name of element "+e.name);if(null==n)throw new Error("Missing attribute value for attribute "+t+" of element "+e.name);this.name=c.attName(t),this.value=c.attValue(n)}return e.prototype.toString=function(){return" "+this.name+'="'+this.value+'"'},e}();e.XMLAttribute=i;var o=function(){function e(e,t,n){this.version=null!=e?c.xmlVersion(e):"1.0",this.encoding=null!=t?c.xmlEncoding(t):"UTF-8",null!=n&&(this.standalone=c.xmlStandalone(n))}return e.prototype.toString=function(e){var n,r,i,o,a;return i=t,n="  ",r="\n",e=e||0,a=new Array(e+1).join(n),o="",i&&(o+=a),o+="<?xml",null!=this.version&&(o+=' version="'+this.version+'"'),null!=this.encoding&&(o+=' encoding="'+this.encoding+'"'),null!=this.standalone&&(o+=' standalone="'+this.standalone+'"'),o+="?>",i&&(o+=r),o},e}();e.XMLDeclaration=o;var a=function(){function e(e,t){if(null==t)throw new Error("Missing element text");this.value=c.eleText(t)}return e.prototype.toString=function(e){var n,r,i,o,a;return i=t,n="  ",r="\n",e=e||0,a=new Array(e+1).join(n),o="",i&&(o+=a),o+=this.value,i&&(o+=r),o},e}();e.XMLText=a;var s=function(){function e(e,t){if(null==t)throw new Error("Missing element data");this.value="<![CDATA["+c.cdata(t)+"]]>"}return e.prototype.toString=function(e){var n,r,i,o,a;return i=t,n="  ",r="\n",e=e||0,a=new Array(e+1).join(n),o="",i&&(o+=a),o+=this.value,i&&(o+=r),o},e}();e.XMLCData=s;var c=function(){function e(){}return e.eleName=function(t){return t=""+t||"",e.assertLegalChar(t)},e.eleText=function(t){return t=""+t||"",e.assertLegalChar(e.elEscape(t))},e.cdata=function(t){if(t=""+t||"",t.match(/]]>/))throw new Error("Invalid CDATA text: "+t);return e.assertLegalChar(t)},e.comment=function(t){if(t=""+t||"",t.match(/--/))throw new Error("Comment text cannot contain double-hypen: "+t);return e.assertLegalChar(t)},e.raw=function(e){return""+e||""},e.attName=function(e){return""+e||""},e.attValue=function(t){return t=""+t||"",e.attEscape(t)},e.insTarget=function(e){return""+e||""},e.insValue=function(e){if(e=""+e||"",e.match(/\?>/))throw new Error("Invalid processing instruction value: "+e);return e},e.xmlVersion=function(e){if(e=""+e||"",!e.match(/1\.[0-9]+/))throw new Error("Invalid version number: "+e);return e},e.xmlEncoding=function(e){if(e=""+e||"",!e.match(/[A-Za-z](?:[A-Za-z0-9._-]|-)*/))throw new Error("Invalid encoding: "+e);return e},e.xmlStandalone=function(e){return e?"yes":"no"},e.dtdPubID=function(e){return""+e||""},e.dtdSysID=function(e){return""+e||""},e.dtdElementValue=function(e){return""+e||""},e.dtdAttType=function(e){return""+e||""},e.dtdAttDefault=function(e){return null!=e?""+e||"":e},e.dtdEntityValue=function(e){return""+e||""},e.dtdNData=function(e){return""+e||""},e.assertLegalChar=function(t){var n,r;if(n=e.allowSurrogateChars?/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uFFFE-\uFFFF]/:/[\u0000-\u0008\u000B-\u000C\u000E-\u001F\uD800-\uDFFF\uFFFE-\uFFFF]/,r=t.match(n))throw new Error("Invalid character ("+r+") in string: "+t+" at index "+r.index);return t},e.elEscape=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/\r/g,"&#xD;")},e.attEscape=function(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/"/g,"&quot;").replace(/\t/g,"&#x9;").replace(/\n/g,"&#xA;").replace(/\r/g,"&#xD;")},e.allowSurrogateChars=!1,e.convertAttKey="@",e.convertPIKey="?",e.convertTextKey="#text",e.convertCDataKey="#cdata",e.convertCommentKey="#comment",e.convertRawKey="#raw",e.convertListKey="#list",e}();e.XMLStringifier=c}(t=e.utils||(e.utils={}))}(t=e.sagOpc||(e.sagOpc={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function t(e,t){this.serviceAgentExtended=e,this.$q=t}return t.prototype.init=function(){var n=this;return this.getDonneesDelocalisees("codeCapaciteJuridique").then(function(r){return e.comContract.Loggers.info(t.CLASS_NAME,"init","capaciteDeloc %o",r),n.capacites=r.donnees,n.getDonneesDelocalisees("codeCivilite").then(function(r){return e.comContract.Loggers.info(t.CLASS_NAME,"init","civiliteCodes %o",r),n.civilites=r.donnees,n})})},t.prototype.getDonneesDelocalisees=function(e){var t=this;return this.getCodeEtablissement().then(function(n){return t.serviceAgentExtended.DonneesDelocalisees.getDonneesDelocalisees(n,e)})},t.prototype.getHabilitation=function(n){return e.comContract.Loggers.info(t.CLASS_NAME,"getHabilitation","habilitation %o",n),this.$q.when(this.serviceAgentExtended.Habilitation.EstHabilite(n))},t.prototype.getCodeEtablissement=function(){return this.serviceAgentExtended.getAuthentificationInfo().then(function(n){return e.comContract.Loggers.info(t.CLASS_NAME,"getCodeEtablissement","authentificationInfo %o",n),n.codeEtablissement})},t.CLASS_NAME="myway.comContract.signataire.CommunService",t.$inject=["serviceAgentExtended","$q"],t}();n.CommunService=r,t.app.service("contractCommunService",r)}(n=t.signataire||(t.signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(e,t,n,r){this.serviceAgentExtended=e,this.$q=t,this.signatureElectroniqueService=n,this.deploiementSu1pService=r,this.libelleNonEligibilite=null}return n.prototype.verifierEligibiliteSAGSEDReduit=function(r,i,o){var a=this;if(e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit","acte %o listeSignataires %o surchargeNonEligibilite %o %o",r,i,o,t.Loggers.APP_VERSION),null==r)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit",t.ContractualisationActe.MessageErreur.ACTE_GESTION_UNDEFINED),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.ACTE_GESTION_UNDEFINED,"verifierELigibiliteSAGSEDReduit Méthode"));if(null==r.codeActeGestion)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit",t.ContractualisationActe.MessageErreur.CODE_ACTE_GESTION_UNDEFINED),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.CODE_ACTE_GESTION_UNDEFINED,"verifierELigibiliteSAGSEDReduit Méthode"));if(null==r.codeCanal)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit",t.ContractualisationActe.MessageErreur.CODE_CANAL_UNDEFINED),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.CODE_CANAL_UNDEFINED,"verifierELigibiliteSAGSEDReduit Méthode"));if(null==i||0===i.length)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit",t.ContractualisationActe.MessageErreur.NOMBRE_SIGNATAIRES_ACTE_VIDE),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.NOMBRE_SIGNATAIRES_ACTE_VIDE,"verifierELigibiliteSAGSEDReduit Méthode"));if(null==r.codeModeMiseGestion)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit",t.ContractualisationActe.MessageErreur.CODE_MODE_MISE_GESTION_UNDEFINED),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.CODE_MODE_MISE_GESTION_UNDEFINED,"verifierELigibiliteSAGSEDReduit Méthode"));if(null==r.codeTypeMarcheEntreprise)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit",t.ContractualisationActe.MessageErreur.CODE_TYPE_MARCHE_ENTREPRISE_UNDEFINED),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.CODE_TYPE_MARCHE_ENTREPRISE_UNDEFINED,"verifierELigibiliteSAGSEDReduit Méthode"));var s,c,u,l;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(e){l=e;var t=[];return t.push(a.deploiementSu1pService.isDeployeSEMD(l.codeEtablissement,r.codeActeGestion,r.codeCanal,r.typeProfessionnel)),t.push(a.deploiementSu1pService.isDeployeMYSIGN(l.codeEtablissement,r.codeActeGestion,r.codeCanal,r.typeProfessionnel)),a.$q.all(t)}).then(function(e){return s=e[0],c=e[1],a.deploiementSu1pService.isDeployeBulleConfiance(l.codeEtablissement,r.codeActeGestion,r.codeCanal,r.typeProfessionnel,c)}).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit","isDeployeSEMD %o isDeployeMySign %o isDeployeBulleConfiance %o",s,c,t),a.isPreEligibiliteNiveauZero(r,i,o,t)}).then(function(o){if(e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit","isPreEligibiliteNiveauZero %o",o),o)return null==r.listeActeSecondaires&&(r.listeActeSecondaires=[]),a.postContractualisationActe((new t.ContractualisationActe.ContractualisationActeInputFactory).create(r,i,a.listeMateriels,null,!1,!1,!1,null));var s={indicateurPapier:!0,motifNonEligibiliteSAGSED:a.motifNonEligibiliteSAGSED,listePiecesIdentiteManquantes:null,isEligibleVisaCollaborateur:a.isEligibileVisaCollaborateur};return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit","nonEligibiliteSAGSED %o",s),a.$q.when(s)}).then(function(t){return t.isEligibleVisaCollaborateur=a.isEligibileVisaCollaborateur,t.isDeployeMySign=c,t.isDeployeSEMD=s,t.isDeployeBulleConfiance=u,e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit","eligibiliteSAGSED %o",t),a.$q.when(t)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDReduit","error %o",t),a.$q.reject(t)})},n.prototype.verifierEligibiliteSAGSEDComplet=function(r,i,o,a,s){var c=this;if(e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGSEDComplet","acte %o listeSignataires %o listeTitulaires %o surchargeNonEligibilite %o libelleMotifNonEligibProducteur %o %o",r,i,o,a,s,t.Loggers.APP_VERSION),null==r)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDComplet",t.ContractualisationActe.MessageErreur.ACTE_GESTION_UNDEFINED),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.ACTE_GESTION_UNDEFINED,"verifierELigibiliteSAGSEDComplet Méthode"));if(null==r.codeActeGestion)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDComplet",t.ContractualisationActe.MessageErreur.CODE_ACTE_GESTION_UNDEFINED),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.CODE_ACTE_GESTION_UNDEFINED,"verifierELigibiliteSAGSEDComplet Méthode"));if(null==r.codeCanal)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDComplet",t.ContractualisationActe.MessageErreur.CODE_CANAL_UNDEFINED),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.CODE_CANAL_UNDEFINED,"verifierELigibiliteSAGSEDComplet Méthode"));if(null==i||0===i.length)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDComplet",t.ContractualisationActe.MessageErreur.NOMBRE_SIGNATAIRES_ACTE_VIDE),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.NOMBRE_SIGNATAIRES_ACTE_VIDE,"verifierELigibiliteSAGSEDComplet Méthode"));if(null==r.codeModeMiseGestion)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDComplet",t.ContractualisationActe.MessageErreur.CODE_MODE_MISE_GESTION_UNDEFINED),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.CODE_MODE_MISE_GESTION_UNDEFINED,"verifierELigibiliteSAGSEDComplet Méthode"));if(null==r.codeTypeMarcheEntreprise)return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDComplet",t.ContractualisationActe.MessageErreur.CODE_TYPE_MARCHE_ENTREPRISE_UNDEFINED),this.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.CODE_TYPE_MARCHE_ENTREPRISE_UNDEFINED,"verifierELigibiliteSAGSEDComplet Méthode"));var u,l,E,g;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(e){g=e;var t=[];return t.push(c.deploiementSu1pService.isDeployeSEMD(g.codeEtablissement,r.codeActeGestion,r.codeCanal,r.typeProfessionnel)),t.push(c.deploiementSu1pService.isDeployeMYSIGN(g.codeEtablissement,r.codeActeGestion,r.codeCanal,r.typeProfessionnel)),c.$q.all(t)}).then(function(e){return u=e[0],l=e[1],c.deploiementSu1pService.isDeployeBulleConfiance(g.codeEtablissement,r.codeActeGestion,r.codeCanal,r.typeProfessionnel,l)}).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGSEDComplet","isDeployeSEMD %o isDeployeMySign %o isDeployeBulleConfiance %o",u,l,t),c.isPreEligibiliteNiveauZero(r,i,a,t)}).then(function(E){return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGSEDComplet","isPreEligibiliteNiveauZero %o",E),null==r.listeActeSecondaires&&(r.listeActeSecondaires=[]),c.putContractualisationActe((new t.ContractualisationActe.ContractualisationActeInputFactory).create(r,i,c.listeMateriels,o,a,u,l,g.agentConnecte.referenceExterneAgent,s))}).then(function(t){return t.isEligibleVisaCollaborateur=c.isEligibileVisaCollaborateur,t.isDeployeBulleConfiance=E,e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGSEDComplet","contractualisationActe %o",t),c.$q.when(t)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGSEDComplet","error %o",t),c.$q.reject(t)})},n.prototype.getMateriels=function(t){var r=this.$q.defer(),i=new(function(){function e(){}return e}());return t?i.methode=MyWay.Services.Mobilite.RECUP_INFO.DETECTION:i.methode=MyWay.Services.Mobilite.RECUP_INFO.FICHIER,this.serviceAgentExtended.Mobilite.getTablettesSignature(i).then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"getMateriels","result %o ",t),r.resolve(t)})["catch"](function(t){e.comContract.Loggers.error(n.CLASS_NAME,"getMateriels","error %o ",t),r.resolve(new Array)}),r.promise},n.prototype.isPreEligibiliteNiveauZero=function(r,i,o,a){var s=this;e.comContract.Loggers.info(n.CLASS_NAME,"isPreEligibiliteNiveauZero","acte %o listeSignataires %o surchargeNonEligibilite %o isDeployeBulleConfiance %o %o",r,i,o,a,t.Loggers.APP_VERSION);var c=this.$q.defer(),u=[];return u.push(this.getMateriels(a)),this.$q.all(u).then(function(a){s.listeMateriels=s.getListeMaterielFromListeTabletteSignature(a[0]),e.comContract.Loggers.info(n.CLASS_NAME,"isPreEligibiliteNiveauZero","listeMateriels %o ",s.listeMateriels),o?(e.comContract.Loggers.info(n.CLASS_NAME,"isPreEligibiliteNiveauZero","non eligible! (FAF && PART) motif %o",s.motifNonEligibiliteSAGSED),s.motifNonEligibiliteSAGSED=null,c.resolve(!1)):r.codeCanal===t.ContractualisationActe.Constants.CODE_CANAL_FACE_A_FACE&&null==r.typeProfessionnel?(0!==s.listeMateriels.length||e.comContract.VisaCollaborateurUtils.isVisaCollaborateur(i)||(s.libelleNonEligibilite=t.ContractualisationActe.MessageErreur.CONTROLE_MATERIELS,s.motifNonEligibiliteSAGSED=t.ContractualisationActe.MotifNonEligibiliteSAGSEDFactory.createMotifNonEligibiliteSAGSED(t.ContractualisationActe.CodeNonELigibilite.CONTROLE_MATERIELS,t.ContractualisationActe.LibelleNonELigibilite.CONTROLE_MATERIELS),e.comContract.Loggers.info(n.CLASS_NAME,"isPreEligibiliteNiveauZero","non eligible! (FAF && PART) motif %o",s.motifNonEligibiliteSAGSED),c.resolve(!1)),s.isExisteSignataireAutre(i)&&(s.libelleNonEligibilite=t.ContractualisationActe.MessageErreur.CONTROLE_SIGNATAIRE_AUTRE,s.motifNonEligibiliteSAGSED=t.ContractualisationActe.MotifNonEligibiliteSAGSEDFactory.createMotifNonEligibiliteSAGSED(t.ContractualisationActe.CodeNonELigibilite.CONTROLE_SIGNATAIRE_AUTRE,t.ContractualisationActe.LibelleNonELigibilite.CONTROLE_SIGNATAIRE_AUTRE),e.comContract.Loggers.info(n.CLASS_NAME,"isPreEligibiliteNiveauZero","non eligible! (FAF && PART) motif %o",s.motifNonEligibiliteSAGSED),c.resolve(!1)),s.isExisteSignataireMandataire(i)&&(s.libelleNonEligibilite=t.ContractualisationActe.MessageErreur.CONTROLE_SIGNATAIRE_MANDATAIRE,s.motifNonEligibiliteSAGSED=t.ContractualisationActe.MotifNonEligibiliteSAGSEDFactory.createMotifNonEligibiliteSAGSED(t.ContractualisationActe.CodeNonELigibilite.CONTROLE_SIGNATAIRE_MANDATAIRE,t.ContractualisationActe.LibelleNonELigibilite.CONTROLE_SIGNATAIRE_MANDATAIRE),e.comContract.Loggers.info(n.CLASS_NAME,"isPreEligibiliteNiveauZero","non eligible! (FAF && PART) motif %o",s.motifNonEligibiliteSAGSED),c.resolve(!1)),i.length>5&&(s.libelleNonEligibilite=t.ContractualisationActe.MessageErreur.CONTROLE_TROP_SIGNATAIRES,s.motifNonEligibiliteSAGSED=t.ContractualisationActe.MotifNonEligibiliteSAGSEDFactory.createMotifNonEligibiliteSAGSED(t.ContractualisationActe.CodeNonELigibilite.CONTROLE_NOMBRE_SIGNATAIRES,t.ContractualisationActe.LibelleNonELigibilite.CONTROLE_NOMBRE_SIGNATAIRES),e.comContract.Loggers.info(n.CLASS_NAME,"isPreEligibiliteNiveauZero","non eligible! (FAF && PART) motif %o",s.motifNonEligibiliteSAGSED),c.resolve(!1)),e.comContract.Loggers.info(n.CLASS_NAME,"isPreEligibiliteNiveauZero","eligible! (FAF && PART)"),c.resolve(!0)):(e.comContract.Loggers.info(n.CLASS_NAME,"isPreEligibiliteNiveauZero","eligible! (!FAF || (FAF && PRO))"),c.resolve(!0))})["catch"](function(t){e.comContract.Loggers.error(n.CLASS_NAME,"isPreEligibiliteNiveauZero","error %o",t),c.reject(t)}),c.promise},n.prototype.getListeMaterielFromListeTabletteSignature=function(e){var t=[];return _.forEach(e,function(e){if(null!==e){var n={codeModele:e.codeModele,identifiant:e.idMateriel,modele:e.modele,type:e.type,typePeripherique:e.typePeripherique};t.push(n)}}),t},n.prototype.isExisteSignataireMandataire=function(e){var n=_.find(e,function(e){return e.role===t.modeles.TypeSignataire.MANDATAIRE});return null!=n?!0:!1},n.prototype.isExisteSignataireAutre=function(e){var n=_.find(e,function(e){return e.role===t.modeles.TypeSignataire.AUTRE});return null!=n?!0:!1},n.prototype.postContractualisationActe=function(r){var i=this,o=Date.now(),a=new t.ContractualisationActe.ContractualisationActeRequestFactory(MyWay.Services.MethodEnum.POST,r).create();return e.comContract.Loggers.info(n.CLASS_NAME,"postContractualisationActe","request %o",a),this.serviceAgentExtended.sendRequest(a).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"postContractualisationActe","response %o elapsedTime %o",t,Date.now()-o),t})["catch"](function(r){return e.comContract.Loggers.error(n.CLASS_NAME,"postContractualisationActe","error %o",r),i.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.ERREUR_TECHNIQUE,"postContractualisationActe Méthode",r))})},n.prototype.putContractualisationActe=function(r){var i=this,o=Date.now(),a=new t.ContractualisationActe.ContractualisationActeRequestFactory(MyWay.Services.MethodEnum.PUT,r).create();return e.comContract.Loggers.info(n.CLASS_NAME,"putContractualisationActe","request %o",a),this.serviceAgentExtended.sendRequest(a).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"putContractualisationActe","response %o elapsedTime %o",t,Date.now()-o),t})["catch"](function(r){return e.comContract.Loggers.error(n.CLASS_NAME,"putContractualisationActe","error %o",r),i.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.ERREUR_TECHNIQUE,"putContractualisationActe Méthode",r))})},n.CLASS_NAME="myway.comContract.Services.ContractualisationActeService",n.$inject=["serviceAgentExtended","$q","signatureElectroniqueService","deploiementSu1pService"],n}();n.ContractualisationActeService=r,t.app.service("contractualisationActeService",r)}(n=t.Services||(t.Services={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(e,t){this.serviceAgentExtended=e,this.$q=t}return n.prototype.isDeployeSEMD=function(r,i,o,a){var s=this,c=Date.now();if(e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeSEMD","codeEtablissement %o codeActeGestion %o codeCanal %o typeProfessionnel %o %o",r,i,o,a,t.Loggers.APP_VERSION),r&&o&&i){var u=a?t.Enums.CodeApplication.SEMD_BDR:t.Enums.CodeApplication.SEMD,l=!1,E=[];E.push({propriete:"COSXAP",valeur:u,operateur:MyWay.Services.DonneesDelocalisees.CRITERES_OPERATEUR.EGAL});var g,S,m=i.substring(2),C=this.getModeContractualisation(o,a);return m?this.serviceAgentExtended.Context.GetFromContext("ParametresServeurPoste").then(function(t){var i=JSON.parse(t);return g=i.NomServeur,e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeSEMD","modeContractualisation %o objetActeGestion %o paramServeurPoste %o codeEtablissement %o criteres %o",C,m,i,r,E),s.serviceAgentExtended.DonneesDelocalisees.getDonneesParCriteres(r,"SU1P",E)}).then(function(t){if(S=t,e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeSEMD","parametresSu1p %o codeEtablissement %o",S,r),S&&S.length){if(S=s.filtreSU1PParDates(t),S&&S.length?e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeSEMD","les lignes SU1P SEMD avec la date valide %o",S):e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeSEMD","absence des lignes SU1P SEMD avec la date valide pour la caisse %o",r),S&&S.length)for(var i=S.length,o=0;!l&&i>o;)(S[o].WLNLU||S[o].COEIO1||S[o].CTLIME)&&(g!==S[o].WLNLU&&S[o].WLNLU||m!==S[o].COEIO1&&S[o].COEIO1||C!==S[o].CTLIME&&S[o].CTLIME||(l=!0)),o++}else l=!0;return e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeSEMD","isDeployeSEMD %o elapsedTime %o",l,Date.now()-c),s.$q.when(l)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"isDeployeSEMD","error %o - isDeployeSEMD %o",t,!1),s.$q.when(!1)}):(e.comContract.Loggers.error(n.CLASS_NAME,"isDeployeSEMD","modeContractualisation %o or objetActeGestion %o is undefined - isDeployeSEMD %o",C,m,!1),this.$q.when(!1))}return e.comContract.Loggers.error(n.CLASS_NAME,"isDeployeSEMD","codeEtablissement %o or codeCanal %o or codeActeGestion %o is undefined - isDeployeSEMD %o",r,o,i,!1),this.$q.when(!1)},n.prototype.isDeployeMYSIGN=function(r,i,o,a,s){var c=this,u=Date.now();if(e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeMYSIGN","codeEtablissement %o codeActeGestion %o codeCanal %o typeProfessionnel %o isSagOpc %o %o",r,i,o,a,s,t.Loggers.APP_VERSION),r&&o&&i){var l=t.Enums.CodeApplication.MYSIGN,E=[];E.push({propriete:"COSXAP",valeur:l,operateur:MyWay.Services.DonneesDelocalisees.CRITERES_OPERATEUR.EGAL});var g,S,m=i.substring(2),C=this.getModeContractualisation(o,a,s);if(m){var p=!1;return this.serviceAgentExtended.Context.GetFromContext("ParametresServeurPoste").then(function(t){
var i=JSON.parse(t);return g=i.NomServeur,e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeMYSIGN","modeContractualisation %o objetActeGestion %o paramServeurPoste %o codeEtablissement %o criteres %o",C,m,i,r,E),c.serviceAgentExtended.DonneesDelocalisees.getDonneesParCriteres(r,"SU1P",E)}).then(function(t){if(S=t,e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeMYSIGN","parametresSu1p %o codeEtablissement %o",S,r),S&&S.length){if(S=c.filtreSU1PParDates(t),S&&S.length?e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeMYSIGN","les lignes SU1P MYSIGN avec la date valide %o",S):e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeMYSIGN","absence des lignes SU1P MYSIGN avec la date valide pour la caisse %o",r),S&&S.length)for(var i=S.length,o=0;!p&&i>o;)(S[o].WLNLU||S[o].COEIO1||S[o].CTLIME)&&(g!==S[o].WLNLU&&S[o].WLNLU||m!==S[o].COEIO1&&S[o].COEIO1||C!==S[o].CTLIME&&S[o].CTLIME||(p=!0)),o++}else p=!0;return e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeMYSIGN","isDeployeMYSIGN %o elapsedTime %o",p,Date.now()-u),c.$q.when(p)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"isDeployeMYSIGN","error %o",t),c.$q.when(!1)})}return e.comContract.Loggers.error(n.CLASS_NAME,"isDeployeMYSIGN","modeContractualisation %o or objetActeGestion %o is undefined - isDeployeMYSIGN %o",C,m,!1),this.$q.when(!1)}return e.comContract.Loggers.error(n.CLASS_NAME,"isDeployeMYSIGN","codeEtablissement %o or codeCanal %o or codeActeGestion %o is undefined - isDeployeMYSIGN %o",r,o,i,!1),this.$q.when(!1)},n.prototype.isDeployeBulleConfiance=function(r,i,o,a,s){var c=this;if(o===t.Enums.CodeCanalVente.TELEPHONIQUE||a||!s)return e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeBulleConfiance","CanalVente.TELEPHONIQUE || typeProfessionnel || !isDeployeMySign - isDeployeBulleConfiance %o",o,a,s,!1),this.$q.when(!1);var u=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeBulleConfiance","codeEtablissement %o codeActeGestion %o codeCanal %o typeProfessionnel %o isDeployeMySign %o %o",r,i,o,a,s,t.Loggers.APP_VERSION);var l=t.Enums.CodeApplication.BULLECONFIANCE,E=[];E.push({propriete:"COSXAP",valeur:l,operateur:MyWay.Services.DonneesDelocalisees.CRITERES_OPERATEUR.EGAL});var g,S=!1;return this.serviceAgentExtended.Context.GetFromContext("ParametresServeurPoste").then(function(t){var i=JSON.parse(t);return g=i.NomServeur,e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeBulleConfiance","paramServeurPoste %o codeEtablissement %o criteres %o",i,r,E),c.serviceAgentExtended.DonneesDelocalisees.getDonneesParCriteres(r,"SU1P",E)}).then(function(t){if(e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeBulleConfiance","parametresSu1p %o codeEtablissement %o",t,r),t&&t.length){if(t=c.filtreSU1PParDates(t),t&&t.length?e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeBulleConfiance","les lignes SU1P BULLCONF avec la date valide %o",t):e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeBulleConfiance","absence des lignes SU1P BULLCONF avec la date valide pour la caisse %o",r),t&&t.length)for(var i=t.length,o=0;!S&&i>o;)t[o].WLNLU&&g===t[o].WLNLU&&(S=!0,e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeBulleConfiance","serveurAgence %o isBulleConfiance %o elapsedTime %o",g,S,Date.now()-u)),o++}else S=!0,e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeBulleConfiance","Absence des lignes SU1P BULLCONF pour la caisse %o serveurAgence %o isBulleConfiance %o elapsedTime %o",r,g,S,Date.now()-u);return S||e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeBulleConfiance","serveurAgence %o isBulleConfiance %o elapsedTime %o",g,S,Date.now()-u),c.$q.when(S)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"isDeployeBulleConfiance","error %o",t),c.$q.when(!1)})},n.prototype.filtreSU1PParDates=function(e){var t=new Date;return e.filter(function(e){return t>=MyWay.Services.DateUtils.fromJJMMAAAA(e.DDEJDA)&&t<MyWay.Services.DateUtils.fromJJMMAAAA(e.DFEJDA)})},n.prototype.getModeContractualisation=function(e,n,r){return r?t.Enums.ModeContractualisation.FAFG:e===t.Enums.CodeCanalVente.FACE_A_FACE||e===t.Enums.CodeCanalVente.MOBILITE?n?t.Enums.ModeContractualisation.FFPE:t.Enums.ModeContractualisation.FAFE:e===t.Enums.CodeCanalVente.TELEPHONIQUE?t.Enums.ModeContractualisation.VADE:e===t.Enums.CodeCanalVente.INTERNET?t.Enums.ModeContractualisation.VELE:t.Enums.ModeContractualisation.FAFE},n.prototype.controlerTableSU1P=function(t){return this.getTableSU1P(t).then(function(t){return{isDeployeSAGOpc:_.some(t,function(t){return t.COEIO1===e.comContract.OPC.Enums.ModeContractualisation.FAFG||t.COEIO1===e.comContract.OPC.Enums.ModeContractualisation.FAFGXML}),isSensibiliteBordereauPossible:_.some(t,function(t){return t.COEIO1===e.comContract.OPC.Enums.ModeContractualisation.FAFGXML})}})},n.prototype.getTableSU1P=function(t){var r=Date.now();return this.serviceAgentExtended.getDonneesDelocalisees(t,"SU1P").then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"getTableSU1P","data %o elapsedTime %o",t,Date.now()-r),t.donnees})},n.CLASS_NAME="myway.comContract.Services.DeploiementSu1pService",n.$inject=["serviceAgentExtended","$q"],n}();n.DeploiementSu1pService=r,t.app.service("deploiementSu1pService",r)}(n=t.Services||(t.Services={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(e,t){this.$q=e,this.serviceAgentExtended=t}return n.prototype.postCreationDossierCanalNum=function(r,i,o,a,s,c,u,l,E,g,S,m,C,p,d,A){var f=this,R=Date.now();return e.comContract.Loggers.info(n.CLASS_NAME,"postCreationDossierCanalNum","codeActeGestion %o listeActeSecondaires %o identifiantActeIDN %o codeCanal %o referenceOffre %o codeTypeProduit %o numeroEntiteTitulaire %o identifiantAgent %o referenceEDSInterneClient %o referenceEDSExterneClient %o codeGuichet %o acteGestionArcade %o nodapeTitulaire %o acteGestionCompteSupport %o compte %o identifiantActeExterne %o %o",r,i,o,a,s,c,u,l,E,g,S,m,C,p,d,A,t.Loggers.APP_VERSION),this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(R){e.comContract.Loggers.info(n.CLASS_NAME,"postCreationDossierCanalNum","authenticationInfo %o",R);var N=(new t.Ressources.DossierCanalNumerique.ActeGestionFactory).createListeActeGestion(r,i,o,a,f.getIdOffre(s),c,u,l,E,g,S,m,C,p,d,f.getCodeTypeEDS(R),R.codeEtablissement,A),y={listeActeGestion:N},T=new e.comContract.Ressources.DossierCanalNumerique.DossierCanalNumeriqueRequestFactory(MyWay.Services.MethodEnum.POST,y).create();return e.comContract.Loggers.info(n.CLASS_NAME,"postCreationDossierCanalNum","request %o",T),f.serviceAgentExtended.sendRequest(T)}).then(function(r){if(null!=r&&null!=r.listeDossierCanalNumerique&&r.listeDossierCanalNumerique.length>0)return f.dossierCanalNumeriqueOutput=r,e.comContract.Loggers.info(n.CLASS_NAME,"postCreationDossierCanalNum","SUCCESS! response %o elapsedTime %o",r,Date.now()-R),f.$q.when(!0);var i=new t.VenteVpc.Modeles.VenteVpcMessageErreur(t.VenteVpc.Modeles.VenteVpcMessageErreur.PB_RESSOURCE_REST_DOSSIER_CANAL_NUMERIQUE,"postCreationDossierCanalNum");return e.comContract.Loggers.error(n.CLASS_NAME,"postCreationDossierCanalNum","venteVpcMessageErreur %o response %o elapsedTime %o",i,r,Date.now()-R),f.$q.reject(i)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"postCreationDossierCanalNum","error %o",t),f.$q.reject(t)})},n.prototype.getIdOffre=function(e){return null==e?0:e},n.prototype.getCodeTypeEDS=function(e){return e.agentConnecte.typeEdsRattachement},n.CLASS_NAME="myway.comContract.Services.DossierCanalNumeriqueService",n.$inject=["$q","serviceAgentExtended"],n}();n.DossierCanalNumeriqueService=r,t.app.service("dossierCanalNumeriqueService",r)}(n=t.Services||(t.Services={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(e,t){this.$q=e,this.serviceAgentExtended=t}return n.prototype.postDossierContratService=function(r,i,o,a,s,c,u,l,E,g,S,m,C,p,d,A,f,R,N){var y=this,T=Date.now();return e.comContract.Loggers.info(n.CLASS_NAME,"postDossierContratService","codeActeGestion %o listeActeSecondaires %o identifiantDossierNumerique %o codeCanal %o referenceOffre %o codeTypeProduit %o numeroEntiteTitulaire %o identifiantAgent %o referenceEDSInterneClient %o referenceEDSExterneClient %o codeGuichet %o acteGestionArcade %o nodapeTitulaire %o acteGestionCompteSupport %o referenceContrat %o identifiantActeExterne %o modeSignature %o %o",r,o,a,s,c,u,l,E,g,S,m,C,p,d,A,f,R,t.Loggers.APP_VERSION),this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"postDossierContratService","authenticationInfo %o",t);var u=(new e.comContract.Ressources.DossierContratServi.DossierContratServiceInputFactory).createDossierContratServiceInputFromDossierNumerique(r,i,l,o,d,E,S,a,f,A,c,t.codeEtablissement,y.getCodeModeContractualisation(s),m,null,s,y.mapListeDocuments(r,N.listeDocument)),g=new e.comContract.Ressources.DossierContratServi.DossierContratServiRequestFactory(MyWay.Services.MethodEnum.POST,u).create();return e.comContract.Loggers.info(n.CLASS_NAME,"postDossierContratService","request %o",g),y.serviceAgentExtended.sendRequest(g)}).then(function(r){if(null!=r&&(9===r.coderetour||r.listeDossierClasseurClient&&r.listeDossierClasseurClient.length))return e.comContract.Loggers.info(n.CLASS_NAME,"postDossierContratService","SUCCESS! response %o elapsedTime %o",r,Date.now()-T),y.$q.when(!0);var i=new t.VenteVpc.Modeles.VenteVpcMessageErreur(t.VenteVpc.Modeles.VenteVpcMessageErreur.PB_RESSOURCE_REST_DOSSIER_CONTRAT_SERVI,"postDossierContratService");return e.comContract.Loggers.error(n.CLASS_NAME,"postDossierContratService","venteVpcMessageErreur %o response %o elapsedTime %o",i,r,Date.now()-T),y.$q.reject(i)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"postDossierContratService","error %o",t),y.$q.reject(t)})},n.prototype.getCodeModeContractualisation=function(e){return e===t.Enums.CodeCanalVente.FACE_A_FACE?t.Enums.ModeContractualisation.FAFE:e===t.Enums.CodeCanalVente.MOBILITE?t.Enums.ModeContractualisation.FFPE:e===t.Enums.CodeCanalVente.INTERNET?t.Enums.ModeContractualisation.VELD:t.Enums.ModeContractualisation.VADE},n.prototype.mapListeDocuments=function(t,r){var i=this,o=[];return _.forEach(r,function(e){var n;n=null!=e.donneesContenuDocument&&null!=e.donneesContenuDocument.fluxFilenet&&null!=e.donneesContenuDocument.fluxFilenet.identifiantGEDDocument?e.donneesContenuDocument.fluxFilenet.identifiantGEDDocument:null!=e.donneesContenuDocument&&null!=e.donneesContenuDocument.fluxGedTemporaire&&null!=e.donneesContenuDocument.fluxGedTemporaire.identifiantDocumentTemporaire?e.donneesContenuDocument.fluxGedTemporaire.identifiantDocumentTemporaire:"9999";var r={codeActe:t,idDocument:n,typeDocument:e.donneesComportementSignatureDocument.descriptionDocument.codeTypeDocument,typeAttributaire:i.mapTypeAttributaireToCodeTypeAttributaire(e.donneesStockageDocument.codeTypeAttributaire),natureDocument:e.donneesStockageDocument.identifiantNaturePieceJointe,attributairePrincipal:e.donneesStockageDocument.identifiantAttributaire,attributaireSecondaire:e.donneesStockageDocument.intituleAttributaire};o.push(r)}),e.comContract.Loggers.info(n.CLASS_NAME,"mapListeDocuments","documents %o",o),o},n.prototype.mapTypeAttributaireToCodeTypeAttributaire=function(e){return"Contrat"===e?"1":"Personne"===e?"2":"Entité Titulaire"===e?"7":void 0},n.CLASS_NAME="myway.comContract.Services.DossierContratServiService",n.$inject=["$q","serviceAgentExtended"],n}();n.DossierContratServiService=r,t.app.service("dossierContratServiService",r)}(n=t.Services||(t.Services={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(e,t){this.$q=e,this.serviceAgentExtended=t}return n.prototype.putDossierContrat=function(r,i,o,a,s,c,u,l,E,g,S){var m=this,C=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"putDossierContrat","codeEtablissementFinancier %o codeModeContractualisation %o codeActeGestion %o codeGuichet %o numeroEntiteTitulaire %o referenceContrat %o referenceEDSInterneClient %o referenceEDSExterneClient %o listeActeSecondaires %o nbPersonneEntiteTitulaire %o identifiantActeExterne %o %o",r,i,o,a,s,c,u,l,E,g,S,t.Loggers.APP_VERSION);var p=(new t.Ressources.DossierContrat.DossierContratFactory).createDossierContrat(r,i,o,a,s,c,u,l,E,g,S),d=new t.Ressources.DossierContrat.DossierContratRequestFactory(MyWay.Services.MethodEnum.PUT,p).create();return e.comContract.Loggers.info(n.CLASS_NAME,"putDossierContrat","request %o",d),this.serviceAgentExtended.sendRequest(d).then(function(t){return null!=t?(e.comContract.Loggers.info(n.CLASS_NAME,"putDossierContrat","SUCCES! listeNumerosDossier %o elapsedTime %o",t,Date.now()-C),m.$q.when(!0)):(e.comContract.Loggers.error(n.CLASS_NAME,"putDossierContrat","listeNumerosDossier %o elapsedTime %o",t,Date.now()-C),m.$q.when(!1))})["catch"](function(r){var i=new t.VenteVpc.Modeles.VenteVpcMessageErreur(t.VenteVpc.Modeles.VenteVpcMessageErreur.PB_RESSOURCE_REST_DOSSIER_CONTRAT,"putDossierContrat");return e.comContract.Loggers.error(n.CLASS_NAME,"putDossierContrat","venteVpcMessageErreur %o error %o",i,r),m.$q.reject(i)})},n.CLASS_NAME="myway.comContract.Services.DossierContratService",n.$inject=["$q","serviceAgentExtended"],n}();n.DossierContratService=r,t.app.service("dossierContratService",r)}(n=t.Services||(t.Services={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(e,t){this.serviceAgentExtended=e,this.$q=t}return n.prototype.filtreSU1PParDates=function(t){var r=new Date;return t.filter(function(t){var i=MyWay.Services.DateUtils.fromJJMMAAAA(t.DDEJDA),o=MyWay.Services.DateUtils.fromJJMMAAAA(t.DFEJDA);return e.comContract.Loggers.info(n.CLASS_NAME,"filtreSU1PParDates","dateDebut %o <= dateDuJour %o < dateFin %o",i,o,r),r>=i&&o>r})},n.prototype.isDeployeMYSIGN=function(r,i,o){var a=this;e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeMYSIGN","codeEtablissement %o codeActeGestion %o codeCanal %o",r,i,o);var s="MYSIGN",c=!1,u=[];u.push({propriete:"COSXAP",valeur:s,operateur:MyWay.Services.DonneesDelocalisees.CRITERES_OPERATEUR.EGAL});var l;i&&(l=i.substring(2));var E,g,S=this.getModeContractualisation(o);return this.serviceAgentExtended.Context.GetFromContext("ParametresServeurPoste").then(function(t){var i=JSON.parse(t);return E=i.NomServeur,e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeMYSIGN","paramServeurPoste %o codeEtablissement %o criteres %o",i,r,u),a.serviceAgentExtended.DonneesDelocalisees.getDonneesParCriteres(r,"SU1P",u)}).then(function(t){if(g=t,g=a.filtreSU1PParDates(t),e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeMYSIGN","TableDeloc %o parametresSu1p %o",t,g),g&&g.length){for(var r=!0,i=!1,o=!0,s=!1,u=!0,m=!1,C=g.length,p=0;(!i||!s||!m)&&C>p;)r&&g[p].WLNLU&&(r=!1),!i&&g[p].WLNLU&&g[p].WLNLU===E&&(i=!0),o&&g[p].COEIO1&&(o=!1),!s&&g[p].COEIO1&&l&&g[p].COEIO1===l&&(s=!0),u&&g[p].CTLIME&&(u=!1),!m&&g[p].CTLIME&&g[p].CTLIME===S&&(m=!0),p++;c=r&&o&&u?!1:i&&s&&m||r&&o&&m||r&&s&&u||i&&o&&u?!0:!1}else c=!0;return e.comContract.Loggers.info(n.CLASS_NAME,"isDeployeMYSIGN","isDeployeMYSIGN %o",c),a.$q.when(c)})["catch"](function(r){return e.comContract.Loggers.error(n.CLASS_NAME,"isDeployeMYSIGN","error %o",r),a.$q.reject(new t.ContractualisationActe.MessageErreur(t.ContractualisationActe.MessageErreur.ERREUR_TECHNIQUE,"isDeployeMYSIGN Méthode",r,t.ContractualisationActe.MessageErreur.PB_IS_DEPLOYEE_SEMD_MYSIGN))})},n.prototype.getModeContractualisation=function(e){return"FF"===e?"FAFE":"TL"===e?"VADE":"MO"===e?"FFPE":"VELE"},n.prototype.consulterDossierNumerique=function(r,i,o,a,s,c,u,l){var E=this,g=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"consulterDossierNumerique","idDossierNumerique %o codeApplication %o avecDocuments %o avecReferences %o avecEmplacementsSignatures %o avecBinaires %o avecSignataires %o avecTitulaires %o %o",r,i,o,a,s,c,u,l,t.Loggers.APP_VERSION);var S=(new e.comContract.DossierNumerique.DossierNumeriqueRequestFactory).getDossierNumeriqueRequest(r,i,o,a,s,c,u,l);return e.comContract.Loggers.info(n.CLASS_NAME,"consulterDossierNumerique","request %o",S),this.serviceAgentExtended.sendRequest(S).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"consulterDossierNumerique","response %o elapsedTime %o",t,Date.now()-g),t})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"consulterDossierNumerique","error %o",t),E.$q.reject(t)})},n.prototype.getEtatDossierNumerique=function(r,i){var o=this,a=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"getEtatDossierNumerique","idDossierNumerique %o codeApplication %o %o",r,i,t.Loggers.APP_VERSION);var s=(new e.comContract.DossierNumerique.DossierNumeriqueRequestFactory).getDossierNumeriqueRequest(r,i,!1,!1,!1,!1,!1,!1);return e.comContract.Loggers.info(n.CLASS_NAME,"getEtatDossierNumerique","request %o",s),this.serviceAgentExtended.sendRequest(s).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"getEtatDossierNumerique","response %o elapsedTime %o",t,Date.now()-a),t.acte.etatDossier})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"getEtatDossierNumerique","error %o",t),o.$q.reject(t)})},n.prototype.reserverDossierNumerique=function(r){var i=this,o=Date.now();if(e.comContract.Loggers.info(n.CLASS_NAME,"reserverDossierNumerique","dossierNumerique %o %o",r,t.Loggers.APP_VERSION),r.isDeployeMySign){var a=(new e.comContract.DossierNumerique.DossierNumeriqueRequestFactory).postDossierNumeriqueRequest(r);return e.comContract.Loggers.info(n.CLASS_NAME,"reserverDossierNumerique","isDeployeMySign true request %o",a),this.serviceAgentExtended.sendRequest(a).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"reserverDossierNumerique","isDeployeMySign true response %o elapsedTime %o",t,Date.now()-o),t})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"reserverDossierNumerique","error %o",t),i.$q.reject("Problème technique se produit lors de l'appel à la méthode dossierNumeriqueService.reserverDossierNumerique")})}var s,c=!1;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(e){return s=e.codeEtablissement,i.isDeployeMYSIGN(s,null,null)}).then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"reserverDossierNumerique","codeEtablissement %o isDeployeMySign %o",s,t),r.isDeployeMySign=t;var o=(new e.comContract.DossierNumerique.DossierNumeriqueRequestFactory).postDossierNumeriqueRequest(r);return e.comContract.Loggers.info(n.CLASS_NAME,"reserverDossierNumerique","isDeployeMySign %o request %o",t,o),c=t,i.serviceAgentExtended.sendRequest(o)}).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"reserverDossierNumerique","isDeployeMySign %o response %o elapsedTime %o",c,t,Date.now()-o),t})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"reserverDossierNumerique","error %o",t),i.$q.reject("Problème technique se produit lors de l'appel à la méthode dossierNumeriqueService.reserverDossierNumerique")})},n.prototype.alimenterDossierNumerique=function(r){var i=this,o=Date.now();if(e.comContract.Loggers.info(n.CLASS_NAME,"alimenterDossierNumerique","dossierNumerique %o %o",r,t.Loggers.APP_VERSION),!r.isDeployeMySign&&!r.isOffreMixte){var a;this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"alimenterDossierNumerique","authenticationInfo %o",t),a=t.codeEtablissement,i.isDeployeMYSIGN(a,null,null)}).then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"alimenterDossierNumerique","codeEtablissement %o deployeMySign %o",a,t),r.isDeployeMySign=t})}r.isOffreMixte&&-1!==r.acte.idDossierNumerique.indexOf("MS")&&(e.comContract.Loggers.info(n.CLASS_NAME,"alimenterDossierNumerique","set idDossierNumerique to NULL isOffreMixte %o idDossierNumerique was %o",r.isOffreMixte,r.acte.idDossierNumerique),r.acte.idDossierNumerique=null);var s=(new e.comContract.DossierNumerique.DossierNumeriqueRequestFactory).putDossierNumeriqueRequest(r);return e.comContract.Loggers.info(n.CLASS_NAME,"putDossierNumerique","request %o",s),this.serviceAgentExtended.sendRequest(s).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"putDossierNumerique","response %o elapsedTime %o",t,Date.now()-o),t})["catch"](function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"putDossierNumerique","error %o",t),i.$q.reject("Problème technique se produit lors de l'appel à la méthode dossierNumeriqueService.alimenterDossierNumerique")})},n.prototype.annulerDossierNumerique=function(r,i,o,a){var s=this,c=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"annulerDossierNumerique","idDossierNumerique %o codeApplication %o referenceActe %o typeReferenceActe %o %o",r,i,o,a,t.Loggers.APP_VERSION);var u;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(e){return u=e.codeEtablissement,s.isDeployeMYSIGN(u,null,null)}).then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"annulerDossierNumerique","codeEtablissement %o isDeployeMySign %o",u,t);var l=(new e.comContract.DossierNumerique.DossierNumeriqueRequestFactory).deleteDossierNumeriqueRequest(r,i,t,o,a);return e.comContract.Loggers.info(n.CLASS_NAME,"annulerDossierNumerique","request %o",l),s.serviceAgentExtended.sendRequest(l).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"annulerDossierNumerique","response %o elapsedTime %o",t,Date.now()-c),t})}).then(function(e){return s.$q.when(e)})["catch"](function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"annulerDossierNumerique","error %o",t),s.$q.reject(t)})},n.prototype.basculerVersDossierPapier=function(r,i,o){var a=this,s=Date.now();if(e.comContract.Loggers.info(n.CLASS_NAME,"basculerVersDossierPapier","idDossierNumerique %o codeApplication %o isDeployMySign %o %o",r,i,o,t.Loggers.APP_VERSION),o){var c=(new e.comContract.DossierNumerique.DossierNumeriqueRequestFactory).basculerDossierVersPapier(r,i,o);return e.comContract.Loggers.info(n.CLASS_NAME,"basculerVersDossierPapier","isDeployMySign true request %o",c),this.serviceAgentExtended.sendRequest(c).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"basculerVersDossierPapier","isDeployMySign true response %o elapsedTime %o",t,Date.now()-s),a.$q.when(t)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"basculerVersDossierPapier","isDeployMySign true error %o",t),a.$q.when(!1)})}var u;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(e){return u=e.codeEtablissement,a.isDeployeMYSIGN(u,null,null)}).then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"basculerVersDossierPapier","codeEtablissement %o isDeployeMYSIGN %o",u,t);var o=(new e.comContract.DossierNumerique.DossierNumeriqueRequestFactory).basculerDossierVersPapier(r,i,t);return e.comContract.Loggers.info(n.CLASS_NAME,"basculerVersDossierPapier","request %o",o),a.serviceAgentExtended.sendRequest(o)}).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"basculerVersDossierPapier","response %o elapsedTime %o",t,Date.now()-s),a.$q.when(t)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"basculerVersDossierPapier","error %o",t),a.$q.when(!1)})},n.prototype.createSignature=function(r){var i=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"createSignature","initierSignatureInput %o %o",r,t.Loggers.APP_VERSION);var o=(new e.comContract.Signature.SignatureRequestFactory).postSignatureRequest(r);return e.comContract.Loggers.info(n.CLASS_NAME,"createSignature","request %o",o),this.serviceAgentExtended.sendRequest(o).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"createSignature","response %o elapsedTime %o",t,Date.now()-i),t})},n.prototype.createSessionSignatureElectronique=function(r){var i=this,o=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"createSessionSignatureElectronique","signatureElectronique %o %o",r,t.Loggers.APP_VERSION);var a=(new e.comContract.Signature.SignatureRequestFactory).postSessionSignatureRequest(r);return e.comContract.Loggers.info(n.CLASS_NAME,"createSessionSignatureElectronique","request %o",a),this.serviceAgentExtended.sendRequest(a).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"createSessionSignatureElectronique","response %o elapsedTime %o",t,Date.now()-o),t.urlSessionSignature=i.updateUrlSessionSignature(t.urlSessionSignature),t})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"createSessionSignatureElectronique","error %o",t),i.$q.reject(t)})},n.prototype.updateUrlSessionSignature=function(r){var i=window.sessionStorage.getItem(t.Signataire.Constantes.Commun.SESSION_STORAGE_MYWAY_CONTAINER_ID);return i?t.utils.UrlUtils.updateURLParameter(r,t.Signataire.Constantes.Commun.PARAM_MYWAY_CONTAINER_ID,i):(e.comContract.Loggers.warn(n.CLASS_NAME,"updateUrlSessionSignature","Pas de valeur pour "+t.Signataire.Constantes.Commun.SESSION_STORAGE_MYWAY_CONTAINER_ID),r)},n.prototype.updateSessionSignatureElectronique=function(r){var i=this,o=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"updateSessionSignatureElectronique","signatureElectronique %o %o",r,t.Loggers.APP_VERSION);var a=(new e.comContract.Signature.SignatureRequestFactory).putSessionSignatureRequest(r);return e.comContract.Loggers.info(n.CLASS_NAME,"updateSessionSignatureElectronique","request %o",a),this.serviceAgentExtended.sendRequest(a).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"updateSessionSignatureElectronique","response %o elapsedTime %o",t,Date.now()-o),t})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"updateSessionSignatureElectronique","error %o",t),i.$q.reject(t)})},n.prototype.envoyerMail=function(r){var i=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"envoyerMail","mailInput %o %o",r,t.Loggers.APP_VERSION);var o=(new e.comContract.Signature.SignatureRequestFactory).postMail(r);return e.comContract.Loggers.info(n.CLASS_NAME,"envoyerMail","request %o",o),this.serviceAgentExtended.sendRequest(o).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"envoyerMail","response %o elapsedTime %o",t,Date.now()-i),t})},n.prototype.annulerTransactionIcg=function(r,i,o,a){var s=this,c=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"annulerTransactionIcg","idTransactionIcg %o annulerDossiersConcernes %o idPersonne %o codeAction %o %o",r,i,o,a,t.Loggers.APP_VERSION);var u;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(e){return u=e.codeEtablissement,s.isDeployeMYSIGN(u,null,null)}).then(function(c){e.comContract.Loggers.info(n.CLASS_NAME,"annulerTransactionIcg","codeEtablissement %o annulerDossiersConcernes %o",u,c);var l=(new t.Signature.SignatureRequestFactory).deleteTransactionIcgRequest(c,r,i,o,a);return e.comContract.Loggers.info(n.CLASS_NAME,"annulerTransactionIcg","request %o",l),s.serviceAgentExtended.sendRequest(l)}).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"annulerTransactionIcg","response %o elapsedTime %o",u,t,Date.now()-c),s.$q.when(t)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"annulerTransactionIcg","error %o",t),s.$q.when(!1)})},n.CLASS_NAME="myway.comContract.Services.DossierNumeriqueService",n.$inject=["serviceAgentExtended","$q"],n}();n.DossierNumeriqueService=r,t.app.service("dossierNumeriqueService",r)}(n=t.Services||(t.Services={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(e,t){this.$q=e,this.serviceAgentExtended=t}return n.prototype.putDocumentsAttributaire=function(r){var i=this,o=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"putDocumentsAttributaire","documentsAttributaireInput %o %o",r,t.Loggers.APP_VERSION);var a=new t.Ressources.DocumentsAttributaire.PutDocumentsAttributaireRequestFactory(MyWay.Services.MethodEnum.PUT,r).create();return this.serviceAgentExtended.sendRequest(a).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"putDocumentsAttributaire","response %o elapsedTime %o",t,Date.now()-o),i.$q.when(t)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"putDocumentsAttributaire","error %o",t),i.$q.reject(t)})},n.CLASS_NAME="myway.comContract.Services.MajDocumentsAtrtibutaireService",n.$inject=["$q","serviceAgentExtended"],n}();n.MajDocumentsAttributaireService=r,t.app.service("majDocumentsAttributaireService",r)}(n=t.Services||(t.Services={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(e,t){this.$q=e,this.serviceAgentExtended=t}return n.prototype.getDocumentsAttributaire=function(t,r){var i=(new e.comContract.Ressources.DocumentsAttributaire.GetDocumentsAttributaireRequestFactory).create(t,r);return e.comContract.Loggers.info(n.CLASS_NAME,"getDocumentsAttributaire","request %o",i),this.serviceAgentExtended.sendRequest(i)},n.prototype.recupererDocumentsAttributaires=function(r,i){var o=this,a=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"recupererDocumentsAttributaires","idDossierNumerique %o codeApplication %o %o",r,i,t.Loggers.APP_VERSION);var s=[];return this.getDocumentsAttributaire(r,i).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"recupererDocumentsAttributaires","response %o elapsedTime %o",t,Date.now()-a),null!=t&&t.length>0&&_.forEach(t,function(e){e.idAttributaire===n.VENTE_VPC_ID_ATTRIBUTAIRE&&s.push(e)}),e.comContract.Loggers.info(n.CLASS_NAME,"recupererDocumentsAttributaires","VPC documents %o",s),o.$q.when(s)})["catch"](function(r){var i=new t.VenteVpc.Modeles.VenteVpcMessageErreur(t.VenteVpc.Modeles.VenteVpcMessageErreur.PB_RESSOURCE_REST_RECUPERER_DOCUMENTS_IDN,"recupererDocumentsIdAttributairs");return e.comContract.Loggers.error(n.CLASS_NAME,"recupererDocumentsAttributaires","venteVpcMessageErreur %o error %o",i,r),o.$q.reject(i)})},n.CLASS_NAME="myway.comContract.Services.RecupererDocumentsAttributaireService",n.$inject=["$q","serviceAgentExtended"],n.VENTE_VPC_ID_ATTRIBUTAIRE="999999999",n}();n.RecupererDocumentsAttributaireService=r,t.app.service("recupererDocumentsAttributaireService",r)}(n=t.Services||(t.Services={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){var n=function(){function e(e,t){this.$filter=e,this.$parse=t}return e.prototype.comparatorFn=function(e,t,n){var r=this.$parse(n.bind),i=r(e);if(!angular.isNumber(i))return!1;var o=this.$filter("roleSignataire")(i);return-1!==o.toLowerCase().indexOf(t)},e}();t.RoleComparator=n,e.app.service("RoleComparator",n)}(t=e.signataire||(e.signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(e,t,n){this.serviceAgentExtended=e,this.$q=t,this.deploiementSu1pService=n,this.CODE_ROLE_VISA_COLLAB="13"}return n.prototype.verifierEligibiliteSAGOPC=function(r,i,o,a,s,c,u,l,E,g){var S=this,m=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","identifiantPersonne %o codeActeGestion %o libelleActeGestion %o codeCanal %o codeModeMiseGestion %o codeTypeMarcheEntreprise %o signataires %o operationsFinancieres %o typeBordereau %o donneesBordereau %o %o",r,i,o,a,s,c,u,l,E,g,t.Loggers.APP_VERSION);var C,p=!1,d=!1,A=!1,f=!1,R=[],N=[],y=e.comContract.OPC.Enums.TypeDocument.PDF;return f=this.verifierParamsObligatoires(r,i,o,a,s,c,u,l),a!==e.comContract.OPC.Enums.CodeCanal.FF||null!=u&&1!==u.length&&!this.isVisaCollaborateur(u)||!f?(a!==e.comContract.OPC.Enums.CodeCanal.FF?e.comContract.Loggers.warn(n.CLASS_NAME,"verifierEligibiliteSAGOPC",e.comContract.SAGOPC.Modeles.MotifIneligibilite.CODE_CANAL_DIFF_FF):null==u||1===u.length||this.isVisaCollaborateur(u)||e.comContract.Loggers.warn(n.CLASS_NAME,"verifierEligibiliteSAGOPC",e.comContract.SAGOPC.Modeles.MotifIneligibilite.MULTISIGNATAIRE),
this.appelDocParametreEtCreerDonneesSagOpc(i,o,a,s,c,null,p,r,u,l,E,g,!1,!1,N).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","donneesSAGOpc %o elapsedTime %o",t,Date.now()-m),S.$q.when(t)})):this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(e){return C=e.codeEtablissement,S.deploiementSu1pService.isDeployeMYSIGN(e.codeEtablissement,i,a,null,!0)}).then(function(e){return d=e,S.deploiementSu1pService.isDeployeBulleConfiance(C,i,a,null,e)}).then(function(t){return A=t,e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","codeEtablissement %o isDeployeMYSIGN %o isDeployeBulleConfiance %o",C,d,A),S.getMateriels(A)}).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","listeMaterielsDetecte %o",t),0!==t.length||S.isVisaCollaborateur(u)?S.deploiementSu1pService.controlerTableSU1P(C).then(function(C){if(e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","retourSU1PSagOpc %o",C),S.isSAGOPC(C.isDeployeSAGOpc,C.isSensibiliteBordereauPossible)){var f=null,T=(new e.comContract.OPC.Ressources.DocumentParametre.ContractualisationParametreInputFactory).createContractualisationParametreInput(r,i,o,a,s,c,u,l,t),h=(new e.comContract.OPC.Ressources.DocumentParametre.ContractualisationParametreRequestFactory).create(T);return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","request %o",h),f=S.serviceAgentExtended.sendRequest(h),f.then(function(f){return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","response %o",f),null!=f?(_.forEach(f.listeModeContractualisation,function(e){R.push(e)}),_.forEach(f.listeMateriels,function(e){_.forEach(t,function(t){if(e.type===t.type){var n={type:e.type,codeModele:t.codeModele,modele:t.modele,typePeripherique:t.typePeripherique,identifiant:t.identifiant,rang:e.rang};N.push(n)}})}),e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","listemodeContractualisations %o listeMateriels %o",R,N),S.controleEligibiliteSuiteContractualisationParametre(f)?(y=S.setTypeDocumentAProduireSelonSU1P(f,C.isDeployeSAGOpc,C.isSensibiliteBordereauPossible),S.getDocumentParametre([i],a,s,c).then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","listeDocumentActe %o",t),t=S.setDocXmlPdf(t,y);var C=S.createActeSAGOPC(i,o,a,s,c,R,t);e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","acteSAGOPC %o",C),p=!0;var f=S.createDonneesSagOpc(p,r,u,l,E,g,C,d,A,N);return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","donneesSAGOpc %o elapsedTime %o",f,Date.now()-m),S.$q.when(f)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGOPC","error %o",t),S.$q.reject(t)})):S.appelDocParametreEtCreerDonneesSagOpc(i,o,a,s,c,f.listeModeContractualisation,p,r,u,l,E,g,d,A,N).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","donneesSAGOpc %o elapsedTime %o",t,Date.now()-m),S.$q.when(t)})):void e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGOPC","SAGOPC retour ContractualisationParametre null")})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGOPC","error %o",t),S.$q.reject(t)})}return S.appelDocParametreEtCreerDonneesSagOpc(i,o,a,s,c,null,p,r,u,l,E,g,d,A,N).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","donneesSAGOpc %o elapsedTime %o",t,Date.now()-m),S.$q.when(t)})})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGOPC","error %o",t),S.$q.reject(t)}):S.appelDocParametreEtCreerDonneesSagOpc(i,o,a,s,c,null,p,r,u,l,E,g,d,A,N).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"verifierEligibiliteSAGOPC","donneesSAGOpc %o elapsedTime %o",t,Date.now()-m),S.$q.when(t)})})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"verifierEligibiliteSAGOPC","error %o",t),S.$q.reject(t)})},n.prototype.isVisaCollaborateur=function(e){var t=this;return _.filter(e,function(e){return e.codeRoleSignataire===t.CODE_ROLE_VISA_COLLAB}).length>0},n.prototype.setDocXmlPdf=function(t,r){var i=this;return _.forEach(t,function(t){if(t&&t.codeModeContractualisation===e.comContract.Enums.ModeContractualisation.FAFG)if(null!=t&&r===e.comContract.OPC.Enums.TypeDocument.XML)t.isDocXml=!0;else{if(null==t||r!==e.comContract.OPC.Enums.TypeDocument.PDF)return e.comContract.Loggers.error(n.CLASS_NAME,"setDocXmlPdf","Document à produire ni XML ni PDF! - doc %o typeDocumentAProduire %o",t,r),i.$q.reject("SAGOPC pas de doc...Document à produire ni XML ni PDF");t.isDocXml=!1}}),e.comContract.Loggers.info(n.CLASS_NAME,"setDocXmlPdf","listeDocumentActe %o",t),t},n.prototype.setTypeDocumentAProduireSelonSU1P=function(t,r,i){var o;return r&&i&&_.some(t.listeModeContractualisation,function(t){return t.codeModeContractualisation===e.comContract.OPC.Enums.ModeContractualisation.FAFG&&t.indicateurSensibiliteMontant})?(o=e.comContract.OPC.Enums.TypeDocument.PDF,e.comContract.Loggers.info(n.CLASS_NAME,"setTypeDocumentAProduireSelonSU1P","SAGOPC, isSensibiliteBordereauPossible, ModeContractualisation.FAFG et montant sensible - typeDocumentAProduire %o",o)):r&&i&&_.some(t.listeModeContractualisation,function(t){return t.codeModeContractualisation===e.comContract.OPC.Enums.ModeContractualisation.FAFG&&!t.indicateurSensibiliteMontant})?(o=e.comContract.OPC.Enums.TypeDocument.XML,e.comContract.Loggers.info(n.CLASS_NAME,"setTypeDocumentAProduireSelonSU1P","SAGOPC, isSensibiliteBordereauPossible, ModeContractualisation.FAFG et pas de montant sensible - typeDocumentAProduire %o",o)):(o=e.comContract.OPC.Enums.TypeDocument.PDF,e.comContract.Loggers.info(n.CLASS_NAME,"setTypeDocumentAProduireSelonSU1P","!ModeContractualisation.FAFG - isDeployeSAGOpc %o isSensibiliteBordereauPossible %o typeDocumentAProduire %o",r,i,o)),o},n.prototype.appelDocParametreEtCreerDonneesSagOpc=function(t,r,i,o,a,s,c,u,l,E,g,S,m,C,p){var d=this,A=Date.now(),f=null;return this.getDocumentParametre([t],i,o,a).then(function(R){e.comContract.Loggers.info(n.CLASS_NAME,"appelDocParametreEtCreerDonneesSagOpc","listeDocumentActe %o",R);var N=d.createActeSAGOPC(t,r,i,o,a,s,R);return e.comContract.Loggers.info(n.CLASS_NAME,"appelDocParametreEtCreerDonneesSagOpc","acteSAGOPC %o",N),f=d.createDonneesSagOpc(c,u,l,E,g,S,N,m,C,p),e.comContract.Loggers.info(n.CLASS_NAME,"appelDocParametreEtCreerDonneesSagOpc","donneesSAGOpc %o elapsedTime %o",f,Date.now()-A),f})},n.prototype.createActeSAGOPC=function(e,t,n,r,i,o,a){return{codeActeGestion:e,libelleActe:t,codeCanal:n,codeModeMiseGestion:r,codeTypeMarcheEntreprise:i,listeModeContractualisation:o,listeDocumentsAProduire:a,listeOperationFinanciere:null,listeSignatairesActe:null,listeTitulairesActe:null,listeModeOperationsFinanciere:null}},n.prototype.createDonneesSagOpc=function(e,t,n,r,i,o,a,s,c,u){return{indicateurPapier:!e,identifiantPersonne:t,signataires:n,operationsFinancieres:r,typeBordereau:i,donneesBordereau:o,acte:a,identifiantAttributaire:null,intituleAttributaire:null,isDeployeMySign:s,isDeployeBulleConfiance:c,listeMateriels:u}},n.prototype.controleEligibiliteSuiteContractualisationParametre=function(t){return _.some(t.listeModeContractualisation,function(t){return t.codeModeContractualisation===e.comContract.OPC.Enums.ModeContractualisation.FAFG})?_.some(t.listeModeContractualisation,function(t){return t.codeModeContractualisation===e.comContract.OPC.Enums.ModeContractualisation.FAFG&&"K"===t.codeStatutContractualisation})?(e.comContract.Loggers.warn(n.CLASS_NAME,"controleEligibiliteSuiteContractualisationParametre",e.comContract.SAGOPC.Modeles.MotifIneligibilite.STATUT_CONTRACT_K),!1):!0:(e.comContract.Loggers.warn(n.CLASS_NAME,"controleEligibiliteSuiteContractualisationParametre",e.comContract.SAGOPC.Modeles.MotifIneligibilite.AUCUN_MODE_CONTRACT_FAFG),!1)},n.prototype.isSAGOPC=function(t,r){return t||r?!0:(e.comContract.Loggers.warn(n.CLASS_NAME,"isSAGOPC",e.comContract.SAGOPC.Modeles.MotifIneligibilite.PAS_PARAMETRE_SU1P),!1)},n.prototype.getDocumentParametre=function(r,i,o,a){var s=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"getDocumentParametre","actes %o codeCanal %o codeModeMiseGestion %o codeTypeMarcheEntreprise %o %o",r,i,o,a,t.Loggers.APP_VERSION);var c=this.$q.defer();if(null!=r&&r.length>0){var u=(new t.OPC.Ressources.DocumentParametre.DocumentParametreRequestFactory).create(r,i,o,a);e.comContract.Loggers.info(n.CLASS_NAME,"getDocumentParametre","request %o",u),this.serviceAgentExtended.sendRequest(u).then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"getDocumentParametre","response %o elapsedTime %o",t,Date.now()-s),c.resolve(t.listeDocumentActe)})["catch"](function(t){e.comContract.Loggers.error(n.CLASS_NAME,"getDocumentParametre","error %o",t),c.resolve(null)})}else e.comContract.Loggers.warn(n.CLASS_NAME,"getDocumentParametre","actes %o",r),c.resolve(null);return c.promise},n.prototype.getFluxBinaire=function(n){var r=this.$q.defer();return this.serviceAgentExtended.Impression.getJsonConverti(n).then(function(n){var i=e.comContract.sagOpc.utils.XMLBuilder.create("document",{});i.cdata(t.sagOpc.utils.BinaryUtils.toBinary(n));var o=i.end();r.resolve(t.sagOpc.utils.BinaryUtils.toBinary(o))}),r.promise},n.prototype.verifierParamsObligatoires=function(r,i,o,a,s,c,u,l){return null==r?(e.comContract.Loggers.warn(n.CLASS_NAME,"verifierParamsObligatoires","warning %o",t.ContractualisationActe.MessageErreur.ACTE_GESTION_UNDEFINED),!1):null==i?(e.comContract.Loggers.warn(n.CLASS_NAME,"verifierParamsObligatoires","warning %o",t.ContractualisationActe.MessageErreur.CODE_ACTE_GESTION_UNDEFINED),!1):null==a?(e.comContract.Loggers.warn(n.CLASS_NAME,"verifierParamsObligatoires","warning %o",t.ContractualisationActe.MessageErreur.CODE_CANAL_UNDEFINED),!1):null==c?(e.comContract.Loggers.warn(n.CLASS_NAME,"verifierParamsObligatoires","warning %o",t.ContractualisationActe.MessageErreur.CODE_MARCHE_UNDEFINED),!1):null===l?(e.comContract.Loggers.warn(n.CLASS_NAME,"verifierParamsObligatoires","warning %o",t.ContractualisationActe.MessageErreur.OPERATIONS_FINANCIERES_VIDE),!1):null==u||0===u.length?(e.comContract.Loggers.warn(n.CLASS_NAME,"verifierParamsObligatoires","warning %o",t.ContractualisationActe.MessageErreur.NOMBRE_SIGNATAIRES_ACTE_VIDE),!1):null!==u&&0!==u.length&&""===u[0].numeroPersonne?(e.comContract.Loggers.warn(n.CLASS_NAME,"verifierParamsObligatoires","warning %o",t.ContractualisationActe.MessageErreur.CONTROLE_SIGNATAIRE_AUTRE),!1):null==s?(e.comContract.Loggers.warn(n.CLASS_NAME,"verifierParamsObligatoires","warning %o",t.ContractualisationActe.MessageErreur.CODE_MODE_MISE_GESTION_UNDEFINED),!1):null==c?(e.comContract.Loggers.warn(n.CLASS_NAME,"verifierParamsObligatoires","warning %o",t.ContractualisationActe.MessageErreur.CODE_TYPE_MARCHE_ENTREPRISE_UNDEFINED),!1):!0},n.prototype.getMateriels=function(t){var r=this.$q.defer(),i=new(function(){function e(){}return e}());return t?i.methode=MyWay.Services.Mobilite.RECUP_INFO.DETECTION:i.methode=MyWay.Services.Mobilite.RECUP_INFO.FICHIER,e.comContract.Loggers.info(n.CLASS_NAME,"getMateriels","isDeployeBulleConfiance %o paramsPeripheriques %o",t,i),this.serviceAgentExtended.Mobilite.getTablettesSignature(i).then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"getMateriels","result %o",t),r.resolve(t)})["catch"](function(t){e.comContract.Loggers.error(n.CLASS_NAME,"getMateriels","error %o",t),r.resolve(new Array)}),r.promise},n.CLASS_NAME="myway.comContract.Services.SagOpcService",n.$inject=["serviceAgentExtended","$q","deploiementSu1pService"],n}();n.SagOpcService=r,t.app.service("sagOpcService",r)}(n=t.Services||(t.Services={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(e,t){this.$q=e,this.serviceAgentExtended=t}return n.prototype.isBasculeSAG=function(r){var i=this,o=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"isBasculeSAG","acteGestion %o %o",r,t.Loggers.APP_VERSION);var a=[];a.push({propriete:"CTSFBA",valeur:"PETRA",operateur:MyWay.Services.DonneesDelocalisees.CRITERES_OPERATEUR.EGAL});var s;return this.$q.all([this.serviceAgentExtended.getAuthentificationInfo(),this.serviceAgentExtended.Context.GetFromContext("ParametresServeurPoste")]).then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"isBasculeSAG","ParametresServeurPoste %o",t),s=JSON.parse(t[1]).NomServeur;var r=t[0].codeEtablissement;return i.serviceAgentExtended.DonneesDelocalisees.getDonneesParCriteres(r,"SU1P",a)}).then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"isBasculeSAG","caisses %o",t),t=i.filtreSU1PParDates(t);var a=r.substring(2),c=i.caissesBasculeesSAG001(t,a),u=c.length>0;if(u){var l=c.filter(function(e){return e.WLNLU===s}).length>0;return e.comContract.Loggers.info(n.CLASS_NAME,"isBasculeSAG","isRattacheServeurAgence %o caissesBasculeesSAG001 %o elapsedTime %o",t,c,Date.now()-o),l}var E=t.filter(function(e){return"FAFE"===e.COEIO1&&(!e.WLNLU||e.WLNLU===s)});return e.comContract.Loggers.info(n.CLASS_NAME,"isBasculeFAFE","datasFAFE %o elapsedTime %o",E,Date.now()-o),E.length>0})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"isBasculeSAG","error %o",t),i.$q.when(!1)})},n.prototype.filtreSU1PParDates=function(e){var t=new Date;return e.filter(function(e){var n=MyWay.Services.DateUtils.fromJJMMAAAA(e.DDEJDA),r=MyWay.Services.DateUtils.fromJJMMAAAA(e.DFEJDA);return t>=n&&r>t})},n.prototype.caissesBasculeesSAG001=function(e,t){var n=e.filter(function(e){return"SAG001"===e.COSXAP&&e.COEIO1===t});return n},n.CLASS_NAME="myway.comContract.Services.SignatureElectroniqueService",n.$inject=["$q","serviceAgentExtended"],n}();n.SignatureElectroniqueService=r,t.app.service("signatureElectroniqueService",r)}(n=t.Services||(t.Services={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(e,t,n,r,i,o){this.serviceAgentExtended=e,this.$q=t,this.recupererDocumentsAttributaireService=n,this.majDocumentsAttributaireService=r,this.dossierContratService=i,this.dossierCanalNumeriqueService=o}return n.prototype.finaliserVenteVpc=function(r){var i=this,o=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"finaliserVenteVpc","finaliserVenteVpcInput %o %o",r,t.Loggers.APP_VERSION);var a={codeRetour:0,listeLibelleRetour:[],isDossierIDNMisAJour:!1,isClasseurClientCreer:!1},s=this.controlerDonneesEnEntree(r);if(null===s){var c=[];return c.push(this.serviceAgentExtended.Context.GetAuthentificationInfo()),c.push(this.serviceAgentExtended.Context.GetParametresComptables()),this.$q.all(c).then(function(o){return i.venteVpcContexteModele=new t.VenteVpc.Modeles.VenteVpcContexteModele(o[0],o[1]),e.comContract.Loggers.info(n.CLASS_NAME,"finaliserVenteVpc","venteVpcContexteModele %o",i.venteVpcContexteModele),i.recupererDocumentsAttributaireService.recupererDocumentsAttributaires(r.identifiantActeIDN,n.CODE_APPLICATION_CONTELEC)}).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"finaliserVenteVpc","documentsAttributaires %o",t),null!=t?i.mettreAJourDossier(r,t):void 0}).then(function(t){return null!=t?a.listeLibelleRetour.push(t):a.isDossierIDNMisAJour=!0,e.comContract.Loggers.info(n.CLASS_NAME,"finaliserVenteVpc","finaliserVenteVpcOutput %o",a),i.createClasseurClient(r)}).then(function(t){return null!=t?a.listeLibelleRetour.push(t):a.isClasseurClientCreer=!0,e.comContract.Loggers.info(n.CLASS_NAME,"finaliserVenteVpc","finaliserVenteVpcOutput %o elapsedTime %o",a,Date.now()-o),i.$q.when(a)})["catch"](function(t){return a.listeLibelleRetour.push(t.messageErreur),e.comContract.Loggers.error(n.CLASS_NAME,"finaliserVenteVpc","venteVpcMessageErreur %o finaliserVenteVpcOutput %o",t,a),i.$q.when(a)})}return a.listeLibelleRetour.push(s),e.comContract.Loggers.error(n.CLASS_NAME,"finaliserVenteVpc","pbDonneesEnEntree %o finaliserVenteVpcOutput %o",s,a),this.$q.when(a)},n.prototype.controlerDonneesEnEntree=function(e){return null==e?t.VenteVpc.Modeles.VenteVpcMessageErreur.FINALISER_VENTE_VPC_INPUT_UNDEFINED:null==e.referenceContrat?t.VenteVpc.Modeles.VenteVpcMessageErreur.REFERENCE_CONTRAT_UNDEFINED:null==e.identifiantActeIDN?t.VenteVpc.Modeles.VenteVpcMessageErreur.ID_IDN_UNDEFINED:null==e.identifiantActeExterne?t.VenteVpc.Modeles.VenteVpcMessageErreur.ID_ACTE_EXTERNE_UNDEFINED:null==e.codeActeGestion?t.VenteVpc.Modeles.VenteVpcMessageErreur.CODE_ACTE_GESTION_UNDEFINED:null==e.modeSignature?t.VenteVpc.Modeles.VenteVpcMessageErreur.MODE_SIGNATURE_UNDEFINED:null==e.codeEtablissement?t.VenteVpc.Modeles.VenteVpcMessageErreur.CODE_ETABLISSEMENT_FINANACIER_UNDEFINED:null==e.numeroEntiteTitulaire?t.VenteVpc.Modeles.VenteVpcMessageErreur.NUMERO_ENTITE_TITULAIRES_UNDEFINED:null==e.listeTitulairesActe||0===e.listeTitulairesActe.length?t.VenteVpc.Modeles.VenteVpcMessageErreur.NOMBRE_TITULAIRES_ACTE_VIDE:null},n.prototype.mettreAJourDossier=function(r,i){var o=this;return e.comContract.Loggers.info(n.CLASS_NAME,"mettreAJourDossier","finaliserVenteVpcInput %o listeDocumentsAttributaire %o",r,i),this.majDocumentsAttributaireService.putDocumentsAttributaire(this.createDocumentsAttributaireInput(r.identifiantActeIDN,n.CODE_APPLICATION_CONTELEC,r.referenceContrat,i,r.codeActionDossierVente)).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"mettreAJourDossier","documentAttributaireResponse %o",t),o.$q.when(t)})["catch"](function(r){return e.comContract.Loggers.error(n.CLASS_NAME,"mettreAJourDossier","error %o",r),o.$q.when(t.VenteVpc.Modeles.VenteVpcMessageErreur.PB_RESSOURCE_REST_TERMINER_ACTE_VAD)})},n.prototype.createClasseurClient=function(r){var i=this;e.comContract.Loggers.info(n.CLASS_NAME,"createClasseurClient","finaliserVenteVpcInput %o",r);var o=Date.now();return r.modeSignature===t.VenteVpc.ModeSignature.PAPIER?this.createClasseurClientPapier(r,this.venteVpcContexteModele.authenficationInfo.agentConnecte.numeroEdsSuperieur,this.venteVpcContexteModele.authenficationInfo.agentConnecte.referenceExterneEdsRattachemen).then(function(r){return r?(e.comContract.Loggers.info(n.CLASS_NAME,"createClasseurClient","createClasseurClientPapier SUCCESS! elapsedTime %o",Date.now()-o),i.serviceAgentExtended.Context.AddToMainProcessContext(n.INDICATEUR_CLASSEUR_CLIENT,"1").then(function(){e.comContract.Loggers.info(n.CLASS_NAME,"createClasseurClient","l'ajout de l'indicateur APPEL_IHM_ACQ_CLACLI est bien effectué!")},function(){e.comContract.Loggers.error(n.CLASS_NAME,"createClasseurClient","problème lors de l'ajout de l'indicateur APPEL_IHM_ACQ_CLACLI!")}),i.$q.when(null)):i.$q.when(t.VenteVpc.Modeles.VenteVpcMessageErreur.PB_RESSOURCE_REST_DOSSIER_CONTRAT)})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"createClasseurClient","createClasseurClientPapier error %o",t),i.$q.when(t.messageErreur)}):r.modeSignature===t.VenteVpc.ModeSignature.ELECTRONIQUE||r.modeSignature===t.VenteVpc.ModeSignature.INTERNET?this.createClasseurClientNumerique(r,this.venteVpcContexteModele.authenficationInfo.agentConnecte.numeroEdsSuperieur,this.venteVpcContexteModele.authenficationInfo.agentConnecte.referenceExterneEdsRattachemen,r.modeSignature).then(function(r){return r?(e.comContract.Loggers.info(n.CLASS_NAME,"createClasseurClient","createClasseurClientNumerique SUCCESS! elapsedTime %o",Date.now()-o),i.$q.when(null)):(e.comContract.Loggers.error(n.CLASS_NAME,"createClasseurClient",t.VenteVpc.Modeles.VenteVpcMessageErreur.PB_RESSOURCE_REST_DOSSIER_CANAL_NUMERIQUE),i.$q.when(t.VenteVpc.Modeles.VenteVpcMessageErreur.PB_RESSOURCE_REST_DOSSIER_CANAL_NUMERIQUE))})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"createClasseurClient","createClasseurClientNumerique error %o",t),i.$q.when(t.messageErreur)}):(e.comContract.Loggers.error(n.CLASS_NAME,"createClasseurClient","mode signature inconnu - finaliserVenteVpcInput %o",r),this.$q.when(t.VenteVpc.Modeles.VenteVpcMessageErreur.MODE_SIGNATURE_UNDEFINED))},n.prototype.createDocumentsAttributaireInput=function(t,r,i,o,a){var s=null;if(null!=t&&null!=r&&null!=o){var c=[];_.forEach(o,function(e){var t={identifiantDocument:e.identifiantDocument,idAttributaire:i,intituleAttributaire:e.intituleAttributaire,codeTypeAttributaire:e.codeTypeAttributaire,codeTypeDoc:e.codeTypeDoc};c.push(t)}),null!=t&&null!=r&&null!=o&&(s={codeApplication:r,idDossierNumerique:t,documents:c,codeActionDossierVente:a})}return e.comContract.Loggers.info(n.CLASS_NAME,"createDocumentsAttributaireInput","documentsAttributaireInput %o",s),s},n.prototype.createClasseurClientPapier=function(e,t,n){return this.dossierContratService.putDossierContrat(e.codeEtablissement,this.getCodeModeContractualisation(e.codeCanal),e.codeActeGestion,this.venteVpcContexteModele.parametresComptables.codeGuichetInterbancaire,e.numeroEntiteTitulaire,e.referenceContrat.slice(10,21),t,n,e.listeActeSecondaires,1,e.identifiantActeExterne)},n.prototype.createClasseurClientNumerique=function(t,r,i,o){var a=this,s=this.isMySign(t.identifiantActeIDN);return e.comContract.Loggers.info(n.CLASS_NAME,"createClasseurClientNumerique","isMySign %o finaliserVenteVpcInput %o referenceEDSInterneClient %o referenceEDSExterneClient %o modeSignature %o",s,t,r,i,o),s?this.consulterDossierNumerique(t.identifiantActeIDN,n.CODE_APPLICATION_CONTELEC,!0,!1,!1,!1,!1,!1).then(function(e){return a.postDossierContratService(t.codeActeGestion,t.listeTitulairesActe,t.listeActeSecondaires,t.identifiantActeIDN,t.codeCanal,parseInt(t.referenceOffre,10),t.codeTypeProduit,parseInt(t.numeroEntiteTitulaire),parseInt(a.venteVpcContexteModele.authenficationInfo.agentConnecte.referenceExterneAgent,10),parseInt(r),parseInt(i),a.venteVpcContexteModele.parametresComptables.codeGuichetInterbancaire,"0000",a.getNodapeTitulaire(t.listeTitulairesActe),t.acteGestionCompteSupport,t.referenceContrat,t.identifiantActeExterne,o,e)}):this.dossierCanalNumeriqueService.postCreationDossierCanalNum(t.codeActeGestion,t.listeActeSecondaires,t.identifiantActeIDN,t.codeCanal,parseInt(t.referenceOffre),t.codeTypeProduit,parseInt(t.numeroEntiteTitulaire),parseInt(this.venteVpcContexteModele.authenficationInfo.agentConnecte.referenceExterneAgent),parseInt(r),parseInt(i),this.venteVpcContexteModele.parametresComptables.codeGuichetInterbancaire,"0000",this.getNodapeTitulaire(t.listeTitulairesActe),t.acteGestionCompteSupport,t.referenceContrat,t.identifiantActeExterne)},n.prototype.mapListeDocuments=function(t,r,i){var o=this,a=[];return _.forEach(r,function(e){var n;n=null!=e.donneesContenuDocument&&null!=e.donneesContenuDocument.fluxFilenet&&null!=e.donneesContenuDocument.fluxFilenet.identifiantGEDDocument?e.donneesContenuDocument.fluxFilenet.identifiantGEDDocument:null!=e.donneesContenuDocument&&null!=e.donneesContenuDocument.fluxGedTemporaire&&null!=e.donneesContenuDocument.fluxGedTemporaire.identifiantDocumentTemporaire?e.donneesContenuDocument.fluxGedTemporaire.identifiantDocumentTemporaire:"9999";var r={codeActe:t,idDocument:n,typeDocument:e.donneesComportementSignatureDocument.descriptionDocument.codeTypeDocument,typeAttributaire:o.mapTypeAttributaireToCodeTypeAttributaire(e.donneesStockageDocument.codeTypeAttributaire),natureDocument:e.donneesStockageDocument.identifiantNaturePieceJointe,attributairePrincipal:e.donneesStockageDocument.identifiantAttributaire,attributaireSecondaire:e.donneesStockageDocument.intituleAttributaire};a.push(r)}),e.comContract.Loggers.info(n.CLASS_NAME,"mapListeDocuments","documents %o",a),a},n.prototype.mapTypeAttributaireToCodeTypeAttributaire=function(e){return"Contrat"===e?"1":"Personne"===e?"2":"Entité Titulaire"===e?"7":void 0},n.prototype.postDossierContratService=function(r,i,o,a,s,c,u,l,E,g,S,m,C,p,d,A,f,R,N){var y=this,T=Date.now();return e.comContract.Loggers.info(n.CLASS_NAME,"postDossierContratService","codeActeGestion %o listeTitulairesActe %o listeActeSecondaires %o identifiantDossierNumerique %o codeCanal %o referenceOffre %o codeTypeProduit %o numeroEntiteTitulaire %o identifiantAgent %o referenceEDSInterneClient %o referenceEDSExterneClient %o codeGuichet %o acteGestionArcade %o nodapeTitulaire %o acteGestionCompteSupport %o referenceContrat %o identifiantActeExterne %o modeSignature %o dossierWithDocuments %o %o",r,i,o,a,s,c,u,l,E,g,S,m,C,p,d,A,f,R,N,t.Loggers.APP_VERSION),this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(t){var u=(new e.comContract.Ressources.DossierContratServi.DossierContratServiceInputFactory).createDossierContratServiceInputFromDossierNumerique(r,i,l,o,d,E,S,a,f,A,c,t.codeEtablissement,y.getCodeModeContract(s),m,null,s,y.mapListeDocuments(r,N.listeDocument,N)),g=new e.comContract.Ressources.DossierContratServi.DossierContratServiRequestFactory(MyWay.Services.MethodEnum.POST,u).create();return e.comContract.Loggers.info(n.CLASS_NAME,"postDossierContratService","request %o",g),y.serviceAgentExtended.sendRequest(g)}).then(function(r){if(null!=r&&(9===r.coderetour||r.listeDossierClasseurClient&&r.listeDossierClasseurClient.length))return e.comContract.Loggers.info(n.CLASS_NAME,"postDossierContratService","SUCCES! dossierContratServiceOutput %o elapsedTime %o",r,Date.now()-T),y.$q.when(!0);var i=new t.VenteVpc.Modeles.VenteVpcMessageErreur(t.VenteVpc.Modeles.VenteVpcMessageErreur.PB_RESSOURCE_REST_DOSSIER_CONTRAT_SERVI,"postDossierContratService");return e.comContract.Loggers.error(n.CLASS_NAME,"postDossierContratService","error %o dossierContratServiceOutput %o",i,r),y.$q.reject(i)})},n.prototype.getCodeModeContract=function(e){return e===t.Enums.CodeCanalVente.FACE_A_FACE?t.Enums.ModeContractualisation.FAFE:e===t.Enums.CodeCanalVente.MOBILITE?t.Enums.ModeContractualisation.FFPE:e===t.Enums.CodeCanalVente.INTERNET?t.Enums.ModeContractualisation.VELD:t.Enums.ModeContractualisation.VADE},n.prototype.consulterDossierNumerique=function(r,i,o,a,s,c,u,l){var E=this,g=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"consulterDossierNumerique","idDossierNumerique %o codeApplication %o avecDocuments %o avecReferences %o avecEmplacementsSignatures %o avecBinaires %o avecSignataires %o avecTitulaires %o %o",r,i,o,a,s,c,u,l,t.Loggers.APP_VERSION);var S=(new e.comContract.DossierNumerique.DossierNumeriqueRequestFactory).getDossierNumeriqueRequest(r,i,o,a,s,c,u,l);return e.comContract.Loggers.info(n.CLASS_NAME,"consulterDossierNumerique","request %o",S),this.serviceAgentExtended.sendRequest(S).then(function(t){return e.comContract.Loggers.info(n.CLASS_NAME,"consulterDossierNumerique","response %o elapsedTime %o",t,Date.now()-g),t})["catch"](function(t){return e.comContract.Loggers.error(n.CLASS_NAME,"consulterDossierNumerique","error %o",t),E.$q.reject(t)})},n.prototype.isMySign=function(e){return e&&-1!==e.indexOf("MS")?!0:!1},n.prototype.getCodeModeContractualisation=function(e){return e===t.Enums.CodeCanalVente.FACE_A_FACE?t.Enums.ModeContractualisation.FAFP:t.Enums.ModeContractualisation.VADP},n.prototype.getNodapeTitulaire=function(e){return null!=e&&e.length>0?parseInt(e[0].numeroPersonne):null},n.CLASS_NAME="myway.comContract.Services.VenteVpcService",n.$inject=["serviceAgentExtended","$q","recupererDocumentsAttributaireService","majDocumentsAttributaireService","dossierContratService","dossierCanalNumeriqueService"],n.CODE_APPLICATION_CONTELEC="CONTELEC",n.INDICATEUR_CLASSEUR_CLIENT="APPEL_IHM_ACQ_CLACLI",n}();n.VenteVpcService=r,t.app.service("venteVpcService",r)}(n=t.Services||(t.Services={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){"use strict";function n(){return{restrict:"E",templateUrl:"typescript/directives/recap-signataires/vues/recap-signataires-vue.html",controller:"RecapSignatairesControleur",controllerAs:"rsCtrl",scope:{recapSignatairesInput:"=recapsignatairesinput"},bindToController:!0,link:function(e,t,n){var r=["signataires","dateSignature"];for(var i in r)if(!n.recapsignatairesinput.hasOwnProperty(i))throw new Error("MyWay.UI.mwInputFile : "+i+" est un paramètre obligatoire.")}}}t.mwsfRecapSignataires=n,e.app.directive("mwsfRecapSignataires",n)}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){function n(){return{restrict:"E",templateUrl:"typescript/directives/signataires-document/vues/liste-signataires-view.html",scope:{donneesEntree:"=donnees",open:"=?ouvert",ngModel:"=",messageErreur:"="},controller:"ListeDesignatairesController",controllerAs:"signatairesCtrl",bindToController:!0,link:function(e,t,n){var r=["identifiantEntiteTitulaire","dateSignature","codeActeGestion"];for(var i in r)if(!n.donnees.hasOwnProperty(i))throw new Error("MyWay.UI.mwInputFile : "+i+" est un paramètre obligatoire.")}}}e.app.directive("mwsfListeSignataires",n)}(t=e.signataire||(e.signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.CONTROLE_MATERIELS="20",e.CONTROLE_NOMBRE_SIGNATAIRES="31",e.CONTROLE_SIGNATAIRE_MANDATAIRE="33",e.CONTROLE_SIGNATAIRE_AUTRE="34",e.CONTROLE_SIGNATAIRE_VISA_COLLABORATEUR="35",e}();e.CodeNonELigibilite=t}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.CODE_CANAL_FACE_A_FACE="FF",e.MODE_VERSEMENT_OPERATION_FINANCIERE="01",e.TYPE_ACTE_GESTION_OUVERTURE="OU",e.TYPE_ACTE_GESTION_CLOTURE="CL",e}();e.Constants=t;var n=function(){function e(){}return e.TITULAIRE="T",e.REPRESENTANT_LEGAL="R",e.MANDATAIRE="M",e.AUTRE="Z",e.VISA_COLLABORATEUR="VC",e.GESTIONNAIRE_MESURE_PROTECTION="G",e.REPRESENTANT_LEGAL_PRO="RP",e}();e.CodeRoleSignataire=n}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Modeles||(e.Modeles={}))}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.CONTROLE_MATERIELS="La signature électronique est indisponible pour la raison suivante : aucune tablette n’est configurée sur ce poste.",e.CONTROLE_SIGNATAIRE_AUTRE="La signature électronique est indisponible pour la raison suivante : Un signataire de type 'autre' présent parmi les signataires.",e.CONTROLE_SIGNATAIRE_VISA_COLLABORATEUR="La signature électronique est indisponible pour la raison suivante : Un signataire de type 'Visa Conseiller' présent parmi les signataires.",e.CONTROLE_SIGNATAIRE_MANDATAIRE="La signature électronique est indisponible pour la raison suivante : mandataire présent parmi les signataires.",e.CONTROLE_NOMBRE_SIGNATAIRES="La signature électronique est indisponible pour la raison suivante : nombre de signataires supérieur à 2.",e}();e.LibelleNonELigibilite=t}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n,r){this.messageErreur=e,this.action=t,this.erreurMyWay=n,this.messageComplementaire=r}return e.prototype.toString=function(){var e="";return this.messageErreur&&(e+=this.messageErreur+".\n"),this.erreurMyWay&&(e+="Code HTTP : "+this.erreurMyWay.codeHttp+". Libellé : "+this.erreurMyWay.codeLibelle+", "+this.erreurMyWay.libelle+"\n"),this.messageComplementaire&&(e+=this.messageComplementaire),e},e.CODE_ACTE_GESTION_UNDEFINED="Le code de l'acte de gestion principal non renseigné dans l'objet ActeGestion",
e.ERREUR_TECHNIQUE="Une erreur technique est survenue, la vérification de l'égibilité SAG/SED ne peut pas être réalisée",e.PB_GET_PERIPHERIQUES="Une erreur est survenue lors de récupération des péripheriques, vérifier le démarrage du service local",e.PB_IS_DEPLOYEE_SEMD_MYSIGN="Une erreur est survenue lors de vérification du déploiement SEMD ou MYSIGN",e.CODE_CANAL_UNDEFINED="Code canal dossier vente non renseigné dans l'objet ActeGestion",e.CODE_MARCHE_UNDEFINED="Le Code marché est non renseigné dans l'objet ActeGestion",e.CODE_ETABLISSEMENT_FINANACIER_UNDEFINED="Code établissement non renseigné dans l'objet ActeGestion",e.CODE_NATURE_APPEL_QR_UNDEFINED="Code nature appel QR non renseigné dans l'objet ActeGestion",e.NOMBRE_SIGNATAIRES_ACTE="la taille de la liste de signataires doit être inférieure ou égale à 5",e.NOMBRE_SIGNATAIRES_ACTE_VIDE="la liste de signataires ne doit pas être vide",e.ACTE_GESTION_UNDEFINED="Acte de gestion non renseigné. Acte de gestion est obligatoire dans l'objet ContractualisationActeInput",e.CONTRACTUALISATION_ACTE_INPUT_UNDEFINED="ContractualisationActeInput est null ",e.CODE_TYPE_MARCHE_ENTREPRISE_UNDEFINED="CodeTypeMarcheEntreprise  non renseigné dans l'objet ActeGestion ",e.CODE_MODE_MISE_GESTION_UNDEFINED="CodeModeMiseGestion non renseigné dans l'objet ActeGestion ",e.CONTROLE_MATERIELS="La signature électronique est indisponible pour la raison suivante : aucune tablette n’est configurée sur ce poste.",e.CONTROLE_SIGNATAIRE_AUTRE="La signature électronique est indisponible pour la raison suivante : Un signataire de type 'autre' présent parmi les signataires.",e.CONTROLE_SIGNATAIRE_VISA_COLLABORATEUR="La signature électronique est indisponible pour la raison suivante : Un signataire de type 'VISA_COLLABORATEUR' présent parmi les signataires.",e.CONTROLE_SIGNATAIRE_MANDATAIRE="La signature électronique est indisponible pour la raison suivante : mandataire présent parmi les signataires.",e.CONTROLE_TROP_SIGNATAIRES="La signature électronique est indisponible pour la raison suivante : nombre de signataires supérieur à 2.",e.OPERATIONS_FINANCIERES_VIDE="la liste des opérations financieres ne doit pas être vide",e.RETOUR_CONTRACTUALISATION_VIDE="Aucun code acte correspondant dans le paramétrage CONTELEC",e}();e.MessageErreur=t}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.MYSIGN="MYSIGN",e.SEMD="SEMD",e.SEMD_BDR="SEMDBDR",e.BULLECONFIANCE="BULLCONF",e}();e.CodeApplication=t}(t=e.Enums||(e.Enums={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.FACE_A_FACE="FF",e.TELEPHONIQUE="TL",e.MOBILITE="MO",e.INTERNET="IN",e}();e.CodeCanalVente=t}(t=e.Enums||(e.Enums={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";!function(e){e[e.Operant=0]="Operant",e[e.ChargeAffaire=1]="ChargeAffaire",e[e.OperantPourChargeAffaire=2]="OperantPourChargeAffaire",e[e.Aucun=3]="Aucun"}(e.DestinataireEmailConseillerEnum||(e.DestinataireEmailConseillerEnum={}));e.DestinataireEmailConseillerEnum}(t=e.Enums||(e.Enums={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.UNE_PERSONNE="1 personne à sélectionner",e.AUCUN="Aucun signataire possible",e.CAS_PARTICULIER="Cas particulier",e}();e.MessageInfo=t}(t=e.Enums||(e.Enums={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.FAFE="FAFE",e.FAFG="FAFG",e.FFPE="FFPE",e.FAFP="FAFP",e.VADE="VADE",e.VADP="VADP",e.VELD="VELD",e.VELE="VELE",e.AUCUN="AUCUN",e}();e.ModeContractualisation=t}(t=e.Enums||(e.Enums={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";!function(e){e[e.Operant=0]="Operant",e[e.ChargeAffaire=1]="ChargeAffaire",e[e.OperantPourChargeAffaire=2]="OperantPourChargeAffaire"}(e.SignatureAgentEmailEnum||(e.SignatureAgentEmailEnum={}));e.SignatureAgentEmailEnum}(t=e.Enums||(e.Enums={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.ENTREPRENEUR_INDIVIDUEL_PHYSIQUE="EI",e.PERSONNE_MORALE="PM",e}();e.TypeProfessionnel=t}(t=e.Enums||(e.Enums={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){!function(e){e[e.MADAME=1]="MADAME",e[e.MADEMOISELLE=2]="MADEMOISELLE",e[e.MONSIEUR=3]="MONSIEUR"}(e.Civilite||(e.Civilite={}));e.Civilite}(t=e.modeles||(e.modeles={}))}(t=e.signataire||(e.signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Modeles||(e.Modeles={}))}(t=e.SAGOPC||(e.SAGOPC={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.OPERATION_FINANCIERE="OPERATION_FINANCIERE",e.REMISE_CARTE_TEMPO="REMISE_CARTE_TEMPO",e.REMISE_CARTE_BANCAIRE="REMISE_CARTE_BANCAIRE",e.VISITE_COFFRE="VISITE_COFFRE",e.OPPOSITION_CARTE_BANCAIRE="OPPOSITION_CARTE_BANCAIRE",e.VIREMENT_IMMEDIAT="VIREMENT_IMMEDIAT",e.VIREMENT_INTERNE="VIREMENT_INTERNE",e.VIREMENT_INTERNATIONAL="VIREMENT_INTERNATIONAL",e.ECHEANCIER_VIREMENT_SEPA="ECHEANCIER_VIREMENT_SEPA",e.ECHEANCIER_VIREMENT_INTERNATIONAL="ECHEANCIER_VIREMENT_INTERNATIONAL",e.AVENANT_ECHEANCIER_VIREMENT_SEPA="AVENANT_ECHEANCIER_VIREMENT_SEPA",e.AVENANT_ECHEANCIER_VIREMENT_INTERNATIONAL="AVENANT_ECHEANCIER_VIREMENT_INTERNATIONAL",e.CLOTURE_ECHEANCIER_VIREMENT_SEPA="CLOTURE_ECHEANCIER_VIREMENT_SEPA",e.CLOTURE_ECHEANCIER_VIREMENT_INTERNATIONAL="CLOTURE_ECHEANCIER_VIREMENT_INTERNATIONAL",e.SUSPENSION_ECHEANCIER_VIREMENT_SEPA="SUSPENSION_ECHEANCIER_VIREMENT_SEPA",e.REACTIVATION_ECHEANCIER_VIREMENT_SEPA="REACTIVATION_ECHEANCIER_VIREMENT_SEPA",e}();e.TypeBordereau=t}(t=e.Modeles||(e.Modeles={}))}(t=e.SAGOPC||(e.SAGOPC={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.CODE_CANAL_DIFF_FF="SAGOPC inéligible car le code canal est différent de FF",e.MULTISIGNATAIRE="SAGOPC inéligible car plus d'un signataire",e.AUCUNE_TABLETTE="SAGOPC inéligible car pas de tablette détectée",e.PAS_PARAMETRE_SU1P="SAGOPC inéligible car aucun paramétrage SU1P configuré",e.AUCUN_MODE_CONTRACT_FAFG="SAGOPC inéligible car pas de mode de contractualisation FAFG",e.STATUT_CONTRACT_K="SAGOPC inéligible car le codeStatutContractualisation est à K pour le mode FAFG",e}();e.MotifIneligibilite=t}(t=e.Modeles||(e.Modeles={}))}(t=e.SAGOPC||(e.SAGOPC={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t){this.authenficationInfo=e,this.parametresComptables=t}return e}();e.VenteVpcContexteModele=t}(t=e.Modeles||(e.Modeles={}))}(t=e.VenteVpc||(e.VenteVpc={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n,r,i){this.messageErreur=e,this.action=t,this.erreurMyWay=r,this.messageComplementaire=i,this.classeTypeScript=n}return e.FINALISER_VENTE_VPC_INPUT_UNDEFINED="Une erreur technique est survenue. L'objet FinaliserVenteVpcInput n'est pas défini",e.CODE_ETABLISSEMENT_FINANACIER_UNDEFINED="Le code établissement n'est pas renseigné dans l'objet FinaliserVenteVpcInput",e.CODE_ACTE_GESTION_UNDEFINED="Le code acte de gestion n'est pas renseigné dans l'objet FinaliserVenteVpcInput.",e.ID_IDN_UNDEFINED="L'identifiant IDN n'est pas renseigné dans l'objet FinaliserVenteVpcInput.",e.ID_ACTE_EXTERNE_UNDEFINED="L'identifiant acte externe n'est pas renseigné dans l'objet FinaliserVenteVpcInput.",e.CODE_CANAL_UNDEFINED="Le code canal dossier vente n'est pas renseigné dans l'objet FinaliserVenteVpcInput.",e.MODE_SIGNATURE_UNDEFINED="Le mode signature n'est pas renseigné dans l'objet FinaliserVenteVpcInput.",e.REFERENCE_CONTRAT_UNDEFINED="Le réference contrat n'est pas renseigné dans l'objet FinaliserVenteVpcInput.",e.NUMERO_ENTITE_TITULAIRES_UNDEFINED="Le numéro entité titulaire n'est pas renseigné dans l'objet FinaliserVenteVpcInput.",e.NOMBRE_TITULAIRES_ACTE_VIDE="La liste de titulaires ne doit pas être vide",e.PB_RESSOURCE_REST_DOSSIER_CONTRAT="Une erreur technique est survenue lors de l'appel à la ressource dossierContrat pour créer le classeur client papier",e.PB_RESSOURCE_REST_DOSSIER_CANAL_NUMERIQUE="Une erreur technique est survenue lors de l'appel à la ressource dossierCanalNumerique pour créer le classeur client Numérique",e.PB_RESSOURCE_REST_DOSSIER_CONTRAT_SERVI="Une erreur technique est survenue lors de l'appel à la ressource dossierContratServi pour créer le classeur client Numérique",e.PB_RESSOURCE_REST_RECUPERER_DOCUMENTS_IDN="Une erreur technique est survenue lors de l'appel à la ressource recupererDocumentsIdntAttributaire ",e.PB_RESSOURCE_REST_TERMINER_ACTE_VAD="Une erreur technique est survenue lors de l'appel à la ressource terminerActeVad ",e}();e.VenteVpcMessageErreur=t}(t=e.Modeles||(e.Modeles={}))}(t=e.VenteVpc||(e.VenteVpc={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.Modeles||(e.Modeles={}))}(t=e.VenteVpc||(e.VenteVpc={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function n(r,i){var o=this;this.$scope=r,this.recapSignatairesService=i,this.PB_RECAP_SIGNATAIRES="Récapitulatif des signataires indisponible",this.tableauColonneOptionsNom={title:"Nom",bind:"nomSignataire",cssClass:"col-md-2 col-lg-3"},this.tableauColonneOptionsPrecisionSIgnataires={title:"Précision signataire",bind:"precisionSignataire",cssClass:"col-md-2 col-lg-2"},this.tableauColonneOptionsRole={title:"Rôle",bind:"roleSignataire",cssClass:"col-md-2 col-lg-2"},this.tableauColonneOptionsMail={title:"Dernier e-mail utilisé",bind:"dernierMailUtilise",cssClass:"col-md-2 col-lg-2"},this.tableauColonneOptionsEtatSignature={title:"Etat de la signature",bind:"etatSignature",cssClass:"col-md-2 col-lg-2"};var a=Date.now();e.comContract.Loggers.info(n.CLASS_NAME,"/directives/recapSignataires","recapSignatairesInput %o %o",this.recapSignatairesInput,t.Loggers.APP_VERSION),this.chargementCourtShow=!0,this.afficherMessageErreur=!1,this.signatairesTableShow=!1,this.recapSignatairesService.init(this.recapSignatairesInput).then(function(t){e.comContract.Loggers.info(n.CLASS_NAME,"/directives/recapSignataires","listSignataires %o",t),o.chargementCourtShow=!1,o.signatairesTableShow=!0,o.signatairesTableau=o.getSignatairesTableau(o.simplifyTableauSignataire(t)),e.comContract.Loggers.info(n.CLASS_NAME,"/directives/recapSignataires","elapsedTime %o",Date.now()-a),o.$scope.$apply()})["catch"](function(t){o.afficherMessageErreur=!0,o.chargementCourtShow=!1,e.comContract.Loggers.error(n.CLASS_NAME,"/recapSignatairesDirective","Une erreur technique est survenue : %o",t)})}return n.prototype.simplifyTableauSignataire=function(e){var t=[];return _.forEach(e,function(e){t.push({nomSignataire:e.getNomSignataire(),precisionSignataire:e.precisionSignataire,roleSignataire:e.libelleRoleSignataire,dernierMailUtilise:e.adresseMailSignataire,etatSignature:e.getEtatSignature()})}),t},n.prototype.getSignatairesTableau=function(e){return{width:"col-md-12 ",orderBy:"prenom",reserve:!1,perPage:5,multiSelect:!1,filterEnable:!1,sortEnable:!1,moreEnable:!1,columns:[this.tableauColonneOptionsNom,this.tableauColonneOptionsPrecisionSIgnataires,this.tableauColonneOptionsRole,this.tableauColonneOptionsMail,this.tableauColonneOptionsEtatSignature],data:e,selectedItems:[],disabledItems:[],templateUrl:"",selectionChangeHandler:void 0}},n.CLASS_NAME="myway.comContract.RecapSignataires.RecapSignatairesControleur",n.$inject=["$scope","recapSignatairesService"],n}();n.RecapSignatairesControleur=r,t.app.controller("RecapSignatairesControleur",r)}(n=t.RecapSignataires||(t.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var __extends=this&&this.__extends||function(e,t){function n(){this.constructor=e}for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r]);e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)},myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.MME=new t("MME","MME"),t.MLLE=new t("MLLE","MLLE"),t.M=new t("M","M"),t.INCONNU=new t("INCONNU"," "),t}(MyWay.Services.StringEnum);e.CiviliteEnum=t}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.E=new t("E","E"),t.P=new t("P","P"),t.D=new t("D","D"),t.INCONNU=new t("INCONNU"," "),t}(MyWay.Services.StringEnum);e.CodeModeSignatureEnum=t}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n,r,i){this.messageErreur=e,this.action=t,this.erreurMyWay=r,this.messageComplementaire=i,this.classeTypeScript=n}return e.PB_GET_SIGNATURE_EN_INSTANCE="Une erreur est survenue lors de l'appel de la ressource signatureEnInstance",e.PB_GET_IDENTIFICATION="Une erreur est survenue lors de l'appel de la ressource identification",e.PB_GET_CORPORATE_INFORMATION="Une erreur est survenue lors de l'appel de la ressource corporateInformation",e.PB_GET_PARTICULIER_INFORMATION="Une erreur est survenue lors de l'appel de la ressource particulierInformation",e.PB_GET_AUTHENTIFICATION_INFO="Une erreur est survenue lors de récupération de l'objet contexte AuthentificationInfo",e.PB_RECAP_SIGNATAIRES="Une erreur technique est survenue, on ne peut pas suivre le processus recapSignataires ",e.PB_RECAP_SIGNATAIRE_INPUT="Une erreur technique est survenue, le paramétre d'entré de la directive n'est pas défini ",e.PB_SIGNATAIRES="Une erreur technique est survenue, la liste de signataires est vide ",e.PB_ROLE_SIGNATAIRE="Une erreur technique est survenue, le libelleRoleSignataire n'est pas renseigné ",e.PB_IDENTTIFIANT_SIGNATAIRE="Une erreur technique est survenue, l'identifiantSignataire n'est pas renseigné ",e.PB_GET_TIERS_NOYAU="Une erreur technique est survenue lors de l'appel de la ressource tiersNoyau",e}();e.RecapSignatairesMessageErreur=t}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(e,t,n,r){this.identifiantSignataire=e,this.libelleRoleSignataire=t,this.adresseMailSignataire=n,this.precisionSignataire=r,this.etatSignature="",this.nomSignataire=""}return e.prototype.getNomSignataire=function(){return this.nomSignataire},e.prototype.setNomSignataire=function(e){this.nomSignataire=e},e.prototype.getEtatSignature=function(){return this.etatSignature},e.prototype.setEtatSignature=function(e){this.etatSignature=e},e}();e.Signataire=t}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(e){function t(){e.apply(this,arguments)}return __extends(t,e),t.VISA_COLLABORATEUR=new t("VISA_COLLABORATEUR","Visa Conseiller"),t.TITULAIRE=new t("TITULAIRE","Titulaire"),t.CO_TITULAIRE=new t("CO_TITULAIRE","Co-Titulaire"),t.REPRESENTANT_LEGAL=new t("REPRESENTANT_LEGAL","Représentant légal"),t.REPRESENTANT_LEGAL_PRO=new t("REPRESENTANT_LEGAL_PRO","Représentant légal Pro"),t.GESTIONNAIRE_MESURE_PROTECTION=new t("GESTIONNAIRE_MESURE_PROTECTION","Gestionnaire Mesures Protection"),t.EMPRUNTEUR=new t("EMPRUNTEUR","Emprunteur"),t.CO_EMPRUNTEUR=new t("CO_EMPRUNTEUR","Co-Emprunteur"),t.DELEGATAIRE=new t("DELEGATAIRE","Délégataire"),t.CAUTION=new t("CAUTION","Caution"),t.SIGNATAIRE_LEGAL=new t("SIGNATAIRE_LEGAL","Signataire légal"),t.AUTRE=new t("AUTRE","Autre"),t.VIDE=new t(" "," "),t}(MyWay.Services.StringEnum);e.RoleSignataireEnum=t}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function t(e,t){this.$q=e,this.serviceAgentExtended=t}return t.prototype.getParticulierInformation=function(n,r){var i=Date.now(),o=(new e.comContract.RecapSignataires.Ressource.ParticulierInformation.ParticulierInformationRequestFactory).create(n,r);e.comContract.Loggers.info(t.CLASS_NAME,"getParticulierInformation","request %o",o);var a=this.serviceAgentExtended.sendRequest(o);return e.comContract.Loggers.info(t.CLASS_NAME,"getParticulierInformation","response %o elapsedTime %o",a,Date.now()-i),a},t.prototype.getNomSignataire=function(r,i){var o=this;return this.getParticulierInformation(r,i).then(function(e){switch(e.codeCivilite){case"1":return n.CiviliteEnum.MME+". "+o.getNomSignataireFromParticulierInformation(e);case"2":return n.CiviliteEnum.MLLE+". "+o.getNomSignataireFromParticulierInformation(e);case"3":return n.CiviliteEnum.M+". "+o.getNomSignataireFromParticulierInformation(e);case"9":return o.getNomSignataireFromParticulierInformation(e)}})["catch"](function(r){return e.comContract.Loggers.error(t.CLASS_NAME,"getNomSignataire","error %o",r),o.$q.reject(new n.RecapSignatairesMessageErreur(n.RecapSignatairesMessageErreur.PB_GET_PARTICULIER_INFORMATION,"getNomSignataire","ParticulierInformationService",r))})},t.prototype.getNomSignataireFromParticulierInformation=function(e){return null!=e.nomMarital?e.nomMarital+" ("+e.nomFamillePersonnePhysique+") "+e.prenom:e.nomFamillePersonnePhysique+" "+e.prenom},t.CLASS_NAME="myway.comContract.RecapSignataires.ParticulierInformationService",t.$inject=["$q","serviceAgentExtended"],t}();n.ParticulierInformationService=r,t.app.service("particulierInformationService",r)}(n=t.RecapSignataires||(t.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function t(e,t){this.$q=e,this.serviceAgentExtended=t}return t.prototype.init=function(){var r=this;return this.serviceAgentExtended.Context.GetAuthentificationInfo().then(function(n){return e.comContract.Loggers.info(t.CLASS_NAME,"init","authentificationInfo %o",n),r.$q.when(n)})["catch"](function(i){return e.comContract.Loggers.error(t.CLASS_NAME,"init","error %o",i),r.$q.reject(new n.RecapSignatairesMessageErreur(n.RecapSignatairesMessageErreur.PB_GET_AUTHENTIFICATION_INFO,"init","RecapSignatairesContexteService",i))})},t.CLASS_NAME="myway.comContract.RecapSignataires.RecapSignatairesContexteService",t.$inject=["$q","serviceAgentExtended"],t}();n.RecapSignatairesContexteService=r,t.app.service("recapSignatairesContexteService",r)}(n=t.RecapSignataires||(t.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function t(e,t,n,r){this.$q=e,this.recapSignatairesContexteService=t,this.signatureEnInstanceService=n,this.tiersNoyauService=r,this.erreurRecapSignataire="Une erreur est survenue : Récapitulatif des signataires indisponible"}return t.prototype.init=function(r){var i=this;if(!this.checkRecapSignataireInputObjet(r))return this.$q.reject(this.erreurRecapSignataire);var o=Date.now();return this.recapSignatairesContexteService.init().then(function(a){var s=[],c=[];return r.signataires.forEach(function(e){e.libelleRoleSignataire===n.RoleSignataireEnum.VISA_COLLABORATEUR?c.push(e):s.push(i.getSignataireAvecNom(a.codeEtablissement,e))}),i.$q.all(s).then(function(n){return e.comContract.Loggers.info(t.CLASS_NAME,"init","signataires %o",n),r.signataires=n.concat(c),i.getEtatSignature(r)}).then(function(n){return e.comContract.Loggers.info(t.CLASS_NAME,"init","Signataires %o elapsedTime %o",n,Date.now()-o),i.$q.when(n)})["catch"](function(n){return e.comContract.Loggers.error(t.CLASS_NAME,"init","error %o",n),i.$q.reject(n)})})},t.prototype.checkRecapSignataireInputObjet=function(r){var i=this;return null==r?(this.erreurRecapSignataire=n.RecapSignatairesMessageErreur.PB_RECAP_SIGNATAIRE_INPUT,e.comContract.Loggers.error(t.CLASS_NAME,"checkRecapSignataireInputObjet",n.RecapSignatairesMessageErreur.PB_RECAP_SIGNATAIRE_INPUT),!1):null==r.signataires||0===r.signataires.length?(this.erreurRecapSignataire=n.RecapSignatairesMessageErreur.PB_SIGNATAIRES,e.comContract.Loggers.error(t.CLASS_NAME,"checkRecapSignataireInputObjet",n.RecapSignatairesMessageErreur.PB_SIGNATAIRES),!1):_.every(r.signataires,function(e){return i.checkSignataireObjet(e)})?!0:!1},t.prototype.checkSignataireObjet=function(r){return null==r.identifiantSignataire?(this.erreurRecapSignataire=n.RecapSignatairesMessageErreur.PB_IDENTTIFIANT_SIGNATAIRE,e.comContract.Loggers.error(t.CLASS_NAME,"checkSignataireObjet",n.RecapSignatairesMessageErreur.PB_IDENTTIFIANT_SIGNATAIRE),!1):(null==r.libelleRoleSignataire&&(r.libelleRoleSignataire=n.RoleSignataireEnum.VIDE),!0)},t.prototype.getSignataireAvecNom=function(n,r){var i=this;return this.tiersNoyauService.getTiersNoyau(n,parseInt(r.identifiantSignataire,10)).then(function(n){var o=!!n.informationParticulier;return r.setNomSignataire(o?n.informationParticulier.designationCourte:n.informationProfessionnel[0].raisonSocial),e.comContract.Loggers.info(t.CLASS_NAME,"majNomSignataire","personne physique - signataire %o",r),i.$q.when(r)})},t.prototype.getEtatSignature=function(r){var i=this,o=Date.now(),a=[];return r.signataires.forEach(function(e){return a.push(angular.copy(e))}),this.isDateSignatureFournie(r.dateSignature)?(_.forEach(a,function(e){e.setEtatSignature(t.SIGNE)}),this.$q.when(a)):void 0===r.idActeIDN||""===r.idActeIDN?(_.forEach(a,function(e){e.setEtatSignature(t.BLANC)}),this.$q.when(a)):r.signataires.filter(function(e){return e.libelleRoleSignataire===n.RoleSignataireEnum.VISA_COLLABORATEUR}).length>0&&!this.isDateSignatureFournie(r.dateSignature)?(_.forEach(a,function(e){e.setEtatSignature(t.NON_SIGNE)}),this.$q.when(a)):this.signatureEnInstanceService.getSignatureEnInstance(t.CODE_APPLICATION,r.idActeIDN).then(function(n){return n.signataires.forEach(function(e){a.forEach(function(t){t.identifiantSignataire===e.identifiantPersonne&&t.setEtatSignature(e.etatSessionIcg)})}),e.comContract.Loggers.info(t.CLASS_NAME,"getEtatSignature","recapSignatairesInput %o signatureEnInstanceOutput %o elapsedTime %o",r,n,Date.now()-o),i.$q.when(a)})["catch"](function(n){return _.forEach(a,function(e){e.setEtatSignature(t.BLANC)}),e.comContract.Loggers.error(t.CLASS_NAME,"getEtatSignature","error %o EtatSignatureEnum.BLANC recapSignatairesInput %o",n,r),a})},t.prototype.isDateSignatureFournie=function(e){return null!==e&&""!==e&&e!==t.DATE_SIGNATURE_NON_SIGNE},t.CLASS_NAME="myway.comContract.RecapSignataires.RecapSignatairesService",t.CODE_APPLICATION="DOSS_NUM",t.BLANC="",t.SIGNE="Signe",t.NON_SIGNE="Non signe",t.DATE_SIGNATURE_NON_SIGNE="0001-01-01-00.00.00.000000",t.$inject=["$q","recapSignatairesContexteService","signatureEnInstanceService","tiersNoyauService"],t}();n.RecapSignatairesService=r,t.app.service("recapSignatairesService",r)}(n=t.RecapSignataires||(t.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function t(e,t){this.$q=e,this.serviceAgentExtended=t}return t.prototype.getSignatureEnInstance=function(r,i){var o=this,a=Date.now(),s=(new e.comContract.RecapSignataires.Ressource.SignatureEnInstance.SignatureEnInstanceRequestFactory).create(r,i);return e.comContract.Loggers.info(t.CLASS_NAME,"getSignatureEnInstance","request %o",s),this.serviceAgentExtended.sendRequest(s).then(function(n){return e.comContract.Loggers.info(t.CLASS_NAME,"getSignatureEnInstance","response %o elapsedTime %o",n,Date.now()-a),o.$q.when(n)})["catch"](function(r){return e.comContract.Loggers.error(t.CLASS_NAME,"getSignatureEnInstance","error %o",r),o.$q.reject(new n.RecapSignatairesMessageErreur(n.RecapSignatairesMessageErreur.PB_GET_SIGNATURE_EN_INSTANCE,"getSignatureEnInstance","SignatureEnInstanceService",r))})},t.CLASS_NAME="myway.comContract.RecapSignataires.SignatureEnInstanceService",t.$inject=["$q","serviceAgentExtended"],t}();n.SignatureEnInstanceService=r,t.app.service("signatureEnInstanceService",r)}(n=t.RecapSignataires||(t.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function t(e,t){this.$q=e,this.serviceAgentExtended=t}return t.prototype.getTiersNoyau=function(r,i){var o=this,a=Date.now(),s=(new e.comContract.RecapSignataires.Ressource.TiersNoyau.TiersNoyauRequestFactory).create(r,i);return e.comContract.Loggers.info(t.CLASS_NAME,"getTiersNoyau","request %o",s),this.serviceAgentExtended.sendRequest(s).then(function(n){return e.comContract.Loggers.info(t.CLASS_NAME,"getTiersNoyau","response %o elapsedTime %o",n,Date.now()-a),o.$q.when(n)})["catch"](function(r){return e.comContract.Loggers.error(t.CLASS_NAME,"getTiersNoyau","error %o",r),o.$q.reject(new n.RecapSignatairesMessageErreur(n.RecapSignatairesMessageErreur.PB_GET_TIERS_NOYAU,"getTiersNoyau","TiersNoyauService",r))})},t.CLASS_NAME="myway.comContract.RecapSignataires.TiersNoyauService",t.$inject=["$q","serviceAgentExtended"],t}();n.TiersNoyauService=r,t.app.service("tiersNoyauService",r)}(n=t.RecapSignataires||(t.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";e.PRECISION_SIGNATAIRE_MINLENGTH=3,e.REFERENCE_IDENTITE_MINLENGTH=3,e.REFERENCE_IDENTITE_MAXLENGTH=32,e.MESSAGE_ERREUR_PRECISION_SIGNATAIRE_REQUIRED="Le champ 'Cas particulier' est obligatoire",e.MESSAGE_ERREUR_PRECISION_SIGNATAIRE_MINLENGTH="Le champ 'Cas particulier' doit avoir au moins "+e.PRECISION_SIGNATAIRE_MINLENGTH+" caractères",e.MESSAGE_ERREUR_REFERENCE_IDENTITE_REQUIRED="Le champ 'Référence justificatif d'identité' est obligatoire",e.MESSAGE_ERREUR_REFERENCE_IDENTITE_MINLENGTH="Le champ 'Référence justificatif d'identité' doit avoir au moins "+e.REFERENCE_IDENTITE_MINLENGTH+" caractères",e.MESSAGE_ERREUR_REFERENCE_IDENTITE_MAXLENGTH="Le champ 'Référence justificatif d'identité' doit avoir au plus "+e.REFERENCE_IDENTITE_MAXLENGTH+" caractères",e.MESSAGE_ERREUR_SERVICE_REST="Impossible de récuperer la listes de signataires, problème de service REST - ",e.MESSAGE_ERREUR_DONNEES_ENTREES="Impossible de récuperer la liste de signataires, données en entrée manquantes ",e.MESSAGE_ERREUR_CODE_GESTION_REQUIRED="Le code acte de gestion est obligatoire.",e.MESSAGE_ERREUR_ENTITE_OU_RICE_REQUIRED="Un numéro d’entité titulaire, ou un RICE, doit être fourni.",e.MESSAGE_ERREUR_CHECKBOX_VC_CONFIRM="En mode Visa Conseiller, veuillez confirmer que vous détenez la demande du client.",e.CHANGED_EVENTNAME="MWSFLISTESIGNATAIRES_CHOIX_SIGNATAIRES_CHANGED",e.SESSION_STORAGE_MYWAY_CONTAINER_ID="myway-container-id",e.PARAM_MYWAY_CONTAINER_ID="idConteneur";var t;!function(e){e.TITRE_COLONNE_RESTRICTION="Restriction sur Financement",e.TITRE_COLONNE_QUALITE="Qualité",e.TITRE_COLONNE_DESIGNATION="Désignation"}(t=e.TableauPro||(e.TableauPro={}))}(t=e.Commun||(e.Commun={}))}(t=e.Constantes||(e.Constantes={}))}(t=e.Signataire||(e.Signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";e.VALEUR_REGLE_CONTRACTUALISATION_TRUE="1",e.CODE_CANAL_FACE_A_FACE="FF",e.CODE_CANAL_TL="TL",e.LISTE_MODE_CONTRACTUALISATION_FF=["FAFE","FAFG"],e.LISTE_MODE_CONTRACTUALISATION_TL=["VADE","VADP"];var t;!function(e){e.INDICATEUR_MODE_APPEL_QR="R",e.CODE_RUBRIQUE_REGLE="TYPMAN"}(t=e.RequestSettings||(e.RequestSettings={}))}(t=e.ReglesSignataire||(e.ReglesSignataire={}))}(t=e.Constantes||(e.Constantes={}))}(t=e.Signataire||(e.Signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){var r=function(){function r(n,i,o,a,s,c,u,l){var E=this;this.$scope=n,this.$filter=i,this.$parse=o,this.$q=a,this.$timeout=s,this.serviceAgentExtended=c,this.signataireService=u,this.communService=l,this.LIBELLE_AUTRE="Autre",this.LIBELLE_ONGLET_SIGNATAIRES="Signataires",this.LIBELLE_ONGLET_VISA_COLLABORATEUR="Visa Conseiller",this.OUVERTURE_TRANSFERT="OT",this.isOpened=!1,this.isPro=!1,this.afficheChampPrecision=!1,this.typeSignataireEnum=e.comContract.modeles.TypeSignataire,this.codeTypePersonne=e.comContract.modeles.CodeTypePersonne,this.tableauColonneOptionsNom={title:e.comContract.Signataire.Constantes.Commun.TableauPro.TITRE_COLONNE_DESIGNATION.toUpperCase(),bind:"nom",cssClass:"col-md-6 col-lg-6 bold"},this.tableauColonneOptionsQualite={title:e.comContract.Signataire.Constantes.Commun.TableauPro.TITRE_COLONNE_QUALITE,bind:"role",cssClass:"col-md-3 col-lg-3 majuscule",filter:"| roleSignataire",comparator:this.roleFiltre},this.tableauColonneOptionsFinance={title:e.comContract.Signataire.Constantes.Commun.TableauPro.TITRE_COLONNE_RESTRICTION,bind:"montantAutorisationSignataire",cssClass:"col-md-3 col-lg-3 majuscule",filter:"| financement",disableFilter:!0},this.tableauSignatairesPro={width:"col-md-12 ",orderBy:"role",reserve:!1,perPage:100,multiSelect:!0,filterEnable:!0,sortEnable:!0,moreEnable:!1,columns:[this.tableauColonneOptionsNom,this.tableauColonneOptionsQualite],data:[],selectedItems:[],disabledItems:[],templateUrl:"",selectionChangeHandler:this},this.ngModel=[],this.isOpened=!1,this.checkboxVcConfirm=!1,n.$watch(function(){return E.donneesEntree.identifiantEntiteTitulaire},function(n,i){n&&(e.comContract.Loggers.info(r.CLASS_NAME,"/directives/signataires","newValue identifiantEntiteTitulaire %o (%o) %o",n,i,t.Loggers.APP_VERSION),E.ngModel=[],E.isOpened=!1,E.recuperationSignataires())}),this.donneesEntree.identifiantEntiteTitulaire||(e.comContract.Loggers.info(r.CLASS_NAME,"/directives/signataires","identifiantEntiteTitulaire %o %o",this.donneesEntree.identifiantEntiteTitulaire,t.Loggers.APP_VERSION),this.recuperationSignataires())}return r.prototype.expand=function(e){if(this.isOpened=null!=e?e:!this.isOpened,this.referenceIdentiteFocus){var t="input-reference-identite";t+=this.isPro?"-pro":"",this.$timeout(function(){null!==document.getElementById(t)&&(this.isOpened?document.getElementById(t).focus():document.getElementById(t).blur())},100)}},r.prototype.recuperationSignataires=function(){var t=this,n=Date.now();
e.comContract.Loggers.info(r.CLASS_NAME,"recuperationSignataires","donneesEntree %o",this.donneesEntree);var i=this.verifierDonneesEntree(this.donneesEntree);this.chargement=!0,this.chargementSansErreur=!1,this.resetErreurs(),""!==i?(this.messageErreurServiceRest=e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_DONNEES_ENTREES,this.setErreurPrecisionSignataire(i),this.chargement=!1,e.comContract.Loggers.error(r.CLASS_NAME,"recuperationSignataires","error messageDonneesEntree %o",i),this.$scope.$evalAsync()):this.communService.init().then(function(){t.identifiantPersonne=t.donneesEntree.identifiantPersonne,t.signataireService.getSignataires(t.donneesEntree).then(function(i){t.signataireReponse=i,null!=t.signataireReponse.estDeplier&&t.signataireReponse.estDeplier&&(t.isOpened=t.signataireReponse.estDeplier),e.comContract.Loggers.info(r.CLASS_NAME,"recuperationSignataires","signataireReponse %o",t.signataireReponse),t.isPro=i.isPro,t.existAutresInSignataireReponse()&&(t.autreSignataire=t.signataireReponse.autres.personnes[0]),null!=t.autreSignataire&&t.donneesEntree.isModeReprise&&null!=t.donneesEntree.casParticulier?t.gestionCasParticulierModeReprise():(null!=t.ngModel&&t.ngModel.length?t.disableIsselectionneInSignataireReponseExceptIfInNgModel():t.loadTitulairesAndRepresentantsLegauxToNgModel(),t.gestionPrecisionSignataire()),t.existVisaCollabInSignataireReponse()&&(t.visaCollaborateur=t.signataireReponse.visaCollaborateurs.personnes[0],t.visaCollaborateur.isSelectionne&&t.ajoutSignataireNgModel(t.visaCollaborateur,e.comContract.modeles.TypeSignataire.VISA_COLLABORATEUR)),t.isPro&&t.initTableauPro(),t.doitAfficherReferenceIdentite(t.donneesEntree.referenceIdentite),t.notifierChangement(),t.chargement=!1,t.chargementSansErreur=!0,t.expand(!0),e.comContract.Loggers.info(r.CLASS_NAME,"recuperationSignataires","elapsedTime %o",Date.now()-n),t.$scope.$evalAsync()})["catch"](function(n){e.comContract.Loggers.error(r.CLASS_NAME,"recuperationSignataires","error %o",n),t.setErreurServiceRest(n.libelle||"pas de réponse du serveur"),t.chargement=!1,t.$scope.$evalAsync()})})},r.prototype.disableIsselectionneInSignataireReponseExceptIfInNgModel=function(){var n=this;this.signataireReponse.titulaires.personnes.forEach(function(e){return e.isSelectionne=!1}),this.signataireReponse.mandataires.personnes.forEach(function(e){return e.isSelectionne=!1}),this.signataireReponse.representantsLegaux.personnes.forEach(function(e){return e.isSelectionne=!1}),this.isPro&&this.signataireReponse.delegataires.personnes.forEach(function(e){return e.isSelectionne=!1}),this.ngModel.forEach(function(e){return n.forceIsselectionneInSignataireReponse(e,!0)}),e.comContract.Loggers.info(r.CLASS_NAME,"disableIsselectionneInSignataireReponseExceptIfInNgModel","ngModel %o",this.ngModel),this.ngModel[0].role===t.modeles.TypeSignataire.AUTRE?(this.precisionSignataire=this.ngModel[0].nomUsage,this.afficheChampPrecision=!0):this.controlerMinMax()},r.prototype.loadTitulairesAndRepresentantsLegauxToNgModel=function(){var n=this;this.ngModel=[],this.signataireReponse.titulaires.personnes.filter(function(e){return e.isSelectionne}).forEach(function(e){return n.ajoutSignataireNgModel(e,t.modeles.TypeSignataire.TITULAIRE)}),this.signataireReponse.representantsLegaux.personnes.filter(function(e){return e.isSelectionne}).forEach(function(e){return n.ajoutSignataireNgModel(e,t.modeles.TypeSignataire.REPRESENTANT_LEGAL)}),this.signataireReponse.representantsLegauxPro.personnes.filter(function(e){return e.isSelectionne}).forEach(function(e){return n.ajoutSignataireNgModel(e,t.modeles.TypeSignataire.REPRESENTANT_LEGAL_PRO)}),this.signataireReponse.gestionnairesMesureProtection.personnes.filter(function(e){return e.isSelectionne}).forEach(function(e){return n.ajoutSignataireNgModel(e,t.modeles.TypeSignataire.GESTIONNAIRE_MESURE_PROTECTION)}),e.comContract.Loggers.info(r.CLASS_NAME,"loadTitulairesAndRepresentantsLegauxToNgModel","ngModel %o",this.ngModel),this.controlerMinMax()},r.prototype.getLibellePersonne=function(t){return t.codeTypePersonne===e.comContract.modeles.CodeTypePersonne.MORALE?t.raisonSocial+" ":t.designationCourte&&""!==t.designationCourte?t.designationCourte+" ":this.getLibelleCivilite(t.codeCivilite)+" "+(t.nomUsage?t.nomUsage+" ("+t.nomFamille+")":t.nomFamille)+" "+t.prenom+" "},r.prototype.getLibelleCivilite=function(e){switch(e){case 1:return"Mme";case 2:return"Mlle";case 3:return"M.";default:return""}},r.prototype.onCheck=function(e,n){this.autreSignataire&&this.autreSignataire.isSelectionne&&this.removeAutreSignataire(),n===t.modeles.TypeSignataire.TITULAIRE?this.gestionNgModel(this.signataireReponse.titulaires.personnes[e],n):n===t.modeles.TypeSignataire.REPRESENTANT_LEGAL?this.gestionNgModel(this.signataireReponse.representantsLegaux.personnes[e],n):n===t.modeles.TypeSignataire.REPRESENTANT_LEGAL_PRO?this.gestionNgModel(this.signataireReponse.representantsLegauxPro.personnes[e],n):n===t.modeles.TypeSignataire.GESTIONNAIRE_MESURE_PROTECTION?this.gestionNgModel(this.signataireReponse.gestionnairesMesureProtection.personnes[e],n):n===t.modeles.TypeSignataire.MANDATAIRE&&this.gestionNgModel(this.signataireReponse.mandataires.personnes[e],n),this.onChangePrecisionSignataire(),this.onChangeReferenceIdentite(),this.notifierChangement()},r.prototype.onCheckAutre=function(e,n){var r=this;e?(n?(this.setMessageInfo(!0),this.tableauSignatairesPro.selectedItems.length>0&&(this.tableauSignatairesPro.selectedItems=[]),this.signatairesListe.forEach(function(e){e.checked=!1,e.isSelectionne=!1,e.disabled=!0})):null!=this.ngModel&&this.ngModel.forEach(function(e){return r.forceIsselectionneInSignataireReponse(e,!1)}),this.setErreurMinMax(),this.afficheChampPrecision=!0,this.ngModel=[],this.ajoutSignataireNgModel(this.autreSignataire,t.modeles.TypeSignataire.AUTRE),this.removeVcSignataire()):(n&&(this.signatairesListe.forEach(function(e){return e.disabled=!1}),this.setMessageInfo()),this.setErreurMinMax(this.signataireReponse.libelleErreur),this.afficheChampPrecision=!1,this.removeAutreSignataire()),this.onChangePrecisionSignataire(),this.onChangeReferenceIdentite(),this.notifierChangement()},r.prototype.onSelectTabSignataires=function(){this.removeVcSignataire(),this.checkboxVcConfirm=!1,this.setErreurCheckboxConfirmVc(),this.notifierChangement(),this.isTabVcSelected=!1},r.prototype.onSelectTabVc=function(){this.setErreurPrecisionSignataire(),this.precisionSignataire=void 0,this.isAutreSelected()&&this.setErreurMinMax(this.signataireReponse.libelleErreur),this.removeAutreSignataire(),this.ajoutSignataireNgModel(this.signataireReponse.visaCollaborateurs.personnes[0],t.modeles.TypeSignataire.VISA_COLLABORATEUR),this.notifierChangement(),this.isTabVcSelected=!0,this.onCheckVcConfirm(!1)},r.prototype.isAutreSelected=function(){return this.ngModel.filter(function(e){return e.role===t.modeles.TypeSignataire.AUTRE}).length},r.prototype.onCheckVcConfirm=function(t){t?this.setErreurCheckboxConfirmVc():this.setErreurCheckboxConfirmVc(e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_CHECKBOX_VC_CONFIRM)},r.prototype.onChangePrecisionSignataire=function(){var n=this;if(this.afficheChampPrecision)if(this.precisionSignataire&&this.precisionSignataire.length>=e.comContract.Signataire.Constantes.Commun.PRECISION_SIGNATAIRE_MINLENGTH){var r=_.findIndex(this.ngModel,function(e){return e.role===t.modeles.TypeSignataire.AUTRE});-1!==r?(this.ngModel[r].nom=this.precisionSignataire,this.ngModel[r].designataire="Autre Signataire"):this.ngModel.filter(function(e){return e.typePersonne===t.modeles.TypePersonne.MORALE&&e.role===t.modeles.TypeSignataire.REPRESENTANT_LEGAL}).forEach(function(e){return e.nomUsage=n.precisionSignataire}),this.setErreurPrecisionSignataire()}else this.precisionSignataire&&this.precisionSignataire.length<e.comContract.Signataire.Constantes.Commun.PRECISION_SIGNATAIRE_MINLENGTH?this.setErreurPrecisionSignataire(e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_PRECISION_SIGNATAIRE_MINLENGTH):this.setErreurPrecisionSignataire(e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_PRECISION_SIGNATAIRE_REQUIRED);else this.setErreurPrecisionSignataire(),this.precisionSignataire=void 0;this.notifierChangement()},r.prototype.onChangeReferenceIdentite=function(){var t=this;this.afficherReferenceIdentite?this.referenceIdentite?this.verifierReferenceIdentiteLength()?(this.setErreurReferenceIdentite(),this.ngModel.forEach(function(e){return e.referenceIdentite=t.referenceIdentite})):this.referenceIdentite.length>0?(this.setErreurReferenceIdentite(this.referenceIdentite.length>e.comContract.Signataire.Constantes.Commun.REFERENCE_IDENTITE_MAXLENGTH?e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_REFERENCE_IDENTITE_MAXLENGTH:e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_REFERENCE_IDENTITE_MINLENGTH),this.ngModel.forEach(function(e){return e.referenceIdentite=void 0})):(this.referenceIdentiteObligatoire?this.setErreurReferenceIdentite(e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_REFERENCE_IDENTITE_REQUIRED):this.setErreurReferenceIdentite(),this.ngModel.forEach(function(e){return e.referenceIdentite=void 0})):(this.referenceIdentiteObligatoire?this.setErreurReferenceIdentite(e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_REFERENCE_IDENTITE_REQUIRED):this.setErreurReferenceIdentite(),this.ngModel.forEach(function(e){return e.referenceIdentite=void 0})):(this.setErreurReferenceIdentite(),this.referenceIdentite=void 0),this.notifierChangement()},r.prototype.verifierReferenceIdentiteLength=function(){return this.referenceIdentite.length>=e.comContract.Signataire.Constantes.Commun.REFERENCE_IDENTITE_MINLENGTH&&this.referenceIdentite.length<=e.comContract.Signataire.Constantes.Commun.REFERENCE_IDENTITE_MAXLENGTH},r.prototype.gestionCasParticulierModeReprise=function(){this.setErreurMinMax(),this.afficheChampPrecision=!0,this.ngModel=[],this.ajoutSignataireNgModel(this.autreSignataire,t.modeles.TypeSignataire.AUTRE),this.donneesEntree.casParticulier&&(this.precisionSignataire=this.donneesEntree.casParticulier,this.donneesEntree.casParticulier.length>=e.comContract.Signataire.Constantes.Commun.PRECISION_SIGNATAIRE_MINLENGTH?(this.ngModel[0].nom=this.donneesEntree.casParticulier,this.ngModel[0].designataire="Autre Signataire",this.setErreurPrecisionSignataire()):this.setErreurPrecisionSignataire(e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_PRECISION_SIGNATAIRE_MINLENGTH))},r.prototype.ajoutSignataireNgModel=function(n,i){var o={numeroPersonne:n.identifiantPersonne,role:i,rang:parseInt(n.numeroRangPersonneET),codeLienPersonne:n.codeTypeLienInterPersonnes,nom:this.getLibellePersonne(n),prenom:n.prenom,nomUsage:n.nomUsage,nomFamille:n.nomFamille,designataire:this.getLibelleDesignataire(n.codeTypeLienInterPersonnes,i),typePersonne:n.codeTypePersonne===e.comContract.modeles.CodeTypePersonne.MORALE?t.modeles.TypePersonne.MORALE:t.modeles.TypePersonne.PHYSIQUE,situationFamille:n.codeTypeSituationFamille,dateNaissance:new Date(n.dateNaissance),codePersonnaliteJuridique:n.codeCapaciteJuridique?n.codeCapaciteJuridique.toString():void 0,codeFamilleLiensInterPersonnes:n.codeFamilleLiensInterPersonnes,codeRoleDossierVente:this.getCodeRoleDossierVente(""+n.identifiantPersonne,i),identifiantPersonneEnLien:i===t.modeles.TypeSignataire.GESTIONNAIRE_MESURE_PROTECTION?n.premierePersEnRelation:null,rolePersonneEnLien:i===t.modeles.TypeSignataire.GESTIONNAIRE_MESURE_PROTECTION?t.modeles.TypeSignataire.REPRESENTANT_LEGAL_PRO:null};this.referenceIdentite&&this.verifierReferenceIdentiteLength()&&(o.referenceIdentite=this.referenceIdentite),n.identifiantPersonne===parseInt(this.identifiantPersonne)&&this.ngModel.length>0?(e.comContract.Loggers.info(r.CLASS_NAME,"ajoutSignataireNgModel","unshift newSignataire %o",o),this.ngModel.unshift(o)):(e.comContract.Loggers.info(r.CLASS_NAME,"ajoutSignataireNgModel","push newSignataire %o",o),this.ngModel.push(o))},r.prototype.getCodeRoleDossierVente=function(e,n){return null!=this.donneesEntree.identifiantPersonne&&e===this.donneesEntree.identifiantPersonne?t.modeles.CodeRoleDossierVente.TITULAIRE:n===t.modeles.TypeSignataire.REPRESENTANT_LEGAL?t.modeles.CodeRoleDossierVente.REPRESENTANT_LEGAL:n===t.modeles.TypeSignataire.REPRESENTANT_LEGAL_PRO?t.modeles.CodeRoleDossierVente.REPRESENTANT_LEGAL_PRO:n===t.modeles.TypeSignataire.GESTIONNAIRE_MESURE_PROTECTION?t.modeles.CodeRoleDossierVente.GESTIONNAIRE_MESURE_PROTECTION:n===t.modeles.TypeSignataire.SIGNATAIRE_LEGAL?t.modeles.CodeRoleDossierVente.SIGNATAIRE_LEGAL:n===t.modeles.TypeSignataire.TITULAIRE?t.modeles.CodeRoleDossierVente.Co_TITULAIRE:n===t.modeles.TypeSignataire.MANDATAIRE?t.modeles.CodeRoleDossierVente.MANDATAIRE:n===t.modeles.TypeSignataire.DELEGATAIRE?t.modeles.CodeRoleDossierVente.DELEGATAIRE:n===t.modeles.TypeSignataire.VISA_COLLABORATEUR?t.modeles.CodeRoleDossierVente.VISA_COLLABORATEUR:null},r.prototype.removeAutreSignataire=function(){this.autreSignataire&&(this.autreSignataire.isSelectionne=!1,_.remove(this.ngModel,function(e){return e.role===t.modeles.TypeSignataire.AUTRE}),this.afficheChampPrecision=!1)},r.prototype.removeVcSignataire=function(){this.visaCollaborateur&&(this.visaCollaborateur.isSelectionne=!1,_.remove(this.ngModel,function(e){return e.role===t.modeles.TypeSignataire.VISA_COLLABORATEUR}))},r.prototype.forceIsselectionneInSignataireReponse=function(e,t){var n=this.getTitulairesByType(e.role);n?n.filter(function(t){return t.identifiantPersonne===e.numeroPersonne&&t.codeTypeLienInterPersonnes===e.codeLienPersonne}).forEach(function(e){return e.isSelectionne=t}):this.autreSignataire.isSelectionne=!0},r.prototype.getTitulairesByType=function(e){return e===t.modeles.TypeSignataire.TITULAIRE?this.signataireReponse.titulaires.personnes:e===t.modeles.TypeSignataire.REPRESENTANT_LEGAL?this.signataireReponse.representantsLegaux.personnes:e===t.modeles.TypeSignataire.REPRESENTANT_LEGAL_PRO?this.signataireReponse.representantsLegauxPro.personnes:e===t.modeles.TypeSignataire.GESTIONNAIRE_MESURE_PROTECTION?this.signataireReponse.gestionnairesMesureProtection.personnes:e===t.modeles.TypeSignataire.SIGNATAIRE_LEGAL?this.signataireReponse.signatairesLegaux.personnes:e===t.modeles.TypeSignataire.MANDATAIRE?this.signataireReponse.mandataires.personnes:e===t.modeles.TypeSignataire.DELEGATAIRE?this.signataireReponse.delegataires.personnes:null},r.prototype.gestionNgModel=function(e,t){e.isSelectionne?this.ajoutSignataireNgModel(e,t):_.remove(this.ngModel,function(n){return n.numeroPersonne===e.identifiantPersonne&&n.role===t&&n.codeLienPersonne===e.codeTypeLienInterPersonnes}),this.controlerMinMax(),this.gestionPrecisionSignataire()},r.prototype.controlerMinMax=function(){if(this.setErreurMinMax(),0===this.countSelectedOtherThanVc())this.setErreurMinMax(this.signataireReponse.libelleErreur);else if(!this.verifierPresenceModeOperationsFinancieres(this.donneesEntree)||!this.isPro){var e=this.controlerMinMaxTypeSignataire(t.modeles.TypeSignataire.TITULAIRE,this.signataireReponse.titulaires),n=this.controlerMinMaxTypeSignataire(t.modeles.TypeSignataire.REPRESENTANT_LEGAL,this.signataireReponse.representantsLegaux),r=this.controlerMinMaxTypeSignataireRLProAndGMP(this.signataireReponse.representantsLegauxPro,this.signataireReponse.gestionnairesMesureProtection),i=this.controlerMinMaxTypeSignataire(t.modeles.TypeSignataire.MANDATAIRE,this.signataireReponse.mandataires),o=this.isPro?this.controlerMinMaxTypeSignataire(t.modeles.TypeSignataire.DELEGATAIRE,this.signataireReponse.delegataires):!0,a=this.isPro?this.controlerMinMaxTypeSignataire(t.modeles.TypeSignataire.SIGNATAIRE_LEGAL,this.signataireReponse.signatairesLegaux):!0,s=this.controlerMaxSignataire();e&&n&&r&&i&&s&&o&&a||this.setErreurMinMax(this.signataireReponse.libelleErreur)}},r.prototype.countSelectedOtherThanVc=function(){return this.ngModel.filter(function(e){return e.role!==t.modeles.TypeSignataire.VISA_COLLABORATEUR}).length},r.prototype.controlerMinMaxTypeSignataire=function(e,t){var n=this.ngModel.filter(function(t){return t.role===e}).length;return n>=t.minSelectionne&&n<=t.maxSelectionne},r.prototype.controlerMaxSignataire=function(){var e=this.ngModel.filter(function(e){return e.role!==t.modeles.TypeSignataire.VISA_COLLABORATEUR}).length;return e<=this.signataireReponse.maxSignataire},r.prototype.controlerMinMaxTypeSignataireRLProAndGMP=function(e,n){var r=this.ngModel.filter(function(e){return e.role===t.modeles.TypeSignataire.REPRESENTANT_LEGAL_PRO}).length,i=this.ngModel.filter(function(e){return e.role===t.modeles.TypeSignataire.GESTIONNAIRE_MESURE_PROTECTION}).length,o=r+i;return o>=e.minSelectionne&&r<=e.maxSelectionne&&i<=n.maxSelectionne},r.prototype.gestionPrecisionSignataire=function(){var n=this.ngModel.filter(function(e){return e.typePersonne===t.modeles.TypePersonne.MORALE&&e.role===t.modeles.TypeSignataire.REPRESENTANT_LEGAL_PRO}).length;this.afficheChampPrecision=n>0,this.onChangePrecisionSignataire(),e.comContract.Loggers.info(r.CLASS_NAME,"gestionPrecisionSignataire","ngModel %o",this.ngModel)},r.prototype.getLibelleDesignataire=function(e,n){return n===t.modeles.TypeSignataire.TITULAIRE?"Titulaire":n===t.modeles.TypeSignataire.REPRESENTANT_LEGAL?"Représentant Légal":n===t.modeles.TypeSignataire.REPRESENTANT_LEGAL_PRO?"Représentant légal Pro":n===t.modeles.TypeSignataire.GESTIONNAIRE_MESURE_PROTECTION?"Gestionnaire Mesures Protection":n===t.modeles.TypeSignataire.SIGNATAIRE_LEGAL?"Signataire Légal":n===t.modeles.TypeSignataire.MANDATAIRE?"Mandataire":n===t.modeles.TypeSignataire.DELEGATAIRE?"Délégataire":""},r.prototype.resetErreurs=function(){this.setErreurPrecisionSignataire(),this.setErreurReferenceIdentite(),this.setErreurMinMax(),this.setErreurServiceRest(),this.setErreurCheckboxConfirmVc()},r.prototype.setErreurPrecisionSignataire=function(t){this.messageErreurPrecisionSignataire=t,t&&e.comContract.Loggers.error(r.CLASS_NAME,"setErreurPrecisionSignataire","message %o",t),this.buildOutputMessageErreur()},r.prototype.setErreurReferenceIdentite=function(t){this.messageErreurReferenceIdentite=t,t&&e.comContract.Loggers.error(r.CLASS_NAME,"setErreurReferenceIdentite","message %o",t),this.buildOutputMessageErreur()},r.prototype.setErreurMinMax=function(t){t&&e.comContract.Loggers.info(r.CLASS_NAME,"setErreurMinMax","message %o",t),this.messageErreurMinMax=t,this.buildOutputMessageErreur()},r.prototype.setErreurCheckboxConfirmVc=function(t){this.messageErreurCheckboxVcConfirm=t,t&&e.comContract.Loggers.error(r.CLASS_NAME,"setErreurCheckboxconfirm","message %o",t),this.buildOutputMessageErreur()},r.prototype.setErreurServiceRest=function(t){this.messageErreurServiceRest=t?e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_SERVICE_REST+t:"",t&&e.comContract.Loggers.error(r.CLASS_NAME,"setErreurServiceRest","message %o",t),this.buildOutputMessageErreur()},r.prototype.buildOutputMessageErreur=function(){this.messageErreur=_.compact([this.messageErreurServiceRest,this.messageErreurMinMax,this.messageErreurPrecisionSignataire,this.messageErreurReferenceIdentite,this.messageErreurCheckboxVcConfirm]).join("| ")},r.prototype.notifierChangement=function(){var n=this.ngModel.filter(function(e){return e.role!==t.modeles.TypeSignataire.VISA_COLLABORATEUR}).length,i=n>1?"s":"";this.selectionMessage=n+" personne"+i+" sélectionnée"+i+".",this.signataireService.signatairesSelectionnes=this.ngModel,e.comContract.Loggers.info(r.CLASS_NAME,"notifierChangement","selectionMessage %o ngModel %o",this.selectionMessage,this.ngModel),this.$scope.$emit(e.comContract.Signataire.Constantes.Commun.CHANGED_EVENTNAME,this.ngModel)},r.prototype.doitAfficherReferenceIdentite=function(t){switch(this.afficherReferenceIdentite=!0,t){case n.ReferenceIdentiteEnum.OBLIGATOIRE:case n.ReferenceIdentiteEnum.OBLIGATOIRE_FOCUS:this.setErreurReferenceIdentite(e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_REFERENCE_IDENTITE_REQUIRED);break;case n.ReferenceIdentiteEnum.FACULTATIVE_FOCUS:case n.ReferenceIdentiteEnum.FACULTATIVE:break;default:this.afficherReferenceIdentite=!1}this.referenceIdentiteObligatoire=t===n.ReferenceIdentiteEnum.OBLIGATOIRE||t===n.ReferenceIdentiteEnum.OBLIGATOIRE_FOCUS,this.referenceIdentiteFocus=t===n.ReferenceIdentiteEnum.OBLIGATOIRE_FOCUS||t===n.ReferenceIdentiteEnum.FACULTATIVE_FOCUS},r.prototype.verifierDonneesEntree=function(t){return this.verifierPresenceModeOperationsFinancieres(t)?"":this.verifierPresenceCodeActeGestion(t)?this.verifierPresenceEntiteTitulaire(t)||this.verifierPresenceRICE(t)?"":e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_ENTITE_OU_RICE_REQUIRED:e.comContract.Signataire.Constantes.Commun.MESSAGE_ERREUR_CODE_GESTION_REQUIRED},r.prototype.verifierPresenceModeOperationsFinancieres=function(e){return null!=e&&(e.modeOperationsFinancieres===n.ModeOperationsFinancieresEnum.PARAMETRAGE_SPECIFIQUE_OF1||e.modeOperationsFinancieres===n.ModeOperationsFinancieresEnum.PARAMETRAGE_SPECIFIQUE_OF2||e.modeOperationsFinancieres===n.ModeOperationsFinancieresEnum.PARAMETRAGE_SPECIFIQUE_OF3)},r.prototype.verifierPresenceCodeActeGestion=function(e){return null!=e.codeActeGestion&&""!==e.codeActeGestion},r.prototype.verifierPresenceEntiteTitulaire=function(e){return null!=e.identifiantEntiteTitulaire&&e.identifiantEntiteTitulaire>0},r.prototype.verifierPresenceRICE=function(e){return null!=e.codeGuichetCompteSupport&&""!==e.codeGuichetCompteSupport&&null!=e.codeTypePSCompteSupport&&""!==e.codeTypePSCompteSupport&&null!=e.codePSCompteSupport&&""!==e.codePSCompteSupport},r.prototype.isShowBlocRLProPMWithGMP=function(e,n){return n.codeTypePersonne===t.modeles.CodeTypePersonne.MORALE&&this.isPersonneProtegee(e)&&this.isActeGestionPerimetreETutelle(this.donneesEntree.codeActeGestion)},r.prototype.isShowBlocRLProPMWithoutGMP=function(e,n){return!(n.codeTypePersonne!==t.modeles.CodeTypePersonne.MORALE||this.isPersonneProtegee(e)&&this.isActeGestionPerimetreETutelle(this.donneesEntree.codeActeGestion))},r.prototype.isActeGestionPerimetreETutelle=function(e){return null==e||e.substring(0,2)!==this.OUVERTURE_TRANSFERT},r.prototype.isPersonneProtegee=function(e){var t=[0,3,4,5,6];return e?e.filter(function(e){return e.codeCapaciteJuridique>7||-1!==t.indexOf(e.codeCapaciteJuridique)}).length>0:!1},r.prototype.existGMPLie=function(e){return this.signataireReponse.gestionnairesMesureProtection.personnes.filter(function(t){return t.premierePersEnRelation===e.identifiantPersonne}).length>0},r.prototype.existAutresInSignataireReponse=function(){return this.signataireReponse.autres&&this.signataireReponse.autres.personnes.length>0},r.prototype.existVisaCollabInSignataireReponse=function(){return this.signataireReponse.visaCollaborateurs&&this.signataireReponse.visaCollaborateurs.personnes.length>0},r.prototype.getTypeSignatairePro=function(e){return e===t.modeles.TypeSignataire.TITULAIRE?t.modeles.TypeSignatairePro.TITULAIRE:e===t.modeles.TypeSignataire.REPRESENTANT_LEGAL?t.modeles.TypeSignatairePro.REPRESENTANT_LEGAL:e===t.modeles.TypeSignataire.DELEGATAIRE?t.modeles.TypeSignatairePro.DELEGATAIRE:e===t.modeles.TypeSignataire.MANDATAIRE?t.modeles.TypeSignatairePro.MANDATAIRE:e===t.modeles.TypeSignataire.SIGNATAIRE_LEGAL?t.modeles.TypeSignatairePro.SIGNATAIRE_LEGAL:t.modeles.TypeSignatairePro.AUTRE},r.prototype.getTypeSignataireCommun=function(e){return e===t.modeles.TypeSignatairePro.TITULAIRE?t.modeles.TypeSignataire.TITULAIRE:e===t.modeles.TypeSignatairePro.REPRESENTANT_LEGAL?t.modeles.TypeSignataire.REPRESENTANT_LEGAL:e===t.modeles.TypeSignatairePro.DELEGATAIRE?t.modeles.TypeSignataire.DELEGATAIRE:e===t.modeles.TypeSignatairePro.MANDATAIRE?t.modeles.TypeSignataire.MANDATAIRE:e===t.modeles.TypeSignatairePro.SIGNATAIRE_LEGAL?t.modeles.TypeSignataire.SIGNATAIRE_LEGAL:t.modeles.TypeSignataire.AUTRE},r.prototype.createSignatairePro=function(e,n){return{numeroPersonne:e.identifiantPersonne,role:this.getTypeSignatairePro(n),rang:1,codeLienPersonne:e.codeTypeLienInterPersonnes,nom:this.getLibellePersonnePro(e),prenom:e.prenom,nomUsage:e.nomUsage,nomFamille:e.nomFamille,designataire:this.getLibelleDesignataire(e.codeTypeLienInterPersonnes,n),typePersonne:t.modeles.TypePersonne.PHYSIQUE,situationFamille:e.codeTypeSituationFamille,dateNaissance:new Date(e.dateNaissance),codePersonnaliteJuridique:e.codeCapaciteJuridique?e.codeCapaciteJuridique.toString():void 0,codeFamilleLiensInterPersonnes:e.codeFamilleLiensInterPersonnes,codeRoleDossierVente:this.getCodeRoleDossierVente(""+e.identifiantPersonne,n),isSelectionne:e.isSelectionne,isSelectionnable:e.isSelectionnable,disabled:!e.isSelectionnable,checked:e.isSelectionne,montantAutorisationSignataire:e.montantAutorisationSignataire}},r.prototype.initTableauPro=function(){var i=this;this.roleFiltre=new n.RoleComparator(this.$filter,this.$parse),this.tableauColonneOptionsQualite.comparator=this.roleFiltre,this.signatairesListe=[].concat(this.signataireReponse.titulaires.personnes.map(function(e){return i.createSignatairePro(e,t.modeles.TypeSignataire.TITULAIRE)})).concat(this.signataireReponse.representantsLegaux.personnes.map(function(e){return i.createSignatairePro(e,t.modeles.TypeSignataire.REPRESENTANT_LEGAL)})).concat(this.signataireReponse.signatairesLegaux.personnes.map(function(e){return i.createSignatairePro(e,t.modeles.TypeSignataire.SIGNATAIRE_LEGAL)})).concat(this.signataireReponse.mandataires.personnes.map(function(e){return i.createSignatairePro(e,t.modeles.TypeSignataire.MANDATAIRE)})).concat(this.signataireReponse.delegataires.personnes.map(function(e){return i.createSignatairePro(e,t.modeles.TypeSignataire.DELEGATAIRE)})),e.comContract.Loggers.info(r.CLASS_NAME,"initTableauPro","signatairesListe %o",this.signatairesListe),this.tableauSignatairesPro.data=this.signatairesListe,this.verifierPresenceModeOperationsFinancieres(this.donneesEntree)||this.tableauSignatairesPro.columns.push(this.tableauColonneOptionsFinance),1===this.signatairesListe.length?this.signatairesListe[0].isSelectionnable?(this.signatairesListe[0].checked=!0,this.signatairesListe[0].isSelectionne=!0,this.ajoutSignataireNgModelPro(this.signatairesListe[0]),this.controlerMinMax(),this.messageInfo=e.comContract.Enums.MessageInfo.UNE_PERSONNE):this.messageInfo=e.comContract.Enums.MessageInfo.AUCUN:this.setMessageInfo(),this.tableauSignatairesPro.selectedItems=this.signatairesListe.filter(function(e){return e.isSelectionne})},r.prototype.setMessageInfo=function(t){this.messageInfo=t?this.signataireReponse.libelleRegle:e.comContract.Enums.MessageInfo.CAS_PARTICULIER},r.prototype.getLibellePersonnePro=function(e){return this.getLibelleCivilite(e.codeCivilite)+" "+((e.nomUsage?e.nomUsage+" ("+e.nomFamille+")":e.nomFamille)+" "+e.prenom+" ").toUpperCase()},r.prototype.onSelectionChange=function(e){var t=this,n=e.isSelectionne;e.isSelectionne=e.checked,e.checked?(this.tableauSignatairesPro.selectedItems.length>=this.signataireReponse.maxSignataire&&this.signatairesListe.filter(function(e){return!e.isSelectionne}).forEach(function(e){return e.disabled=!0}),n||this.ajoutSignataireNgModelPro(angular.copy(e))):(this.signatairesListe.filter(function(e){return e.isSelectionnable}).forEach(function(e){return e.disabled=!1}),_.remove(this.ngModel,function(n){return n.numeroPersonne===e.numeroPersonne&&n.role===t.getTypeSignataireCommun(e.role)&&n.codeLienPersonne===e.codeLienPersonne})),this.controlerMinMax(),this.gestionPrecisionSignataire(),this.onChangeReferenceIdentite(),this.notifierChangement()},r.prototype.ajoutSignataireNgModelPro=function(n){var i={numeroPersonne:n.numeroPersonne,role:this.getTypeSignataireCommun(n.role),rang:n.rang,codeLienPersonne:n.codeLienPersonne,nom:n.nom,prenom:n.prenom,nomUsage:n.nomUsage,nomFamille:n.nomFamille,designataire:n.designataire,typePersonne:n.typePersonne,situationFamille:n.situationFamille,dateNaissance:n.dateNaissance,codePersonnaliteJuridique:n.codePersonnaliteJuridique,codeFamilleLiensInterPersonnes:n.codeFamilleLiensInterPersonnes,codeRoleDossierVente:n.codeRoleDossierVente};i.role===t.modeles.TypeSignataire.DELEGATAIRE&&(i.montantAutorisationSignataire=n.montantAutorisationSignataire),this.ngModel.length>0&&n.numeroPersonne===parseInt(this.identifiantPersonne)?(e.comContract.Loggers.info(r.CLASS_NAME,"ajoutSignataireNgModelPro","unshift personne %o",n),this.ngModel.unshift(n)):(e.comContract.Loggers.info(r.CLASS_NAME,"ajoutSignataireNgModelPro","push newSignataire %o",i),this.ngModel.push(i))},r.CLASS_NAME="myway.comContract.signataire.ListeDesignatairesController",r.$inject=["$scope","$filter","$parse","$q","$timeout","serviceAgentExtended","SignataireService","contractCommunService"],r}();n.ListeDesignatairesController=r,t.app.controller("ListeDesignatairesController",r),t.app.filter("financement",[function(){return function(e){return null!==e&&e>=0?e.toLocaleString().replace(/\B(?=(\d{3})+(?!\d))/g,",")+" €":""}}]),t.app.filter("roleSignataire",[function(){return function(e){return e===t.modeles.TypeSignatairePro.TITULAIRE?"Titulaire":e===t.modeles.TypeSignatairePro.REPRESENTANT_LEGAL?"Répresentant Légal":e===t.modeles.TypeSignatairePro.SIGNATAIRE_LEGAL?"Signataire Légal":e===t.modeles.TypeSignatairePro.DELEGATAIRE?"Délégataire":e===t.modeles.TypeSignatairePro.MANDATAIRE?"Mandataire":"Autre"}}])}(n=t.signataire||(t.signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";!function(e){e[e.DESACTIVE=0]="DESACTIVE",e[e.PARAMETRAGE_SPECIFIQUE_OF1=1]="PARAMETRAGE_SPECIFIQUE_OF1",e[e.PARAMETRAGE_SPECIFIQUE_OF2=2]="PARAMETRAGE_SPECIFIQUE_OF2",e[e.PARAMETRAGE_SPECIFIQUE_OF3=3]="PARAMETRAGE_SPECIFIQUE_OF3",e[e.INCONNU=void 0]="INCONNU"}(e.ModeOperationsFinancieresEnum||(e.ModeOperationsFinancieresEnum={}));e.ModeOperationsFinancieresEnum}(t=e.signataire||(e.signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";!function(e){e[e.OBLIGATOIRE_FOCUS=1]="OBLIGATOIRE_FOCUS",e[e.FACULTATIVE_FOCUS=2]="FACULTATIVE_FOCUS",e[e.CACHEE=3]="CACHEE",e[e.OBLIGATOIRE=4]="OBLIGATOIRE",e[e.FACULTATIVE=5]="FACULTATIVE",e[e.INCONNU=void 0]="INCONNU"}(e.ReferenceIdentiteEnum||(e.ReferenceIdentiteEnum={}));e.ReferenceIdentiteEnum}(t=e.signataire||(e.signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.ReglesSignataires||(e.ReglesSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function t(e,t,n,r){this.$q=e,this.serviceAgentExtended=t,this.restClient=n,this.communService=r,this.RESSOURCE_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/dossiernumerique/v3/signataire/v4",this.signatairesSelectionnes=[]}return t.prototype.getSignataires=function(n){var r=this;return e.comContract.Loggers.info(t.CLASS_NAME,"getSignataires","signataireInput %o",n),this.serviceAgentExtended.Habilitation.EstHabilite("SHEQ24").then(function(e){return r.restClient.get(r.RESSOURCE_URL,r.map(n,e))})},t.prototype.map=function(e,t){var n=e.listeProduitService?e.listeProduitService.map(function(e){return e.codeTypeProduitService}):[],r={identifiantEntiteTitulaire:e.identifiantEntiteTitulaire,codeCanal:e.codeCanal,codeActeGestion:e.codeActeGestion,identifiantPersonne:e.identifiantPersonne,codeTypePSCompteSupport:e.codeTypePSCompteSupport,codePSCompteSupport:e.codePSCompteSupport,codeGuichetCompteSupport:e.codeGuichetCompteSupport,listeCodeTypeProduitService:n,modeOperationFinanciere:e.modeOperationsFinancieres,codeEtablissement:e.codeEtablissement,isPro:e.isPro,isModeReprise:e.isModeReprise,casParticulier:e.casParticulier,idPersonnesPreSelectionnees:e.idPersonnesPreSelectionnees,isHabilitedSHEQ24:t};return(null==r.casParticulier||null===r.casParticulier||void 0===!r.casParticulier)&&delete r.casParticulier,null==r.identifiantPersonne&&delete r.identifiantPersonne,
null==r.codeTypePSCompteSupport&&delete r.codeTypePSCompteSupport,null==r.codePSCompteSupport&&delete r.codePSCompteSupport,null==r.codeGuichetCompteSupport&&delete r.codeGuichetCompteSupport,null==r.modeOperationFinanciere&&delete r.modeOperationFinanciere,null==r.codeActeGestion&&delete r.codeActeGestion,null==r.identifiantEntiteTitulaire&&delete r.identifiantEntiteTitulaire,null==r.codeEtablissement&&delete r.codeEtablissement,(null==r.isPro||void 0===!r.isPro)&&delete r.isPro,r},t.CLASS_NAME="myway.comContract.signataire.SignataireService",t.$inject=["$q","serviceAgentExtended","restClient","contractCommunService"],t}();n.SignataireService=r,t.app.service("SignataireService",r)}(n=t.signataire||(t.signataire={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.FF="FF",e}();e.CodeCanal=t}(t=e.Enums||(e.Enums={}))}(t=e.OPC||(e.OPC={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.FAFGXML="FAFGXML",e.FAFG="FAFG",e}();e.ModeContractualisation=t}(t=e.Enums||(e.Enums={}))}(t=e.OPC||(e.OPC={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.OPERATION_FINANCIERE="OPERATION_FINANCIERE",e.REMISE_CARTE_TEMPO="REMISE_CARTE_TEMPO",e.REMISE_CARTE_BANCAIRE="REMISE_CARTE_BANCAIRE",e.VISITE_COFFRE="VISITE_COFFRE",e.OPPOSITION_CARTE_BANCAIRE="OPPOSITION_CARTE_BANCAIRE",e.VIREMENT_IMMEDIAT="VIREMENT_IMMEDIAT",e.VIREMENT_INTERNE="VIREMENT_INTERNE",e.VIREMENT_INTERNATIONAL="VIREMENT_INTERNATIONAL",e.ECHEANCIER_VIREMENT_SEPA="ECHEANCIER_VIREMENT_SEPA",e.ECHEANCIER_VIREMENT_INTERNATIONAL="ECHEANCIER_VIREMENT_INTERNATIONAL",e.AVENANT_ECHEANCIER_VIREMENT_SEPA="AVENANT_ECHEANCIER_VIREMENT_SEPA",e.AVENANT_ECHEANCIER_VIREMENT_INTERNATIONAL="AVENANT_ECHEANCIER_VIREMENT_INTERNATIONAL",e.CLOTURE_ECHEANCIER_VIREMENT_SEPA="CLOTURE_ECHEANCIER_VIREMENT_SEPA",e.CLOTURE_ECHEANCIER_VIREMENT_INTERNATIONAL="CLOTURE_ECHEANCIER_VIREMENT_INTERNATIONAL",e.SUSPENSION_ECHEANCIER_VIREMENT_SEPA="SUSPENSION_ECHEANCIER_VIREMENT_SEPA",e.REACTIVATION_ECHEANCIER_VIREMENT_SEPA="REACTIVATION_ECHEANCIER_VIREMENT_SEPA",e}();e.TypeBordereau=t}(t=e.Enums||(e.Enums={}))}(t=e.OPC||(e.OPC={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.XML="XML",e.PDF="PDF",e}();e.TypeDocument=t}(t=e.Enums||(e.Enums={}))}(t=e.OPC||(e.OPC={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.DOSSIER_VENTE="002",e.COMPTE_SUPPORT_CONTRAT="004",e.CONTRAT_CARTE="005",e.CONTRAT_EXTERNE="012",e}();e.CodeTypeReferenceExterne=t}(t=e.Ennums||(e.Ennums={}))}(t=e.VenteVpc||(e.VenteVpc={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.PAPIER="P",e.ELECTRONIQUE="E",e.INTERNET="D",e}();e.ModeSignature=t}(t=e.VenteVpc||(e.VenteVpc={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.prototype.createContractualisationParametreInput=function(e,t,n,r,i,o,a,s,c){var u={numeroPersonne:a[0].numeroPersonne,identifiantJustificatifIdentite:a[0].identifiantJustificatifIdentite},l=[];_.forEach(s,function(e){var t={codeDevise:"",montant:""};null!=t.montant&&"0"!==t.montant&&(t.codeDevise=e.codeDevise,t.montant=e.montant,l.push(t))});var E=[];return _.forEach(c,function(e){var t={type:null,rang:null,modeContractualisation:null};t.type=e.type,null!=t.type&&E.push(t)}),{codeActeGestionPrincipal:t,codeMaterielCompatible:["ECTAS"],codeNatureAppelQr:"C",indicateurPresenceLecteurCarte:!1,indicateurPresenceTablette:!0,indicateurTraitementImpression:!1,numeroEntiteTitulaire:null,numeroPersonne:""+e,listeActeGestionSecondaire:null,codeCanal:r,listeSignataires:[u],listeMontantOperation:l,listeMateriels:E}},e}();e.ContractualisationParametreInputFactory=t}(t=e.DocumentParametre||(e.DocumentParametre={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.OPC||(e.OPC={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL_CONTRACTUALISATION="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/documentparametre/v2/ContractualisationParametre",e.RESSOURCE_REST_URL_DOCUMENT="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/documentparametre/v2/DocumentParametre",e}();e.DocumentParametreConstantes=t}(t=e.DocumentParametre||(e.DocumentParametre={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.OPC||(e.OPC={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){var n;!function(t){"use strict";var n=function(){function e(){}return e.prototype.create=function(e){return{url:t.DocumentParametreConstantes.RESSOURCE_REST_URL_CONTRACTUALISATION,withHeaders:!0,data:e,method:MyWay.Services.MethodEnum.POST,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},e}();t.ContractualisationParametreRequestFactory=n;var r=function(){function n(){}return n.prototype.create=function(r,i,o,a){return a||e.comContract.Loggers.warn(n.CLASS_NAME,"create","information codeTypeMarcheDocumentEntreprise absente"),{url:t.DocumentParametreConstantes.RESSOURCE_REST_URL_DOCUMENT,withHeaders:!0,params:{listeActes:r,codeCanal:i,codeModeMiseGestion:o,codeTypeMarcheDocumentEntreprise:a},method:MyWay.Services.MethodEnum.GET,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},n.CLASS_NAME="myway.comContract.OPC.Ressources.DocumentParametre.DocumentParametreRequestFactory",n}();t.DocumentParametreRequestFactory=r}(n=t.DocumentParametre||(t.DocumentParametre={}))}(n=t.Ressources||(t.Ressources={}))}(n=t.OPC||(t.OPC={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers/v1/particulierInformation/",e}();e.ParticulierInformationConstants=t}(t=e.ParticulierInformation||(e.ParticulierInformation={}))}(t=e.Ressource||(e.Ressource={}))}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.ParticulierInformation||(e.ParticulierInformation={}))}(t=e.Ressource||(e.Ressource={}))}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.prototype.create=function(t,n){return{url:e.ParticulierInformationConstants.RESSOURCE_REST_URL,withHeaders:!0,params:{codeEtablissement:t,idPersonne:n},method:MyWay.Services.MethodEnum.GET,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t}();e.ParticulierInformationRequestFactory=t}(t=e.ParticulierInformation||(e.ParticulierInformation={}))}(t=e.Ressource||(e.Ressource={}))}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/dossiernumerique/v3/signatureEnInstance/",e}();e.SignatureEnInstanceConstants=t}(t=e.SignatureEnInstance||(e.SignatureEnInstance={}))}(t=e.Ressource||(e.Ressource={}))}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.SignatureEnInstance||(e.SignatureEnInstance={}))}(t=e.Ressource||(e.Ressource={}))}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.prototype.create=function(t,n){return{url:e.SignatureEnInstanceConstants.RESSOURCE_REST_URL,withHeaders:!0,params:{codeApplication:t,idDossierNumerique:n},method:MyWay.Services.MethodEnum.GET,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t}();e.SignatureEnInstanceRequestFactory=t}(t=e.SignatureEnInstance||(e.SignatureEnInstance={}))}(t=e.Ressource||(e.Ressource={}))}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/tiers/v3/tiersNoyau/",e}();e.TiersNoyauConstants=t}(t=e.TiersNoyau||(e.TiersNoyau={}))}(t=e.Ressource||(e.Ressource={}))}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict"}(t=e.TiersNoyau||(e.TiersNoyau={}))}(t=e.Ressource||(e.Ressource={}))}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.prototype.create=function(t,n){return{url:e.TiersNoyauConstants.RESSOURCE_REST_URL,withHeaders:!0,params:{codeEtablissement:t,identifiantPersonne:n},method:MyWay.Services.MethodEnum.GET,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t}();e.TiersNoyauRequestFactory=t}(t=e.TiersNoyau||(e.TiersNoyau={}))}(t=e.Ressource||(e.Ressource={}))}(t=e.RecapSignataires||(e.RecapSignataires={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.prototype.create=function(t,n,r,i){return{libelleActe:this.getLibelleActe(t.libelleActe),codeActeGestion:t.codeActeGestion,numeroEntiteTitulaire:t.numeroEntiteTitulaire,codeCanal:t.codeCanal,codeModeMiseGestion:t.codeModeMiseGestion,codeTypeMarcheEntreprise:t.codeTypeMarcheEntreprise,identifiantActeIDN:t.identifiantActeIDN,codeGuichet:null,topFAFGXML:null,identifiantActeExterne:t.identifiantActeExterne,identifiantAgence:null,identifiantAgent:i,referenceContrat:null,referenceActeProducteur:null,codeEntite:null,referenceOffre:null,referenceContratCarte:null,listeDocumentAProduire:null,listeModeContractualisation:null,listeActeSecondaires:t.listeActeSecondaires,listeSignatairesActe:(new e.SignataireActeFactory).createListeSignatairesActeFromListeSignataire(n),listeTitulairesActe:(new e.TitulaireActeFactory).createListeTitulairesActeFromListeTitulaires(r),codeTypeProduit:null,listeOperationFinanciere:(new e.OperationFinanciereFactory).createListeOperationsFinanaciere(t.listeModeOperationsFinanciere),referenceEDSInterneClient:null,referenceEDSExterneClient:null,nbPersonneEntiteTitulaire:null,indicateurActeIDNExistant:this.getIndicateurActeIDNExistant(t.identifiantActeIDN,t.indicateurActeIDNExistant),acteGestionCompteSupport:null,numeroOffreVMC:null,identifiantAgentConseiller:t.identifiantAgentConseiller,signatureAgentEmail:null!=t.signatureAgentEmail?t.signatureAgentEmail.valueOf():null,destinataireEmailConseiller:null!=t.destinataireEmailConseiller?t.destinataireEmailConseiller.valueOf():null,codeFamilleGestionLocaleContrat:t.codeFamilleGestionLocaleContrat,remiseDocViaDossierPartage:t.remiseDocViaDossierPartage,codeTypeSousMarcheDocEntreprise:t.codeTypeSousMarcheDocEntreprise,contratExterne:t.contratExterne}},t.prototype.getIndicateurActeIDNExistant=function(e,t){return null!=e?!0:t?t:!1},t.prototype.getLibelleActe=function(e){return null!=e?e.replace(/\./g,""):null},t}();e.ActeGestionFactory=t}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/dossiernumerique/v3/contractualisationActe/",e}();e.ContractualisationActeConstants=t}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.prototype.createContractualisationActe=function(e,t,n,r,i,o,a,s,c){return{indicateurPapier:e,acteGestion:t,listeMateriels:r,surchargeNonEligibilite:i,motifNonEligibiliteSAGSED:o,listePiecesIdentiteManquantes:null,typeProfessionnel:a,isDeployeMySign:s,isDeployeSEMD:c,codeProcessusMetier:null,isDeployeBulleConfiance:null,isDerniereLiasse:null,isOffreMixte:null}},e}();e.ContractualisationActeFactory=t}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.prototype.create=function(t,n,r,i,o,a,s,c,u){return angular.isUndefined(t)&&(t=null),angular.isUndefined(n)&&(n=null),angular.isUndefined(i)&&(i=null),angular.isUndefined(r)&&(r=null),angular.isUndefined(u)&&(u=null),{acteGestion:(new e.ActeGestionFactory).create(t,n,i,c),listeMateriels:r,surchargeNonEligibilite:o,typeProfessionnel:t.typeProfessionnel,libelleMotifNonEligibProducteur:u,isDeployeMySign:s,isDeployeSEMD:a}},t}();e.ContractualisationActeInputFactory=t}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){this.methode=e,this.contractualisationActeInput=t}return t.prototype.create=function(){return{url:e.ContractualisationActeConstants.RESSOURCE_REST_URL,data:this.contractualisationActeInput,withHeaders:!0,method:this.methode,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON,timeout:7e4}},t}();e.ContractualisationActeRequestFactory=t}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.createMotifNonEligibiliteSAGSED=function(e,t){return{libelleNonEligibilite:t,codeNonEligibilite:e}},e}();e.MotifNonEligibiliteSAGSEDFactory=t}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.prototype.createOperationFinanciere=function(e){return null!=e?{numeroPersonne:null,libelleClientOperation:null,libelleCompteOperation:null,dateOperation:null,montantOperation:null,natureOperation:null,modeVersementOpeFinanciere:e}:null},e.prototype.createListeOperationsFinanaciere=function(e){var t=this,n=[];return _.forEach(e,function(e){n.push(t.createOperationFinanciere(e))}),n},e}();e.OperationFinanciereFactory=t}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(n){"use strict";var r=function(){function r(){}return r.prototype.createSignataireActeFromSignataire=function(t){if(null!=t){e.comContract.Loggers.info(r.CLASS_NAME,"createSignataireActeFromSignataire","signataire %o",t);var n=this.switchCodeRole(t.role);return e.comContract.Loggers.info(r.CLASS_NAME,"createSignataireActeFromSignataire","codeRole %o",n),{numeroSignataire:_.padLeft(t.numeroPersonne+"",9,"0"),identifiantJustificatifIdentite:null,adresseMailSign:t.adresseMail,rangSignataire:t.rang,codeTypeSignataire:null,codeRoleSignataire:n,nomSignataire:t.nomFamille,prenomSignataire:t.prenom,moyenAuthentificationICG:t.moyenAuthentificationICG,numeroTelephonePortable:t.numeroTelephonePortable,infoComplementaire:t.infoComplementaire,civiliteSignataire:t.civiliteSignataire,numUsagerBAD:t.numUsagerBAD}}return null},r.prototype.createListeSignatairesActeFromListeSignataire=function(e){var t=this,n=[];return _.forEach(e,function(e){n.push(t.createSignataireActeFromSignataire(e))}),n},r.prototype.switchCodeRole=function(e){return n.CodeRoleSignataire[t.modeles.TypeSignataire[e]]},r.CLASS_NAME="myway.comContract.Modeles.SignataireActeFactory",r}();n.SignataireActeFactory=r}(n=t.ContractualisationActe||(t.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.prototype.createTitulaireActeFromTitulaire=function(e){return{numeroPersonne:_.padLeft(e.numeroPersonne,9,"0"),adresseMail:e.adresseMail,nom:e.nom,prenom:e.prenom,civilite:e.civilite}},e.prototype.createListeTitulairesActeFromListeTitulaires=function(e){var t=this,n=[];return _.forEach(e,function(e){n.push(t.createTitulaireActeFromTitulaire(e))}),n},e}();e.TitulaireActeFactory=t}(t=e.ContractualisationActe||(e.ContractualisationActe={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/dossiernumerique/v3/dossierNumerique",e.RESSOURCE_REST_URL_BASCULER_VERS_DOSSIER_PAPIER="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/dossiernumerique/v3/dossierNumerique/basculerVersDossierPapier",e}();e.DossierNumeriqueConstants=t}(t=e.DossierNumerique||(e.DossierNumerique={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.prototype.postDossierNumeriqueRequest=function(t){return{url:e.DossierNumeriqueConstants.RESSOURCE_REST_URL,data:t,withHeaders:!0,method:MyWay.Services.MethodEnum.POST,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON,timeout:7e4}},t.prototype.putDossierNumeriqueRequest=function(t){return{url:e.DossierNumeriqueConstants.RESSOURCE_REST_URL,data:t,withHeaders:!0,method:MyWay.Services.MethodEnum.PUT,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON,timeout:7e4}},t.prototype.deleteDossierNumeriqueRequest=function(t,n,r,i,o){return{url:e.DossierNumeriqueConstants.RESSOURCE_REST_URL,withHeaders:!0,params:{idDossierNumerique:t,codeApplication:n,isDeployMySign:r,referenceActe:i,typeReferenceActe:o},method:MyWay.Services.MethodEnum.DELETE,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t.prototype.getDossierNumeriqueRequest=function(t,n,r,i,o,a,s,c){return{url:e.DossierNumeriqueConstants.RESSOURCE_REST_URL,withHeaders:!0,params:{idDossierNumerique:t,codeApplication:n,avecDocuments:r,avecReferences:i,avecEmplacementsSignatures:o,avecBinaires:a,avecSignataires:s,avecTitulaires:c},method:MyWay.Services.MethodEnum.GET,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t.prototype.basculerDossierVersPapier=function(t,n,r){return{url:e.DossierNumeriqueConstants.RESSOURCE_REST_URL_BASCULER_VERS_DOSSIER_PAPIER,withHeaders:!0,params:{idDossierNumerique:t,codeApplication:n,isDeployMySign:r},method:MyWay.Services.MethodEnum.POST,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t}();e.DossierNumeriqueRequestFactory=t}(t=e.DossierNumerique||(e.DossierNumerique={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/dossiernumerique/v3/signature/",e.RESSOURCE_REST_URL_SESSION_SIGNATURE="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/dossiernumerique/v3/signature/sessionSignature",e.RESSOURCE_REST_URL_TRANSACTION_ICG="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/dossiernumerique/v3/signature/transactionIcg",e.RESSOURCE_REST_URL_MAIL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/dossiernumerique/v3/signature/mail",e}();e.SignatureConstants=t}(t=e.Signature||(e.Signature={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.prototype.deleteTransactionIcgRequest=function(t,n,r,i,o){return{url:e.SignatureConstants.RESSOURCE_REST_URL_TRANSACTION_ICG,withHeaders:!0,params:{isDeployeMySign:t,idTransactionIcg:n,annulerDossiersConcernes:r,idPersonne:i,codeAction:o},method:MyWay.Services.MethodEnum.DELETE,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t.prototype.postSignatureRequest=function(t){return{url:e.SignatureConstants.RESSOURCE_REST_URL,data:t,withHeaders:!0,method:MyWay.Services.MethodEnum.POST,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON,timeout:7e4}},t.prototype.postSessionSignatureRequest=function(t){return{url:e.SignatureConstants.RESSOURCE_REST_URL_SESSION_SIGNATURE,data:t,withHeaders:!0,method:MyWay.Services.MethodEnum.POST,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON,timeout:7e4}},t.prototype.putSessionSignatureRequest=function(t){return{url:e.SignatureConstants.RESSOURCE_REST_URL_SESSION_SIGNATURE,data:t,withHeaders:!0,method:MyWay.Services.MethodEnum.PUT,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON,timeout:7e4}},t.prototype.postMail=function(t){return{url:e.SignatureConstants.RESSOURCE_REST_URL_MAIL,data:t,withHeaders:!0,method:MyWay.Services.MethodEnum.POST,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON,timeout:7e4}},t}();e.SignatureRequestFactory=t}(t=e.Signature||(e.Signature={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/dossiernumerique/v3/dossierNumerique/documentsAttributaire",e}();e.DocumentsAttributaireConstants=t}(t=e.DocumentsAttributaire||(e.DocumentsAttributaire={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.prototype.create=function(t,n){return{url:e.DocumentsAttributaireConstants.RESSOURCE_REST_URL,withHeaders:!0,params:{idDossierNumerique:t,codeApplication:n},method:MyWay.Services.MethodEnum.GET,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t}();e.GetDocumentsAttributaireRequestFactory=t}(t=e.DocumentsAttributaire||(e.DocumentsAttributaire={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){this.methode=e,this.documentsAttributaireInput=t}return t.prototype.create=function(){return{url:e.DocumentsAttributaireConstants.RESSOURCE_REST_URL,data:this.documentsAttributaireInput,withHeaders:!0,method:this.methode,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t}();e.PutDocumentsAttributaireRequestFactory=t}(t=e.DocumentsAttributaire||(e.DocumentsAttributaire={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(t){var n;!function(t){"use strict";var n=function(){function t(){}return t.prototype.createActeGestion=function(e,n,r,i,o,a,s,c,u,l,E,g,S,m,C,p,d){return{acteGestionClasseurClient:e,acteGestionArcade:E,topActeGestionPrincipal:this.getTopActeGestionPrincipal(S),idOffre:i,compte:m,codeIPR:o,isMAJDrcDemandee:"O",nodapeTitulaire:g,codeAgent:s,codeEtablissement:p,codeClientBancaire:a,referenceInterneEDS:c,codeTypeEDS:C,referenceExterneEDS:u,codeApplication:t.CODE_APPLICATION,codeGuichet:l,codeCanal:r,idIDN:n,modeContract:this.getModeContract(r),typeDRC:"",listeReferenceExterne:this.getListeReferenceExterne(d)}},t.prototype.createListeActeGestion=function(e,t,n,r,i,o,a,s,c,u,l,E,g,S,m,C,p,d){var A=this;null==t&&(t=[]),null!=S&&(t.push(S),_.uniq(t));var f=[];return f.push(this.createActeGestion(e,n,r,i,o,a,s,c,u,l,E,g,!0,m,C,p,d)),_.forEach(t,function(e){f.push(A.createActeGestion(e,n,r,i,o,a,s,c,u,l,E,g,!1,m,C,p,d))}),f},t.prototype.getTopActeGestionPrincipal=function(e){return e?"O":"N"},t.prototype.getModeContract=function(t){return t===e.Enums.CodeCanalVente.FACE_A_FACE?e.Enums.ModeContractualisation.FAFE:t===e.Enums.CodeCanalVente.MOBILITE?e.Enums.ModeContractualisation.FFPE:t===e.Enums.CodeCanalVente.INTERNET?e.Enums.ModeContractualisation.VELD:e.Enums.ModeContractualisation.VADE},t.prototype.getListeReferenceExterne=function(e){var n=null;if(null!==e){n=[];var r={identifiantReferenceExterne:e,typeReferenceExterne:t.TYPE_REFERENCE_EXTERNE_DOSSIER_VENTE};n.push(r)}return n},t.CODE_APPLICATION="MYWAY",t.TYPE_REFERENCE_EXTERNE_DOSSIER_VENTE="002",t}();t.ActeGestionFactory=n}(n=t.DossierCanalNumerique||(t.DossierCanalNumerique={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/classeurclient/v1/dossierCanalNumerique/",e}();e.DossierCanalNumeriqueConstants=t}(t=e.DossierCanalNumerique||(e.DossierCanalNumerique={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){this.methode=e,this.dossierCanalNumeriqueInput=t}return t.prototype.create=function(){return{url:e.DossierCanalNumeriqueConstants.RESSOURCE_REST_URL,data:this.dossierCanalNumeriqueInput,withHeaders:!0,method:this.methode,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t}();e.DossierCanalNumeriqueRequestFactory=t}(t=e.DossierCanalNumerique||(e.DossierCanalNumerique={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.prototype.createCodeEvenementMetierFromCodeActeGestion=function(e){return null!=e?{code:e}:null},e.prototype.createListeCodeEvenementMetierFromListeActeSecondaires=function(e){var t=this;if(null!=e){var n=[];return _.forEach(e,function(e){n.push(t.createCodeEvenementMetierFromCodeActeGestion(e))}),n}return null},e}();e.CodeEvenementMetierFactory=t}(t=e.DossierContrat||(e.DossierContrat={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(){}return t.prototype.createDossierContrat=function(n,r,i,o,a,s,c,u,l,E,g){return{codeEtablissement:n,codeGuichet:o,clientBancaire:parseInt(a),identifiantContrat:s,codeElementDeStructure:c,codeApplication:t.CODE_APPLICATION,referenceExterneEDS:u,codeEvenementMetierPrincipal:(new e.CodeEvenementMetierFactory).createCodeEvenementMetierFromCodeActeGestion(i),listCodeEvenementMetier:(new e.CodeEvenementMetierFactory).createListeCodeEvenementMetierFromListeActeSecondaires(l),nbPersonneEntiteTitulaire:E,codeModeContractualisation:r,listeReferenceExterne:this.getListeReferenceExterne(g)}},t.prototype.getListeReferenceExterne=function(e){var n=null;if(null!==e){n=[];var r={identifiantReferenceExterne:e,typeReferenceExterne:t.TYPE_REFERENCE_EXTERNE_DOSSIER_VENTE};n.push(r)}return n},t.CODE_APPLICATION="MYWAY",t.TYPE_REFERENCE_EXTERNE_DOSSIER_VENTE="002",t}();e.DossierContratFactory=t}(t=e.DossierContrat||(e.DossierContrat={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/classeurclient/v1/dossierContrat/",e}();e.DossierContratConstants=t}(t=e.DossierContrat||(e.DossierContrat={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){this.methode=e,this.dossierContratInput=t}return t.prototype.create=function(){return{url:e.DossierContratConstants.RESSOURCE_REST_URL,data:this.dossierContratInput,withHeaders:!0,method:this.methode,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t}();e.DossierContratRequestFactory=t}(t=e.DossierContrat||(e.DossierContrat={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/classeurclient/v1/dossierContratServi/",e}();e.DossierContratServiConstants=t}(t=e.DossierContratServi||(e.DossierContratServi={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function t(e,t){this.methode=e,this.dossierContratServiceInput=t}return t.prototype.create=function(){return{url:e.DossierContratServiConstants.RESSOURCE_REST_URL,data:this.dossierContratServiceInput,withHeaders:!0,method:this.methode,responseType:MyWay.Services.ResponseTypeEnum.JSON,contentType:MyWay.Services.ContentTypeEnum.JSON}},t}();e.DossierContratServiRequestFactory=t}(t=e.DossierContratServi||(e.DossierContratServi={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(t){var n;!function(t){var n;!function(t){"use strict";!function(e){e[e.PRINCIPAL=1]="PRINCIPAL",e[e.SECONDAIRE=0]="SECONDAIRE"}(t.TypeActeEnum||(t.TypeActeEnum={}));var n=t.TypeActeEnum,r=function(){function t(){}return t.prototype.createDossierContratServiceInputFromActe=function(e,n,r,i,o,a,s){return null!=e?(null==e.listeActeSecondaires&&(e.listeActeSecondaires=[]),null!=e.acteGestionCompteSupport&&(e.listeActeSecondaires.push(e.acteGestionCompteSupport),e.listeActeSecondaires=_.uniq(e.listeActeSecondaires)),{codeEtablissement:r,codeAgent:parseInt(e.identifiantAgent,10),appOrigine:t.CODE_APPLICATION,agentEDS:this.getAgentEds(e.identifiantAgent,e.referenceEDSExterneClient),codeCanal:e.codeCanal,
creationDossier:t.CREATION_DOSSIER,idActe:e.identifiantActeIDN,dateActe:null,listeReferenceExternes:this.getListeReferenceExterne(r,o,e.identifiantActeExterne,e.referenceContrat,e.referenceContratCarte,a,e.contratExterne),listeDocuments:this.getListeDocumentsDossierContratServi(e.codeActeGestion,s),listeActe:this.getListeActe(e,r,o),modeContractualisation:i}):null},t.prototype.createDossierContratServiceInputFromDossierNumerique=function(e,n,r,i,o,a,s,c,u,l,E,g,S,m,C,p,d){return null==i&&(i=[]),null!=o&&(i.push(o),_.uniq(i)),{codeEtablissement:g,codeAgent:a,appOrigine:t.CODE_APPLICATION,agentEDS:this.getAgentEds(String(a),String(s)),codeCanal:p,creationDossier:t.CREATION_DOSSIER,idActe:c,dateActe:null,listeReferenceExternes:this.getListeReferenceExterne(g,m,u,l,null,C,null),listeDocuments:null!==d?d:[],listeActe:this.getListeActeFromDossierNumerique(e,n,r,i,E,g,m,l),modeContractualisation:S}},t.prototype.getListeActeFromDossierNumerique=function(e,t,r,i,o,a,s,c){var u=this,l=null;return l=[],l.push(this.getActe(e,n.PRINCIPAL,null,c,o,this.getEntiteTitulaire(String(r)),t&&t.length?parseInt(t[0].numeroPersonne,10):null,null)),null!=i&&i.length>0&&_.forEach(i,function(e){l.push(u.getActe(e,n.SECONDAIRE,null,c,o,u.getEntiteTitulaire(String(r)),t&&t.length?parseInt(t[0].numeroPersonne,10):null,null))}),l},t.prototype.getListeActe=function(e,t,r){var i=this,o=null;return null!=e&&(o=[],o.push(this.getActe(e.codeActeGestion,n.PRINCIPAL,null,this.getIdentifiantContratFromActeGestion(e,t,r),parseInt(e.referenceOffre,10),this.getEntiteTitulaire(e.numeroEntiteTitulaire),parseInt(this.getIdentifiantPersonne(e.listeTitulairesActe),10),null)),null!=e.listeActeSecondaires&&e.listeActeSecondaires.length>0&&_.forEach(e.listeActeSecondaires,function(a){o.push(i.getActe(a,n.SECONDAIRE,null,i.getIdentifiantContratFromActeGestion(e,t,r),parseInt(e.referenceOffre,10),i.getEntiteTitulaire(e.numeroEntiteTitulaire),parseInt(i.getIdentifiantPersonne(e.listeTitulairesActe),10),null))})),o},t.prototype.getIdentifiantContratFromActeGestion=function(e,t,n){return e.referenceContrat!==e.referenceActeProducteur?this.getRice(e.referenceContrat,t,n):null},t.prototype.getRice=function(e,t,n){return e?e.length>11?e:t+n+_.padLeft(e,11,"0"):null},t.prototype.getAgentEds=function(e,t){return t?t:e},t.prototype.getEntiteTitulaire=function(e){return e?parseInt(e,10):null},t.prototype.getActe=function(e,t,n,r,i,o,a,s){return null!=e&&null!=t?{codeActe:e,actePrincipal:t,codeDossier:n,idContrat:r,idOffre:i,numeroPersonne:a,numeroEntiteTitulaire:o,numeroDossierVente:s}:null},t.prototype.getListeReferenceExterne=function(t,n,r,i,o,a,s){var c=[];if(r){var u={idReferenceExterieur:r,typeReferenceExterieur:e.comContract.VenteVpc.Ennums.CodeTypeReferenceExterne.DOSSIER_VENTE};c.push(u)}if(s){var u={idReferenceExterieur:s,typeReferenceExterieur:e.comContract.VenteVpc.Ennums.CodeTypeReferenceExterne.CONTRAT_EXTERNE};c.push(u)}if(o&&i&&null!==a){var l={idReferenceExterieur:t+n+_.padLeft(i,11,"0"),typeReferenceExterieur:e.comContract.VenteVpc.Ennums.CodeTypeReferenceExterne.COMPTE_SUPPORT_CONTRAT};c.push(l);var E={idReferenceExterieur:_.padLeft(a,9,"0"),typeReferenceExterieur:e.comContract.VenteVpc.Ennums.CodeTypeReferenceExterne.CONTRAT_CARTE};c.push(E)}return c},t.prototype.getListeDocumentsDossierContratServi=function(e,t){var n=[];return _.forEach(t,function(t){var r={codeActe:e,idDocument:t.idDocumentIdn,typeDocument:t.codeTypeDoc,typeAttributaire:t.codeTypeAttributaire,natureDocument:"",attributairePrincipal:t.idAttributaire,attributaireSecondaire:t.intituleAttributaire};n.push(r)}),n},t.prototype.getIdentifiantPersonne=function(e){return e&&e.length?e[0].numeroPersonne:null},t.CODE_APPLICATION="MYWAY",t.CREATION_DOSSIER="O",t}();t.DossierContratServiceInputFactory=r}(n=t.DossierContratServi||(t.DossierContratServi={}))}(n=t.Ressources||(t.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={}));var myway;!function(e){var t;!function(e){var t;!function(e){var t;!function(e){"use strict";var t=function(){function e(){}return e.RESSOURCE_REST_URL="http://myway-ressources-dua.sigcesie.caisse-epargne.fr:6083/dossiernumerique/v3/dossierNumerique/documentsAttributaire",e}();e.RecupererDocumentsIdnConstants=t}(t=e.RecupererDocumentsIdn||(e.RecupererDocumentsIdn={}))}(t=e.Ressources||(e.Ressources={}))}(t=e.comContract||(e.comContract={}))}(myway||(myway={})),angular.module("myway.comContract").run(["$templateCache",function(e){e.put("typescript/directives/recap-signataires/vues/recap-signataires-vue.html",'\r\n\r\n<div mw-chargement="rsCtrl.chargementCourtShow" id="identification-signataires-directive-chargement-long">\r\n    <mw-table options="rsCtrl.signatairesTableau" id="table-signataires" ng-if="rsCtrl.signatairesTableShow"></mw-table>\r\n    <span ng-show="rsCtrl.afficherMessageErreur" ng-bind="::rsCtrl.PB_RECAP_SIGNATAIRES" class="error-msg col-md-12"></span>\r\n</div>'),e.put("typescript/directives/signataires-document/vues/bloc-signataires.html",'\r\n<!-- Liste des Signataires -->\r\n    <div>\r\n        <span ng-show="!signatairesCtrl.isTabVcSelected" class="bold col-sm-12 col-md-12">Sélectionner les signataires</span>\r\n        <span ng-show="signatairesCtrl.isTabVcSelected" class="bold col-sm-12 col-md-12">Sélectionner les demandeurs</span>\r\n        \r\n        <span ng-show="signatairesCtrl.isPersonneProtegee(signatairesCtrl.signataireReponse.titulaires.personnes) && signatairesCtrl.chargementSansErreur" class="col-sm-12 col-md-12 italic">Sélectionner le(s) signataire(s) en fonction de la capacité juridique et de l\'acte en cours (se référer aux procédures internes)</span>\r\n\r\n        <!-- Titulaires -->\r\n        <section class="mw-input-check col-sm-12 col-md-12" ng-repeat="titulaire in signatairesCtrl.signataireReponse.titulaires.personnes track by $index">\r\n            <label data-for="id-checkbox-titulaire-{{ $index }}" data-id="id-label-titulaire-{{ $index }}" ng-class="{\'disabled\' : !titulaire.isSelectionnable}" ng-disabled="!titulaire.isSelectionnable">\r\n                <input data-id="id-checkbox-titulaire-{{ $index }}" type="checkbox" ng-model="titulaire.isSelectionne" ng-change="signatairesCtrl.onCheck($index, {{signatairesCtrl.typeSignataireEnum.TITULAIRE}})" aria-checked="{{ ::titulaire.isSelectionne }}" aria-labelledby="id-label-titulaire-{{ $index }}" ng-disabled="!titulaire.isSelectionnable">\r\n                <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\': titulaire.isSelectionne}"></span>\r\n                <span class="bold" ng-bind="signatairesCtrl.getLibellePersonne(titulaire)"></span><span>&nbsp- Titulaire -&nbsp</span>\r\n                <span ng-bind="::titulaire.codeCapaciteJuridique | capacite"></span>\r\n                <span class="decedee" ng-show="titulaire.dateDecesPersonne != null">Décédé(e)</span>\r\n            </label>\r\n        </section>\r\n\r\n        <!-- Representants Legaux -->\r\n        <section class="mw-input-check col-sm-12 col-md-12" ng-repeat="representant in signatairesCtrl.signataireReponse.representantsLegaux.personnes track by $index">\r\n            <label data-for="id-checkbox-representant-{{ $index }}" data-id="id-label-representant-{{ $index }}" ng-class="{\'disabled\' : !representant.isSelectionnable}" ng-disabled="!representant.isSelectionnable">\r\n                <input data-id="id-checkbox-representant-{{ $index }}" type="checkbox" ng-model="representant.isSelectionne" ng-change="signatairesCtrl.onCheck($index, {{signatairesCtrl.typeSignataireEnum.REPRESENTANT_LEGAL}})" aria-checked="{{ ::representant.isSelectionne }}" aria-labelledby="id-label-representant-{{ $index }}" ng-disabled="!representant.isSelectionnable">\r\n                <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\': representant.isSelectionne}"></span>\r\n                <span class="bold" ng-bind="signatairesCtrl.getLibellePersonne(representant)"></span> - Représentant Légal -\r\n                <span ng-bind="::representant.codeCapaciteJuridique | capacite"></span>\r\n                <span class="decedee" ng-show="representant.dateDecesPersonne != null">Décédé(e)</span>\r\n            </label>\r\n        </section>\r\n\r\n        <!-- Representants Legaux Pro-->\r\n        <section class="mw-input-check col-sm-12 col-md-12" ng-repeat="representantPro in signatairesCtrl.signataireReponse.representantsLegauxPro.personnes track by $index">\r\n            <!-- Representants Legaux Pro Personne Physique-->\r\n            <label ng-if="representantPro.codeTypePersonne === signatairesCtrl.codeTypePersonne.PHYSIQUE" data-for="id-checkbox-representant-pro-{{ $index }}" data-id="id-label-representant-pro-{{ $index }}" ng-class="{\'disabled\' : !representantPro.isSelectionnable}" ng-disabled="!representantPro.isSelectionnable">\r\n                <input data-id="id-checkbox-representant-pro-{{ $index }}" type="checkbox" ng-model="representantPro.isSelectionne" ng-change="signatairesCtrl.onCheck($index, {{signatairesCtrl.typeSignataireEnum.REPRESENTANT_LEGAL_PRO}})" aria-checked="{{ ::representantPro.isSelectionne }}" aria-labelledby="id-label-representant-pro-{{ $index }}" ng-disabled="!representantPro.isSelectionnable">\r\n                <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\': representantPro.isSelectionne}"></span>\r\n                <span class="bold" ng-bind="signatairesCtrl.getLibellePersonne(representantPro)"></span> - Représentant légal Pro -\r\n                <span ng-bind="::representantPro.codeCapaciteJuridique | capacite"></span>\r\n                <span class="decedee" ng-show="representantPro.dateDecesPersonne != null">Décédé(e)</span>\r\n            </label>\r\n\r\n            <!-- Representants Legaux Pro Personne Morale - Avec affichage des GMP-->\r\n            <div ng-if="signatairesCtrl.isShowBlocRLProPMWithGMP(signatairesCtrl.signataireReponse.titulaires.personnes,representantPro)">\r\n                <label data-for="id-checkbox-representant-pro-{{ $index }}" data-id="id-label-representant-pro-{{ $index }}">\r\n                    -&nbsp;<span class="bold" ng-bind="signatairesCtrl.getLibellePersonne(representantPro)"></span>\r\n                </label>\r\n                <div ng-if="signatairesCtrl.existGMPLie(representantPro)">\r\n                    <!-- Gestion Mesure Protection -->\r\n                    <section ng-if="gestionnaireMesureProtection.premierePersEnRelation===representantPro.identifiantPersonne" class="mw-input-check col-sm-12 col-md-12 mw-input-check-gmp" ng-repeat="gestionnaireMesureProtection in signatairesCtrl.signataireReponse.gestionnairesMesureProtection.personnes track by $index">\r\n                        <label data-for="id-checkbox-GMP-{{ $index }}" data-id="id-label-GMP-{{ $index }}" ng-class="{\'disabled\' : !gestionnaireMesureProtection.isSelectionnable}" ng-disabled="!gestionnaireMesureProtection.isSelectionnable">\r\n                            <input data-id="id-checkbox-GMP-{{ $index }}" type="checkbox" ng-model="gestionnaireMesureProtection.isSelectionne" ng-change="signatairesCtrl.onCheck($index, {{signatairesCtrl.typeSignataireEnum.GESTIONNAIRE_MESURE_PROTECTION}})" aria-checked="{{ ::gestionnaireMesureProtection.isSelectionne }}" aria-labelledby="id-label-GMP-{{ $index }}" ng-disabled="!gestionnaireMesureProtection.isSelectionnable">\r\n                            <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\': gestionnaireMesureProtection.isSelectionne}"></span>\r\n                            <span class="bold" ng-bind="signatairesCtrl.getLibellePersonne(gestionnaireMesureProtection)"></span> - Gestionnaire Mesures Protection -\r\n                            <span ng-bind="::gestionnaireMesureProtection.codeCapaciteJuridique | capacite"></span>\r\n                            <span class="decedee" ng-show="gestionnaireMesureProtection.dateDecesPersonne != null">Décédé(e)</span>\r\n                        </label>\r\n                    </section>\r\n                </div>\r\n                <div ng-if="!signatairesCtrl.existGMPLie(representantPro)">\r\n                    <span class="mw-input-no-gmp col-sm-12 col-md-12">Pas de gestionnaire de mesures de protection défini</span>\r\n                </div>\r\n            </div>\r\n            <!-- Representants Legaux Pro Personne Morale - Sans affichage des GMP-->\r\n            <div ng-if="signatairesCtrl.isShowBlocRLProPMWithoutGMP(signatairesCtrl.signataireReponse.titulaires.personnes,representantPro)">\r\n                <label data-for="id-checkbox-representant-pro-{{ $index }}" data-id="id-label-representant-pro-{{ $index }}" ng-class="{\'disabled\' : !representantPro.isSelectionnable}" ng-disabled="!representantPro.isSelectionnable">\r\n                    <input data-id="id-checkbox-representant-pro-{{ $index }}" type="checkbox" ng-model="representantPro.isSelectionne" ng-change="signatairesCtrl.onCheck($index, {{signatairesCtrl.typeSignataireEnum.REPRESENTANT_LEGAL_PRO}})" aria-checked="{{ ::representantPro.isSelectionne }}" aria-labelledby="id-label-representant-pro-{{ $index }}" ng-disabled="!representantPro.isSelectionnable">\r\n                    <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\': representantPro.isSelectionne}"></span>\r\n                    <span class="bold" ng-bind="signatairesCtrl.getLibellePersonne(representantPro)"></span> - Représentant légal Pro -\r\n                    <span ng-bind="::representantPro.codeCapaciteJuridique | capacite"></span>\r\n                    <span class="decedee" ng-show="representantPro.dateDecesPersonne != null">Décédé(e)</span>\r\n                </label>\r\n            </div>\r\n        </section>\r\n\r\n        <!-- Mandataires -->\r\n        <section class="mw-input-check col-sm-12 col-md-12" ng-repeat="mandataire in signatairesCtrl.signataireReponse.mandataires.personnes track by $index">\r\n            <label data-for="id-checkbox-mandataire-{{ $index }}" data-id="id-label-mandataire-{{ $index }}" ng-class="{\'disabled\' : !mandataire.isSelectionnable}" ng-disabled="!mandataire.isSelectionnable">\r\n                <input data-id="id-checkbox-mandataire-{{ $index }}" type="checkbox" ng-model="mandataire.isSelectionne" ng-change="signatairesCtrl.onCheck($index, {{signatairesCtrl.typeSignataireEnum.MANDATAIRE}})" aria-checked="{{ mandataire.isSelectionne }}" aria-labelledby="id-label-mandataire-{{ $index }}" ng-disabled="!mandataire.isSelectionnable">\r\n                <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\': mandataire.isSelectionne}"></span>\r\n                <span class="bold" ng-bind="signatairesCtrl.getLibellePersonne(mandataire)"></span> - Mandataire\r\n                -\r\n                <span ng-bind="::mandataire.codeCapaciteJuridique | capacite"></span>\r\n                <span class="decedee" ng-show="mandataire.dateDecesPersonne != null">Décédé(e)</span>\r\n            </label>\r\n        </section>\r\n\r\n        <!-- Autre -->\r\n        <section ng-if="!signatairesCtrl.isTabVcSelected" class="mw-input-check col-sm-12 col-md-12" ng-repeat="autre in signatairesCtrl.signataireReponse.autres.personnes track by $index">\r\n            <label data-for="id-checkbox-autre-{{ $index }}" data-id="id-label-autre-{{ $index }}" ng-disabled="!autre.isSelectionnable">\r\n                <input data-id="id-checkbox-autre-{{ $index }}" type="checkbox" ng-model="autre.isSelectionne" ng-change="signatairesCtrl.onCheckAutre(autre.isSelectionne, false)" ng-attr-aria-checked="{{ autre.isSelectionne }}" aria-labelledby="id-label-autre-{{ $index }}" ng-disabled="!autre.isSelectionnable">\r\n                <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\':autre.isSelectionne}"></span>\r\n                <span ng-bind="::signatairesCtrl.LIBELLE_AUTRE"></span>\r\n            </label>\r\n        </section>\r\n\r\n        <!-- Champ précision -->\r\n        <div ng-if="signatairesCtrl.afficheChampPrecision" class="col-sm-12 col-md-12">\r\n            <label class="col-sm-12 col-md-3 control-label asterisque" for="input-precision-signataire" aria-required="true">Cas particulier</label>\r\n            <div class="col-sm-12 col-md-9">\r\n                <input id="input-precision-signataire" name="precisionSignataire" class="form-control" type="text" placeholder="Nom du signataire effectif ou raison de l’absence de signataire" ng-model="signatairesCtrl.precisionSignataire" ng-model-options="{ allowInvalid: true }" ng-change="signatairesCtrl.onChangePrecisionSignataire()" ng-required="signatairesCtrl.afficheChampPrecision" ng-minlength="{{::signatairesCtrl.PRECISION_SIGNATAIRE_MINLENGTH}}">\r\n                <div ng-show="formulaireListeSignataires.precisionSignataire.$error.minlength" class="error-msg col-md-12">\r\n                    <span ng-bind="::signatairesCtrl.PRECISION_SIGNATAIRE_MINLENGTH"></span> caractères minimum\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Visa Collaborateur : Message spécifique + Checkbox Confirmation -->\r\n        <div ng-if="signatairesCtrl.isTabVcSelected" class="col-sm-12 col-md-12">\r\n            <span aria-hidden="true" class="icon itce-information-circle"></span>\r\n            <span class="mw-message-vc"> Pour poursuivre, vous devez détenir une demande écrite, signée de la main de votre client. Celle-ci vous sera demandée ultérieurement.</span>\r\n            <div class="col-sm-12 col-md-12 mw-input-check">\r\n                <label data-for="id-checkbox-visa-confirm" data-id="id-checkbox-visa-confirm">\r\n                    <input data-id="id-checkbox-visa-confirm" type="checkbox" ng-model="signatairesCtrl.checkboxVcConfirm" ng-change="signatairesCtrl.onCheckVcConfirm(signatairesCtrl.checkboxVcConfirm)" ng-attr-aria-checked="{{ signatairesCtrl.checkboxVcConfirm }}" aria-labelledby="id-checkbox-visa-confirm">\r\n                    <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\':signatairesCtrl.checkboxVcConfirm}"></span>\r\n                    <span>Je confirme détenir une demande écrite de mon client</span>\r\n                </label>\r\n            </div>\r\n        </div>\r\n\r\n\r\n        <!-- Reference Identité -->\r\n        <div ng-if="signatairesCtrl.afficherReferenceIdentite" class="col-sm-12 col-md-12">\r\n            <label class="col-sm-12 col-md-3 control-label" ng-class="{\'asterisque\': signatairesCtrl.referenceIdentiteObligatoire}" for="input-reference-identite" aria-required="true">Référence justificatif d\'identité</label>\r\n            <div class="col-sm-12 col-md-9">\r\n                <input id="input-reference-identite" name="referenceIdentite" class="form-control" type="text" placeholder="" ng-model="signatairesCtrl.referenceIdentite" ng-model-options="{ allowInvalid: true }" ng-change="signatairesCtrl.onChangeReferenceIdentite()" ng-required="signatairesCtrl.referenceIdentiteObligatoire" ng-minlength="{{::signatairesCtrl.REFERENCE_IDENTITE_MINLENGTH}}" maxlength="{{::signatairesCtrl.REFERENCE_IDENTITE_MAXLENGTH}}">\r\n                <div ng-show="formulaireListeSignataires.referenceIdentite.$error.minlength" class="error-msg col-md-12">\r\n                    <span ng-bind="::signatairesCtrl.REFERENCE_IDENTITE_MINLENGTH"></span> caractères minimum\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Infos complémentaires-->\r\n        <div ng-if="signatairesCtrl.signataireReponse.infosComplementaires.libelleErreur">\r\n            <span ng-bind="::signatairesCtrl.signataireReponse.infosComplementaires.libelleErreur"></span>\r\n        </div>\r\n    </div>'),e.put("typescript/directives/signataires-document/vues/liste-signataires-view-part.html",'    <!-- FORME QR PART : LISTE -->\r\n    <div class="mw-hrectractable panel mw-hrectractable-collapsible" ng-class="{\'mw-hrectractable-collapsible-open\': signatairesCtrl.isOpened, \'mw-hrectractable-collapsible-close\': !signatairesCtrl.isOpened}" ng-if="!signatairesCtrl.isPro">\r\n\r\n        <button id="signataires-liste-bouton" class="panel-heading" ng-click="signatairesCtrl.expand()" aria-expanded="{{ ::signatairesCtrl.isOpened}}" aria-controls="conteneur">\r\n\r\n            <span class="icon-loader itce-spinner icon animate" aria-hidden="true" ng-show="signatairesCtrl.chargement"></span>\r\n\r\n            <span class="pull-right icon" aria-hidden="true" ng-class="{\'itce-chevron-down\':!signatairesCtrl.isOpened, \'itce-chevron-up\': signatairesCtrl.isOpened, \'cache\': !signatairesCtrl.chargementSansErreur}"></span>\r\n            <span ng-show="signatairesCtrl.chargementSansErreur" class="col-sm-12 col-md-5 bold italic" ng-bind="::signatairesCtrl.signataireReponse.libelleRegle"></span>\r\n            <span ng-show="signatairesCtrl.chargementSansErreur" ng-bind="signatairesCtrl.selectionMessage"></span>\r\n\r\n            <span ng-show="signatairesCtrl.messageErreurServiceRest" ng-bind="::signatairesCtrl.messageErreur"></span>\r\n        </button>\r\n\r\n        <div id="signataires-liste" class="panel-body col-md-12" collapse="!signatairesCtrl.isOpened" tabindex="0">\r\n            <div class="panel-body-contenu col-md-12 mw-tabs-for-vc">\r\n                <tabset ng-show="!signatairesCtrl.messageErreurServiceRest" id="tabset-vc">\r\n                    <tab heading="{{::signatairesCtrl.LIBELLE_ONGLET_SIGNATAIRES}}" id="tab-select-sign" select="signatairesCtrl.onSelectTabSignataires()">\r\n                        <div ng-include src="\'typescript/directives/signataires-document/vues/bloc-signataires.html\'"></div>\r\n                    </tab>\r\n                    <tab disabled="!signatairesCtrl.signataireReponse.visaCollaborateurs || !signatairesCtrl.signataireReponse.visaCollaborateurs.personnes.length" heading="{{::signatairesCtrl.LIBELLE_ONGLET_VISA_COLLABORATEUR}}" id="tab-select-demandeur" select="signatairesCtrl.onSelectTabVc()">\r\n                        <div ng-include src="\'typescript/directives/signataires-document/vues/bloc-signataires.html\'"></div>\r\n                    </tab>\r\n                </tabset>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <!-- FIN QR PART : LISTE -->\r\n'),e.put("typescript/directives/signataires-document/vues/liste-signataires-view-pro.html",'    <!-- QR PRO : TABLEAU SIMPLE MULTISELECT -->\r\n    <div class="mw-hrectractable panel mw-hrectractable-collapsible" ng-class="{\'mw-hrectractable-collapsible-open\': signatairesCtrl.isOpened, \'mw-hrectractable-collapsible-close\': !signatairesCtrl.isOpened}" ng-if="signatairesCtrl.isPro">\r\n        <button id="signataires-pro-liste-bouton" class="panel-heading" ng-click="signatairesCtrl.expand()" aria-expanded="{{signatairesCtrl.isOpened}}" aria-controls="conteneur">\r\n            <span class="pull-right icon" aria-hidden="true" ng-class="{\'itce-chevron-down\':!signatairesCtrl.isOpened, \'itce-chevron-up\': signatairesCtrl.isOpened}"></span>\r\n            <span class="icon-loader itce-spinner icon animate" aria-hidden="true" ng-show="signatairesCtrl.chargement"></span>\r\n            <span class="asterisque" ng-class="{\'cache\': !signatairesCtrl.messageErreur.length}"></span><span>Choix des signataires</span>\r\n            :\r\n            <span ng-show="signatairesCtrl.tableauSignatairesPro.selectedItems.length>0" class="help-text">\r\n                <span ng-bind="signatairesCtrl.selectionMessage"></span>\r\n                <br>\r\n            </span>\r\n            <span ng-hide="signatairesCtrl.tableauSignatairesPro.selectedItems.length>0">\r\n                <span class="help-text" ng-bind="::signatairesCtrl.messageInfo"></span>\r\n                <br>\r\n            </span>\r\n            <span class="asterisque cache float-left"></span>\r\n            <section class="bold float-left" ng-repeat="ligne in signatairesCtrl.tableauSignatairesPro.selectedItems track by $index">\r\n                <span ng-bind="::ligne.nom"></span> ;&nbsp\r\n            </section>\r\n            <span class="bold">&nbsp</span>\r\n        </button>\r\n\r\n        <div id="signataires-pro-liste" class="panel-body col-md-12" collapse="!signatairesCtrl.isOpened" ng-show="!signatairesCtrl.messageErreurServiceRest" tabindex="0">\r\n\r\n            <form class="form-vertical table-scroll">\r\n                <div class="form-group">\r\n                    <mw-table options="signatairesCtrl.tableauSignatairesPro" id="tableau-signataires"></mw-table>\r\n                </div>\r\n            </form>\r\n\r\n            <!-- Autres -->\r\n            <section class="mw-input-check vertical-alignement col-md-12" ng-repeat="autre in signatairesCtrl.signataireReponse.autres.personnes track by $index">\r\n                <label data-for="id-checkbox-autre-{{ $index }}" data-id="id-label-autre-{{ $index }}" ng-disabled="!autre.isSelectionnable">\r\n                    <input data-id="id-checkbox-autre-{{ $index }}" type="checkbox" ng-model="autre.isSelectionne" ng-change="signatairesCtrl.onCheckAutre(autre.isSelectionne, true)" ng-attr-aria-checked="{{ autre.isSelectionne }}" aria-labelledby="id-label-autre-{{ $index }}" ng-disabled="!autre.isSelectionnable">\r\n                    <span aria-hidden="true" class="icon" ng-class="{\'itce-fa-check\':autre.isSelectionne}"></span>\r\n                    Autre\r\n                </label>\r\n            </section>\r\n\r\n            <div ng-if="signatairesCtrl.afficheChampPrecision" class="col-sm-12 col-md-12">\r\n                <label class="col-sm-12 col-md-3 control-label asterisque" for="input-precision-signataire-pro" aria-required="true">Cas particulier</label>\r\n                <div class="col-sm-12 col-md-9">\r\n                    <input id="input-precision-signataire-pro" name="precisionSignataire" class="form-control" type="text" placeholder="Nom du signataire effectif ou raison de l’absence de signataire" ng-model="signatairesCtrl.precisionSignataire" ng-model-options="{ allowInvalid: true }" ng-change="signatairesCtrl.onChangePrecisionSignataire()" ng-required="signatairesCtrl.afficheChampPrecision" ng-minlength="{{::signatairesCtrl.PRECISION_SIGNATAIRE_MINLENGTH}}">\r\n                    <div ng-show="formulaireListeSignataires.precisionSignataire.$error.minlength" class="error-msg col-md-12">\r\n                        <span ng-bind="::signatairesCtrl.PRECISION_SIGNATAIRE_MINLENGTH"></span> caractères minimum\r\n                    </div>\r\n                </div>\r\n            </div>\r\n\r\n            <div ng-if="signatairesCtrl.afficherReferenceIdentite" class="col-sm-12 col-md-12">\r\n                <label class="col-sm-12 col-md-3 control-label" ng-class="{\'asterisque\': signatairesCtrl.referenceIdentiteObligatoire}" for="input-reference-identite-pro" aria-required="true">Référence justificatif d\'identité</label>\r\n                <div class="col-sm-12 col-md-9">\r\n                    <input id="input-reference-identite-pro" name="referenceIdentite" class="form-control" type="text" placeholder="" ng-model="signatairesCtrl.referenceIdentite" ng-model-options="{ allowInvalid: true }" ng-change="signatairesCtrl.onChangeReferenceIdentite()" ng-required="signatairesCtrl.referenceIdentiteObligatoire" ng-minlength="{{::signatairesCtrl.REFERENCE_IDENTITE_MINLENGTH}}" maxlength="{{::signatairesCtrl.REFERENCE_IDENTITE_MAXLENGTH}}">\r\n                    <div ng-show="formulaireListeSignataires.referenceIdentite.$error.minlength" class="error-msg col-md-12">\r\n                        <span ng-bind="::signatairesCtrl.REFERENCE_IDENTITE_MINLENGTH"></span> caractères minimum\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    <!-- FIN QR PRO : TABLEAU SIMPLE MULTISELECT -->\r\n'),e.put("typescript/directives/signataires-document/vues/liste-signataires-view.html",'<ng-form name="formulaireListeSignataires">\r\n    <!-- Liste Signataires Part -->\r\n    <div ng-include src="\'typescript/directives/signataires-document/vues/liste-signataires-view-part.html\'"></div>\r\n    <!-- Liste Signataires Pro -->\r\n    <div ng-include src="\'typescript/directives/signataires-document/vues/liste-signataires-view-pro.html\'"></div>\r\n</ng-form>')}]);