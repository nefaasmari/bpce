var MyWay;!function(e){!function(e){"use strict";var o=function(e,r,n){this.codeLibelle=e,this.valeurs=r,this.causes=n};e.Erreur=o;var r=function(){function e(e){this.innerService=e}return e.prototype.all=function(e){return this.innerService.all(e)},e.prototype.defer=function(r){return new n(this.innerService.defer(),function(e){r&&r(e)})},e.prototype.reject=function(e){return this.innerService.reject(e)},e.prototype.when=function(e){return this.innerService.when(e)},e}();e.MonServiceDePromesse=r;var t=function(){function e(e,r){this.innerPromesse=e,this.erreurCallback=r,this._catchHappened=!1}return e.prototype.then=function(e,r,n){return this.innerPromesse.then(e,r,n)},e.prototype.catch=function(e){return this._catchHappened=!0,this.innerPromesse.catch(e)},e.prototype.finally=function(e){return!this._catchHappened&&this.erreurCallback&&this.erreurCallback(this.lastReason),this.innerPromesse.finally(e)},e}();e.MaPromesse=t;var n=function(){function e(e,r){var n=this;this.innerDeferred=e,this.erreurCallback=r,this.resolve=function(e){return n.innerDeferred.resolve(e)},this.reject=function(e){return n.promesse.lastReason=e,n.innerDeferred.reject(e)},this.notify=function(e){return n.innerDeferred.notify(e)},this.promesse=new t(this.innerDeferred.promise,this.erreurCallback)}return Object.defineProperty(e.prototype,"promise",{get:function(){return this.promesse},enumerable:!0,configurable:!0}),e}();e.MonDeferred=n;var s=function(){function s(){}return s.getServiceDePromesse=function(){return s.ServiceDePromesse||(s.ServiceDePromesse="undefined"!=typeof angular?new r(angular.injector(["ng"]).get("$q")):(console.debug("[Framework Technique MyWay - Promesses - init] Angular n'est pas disponible"),new r(Q))),s.ServiceDePromesse},s.getPromesseSelfResoved=function(){if(!s.promesseSelfResolved){var e=s.getServiceDePromesse().defer();e.resolve(),s.promesseSelfResolved=e.promise}return s.promesseSelfResolved},s.createPromiseSelfResolved=function(e){var r=s.getServiceDePromesse().defer();return r.resolve(e),r.promise},s.createPromiseSelfError=function(e){var r=s.getServiceDePromesse().defer();return r.reject(e),r.promise},s.promesseTryCatch=function(e,r){var n=s.getServiceDePromesse().defer();try{e(n)}catch(e){r?r(e,n):n.reject(e)}return n.promise},s.prototype.promesseTryCatch=function(e,r){return s.promesseTryCatch(e,r)},s.executePromisesSequentially=function(t){return s.promesseTryCatch(function(r){var n=function(e){try{if(t.length<=e)return void r.resolve();t[e]().then(function(){n(e+1)},function(e){r.reject(e)})}catch(e){r.reject(new o(e))}};n(0)})},s.executePromisesSimultaneous=function(r){return s.promesseTryCatch(function(e){s.getServiceDePromesse().all(r).then(function(){e.resolve()},e.reject)})},s.all=function(e){return s.getServiceDePromesse().all(e)},s.executePromisesSimultaneousAndWaitAllResolves=function(e){var r=[];return e.forEach(function(e){r.push(s.promesseTryCatch(function(r){e.then(function(e){r.resolve({result:e,isError:!1})},function(e){r.resolve({result:e,isError:!0})})}))}),s.getServiceDePromesse().all(r).then(function(e){e.forEach(function(e){if(e.isError)throw e.result})})},s.promesseSelfResolved=null,s}();e.Promesses=s}(e.Services||(e.Services={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-promesses.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t,r,n;t=e.Services||(e.Services={}),r=t.Loggers||(t.Loggers={}),(n=r.LEVEL||(r.LEVEL={}))[n.DEBUG="DEBUG"]="DEBUG",n[n.INFO="INFO"]="INFO",n[n.WARN="WARN"]="WARN",n[n.ERROR="ERROR"]="ERROR",n[n.NONE="NONE"]="NONE"}(MyWay||(MyWay={})),function(e){var t,a,r;t=e.Services||(e.Services={}),a=t.Loggers||(t.Loggers={}),r=function(){function i(){this.isInit=!1,this.LOGGER_ACTUEL=null,this.appenders={},this.waitingAppenders={}}return Object.defineProperty(i,"INSTANCE",{get:function(){return i._INSTANCE||(i._INSTANCE=new i),i._INSTANCE},enumerable:!0,configurable:!0}),i.prototype.declareAppender=function(e,t){this.appenders[e]=t,this.waitingAppenders[e]&&(this.waitingAppenders[e].forEach(function(e){e.setInternalAppender(t)}),delete this.waitingAppenders[e])},i.prototype.getClassByName=function(e){var t=window;return e.split(".").forEach(function(e){t=t[e]}),t},i.prototype.getClass=function(e){return a.loggersParNom[e]?a.loggersParNom[e]:new a.Logger(e)},i.prototype.addAppender=function(e){var t=this.appenders[e.class];if(t){var r=new t(e.type,e.level,e.config);a.appenders.push(r)}else{var n=new a.WaitingAppender(e.type,e.level,e.config);this.waitingAppenders[e.class]||(this.waitingAppenders[e.class]=[]),this.waitingAppenders[e.class].push(n),a.appenders.push(n)}},i.prototype.addLogger=function(e){var r={name:e.name,level:e.level,appenders:[]};e.appenders.forEach(function(t){a.appenders.forEach(function(e){e.name===t&&r.appenders.push(e)})}),a.categories.push(r)},i.prototype.appenderToConfigAppender=function(e){return{class:e.class,config:e.getConfig(),level:e.level,type:e.name}},i.prototype.loggerToConfigLogger=function(e){var t=[];return e.appenders.forEach(function(e){t.push(e.name)}),{appenders:t,level:e.level,name:e.name}},i.prototype.rechargerConfigurationsLoggers=function(){for(var e in a.loggersParNom)a.loggersParNom[e].verifierNiveauMinimum()},i.prototype.setConfigActual=function(e){var t=this;a.appenders=[],a.categories=[],e.appenders.forEach(function(e){t.addAppender(e)}),e.loggers.forEach(function(e){t.addLogger(e)}),this.isInit=!0,this.rechargerConfigurationsLoggers()},i.prototype.setConfigDB=function(e,t){localStorage.setItem("logger."+e+".config",JSON.stringify(t))},i.prototype.getConfigurationActual=function(){var t=this,r={appenders:[],loggers:[]};return a.appenders.forEach(function(e){r.appenders.push(t.appenderToConfigAppender(e))}),a.categories.forEach(function(e){r.loggers.push(t.loggerToConfigLogger(e))}),r},i.prototype.getConfigurationDB=function(e){return JSON.parse(localStorage.getItem("logger."+e+".config"))},i.prototype.saveConfiguration=function(e){var t=this.getConfigurationActual();localStorage.setItem("logger."+e+".config",JSON.stringify(t)),localStorage.setItem("logger."+e+".version","1"),this.LOGGER_ACTUEL=e},i.prototype.loadConfiguration=function(e){var t="";if(t=a.DEFAULT_CONFIGURATION_PORTAIL?"portail_":"agent_",!e)if(localStorage.getItem(t+"loggerActuel.name"))e=localStorage.getItem(t+"loggerActuel.name");else if(a.DEFAULT_CONFIGURATION_PORTAIL)e=i.LOGGER_PORTAIL;else{if(!a.DEFAULT_CONFIGURATION_AGENTS)throw"Aucune configuration de LOG trouvée";e=i.LOGGER_AGENTS}var r=localStorage.getItem("logger."+e+".config");if(r){var n=localStorage.getItem("logger."+e+".version");if("1"!==n)switch(e){case i.LOGGER_PORTAIL:this.setConfigActual(a.DEFAULT_CONFIGURATION_PORTAIL),this.LOGGER_ACTUEL=i.LOGGER_PORTAIL,e=i.LOGGER_PORTAIL;break;case i.LOGGER_AGENTS:this.setConfigActual(a.DEFAULT_CONFIGURATION_AGENTS),this.LOGGER_ACTUEL=i.LOGGER_AGENTS,e=i.LOGGER_AGENTS;break;default:throw"La configuration "+e+" est en version "+n+" alors que les logs sont en version 1 maximum"}else{var o=JSON.parse(r);this.setConfigActual(o),this.LOGGER_ACTUEL=e}}else switch(e){case i.LOGGER_PORTAIL:this.setConfigActual(a.DEFAULT_CONFIGURATION_PORTAIL),this.LOGGER_ACTUEL=i.LOGGER_PORTAIL,e=i.LOGGER_PORTAIL;break;case i.LOGGER_AGENTS:this.setConfigActual(a.DEFAULT_CONFIGURATION_AGENTS),this.LOGGER_ACTUEL=i.LOGGER_AGENTS,e=i.LOGGER_AGENTS;break;default:if(a.DEFAULT_CONFIGURATION_PORTAIL)this.setConfigActual(a.DEFAULT_CONFIGURATION_PORTAIL),this.LOGGER_ACTUEL=i.LOGGER_PORTAIL,e=i.LOGGER_PORTAIL;else{if(!a.DEFAULT_CONFIGURATION_AGENTS)throw"Impossible de charger une configuration de log";this.setConfigActual(a.DEFAULT_CONFIGURATION_AGENTS),this.LOGGER_ACTUEL=i.LOGGER_AGENTS,e=i.LOGGER_AGENTS}}localStorage.setItem(t+"loggerActuel.name",e)},i.prototype.getNomConfigActuelle=function(){return this.LOGGER_ACTUEL},i.prototype.getAllLogggersNames=function(){var e=[];e.push(i.LOGGER_PORTAIL),e.push(i.LOGGER_AGENTS);for(var t=localStorage.length;t--;){var r=localStorage.key(t),n=/^logger\.([^.]+)\.config$/.exec(r);if(n){var o=n[1];o!==i.LOGGER_PORTAIL&&o!==i.LOGGER_AGENTS&&e.push(o)}}return e},i.prototype.supprimerConfiguration=function(e){localStorage.removeItem("logger."+e+".config"),localStorage.removeItem("logger."+e+".version")},i.prototype.clearConfigurations=function(){var t=this;localStorage.removeItem("portail_loggerActuel.name"),localStorage.removeItem("agent_loggerActuel.name"),this.getAllLogggersNames().forEach(function(e){t.supprimerConfiguration(e)})},i.LOGGER_PORTAIL="portail",i.LOGGER_AGENTS="agent",i._INSTANCE=null,i}(),a.LoggerFactory=r}(MyWay||(MyWay={})),function(e){var r;(function(a){a.appenders=[],a.categories=[],a.loggers=[],a.loggersParNom={};var e=function(){function e(){}return Object.defineProperty(e,"INSTANCE",{get:function(){return e._INSTANCE||(e._INSTANCE=new e),e._INSTANCE},enumerable:!0,configurable:!0}),e.prototype.testLevel=function(e,t){if(r.PrivatePortalServiceParameters&&r.PrivatePortalServiceParameters.Instance()&&r.PrivatePortalServiceParameters.Instance().ModeDebug)return!0;switch(t){case a.LEVEL.DEBUG:if(e===a.LEVEL.DEBUG)return!0;case a.LEVEL.INFO:if(e===a.LEVEL.INFO)return!0;case a.LEVEL.WARN:if(e===a.LEVEL.WARN)return!0;case a.LEVEL.ERROR:if(e===a.LEVEL.ERROR)return!0}return!1},e.prototype.getAppenders=function(r){for(var n=[],o={},e=a.categories.length;e--;){var i=a.categories[e];i.appenders.forEach(function(e){if("*"===i.name||new RegExp("^"+i.name.replace(".","\\.")).test(r))if(o[e.name]){if(o[e.name].packagename.length>i.name.length)return;o[e.name].levelMin=i.level,o[e.name].packagename=i.name}else{var t={appender:e,levelMin:i.level,packagename:i.name};o[e.name]=t,n.push(t)}})}return n},e.prototype.getContext=function(){var e=a.MDC.INSTANCE.getAll(),t=a.FLASH.INSTANCE.getAll();for(var r in t)e[r]=t[r];return e},e._INSTANCE=null,e}();a.LoggerHelper=e})((r=e.Services||(e.Services={})).Loggers||(r.Loggers={}))}(MyWay||(MyWay={})),function(e){var t,i,r;t=e.Services||(e.Services={}),i=t.Loggers||(t.Loggers={}),r=function(){function e(e){this.packageName=null,this.levelMinimum=i.LEVEL.DEBUG,this.appenders=[],this._cache=[],this.packageName=e,i.loggers.push(this),(i.loggersParNom[e]=this).verifierNiveauMinimum()}return e.prototype.internalLog=function(e,t,r){var n=i.FLASH.INSTANCE.getValue("dateLog");n||(n=new Date);var o={arguments:r,context:i.LoggerHelper.INSTANCE.getContext(),date:n.getTime(),message:t,niveau:e,packageName:this.packageName};i.LoggerFactory.INSTANCE.isInit?this.tracer(o):this._cache.push(o)},e.prototype.tracer=function(t){i.LoggerHelper.INSTANCE.testLevel(t.niveau,this.levelMinimum)&&this.appenders.forEach(function(e){e.appender.append(t)})},e.prototype.debug=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.internalLog(i.LEVEL.DEBUG,e,t)},e.prototype.info=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.internalLog(i.LEVEL.INFO,e,t)},e.prototype.warn=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.internalLog(i.LEVEL.WARN,e,t)},e.prototype.error=function(e){for(var t=[],r=1;r<arguments.length;r++)t[r-1]=arguments[r];this.internalLog(i.LEVEL.ERROR,e,t)},e.prototype.verifierNiveauMinimum=function(){var t=this;this.appenders=i.LoggerHelper.INSTANCE.getAppenders(this.packageName),this.levelMinimum=null,this.appenders.forEach(function(e){(null===t.levelMinimum||i.LoggerHelper.INSTANCE.testLevel(t.levelMinimum,e.levelMin))&&(t.levelMinimum=e.levelMin)}),this.clearCache()},e.prototype.clearCache=function(){var t=this;i.LoggerFactory.INSTANCE.isInit&&this._cache&&0<this._cache.length&&(this._cache.forEach(function(e){t.tracer(e)}),this._cache=[])},e}(),i.Logger=r}(MyWay||(MyWay={})),function(e){var t,r,n;t=e.Services||(e.Services={}),r=t.Loggers||(t.Loggers={}),n=function(){function e(){this.mdc={},this.stringify=null}return Object.defineProperty(e,"INSTANCE",{get:function(){return e._INSTANCE||(e._INSTANCE=new e),e._INSTANCE},enumerable:!0,configurable:!0}),e.prototype.setValue=function(e,t){if(void 0!==t)this.mdc[e]=t;else{if(!this.mdc[e])return;delete this.mdc[e]}this.stringify=null},e.prototype.getValue=function(e){return this.mdc[e]},e.prototype.remove=function(e){delete this.mdc[e],this.stringify=null},e.prototype.getAll=function(){return null===this.stringify&&(this.stringify=JSON.stringify(this.mdc)),JSON.parse(this.stringify)},e._INSTANCE=null,e}(),r.MDC=n}(MyWay||(MyWay={})),function(e){var t,r,n;t=e.Services||(e.Services={}),r=t.Loggers||(t.Loggers={}),n=function(){function e(){this.flash={}}return Object.defineProperty(e,"INSTANCE",{get:function(){return e._INSTANCE||(e._INSTANCE=new e),e._INSTANCE},enumerable:!0,configurable:!0}),e.prototype.setValue=function(e,t){void 0!==t?this.flash[e]=t:delete this.flash[e]},e.prototype.getValue=function(e){var t=this.flash[e];return delete this.flash[e],t},e.prototype.setAll=function(e){this.flash=e},e.prototype.getAll=function(){var e=JSON.parse(JSON.stringify(this.flash));return this.flash={},e},e._INSTANCE=null,e}(),r.FLASH=n}(MyWay||(MyWay={})),function(e){var t,r,n,o;t=e.Services||(e.Services={}),r=t.Loggers||(t.Loggers={}),n=r.Appenders||(r.Appenders={}),o=function(){function e(e,t,r,n){this.name=e,this.level=r,this.config=n,this.class=null,this.class=t}return e.prototype.getConfig=function(){return this.config},e.prototype.append=function(e){return!!r.LoggerHelper.INSTANCE.testLevel(e.niveau,this.level)&&(this.onAppend(e),!0)},e.prototype.onAppend=function(e){throw'La méthode "onAppend" n\'a pas été surchargée'},e}(),n.AbstractAppender=o}(MyWay||(MyWay={})),function(e){var t,a,r,n;t=e.Services||(e.Services={}),a=t.Loggers||(t.Loggers={}),r=a.Appenders||(a.Appenders={}),n=function(o){function i(e,t,r){var n=o.call(this,e,i.CLASSNAME,t,r)||this;return n.format=null,n.parse(r.format),n}return __extends(i,o),i.prototype.onAppend=function(t){var r="";switch(this.format.forEach(function(e){r+=e.format(t)}),t.niveau){case a.LEVEL.DEBUG:console.debug(r);break;case a.LEVEL.INFO:console.info(r);break;case a.LEVEL.WARN:console.warn(r);break;case a.LEVEL.ERROR:console.error(r)}},i.prototype.parse=function(e){var n=this,t=e.split(/%([^ ]+)/g);this.format=[],t.forEach(function(t){if(0!==t.length){if(/^d/.test(t)){var e=t.split(/d{([^}]+)}/);return 3!==e.length?void n.format.push(new a.Formaters.DateFormater):void n.format.push(new a.Formaters.DateFormater(e[1]))}if(/^level$/.test(t))n.format.push({format:function(e){return e.niveau.toString()}});else if(/^class/.test(t))n.format.push({format:function(e){return e.packageName?e.packageName:""}});else if(/^msg/.test(t))n.format.push(new a.Formaters.MessageFormater);else{if(/^X/.test(t)){var r=t.split(/X{([^}]+)}/);if(3===r.length)return void n.format.push({format:function(e){return e.context[r[1]]?"string"==typeof e.context[r[1]]?e.context[r[1]]:JSON.stringify(e.context[r[1]]):""}})}n.format.push({format:function(e){return t}})}}})},i.CLASSNAME="MyWay.Services.Loggers.Appenders.ConsoleAppender",i}(r.AbstractAppender),r.ConsoleAppender=n,a.LoggerFactory.INSTANCE.declareAppender(n.CLASSNAME,n)}(MyWay||(MyWay={})),function(e){var t,r,n;t=e.Services||(e.Services={}),r=t.Loggers||(t.Loggers={}),n=function(o){function i(e,t,r){var n=o.call(this,e,i.CLASSNAME,t,r)||this;return n.internalAppender=null,n.messagesEnAttente=[],n}return __extends(i,o),i.prototype.setInternalAppender=function(e){var t=this;this.internalAppender=new e(this.name,this.level,this.getConfig()),this.class=this.internalAppender.class,this.messagesEnAttente.forEach(function(e){t.internalAppender.append(e)}),this.messagesEnAttente.length=0},i.prototype.onAppend=function(e){return this.internalAppender?this.internalAppender.append(e):(this.messagesEnAttente.push(e),!0)},i.CLASSNAME="MyWay.Services.Loggers.WaitingAppender",i}(r.Appenders.AbstractAppender),r.WaitingAppender=n}(MyWay||(MyWay={})),function(e){var t,r,n,i,o;t=e.Services||(e.Services={}),r=t.Loggers||(t.Loggers={}),n=r.Formaters||(r.Formaters={}),i=function(e,t,r){for(var n=e.toString();n.length<r;)n=t+n;return n},o=function(){function e(e){this.formatter=null,this.parse(e)}return e.prototype.format=function(t){var r="";return this.formatter.forEach(function(e){r+=e(new Date(t.date))}),r},e.prototype.parse=function(r){var n=this;if(this.formatter=[],r){var e=r.split(""),o=0;e.forEach(function(t,e){if(0<o)o--;else switch(t){case"H":"H"===r.charAt(e+1)?(n.formatter.push(function(e){return i(e.getHours().toString(),"0",2)}),o=1):n.formatter.push(function(e){return e.getHours().toString()});break;case"m":"m"===r.charAt(e+1)?(n.formatter.push(function(e){return i(e.getMinutes().toString(),"0",2)}),o=1):n.formatter.push(function(e){return e.getMinutes().toString()});break;case"s":"s"===r.charAt(e+1)?(n.formatter.push(function(e){return i(e.getSeconds().toString(),"0",2)}),o=1):n.formatter.push(function(e){return e.getSeconds().toString()});break;case"S":"S"===r.charAt(e+1)&&"S"===r.charAt(e+2)?(n.formatter.push(function(e){return i(e.getMilliseconds().toString(),"0",3)}),o=2):n.formatter.push(function(e){return e.getMilliseconds().toString()});break;case"Y":"Y"===r.charAt(e+1)?o="Y"===r.charAt(e+2)&&"Y"===r.charAt(e+3)?(n.formatter.push(function(e){return i(e.getFullYear().toString(),"0",4)}),4):(n.formatter.push(function(e){return e.getFullYear().toString().substring(2,4)}),2):n.formatter.push(function(e){return parseInt(e.getFullYear().toString().substring(2,4),10).toString()});break;case"M":"M"===r.charAt(e+1)?(n.formatter.push(function(e){return i((e.getMonth()+1).toString(),"0",2)}),o=1):n.formatter.push(function(e){return(e.getMonth()+1).toString()});break;case"D":"D"===r.charAt(e+1)?(n.formatter.push(function(e){return i(e.getDate().toString(),"0",2)}),o=1):n.formatter.push(function(e){return e.getDate().toString()});break;default:n.formatter.push(function(e){return t})}})}else this.formatter.push(function(e){return e.getTime().toString()})},e}(),n.DateFormater=o}(MyWay||(MyWay={})),function(e){var t,r,n,o;t=e.Services||(e.Services={}),r=t.Loggers||(t.Loggers={}),n=r.Formaters||(r.Formaters={}),o=function(){function e(){}return e.prototype.format=function(e){if(!e.arguments||0===e.arguments.length)return e.message;var r=e.message;return e.arguments.forEach(function(e,t){r=r.replace(new RegExp("%"+(t+1),"g"),e)}),r},e}(),n.MessageFormater=o}(MyWay||(MyWay={})),function(e){var t,r,n,o;t=e.Services||(e.Services={}),r=t.Loggers||(t.Loggers={}),(n=r.Messages||(r.Messages={})).NOM_BIBLIOTHEQUE="Loggers",(o=n.TYPE||(n.TYPE={}))[o.GET_CONFIG_ACTUAL="GET_CONFIG_ACTUAL"]="GET_CONFIG_ACTUAL",o[o.SET_CONFIG_ACTUAL="SET_CONFIG_ACTUAL"]="SET_CONFIG_ACTUAL",o[o.GET_CONFIG_DB="GET_CONFIG_DB"]="GET_CONFIG_DB",o[o.SET_CONFIG_DB="SET_CONFIG_DB"]="SET_CONFIG_DB",o[o.SAVE_CONFIG="SAVE_CONFIG"]="SAVE_CONFIG",o[o.LOAD_CONFIG="LOAD_CONFIG"]="LOAD_CONFIG",o[o.GET_LOGGERS="GET_LOGGERS"]="GET_LOGGERS",o[o.GET_NOM_CONFIG_ACTUELLE="GET_NOM_CONFIG_ACTUELLE"]="GET_NOM_CONFIG_ACTUELLE",o[o.IS_CLASS_EXISTS="IS_CLASS_EXISTS"]="IS_CLASS_EXISTS",o[o.RESET="RESET"]="RESET"}(MyWay||(MyWay={})),function(e){var t,o;t=e.Services||(e.Services={}),(o=t.Loggers||(t.Loggers={})).loggerToTrace=function(n){return{debug:function(e,t,r){t&&o.FLASH.INSTANCE.setValue("action",t),r&&o.FLASH.INSTANCE.setValue("details",r),n.debug(e)},info:function(e,t,r){t&&o.FLASH.INSTANCE.setValue("action",t),r&&o.FLASH.INSTANCE.setValue("details",r),n.info(e)},warning:function(e,t,r){t&&o.FLASH.INSTANCE.setValue("action",t),r&&o.FLASH.INSTANCE.setValue("details",r),n.warn(e)},error:function(e,t,r){t&&o.FLASH.INSTANCE.setValue("action",t),r&&o.FLASH.INSTANCE.setValue("details",r),n.error(e)}}}}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-loggerbase.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}(),__assign=this&&this.__assign||Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e};!function(e){var t=function(){function e(){}return e.NAME="Framework Technique",e.VERSION="1",e.BUILD="Local 24.02",e}();e.Framework=t}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),(n=t.Core||(t.Core={})).override=function(e,t,n){e.prototype[t],e.prototype[t]=function(){return n.apply(this,arguments)}},n.defineProperty=function(e,t,n){Object.defineProperty(e.prototype,t,{get:n.get,set:n.set,enumerable:!0,configurable:!0})}}(MyWay||(MyWay={})),function(e){var t,n,r;t=e.Services||(e.Services={}),n=t.Context||(t.Context={}),(r=n.ScopeType||(n.ScopeType={}))[r.View=1]="View",r[r.Root=2]="Root",r[r.Service=3]="Service"}(MyWay||(MyWay={})),function(e){var n;(function(e){"use strict";e.RegistryType||(e.RegistryType={});var t=function(){function e(e,t){this._components=[],this._componentsInstances=[],this._componentsInstancesByKey={},this._dependenciesInstances=null,this._registryType=e,this._dependencies=t}return e.prototype.register=function(e){this._components.push(e)},Object.defineProperty(e.prototype,"components",{get:function(){return this._components},enumerable:!0,configurable:!0}),e.prototype.reset=function(){this._components.length=0},e.prototype.getComponentInstance=function(e){return this._componentsInstancesByKey[e]},e.prototype.getComponentsInstances=function(){return this._componentsInstances},e.prototype.getLibrary=function(){return this._componentsInstancesByKey},Object.defineProperty(e.prototype,"registryType",{get:function(){return this._registryType},enumerable:!0,configurable:!0}),e.prototype.init=function(e){this.createInstances();var t=this._componentsInstancesByKey[e];return t?this.initializeComponent(t):n.CoreCommon.getPromesseSelfResoved()},e.prototype.createInstances=function(){var n=this;this._components.forEach(function(e){var t=new e;n._componentsInstances.push(t),n._componentsInstancesByKey[t.name]=t}),this._components.length=0},Object.defineProperty(e.prototype,"dependencies",{get:function(){return this._dependencies},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"dependenciesInstances",{set:function(e){this._dependenciesInstances=e},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){var t=[];return this._componentsInstances.forEach(function(e){t.push(e.dispose())}),n.CoreCommon.executePromisesSimultaneous(t)},e}();e.AbstractRegistry=t})((n=e.Services||(e.Services={})).Components||(n.Components={}))}(MyWay||(MyWay={})),function(e){var t;(function(e){"use strict";e.ComponentType||(e.ComponentType={})})((t=e.Services||(e.Services={})).Components||(t.Components={}))}(MyWay||(MyWay={})),function(e){var o;(function(e){"use strict";var t=function(){function i(){this.registries=[],this.registriesByKeys={},this.dependencies=[]}return i.getInstance=function(){return null===i.INSTANCE&&(i.INSTANCE=new i),i.INSTANCE},i.prototype.reorderRegistries=function(){var t=this,n=new o.Toposort;this.registries.forEach(function(e){n.add(e.registryType,e.dependencies)});var e=n.sort();this.registries.length=0,e.forEach(function(e){t.registriesByKeys[e]&&t.registries.push(t.registriesByKeys[e])})},i.prototype.reorderComponents=function(){var t=this,n=new o.Toposort,r={};this.dependencies.forEach(function(e){r[e.name]=e,n.add(e.name,e.dependencies)});var e=n.sort();this.dependencies.length=0,e.forEach(function(e){r[e]&&t.dependencies.push(r[e])})},i.prototype.init=function(){var e=this;this.reorderRegistries(),this.reorderComponents(),this.injectDependencies();var r=[];return this.dependencies.forEach(function(n){e.registries.forEach(function(t){r.push(function(){return t.init(n.name).then(function(){},function(e){throw i.logger.debug("Registry : %1, initialisation du composant %2 => Erreur!",t.registryType,n.name),e})})})}),o.CoreCommon.executePromisesSequentially(r).then(function(){},console.error)},i.prototype.injectDependencies=function(){var i=this;this.registries.forEach(function(e){var t=e.dependencies,r=[];t.forEach(function(t){var n=null;if(i.registries.every(function(e){return e.registryType===t&&(n=e),null===n}),null===n)throw new o.Erreur("Le registry de type "+t+" n'a pas été trouvé!");r.push(n)}),e.dependenciesInstances=r})},i.prototype.dispose=function(){var t=[];return this.registries.forEach(function(e){t.push(function(){return e.dispose()})}),o.CoreCommon.executePromisesSequentially(t)},i.prototype.addRegistry=function(e){this.registries.push(e),this.registriesByKeys[e.registryType]=e},i.prototype.declareComponent=function(t,n){if(void 0===t)throw new o.Erreur("Tentative d'enregistrement de composant avant sa déclaration");n.forEach(function(e){if(void 0===e)throw new o.Erreur("Tentative d'enregistrement des dépendances du composant avant sa déclaration pour "+t+". Dependances :"+JSON.stringify(n))}),this.dependencies.push({dependencies:n,name:t})},i.prototype.getRegistryInstance=function(e){return this.registriesByKeys[e]},i.INSTANCE=null,i.CLASS_NAME="MyWay.Services.Components.FactoryRegistries",i.logger=o.Loggers.LoggerFactory.INSTANCE.getClass(i.CLASS_NAME),i}();e.FactoryRegistries=t})((o=e.Services||(e.Services={})).Components||(o.Components={}))}(MyWay||(MyWay={})),function(e){var t;(function(n){"use strict";var r;(r=n.RegistryType||(n.RegistryType={})).COMMON="COMMON";var e=function(e){function t(){return e.call(this,r.COMMON,[])||this}return __extends(t,e),t.getInstance=function(){return null===t.instance&&(t.instance=new t,n.FactoryRegistries.getInstance().addRegistry(t.instance)),t.instance},t.prototype.initializeComponent=function(e){return e.init(this._componentsInstances)},t.instance=null,t}(n.AbstractRegistry);n.RegistryCommon=e})((t=e.Services||(e.Services={})).Components||(t.Components={}))}(MyWay||(MyWay={})),function(e){var t,n,r;t=e.Services||(e.Services={}),n=t.Components||(t.Components={}),r=function(){function e(e){this._name=e}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e.CLASS_NAMEBase="MyWay.Services.ComponentBase",e.loggerBase=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAMEBase),e}(),n.ComponentBase=r}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),((n=t.Components||(t.Components={})).ComponentType||(n.ComponentType={})).Controle="Controle"}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),(n=t.Controle||(t.Controle={})).ControleMessageSubject||(n.ControleMessageSubject={}),t.Components.FactoryRegistries.getInstance().declareComponent(t.Components.ComponentType.Controle,[])}(MyWay||(MyWay={})),function(e){var t;(function(e){var t=function(){function e(){}return e.isNotUndefinedAndNotNull=function(e){return null!=e},e}();e.StaticAnyControle=t;var n=function(){function e(){}return e.prototype.isNotUndefinedAndNotNull=function(e){return t.isNotUndefinedAndNotNull(e)},e}();e.AnyControle=n})((t=e.Services||(e.Services={})).Controle||(t.Controle={}))}(MyWay||(MyWay={})),function(e){var t;(function(e){var t=function(){function e(){}return e.isArray=function(e){return null!=e&&"[object Array]"===Object.prototype.toString.call(e)},e}();e.StaticArrayControle=t;var n=function(){function e(){}return e.prototype.isArray=function(e){return t.isArray(e)},e}();e.ArrayControle=n})((t=e.Services||(e.Services={})).Controle||(t.Controle={}))}(MyWay||(MyWay={})),function(e){var t;(function(e){var t=function(){function e(){}return e.isDate=function(e){return null!=e&&"[object Date]"===Object.prototype.toString.call(e)},e}();e.StaticDateControle=t;var n=function(){function e(){}return e.prototype.isDate=function(e){return t.isDate(e)},e}();e.DateControle=n})((t=e.Services||(e.Services={})).Controle||(t.Controle={}))}(MyWay||(MyWay={})),function(e){var t;(function(r){var n=function(){function n(){}return n.isAnEnumValueOrNullOrUndefined=function(e,t){return!r.StaticAnyControle.isNotUndefinedAndNotNull(e)||n.isAnEnumValue(e,t)},n.isAnEnumValue=function(e,t){if(r.StaticNumberControle.isInt(e)&&r.StaticObjectControle.isObject(t)){for(var n in t)if("number"==typeof t[n]&&t[n]===e)return!0;return!1}return!1},n.isAnEnumMember=function(e,t){if(r.StaticStringControle.isString(e)&&r.StaticObjectControle.isObject(t)){for(var n in t)if("number"==typeof t[n]&&n===e)return!0;return!1}return!1},n}();r.StaticEnumControle=n;var e=function(){function e(){}return e.prototype.isAnEnumValueOrNullOrUndefined=function(e,t){return n.isAnEnumValueOrNullOrUndefined(e,t)},e.prototype.isAnEnumValue=function(e,t){return n.isAnEnumValue(e,t)},e.prototype.isAnEnumMember=function(e,t){return n.isAnEnumMember(e,t)},e}();r.EnumControle=e})((t=e.Services||(e.Services={})).Controle||(t.Controle={}))}(MyWay||(MyWay={})),function(e){var t;(function(e){var t=function(){function e(){}return e.isFunction=function(e){return null!=e&&"function"==typeof e},e.isFunctionOrNull=function(e){return null===e||this.isFunction(e)},e}();e.StaticFunctionControle=t;var n=function(){function e(){}return e.prototype.isFunction=function(e){return t.isFunction(e)},e.prototype.isFunctionOrNull=function(e){return t.isFunctionOrNull(e)},e}();e.FunctionControle=n})((t=e.Services||(e.Services={})).Controle||(t.Controle={}))}(MyWay||(MyWay={})),function(e){var t;(function(e){var t=function(){function e(){}return e.isNumber=function(e){return null!=e&&"number"==typeof e},e.isInt=function(e){return!!this.isNumber(e)&&e%1==0},e}();e.StaticNumberControle=t;var n=function(){function e(){}return e.prototype.isNumber=function(e){return t.isNumber(e)},e.prototype.isInt=function(e){return t.isInt(e)},e}();e.NumberControle=n})((t=e.Services||(e.Services={})).Controle||(t.Controle={}))}(MyWay||(MyWay={})),function(e){var t;(function(n){var r=function(){function e(){}return e.isObject=function(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)},e.isObjectOrNull=function(e){return null===e||this.isObject(e)},e.isObjectOrNullOrUndefined=function(e){return void 0===e||this.isObjectOrNull(e)},e.isObjectSpecified=function(e,t){return!!n.StaticStringControle.isStringNotEmpty(t)&&null!=e&&Object.prototype.toString.call(e)==="[object "+t+"]"},e}();n.StaticObjectControle=r;var e=function(){function e(){}return e.prototype.isObject=function(e){return r.isObject(e)},e.prototype.isObjectOrNull=function(e){return r.isObjectOrNull(e)},e.prototype.isObjectOrNullOrUndefined=function(e){return r.isObjectOrNullOrUndefined(e)},e.prototype.isObjectSpecified=function(e,t){return r.isObjectSpecified(e,t)},e}();n.ObjectControle=e})((t=e.Services||(e.Services={})).Controle||(t.Controle={}))}(MyWay||(MyWay={})),function(e){var t;(function(e){var t=function(){function e(){}return e.isString=function(e){return null!=e&&"string"==typeof e},e.isStringOrNull=function(e){return null===e||this.isString(e)},e.isStringOrNullOrUndefined=function(e){return void 0===e||this.isStringOrNull(e)},e.isStringNotEmpty=function(e){return""!==e&&this.isString(e)},e.isStringNotEmptyOrNull=function(e){return""!==e&&this.isStringOrNull(e)},e.isStringNotEmptyOrNullOrUndefined=function(e){return void 0===e||this.isStringNotEmptyOrNull(e)},e}();e.StaticStringControle=t;var n=function(){function e(){}return e.prototype.isString=function(e){return t.isString(e)},e.prototype.isStringOrNull=function(e){return t.isStringOrNull(e)},e.prototype.isStringOrNullOrUndefined=function(e){return t.isStringOrNullOrUndefined(e)},e.prototype.isStringNotEmpty=function(e){return t.isStringNotEmpty(e)},e.prototype.isStringNotEmptyOrNull=function(e){return t.isStringNotEmptyOrNull(e)},e.prototype.isStringNotEmptyOrNullOrUndefined=function(e){return t.isStringNotEmptyOrNullOrUndefined(e)},e}();e.StringControle=n})((t=e.Services||(e.Services={})).Controle||(t.Controle={}))}(MyWay||(MyWay={})),function(e){var t;(function(e){var t=function(){function e(){}return e.isBoolean=function(e){return null!=e&&"[object Boolean]"===Object.prototype.toString.call(e)},e}();e.StaticBooleanControle=t;var n=function(){function e(){}return e.prototype.isBoolean=function(e){return t.isBoolean(e)},e}();e.BooleanControle=n})((t=e.Services||(e.Services={})).Controle||(t.Controle={}))}(MyWay||(MyWay={})),function(e){var t,r,i,n,o;t=e.Services||(e.Services={}),r=t.Controle||(t.Controle={}),o=function(){function e(){}return e.checkParameters=function(e){var t,n="";for(t=0;t<e.length;t++)switch(e[t].controle){case i.isNotUndefinedAndNotNull:r.StaticAnyControle.isNotUndefinedAndNotNull(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' ne doit être ni null ni undefined / ");break;case i.isArray:r.StaticArrayControle.isArray(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être un tableau / ");break;case i.isBoolean:r.StaticBooleanControle.isBoolean(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être un booléen / ");break;case i.isDate:r.StaticDateControle.isDate(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être une date / ");break;case i.isAnEnumValue:r.StaticEnumControle.isAnEnumValue(e[t].value,e[t].enumObject)||(n=n+"Le paramètre '"+e[t].name+"' doit être une valeur de l'enum '"+e[t].enumName+"' / ");break;case i.isAnEnumMember:r.StaticEnumControle.isAnEnumMember(e[t].value,e[t].enumObject)||(n=n+"Le paramètre '"+e[t].name+"' doit être un membre de l'enum '"+e[t].enumName+"' / ");break;case i.isAnEnumValueOrNullOrUndefined:r.StaticEnumControle.isAnEnumValueOrNullOrUndefined(e[t].value,e[t].enumObject)||(n=n+"Le paramètre '"+e[t].name+"' doit être une valeur de l'enum '"+e[t].enumName+"' ou null ou undefined / ");break;case i.isFunction:r.StaticFunctionControle.isFunction(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être une fonction / ");break;case i.isFunctionOrNull:r.StaticFunctionControle.isFunctionOrNull(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être une fonction ou null / ");break;case i.isNumber:r.StaticNumberControle.isNumber(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être un nombre / ");break;case i.isInt:r.StaticNumberControle.isInt(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être un nombre entier / ");break;case i.isObject:r.StaticObjectControle.isObject(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être un objet / ");break;case i.isObjectOrNull:r.StaticObjectControle.isObjectOrNull(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être un objet ou null / ");break;case i.isObjectOrNullOrUndefined:r.StaticObjectControle.isObjectOrNullOrUndefined(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être un objet ou null ou undefined / ");break;case i.isObjectSpecified:r.StaticObjectControle.isObjectSpecified(e[t].value,e[t].objectType)||(n=n+"Le paramètre '"+e[t].name+"' doit être un objet de type '"+e[t].objectType+"' / ");break;case i.isString:r.StaticStringControle.isString(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être une chaine de caractères / ");break;case i.isStringOrNull:r.StaticStringControle.isStringOrNull(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être une chaine de caractères ou null / ");break;case i.isStringOrNullOrUndefined:r.StaticStringControle.isStringOrNullOrUndefined(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être une chaine de caractères ou null ou undefined / ");break;case i.isStringNotEmpty:r.StaticStringControle.isStringNotEmpty(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être une chaine de caractères non vide / ");break;case i.isStringNotEmptyOrNull:r.StaticStringControle.isStringNotEmptyOrNull(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être une chaine de caractères non vide ou null / ");break;case i.isStringNotEmptyOrNullOrUndefined:r.StaticStringControle.isStringNotEmptyOrNullOrUndefined(e[t].value)||(n=n+"Le paramètre '"+e[t].name+"' doit être une chaine de caractères non vide ou null ou undefined / ")}return""!=n&&(n=n.substring(0,n.lastIndexOf("/")-1)),n},e}(),r.StaticParametresControle=o,(n=i=r.CONTROLES||(r.CONTROLES={}))[n.isNotUndefinedAndNotNull=0]="isNotUndefinedAndNotNull",n[n.isArray=100]="isArray",n[n.isBoolean=200]="isBoolean",n[n.isDate=300]="isDate",n[n.isAnEnumValue=400]="isAnEnumValue",n[n.isAnEnumMember=401]="isAnEnumMember",n[n.isAnEnumValueOrNullOrUndefined=402]="isAnEnumValueOrNullOrUndefined",n[n.isFunction=500]="isFunction",n[n.isFunctionOrNull=501]="isFunctionOrNull",n[n.isNumber=600]="isNumber",n[n.isInt=601]="isInt",n[n.isObject=700]="isObject",n[n.isObjectOrNull=701]="isObjectOrNull",n[n.isObjectOrNullOrUndefined=702]="isObjectOrNullOrUndefined",n[n.isObjectSpecified=703]="isObjectSpecified",n[n.isString=800]="isString",n[n.isStringOrNull=801]="isStringOrNull",n[n.isStringOrNullOrUndefined=802]="isStringOrNullOrUndefined",n[n.isStringNotEmpty=803]="isStringNotEmpty",n[n.isStringNotEmptyOrNull=804]="isStringNotEmptyOrNull",n[n.isStringNotEmptyOrNullOrUndefined=805]="isStringNotEmptyOrNullOrUndefined"}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),((n=t.Components||(t.Components={})).ComponentType||(n.ComponentType={})).Message="Message",n.FactoryRegistries.getInstance().declareComponent(n.ComponentType.Message,[])}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),(n=t.CommonEventType||(t.CommonEventType={}))[n.BriqueCommunication=1]="BriqueCommunication"}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),n=function(){function e(){if(e._instance)throw new Error("Error: Instantiation failed: Use PortalServiceParameters.Instance() instead of new.");e._instance=this}return e.Instance=function(){return null===e._instance&&(e._instance=new e),e._instance},e._instance=null,e}(),t.PortalServiceParameters=n}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),((n=t.Components||(t.Components={})).ComponentType||(n.ComponentType={})).Evennements="Evennements"}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),((n=t.Components||(t.Components={})).ComponentType||(n.ComponentType={})).Core="Core"}(MyWay||(MyWay={})),function(N){!function(f){"use strict";var e=function(){function e(){this._classCallCheck(this,e),this.edges=[]}return e.prototype._classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},e.prototype.add=function(e,t){if("string"!=typeof e||!e)throw new TypeError("Dependent name must be given as a not empty string");if(0<(t=Array.isArray(t)?t:[t]).length){var n=t,r=Array.isArray(n),i=0;for(n=r?n:n[Symbol.iterator]();;){var o;if(r){if(i>=n.length)break;o=n[i++]}else{if((i=n.next()).done)break;o=i.value}var s=o;if("string"!=typeof s||!s)throw new TypeError("Dependency name must be given as a not empty string");this.edges.push([e,s])}}else this.edges.push([e]);return this},e.prototype.sort=function(){var l=this,p=[],e=this.edges,t=Array.isArray(e),n=0;for(e=t?e:e[Symbol.iterator]();;){var r;if(t){if(n>=e.length)break;r=e[n++]}else{if((n=e.next()).done)break;r=n.value}var i=S=r,o=Array.isArray(i),s=0;for(i=o?i:i[Symbol.iterator]();;){var a;if(o){if(s>=i.length)break;a=i[s++]}else{if((s=i.next()).done)break;a=s.value}var u=a;-1===p.indexOf(u)&&p.push(u)}}for(var f=p.length,d=new Array(p.length),c=function e(t,n){if(0!==n.length&&-1!==n.indexOf(t))throw new Error("Cyclic dependency found. "+t+" is dependent of itself.\nDependency chain: "+n.join(" -> ")+" => "+t);var r=p.indexOf(t);if(-1!==r){var i=!1;p[r]=!1;var o=l.edges,s=Array.isArray(o),a=0;for(o=s?o:o[Symbol.iterator]();;){var u;if(s){if(a>=o.length)break;u=o[a++]}else{if((a=o.next()).done)break;u=a.value}var c=u;c[0]===t&&(i=i||n.concat([t]),e(c[1],i))}d[--f]=t}},y=0;y<p.length;y++){if(!1!==(u=p[y])){p[y]=!1;var m=this.edges,g=Array.isArray(m),h=0;for(m=g?m:m[Symbol.iterator]();;){var v,S;if(g){if(h>=m.length)break;v=m[h++]}else{if((h=m.next()).done)break;v=h.value}(S=v)[0]===u&&c(S[1],[u])}d[--f]=u}}return d.reverse()},e.prototype.clear=function(){return this.edges=[],this},e}();f.Toposort=e;var t=function(){function e(e){this.$parse=e}return e.prototype.createInstance=function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];var r=Object.create(this.$parse(e)(window).prototype);return r.constructor.apply(r,t),r},e.$inject=["$parse"],e}();f.InstanceLoaderService=t;var d=function(){function e(e,t,n,r){this.response=n,this.status=e,this.responseType=r,this.headers=t}return e.prototype.getAllResponseHeaders=function(){return Object.keys(this.headers).reduce(function(e,t){return e+=t+": "+this.headers[t]+"\r\n"},"")+"\r\n"},e.prototype.getResponseHeader=function(e){return this.headers[e]},e}();f.FakeXhr=d;var n=function(t){function p(){var e=t.call(this,f.Components.ComponentType.Core)||this;return e._serviceLocalDisponible=!1,e.StringUtils=p.StringUtils,e.ObjectUtils=p.ObjectUtils,e}return __extends(p,t),Object.defineProperty(p,"ServiceDePromesse",{get:function(){return f.Promesses.getServiceDePromesse()},enumerable:!0,configurable:!0}),p.prototype.init=function(e){return this._libraryCommon=e,this.getPromesseSelfResoved()},p.prototype.getServiceDePromesse=function(){return f.Promesses.getServiceDePromesse()},p.getPromesseSelfResoved=function(){return f.Promesses.getPromesseSelfResoved()},p.prototype.dispose=function(){return this.getPromesseSelfResoved()},p.prototype.getPromesseSelfResoved=function(){return f.Promesses.getPromesseSelfResoved()},p.prototype.createPromiseSelfResolved=function(e){return f.Promesses.createPromiseSelfResolved(e)},p.prototype.createPromiseSelfError=function(e){return f.Promesses.createPromiseSelfError(e)},p.createPromiseSelfResolved=function(e){return f.Promesses.createPromiseSelfResolved(e)},p.createPromiseSelfError=function(e){return f.Promesses.createPromiseSelfError(e)},p.executePromisesSequentially=function(e){return f.Promesses.executePromisesSequentially(e)},p.executePromisesSimultaneous=function(e){return f.Promesses.executePromisesSimultaneous(e)},p.executePromisesSimultaneousAndWaitAllResolves=function(e){return f.Promesses.executePromisesSimultaneousAndWaitAllResolves(e)},p.prototype.FindKeysToReplace=function(e){for(var t=[],n=0,r=!1;!r;){var i=e.indexOf("[",n);if(0<=i){var o=e.indexOf("]",i);if(0<o){-1!=e.indexOf("[",i+1)&&e.indexOf("[",i+1)<o&&(i=e.indexOf("[",i+1));var s=e.substring(i+1,o);'"'!==s[0]&&t.push(s)}else r=!0;n=o}else r=!0}return t},p.prototype.GetBrowser=function(){return p.GetBrowserStatic()},p.GetBrowserStatic=function(){if(!navigator&&!navigator.platform)return null;var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===n[1]&&null!=(e=t.match(/\bOPR\/(\d+)/))?"Opera "+e[1]:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n[0])},p.prototype.GetBrowserVersion=function(){return p.GetBrowserVersionStatic()},p.GetBrowserVersionStatic=function(){if(!navigator&&!navigator.platform)return null;var e,t=navigator.userAgent,n=t.match(/(opera|chrome|safari|firefox|msie|trident(?=\/))\/?\s*(\d+)/i)||[];return/trident/i.test(n[1])?"IE "+((e=/\brv[ :]+(\d+)/g.exec(t)||[])[1]||""):"Chrome"===n[1]&&null!=(e=t.match(/\bOPR\/(\d+)/))?"Opera "+e[1]:(n=n[2]?[n[1],n[2]]:[navigator.appName,navigator.appVersion,"-?"],null!=(e=t.match(/version\/(\d+)/i))&&n.splice(1,1,e[1]),n[1])},p.IsMobileBrowser=function(){return!!/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)},p.prototype.SerializeScope=function(e){var t={};return this.ApplyProperties(e,t),JSON.stringify(t)},p.prototype.ApplyProperties=function(e,t){for(var n in e)e.hasOwnProperty(n)&&"$"!==n.substring(0,1)&&(p.IsFunction(e[n])||(t[n]=e[n]))},p.IsFunction=function(e){return e&&"[object Function]"==={}.toString.call(e)},p.checkIsIE=function(){return-1<N.Services.CoreCommon.getInternetExplorerVersion()},p.prototype.serviceLocalDisponible=function(){return this._serviceLocalDisponible},p.getInternetExplorerVersion=function(){var e=-1;if("Microsoft Internet Explorer"==navigator.appName){var t=navigator.userAgent;null!=new RegExp("MSIE ([0-9]{1,}[.0-9]{0,})").exec(t)&&(e=parseFloat(RegExp.$1))}else if("Netscape"==navigator.appName){t=navigator.userAgent;null!=new RegExp("Trident/.*rv:([0-9]{1,}[.0-9]{0,})").exec(t)&&(e=parseFloat(RegExp.$1))}return e},p.prototype.SwapArrayElements=function(e,t,n){if(!e)throw"arrayObject null";if(t<0||t>e.length-1)throw"index_a non valide";if(n<0||n>e.length-1)throw"index_b non valide";if(t!==n){var r=e[t];e[t]=e[n],e[n]=r}},p.SendRequestWithPromise=function(e){var t=p.ServiceDePromesse.defer();try{p.SendRequest(e,t.resolve,t.reject)}catch(e){t.reject(new f.Erreur(e))}return t.promise},p.registerMethodForSendRequest=function(e){p._methodForSendRequest=e,p._waitSendRequestBapi&&(p._waitSendRequestBapi.forEach(function(e){p.SendRequest(e.param,e.defer.resolve,e.defer.reject)}),p._waitSendRequestBapi.length=0)},p.prototype.sendRequest=function(t){return this.promesseTryCatch(function(e){p.SendRequest(t,e.resolve,e.reject)})},p.SendRequest=function(n,r,i){var o=this;if(p.CheckSettings(n),n.url&&0===n.url.indexOf("https://rs-biz-std-ce-dev.hpr.api-wsg.f.bbg")||n.url.includes("/aideenligne/v1/")){if(!p._methodForSendRequest){var e=p.ServiceDePromesse.defer();return p._waitSendRequestBapi.push({defer:e,param:n}),void e.promise.then(r,i)}var s=!1;return p.PreventMultipleJSONCalls&&5<c.url.length&&".json"===c.url.substring(c.url.length-5)&&(s=!0),n.refer=n.refer||location.href,void p._methodForSendRequest(n).then(function(e){"string"!=typeof e.body&&(e.body=JSON.stringify(e.body));var t="text";e.headers&&e.headers["content-type"]&&0<=e.headers["content-type"].indexOf("application/json")&&(t="json"),p.SendOnLoad(new d(e.statusCode,e.headers,e.body,t),__assign({},n,{success:r,error:i}),s,f.Loggers.loggerToTrace(n.logger))},i)}var t=n.url,a="";f.Controle.StaticAnyControle.isNotUndefinedAndNotNull(n.params)&&(a=p.GetParams(n.params)),t&&""!==a&&(t=t+"?"+a);var u,c={};if(c.url=t||"ceciestuntest?"+a,c.async=n.async,c.headers={},n.additionalHeaders)for(u in n.additionalHeaders){var l=n.additionalHeaders[u];c.headers[u]=l}if(n.method===h.DELETE?c.method="DELETE":n.method===h.GET?c.method="GET":n.method===h.POST?c.method="POST":n.method===h.PUT&&(c.method="PUT"),n.accept===g.ALL?c.headers.Accept="*/*":n.accept===g.JSON&&(c.headers.Accept="application/json"),p.AddMyWayHeaders(c,n),n.data)if(n.contentType===y.JSON)c.data=JSON.stringify(n.data),c.headers["Content-Type"]="application/json";else{if(n.contentType!==y.URL_ENCODED)throw"data is not null and settings is unknown";c.data=p.GetParams(n.data),c.headers["Content-Type"]="application/x-www-form-urlencoded"}switch(n.responseType){case m.BLOB:c.responseType="blob";break;case m.JSON:c.responseType="json";break;case m.EMPTY:c.responseType="";break;default:n.method===h.GET?c.responseType="json":c.responseType=""}n.timeout&&(c.timeout=n.timeout),!0===n.originalResponse&&(c.originalResponse=!0);return c.success=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];r&&r.apply(o,e),f.Loggers.FLASH.INSTANCE.setValue("details",c.url),p.logger.debug("SendRequest success")},c.error=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];i&&i.apply(o,e),f.Loggers.FLASH.INSTANCE.setValue("details",c.url),p.logger.warn("SendRequest failed")},t?p.Send(c,f.Loggers.loggerToTrace(n.logger),n.withHeaders):(f.Loggers.FLASH.INSTANCE.setValue("action","SendRequest"),p.logger.warn("Aucune URL n'a été fournie"),i(new f.Erreur("Aucune URL n'a été fournie"))),c},p.FixedEncodeURIComponent=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})},p.GetParams=function(e){var n="",t=!0;if(!f.Controle.StaticObjectControle.isObject(e))return n;for(var r in e)f.Controle.StaticStringControle.isStringNotEmpty(r)&&e.hasOwnProperty(r)&&(t||(n+="&"),t=!1,f.Controle.StaticObjectControle.isObject(e[r])?n+=r+"="+this.FixedEncodeURIComponent(JSON.stringify(e[r])):Array.isArray(e[r])?e[r].forEach(function(e,t){n+=(0<t?"&":"")+r+"="+e}):n+=r+"="+e[r]);return n},p.addListenerOnAddMyWayHeaders=function(e){p.listenersOnAddMyWayHeaders.push(e)},p.removeListenerOnAddMyWayHeaders=function(t){p.ArrayUtils.remove(p.listenersOnAddMyWayHeaders,function(e){return e===t})},p.AddMyWayHeaders=function(t,n){n.withHeaders&&(t.headers["X-versionComposant"]=n.versionComposant,t.headers["X-typeOrigineComposant"]="1",t.headers["X-dateHeureInstanciation"]=Date.now().toString(),t.headers["X-typeCanal"]="01",t.headers["X-typeDevice"]="01",p.listenersOnAddMyWayHeaders.forEach(function(e){e(t.headers,n)})),n.cache||(t.headers["Cache-Control"]="no-cache",t.headers.Pragma="no-cache")},p.Send=function(t,n,e){p.logger.debug("Debut envoi requete: %1",t.url);var r=!1;if(p.PreventMultipleJSONCalls&&5<t.url.length&&".json"===t.url.substring(t.url.length-5)&&(r=!0,p.SavedJSON[t.url]))t.success(p.SavedJSON[t.url]);else{var i=new XMLHttpRequest;for(var o in i.open(t.method,t.url,t.async),e&&!0===t.async&&(i.withCredentials=!0),!0===t.async&&(t.timeout?i.timeout=t.timeout:i.timeout=3e4),i.ontimeout=function(){p.traiterErreur(i,t,n,null,!0)},i.onload=function(e){p.SendOnLoad(i,t,r,n)},t.cancel=function(){i.abort()},t.headers){var s=t.headers[o];try{if(s){var a=new RegExp("\\p{Diacritic}","gu");s=s.normalize("NFD").replace(a,"").replace(/[^\x00-\x7F]/g," ")}}catch(e){}i.setRequestHeader(o,s)}if(t.async)i.onerror=function(e){p.traiterErreur(i,t,n)},i.send(t.data);else try{i.send(t.data)}catch(e){p.traiterErreur(i,t,n,e)}}},p.SendOnLoad=function(e,t,n,r){if(e.status<400){if(p.logger.debug("Success requete: %1",t.url),f.Controle.StaticFunctionControle.isFunction(t.success))if(t.originalResponse)t.success(e);else{var i=p.GetResponse(e,t.responseType,r);p.PreventMultipleJSONCalls&&n&&(p.SavedJSON[t.url]=i),t.success(i)}}else p.traiterErreur(e,t,r)},p.GetResponse=function(t,e,n){var r=t.response;if(f.Controle.StaticStringControle.isString(t.response)&&""!==t.response&&("json"===t.responseType||"json"===e))try{r=JSON.parse(t.response)}catch(e){var i="une erreur (";e&&(i+=e.message),i+=") est survenue en déserialisant le json suivant : '"+t.response+"'",p.logger.warn(i)}return r},p.traiterErreur=function(e,t,n,r,i){if(n){var o={};e.response?f.Controle.StaticStringControle.isString(e.response)&&(o={text:e.response}):p.logger.error("Aucune réponse à la requête retournée"),i?(o.clientTimeout=!0,f.Loggers.FLASH.INSTANCE.setValue("action","traiterErreur"),f.Loggers.FLASH.INSTANCE.setValue("details",o),p.logger.error("Erreur requete (timeout client): %1",t.url)):0==e.status?(f.Loggers.FLASH.INSTANCE.setValue("action","traiterErreur"),f.Loggers.FLASH.INSTANCE.setValue("details",o),p.logger.error("Erreur requete (acces serveur impossible): %1",t.url)):(f.Loggers.FLASH.INSTANCE.setValue("action","traiterErreur"),f.Loggers.FLASH.INSTANCE.setValue("details",o),p.logger.error("Erreur requete (%1): %2",e.status,t.url))}var s;if(f.Controle.StaticFunctionControle.isFunction(t.error)){if(r)s=new u(f.Libelle.LibelleModel.COM.ERREUR_SERVEUR,[e.statusText+"\nErreur levée : "+r.toString()],r);else{var a=p.GetResponse(e,"json",n);f.Controle.StaticObjectControle.isObject(a)&&a.codeLibelle?(s=a).codeHttp=e.status:s=i?new c(e.status,f.Libelle.LibelleModel.COM.ERREUR_TIMEOUT_CLIENT,e.statusText):403===e.status&&a.codeLibelle&&"ECH.LOG_ERREUR_USER_NON_AUTORISE"===a.codeLibelle?new c(e.status,f.Libelle.LibelleModel.COM.ERREUR_HABILITATION_AUTHENTIFICATION_MANQUANTE,e.statusText):504===e.status?new c(e.status,f.Libelle.LibelleModel.COM.ERREUR_TIMEOUT_SERVEUR,e.statusText):0===e.status?new c(e.status,f.Libelle.LibelleModel.COM.ERREUR_ACCES_SERVEUR,e.statusText):new c(e.status,f.Libelle.LibelleModel.COM.ERREUR_SERVEUR,e.statusText)}t.error(s)}},p.addListenerOnCheckSettings=function(e){this.listenersOnCheckSettings.push(e)},p.removeListenerOnCheckSettings=function(t){p.ArrayUtils.remove(this.listenersOnCheckSettings,function(e){return e===t})},p.CheckSettings=function(t){if(!f.Controle.StaticObjectControle.isObject(t))throw"settings doit être un objet non null!";f.Controle.StaticEnumControle.isAnEnumValue(t.method,h)||(f.Controle.StaticAnyControle.isNotUndefinedAndNotNull(t.data)?t.method=h.POST:t.method=h.GET),f.Controle.StaticBooleanControle.isBoolean(t.async)||(t.async=!0),f.Controle.StaticEnumControle.isAnEnumValue(t.contentType,y)||(f.Controle.StaticAnyControle.isNotUndefinedAndNotNull(t.data)?t.contentType=y.JSON:t.contentType=y.NONE),f.Controle.StaticEnumControle.isAnEnumValue(t.accept,g)||(t.accept=g.ALL),f.Controle.StaticBooleanControle.isBoolean(t.cache)||(t.cache=!0),f.Controle.StaticBooleanControle.isBoolean(t.withHeaders)||(t.withHeaders=!0),f.Controle.StaticEnumControle.isAnEnumValue(t.responseType,m)||(t.responseType=m.NOT_DEFINED),!t.versionComposant&&p.VersionMySys&&(t.versionComposant=p.VersionMySys),p.listenersOnCheckSettings.forEach(function(e){e(t)})},p.creerChaineAleatoire=function(e){for(var t=Math.random().toString(36).substring(2);t.length<e;)t+=Math.random().toString(36).substring(2);return t.length>e&&(t=t.substring(0,e)),t},p.prototype.creerChaineAleatoire=function(e){return p.creerChaineAleatoire(e)},p.applyProperties=function(e,t,n){if(N.Services.Controle.StaticObjectControle.isObject(e[n]))for(var r in t[n]||(t[n]={}),e[n])N.Services.Controle.StaticObjectControle.isObject(e[n][r])?this.applyProperties(e[n],t[n],r):t[n][r]=e[n][r];else t[n]=e[n]},p.loadCdnServiceScript=function(e){var t=p.getBaseFolder(e);t&&p.loadScript(t+"/"+e)},p.loadCdnAddonsServiceScript=function(e){var t=p.getBaseFolder(e);t&&p.loadScript(t+"/../services-addons/"+e)},p.getBaseFolder=function(e){var t=document.getElementsByTagName("script"),n=null;for(var r in t){var i=t[r];if(i&&i.src&&0<i.src.indexOf("framework-client-")){n=i.src;break}}if(n){for(var o="",s=n.split("/"),a=0;a<s.length-1;a++)o+=s[a]+"/";return o.substr(0,o.length-1)}return null},p.loadScript=function(e){var t=document.getElementsByTagName("body")[0],n=document.createElement("script");n.type="text/javascript",n.src=e,t.appendChild(n)},p.encoderURL=function(e){return encodeURIComponent(e).replace(/[!'()*]/g,function(e){return"%"+e.charCodeAt(0).toString(16)})},p.promesseTryCatch=function(e,t){return f.Promesses.promesseTryCatch(e,t)},p.prototype.promesseTryCatch=function(e,t){return f.Promesses.promesseTryCatch(e,t)},p.isObject=function(e){return e&&"object"==typeof e&&!Array.isArray(e)&&null!==e},p.CLASS_NAME="MyWay.Services.CoreCommon",p.logger=f.Loggers.LoggerFactory.INSTANCE.getClass(p.CLASS_NAME),p._waitSendRequestBapi=[],p.PreventMultipleJSONCalls=!1,p.VersionMySys=null,p.listenersOnAddMyWayHeaders=[],p.SavedJSON=[],p.listenersOnCheckSettings=[],p.StringUtils={leftPad:function(e,t,n){for(var r=e.toString();r.length<n;)r=t+r;return r},rightPad:function(e,t,n){for(var r=e.toString();r.length<n;)r+=t;return r}},p.ArrayUtils={remove:function(e,t){if(!e)return e;for(var n=e.length,r=[],i=0;i<n;i++){var o=e[i];t(o)||r.push(o)}n=r.length;for(i=0;i<n;i++)e[i]=r[i];return e.length=r.length,e},keyExists:function(e,t){if(!t||t.constructor!==Array&&t.constructor!==Object)return!1;for(var n=0;n<t.length;n++)if(t[n]===e)return!0;return e in t},getOne:function(e,t){for(var n=e.length;n--;)if(t(e[n]))return e[n];return null}},p.EnumUtils={getNamesAndValues:function(t){return p.EnumUtils.getNames(t).map(function(e){return{name:e,value:t[e]}})},getNames:function(e){return p.EnumUtils.getObjValues(e).filter(function(e){return"string"==typeof e})},getValues:function(e){return p.EnumUtils.getObjValues(e).filter(function(e){return"number"==typeof e})},getObjValues:function(t){return Object.keys(t).map(function(e){return t[e]})},listerEnums:function(e){var t=[];for(var n in e)"number"==typeof e[n]&&t.push(n);return t},getName:function(e,t){var n=null;for(var r in e)"number"==typeof e[r]&&e[r]===t&&(n=r);return n}},p.ObjectUtils={hasKeys:function(e,t,n){void 0===n&&(n=!1);var r=!0;return(!n||e.length==Object.keys(t).length)&&(e.forEach(function(e){N.Services.CoreCommon.ArrayUtils.keyExists(e,t)||(r=!1)}),r)},objectExistsByKeyValueList:function(e,t){for(var n=0;n<t.length;n++)if(N.Services.CoreCommon.ObjectUtils.hasKeyValuePairList(t[n],e))return t[n];return null},hasKeyValuePairList:function(e,t){for(var n=0;n<t.length;n++)if(!e.hasOwnProperty(t[n].Key)||e[t[n].Key]!=t[n].Value)return!1;return!0},objectToArray:function(e){var t=[];for(var n in e)t.push({Key:n,Value:e[n]});return t},merge:function(t,n){for(var r in n)try{N.Services.CoreCommon.isObject(n[r])?t[r]=N.Services.CoreCommon.ObjectUtils.merge(t[r],n[r]):t[r]=n[r]}catch(e){t[r]=n[r]}return t},deepEquals:function(e,t){if(e===t)return!0;if(!e||!t)return!1;if(typeof e!=typeof t)return!1;if("object"!=typeof e)return!1;for(var n in e)if(!p.ObjectUtils.deepEquals(e[n],t[n]))return!1;for(var n in t)if(void 0!==t[n]&&void 0===e[n])return!1;return!0}},p}(f.Components.ComponentBase);f.CoreCommon=n;var r=function(e,t,n,r){this.CodeRetour=e,this.MessageRetour=t,this.DonneesRetour=n,this.Pid=r};f.ExecutionAppliExt=r;var u=function(i){function e(e,t,n){var r=i.call(this,e,t)||this;return r.error=n,r}return __extends(e,i),e}(f.Erreur);f.ErreurClient=u;var y,i,m,o,g,s,h,a,c=function(s){function e(e,t,n,r,i){var o=s.call(this,t,r)||this;return o.codeHttp=e,o.libelle=n,o.causes=i,o}return __extends(e,s),e}(f.Erreur);f.ErreurServeur=c,(i=y=f.ContentTypeEnum||(f.ContentTypeEnum={}))[i.NONE=0]="NONE",i[i.URL_ENCODED=1]="URL_ENCODED",i[i.JSON=2]="JSON",(o=m=f.ResponseTypeEnum||(f.ResponseTypeEnum={}))[o.BLOB=0]="BLOB",o[o.JSON=1]="JSON",o[o.EMPTY=2]="EMPTY",o[o.NOT_DEFINED=3]="NOT_DEFINED",(s=g=f.AcceptEnum||(f.AcceptEnum={}))[s.ALL=0]="ALL",s[s.JSON=1]="JSON",(a=h=f.MethodEnum||(f.MethodEnum={}))[a.DELETE=0]="DELETE",a[a.GET=1]="GET",a[a.POST=2]="POST",a[a.PUT=3]="PUT";var l=function(){function e(){this.codeApplication="inconnu",this.stepId="inconnu",this.stepPath="inconnu",this._previousStepEndTime=0,this._stepStartTime=0,this._displayTime=0,this._initTime=0,this._lastDigestCycleTime=0,this.watchers=0,this.digestCycles=0,this.contextSize=0,this._userTime=-1,this.finalDiagnostic=!1}return Object.defineProperty(e.prototype,"previousStepEndTime",{set:function(e){this._previousStepEndTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stepStartTime",{set:function(e){this._previousStepEndTime&&e<this._previousStepEndTime&&(e=this._previousStepEndTime),this._stepStartTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"displayTime",{set:function(e){this._stepStartTime&&e<this._stepStartTime&&(e=this._stepStartTime),this._displayTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"initTime",{set:function(e){this._displayTime&&e<this._displayTime&&(e=this._displayTime),this._initTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userTime",{set:function(e){this._userTime=0===e?0:(this._initTime&&e<this._initTime&&(e=this._initTime),e)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"lastDigestCycleTime",{set:function(e){this._initTime&&e<this._initTime&&(e=this._initTime),this._lastDigestCycleTime=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stepStartDuration",{get:function(){return this._displayTime-this._previousStepEndTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"staticFilesLoadDuration",{get:function(){return this._initTime-this._displayTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"digestDuration",{get:function(){return this._lastDigestCycleTime-this._initTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userDuration",{get:function(){return this.userDurationEnabled?this._userTime-this._displayTime:this._lastDigestCycleTime-this._displayTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalDisplayDuration",{get:function(){return this.staticFilesLoadDuration+this.digestDuration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalStartDuration",{get:function(){return this.stepStartDuration+this.totalDisplayDuration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"totalUserDuration",{get:function(){return this.stepStartDuration+this.userDuration},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userDurationEnabled",{get:function(){return 0<this._userTime},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"startStatus",{get:function(){return 1e4<this.totalDisplayDuration?"danger":5e3<this.totalDisplayDuration?"warn":""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"watchersStatus",{get:function(){return 2e3<this.watchers?"danger":1e3<this.watchers?"warn":""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"digestStatus",{get:function(){return""},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextStatus",{get:function(){return 1e5<this.contextSize?"danger":5e4<this.contextSize?"warn":""},enumerable:!0,configurable:!0}),e.prototype.clone=function(e){this.codeApplication=e.codeApplication,this.stepId=e.stepId,this.stepPath=e.stepPath,this._previousStepEndTime=e._previousStepEndTime,this._stepStartTime=e._stepStartTime,this._displayTime=e._displayTime,this._initTime=e._initTime,this._lastDigestCycleTime=e._lastDigestCycleTime,this.watchers=e.watchers,this.digestCycles=e.digestCycles,this.contextSize=e.contextSize,this.finalDiagnostic=e.finalDiagnostic},e}();f.ApplicationDiagnostic=l;var p,v=function(e,t){this.Header=e,this.Payload=t};f.MessageAppliExterne=v,(p=f.PayloadType||(f.PayloadType={}))[p.CONNECT=0]="CONNECT",p[p.DISCONNECT=1]="DISCONNECT",p[p.SEND=2]="SEND";var S=function(){};f.Header=S;var C=function(){};f.Sender=C;var b=function(){};f.Receiver=b;var O=function(){};f.Entity=O;var E=function(e,t){this.Sujet=e,this.Contenu=t};f.Payload=E,f.Components.RegistryCommon.getInstance().register(n)}(N.Services||(N.Services={}))}(MyWay||(MyWay={})),function(){"use strict";var p;Date.prototype.toPrunedJSON=Date.prototype.toJSON,String.prototype.toPrunedJSON=String.prototype.toJSON;var t=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,n={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"};function f(e){return t.lastIndex=0,t.test(e)?'"'+e.replace(t,function(e){var t=n[e];return"string"==typeof t?t:"\\u"+("0000"+e.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+e+'"'}JSON.pruned=function(e,t,n){return p=[],function e(t,n,r,i){var o,s,a,u,c,l=n[t];if(l&&"object"==typeof l&&"function"==typeof l.toPrunedJSON&&(l=l.toPrunedJSON(t)),null==l)return String(l);switch(typeof l){case"string":return f(l);case"number":return isFinite(l)?String(l):"null";case"boolean":return String(l);case"object":if(!l)return"null";if(r<=0||-1!==p.indexOf(l))return console.warn("... oh oh, it seems this object is too deep... depth max is "+r),'"-pruned-"';if(p.push(l),c=[],"[object Array]"===Object.prototype.toString.apply(l)){for(u=Math.min(l.length,i),o=0;o<u;o+=1)c[o]=e(o,l,r-1,i)||"null";return a=0===c.length?"[]":"["+c.join(",")+"]"}for(s in l)if(Object.prototype.hasOwnProperty.call(l,s))try{(a=e(s,l,r-1,i))&&c.push(f(s)+":"+a)}catch(e){}return a=0===c.length?"{}":"{"+c.join(",")+"}"}}("",{"":e},t=t||6,n=n||50)}}(),function(e){var t;t=function(){},(e.Services||(e.Services={})).NotificationMessage=t}(MyWay||(MyWay={})),function(e){var t,n,r;t=e.Services||(e.Services={}),n=t.Common||(t.Common={}),r=function(){function e(e,t){this._doublonsPossibles=!1,this._nombreElements=0,this._fonctionCompare=e,this._doublonsPossibles=t}return e.prototype.testerElements=function(e,t){return this._fonctionCompare(e,t)},Object.defineProperty(e.prototype,"doublonsPossibles",{get:function(){return this._doublonsPossibles},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"nombreElements",{get:function(){return this._nombreElements},enumerable:!0,configurable:!0}),e.prototype.ajouter=function(e){return this._racine?!!this.placerElement(e,this._racine)&&(this._nombreElements++,!0):(this._racine={parent:null,precedent:null,suivant:null,valeur:e},this._nombreElements=1,!0)},e.prototype.retirer=function(e){if(this._racine){var t=this.getMinimum(this._racine);if(null!==t)for(;t;)e(t.valeur)&&(this.retirerElement(t),this._nombreElements--),t=this.getSuivant(t)}},e.prototype.inferieurAAsc=function(e,t,n){if(this._racine){var r=this.getMinimum(this._racine),i=this.getPlusGrandInferieurA(e,t,this._racine);if(null!==r&&null!==i){for(;r!==i;)n(r.valeur),r=this.getSuivant(r);n(r.valeur)}}},e.prototype.inferieurADesc=function(e,t,n){if(this._racine){var r=this.getPlusGrandInferieurA(e,t,this._racine);if(null!=r)for(;null!=r;)n(r.valeur),r=this.getPrecedent(r)}},e.prototype.superieurAAsc=function(e,t,n){if(this._racine){var r=this.getPlusPetitSuperieurA(e,t,this._racine);if(null!=r)for(;null!=r;)n(r.valeur),r=this.getSuivant(r)}},e.prototype.superieurADesc=function(e,t,n){if(this._racine){var r=this.getMaximum(this._racine),i=this.getPlusPetitSuperieurA(e,t,this._racine);if(null!==r&&null!==i){for(;r!==i;)n(r.valeur),r=this.getPrecedent(r);n(r.valeur)}}},e.prototype.entreBornesAsc=function(e,t,n,r,i){if(this._racine){var o=this.getPlusPetitSuperieurA(e,t,this._racine),s=this.getPlusGrandInferieurA(n,r,this._racine);if(null!==o&&null!==s){for(var a=o;a!==s;)i(a.valeur),a=this.getSuivant(a);i(a.valeur)}}},e.prototype.entreBornesDesc=function(e,t,n,r,i){if(this._racine){var o=this.getPlusPetitSuperieurA(e,t,this._racine),s=this.getPlusGrandInferieurA(n,r,this._racine);if(null!==o&&null!==s){for(var a=s;a!==o;)i(a.valeur),a=this.getPrecedent(a);i(a.valeur)}}},e.prototype.toutParcourir=function(e){if(this._racine)for(var t=this.getMinimum(this._racine);null!=t;)e(t.valeur),t=this.getSuivant(t)},e.prototype.getParCritere=function(e,t){if(this._racine)for(var n=this.getMinimum(this._racine);null!=n;)e(n.valeur)&&t(n.valeur),n=this.getSuivant(n)},e.prototype.isExists=function(e){return null!==this.getElementInternal(e,this._racine)},e.prototype.getElement=function(e){return this.getElementInternal(e,this._racine)},e.prototype.getElementInternal=function(e,t){if(!t)return null;var n=this._fonctionCompare(t.valeur,e);return 0===n?t.valeur:n<0?t.suivant?this.getElementInternal(e,t.suivant):null:t.precedent?this.getElementInternal(e,t.precedent):null},e.prototype.getPlusGrandInferieurA=function(e,t,n){var r=this._fonctionCompare(n.valeur,e);if(r<0||0===r&&t){if(n.suivant){var i=this.getPlusGrandInferieurA(e,t,n.suivant);return i||n}return n}return n.precedent?this.getPlusGrandInferieurA(e,t,n.precedent):null},e.prototype.getPlusPetitSuperieurA=function(e,t,n){var r=this._fonctionCompare(n.valeur,e);if(0<r||0===r&&t){if(n.precedent){var i=this.getPlusPetitSuperieurA(e,t,n.precedent);return i||n}return n}return n.suivant?this.getPlusPetitSuperieurA(e,t,n.suivant):null},e.prototype.getMinimum=function(e){for(var t=e;t.precedent;)t=t.precedent;return t},e.prototype.getMaximum=function(e){for(var t=e;t.suivant;)t=t.suivant;return t},e.prototype.getSuivant=function(e){if(e.suivant)return this.getMinimum(e.suivant);if(e.parent){if(e.parent.precedent===e)return e.parent;for(var t=e;t.parent&&t.parent.suivant===t;)t=t.parent;return t.parent?t.parent:null}return null},e.prototype.getPrecedent=function(e){if(e.precedent)return this.getMaximum(e.precedent);if(e.parent){if(e.parent.suivant===e)return e.parent;for(var t=e;t.parent&&t.parent.precedent===t;)t=t.parent;return t.parent?t.parent:null}return null},e.prototype.placerElement=function(e,t){var n=this._fonctionCompare(t.valeur,e);return n<=0?!(0===n&&!this._doublonsPossibles)&&(t.suivant?this.placerElement(e,t.suivant):(t.suivant={valeur:e,precedent:null,suivant:null,parent:t},!0)):t.precedent?this.placerElement(e,t.precedent):(t.precedent={valeur:e,precedent:null,suivant:null,parent:t},!0)},e.prototype.retirerElement=function(e){var t,n=null,r=!e.parent;if(e.precedent)if(e.suivant){for(n=e.suivant,r||e.parent.precedent!==e?r||(e.parent.suivant=e.suivant,e.suivant.parent=e.parent):(e.parent.precedent=e.suivant,e.suivant.parent=e.parent),t=e.suivant;t.precedent;)t=t.precedent;t.precedent=e.precedent,t.precedent.parent=t}else n=e.precedent,r||e.parent.precedent!==e?r||(e.parent.suivant=e.precedent,e.precedent.parent=e.parent):(e.parent.precedent=e.precedent,e.precedent.parent=e.parent);else e.suivant?(n=e.suivant,r||e.parent.precedent!==e?r||(e.parent.suivant=e.suivant,e.suivant.parent=e.parent):(e.parent.precedent=e.suivant,e.suivant.parent=e.parent)):(n=null,r||e.parent.precedent!==e?r||(e.parent.suivant=null):e.parent.precedent=null);r&&(null===n?this._racine=null:(this._racine=n).parent=null)},e}(),n.ArbreBinaire=r}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),((n=t.Components||(t.Components={})).ComponentType||(n.ComponentType={})).Loggers="Loggers"}(MyWay||(MyWay={})),function(e){var t,n,r;t=e.Services||(e.Services={}),n=t.Loggers||(t.Loggers={}),(r=n.LoggersMessageSubject||(n.LoggersMessageSubject={}))[r.GetConfigActual=0]="GetConfigActual",r[r.SetConfigActual=1]="SetConfigActual",r[r.GetConfigDB=2]="GetConfigDB",r[r.SetConfigDB=3]="SetConfigDB",r[r.SaveConfig=4]="SaveConfig",r[r.LoadConfig=5]="LoadConfig",r[r.GetLoggers=6]="GetLoggers",r[r.GetNomConfigAcuelle=7]="GetNomConfigAcuelle",r[r.IsClassExists=8]="IsClassExists",r[r.Reset=9]="Reset",t.Components.FactoryRegistries.getInstance().declareComponent(t.Components.ComponentType.Loggers,[t.Components.ComponentType.Core,t.Components.ComponentType.Evennements])}(MyWay||(MyWay={})),function(e){var p,t,r,n;p=e.Services||(e.Services={}),t=p.Message||(p.Message={}),r=function(){},n=function(){function s(e,t,n,r,i,o,s,a){var u=this;this.canReceiveResponses=s,this.canReceiveNewMessages=a,this._currentIndex=0,this._callbackArray=[],this._me=null,this._ReceiveMessage=function(e){var t=e.data;if(t.RecipientZone===u._zoneName){if(null===t.Subject||void 0===t.Subject)throw"Subject is null - "+JSON.stringify(t);t.Subject.substring&&"Response - "===t.Subject.substring(0,11)?u.canReceiveResponses&&u.handleResponse(e):u.canReceiveNewMessages&&u.handleReception(e)}},this._SendResponse=function(e,t,n){var r=e.data,i={RequestId:r.RequestId,RecipientZone:r.SenderZone,RecipientComponent:null,SenderZone:u._zoneName,Subject:"Response - "+r.Subject,Content:t,CallbackIndex:r.CallbackIndex,ErreurCallbackIndex:r.ErreurCallbackIndex,Error:null};return p.CoreCommon.getPromesseSelfResoved().then(function(){if(n&&"Manager"===u._zoneName&&u._library.Libelle&&n.codeLibelle&&!n.libelle)return u._library.Libelle.constituerLibelle(n.codeLibelle,n.valeurs).then(function(e){n.libelle=e})}).then(function(){n&&JSON&&(i.Error=JSON.parse(JSON.stringify(n))),u.ValidateMessage(i),e.source&&u.postMessage(i,e.source,e.origin,null)})},this._targetWindow=e,this._targetDomain=t,this._authorizedDomains=n,this._recipientZone=r,this._zoneName=i,this._me=Math.random().toString(36).substring(2),this._library=o}return s.prototype.createMessage=function(e,t,n,r,i){return{RequestId:"",SenderZone:this._zoneName,RecipientZone:this._recipientZone,RecipientComponent:e,Subject:t,Content:n,CallbackIndex:r,ErreurCallbackIndex:i,Error:null}},s.prototype.send=function(e,t,n,r,i,o){return this.sendWithResponse(e,t,n,r,i,o)},s.prototype.sendWithResponse=function(n,r,i,o,s,a){var u=this,c=null,l=null;return p.CoreCommon.promesseTryCatch(function(e){c=u._AddCallback(e.resolve),l=u._AddCallback(e.reject),o||(o=u._targetWindow),s||(s=u._targetDomain);var t=u.createMessage(n,r,i,c,l);u.ValidateMessage(t),s&&o?u.postMessage(t,o,s,a):(e.reject(new p.Erreur('Impossible d\'envoyer le message, la "target domain" et la "target window" n\'existent pas')),u._RemoveCallback(c),u._RemoveCallback(l))}).catch(function(e){throw u._RemoveCallback(c),u._RemoveCallback(l),e})},s.prototype._AddCallback=function(e){return this._currentIndex++,this._callbackArray[this._currentIndex]=e,this._currentIndex},s._getBaseDomain=function(e){var t=new r;if(0===e.indexOf("http://")){t.Root="http://";var n=e.replace("http://","").split("/")[0].split(":");t.Name=n[0],2==n.length?t.Port=n[1]:t.Port="80"}else 0===e.indexOf("https://")&&(t.Root="https://",n=e.replace("https://","").split("/")[0].split(":"),t.Name=n[0],2==n.length?t.Port=n[1]:(t.Root="http://",t.Port="443"));return t},s.prototype.handleReception=function(e){e.data,this.transmettreMessage(e)},s.prototype.transmettreMessage=function(t){var n=this,e=t.data;if(!s.IsDomainAuthorized(t.origin,this._authorizedDomains))throw t.origin+" is not authorized at Reception : "+JSON.stringify(e)+";"+JSON.stringify(this._authorizedDomains);var r=e.RecipientComponent,i=this._library[r];if(i){var o=t.data;try{i.reception({iframe:t.source,message:o.Content,subject:o.Subject}).then(function(e){n._SendResponse(t,e,null)},function(e){n._SendResponse(t,null,e)})}catch(e){console.error(e)}}else s.loggerMessageBase.warn("%1 can't be found. Message : %2",r,JSON.stringify(e)),this._SendResponse(t,null,new p.Erreur("not delivered"))},s.prototype.handleResponse=function(e){var t=e.data;if(!s.IsDomainAuthorized(e.origin,this._authorizedDomains))throw e.origin+" is not authorized at Response : "+JSON.stringify(t)+";"+JSON.stringify(this._authorizedDomains);t.Error?(t.CallbackIndex&&this._RemoveCallback(t.CallbackIndex),t.ErreurCallbackIndex&&this._ExecuteCallback(t.ErreurCallbackIndex,t.Error)):(t.ErreurCallbackIndex&&this._RemoveCallback(t.ErreurCallbackIndex),t.CallbackIndex&&this._ExecuteCallback(t.CallbackIndex,t.Content))},s.IsDomainAuthorized=function(e,t){var n=!1,r=s._getBaseDomain(e);for(var i in t){var o=s._getBaseDomain(t[i]);if(r.Root&&o.Root&&r.Root.toLowerCase()===o.Root.toLowerCase()&&r.Name&&o.Name&&r.Name.toLowerCase()===o.Name.toLowerCase()&&(r.Port===o.Port||"*"===o.Port)){n=!0;break}}return n},s.prototype._ExecuteCallback=function(e,t){var n=this._callbackArray[e];n&&(this._RemoveCallback(e),n(t))},s.prototype._RemoveCallback=function(e){this._callbackArray[e]&&delete this._callbackArray[e]},s.prototype.ValidateMessage=function(e){if(!e.Subject&&0!==e.Subject)throw"Subject is empty";if(e.RecipientZone===e.SenderZone)throw"recipient zone and sender zone are identical : "+e.RecipientZone+" - "+JSON.stringify(e)},s.CLASS_NAMEMessageBase="MyWay.Services.Message.MessageBase",s.loggerMessageBase=p.Loggers.LoggerFactory.INSTANCE.getClass(s.CLASS_NAMEMessageBase),s}(),t.MessageBase=n}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t,n,r;t=e.Services||(e.Services={}),n=t.Core||(t.Core={}),(r=n.CoreMessageSubject||(n.CoreMessageSubject={}))[r.SendRequest=1]="SendRequest",t.Components.FactoryRegistries.getInstance().declareComponent(t.Components.ComponentType.Core,[]),t.Components.FactoryRegistries.getInstance().declareComponent(t.Components.ComponentType.Evennements,[])}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-core-common.min.js.map
var MyWay;!function(e){var y,n;y=e.Services||(e.Services={}),((n=y.Components||(y.Components={})).RegistryType||(n.RegistryType={})).MANAGER="MANAGER"}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-core-business-object.min.js.map
var MyWay;!function(n){var e,r,o,s;e=n.Test||(n.Test={}),r=e.V1||(e.V1={}),(o=r.Services||(r.Services={})).Erreur=n.Services.Erreur,o.Promesses=n.Services.Promesses,o.generateEmptyLibraryCommon=function(){return{Core:{createPromiseSelfResolved:n.Services.CoreCommon.createPromiseSelfResolved,createPromiseSelfError:n.Services.CoreCommon.createPromiseSelfError,promesseTryCatch:n.Services.CoreCommon.promesseTryCatch,getPromesseSelfResoved:n.Services.CoreCommon.getPromesseSelfResoved}}},o.override=function(e,r,o){if(void 0===e[r])throw new n.Services.Erreur("La méthode "+r+" n'existe pas sur l'objet "+e.constructor);e[r]=o},o.generateMessageService=function(){return{dispose:function(){n.Services.CoreCommon.getPromesseSelfResoved()},send:function(e,r,o,s,t,i){return n.Services.CoreCommon.createPromiseSelfError(new n.Services.Erreur("Send method not overrided for tests"))},sendWithResponse:function(e,r,o,s,t,i){return n.Services.CoreCommon.createPromiseSelfError(new n.Services.Erreur("SendWithResponse method not overrided for tests"))}}},(s=o.TestMode||(o.TestMode={}))[s.DeepEquals=0]="DeepEquals",s[s.StrictEquals=1]="StrictEquals",s[s.NoCheck=2]="NoCheck",s[s.ObjectPropertiesEquals=3]="ObjectPropertiesEquals",s[s.ArrayObjectPropertiesEquals=4]="ArrayObjectPropertiesEquals"}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-test-common.min.js.map
"use strict";var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var o;(function(t){var r;(r=t.RegistryType||(t.RegistryType={})).AGENT="AGENT";var e=function(n){function e(){var e=n.call(this,r.AGENT,[r.COMMON])||this;return e.messageService=null,e._agentInitializer=null,e}return __extends(e,n),e.getInstance=function(){return null===e.instance&&(e.instance=new e,t.FactoryRegistries.getInstance().addRegistry(e.instance)),e.instance},Object.defineProperty(e.prototype,"managerInitializer",{set:function(e){this._agentInitializer=e},enumerable:!0,configurable:!0}),e.prototype.getRegistryCommon=function(){return this._dependenciesInstances[0]},e.prototype.init=function(e){var t=this;return this.getRegistryCommon().getComponentsInstances().forEach(function(e){t._componentsInstancesByKey[e.name]||(t._componentsInstances.push(e),t._componentsInstancesByKey[e.name]=e)}),this.messageService||(this.messageService=o.Message.MessageAgentFactory.createMessageAgent(this.getLibrary())),n.prototype.init.call(this,e)},e.prototype.initializeComponent=function(e){return e.init(this._componentsInstancesByKey,this.messageService,this._agentInitializer)},e.instance=null,e}(t.AbstractRegistry);t.RegistryAgent=e})((o=e.Services||(e.Services={})).Components||(o.Components={}))}(MyWay||(MyWay={})),function(e){var r,t,n;r=e.Services||(e.Services={}),t=r.Components||(r.Components={}),n=function(t){function e(e){return t.call(this,e)||this}return __extends(e,t),e.prototype.init=function(e,t,n){return this.library=e,this.messageService=t,r.Promesses.getPromesseSelfResoved()},e.prototype.reception=function(t){var n=this;return r.Promesses.promesseTryCatch(function(e){e.reject(new r.Erreur("Subject "+t.subject+" not implemented on "+n.name+" agent"))})},e.prototype.dispose=function(){return r.Promesses.getPromesseSelfResoved()},e.prototype.sendMessage=function(e,t){return this.messageService.sendWithResponse(this.name,e,t)},e}(t.ComponentBase),t.ComponentAgentBase=n}(MyWay||(MyWay={})),function(e){var t,n,r,o;t=e.Services||(e.Services={}),n=t.Loggers||(t.Loggers={}),r=n.Appenders||(n.Appenders={}),o=function(r){function o(e,t,n){return r.call(this,e,o.CLASSNAME,t,n)||this}return __extends(o,r),Object.defineProperty(o,"METHODE_PURGE_TRACES",{set:function(e){(o._METHODE_PURGE_TRACES=e)&&(o.logs.forEach(function(e){o._METHODE_PURGE_TRACES(e)}),o.logs.length=0)},enumerable:!0,configurable:!0}),o.prototype.onAppend=function(e){o._METHODE_PURGE_TRACES?o._METHODE_PURGE_TRACES(e):o.logs.push(e)},o.CLASSNAME="MyWay.Services.Loggers.Appenders.BroadcastAppender",o.logs=[],o._METHODE_PURGE_TRACES=null,o}(r.AbstractAppender),r.BroadcastAppender=o,n.LoggerFactory.INSTANCE.declareAppender(o.CLASSNAME,o)}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),(n=t.Loggers||(t.Loggers={})).DEFAULT_CONFIGURATION_AGENTS={appenders:[{type:"BROADCAST",level:n.LEVEL.DEBUG,class:"MyWay.Services.Loggers.Appenders.BroadcastAppender",config:{}}],loggers:[{name:"*",level:n.LEVEL.DEBUG,appenders:["BROADCAST"]}]},n.LoggerFactory.INSTANCE.loadConfiguration()}(MyWay||(MyWay={})),function(e){var n,r,t;n=e.Services||(e.Services={}),r=n.Controle||(n.Controle={}),t=function(e){function t(){return e.call(this,n.Components.ComponentType.Controle)||this}return __extends(t,e),Object.defineProperty(t.prototype,"Any",{get:function(){return t.logger.info("Méthode à surveiller - AnyControle"),new r.AnyControle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Array",{get:function(){return t.logger.info("Méthode à surveiller - AnyControleArrayControle"),new r.ArrayControle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Boolean",{get:function(){return t.logger.info("Méthode à surveiller - BooleanControle"),new r.BooleanControle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Date",{get:function(){return t.logger.info("Méthode à surveiller - DateControle"),new r.DateControle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Enum",{get:function(){return t.logger.info("Méthode à surveiller - EnumControle"),new r.EnumControle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Function",{get:function(){return t.logger.info("Méthode à surveiller - FunctionControle"),new r.FunctionControle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Number",{get:function(){return t.logger.info("Méthode à surveiller - NumberControle"),new r.NumberControle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"Object",{get:function(){return t.logger.info("Méthode à surveiller - ObjectControle"),new r.ObjectControle},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"String",{get:function(){return t.logger.info("Méthode à surveiller - StringControle"),new r.StringControle},enumerable:!0,configurable:!0}),t.CLASS_NAME="MyWay.Services.Controle.ControleAgent",t.logger=n.Loggers.LoggerFactory.INSTANCE.getClass(t.CLASS_NAME),t}(n.Components.ComponentAgentBase),r.ControleAgent=t,n.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),window.___MYSYS_BASE_URL___=window.location.href,function(){function e(){window.URL=function(e,t){var n,r,o,i,s,a,c,u;function p(e,t,n){return"@"===n?"":n}if(Object.defineProperty(this,"hash",{get:function(){return n},set:function(e){return n=0<e.length?"#"+e.match(/^#*(.*)/)[1]:"",e}}),Object.defineProperty(this,"host",{get:function(){return 0<s.length?r+":"+s:r},set:function(e){var t=e.split(":");return this.hostname=t[0],this.port=t[1],e}}),Object.defineProperty(this,"hostname",{get:function(){return r},set:function(e){return r=0<e.length?encodeURIComponent(e):r,e}}),Object.defineProperty(this,"href",{get:function(){var e=a+"//";return(0<u.length||0<o.length)&&(0<u.length&&(e+=u),0<o.length&&(e+=":"+o),e+="@"),e+=r,0<s.length&&(e+=":"+s),e+=i+c+n},set:function(e){var t=(this.protocol=e).replace(/.*?:\/*/,""),n=t.match(/([^:]*).*@/);this.username=n?n[1]:"";var r=(t=t.replace(/([^:]*):?(.*@)/,p)).match(/.*(?=@)/);this.password=r?r[0]:"",t=t.replace(/.*@/,""),this.hostname=t.match(/[^:/?]*/);var o=t.match(/:(\d+)/);this.port=o?o[1]:"";var i=t.match(/\/([^?#]*)/);this.pathname=i?i[1]:"";var s=t.match(/\?[^#]*/);this.search=s?s[0]:"";var a=t.match(/\#.*/);this.hash=a?a[0]:""}}),Object.defineProperty(this,"origin",{get:function(){var e=a+"//"+r;return 0<s.length&&(e+=":"+s),e},set:function(e){var t=(this.protocol=e).replace(/.*?:\/*/,"");this.hostname=t.match(/[^:/?]*/);var n=t.match(/:(\d+)/);this.port=n?n[1]:""}}),Object.defineProperty(this,"password",{get:function(){return o},set:function(e){return o=encodeURIComponent(e),e}}),Object.defineProperty(this,"pathname",{get:function(){return i},set:function(e){return i="/"+e.match(/\/?(.*)/)[1],e}}),Object.defineProperty(this,"port",{get:function(){return s},set:function(e){return s=isNaN(e)||""===e?"":Math.min(65535,e).toString(),e}}),Object.defineProperty(this,"protocol",{get:function(){return a},set:function(e){return a=e.match(/[^/:]*/)[0]+":",e}}),Object.defineProperty(this,"search",{get:function(){return c},set:function(e){return c=0<e.length?"?"+e.match(/\??(.*)/)[1]:"",e}}),Object.defineProperty(this,"username",{get:function(){return u},set:function(e){u=e}}),"string"==typeof e){var h=/^[a-zA-z]+:\/\/.*/.test(e),f=/^[a-zA-z]+:\/\/.*/.test(t);if(h)this.href=e;else{if(!f)throw new TypeError('URL string is not valid. If using a relative url, a second argument needs to be passed representing the base URL. Example: new URL("relative/path", "http://www.example.com");');this.href=t+e}}else n=e.hash,r=e.hostname,o=e.password?e.password:"",i=e.pathname,s=e.port,a=e.protocol,c=e.search,u=e.username?e.username:"";this.searchParams=function(e){var s=[],a=[];0<e.search.length&&e.search.slice(1).split("&").forEach(function(e){var t=e.split("=");s.push(t[0]),a.push(t[1])});function c(){0===s.length?e.search="":e.search=s.map(function(e,t){return e+"="+a[t]}).join("&")}return{append:function(e,t){s.push(e),a.push(t),c()},delete:function(e){for(;-1<s.indexOf(e);)a.splice(s.indexOf(e),1),s.splice(s.indexOf(e),1);c()},entries:function(){return s.map(function(e,t){return[e,a[t]]})},get:function(e){return a[s.indexOf(e)]},getAll:function(n){return a.filter(function(e,t){return s[t]===n})},has:function(e){return-1<s.indexOf(e)},keys:function(){return s},setset:function(n,r){if(-1===s.indexOf(n))this.append(n,r);else{var o=!0,i=[];s=s.filter(function(e,t){return e!==n?(i.push(a[t]),!0):!!o&&(o=!1,i.push(r),!0)}),a=i,c()}},sort:function(){var e=this.entries().sort();s=[],a=[],e.forEach(function(e){s.push(e[0]),a.push(e[1])}),c()},toString:function(){return e.search.slice(1)},values:function(){return a}}}(this)}}"function"!=typeof URL?e():"searchParams"in new URL(window.location.href)||e()}(),function(u){var p;(function(a){var c,e;(e=c=a.WebSocketType||(a.WebSocketType={})).Request="myway-ws-request",e.RequestV1="myway-ws-requestv",e.Response="myway-ws-response",e.Notification="myway-ws-notification",e.Status="myway-ws-status";var t=function(r){function e(e,t,n){return r.call(this,t,n,["file:\\",n],"Manager","Agent",e,!0,!0)||this}return __extends(e,r),e.prototype.replaceLibrary=function(e){this._library=e},e.prototype.dispose=function(){},e}(a.MessageBase),r=function(i){function s(e){var t,n,r;if(parent!==window)return n=parent,r=p.AppServiceParameters.Instance().PortalDomain,t=i.call(this,e,n,r)||this,window.addEventListener("message",t._ReceiveMessage),t;var o="MessageAgent ne fonctionne que si l'application est intégrée dans un portail";throw s.logger.error(o),o}return __extends(s,i),s.prototype.dispose=function(){window.removeEventListener("message",this._ReceiveMessage)},s.prototype.postMessage=function(e,t,n,r){t.postMessage(e,n)},s.CLASS_NAME="MyWay.Services.Message.MessageAgent",s.logger=p.Loggers.LoggerFactory.INSTANCE.getClass(s.CLASS_NAME),s}(a.MessageAgentBase=t);a.MessageAgent=r;var n=function(){function e(){}return e.createMessageAgent=function(e){if(-1!=window.location.toString().indexOf("mywayPortalId")){var t=this._queryParam("mywayPortalId");sessionStorage.setItem("myway-portal-id",t)}var n=new URL(window.___MYSYS_BASE_URL___.replace(new RegExp("#","g"),"")).searchParams;return parent!==window?new r(e):p.ServiceManager&&p.ServiceManager.Instance()?new i(e):null!==sessionStorage.getItem("myway-portal-id")||null!==sessionStorage.getItem("myway-container-id")||n.get("myway-container-id")?new s(e):new o(e)},e._queryParam=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(window.location.search);return null===t?"":decodeURIComponent(t[1].replace(/\+/g," "))},e}();a.MessageAgentFactory=n;var o=function(t){function a(e){return t.call(this,e,window,window.location.protocol+"//"+window.location.host)||this}return __extends(a,t),a.prototype.SendMessage=function(e,t,n,r,o,i,s){a.logger.error("l'application n'est pas hébergée dans une iframe, les services techniques ne peuvent pas fonctionner : tentative de d'envoi de message vers [%1] au sujet de [%2] a échoué",e,t),console.warn("l'application n'est pas hébergée dans une iframe, les services techniques ne peuvent pas fonctionner : tentative de d'envoi de message vers ["+e+"] au sujet de ["+t+"] a échoué")},a.prototype.postMessage=function(e,t,n,r){t.postMessage(e,n)},a.CLASS_NAME="MyWay.Services.Message.SelfMessageManager",a.logger=p.Loggers.LoggerFactory.INSTANCE.getClass(a.CLASS_NAME),a}(t);a.SelfMessageManager=o;var i=function(n){function r(e){var t=n.call(this,e,window,window.location.protocol+"//"+window.location.host)||this;return r.Instance=t}return __extends(r,n),r.prototype.postMessage=function(e,t,n,r){var o={};o.data=e,o.origin=n,o.source=t,p.ServiceManager.Instance().Library.Message._ReceiveMessage(o)},r.CLASS_NAME="MyWay.Services.Message.MobileMessageAgent",r.logger=p.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME),r}(t);a.MobileMessageAgent=i;var s=function(t){function e(e){var i=t.call(this,e,window,window.location.protocol+"//"+window.location.host)||this;i.socketConnected=!1,i.waitingMessages=[];var r=[];r.push(i.getPort("https://localhost:8219/ports/getportsutilisateurMySys",function(e){return e.PortNodeJS})),r.push(i.getPort("http://localhost:8200/ports/getportsutilisateurMySys",function(e){return e.PortNodeJS})),r.push(i.getPort("http://localhost:8353/cdn/agents/ping",function(){return 8353})),r.push(i.getPort("https://localhost:8353/cdn/agents/ping",function(){return 8353}));var o=p.CoreCommon.ServiceDePromesse.defer(),s=0;return r.forEach(function(n){n.onResponse.then(function(e){s++;for(var t=0;t<r.length;t++)r[t]!==n&&(console.log("Port obtenu grâce à "+n.url+", annulation get port "+r[t].url),r[t].cancel());o.resolve(e)},function(){++s===r.length&&o.resolve(8353)})}),o.promise.then(function(e){var t=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(new RegExp("[xy]","g"),function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)})},n=a.io("https://localhost:"+e,{query:{uniqueClientId:t()},transports:["websocket"],secure:!0}),r=a.io("http://localhost:"+e,{query:{uniqueClientId:t()},transports:["websocket"]}),o=function(e,t){e.on("connect",function(){console.log("socket connected"),i.socket=e,i.socketConnected=!0,i.waitingMessages.splice(0).forEach(function(e){var t=e.pMessage,n=e.pTargetDomain;return i.postMessage(t,void 0,n,void 0)}),t.close()}),e.on("disconnect",function(){console.log("socket disconnected"),i.socketConnected=!1}),e.on(c.Notification,function(e){if(!e.header.containerId||window.sessionStorage.getItem("myway-container-id")===e.header.containerId){var t={data:{}};t.origin=window.location.protocol+"//"+window.location.host,t.data.RecipientZone=e.header.recipientZone,t.data.RecipientComponent="Context",t.data.SenderZone=e.header.senderZone,t.data.Subject=e.header.subject,t.data.Content=e.payload,t.data.CallbackIndex=0,t.data.ErreurCallbackIndex=0,t.data.Error=void 0,t.data.type="",i.transmettreMessage(t)}})};o(n,r),o(r,n)}),i}return __extends(e,t),e.prototype.getPort=function(e,t){var n=p.CoreCommon.ServiceDePromesse.defer();return{cancel:p.CoreCommon.SendRequest({url:e,method:p.MethodEnum.GET,withHeaders:!1},function(e){n.resolve(t(e))},function(){n.reject()}).cancel,onResponse:n.promise,url:e}},e.prototype.postMessage=function(o,e,i,t){var s=this,n=function(e){if(s.socketConnected){var n=i;o.RequestId=u.Services.CoreCommon.creerChaineAleatoire(16),o.portalId=window.sessionStorage.getItem("myway-portal-id")||void 0,o.containerId=window.sessionStorage.getItem("myway-container-id")||void 0,o.outsideContainer=""+window.sessionStorage.getItem("myway-outside-container")=="true";var t=new URL(window.___MYSYS_BASE_URL___.replace(new RegExp("#","g"),"")).searchParams;o.portalId=o.portalId||t.get("myway-portal-id")||void 0,o.containerId=o.containerId||t.get("myway-container-id")||void 0,o.outsideContainer=o.outsideContainer||""+t.get("myway-outside-container")=="true",s.socket.emit(c.RequestV1,o),"pmm"===e&&console.log("socket emit",o);var r=function(e){var t={};e.RequestId===o.RequestId&&(t.data=e,t.origin=n,s._ReceiveMessage(t),s.socket.off(c.Response,r))};s.socket.on(c.Response,r)}else s.waitingMessages.push({pMessage:o,pTargetDomain:i})};0<=window.location.href.indexOf("pmmpres-")?setTimeout(function(){n("pmm")},100):n()},e.CLASS_NAME="MyWay.Services.Message.PortailMyWayV2MessageAgent",e.logger=p.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t);a.PortailMyWayV2MessageAgent=s})((p=u.Services||(u.Services={})).Message||(p.Message={}))}(MyWay||(MyWay={})),function(e){!function(u){u.onInitUsableLoggerForServiceAgent=null;var e=function(){function c(){var n=this;this.$$framework="$$framework",this.IsInitDone=!1,this.IsInitInProgress=!1,this.onNotificationForSPA=null,this._initTerminee=function(t){return n.Library.Core.addListenerOnNotification(function(e){n.OnNotification(e,n),t&&t(e,n)}),n.IsInitDone=!0,n.IsInitInProgress=!1,n.Library.Core.getPromesseSelfResoved()},this._displayError=function(e){c.logger.warn(e.codeLibelle)}}return Object.defineProperty(c.prototype,"Library",{get:function(){return this._serviceLibrary},enumerable:!0,configurable:!0}),Object.defineProperty(c.prototype,"idServiceAgent",{get:function(){return this._idServiceAgent},enumerable:!0,configurable:!0}),c.prototype.init=function(n){var r=this;if("IZIVENTE"===n.codeApplication){var e=!1;try{e=!0===window.JSON_PATCHED}catch(e){}if(!e){var o=JSON.stringify;JSON.stringify=function(e){if(e&&e instanceof Array&&1<e.length&&/myway-ws-request/.test(e[0])){var t=o.apply(this,arguments);return JSON.parse(t)}return o.apply(this,arguments)},window.JSON_PATCHED=!0}var i=u.CoreCommon.ServiceDePromesse.defer(),s=null;return s=null!==sessionStorage.getItem("myway-portal-id")||null!==sessionStorage.getItem("myway-container-id")?new u.Message.PortailMyWayV2MessageAgent({}):new u.Message.MessageAgent({}),this.Context={AddToContext:function(e,t){var n=u.CoreCommon.ServiceDePromesse.defer();return s.send(u.Components.ComponentType.Context,u.Context.ContextMessageSubject.AddToContext,{key:e,value:t}),n.resolve(!0),n.promise}},this.Lisa={Next:function(e){var t=u.CoreCommon.ServiceDePromesse.defer();return s.send(u.Components.ComponentType.Lisa,u.Lisa.Messages.LisaMessageSubject.Next,{valeurSortie:e}),t.resolve(null),t.promise}},i.resolve(this),i.promise}this._idServiceAgent=Math.random().toString(36).substring(2);i=u.CoreCommon.ServiceDePromesse.defer();var t=[];if(this.IsInitInProgress)i.reject(new u.Erreur("Initialisation du serviceAgent déjà lancée... Il ne peut pas y avoir deux initialisations simultanées."));else{this.IsInitInProgress=!0;var a=JSON.stringify(n);this.IsInitDone&&this._serializedInitialisationValues===a?c.logger.warn("serviceAgent déjà initialisé"):(this._serializedInitialisationValues=a,n||(n={codeApplication:null,onNotification:null}),n.onGlobalError||(n.onGlobalError=this._displayError),i.promise.catch(n.onGlobalError),u.Components.RegistryAgent.getInstance().managerInitializer={applicationVersion:"",codeApplication:n.codeApplication,disableGetStepInfo:n.disableGetStepInfo,disableScopeSave:n.disableScopeSave,donneesScopeASauvegarder:n.donneesScopeASauvegarder,scopeType:n.scopeType},t.push(function(){return u.Components.FactoryRegistries.getInstance().init().then(function(){for(var e in r._serviceLibrary=u.Components.RegistryAgent.getInstance().getLibrary(),r._serviceLibrary)r[e]=r._serviceLibrary[e];for(var t in r.Library)r[t]=r.Library[t];return u.AppServiceParameters.Instance().MessageAgent||r.IsInitDone?r._initAgents(n,n.onGlobalError):r._initAgents(n,i.reject)})}),this.IsInitDone||t.push(function(){return r.onNotificationForSPA&&(r.Library.Core.removeListenerOnNotification(r.onNotificationForSPA),r.onNotificationForSPA=null),r.Library.Core.getPromesseSelfResoved()})),n.disableGetStepInfo&&!0===n.disableGetStepInfo?t.push(function(){return r.Library.Context?r.Library.Context.SetMyWayCompatible():r.Library.Core.getPromesseSelfResoved()}):t.push(function(){if(r.Library.Context)return r.Library.Context.GetCurrentStepInfo().then(function(e){r.Library.Context.StepInfo=e})}),n.capacitesChat&&t.push(function(){return r.Library.Core.promesseTryCatch(function(e){r.Library.Chat&&r.Library.Chat.addChatCapacity(),e.resolve()})}),t.push(function(){return r._initTerminee(n.onNotification)}),u.Promesses.executePromisesSequentially(t).then(function(){i.resolve(r)},i.reject)}return i.promise},c.prototype._initAgents=function(t,e){var n=this;return u.CoreCommon.promesseTryCatch(function(e){u.CoreCommon.loadCdnAddonsServiceScript("framework-client-app-addon.js"),u.onInitUsableLoggerForServiceAgent&&u.onInitUsableLoggerForServiceAgent(n,t.codeApplication),e.resolve()})},c.prototype.SendRequest=function(n){return u.CoreCommon.promesseTryCatch(function(t){var e=n;e.logger=c.logger,u.CoreCommon.SendRequest(e,function(e){t.resolve(e)},function(e){t.reject(e)})})},c.prototype.SubscribeToNotification=function(t){var n=this;null!==this.onNotificationForSPA&&this.Library.Core.removeListenerOnNotification(this.onNotificationForSPA),this.onNotificationForSPA=function(e){t(e,n)},this.Library.Core.addListenerOnNotification(this.onNotificationForSPA)},c.prototype.Dispose=function(){return u.Components.FactoryRegistries.getInstance().dispose()},c.prototype.OnNotification=function(e,t){},c.staticInit=function(){window.onerror=function(e,t,n,r,o){if(-1<e.toString().toLowerCase().indexOf("script error"))c.logger.error("Erreur TFEB : Script Error: See Browser Console for Detail");else{var i=["Message: "+e,"URL: "+t,"Line: "+n,"Column: "+r,"Error object: "+JSON.stringify(o.stack)].join(" - ");c.logger.error("Erreur TFEB : "+i)}return!1},window.addEventListener("error",function(e){e&&e.error&&e.error.stack&&c.logger.error("Erreur TFEB : "+JSON.stringify(e.error.stack))},!1)},c.CLASS_NAME="MyWay.Services.ServiceAgent",c.logger=u.Loggers.LoggerFactory.INSTANCE.getClass(c.CLASS_NAME),c}();(u.ServiceAgent=e).staticInit()}(e.Services||(e.Services={}))}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),n=function(){function e(){if(e._instance)throw new Error("Error: Instantiation failed: Use AppServiceParameters.Instance() instead of new.");e._instance=this}return e.Instance=function(){return null===e._instance&&(e._instance=new e),e._instance},e._instance=null,e}(),t.AppServiceParameters=n}(MyWay||(MyWay={})),function(e){var t;t=e.Services||(e.Services={}),"undefined"!=typeof angular&&(t.moduleAgent=angular.module("moduleAgent",["ng"]))}(MyWay||(MyWay={})),function(e){!function(e){"undefined"!=typeof angular&&e.moduleAgent.service("instanceLoaderService",e.InstanceLoaderService);var o=function(){function o(e,t,n,r){this.$q=e,this.instanceLoaderService=t,this.$timeout=n,this.$rootScope=r}return o.Instance=function(e,t,n,r){return null===o._serviceAgentExtended&&(o._serviceAgentExtended=new i(e,t,n,r)),o._serviceAgentExtended},o.prototype.init=function(e){var t=this,n=this.$q.defer();return o.Instance(this.$q,this.instanceLoaderService,this.$timeout,this.$rootScope).init(e).then(function(){n.resolve(o.Instance(t.$q,t.instanceLoaderService,t.$timeout,t.$rootScope))},function(){n.reject()}),n.promise},o.$inject=["$q","instanceLoaderService","$timeout","$rootScope"],o._serviceAgentExtended=null,o}();e.ServiceAgentProvider=o;var i=function(i){function s(e,t,n,r){var o=i.call(this)||this;return o.$q=e,o.instanceLoaderService=t,o.$timeout=n,o.$rootScope=r,o._lastDigestTimerHandle=null,o.listenersBeforeInitialization=[],o.listenersAfterInitialization=[],s.onNewInstanceTraitements.forEach(function(e){e(o)}),o}return __extends(s,i),s.onNewInstance=function(e){s.onNewInstanceTraitements.push(e)},s.prototype.init=function(t){var n=this,r=this.$q.defer(),o=Date.now();t||(t={codeApplication:""}),this.listenersBeforeInitialization.forEach(function(e){e.call(n)});var e=this;return i.prototype.init.call(this,t).then(function(){n.listenersAfterInitialization.forEach(function(e){e.call(n,t,o)}),r.resolve(e)},function(e){r.reject(e)}),r.promise},s.prototype.addListenerBeforeInitialization=function(e){this.listenersBeforeInitialization.push(e)},s.prototype.addListenerAfterInitialization=function(e){this.listenersAfterInitialization.push(e)},s.prototype.removeListenerBeforeInitialization=function(t){e.CoreCommon.ArrayUtils.remove(this.listenersBeforeInitialization,function(e){return e===t})},s.prototype.removeListenerAfterInitialization=function(t){e.CoreCommon.ArrayUtils.remove(this.listenersAfterInitialization,function(e){return e===t})},s.prototype.sendRequest=function(e,t){var n=this,r=this.$q.defer();return i.prototype.SendRequest.call(this,e).then(function(e){t&&(e=n.instanceLoaderService.createInstance(t,e)),e&&"string"==typeof e&&(e=JSON.parse(e)),r.resolve(e)},function(e){r.reject(e)}),r.promise},s.prototype.LogDemarrage=function(){var e=this;s.logger_extended.debug("Début demarrage"),this.$timeout&&this.$timeout(function(){s.logger_extended.debug("Fin render")}),this.$rootScope&&this.$rootScope.$evalAsync(function(){s.logger_extended.debug("Fin digest"),e.$timeout&&e.$timeout(function(){s.logger_extended.debug("Fin render")})})},s.prototype.OnNotification=function(e,t){"FrameHidden"===e.Sujet?window.clearTimeout(this._watcherCountTimeout):"FrameShown"===e.Sujet&&t&&t.countWatchers&&t.countWatchers(),i.prototype.OnNotification.call(this,e,t)},s.CLASS_NAME_EXTENDED="MyWay.Services.ServiceAgentExtended",s.logger_extended=e.Loggers.LoggerFactory.INSTANCE.getClass(s.CLASS_NAME_EXTENDED),s.onNewInstanceTraitements=[],s.$inject=["$q","instanceLoaderService","$timeout","$rootScope"],s}(e.ServiceAgent);e.ServiceAgentExtended=i,"undefined"!=typeof angular&&(e.moduleAgent.provider("serviceAgentExtended",function(){this.$get=["$q","instanceLoaderService","$timeout","$rootScope",function(e,t,n,r){return o.Instance(e,t,n,r)}]}),e.moduleAgent.provider("serviceAgent",function(){this.$get=["$q","instanceLoaderService","$timeout","$rootScope",function(e,t,n,r){return o.Instance(e,t,n,r)}]}),e.moduleAgent.provider("serviceAgentProvider",function(){this.$get=["$q","instanceLoaderService","$timeout","$rootScope",function(e,t,n,r){return o.Instance(e,t,n,r)}]}))}(e.Services||(e.Services={}))}(MyWay||(MyWay={})),function(e){var i,s,t;i=e.Services||(e.Services={}),s=i.Core||(i.Core={}),t=function(o){function e(){var e=o.call(this)||this;return e._listenersOnNotification=[],e}return __extends(e,o),e.prototype.addListenerOnNotification=function(e){this._listenersOnNotification.push(e)},e.prototype.removeListenerOnNotification=function(t){i.CoreCommon.ArrayUtils.remove(this._listenersOnNotification,function(e){return t===e})},e.prototype.sendNotification=function(t){this._listenersOnNotification.forEach(function(e){e(t)})},e.prototype.init=function(e,t,n){var r=this;return this.library=e,this.messageService=t,i.CoreCommon.registerMethodForSendRequest(function(e){return r.sendMessage(s.CoreMessageSubject.SendRequest,e)}),o.prototype.getPromesseSelfResoved.call(this)},e.prototype.reception=function(t){var n=this;return o.prototype.promesseTryCatch.call(this,function(e){e.reject(new i.Erreur("Subject "+t.subject+" not implemented on "+n.name+" agent"))})},e.prototype.dispose=function(){return o.prototype.getPromesseSelfResoved.call(this)},e.prototype.sendMessage=function(e,t){return this.messageService.sendWithResponse(this.name,e,t)},e}(i.CoreCommon),s.CoreAgent=t,i.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t,n,r;t=e.Services||(e.Services={}),n=t.Message||(t.Message={}),r=function(){return function(n){var r={};function o(e){if(r[e])return r[e].exports;var t=r[e]={exports:{},id:e,loaded:!1};return n[e].call(t.exports,t,t.exports,o),t.loaded=!0,t.exports}return o.m=n,o.c=r,o.p="",o(0)}([function(e,t,n){var c=n(1),r=n(7),u=n(15),p=n(3)("socket.io-client");e.exports=t=o;var h=t.managers={};function o(e,t){"object"==typeof e&&(t=e,e=void 0),t=t||{};var n,r=c(e),o=r.source,i=r.id,s=r.path,a=h[i]&&s in h[i].nsps;return n=t.forceNew||t["force new connection"]||!1===t.multiplex||a?(p("ignoring socket cache for %s",o),u(o,t)):(h[i]||(p("new io instance for %s",o),h[i]=u(o,t)),h[i]),r.query&&!t.query&&(t.query=r.query),n.socket(r.path,t)}t.protocol=r.protocol,t.connect=o,t.Manager=n(15),t.Socket=n(39)},function(e,t,n){var o=n(2),i=n(3)("socket.io-client:url");e.exports=function(e,t){var n=e;t=t||"undefined"!=typeof location&&location,null==e&&(e=t.protocol+"//"+t.host),"string"==typeof e&&("/"===e.charAt(0)&&(e="/"===e.charAt(1)?t.protocol+e:t.host+e),/^(https?|wss?):\/\//.test(e)||(i("protocol-less url %s",e),e=void 0!==t?t.protocol+"//"+e:"https://"+e),i("parse %s",e),n=o(e)),n.port||(/^(http|ws)$/.test(n.protocol)?n.port="80":/^(http|ws)s$/.test(n.protocol)&&(n.port="443")),n.path=n.path||"/";var r=-1!==n.host.indexOf(":")?"["+n.host+"]":n.host;return n.id=n.protocol+"://"+r+":"+n.port,n.href=n.protocol+"://"+r+(t&&t.port===n.port?"":":"+n.port),n}},function(e,t){var a=/^(?:(?![^:@]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,c=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];e.exports=function(e){var t=e,n=e.indexOf("["),r=e.indexOf("]");-1!=n&&-1!=r&&(e=e.substring(0,n)+e.substring(n,r).replace(/:/g,";")+e.substring(r,e.length));for(var o=a.exec(e||""),i={},s=14;s--;)i[c[s]]=o[s]||"";return-1!=n&&-1!=r&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i}},function(o,r,e){(function(t){var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};r.log=function(){var e;return"object"===("undefined"==typeof console?"undefined":n(console))&&console.log&&(e=console).log.apply(e,arguments)},r.formatArgs=function(e){if(e[0]=(this.useColors?"%c":"")+this.namespace+(this.useColors?" %c":" ")+e[0]+(this.useColors?"%c ":" ")+"+"+o.exports.humanize(this.diff),this.useColors){var t="color: "+this.color;e.splice(1,0,t,"color: inherit");var n=0,r=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(n++,"%c"===e&&(r=n))}),e.splice(r,0,t)}},r.save=function(e){try{e?r.storage.setItem("debug",e):r.storage.removeItem("debug")}catch(e){}},r.load=function(){var e=void 0;try{e=r.storage.getItem("debug")}catch(e){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e},r.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type&&!window.process.__nwjs)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},r.storage=function(){try{return localStorage}catch(e){}}(),r.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],o.exports=e(5)(r),o.exports.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}}}).call(r,e(4))},function(e,t){var n,r,o=e.exports={};function i(){throw new Error("setTimeout has not been defined")}function s(){throw new Error("clearTimeout has not been defined")}function a(t){if(n===setTimeout)return setTimeout(t,0);if((n===i||!n)&&setTimeout)return n=setTimeout,setTimeout(t,0);try{return n(t,0)}catch(e){try{return n.call(null,t,0)}catch(e){return n.call(this,t,0)}}}!function(){try{n="function"==typeof setTimeout?setTimeout:i}catch(e){n=i}try{r="function"==typeof clearTimeout?clearTimeout:s}catch(e){r=s}}();var c,u=[],p=!1,h=-1;function f(){p&&c&&(p=!1,c.length?u=c.concat(u):h=-1,u.length&&l())}function l(){if(!p){var e=a(f);p=!0;for(var t=u.length;t;){for(c=u,u=[];++h<t;)c&&c[h].run();h=-1,t=u.length}c=null,p=!1,function(t){if(r===clearTimeout)return clearTimeout(t);if((r===s||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(t);try{r(t)}catch(e){try{return r.call(null,t)}catch(e){return r.call(this,t)}}}(e)}}function d(e,t){this.fun=e,this.array=t}function y(){}o.nextTick=function(e){var t=new Array(arguments.length-1);if(1<arguments.length)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];u.push(new d(e,t)),1!==u.length||p||a(l)},d.prototype.run=function(){this.fun.apply(null,this.array)},o.title="browser",o.browser=!0,o.env={},o.argv=[],o.version="",o.versions={},o.on=y,o.addListener=y,o.once=y,o.off=y,o.removeListener=y,o.removeAllListeners=y,o.emit=y,o.prependListener=y,o.prependOnceListener=y,o.listeners=function(e){return[]},o.binding=function(e){throw new Error("process.binding is not supported")},o.cwd=function(){return"/"},o.chdir=function(e){throw new Error("process.chdir is not supported")},o.umask=function(){return 0}},function(e,t,s){function a(e){if(Array.isArray(e)){for(var t=0,n=Array(e.length);t<e.length;t++)n[t]=e[t];return n}return Array.from(e)}e.exports=function(t){function n(e){for(var t=0,n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t|=0;return u.colors[Math.abs(t)%u.colors.length]}function u(e){var a=void 0;function c(){for(var e=arguments.length,o=Array(e),t=0;t<e;t++)o[t]=arguments[t];if(c.enabled){var i=c,n=Number(new Date),r=n-(a||n);i.diff=r,i.prev=a,i.curr=n,a=n,o[0]=u.coerce(o[0]),"string"!=typeof o[0]&&o.unshift("%O");var s=0;o[0]=o[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;s++;var n=u.formatters[t];if("function"==typeof n){var r=o[s];e=n.call(i,r),o.splice(s,1),s--}return e}),u.formatArgs.call(i,o),(i.log||u.log).apply(i,o)}}return c.namespace=e,c.enabled=u.enabled(e),c.useColors=u.useColors(),c.color=n(e),c.destroy=r,c.extend=o,"function"==typeof u.init&&u.init(c),u.instances.push(c),c}function r(){var e=u.instances.indexOf(this);return-1!==e&&(u.instances.splice(e,1),!0)}function o(e,t){var n=u(this.namespace+(void 0===t?":":t)+e);return n.log=this.log,n}function i(e){return e.toString().substring(2,e.toString().length-2).replace(/\.\*\?$/,"*")}return((u.debug=u).default=u).coerce=function(e){return e instanceof Error?e.stack||e.message:e},u.disable=function(){var e=[].concat(a(u.names.map(i)),a(u.skips.map(i).map(function(e){return"-"+e}))).join(",");return u.enable(""),e},u.enable=function(e){u.save(e),u.names=[],u.skips=[];var t=void 0,n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?u.skips.push(new RegExp("^"+e.substr(1)+"$")):u.names.push(new RegExp("^"+e+"$")));for(t=0;t<u.instances.length;t++){var o=u.instances[t];o.enabled=u.enabled(o.namespace)}},u.enabled=function(e){if("*"===e[e.length-1])return!0;var t=void 0,n=void 0;for(t=0,n=u.skips.length;t<n;t++)if(u.skips[t].test(e))return!1;for(t=0,n=u.names.length;t<n;t++)if(u.names[t].test(e))return!0;return!1},u.humanize=s(6),Object.keys(t).forEach(function(e){u[e]=t[e]}),u.instances=[],u.names=[],u.skips=[],u.formatters={},u.selectColor=n,u.enable(u.load()),u}},function(e,t){var a=36e5,c=864e5;function u(e,t,n,r){var o=1.5*n<=t;return Math.round(e/n)+" "+r+(o?"s":"")}e.exports=function(e,t){t=t||{};var n,r,o,i,s=typeof e;if("string"===s&&0<e.length)return function(e){if(!(100<(e=String(e)).length)){var t=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"weeks":case"week":case"w":return 6048e5*n;case"days":case"day":case"d":return n*c;case"hours":case"hour":case"hrs":case"hr":case"h":return n*a;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*n;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"===s&&isFinite(e))return t.long?(o=e,i=Math.abs(o),c<=i?u(o,i,c,"day"):a<=i?u(o,i,a,"hour"):6e4<=i?u(o,i,6e4,"minute"):1e3<=i?u(o,i,1e3,"second"):o+" ms"):(n=e,r=Math.abs(n),c<=r?Math.round(n/c)+"d":a<=r?Math.round(n/a)+"h":6e4<=r?Math.round(n/6e4)+"m":1e3<=r?Math.round(n/1e3)+"s":n+"ms");throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,c,t){var u=t(8)("socket.io-parser"),n=t(11),i=t(12),p=t(13),r=t(14);function o(){}c.protocol=4,c.types=["CONNECT","DISCONNECT","EVENT","ACK","ERROR","BINARY_EVENT","BINARY_ACK"],c.CONNECT=0,c.DISCONNECT=1,c.EVENT=2,c.ACK=3,c.ERROR=4,c.BINARY_EVENT=5,c.BINARY_ACK=6,c.Encoder=o,c.Decoder=h;var s=c.ERROR+'"encode error"';function a(e){var t=""+e.type;if(c.BINARY_EVENT!==e.type&&c.BINARY_ACK!==e.type||(t+=e.attachments+"-"),e.nsp&&"/"!==e.nsp&&(t+=e.nsp+","),null!=e.id&&(t+=e.id),null!=e.data){var n=function(e){try{return JSON.stringify(e)}catch(e){return!1}}(e.data);if(!1===n)return s;t+=n}return u("encoded %j as %s",e,t),t}function h(){this.reconstructor=null}function f(e){this.reconPack=e,this.buffers=[]}function l(e){return{type:c.ERROR,data:"parser error: "+e}}o.prototype.encode=function(e,t){var n,o;u("encoding packet %j",e),c.BINARY_EVENT===e.type||c.BINARY_ACK===e.type?(n=e,o=t,i.removeBlobs(n,function(e){var t=i.deconstructPacket(e),n=a(t.packet),r=t.buffers;r.unshift(n),o(r)})):t([a(e)])},n(h.prototype),h.prototype.add=function(e){var t;if("string"==typeof e)t=function(e){var t=0,n={type:Number(e.charAt(0))};if(null==c.types[n.type])return l("unknown packet type "+n.type);if(c.BINARY_EVENT===n.type||c.BINARY_ACK===n.type){for(var r="";"-"!==e.charAt(++t)&&(r+=e.charAt(t),t!=e.length););if(r!=Number(r)||"-"!==e.charAt(t))throw new Error("Illegal attachments");n.attachments=Number(r)}if("/"===e.charAt(t+1))for(n.nsp="";++t;){var o=e.charAt(t);if(","===o)break;if(n.nsp+=o,t===e.length)break}else n.nsp="/";var i=e.charAt(t+1);if(""!==i&&Number(i)==i){for(n.id="";++t;){var o=e.charAt(t);if(null==o||Number(o)!=o){--t;break}if(n.id+=e.charAt(t),t===e.length)break}n.id=Number(n.id)}if(e.charAt(++t)){var s=function(e){try{return JSON.parse(e)}catch(e){return!1}}(e.substr(t)),a=!1!==s&&(n.type===c.ERROR||p(s));if(!a)return l("invalid payload");n.data=s}return u("decoded %s as %j",e,n),n}(e),c.BINARY_EVENT===t.type||c.BINARY_ACK===t.type?(this.reconstructor=new f(t),0===this.reconstructor.reconPack.attachments&&this.emit("decoded",t)):this.emit("decoded",t);else{if(!r(e)&&!e.base64)throw new Error("Unknown type: "+e);if(!this.reconstructor)throw new Error("got binary data when not reconstructing a packet");(t=this.reconstructor.takeBinaryData(e))&&(this.reconstructor=null,this.emit("decoded",t))}},h.prototype.destroy=function(){this.reconstructor&&this.reconstructor.finishedReconstruction()},f.prototype.takeBinaryData=function(e){if(this.buffers.push(e),this.buffers.length!==this.reconPack.attachments)return null;var t=i.reconstructPacket(this.reconPack,this.buffers);return this.finishedReconstruction(),t},f.prototype.finishedReconstruction=function(){this.reconPack=null,this.buffers=[]}},function(r,i,o){(function(t){var e="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};function n(){var e;try{e=i.storage.debug}catch(e){}return!e&&void 0!==t&&"env"in t&&(e=t.env.DEBUG),e}(i=r.exports=o(9)).log=function(){return"object"===("undefined"==typeof console?"undefined":e(console))&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},i.formatArgs=function(e){var t=this.useColors;if(e[0]=(t?"%c":"")+this.namespace+(t?" %c":" ")+e[0]+(t?"%c ":" ")+"+"+i.humanize(this.diff),t){var n="color: "+this.color;e.splice(1,0,n,"color: inherit");var r=0,o=0;e[0].replace(/%[a-zA-Z%]/g,function(e){"%%"!==e&&(r++,"%c"===e&&(o=r))}),e.splice(o,0,n)}},i.save=function(e){try{null==e?i.storage.removeItem("debug"):i.storage.debug=e}catch(e){}},i.load=n,i.useColors=function(){return!("undefined"==typeof window||!window.process||"renderer"!==window.process.type)||("undefined"==typeof navigator||!navigator.userAgent||!navigator.userAgent.toLowerCase().match(/(edge|trident)\/(\d+)/))&&("undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&31<=parseInt(RegExp.$1,10)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/))},i.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),i.colors=["#0000CC","#0000FF","#0033CC","#0033FF","#0066CC","#0066FF","#0099CC","#0099FF","#00CC00","#00CC33","#00CC66","#00CC99","#00CCCC","#00CCFF","#3300CC","#3300FF","#3333CC","#3333FF","#3366CC","#3366FF","#3399CC","#3399FF","#33CC00","#33CC33","#33CC66","#33CC99","#33CCCC","#33CCFF","#6600CC","#6600FF","#6633CC","#6633FF","#66CC00","#66CC33","#9900CC","#9900FF","#9933CC","#9933FF","#99CC00","#99CC33","#CC0000","#CC0033","#CC0066","#CC0099","#CC00CC","#CC00FF","#CC3300","#CC3333","#CC3366","#CC3399","#CC33CC","#CC33FF","#CC6600","#CC6633","#CC9900","#CC9933","#CCCC00","#CCCC33","#FF0000","#FF0033","#FF0066","#FF0099","#FF00CC","#FF00FF","#FF3300","#FF3333","#FF3366","#FF3399","#FF33CC","#FF33FF","#FF6600","#FF6633","#FF9900","#FF9933","#FFCC00","#FFCC33"],i.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},i.enable(n())}).call(i,o(4))},function(e,c,t){function n(e){var r;function a(){if(a.enabled){var o=a,e=+new Date,t=e-(r||e);o.diff=t,o.prev=r,o.curr=e,r=e;for(var i=new Array(arguments.length),n=0;n<i.length;n++)i[n]=arguments[n];i[0]=c.coerce(i[0]),"string"!=typeof i[0]&&i.unshift("%O");var s=0;i[0]=i[0].replace(/%([a-zA-Z%])/g,function(e,t){if("%%"===e)return e;s++;var n=c.formatters[t];if("function"==typeof n){var r=i[s];e=n.call(o,r),i.splice(s,1),s--}return e}),c.formatArgs.call(o,i),(a.log||c.log||console.log.bind(console)).apply(o,i)}}return a.namespace=e,a.enabled=c.enabled(e),a.useColors=c.useColors(),a.color=function(e){var t,n=0;for(t in e)n=(n<<5)-n+e.charCodeAt(t),n|=0;return c.colors[Math.abs(n)%c.colors.length]}(e),a.destroy=o,"function"==typeof c.init&&c.init(a),c.instances.push(a),a}function o(){var e=c.instances.indexOf(this);return-1!==e&&(c.instances.splice(e,1),!0)}(c=e.exports=n.debug=n.default=n).coerce=function(e){return e instanceof Error?e.stack||e.message:e},c.disable=function(){c.enable("")},c.enable=function(e){var t;c.save(e),c.names=[],c.skips=[];var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length;for(t=0;t<r;t++)n[t]&&("-"===(e=n[t].replace(/\*/g,".*?"))[0]?c.skips.push(new RegExp("^"+e.substr(1)+"$")):c.names.push(new RegExp("^"+e+"$")));for(t=0;t<c.instances.length;t++){var o=c.instances[t];o.enabled=c.enabled(o.namespace)}},c.enabled=function(e){if("*"===e[e.length-1])return!0;var t,n;for(t=0,n=c.skips.length;t<n;t++)if(c.skips[t].test(e))return!1;for(t=0,n=c.names.length;t<n;t++)if(c.names[t].test(e))return!0;return!1},c.humanize=t(10),c.instances=[],c.names=[],c.skips=[],c.formatters={}},function(e,t){var i=36e5,s=864e5;function a(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var n,r,o=typeof e;if("string"===o&&0<e.length)return function(e){if(!(100<(e=String(e)).length)){var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(t){var n=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*n;case"days":case"day":case"d":return n*s;case"hours":case"hour":case"hrs":case"hr":case"h":return n*i;case"minutes":case"minute":case"mins":case"min":case"m":return 6e4*n;case"seconds":case"second":case"secs":case"sec":case"s":return 1e3*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return n;default:return}}}}(e);if("number"===o&&!1===isNaN(e))return t.long?a(n=e,s,"day")||a(n,i,"hour")||a(n,6e4,"minute")||a(n,1e3,"second")||n+" ms":s<=(r=e)?Math.round(r/s)+"d":i<=r?Math.round(r/i)+"h":6e4<=r?Math.round(r/6e4)+"m":1e3<=r?Math.round(r/1e3)+"s":r+"ms";throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},function(e,t,n){function r(e){if(e)return function(e){for(var t in r.prototype)e[t]=r.prototype[t];return e}(e)}(e.exports=r).prototype.on=r.prototype.addEventListener=function(e,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+e]=this._callbacks["$"+e]||[]).push(t),this},r.prototype.once=function(e,t){function n(){this.off(e,n),t.apply(this,arguments)}return n.fn=t,this.on(e,n),this},r.prototype.off=r.prototype.removeListener=r.prototype.removeAllListeners=r.prototype.removeEventListener=function(e,t){if(this._callbacks=this._callbacks||{},0==arguments.length)return this._callbacks={},this;var n,r=this._callbacks["$"+e];if(!r)return this;if(1==arguments.length)return delete this._callbacks["$"+e],this;for(var o=0;o<r.length;o++)if((n=r[o])===t||n.fn===t){r.splice(o,1);break}return this},r.prototype.emit=function(e){this._callbacks=this._callbacks||{};var t=[].slice.call(arguments,1),n=this._callbacks["$"+e];if(n)for(var r=0,o=(n=n.slice(0)).length;r<o;++r)n[r].apply(this,t);return this},r.prototype.listeners=function(e){return this._callbacks=this._callbacks||{},this._callbacks["$"+e]||[]},r.prototype.hasListeners=function(e){return!!this.listeners(e).length}},function(e,t,n){var p=n(13),h=n(14),r=Object.prototype.toString,f="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),l="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);t.deconstructPacket=function(e){var t=[],n=e.data,r=e;return r.data=function e(t,n){if(!t)return t;if(h(t)){var r={_placeholder:!0,num:n.length};return n.push(t),r}if(p(t)){for(var o=new Array(t.length),i=0;i<t.length;i++)o[i]=e(t[i],n);return o}if("object"!=typeof t||t instanceof Date)return t;var o={};for(var s in t)o[s]=e(t[s],n);return o}(n,t),r.attachments=t.length,{packet:r,buffers:t}},t.reconstructPacket=function(e,t){return e.data=function e(t,n){if(!t)return t;if(t&&t._placeholder)return n[t.num];if(p(t))for(var r=0;r<t.length;r++)t[r]=e(t[r],n);else if("object"==typeof t)for(var o in t)t[o]=e(t[o],n);return t}(e.data,t),e.attachments=void 0,e},t.removeBlobs=function(e,a){var c=0,u=e;!function e(t,n,r){if(!t)return t;if(f&&t instanceof Blob||l&&t instanceof File){c++;var o=new FileReader;o.onload=function(){r?r[n]=this.result:u=this.result,--c||a(u)},o.readAsArrayBuffer(t)}else if(p(t))for(var i=0;i<t.length;i++)e(t[i],i,t);else if("object"==typeof t&&!h(t))for(var s in t)e(t[s],s,t)}(u),c||a(u)}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t){e.exports=function(e){return n&&Buffer.isBuffer(e)||r&&(e instanceof ArrayBuffer||o(e))};var n="function"==typeof Buffer&&"function"==typeof Buffer.isBuffer,r="function"==typeof ArrayBuffer,o=function(e){return"function"==typeof ArrayBuffer.isView?ArrayBuffer.isView(e):e.buffer instanceof ArrayBuffer}},function(e,t,n){var c=n(16),i=n(39),r=n(11),o=n(7),u=n(41),s=n(42),p=n(3)("socket.io-client:manager"),a=n(38),h=n(43),f=Object.prototype.hasOwnProperty;function l(e,t){if(!(this instanceof l))return new l(e,t);e&&"object"==typeof e&&(t=e,e=void 0),(t=t||{}).path=t.path||"/socket.io",this.nsps={},this.subs=[],this.opts=t,this.reconnection(!1!==t.reconnection),this.reconnectionAttempts(t.reconnectionAttempts||1/0),this.reconnectionDelay(t.reconnectionDelay||1e3),this.reconnectionDelayMax(t.reconnectionDelayMax||5e3),this.randomizationFactor(t.randomizationFactor||.5),this.backoff=new h({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(null==t.timeout?2e4:t.timeout),this.readyState="closed",this.uri=e,this.connecting=[],this.lastPing=null,this.encoding=!1,this.packetBuffer=[];var n=t.parser||o;this.encoder=new n.Encoder,this.decoder=new n.Decoder,this.autoConnect=!1!==t.autoConnect,this.autoConnect&&this.open()}(e.exports=l).prototype.emitAll=function(){for(var e in this.emit.apply(this,arguments),this.nsps)f.call(this.nsps,e)&&this.nsps[e].emit.apply(this.nsps[e],arguments)},l.prototype.updateSocketIds=function(){for(var e in this.nsps)f.call(this.nsps,e)&&(this.nsps[e].id=this.generateId(e))},l.prototype.generateId=function(e){return("/"===e?"":e+"#")+this.engine.id},r(l.prototype),l.prototype.reconnection=function(e){return arguments.length?(this._reconnection=!!e,this):this._reconnection},l.prototype.reconnectionAttempts=function(e){return arguments.length?(this._reconnectionAttempts=e,this):this._reconnectionAttempts},l.prototype.reconnectionDelay=function(e){return arguments.length?(this._reconnectionDelay=e,this.backoff&&this.backoff.setMin(e),this):this._reconnectionDelay},l.prototype.randomizationFactor=function(e){return arguments.length?(this._randomizationFactor=e,this.backoff&&this.backoff.setJitter(e),this):this._randomizationFactor},l.prototype.reconnectionDelayMax=function(e){return arguments.length?(this._reconnectionDelayMax=e,this.backoff&&this.backoff.setMax(e),this):this._reconnectionDelayMax},l.prototype.timeout=function(e){return arguments.length?(this._timeout=e,this):this._timeout},l.prototype.maybeReconnectOnOpen=function(){!this.reconnecting&&this._reconnection&&0===this.backoff.attempts&&this.reconnect()},l.prototype.open=l.prototype.connect=function(n,e){if(p("readyState %s",this.readyState),~this.readyState.indexOf("open"))return this;p("opening %s",this.uri),this.engine=c(this.uri,this.opts);var t=this.engine,r=this;this.readyState="opening",this.skipReconnect=!1;var o=u(t,"open",function(){r.onopen(),n&&n()}),i=u(t,"error",function(e){if(p("connect_error"),r.cleanup(),r.readyState="closed",r.emitAll("connect_error",e),n){var t=new Error("Connection error");t.data=e,n(t)}else r.maybeReconnectOnOpen()});if(!1!==this._timeout){var s=this._timeout;p("connect attempt will timeout after %d",s);var a=setTimeout(function(){p("connect attempt timed out after %d",s),o.destroy(),t.close(),t.emit("error","timeout"),r.emitAll("connect_timeout",s)},s);this.subs.push({destroy:function(){clearTimeout(a)}})}return this.subs.push(o),this.subs.push(i),this},l.prototype.onopen=function(){p("open"),this.cleanup(),this.readyState="open",this.emit("open");var e=this.engine;this.subs.push(u(e,"data",s(this,"ondata"))),this.subs.push(u(e,"ping",s(this,"onping"))),this.subs.push(u(e,"pong",s(this,"onpong"))),this.subs.push(u(e,"error",s(this,"onerror"))),this.subs.push(u(e,"close",s(this,"onclose"))),this.subs.push(u(this.decoder,"decoded",s(this,"ondecoded")))},l.prototype.onping=function(){this.lastPing=new Date,this.emitAll("ping")},l.prototype.onpong=function(){this.emitAll("pong",new Date-this.lastPing)},l.prototype.ondata=function(e){this.decoder.add(e)},l.prototype.ondecoded=function(e){this.emit("packet",e)},l.prototype.onerror=function(e){p("error",e),this.emitAll("error",e)},l.prototype.socket=function(e,t){var n=this.nsps[e];if(!n){n=new i(this,e,t),this.nsps[e]=n;var r=this;n.on("connecting",o),n.on("connect",function(){n.id=r.generateId(e)}),this.autoConnect&&o()}function o(){~a(r.connecting,n)||r.connecting.push(n)}return n},l.prototype.destroy=function(e){var t=a(this.connecting,e);~t&&this.connecting.splice(t,1),this.connecting.length||this.close()},l.prototype.packet=function(n){p("writing packet %j",n);var r=this;n.query&&0===n.type&&(n.nsp+="?"+n.query),r.encoding?r.packetBuffer.push(n):(r.encoding=!0,this.encoder.encode(n,function(e){for(var t=0;t<e.length;t++)r.engine.write(e[t],n.options);r.encoding=!1,r.processPacketQueue()}))},l.prototype.processPacketQueue=function(){if(0<this.packetBuffer.length&&!this.encoding){var e=this.packetBuffer.shift();this.packet(e)}},l.prototype.cleanup=function(){p("cleanup");for(var e=this.subs.length,t=0;t<e;t++)this.subs.shift().destroy();this.packetBuffer=[],this.encoding=!1,this.lastPing=null,this.decoder.destroy()},l.prototype.close=l.prototype.disconnect=function(){p("disconnect"),this.skipReconnect=!0,this.reconnecting=!1,"opening"===this.readyState&&this.cleanup(),this.backoff.reset(),this.readyState="closed",this.engine&&this.engine.close()},l.prototype.onclose=function(e){p("onclose"),this.cleanup(),this.backoff.reset(),this.readyState="closed",this.emit("close",e),this._reconnection&&!this.skipReconnect&&this.reconnect()},l.prototype.reconnect=function(){if(this.reconnecting||this.skipReconnect)return this;var t=this;if(this.backoff.attempts>=this._reconnectionAttempts)p("reconnect failed"),this.backoff.reset(),this.emitAll("reconnect_failed"),this.reconnecting=!1;else{var e=this.backoff.duration();p("will wait %dms before reconnect attempt",e),this.reconnecting=!0;var n=setTimeout(function(){t.skipReconnect||(p("attempting reconnect"),t.emitAll("reconnect_attempt",t.backoff.attempts),t.emitAll("reconnecting",t.backoff.attempts),t.skipReconnect||t.open(function(e){e?(p("reconnect attempt error"),t.reconnecting=!1,t.reconnect(),t.emitAll("reconnect_error",e.data)):(p("reconnect success"),t.onreconnect())}))},e);this.subs.push({destroy:function(){clearTimeout(n)}})}},l.prototype.onreconnect=function(){var e=this.backoff.attempts;this.reconnecting=!1,this.backoff.reset(),this.updateSocketIds(),this.emitAll("reconnect",e)}},function(e,t,n){e.exports=n(17),e.exports.parser=n(24)},function(e,t,n){var r=n(18),o=n(11),h=n(3)("engine.io-client:socket"),i=n(38),s=n(24),a=n(2),c=n(32);function f(e,t){if(!(this instanceof f))return new f(e,t);t=t||{},e&&"object"==typeof e&&(t=e,e=null),e?(e=a(e),t.hostname=e.host,t.secure="https"===e.protocol||"wss"===e.protocol,t.port=e.port,e.query&&(t.query=e.query)):t.host&&(t.hostname=a(t.host).host),this.secure=null!=t.secure?t.secure:"undefined"!=typeof location&&"https:"===location.protocol,t.hostname&&!t.port&&(t.port=this.secure?"443":"80"),this.agent=t.agent||!1,this.hostname=t.hostname||("undefined"!=typeof location?location.hostname:"localhost"),this.port=t.port||("undefined"!=typeof location&&location.port?location.port:this.secure?443:80),this.query=t.query||{},"string"==typeof this.query&&(this.query=c.decode(this.query)),this.upgrade=!1!==t.upgrade,this.path=(t.path||"/engine.io").replace(/\/$/,"")+"/",this.forceJSONP=!!t.forceJSONP,this.jsonp=!1!==t.jsonp,this.forceBase64=!!t.forceBase64,this.enablesXDR=!!t.enablesXDR,this.withCredentials=!1!==t.withCredentials,this.timestampParam=t.timestampParam||"t",this.timestampRequests=t.timestampRequests,this.transports=t.transports||["polling","websocket"],this.transportOptions=t.transportOptions||{},this.readyState="",this.writeBuffer=[],this.prevBufferLen=0,this.policyPort=t.policyPort||843,this.rememberUpgrade=t.rememberUpgrade||!1,this.binaryType=null,this.onlyBinaryUpgrades=t.onlyBinaryUpgrades,this.perMessageDeflate=!1!==t.perMessageDeflate&&(t.perMessageDeflate||{}),!0===this.perMessageDeflate&&(this.perMessageDeflate={}),this.perMessageDeflate&&null==this.perMessageDeflate.threshold&&(this.perMessageDeflate.threshold=1024),this.pfx=t.pfx||null,this.key=t.key||null,this.passphrase=t.passphrase||null,this.cert=t.cert||null,this.ca=t.ca||null,this.ciphers=t.ciphers||null,this.rejectUnauthorized=void 0===t.rejectUnauthorized||t.rejectUnauthorized,this.forceNode=!!t.forceNode,this.isReactNative="undefined"!=typeof navigator&&"string"==typeof navigator.product&&"reactnative"===navigator.product.toLowerCase(),("undefined"==typeof self||this.isReactNative)&&(t.extraHeaders&&0<Object.keys(t.extraHeaders).length&&(this.extraHeaders=t.extraHeaders),t.localAddress&&(this.localAddress=t.localAddress)),this.id=null,this.upgrades=null,this.pingInterval=null,this.pingTimeout=null,this.pingIntervalTimer=null,this.pingTimeoutTimer=null,this.open()}(e.exports=f).priorWebsocketSuccess=!1,o(f.prototype),f.protocol=s.protocol,(f.Socket=f).Transport=n(23),f.transports=n(18),f.parser=n(24),f.prototype.createTransport=function(e){h('creating transport "%s"',e);var t=function(e){var t={};for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);return t}(this.query);t.EIO=s.protocol,t.transport=e;var n=this.transportOptions[e]||{};return this.id&&(t.sid=this.id),new r[e]({query:t,socket:this,agent:n.agent||this.agent,hostname:n.hostname||this.hostname,port:n.port||this.port,secure:n.secure||this.secure,path:n.path||this.path,forceJSONP:n.forceJSONP||this.forceJSONP,jsonp:n.jsonp||this.jsonp,forceBase64:n.forceBase64||this.forceBase64,enablesXDR:n.enablesXDR||this.enablesXDR,withCredentials:n.withCredentials||this.withCredentials,timestampRequests:n.timestampRequests||this.timestampRequests,timestampParam:n.timestampParam||this.timestampParam,policyPort:n.policyPort||this.policyPort,pfx:n.pfx||this.pfx,key:n.key||this.key,passphrase:n.passphrase||this.passphrase,cert:n.cert||this.cert,ca:n.ca||this.ca,ciphers:n.ciphers||this.ciphers,rejectUnauthorized:n.rejectUnauthorized||this.rejectUnauthorized,perMessageDeflate:n.perMessageDeflate||this.perMessageDeflate,extraHeaders:n.extraHeaders||this.extraHeaders,forceNode:n.forceNode||this.forceNode,localAddress:n.localAddress||this.localAddress,requestTimeout:n.requestTimeout||this.requestTimeout,protocols:n.protocols||void 0,isReactNative:this.isReactNative})},f.prototype.open=function(){var e;if(this.rememberUpgrade&&f.priorWebsocketSuccess&&-1!==this.transports.indexOf("websocket"))e="websocket";else{if(0===this.transports.length){var t=this;return void setTimeout(function(){t.emit("error","No transports available")},0)}e=this.transports[0]}this.readyState="opening";try{e=this.createTransport(e)}catch(e){return this.transports.shift(),void this.open()}e.open(),this.setTransport(e)},f.prototype.setTransport=function(e){h("setting transport %s",e.name);var t=this;this.transport&&(h("clearing existing transport %s",this.transport.name),this.transport.removeAllListeners()),(this.transport=e).on("drain",function(){t.onDrain()}).on("packet",function(e){t.onPacket(e)}).on("error",function(e){t.onError(e)}).on("close",function(){t.onClose("transport close")})},f.prototype.probe=function(n){h('probing transport "%s"',n);var r=this.createTransport(n,{probe:1}),o=!1,i=this;function e(){if(i.onlyBinaryUpgrades){var e=!this.supportsBinary&&i.transport.supportsBinary;o=o||e}o||(h('probe transport "%s" opened',n),r.send([{type:"ping",data:"probe"}]),r.once("packet",function(e){if(!o)if("pong"===e.type&&"probe"===e.data){if(h('probe transport "%s" pong',n),i.upgrading=!0,i.emit("upgrading",r),!r)return;f.priorWebsocketSuccess="websocket"===r.name,h('pausing current transport "%s"',i.transport.name),i.transport.pause(function(){o||"closed"!==i.readyState&&(h("changing transport and sending upgrade packet"),p(),i.setTransport(r),r.send([{type:"upgrade"}]),i.emit("upgrade",r),r=null,i.upgrading=!1,i.flush())})}else{h('probe transport "%s" failed',n);var t=new Error("probe error");t.transport=r.name,i.emit("upgradeError",t)}}))}function s(){o||(o=!0,p(),r.close(),r=null)}function t(e){var t=new Error("probe error: "+e);t.transport=r.name,s(),h('probe transport "%s" failed because of error: %s',n,e),i.emit("upgradeError",t)}function a(){t("transport closed")}function c(){t("socket closed")}function u(e){r&&e.name!==r.name&&(h('"%s" works - aborting "%s"',e.name,r.name),s())}function p(){r.removeListener("open",e),r.removeListener("error",t),r.removeListener("close",a),i.removeListener("close",c),i.removeListener("upgrading",u)}f.priorWebsocketSuccess=!1,r.once("open",e),r.once("error",t),r.once("close",a),this.once("close",c),this.once("upgrading",u),r.open()},f.prototype.onOpen=function(){if(h("socket open"),this.readyState="open",f.priorWebsocketSuccess="websocket"===this.transport.name,this.emit("open"),this.flush(),"open"===this.readyState&&this.upgrade&&this.transport.pause){h("starting upgrade probes");for(var e=0,t=this.upgrades.length;e<t;e++)this.probe(this.upgrades[e])}},f.prototype.onPacket=function(e){if("opening"===this.readyState||"open"===this.readyState||"closing"===this.readyState)switch(h('socket receive: type "%s", data "%s"',e.type,e.data),this.emit("packet",e),this.emit("heartbeat"),e.type){case"open":this.onHandshake(JSON.parse(e.data));break;case"pong":this.setPing(),this.emit("pong");break;case"error":var t=new Error("server error");t.code=e.data,this.onError(t);break;case"message":this.emit("data",e.data),this.emit("message",e.data)}else h('packet received with socket readyState "%s"',this.readyState)},f.prototype.onHandshake=function(e){this.emit("handshake",e),this.id=e.sid,this.transport.query.sid=e.sid,this.upgrades=this.filterUpgrades(e.upgrades),this.pingInterval=e.pingInterval,this.pingTimeout=e.pingTimeout,this.onOpen(),"closed"!==this.readyState&&(this.setPing(),this.removeListener("heartbeat",this.onHeartbeat),this.on("heartbeat",this.onHeartbeat))},f.prototype.onHeartbeat=function(e){clearTimeout(this.pingTimeoutTimer);var t=this;t.pingTimeoutTimer=setTimeout(function(){"closed"!==t.readyState&&t.onClose("ping timeout")},e||t.pingInterval+t.pingTimeout)},f.prototype.setPing=function(){var e=this;clearTimeout(e.pingIntervalTimer),e.pingIntervalTimer=setTimeout(function(){h("writing ping packet - expecting pong within %sms",e.pingTimeout),e.ping(),e.onHeartbeat(e.pingTimeout)},e.pingInterval)},f.prototype.ping=function(){var e=this;this.sendPacket("ping",function(){e.emit("ping")})},f.prototype.onDrain=function(){this.writeBuffer.splice(0,this.prevBufferLen),(this.prevBufferLen=0)===this.writeBuffer.length?this.emit("drain"):this.flush()},f.prototype.flush=function(){"closed"!==this.readyState&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length&&(h("flushing %d packets in socket",this.writeBuffer.length),this.transport.send(this.writeBuffer),this.prevBufferLen=this.writeBuffer.length,this.emit("flush"))},f.prototype.write=f.prototype.send=function(e,t,n){return this.sendPacket("message",e,t,n),this},f.prototype.sendPacket=function(e,t,n,r){if("function"==typeof t&&(r=t,t=void 0),"function"==typeof n&&(r=n,n=null),"closing"!==this.readyState&&"closed"!==this.readyState){(n=n||{}).compress=!1!==n.compress;var o={type:e,data:t,options:n};this.emit("packetCreate",o),this.writeBuffer.push(o),r&&this.once("flush",r),this.flush()}},f.prototype.close=function(){if("opening"===this.readyState||"open"===this.readyState){this.readyState="closing";var e=this;this.writeBuffer.length?this.once("drain",function(){this.upgrading?r():t()}):this.upgrading?r():t()}function t(){e.onClose("forced close"),h("socket closing - telling transport to close"),e.transport.close()}function n(){e.removeListener("upgrade",n),e.removeListener("upgradeError",n),t()}function r(){e.once("upgrade",n),e.once("upgradeError",n)}return this},f.prototype.onError=function(e){h("socket error %j",e),f.priorWebsocketSuccess=!1,this.emit("error",e),this.onClose("transport error",e)},f.prototype.onClose=function(e,t){"opening"!==this.readyState&&"open"!==this.readyState&&"closing"!==this.readyState||(h('socket close with reason: "%s"',e),clearTimeout(this.pingIntervalTimer),clearTimeout(this.pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),this.readyState="closed",this.id=null,this.emit("close",e,t),this.writeBuffer=[],this.prevBufferLen=0)},f.prototype.filterUpgrades=function(e){for(var t=[],n=0,r=e.length;n<r;n++)~i(this.transports,e[n])&&t.push(e[n]);return t}},function(e,t,n){var s=n(19),a=n(21),c=n(35),r=n(36);t.polling=function(e){var t=!1,n=!1,r=!1!==e.jsonp;if("undefined"!=typeof location){var o="https:"===location.protocol,i=location.port;i||(i=o?443:80),t=e.hostname!==location.hostname||i!==e.port,n=e.secure!==o}if(e.xdomain=t,e.xscheme=n,"open"in new s(e)&&!e.forceJSONP)return new a(e);if(!r)throw new Error("JSONP disabled");return new c(e)},t.websocket=r},function(e,t,n){var o=n(20);e.exports=function(e){var t=e.xdomain,n=e.xscheme,r=e.enablesXDR;try{if("undefined"!=typeof XMLHttpRequest&&(!t||o))return new XMLHttpRequest}catch(e){}try{if("undefined"!=typeof XDomainRequest&&!n&&r)return new XDomainRequest}catch(e){}if(!t)try{return new(self[["Active"].concat("Object").join("X")])("Microsoft.XMLHTTP")}catch(e){}}},function(t,e){try{t.exports="undefined"!=typeof XMLHttpRequest&&"withCredentials"in new XMLHttpRequest}catch(e){t.exports=!1}},function(e,t,n){var o=n(19),r=n(22),i=n(11),s=n(33),a=n(3)("engine.io-client:polling-xhr");function c(){}function u(e){if(r.call(this,e),this.requestTimeout=e.requestTimeout,this.extraHeaders=e.extraHeaders,"undefined"!=typeof location){var t="https:"===location.protocol,n=location.port;n||(n=t?443:80),this.xd="undefined"!=typeof location&&e.hostname!==location.hostname||n!==e.port,this.xs=e.secure!==t}}function p(e){this.method=e.method||"GET",this.uri=e.uri,this.xd=!!e.xd,this.xs=!!e.xs,this.async=!1!==e.async,this.data=void 0!==e.data?e.data:null,this.agent=e.agent,this.isBinary=e.isBinary,this.supportsBinary=e.supportsBinary,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.requestTimeout=e.requestTimeout,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.extraHeaders=e.extraHeaders,this.create()}if(e.exports=u,e.exports.Request=p,s(u,r),u.prototype.supportsBinary=!0,u.prototype.request=function(e){return(e=e||{}).uri=this.uri(),e.xd=this.xd,e.xs=this.xs,e.agent=this.agent||!1,e.supportsBinary=this.supportsBinary,e.enablesXDR=this.enablesXDR,e.withCredentials=this.withCredentials,e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized,e.requestTimeout=this.requestTimeout,e.extraHeaders=this.extraHeaders,new p(e)},u.prototype.doWrite=function(e,t){var n="string"!=typeof e&&void 0!==e,r=this.request({method:"POST",data:e,isBinary:n}),o=this;r.on("success",t),r.on("error",function(e){o.onError("xhr post error",e)}),this.sendXhr=r},u.prototype.doPoll=function(){a("xhr poll");var e=this.request(),t=this;e.on("data",function(e){t.onData(e)}),e.on("error",function(e){t.onError("xhr poll error",e)}),this.pollXhr=e},i(p.prototype),p.prototype.create=function(){var e={agent:this.agent,xdomain:this.xd,xscheme:this.xs,enablesXDR:this.enablesXDR};e.pfx=this.pfx,e.key=this.key,e.passphrase=this.passphrase,e.cert=this.cert,e.ca=this.ca,e.ciphers=this.ciphers,e.rejectUnauthorized=this.rejectUnauthorized;var t=this.xhr=new o(e),n=this;try{a("xhr open %s: %s",this.method,this.uri),t.open(this.method,this.uri,this.async);try{if(this.extraHeaders)for(var r in t.setDisableHeaderCheck&&t.setDisableHeaderCheck(!0),this.extraHeaders)this.extraHeaders.hasOwnProperty(r)&&t.setRequestHeader(r,this.extraHeaders[r])}catch(e){}if("POST"===this.method)try{this.isBinary?t.setRequestHeader("Content-type","application/octet-stream"):t.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch(e){}try{t.setRequestHeader("Accept","*/*")}catch(e){}"withCredentials"in t&&(t.withCredentials=this.withCredentials),this.requestTimeout&&(t.timeout=this.requestTimeout),this.hasXDR()?(t.onload=function(){n.onLoad()},t.onerror=function(){n.onError(t.responseText)}):t.onreadystatechange=function(){if(2===t.readyState)try{var e=t.getResponseHeader("Content-Type");(n.supportsBinary&&"application/octet-stream"===e||"application/octet-stream; charset=UTF-8"===e)&&(t.responseType="arraybuffer")}catch(e){}4===t.readyState&&(200===t.status||1223===t.status?n.onLoad():setTimeout(function(){n.onError("number"==typeof t.status?t.status:0)},0))},a("xhr data %s",this.data),t.send(this.data)}catch(e){return void setTimeout(function(){n.onError(e)},0)}"undefined"!=typeof document&&(this.index=p.requestsCount++,p.requests[this.index]=this)},p.prototype.onSuccess=function(){this.emit("success"),this.cleanup()},p.prototype.onData=function(e){this.emit("data",e),this.onSuccess()},p.prototype.onError=function(e){this.emit("error",e),this.cleanup(!0)},p.prototype.cleanup=function(e){if(void 0!==this.xhr&&null!==this.xhr){if(this.hasXDR()?this.xhr.onload=this.xhr.onerror=c:this.xhr.onreadystatechange=c,e)try{this.xhr.abort()}catch(e){}"undefined"!=typeof document&&delete p.requests[this.index],this.xhr=null}},p.prototype.onLoad=function(){var e;try{var t;try{t=this.xhr.getResponseHeader("Content-Type")}catch(e){}e=("application/octet-stream"===t||"application/octet-stream; charset=UTF-8"===t)&&this.xhr.response||this.xhr.responseText}catch(e){this.onError(e)}null!=e&&this.onData(e)},p.prototype.hasXDR=function(){return"undefined"!=typeof XDomainRequest&&!this.xs&&this.enablesXDR},p.prototype.abort=function(){this.cleanup()},p.requestsCount=0,p.requests={},"undefined"!=typeof document)if("function"==typeof attachEvent)attachEvent("onunload",f);else if("function"==typeof addEventListener){var h="onpagehide"in self?"pagehide":"unload";addEventListener(h,f,!1)}function f(){for(var e in p.requests)p.requests.hasOwnProperty(e)&&p.requests[e].abort()}},function(e,t,n){var r=n(23),o=n(32),i=n(24),s=n(33),a=n(34),c=n(3)("engine.io-client:polling");e.exports=p;var u=null!=new(n(19))({xdomain:!1}).responseType;function p(e){var t=e&&e.forceBase64;u&&!t||(this.supportsBinary=!1),r.call(this,e)}s(p,r),p.prototype.name="polling",p.prototype.doOpen=function(){this.poll()},p.prototype.pause=function(e){var t=this;function n(){c("paused"),t.readyState="paused",e()}if(this.readyState="pausing",this.polling||!this.writable){var r=0;this.polling&&(c("we are currently polling - waiting to pause"),r++,this.once("pollComplete",function(){c("pre-pause polling complete"),--r||n()})),this.writable||(c("we are currently writing - waiting to pause"),r++,this.once("drain",function(){c("pre-pause writing complete"),--r||n()}))}else n()},p.prototype.poll=function(){c("polling"),this.polling=!0,this.doPoll(),this.emit("poll")},p.prototype.onData=function(e){var r=this;c("polling got data %s",e),i.decodePayload(e,this.socket.binaryType,function(e,t,n){if("opening"===r.readyState&&r.onOpen(),"close"===e.type)return r.onClose(),!1;r.onPacket(e)}),"closed"!==this.readyState&&(this.polling=!1,this.emit("pollComplete"),"open"===this.readyState?this.poll():c('ignoring poll - transport state "%s"',this.readyState))},p.prototype.doClose=function(){var e=this;function t(){c("writing close packet"),e.write([{type:"close"}])}"open"===this.readyState?(c("transport open - closing"),t()):(c("transport not open - deferring close"),this.once("open",t))},p.prototype.write=function(e){var t=this;this.writable=!1;var n=function(){t.writable=!0,t.emit("drain")};i.encodePayload(e,this.supportsBinary,function(e){t.doWrite(e,n)})},p.prototype.uri=function(){var e=this.query||{},t=this.secure?"https":"http",n="";return!1!==this.timestampRequests&&(e[this.timestampParam]=a()),this.supportsBinary||e.sid||(e.b64=1),e=o.encode(e),this.port&&("https"===t&&443!==Number(this.port)||"http"===t&&80!==Number(this.port))&&(n=":"+this.port),e.length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e}},function(e,t,n){var r=n(24);function o(e){this.path=e.path,this.hostname=e.hostname,this.port=e.port,this.secure=e.secure,this.query=e.query,this.timestampParam=e.timestampParam,this.timestampRequests=e.timestampRequests,this.readyState="",this.agent=e.agent||!1,this.socket=e.socket,this.enablesXDR=e.enablesXDR,this.withCredentials=e.withCredentials,this.pfx=e.pfx,this.key=e.key,this.passphrase=e.passphrase,this.cert=e.cert,this.ca=e.ca,this.ciphers=e.ciphers,this.rejectUnauthorized=e.rejectUnauthorized,this.forceNode=e.forceNode,this.isReactNative=e.isReactNative,this.extraHeaders=e.extraHeaders,this.localAddress=e.localAddress}n(11)((e.exports=o).prototype),o.prototype.onError=function(e,t){var n=new Error(e);return n.type="TransportError",n.description=t,this.emit("error",n),this},o.prototype.open=function(){return"closed"!==this.readyState&&""!==this.readyState||(this.readyState="opening",this.doOpen()),this},o.prototype.close=function(){return"opening"!==this.readyState&&"open"!==this.readyState||(this.doClose(),this.onClose()),this},o.prototype.send=function(e){if("open"!==this.readyState)throw new Error("Transport not open");this.write(e)},o.prototype.onOpen=function(){this.readyState="open",this.writable=!0,this.emit("open")},o.prototype.onData=function(e){var t=r.decodePacket(e,this.socket.binaryType);this.onPacket(t)},o.prototype.onPacket=function(e){this.emit("packet",e)},o.prototype.onClose=function(){this.readyState="closed",this.emit("close")}},function(e,f,t){var o,n=t(25),i=t(26),l=t(27),a=t(28),u=t(29);"undefined"!=typeof ArrayBuffer&&(o=t(30));var r="undefined"!=typeof navigator&&/Android/i.test(navigator.userAgent),s="undefined"!=typeof navigator&&/PhantomJS/i.test(navigator.userAgent),p=r||s;f.protocol=3;var h=f.packets={open:0,close:1,ping:2,pong:3,message:4,upgrade:5,noop:6},c=n(h),d={type:"error",data:"parser error"},y=t(31);function g(e,t,n){for(var o=new Array(e.length),r=a(e.length,n),i=function(n,e,r){t(e,function(e,t){o[n]=t,r(e,o)})},s=0;s<e.length;s++)i(s,e[s],r)}f.encodePacket=function(e,t,n,r){"function"==typeof t&&(r=t,t=!1),"function"==typeof n&&(r=n,n=null);var o,i,s,a=void 0===e.data?void 0:e.data.buffer||e.data;if("undefined"!=typeof ArrayBuffer&&a instanceof ArrayBuffer)return function(e,t,n){if(!t)return f.encodeBase64Packet(e,n);var r=e.data,o=new Uint8Array(r),i=new Uint8Array(1+r.byteLength);i[0]=h[e.type];for(var s=0;s<o.length;s++)i[s+1]=o[s];return n(i.buffer)}(e,t,r);if(void 0!==y&&a instanceof y)return function(e,t,n){if(!t)return f.encodeBase64Packet(e,n);if(p)return function(e,t,n){if(!t)return f.encodeBase64Packet(e,n);var r=new FileReader;return r.onload=function(){f.encodePacket({type:e.type,data:r.result},t,!0,n)},r.readAsArrayBuffer(e.data)}(e,t,n);var r=new Uint8Array(1);r[0]=h[e.type];var o=new y([r.buffer,e.data]);return n(o)}(e,t,r);if(a&&a.base64)return o=e,i=r,s="b"+f.packets[o.type]+o.data.data,i(s);var c=h[e.type];return void 0!==e.data&&(c+=n?u.encode(String(e.data),{strict:!1}):String(e.data)),r(""+c)},f.encodeBase64Packet=function(t,n){var r,o="b"+f.packets[t.type];if(void 0!==y&&t.data instanceof y){var i=new FileReader;return i.onload=function(){var e=i.result.split(",")[1];n(o+e)},i.readAsDataURL(t.data)}try{r=String.fromCharCode.apply(null,new Uint8Array(t.data))}catch(e){for(var s=new Uint8Array(t.data),a=new Array(s.length),c=0;c<s.length;c++)a[c]=s[c];r=String.fromCharCode.apply(null,a)}return o+=btoa(r),n(o)},f.decodePacket=function(e,t,n){if(void 0===e)return d;if("string"==typeof e){if("b"===e.charAt(0))return f.decodeBase64Packet(e.substr(1),t);if(n&&!1===(e=function(e){try{e=u.decode(e,{strict:!1})}catch(e){return!1}return e}(e)))return d;var r=e.charAt(0);return Number(r)==r&&c[r]?1<e.length?{type:c[r],data:e.substring(1)}:{type:c[r]}:d}r=new Uint8Array(e)[0];var o=l(e,1);return y&&"blob"===t&&(o=new y([o])),{type:c[r],data:o}},f.decodeBase64Packet=function(e,t){var n=c[e.charAt(0)];if(!o)return{type:n,data:{base64:!0,data:e.substr(1)}};var r=o.decode(e.substr(1));return"blob"===t&&y&&(r=new y([r])),{type:n,data:r}},f.encodePayload=function(e,t,n){"function"==typeof t&&(n=t,t=null);var r=i(e);return t&&r?y&&!p?f.encodePayloadAsBlob(e,n):f.encodePayloadAsArrayBuffer(e,n):e.length?void g(e,function(e,n){f.encodePacket(e,!!r&&t,!1,function(e){var t;n(null,(t=e).length+":"+t)})},function(e,t){return n(t.join(""))}):n("0:")},f.decodePayload=function(e,t,n){if("string"!=typeof e)return f.decodePayloadAsBinary(e,t,n);var r;if("function"==typeof t&&(n=t,t=null),""===e)return n(d,0,1);for(var o,i,s="",a=0,c=e.length;a<c;a++){var u=e.charAt(a);if(":"===u){if(""===s||s!=(o=Number(s)))return n(d,0,1);if(s!=(i=e.substr(a+1,o)).length)return n(d,0,1);if(i.length){if(r=f.decodePacket(i,t,!1),d.type===r.type&&d.data===r.data)return n(d,0,1);if(!1===n(r,a+o,c))return}a+=o,s=""}else s+=u}return""!==s?n(d,0,1):void 0},f.encodePayloadAsArrayBuffer=function(e,r){if(!e.length)return r(new ArrayBuffer(0));g(e,function(e,t){f.encodePacket(e,!0,!0,function(e){return t(null,e)})},function(e,t){var n=t.reduce(function(e,t){var n;return e+(n="string"==typeof t?t.length:t.byteLength).toString().length+n+2},0),s=new Uint8Array(n),a=0;return t.forEach(function(e){var t="string"==typeof e,n=e;if(t){for(var r=new Uint8Array(e.length),o=0;o<e.length;o++)r[o]=e.charCodeAt(o);n=r.buffer}s[a++]=t?0:1;var i=n.byteLength.toString();for(o=0;o<i.length;o++)s[a++]=parseInt(i[o]);for(s[a++]=255,r=new Uint8Array(n),o=0;o<r.length;o++)s[a++]=r[o]}),r(s.buffer)})},f.encodePayloadAsBlob=function(e,n){g(e,function(e,a){f.encodePacket(e,!0,!0,function(e){var t=new Uint8Array(1);if(t[0]=1,"string"==typeof e){for(var n=new Uint8Array(e.length),r=0;r<e.length;r++)n[r]=e.charCodeAt(r);e=n.buffer,t[0]=0}var o=(e instanceof ArrayBuffer?e.byteLength:e.size).toString(),i=new Uint8Array(o.length+1);for(r=0;r<o.length;r++)i[r]=parseInt(o[r]);if(i[o.length]=255,y){var s=new y([t.buffer,i.buffer,e]);a(null,s)}})},function(e,t){return n(new y(t))})},f.decodePayloadAsBinary=function(e,n,r){"function"==typeof n&&(r=n,n=null);for(var t=e,o=[];0<t.byteLength;){for(var i=new Uint8Array(t),s=0===i[0],a="",c=1;255!==i[c];c++){if(310<a.length)return r(d,0,1);a+=i[c]}t=l(t,2+a.length),a=parseInt(a);var u=l(t,0,a);if(s)try{u=String.fromCharCode.apply(null,new Uint8Array(u))}catch(e){var p=new Uint8Array(u);for(u="",c=0;c<p.length;c++)u+=String.fromCharCode(p[c])}o.push(u),t=l(t,a)}var h=o.length;o.forEach(function(e,t){r(f.decodePacket(e,n,!0),t,h)})}},function(e,t){e.exports=Object.keys||function(e){var t=[],n=Object.prototype.hasOwnProperty;for(var r in e)n.call(e,r)&&t.push(r);return t}},function(e,t,n){var i=n(13),r=Object.prototype.toString,s="function"==typeof Blob||"undefined"!=typeof Blob&&"[object BlobConstructor]"===r.call(Blob),a="function"==typeof File||"undefined"!=typeof File&&"[object FileConstructor]"===r.call(File);e.exports=function e(t){if(!t||"object"!=typeof t)return!1;if(i(t)){for(var n=0,r=t.length;n<r;n++)if(e(t[n]))return!0;return!1}if("function"==typeof Buffer&&Buffer.isBuffer&&Buffer.isBuffer(t)||"function"==typeof ArrayBuffer&&t instanceof ArrayBuffer||s&&t instanceof Blob||a&&t instanceof File)return!0;if(t.toJSON&&"function"==typeof t.toJSON&&1===arguments.length)return e(t.toJSON(),!0);for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)&&e(t[o]))return!0;return!1}},function(e,t){e.exports=function(e,t,n){var r=e.byteLength;if(t=t||0,n=n||r,e.slice)return e.slice(t,n);if(t<0&&(t+=r),n<0&&(n+=r),r<n&&(n=r),r<=t||n<=t||0===r)return new ArrayBuffer(0);for(var o=new Uint8Array(e),i=new Uint8Array(n-t),s=t,a=0;s<n;s++,a++)i[a]=o[s];return i.buffer}},function(e,t){function s(){}e.exports=function(e,n,r){var o=!1;return r=r||s,0===(i.count=e)?n():i;function i(e,t){if(i.count<=0)throw new Error("after called too many times");--i.count,e?(o=!0,n(e),n=r):0!==i.count||o||n(null,t)}}},function(e,t){var i,s,a,c=String.fromCharCode;function u(e){for(var t,n,r=[],o=0,i=e.length;o<i;)55296<=(t=e.charCodeAt(o++))&&t<=56319&&o<i?56320==(64512&(n=e.charCodeAt(o++)))?r.push(((1023&t)<<10)+(1023&n)+65536):(r.push(t),o--):r.push(t);return r}function r(e,t){if(55296<=e&&e<=57343){if(t)throw Error("Lone surrogate U+"+e.toString(16).toUpperCase()+" is not a scalar value");return!1}return!0}function o(e,t){return c(e>>t&63|128)}function p(e,t){if(0==(4294967168&e))return c(e);var n="";return 0==(4294965248&e)?n=c(e>>6&31|192):0==(4294901760&e)?(r(e,t)||(e=65533),n=c(e>>12&15|224),n+=o(e,6)):0==(4292870144&e)&&(n=c(e>>18&7|240),n+=o(e,12),n+=o(e,6)),n+=c(63&e|128)}function h(){if(s<=a)throw Error("Invalid byte index");var e=255&i[a];if(a++,128==(192&e))return 63&e;throw Error("Invalid continuation byte")}function f(e){var t,n;if(s<a)throw Error("Invalid byte index");if(a==s)return!1;if(t=255&i[a],a++,0==(128&t))return t;if(192==(224&t)){if(128<=(n=(31&t)<<6|h()))return n;throw Error("Invalid continuation byte")}if(224==(240&t)){if(2048<=(n=(15&t)<<12|h()<<6|h()))return r(n,e)?n:65533;throw Error("Invalid continuation byte")}if(240==(248&t)&&65536<=(n=(7&t)<<18|h()<<12|h()<<6|h())&&n<=1114111)return n;throw Error("Invalid UTF-8 detected")}e.exports={version:"2.1.2",encode:function(e,t){for(var n=!1!==(t=t||{}).strict,r=u(e),o=r.length,i=-1,s="";++i<o;)s+=p(r[i],n);return s},decode:function(e,t){var n=!1!==(t=t||{}).strict;i=u(e),s=i.length,a=0;for(var r,o=[];!1!==(r=f(n));)o.push(r);return function(e){for(var t,n=e.length,r=-1,o="";++r<n;)65535<(t=e[r])&&(o+=c((t-=65536)>>>10&1023|55296),t=56320|1023&t),o+=c(t);return o}(o)}}},function(e,t){!function(){for(var i="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",h=new Uint8Array(256),e=0;e<i.length;e++)h[i.charCodeAt(e)]=e;t.encode=function(e){var t,n=new Uint8Array(e),r=n.length,o="";for(t=0;t<r;t+=3)o+=i[n[t]>>2],o+=i[(3&n[t])<<4|n[t+1]>>4],o+=i[(15&n[t+1])<<2|n[t+2]>>6],o+=i[63&n[t+2]];return r%3==2?o=o.substring(0,o.length-1)+"=":r%3==1&&(o=o.substring(0,o.length-2)+"=="),o},t.decode=function(e){var t,n,r,o,i,s=.75*e.length,a=e.length,c=0;"="===e[e.length-1]&&(s--,"="===e[e.length-2]&&s--);var u=new ArrayBuffer(s),p=new Uint8Array(u);for(t=0;t<a;t+=4)n=h[e.charCodeAt(t)],r=h[e.charCodeAt(t+1)],o=h[e.charCodeAt(t+2)],i=h[e.charCodeAt(t+3)],p[c++]=n<<2|r>>4,p[c++]=(15&r)<<4|o>>2,p[c++]=(3&o)<<6|63&i;return u}}()},function(e,t){var r=void 0!==r?r:"undefined"!=typeof WebKitBlobBuilder?WebKitBlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder&&MozBlobBuilder,n=function(){try{return 2===new Blob(["hi"]).size}catch(e){return!1}}(),o=n&&function(){try{return 2===new Blob([new Uint8Array([1,2])]).size}catch(e){return!1}}(),i=r&&r.prototype.append&&r.prototype.getBlob;function s(e){return e.map(function(e){if(e.buffer instanceof ArrayBuffer){var t=e.buffer;if(e.byteLength!==t.byteLength){var n=new Uint8Array(e.byteLength);n.set(new Uint8Array(t,e.byteOffset,e.byteLength)),t=n.buffer}return t}return e})}function a(e,t){t=t||{};var n=new r;return s(e).forEach(function(e){n.append(e)}),t.type?n.getBlob(t.type):n.getBlob()}function c(e,t){return new Blob(s(e),t||{})}"undefined"!=typeof Blob&&(a.prototype=Blob.prototype,c.prototype=Blob.prototype),e.exports=n?o?Blob:c:i?a:void 0},function(e,t){t.encode=function(e){var t="";for(var n in e)e.hasOwnProperty(n)&&(t.length&&(t+="&"),t+=encodeURIComponent(n)+"="+encodeURIComponent(e[n]));return t},t.decode=function(e){for(var t={},n=e.split("&"),r=0,o=n.length;r<o;r++){var i=n[r].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}},function(e,t){e.exports=function(e,t){var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}},function(e,t){var n,r="0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz-_".split(""),o=64,i={},s=0,a=0;function c(e){for(var t="";t=r[e%o]+t,0<(e=Math.floor(e/o)););return t}function u(){var e=c(+new Date);return e!==n?(s=0,n=e):e+"."+c(s++)}for(;a<o;a++)i[r[a]]=a;u.encode=c,u.decode=function(e){var t=0;for(a=0;a<e.length;a++)t=t*o+i[e.charAt(a)];return t},e.exports=u},function(n,e,a){(function(r){var o=a(22),e=a(33);n.exports=t;var i,u=/\n/g,p=/\\n/g;function s(){}function t(e){if(o.call(this,e),this.query=this.query||{},!i){var t="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r?r:{};i=t.___eio=t.___eio||[]}this.index=i.length;var n=this;i.push(function(e){n.onData(e)}),this.query.j=this.index,"function"==typeof addEventListener&&addEventListener("beforeunload",function(){n.script&&(n.script.onerror=s)},!1)}e(t,o),t.prototype.supportsBinary=!1,t.prototype.doClose=function(){this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),this.form&&(this.form.parentNode.removeChild(this.form),this.form=null,this.iframe=null),o.prototype.doClose.call(this)},t.prototype.doPoll=function(){var t=this,e=document.createElement("script");this.script&&(this.script.parentNode.removeChild(this.script),this.script=null),e.async=!0,e.src=this.uri(),e.onerror=function(e){t.onError("jsonp poll error",e)};var n=document.getElementsByTagName("script")[0];n?n.parentNode.insertBefore(e,n):(document.head||document.body).appendChild(e),this.script=e,"undefined"!=typeof navigator&&/gecko/i.test(navigator.userAgent)&&setTimeout(function(){var e=document.createElement("iframe");document.body.appendChild(e),document.body.removeChild(e)},100)},t.prototype.doWrite=function(e,t){var n=this;if(!this.form){var r,o=document.createElement("form"),i=document.createElement("textarea"),s=this.iframeId="eio_iframe_"+this.index;o.className="socketio",o.style.position="absolute",o.style.top="-1000px",o.style.left="-1000px",o.target=s,o.method="POST",o.setAttribute("accept-charset","utf-8"),i.name="d",o.appendChild(i),document.body.appendChild(o),this.form=o,this.area=i}function a(){c(),t()}function c(){if(n.iframe)try{n.form.removeChild(n.iframe)}catch(e){n.onError("jsonp polling iframe removal error",e)}try{var e='<iframe src="javascript:0" name="'+n.iframeId+'">';r=document.createElement(e)}catch(e){(r=document.createElement("iframe")).name=n.iframeId,r.src="javascript:0"}r.id=n.iframeId,n.form.appendChild(r),n.iframe=r}this.form.action=this.uri(),c(),e=e.replace(p,"\\\n"),this.area.value=e.replace(u,"\\n");try{this.form.submit()}catch(e){}this.iframe.attachEvent?this.iframe.onreadystatechange=function(){"complete"===n.iframe.readyState&&a()}:this.iframe.onload=a}}).call(e,function(){return this}())},function(e,t,n){var r,o,i=n(23),s=n(24),a=n(32),c=n(33),u=n(34),p=n(3)("engine.io-client:websocket");if("undefined"!=typeof WebSocket?r=WebSocket:"undefined"!=typeof self&&(r=self.WebSocket||self.MozWebSocket),"undefined"==typeof window)try{o=n(37)}catch(e){}var h=r||o;function f(e){e&&e.forceBase64&&(this.supportsBinary=!1),this.perMessageDeflate=e.perMessageDeflate,this.usingBrowserWebSocket=r&&!e.forceNode,this.protocols=e.protocols,this.usingBrowserWebSocket||(h=o),i.call(this,e)}c(e.exports=f,i),f.prototype.name="websocket",f.prototype.supportsBinary=!0,f.prototype.doOpen=function(){if(this.check()){var e=this.uri(),t=this.protocols,n={agent:this.agent,perMessageDeflate:this.perMessageDeflate};n.pfx=this.pfx,n.key=this.key,n.passphrase=this.passphrase,n.cert=this.cert,n.ca=this.ca,n.ciphers=this.ciphers,n.rejectUnauthorized=this.rejectUnauthorized,this.extraHeaders&&(n.headers=this.extraHeaders),this.localAddress&&(n.localAddress=this.localAddress);try{this.ws=this.usingBrowserWebSocket&&!this.isReactNative?t?new h(e,t):new h(e):new h(e,t,n)}catch(e){return this.emit("error",e)}void 0===this.ws.binaryType&&(this.supportsBinary=!1),this.ws.supports&&this.ws.supports.binary?(this.supportsBinary=!0,this.ws.binaryType="nodebuffer"):this.ws.binaryType="arraybuffer",this.addEventListeners()}},f.prototype.addEventListeners=function(){var t=this;this.ws.onopen=function(){t.onOpen()},this.ws.onclose=function(){t.onClose()},this.ws.onmessage=function(e){t.onData(e.data)},this.ws.onerror=function(e){t.onError("websocket error",e)}},f.prototype.write=function(e){var r=this;this.writable=!1;for(var o=e.length,t=0,n=o;t<n;t++)!function(n){s.encodePacket(n,r.supportsBinary,function(e){if(!r.usingBrowserWebSocket){var t={};n.options&&(t.compress=n.options.compress),r.perMessageDeflate&&("string"==typeof e?Buffer.byteLength(e):e.length)<r.perMessageDeflate.threshold&&(t.compress=!1)}try{r.usingBrowserWebSocket?r.ws.send(e):r.ws.send(e,t)}catch(e){p("websocket closed before onclose event")}--o||(r.emit("flush"),setTimeout(function(){r.writable=!0,r.emit("drain")},0))})}(e[t])},f.prototype.onClose=function(){i.prototype.onClose.call(this)},f.prototype.doClose=function(){void 0!==this.ws&&this.ws.close()},f.prototype.uri=function(){var e=this.query||{},t=this.secure?"wss":"ws",n="";return this.port&&("wss"===t&&443!==Number(this.port)||"ws"===t&&80!==Number(this.port))&&(n=":"+this.port),this.timestampRequests&&(e[this.timestampParam]=u()),this.supportsBinary||(e.b64=1),(e=a.encode(e)).length&&(e="?"+e),t+"://"+(-1!==this.hostname.indexOf(":")?"["+this.hostname+"]":this.hostname)+n+this.path+e},f.prototype.check=function(){return!(!h||"__initialize"in h&&this.name===f.prototype.name)}},function(e,t){},function(e,t){var r=[].indexOf;e.exports=function(e,t){if(r)return e.indexOf(t);for(var n=0;n<e.length;++n)if(e[n]===t)return n;return-1}},function(e,t,n){var o=n(7),r=n(11),i=n(40),s=n(41),a=n(42),c=n(3)("socket.io-client:socket"),u=n(32),p=n(26);e.exports=l;var h={connect:1,connect_error:1,connect_timeout:1,connecting:1,disconnect:1,error:1,reconnect:1,reconnect_attempt:1,reconnect_failed:1,reconnect_error:1,reconnecting:1,ping:1,pong:1},f=r.prototype.emit;function l(e,t,n){this.io=e,this.nsp=t,(this.json=this).ids=0,this.acks={},this.receiveBuffer=[],this.sendBuffer=[],this.connected=!1,this.disconnected=!0,this.flags={},n&&n.query&&(this.query=n.query),this.io.autoConnect&&this.open()}r(l.prototype),l.prototype.subEvents=function(){if(!this.subs){var e=this.io;this.subs=[s(e,"open",a(this,"onopen")),s(e,"packet",a(this,"onpacket")),s(e,"close",a(this,"onclose"))]}},l.prototype.open=l.prototype.connect=function(){return this.connected||(this.subEvents(),this.io.open(),"open"===this.io.readyState&&this.onopen(),this.emit("connecting")),this},l.prototype.send=function(){var e=i(arguments);return e.unshift("message"),this.emit.apply(this,e),this},l.prototype.emit=function(e){if(h.hasOwnProperty(e))return f.apply(this,arguments),this;var t=i(arguments),n={type:(void 0!==this.flags.binary?this.flags.binary:p(t))?o.BINARY_EVENT:o.EVENT,data:t,options:{}};return n.options.compress=!this.flags||!1!==this.flags.compress,"function"==typeof t[t.length-1]&&(c("emitting packet with ack id %d",this.ids),this.acks[this.ids]=t.pop(),n.id=this.ids++),this.connected?this.packet(n):this.sendBuffer.push(n),this.flags={},this},l.prototype.packet=function(e){e.nsp=this.nsp,this.io.packet(e)},l.prototype.onopen=function(){if(c("transport is open - connecting"),"/"!==this.nsp)if(this.query){var e="object"==typeof this.query?u.encode(this.query):this.query;c("sending connect packet with query %s",e),this.packet({type:o.CONNECT,query:e})}else this.packet({type:o.CONNECT})},l.prototype.onclose=function(e){c("close (%s)",e),this.connected=!1,this.disconnected=!0,delete this.id,this.emit("disconnect",e)},l.prototype.onpacket=function(e){var t=e.nsp===this.nsp,n=e.type===o.ERROR&&"/"===e.nsp;if(t||n)switch(e.type){case o.CONNECT:this.onconnect();break;case o.EVENT:case o.BINARY_EVENT:this.onevent(e);break;case o.ACK:case o.BINARY_ACK:this.onack(e);break;case o.DISCONNECT:this.ondisconnect();break;case o.ERROR:this.emit("error",e.data)}},l.prototype.onevent=function(e){var t=e.data||[];c("emitting event %j",t),null!=e.id&&(c("attaching ack callback to event"),t.push(this.ack(e.id))),this.connected?f.apply(this,t):this.receiveBuffer.push(t)},l.prototype.ack=function(t){var n=this,r=!1;return function(){if(!r){r=!0;var e=i(arguments);c("sending ack %j",e),n.packet({type:p(e)?o.BINARY_ACK:o.ACK,id:t,data:e})}}},l.prototype.onack=function(e){var t=this.acks[e.id];"function"==typeof t?(c("calling ack %s with %j",e.id,e.data),t.apply(this,e.data),delete this.acks[e.id]):c("bad ack %s",e.id)},l.prototype.onconnect=function(){this.connected=!0,this.disconnected=!1,this.emit("connect"),this.emitBuffered()},l.prototype.emitBuffered=function(){var e;for(e=0;e<this.receiveBuffer.length;e++)f.apply(this,this.receiveBuffer[e]);for(this.receiveBuffer=[],e=0;e<this.sendBuffer.length;e++)this.packet(this.sendBuffer[e]);this.sendBuffer=[]},l.prototype.ondisconnect=function(){c("server disconnect (%s)",this.nsp),this.destroy(),this.onclose("io server disconnect")},l.prototype.destroy=function(){if(this.subs){for(var e=0;e<this.subs.length;e++)this.subs[e].destroy();this.subs=null}this.io.destroy(this)},l.prototype.close=l.prototype.disconnect=function(){return this.connected&&(c("performing disconnect (%s)",this.nsp),this.packet({type:o.DISCONNECT})),this.destroy(),this.connected&&this.onclose("io client disconnect"),this},l.prototype.compress=function(e){return this.flags.compress=e,this},l.prototype.binary=function(e){return this.flags.binary=e,this}},function(e,t){e.exports=function(e,t){for(var n=[],r=(t=t||0)||0;r<e.length;r++)n[r-t]=e[r];return n}},function(e,t){e.exports=function(e,t,n){return e.on(t,n),{destroy:function(){e.removeListener(t,n)}}}},function(e,t){var r=[].slice;e.exports=function(e,t){if("string"==typeof t&&(t=e[t]),"function"!=typeof t)throw new Error("bind() requires a function");var n=r.call(arguments,2);return function(){return t.apply(e,n.concat(r.call(arguments)))}}},function(e,t){function n(e){e=e||{},this.ms=e.min||100,this.max=e.max||1e4,this.factor=e.factor||2,this.jitter=0<e.jitter&&e.jitter<=1?e.jitter:0,this.attempts=0}(e.exports=n).prototype.duration=function(){var e=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),n=Math.floor(t*this.jitter*e);e=0==(1&Math.floor(10*t))?e-n:e+n}return 0|Math.min(e,this.max)},n.prototype.reset=function(){this.attempts=0},n.prototype.setMin=function(e){this.ms=e},n.prototype.setMax=function(e){this.max=e},n.prototype.setJitter=function(e){this.jitter=e}}])},"object"==typeof exports&&"object"==typeof module?module.exports=r():"function"==typeof define&&define.amd?define([],r):n.io=r()}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-core-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t;(t=e.Services||(e.Services={})).Components||(t.Components={})}(MyWay||(MyWay={})),function(e){var r;(function(t){"use strict";var a;(a=t.RegistryType||(t.RegistryType={})).API="API";var e=function(i){function e(e,t){var r=i.call(this,a.API,[a.COMMON])||this;return r.factoryRegistries=e,r.serviceApiFactory=t,r.capabilities=null,r.apiInitializer=null,r}return __extends(e,i),e.getInstance=function(){return null===e.instance&&(e.instance=new e(t.FactoryRegistries.getInstance(),new r.ServiceApiFactory),t.FactoryRegistries.getInstance().addRegistry(e.instance)),e.instance},e.prototype.init=function(t){var r=this;return this.getRegistryCommon().getComponentsInstances().forEach(function(e){r._componentsInstancesByKey[e.name]||(r._componentsInstances.push(e),r._componentsInstancesByKey[e.name]=e)}),this.capabilities?i.prototype.init.call(this,t):this.serviceApiFactory.GetServiceLocalCapabilities().then(function(e){return r.capabilities=e,i.prototype.init.call(r,t)})},e.prototype.initializeComponent=function(e){return e.init(this.capabilities,this.factoryRegistries.getRegistryInstance(a.MANAGER).getLibrary(),this.apiInitializer)},e.prototype.getRegistryCommon=function(){return this._dependenciesInstances[0]},e.prototype.setApiInitializer=function(e){this.apiInitializer=e},e.instance=null,e}(t.AbstractRegistry);t.RegistryApi=e})((r=e.Services||(e.Services={})).Components||(r.Components={}))}(MyWay||(MyWay={})),function(e){var i,t,r;i=e.Services||(e.Services={}),t=i.Components||(i.Components={}),r=function(){function e(e){this._name=e,this.libraryManager=null,this.privatePortalServiceParameters=null,this.portalServiceParameters=null}return e.prototype.init=function(e,t,r){return this.libraryManager=t,this.privatePortalServiceParameters=r.privatePortalServiceParameters,this.portalServiceParameters=r.portalServiceParameters,i.CoreCommon.getPromesseSelfResoved()},e.prototype.dispose=function(){return i.CoreCommon.getPromesseSelfResoved()},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e.prototype.WarnLocalServiceUnavailability=function(){e.loggerBase.warn("Le service local n'a pu être joint et a été désactivé. Veuillez redémarrer le service local et recharger le portail")},e.CLASS_NAMEBase="MyWay.Services.Component.ComponentApiBase",e.loggerBase=i.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAMEBase),e}(),t.ComponentApiBase=r}(MyWay||(MyWay={})),function(e){var t,r;t=e.Services||(e.Services={}),r=function(){function e(){if(e._instance)throw new Error("Error: Instantiation failed: Use PrivatePortalServiceParameters.Instance() instead of new.");e._instance=this}return e.Instance=function(){return null===e._instance&&(e._instance=new e),e._instance},e.prototype.init=function(){this.AideUrl=t.PortalServiceParameters.Instance().RestUrl+"/aideenligne/v1",this.ApplicationUrl=t.PortalServiceParameters.Instance().RestUrl+"/portailmyway-v1/application",this.DonneesDelocaliseesUrl=t.PortalServiceParameters.Instance().RestUrl+"/donneesDelocalisees/v1/",this.TraceUrl=t.PortalServiceParameters.Instance().TraceUrl+"/trace/v2/trace",this.ConfigurationPosteUrl=t.PortalServiceParameters.Instance().RestUrl+"/configuration-poste/v1/configuration",this.PreferencesUrl=t.PortalServiceParameters.Instance().RestUrl+"/preferenceUtilisateur/v1",this.TraceSuiviUrl=t.PortalServiceParameters.Instance().TraceUrl+"/trace-suivis/v1/",this.AuthentificationUrl=t.PortalServiceParameters.Instance().RestUrl+"/infos-poste/v1/configuration",this.NumerotationTelephoniqueUrl=t.PortalServiceParameters.Instance().RestUrl+"/boiteoutil/v1/numerotationTelephonique",this.GetFichierFromGEDUrl=t.PortalServiceParameters.Instance().RestUrl+"/document-v1/contenu",this.HabilitationUrl=t.PortalServiceParameters.Instance().RestUrl+"/habilitation/v2",this.RADLADUrl=t.PortalServiceParameters.Instance().RestUrl+"/document-v1/reconnaissance",this.StockageUrl=t.PortalServiceParameters.Instance().RestUrl+"/document-v1/stockage",this.GedUrl=t.PortalServiceParameters.Instance().RestUrl+"/document/v1/contenu",this.ReferentielProcessusSiUrl=t.PortalServiceParameters.Instance().RestUrl+"/referentielprocessussi/v1",this.PortalInfoUrl=t.PortalServiceParameters.Instance().RestUrl+"/portailmyway/v1",this.LisaUrl=t.PortalServiceParameters.Instance().SpaUrl+"/lisa/v2",this.PortsServiceUrl=t.PortalServiceParameters.Instance().PortsServiceUrl,this.PortsHttpsServiceUrl=t.PortalServiceParameters.Instance().PortsHttpsServiceUrl,this.LocalServiceUrl=t.PortalServiceParameters.Instance().ServiceLocaleUrl,this.ImpressionUrl=t.PortalServiceParameters.Instance().ImpressionUrl,this.FichierMessage="/v1/data/MessagesMyWay_fr.json",this._lisaPlaceHolders={VERS:t.PortalServiceParameters.Instance().Version,"URL-SPA":t.PortalServiceParameters.Instance().SpaUrl,"URL-SPA-NEW":"http://myway-dua.sigcesie.caisse-epargne.fr:6080/version2",PORT:"",ALIASTESTAPPS:"/myway.test-apps","ALIASTESTAPPS-CAPACITES":"/myway.utilitaires-socle-technique.capacites","ALIASTESTAPPS-CONTEXTVIEWER":"/myway.utilitaires-socle-technique.context-viewer","ALIASTESTAPPS-DATABASEVIEWER":"/myway.utilitaires-socle-technique.database-viewer","ALIASTESTAPPS-EXPORT":"/myway.utilitaires-socle-technique.export",ALIASPORTAIL:"/portail",PRESPMM:t.PortalServiceParameters.Instance().PresPMM,ENVPMM:t.PortalServiceParameters.Instance().EnvPMM,DOMPMM:t.PortalServiceParameters.Instance().DomainePMM},t.PortalServiceParameters.Instance().LisaFilePath&&(this.LisaFileUrl=t.PortalServiceParameters.Instance().CDNUrl+t.PortalServiceParameters.Instance().LisaFilePath),this.AuthorizedDomains=t.PortalServiceParameters.Instance().AuthorizedDomains,this.Environnement=t.PortalServiceParameters.Instance().Environnement,this.KofaxUrl="http://127.0.0.1:23023/session"},Object.defineProperty(e.prototype,"ModeDebug",{get:function(){return!!(this.TTLModeDebug&&this.TTLModeDebug>Date.now())},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"LisaPlaceholders",{get:function(){return this._lisaPlaceHolders},set:function(e){this._lisaPlaceHolders=e},enumerable:!0,configurable:!0}),e._instance=null,e}(),t.PrivatePortalServiceParameters=r}(MyWay||(MyWay={})),function(e){!function(i){var e=function(){function r(){this.DeviceCapabilities=new t}return r.prototype.GetServiceLocalCapabilities=function(){var t=this;return i.CoreCommon.SendRequestWithPromise({url:i.PrivatePortalServiceParameters.Instance().PortsServiceUrl+"/ports/GetPortUtilisateur",cache:!1,timeout:3e3}).then(function(e){i.PrivatePortalServiceParameters.Instance().LocalServiceUrl="http://localhost:"+e+"/"},function(){return i.CoreCommon.SendRequestWithPromise({url:i.PrivatePortalServiceParameters.Instance().PortsHttpsServiceUrl+"/ports/GetPortUtilisateur",cache:!1,timeout:3e3}).then(function(e){i.PrivatePortalServiceParameters.Instance().LocalServiceUrl="https://localhost:"+e+"/"})}).catch(function(){return t.DeviceCapabilities}).finally(function(){return i.CoreCommon.SendRequestWithPromise({url:i.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/contexte/GetCompetencesSL",cache:!1,timeout:3e3}).then(function(e){t.DeviceCapabilities.ServiceLocal=!0,t.DeviceCapabilities.SIRIS=e.SIRIS,t.DeviceCapabilities.InteropAppliBancaire=e.interopApplicationBancaire,r.logger.info("GetCompetencesSL : SIRIS=%1;InteropAppliBancaire=%2",e.SIRIS,e.interopApplicationBancaire)}).catch(function(e){t.DeviceCapabilities.ServiceLocal=!1,t.DeviceCapabilities.SIRIS=!1,t.DeviceCapabilities.InteropAppliBancaire=!1,r.logger.info("GetCompetencesSL pas disponible : %1",e.codeLibelle)}).finally(function(){t.DeviceCapabilities.MobileBrowser=i.CoreCommon.IsMobileBrowser()})}).then(function(){return t.DeviceCapabilities})},r.CLASS_NAME="MyWay.Services.ServiceApiFactory",r.logger=i.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME),r}();i.ServiceApiFactory=e;var t=function(){};i.DeviceCapabilities=t;var r=function(){};i.CompetencesServiceLocal=r}(e.Services||(e.Services={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-core-api.min.js.map
var MyWay;!function(e){var n,o;n=e.Services||(e.Services={}),((o=n.Components||(n.Components={})).ComponentType||(o.ComponentType={})).JAB="JAB"}(MyWay||(MyWay={})),function(e){var n,o,t;n=e.Services||(e.Services={}),o=n.JAB||(n.JAB={}),(t=o.JABMessageSubject||(o.JABMessageSubject={}))[t.Enregistrer=0]="Enregistrer",n.Components.FactoryRegistries.getInstance().declareComponent(n.Components.ComponentType.JAB,[n.Components.ComponentType.Core])}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-jab-common.min.js.map
var MyWay;!function(e){var n,t;n=e.Services||(e.Services={}),((t=n.Components||(n.Components={})).ComponentType||(t.ComponentType={})).TraitementNsdk="TraitementNsdk"}(MyWay||(MyWay={})),function(e){var n,t,o;n=e.Services||(e.Services={}),t=n.TraitementNsdk||(n.TraitementNsdk={}),(o=t.TraitementNsdkMessageSubject||(t.TraitementNsdkMessageSubject={}))[o.Lancer=0]="Lancer",n.Components.FactoryRegistries.getInstance().declareComponent(n.Components.ComponentType.TraitementNsdk,[n.Components.ComponentType.Core])}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-traitement-nsdk-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var t,o;t=e.Services||(e.Services={}),((o=t.Components||(t.Components={})).ComponentType||(o.ComponentType={})).Dates="Dates"}(MyWay||(MyWay={})),function(e){var m;(function(e){var n,t;(t=n=e.FORMATS_DATE||(e.FORMATS_DATE={}))[t.aaaammjj=10]="aaaammjj";var o=function(e){function l(){return e.call(this,m.Components.ComponentType.Dates)||this}return __extends(l,e),l.prototype.init=function(){return m.CoreCommon.getPromesseSelfResoved()},l.prototype.dispose=function(){return m.CoreCommon.getPromesseSelfResoved()},l.prototype.getDateDuJour=function(e){var t="";if(m.Controle.StaticEnumControle.isAnEnumValue(e,n)||(t+="Le paramètre 'format' est obligatoire et sa valeur doit faire partie de l'enum 'FORMATS_DATE' / "),""!=t)return t=t.substring(0,t.lastIndexOf("/")-1),m.Loggers.FLASH.INSTANCE.setValue("action","getDateDuJour"),void l.logger.error(t);var o=new Date;switch(e){case n.aaaammjj:return o.getFullYear()+("0"+(o.getMonth()+1)).substr(-2,2)+("0"+o.getDate()).substr(-2,2);default:var r="Le format '"+e+"' n'est pas reconnu!";return m.Loggers.FLASH.INSTANCE.setValue("action","getDateDuJour"),l.logger.error(r),r}},l.prototype.isBissextile=function(){var e=(new Date).getFullYear();return e%4==0&&e%100!=0||e%400==0},l.prototype.getNbJoursMois=function(e,t){return[31,this.isBissextile()?29:28,31,30,31,30,31,31,30,31,30,31][t]},l.prototype.CompareDates=function(e,t,o){var r,n=Math.round(Math.abs((e.getTime()-t.getTime())/864e5));switch(o){case"d":r=1;break;case"m":r=30;break;case"y":r=365;break;default:r=1}return Math.floor(n/r)},l.prototype.addDate=function(e,t,o,r){var n="";if(m.Controle.StaticDateControle.isDate(e)||(n+="Le paramètre 'd' est obligatoire et doit être un objet date / "),m.Controle.StaticNumberControle.isInt(t)||(n+="Le paramètre 'jours' est obligatoire et doit être un nombre entier / "),m.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o)&&!m.Controle.StaticNumberControle.isInt(o)&&(n+="Le paramètre 'mois' doit être un nombre entier / "),m.Controle.StaticAnyControle.isNotUndefinedAndNotNull(r)&&!m.Controle.StaticNumberControle.isInt(r)&&(n+="Le paramètre 'annees' doit être un nombre entier / "),""!=n)return n=n.substring(0,n.lastIndexOf("/")-1),m.Loggers.FLASH.INSTANCE.setValue("action","addDate"),void l.logger.error(n);var a=e.getTime(),s=new Date;if(0<t&&(a+=864e5*t),s.setTime(a),null!=o&&0<o){var i=s.getDate();s.setDate(1),s.setMonth(s.getMonth()+o);var u=this.getNbJoursMois(s.getFullYear(),s.getMonth());s.setDate(Math.min(i,u))}return null!=r&&0<r&&s.setFullYear(s.getFullYear()+r),s},l.CLASS_NAME="MyWay.Services.Dates.DatesCommon",l.logger=m.Loggers.LoggerFactory.INSTANCE.getClass(l.CLASS_NAME),l}(m.Components.ComponentBase);e.DatesCommon=o,m.Components.RegistryCommon.getInstance().register(o),m.Components.FactoryRegistries.getInstance().declareComponent(m.Components.ComponentType.Dates,[])})((m=e.Services||(e.Services={})).Dates||(m.Dates={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-dates-common.min.js.map
var MyWay;!function(e){var n,s;n=e.Services||(e.Services={}),((s=n.Components||(n.Components={})).ComponentType||(s.ComponentType={})).Persistence="Persistence"}(MyWay||(MyWay={})),function(e){var n,s;n=e.Services||(e.Services={}),(s=n.Persistence||(n.Persistence={})).PersistenceMessageSubject||(s.PersistenceMessageSubject={}),n.Components.FactoryRegistries.getInstance().declareComponent(n.Components.ComponentType.Persistence,[])}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-persistence-common.min.js.map
var MyWay;!function(e){var _,F,i,n;_=e.Services||(e.Services={}),F=_.Fichier||(_.Fichier={}),(i=F.TYPE_FICHIER||(F.TYPE_FICHIER={}))[i.PDF=0]="PDF",i[i.PDF_EMBED=5]="PDF_EMBED",i[i.PDFA_1A=10]="PDFA_1A",i[i.PDFA_1B=15]="PDFA_1B",i[i.PDFX_1_2001=20]="PDFX_1_2001",i[i.PDFX_1A_2001=25]="PDFX_1A_2001",i[i.PDFX_1A_2003=30]="PDFX_1A_2003",i[i.PDFX_3_2002=35]="PDFX_3_2002",i[i.PDFX_3_2003=40]="PDFX_3_2003",i[i.JSON=105]="JSON",i[i.TAR_GZ=110]="TAR_GZ",i[i.WORDML=100]="WORDML",(n=F.TYPE_DONNEES_A_SAUVER||(F.TYPE_DONNEES_A_SAUVER={}))[n.BLOB=0]="BLOB",n[n.BASE64=1]="BASE64"}(MyWay||(MyWay={})),function(e){var _,F;_=e.Services||(e.Services={}),((F=_.Components||(_.Components={})).ComponentType||(F.ComponentType={})).Fichier="Fichier"}(MyWay||(MyWay={})),function(e){var _,F,i;_=e.Services||(e.Services={}),F=_.Fichier||(_.Fichier={}),(i=F.FichierMessageSubject||(F.FichierMessageSubject={}))[i.SaveAs=0]="SaveAs",_.Components.FactoryRegistries.getInstance().declareComponent(_.Components.ComponentType.Fichier,[])}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-fichier-common.min.js.map
var MyWay;!function(e){var E,n;E=e.Services||(e.Services={}),((n=E.Components||(E.Components={})).ComponentType||(n.ComponentType={})).BaseDeDonnees="BaseDeDonnees"}(MyWay||(MyWay={})),function(e){var E,n,s,R;E=e.Services||(e.Services={}),n=E.BaseDeDonnees||(E.BaseDeDonnees={}),s=n.Messages||(n.Messages={}),(R=s.BaseDeDonneesMessageSubject||(s.BaseDeDonneesMessageSubject={}))[R.GetBases=0]="GetBases",R[R.Get=1]="Get",R[R.GetAll=2]="GetAll",R[R.Find=3]="Find",R[R.Count=4]="Count",R[R.Ajouter=5]="Ajouter",R[R.Supprimer=6]="Supprimer",R[R.MettreAJour=7]="MettreAJour",R[R.ResetAll=8]="ResetAll",E.Components.FactoryRegistries.getInstance().declareComponent(E.Components.ComponentType.BaseDeDonnees,[])}(MyWay||(MyWay={})),function(e){var E,n,s,R,T,I,t,a,o;E=e.Services||(e.Services={}),n=E.BaseDeDonnees||(E.BaseDeDonnees={}),(s=n.messages||(n.messages={})).NOM_BIBLIOTHEQUE="BaseDeDonnees",(R=s.DB_UPGRADE_TYPE||(s.DB_UPGRADE_TYPE={}))[R.TABLE_CREER="tableCreer"]="TABLE_CREER",R[R.TABLE_SUPPRIMER="tableSupprimer"]="TABLE_SUPPRIMER",R[R.INDEX_CREER="indexCreer"]="INDEX_CREER",R[R.INDEX_SUPPRIMER="indexSupprimer"]="INDEX_SUPPRIMER",(T=s.CAPACITE||(s.CAPACITE={}))[T.VOLATILE=1]="VOLATILE",T[T.MONO_ENREGISTREMENT=2]="MONO_ENREGISTREMENT",T[T.MULTI_ENREGISTREMENT=3]="MULTI_ENREGISTREMENT",(I=s.TYPE_BASE||(s.TYPE_BASE={}))[I.INDEXEDDB="indexeddb"]="INDEXEDDB",I[I.LOCALSTORAGE="localstorage"]="LOCALSTORAGE",I[I.MEMORY="memory"]="MEMORY",(t=s.CLE_TYPE||(s.CLE_TYPE={}))[t.AUTOINCREMENT="autoincrement"]="AUTOINCREMENT",t[t.PATH="path"]="PATH",(a=s.CRITERE_TYPE||(s.CRITERE_TYPE={}))[a.EGAL="egal"]="EGAL",a[a.INFERIEUR="inferieur"]="INFERIEUR",a[a.SUPERIEUR="superieur"]="SUPERIEUR",a[a.BORNES="bornes"]="BORNES",(o=s.CRITERE_DIRECTION||(s.CRITERE_DIRECTION={}))[o.PRECEDENT="precedent"]="PRECEDENT",o[o.PRECEDENT_UNIQUE="precedent_unique"]="PRECEDENT_UNIQUE",o[o.SUIVANT="suivant"]="SUIVANT",o[o.SUIVANT_UNIQUE="suivant_unique"]="SUIVANT_UNIQUE"}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-database-common.min.js.map
var MyWay;!function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={})),function(e){var n,o;n=e.Services||(e.Services={}),((o=n.Components||(n.Components={})).ComponentType||(o.ComponentType={})).Performance="Performance"}(MyWay||(MyWay={})),function(e){var n,o,r,a,c;n=e.Services||(e.Services={}),o=n.Performance||(n.Performance={}),(r=o.PerformanceMessageSubject||(o.PerformanceMessageSubject={}))[r.STEP=0]="STEP",r[r.END=1]="END",r[r.CANCEL=2]="CANCEL",n.Components.FactoryRegistries.getInstance().declareComponent(n.Components.ComponentType.Performance,[n.Components.ComponentType.Core]),(a=o.PerformanceType||(o.PerformanceType={}))[a.OPERATION=0]="OPERATION",a[a.APP_LOADING=1]="APP_LOADING",a[a.HTTP_REQUEST=2]="HTTP_REQUEST",(c=o.AppLoadingPerformanceStep||(o.AppLoadingPerformanceStep={})).START_LISA="startLisa",c.END_LISA="endLisa",c.INIT_SPA="initSpa",c.MANUAL_END="manualEnd",c.AUTO_END="autoEnd"}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-performance-common.min.js.map
var MyWay;!function(e){var o,t;o=e.Services||(e.Services={}),((t=o.Components||(o.Components={})).ComponentType||(t.ComponentType={})).Export="Export"}(MyWay||(MyWay={})),function(e){var o,t,r;o=e.Services||(e.Services={}),t=o.Export||(o.Export={}),(r=t.ExportMessageSubject||(t.ExportMessageSubject={}))[r.ExporterFichier=0]="ExporterFichier",o.Components.FactoryRegistries.getInstance().declareComponent(o.Components.ComponentType.Export,[o.Components.ComponentType.Core])}(MyWay||(MyWay={})),function(e){var o,t,r,n;o=e.Services||(e.Services={}),t=o.Export||(o.Export={}),(r=t.FORMAT_FICHIER||(t.FORMAT_FICHIER={}))[r.CSV="csv"]="CSV",(n=t.LOCALISATION||(t.LOCALISATION={}))[n.EN=0]="EN",n[n.FR=1]="FR"}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-export-common.min.js.map
var MyWay;!function(y){var a;(a=y.Services||(y.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-test-business-object.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,e){n.__proto__=e}||function(n,e){for(var t in e)e.hasOwnProperty(t)&&(n[t]=e[t])};return function(n,e){function t(){this.constructor=n}o(n,e),n.prototype=null===e?Object.create(e):(t.prototype=e.prototype,new t)}}();!function(n){var s;(function(n){var t=function(){function n(){}return n.filtrer=function(n,e){var t="";if(s.Controle.StaticArrayControle.isArray(n)||(t+="Le paramètre 'collection' est obligatoire et doit être un tableau / "),s.Controle.StaticFunctionControle.isFunction(e)||(t+="Le paramètre 'predicat' est obligatoire et doit être une fonction / "),""!=t)throw t=t.substring(0,t.lastIndexOf("/")-1);for(var o=[],r=-1,i=n.length;++r<i;){var u=n[r],a=e(u);if(!s.Controle.StaticBooleanControle.isBoolean(a)){o=null;break}a&&o.push(u)}return o},n}();n.StaticArrayExtension=t;var e=function(){function n(){}return n.prototype.filtrer=function(n,e){return t.filtrer(n,e)},n}();n.ArrayExtension=e})((s=n.Services||(n.Services={})).Donnees||(s.Donnees={}))}(MyWay||(MyWay={})),function(n){var e,t;e=n.Services||(n.Services={}),((t=e.Components||(e.Components={})).ComponentType||(t.ComponentType={})).Donnees="Donnees"}(MyWay||(MyWay={})),function(n){var t,o,e;t=n.Services||(n.Services={}),o=t.Donnees||(t.Donnees={}),e=function(e){function n(){var n=e.call(this,t.Components.ComponentType.Donnees)||this;return n.Enum=new o.EnumExtension,n.Array=new o.ArrayExtension,n.Object=new o.ObjectExtension,n.String=new o.StringExtension,n}return __extends(n,e),n.prototype.init=function(){return t.CoreCommon.getPromesseSelfResoved()},n.prototype.dispose=function(){return t.CoreCommon.getPromesseSelfResoved()},n}(t.Components.ComponentBase),o.DonneesCommon=e,t.Components.RegistryCommon.getInstance().register(e),t.Components.FactoryRegistries.getInstance().declareComponent(t.Components.ComponentType.Donnees,[])}(MyWay||(MyWay={})),function(n){var e;(function(n){var t=function(){function n(){}return n.getNames=function(n){var e=[];for(var t in n)"number"==typeof n[t]&&e.push(t);return e},n.getName=function(n,e){var t=null;for(var o in n)"number"==typeof n[o]&&n[o]===e&&(t=o);return t},n.getValues=function(n){var e=[];for(var t in n)"number"!=typeof n[t]&&e.push(parseInt(t,10));return e},n.getValue=function(n,e){var t=null;for(var o in n)"number"!=typeof n[o]&&n[o]===e&&(t=Number(o));return t},n.getValuesAndNames=function(n){var e=[];for(var t in n)"number"!=typeof n[t]&&e.push({value:Number(t),name:n[Number(t)]});return e},n}();n.StaticEnumExtension=t;var e=function(){function n(){}return n.prototype.getNames=function(n){return t.getNames(n)},n.prototype.getName=function(n,e){return t.getName(n,e)},n.prototype.getValues=function(n){return t.getValues(n)},n.prototype.getValue=function(n,e){return t.getValue(n,e)},n.prototype.getValuesAndNames=function(n){return t.getValuesAndNames(n)},n}();n.EnumExtension=e})((e=n.Services||(n.Services={})).Donnees||(e.Donnees={}))}(MyWay||(MyWay={})),function(n){var o;(function(n){var e=function(){function n(){}return n.getTaille=function(n){return o.Controle.StaticAnyControle.isNotUndefinedAndNotNull(n)?JSON.stringify(n).length:0},n}();n.StaticObjectExtension=e;var t=function(){function n(){}return n.prototype.getTaille=function(n){return e.getTaille(n)},n}();n.ObjectExtension=t})((o=n.Services||(n.Services={})).Donnees||(o.Donnees={}))}(MyWay||(MyWay={})),function(n){var o;(function(n){var e=function(){function n(){}return n.getEmptyStringIfNotStringOrGetItSelf=function(n){return o.Controle.StaticStringControle.isStringNotEmpty(n)?n:""},n}();n.StaticStringExtension=e;var t=function(){function n(){}return n.prototype.getEmptyStringIfNotStringOrGetItSelf=function(n){return e.getEmptyStringIfNotStringOrGetItSelf(n)},n}();n.StringExtension=t})((o=n.Services||(n.Services={})).Donnees||(o.Donnees={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-donnees-common.min.js.map
var MyWay;!function(y){var a;(a=y.Services||(y.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-core-agent-addon.min.js.map
var MyWay;!function(p){var e,t;e=p.Test||(p.Test={}),function(l){function d(){return{Core:{createPromiseSelfResolved:p.Services.CoreCommon.createPromiseSelfResolved,createPromiseSelfError:p.Services.CoreCommon.createPromiseSelfError,promesseTryCatch:p.Services.CoreCommon.promesseTryCatch,getPromesseSelfResoved:p.Services.CoreCommon.getPromesseSelfResoved},Context:{}}}l.generateEmptyLibraryAgent=d;var f=function(){function e(){}return e.getInstance=function(){return null===e.INSTANCE&&(e.INSTANCE=new e).init(),e.INSTANCE},e.prototype.init=function(){var r=this;this.componentsByKey={},p.Services.Components.RegistryAgent.getInstance().components.forEach(function(e){var t=new e;r.componentsByKey[t.name.toString()]=e})},e.prototype.getClass=function(e){return this.componentsByKey[e.toString()]},e.INSTANCE=null,e}();l.declareAgentVersExterieurATester=function(g){var e=[];return{execute:function(){describe("Lorsque j'utilise l'agent "+g.classAgentName+" vers l'exterieur",function(){e.forEach(function(e){e()})})},test:function(c){var t="";t="Si j'appelle la méthode "+c.agentMethod+" de l'agent correctement j'ai bien le comportement attendu",c.testMethodSuffix&&(t+=" [cas : "+c.testMethodSuffix+"]"),e.push(function(){var e=it;!0===c.only&&(e=fit),e(t,function(e){var t=l.generateMessageService(),r=d(),n={},a=f.getInstance().getClass(g.component);if(a){expect(!0).toBe(!0,"La class agent du type "+g.component+" est enregistrée auprès du RegistryAgent");var s=new a,o=!1,i=void 0,u=void 0;return l.override(t,"sendWithResponse",function(e,t,r){return o=!0,i=t,u=r,e!==g.component?p.Services.Promesses.createPromiseSelfError(new p.Services.Erreur("L'agent n'envoie pas un message au bon composant. Il est de type "+g.component+" mais il envoie un message au composant "+e)):c.hasResponseMessage?p.Services.Promesses.createPromiseSelfResolved(c.responseMessage):p.Services.Promesses.getPromesseSelfResoved()}),p.Services.CoreCommon.getPromesseSelfResoved().then(function(){if(g.beforeEach){var e={agentLibrary:r,instance:s,isErrorMode:!1};return g.beforeEach(e)}}).then(function(){var e={agentLibrary:r,instance:s,isErrorMode:!1};return c.before?c.before(e):void 0}).then(function(){return s.init(r,t,n)}).then(function(){return c.agentHasMethodParams?s[c.agentMethod].apply(s,c.agentMethodParams):s[c.agentMethod].call(s)}).then(function(e){if(expect(o).toBe(!0,"Le sendMessage doit être appelé"),expect(i).toBe(c.typeMessage,"Le message "+g.enumTypeMessage[c.typeMessage]+" doit être envoyé, et pas "+g.enumTypeMessage[i]),c.hasRequestMessage)switch(c.requestMessageTestMode){case l.TestMode.NoCheck:expect(!0).toBe(!0,"Vérification du message que l'agent a envoyé au manager [test ignoré]");break;case l.TestMode.StrictEquals:expect(u).toBe(c.requestMessage,"Vérification du message que l'agent a envoyé au manager");break;case l.TestMode.DeepEquals:default:expect(u).toEqual(c.requestMessage,"Vérification du message que l'agent a envoyé au manager")}else expect(u).toBe(void 0,"Vérification du message que l'agent a envoyé au manager");if(c.agentHasResult)switch(c.agentResultTestMode){case l.TestMode.NoCheck:expect(!0).toBe(!0,"Vérification du résultat retourné par l'agent [test ignoré]");break;case l.TestMode.StrictEquals:expect(e).toBe(c.agentResult,"Vérification du résultat retourné par l'agent");break;case l.TestMode.ObjectPropertiesEquals:expect(e).toEqual(jasmine.objectContaining(c.agentResult),"Vérification du résultat retourné par l'agent");break;case l.TestMode.ArrayObjectPropertiesEquals:expect(e.length).toEqual(c.agentResult.length,"Vérification du résultat retourné par l'agent - Test du nombre de résutlats dans le tableau de réponse"),e.length===c.agentResult.length&&e.forEach(function(e,t){expect(e).toEqual(jasmine.objectContaining(c.agentResult[t]),"Vérification du résultat retourné par l'agent - Vérification de l'élément "+t)});break;case l.TestMode.DeepEquals:default:expect(e).toEqual(c.agentResult,"Vérification du résultat retourné par l'agent")}else expect(e).toBe(void 0,"Vérification du résultat retourné par l'agent")},function(e){fail("Une erreur s'est produite! Details : "+e.codeLibelle),console.error(e)}).then(function(){if(g.afterEach){var e={agentLibrary:r,instance:s,isErrorMode:!1};return g.afterEach(e)}}).then(function(){var e={agentLibrary:r,instance:s,isErrorMode:!1};return c.after?c.after(e):void 0}).finally(e)}fail("La class agent du type "+g.component+" n'est pas enregistrée auprès du RegistryAgent")})}),e.push(function(){t="Si j'appelle la méthode "+c.agentMethod+" de l'agent de manière incorrecte j'ai bien une erreur qui remonte",c.testMethodSuffix&&(t+=" [cas : "+c.testMethodSuffix+"]"),it(t,function(e){var t=l.generateMessageService(),n=d(),r={},a=f.getInstance().getClass(g.component);if(a){expect(!0).toBe(!0,"La class agent du type "+g.component+" est enregistrée auprès du RegistryAgent");var s=new a,o=!1,i=void 0,u=void 0;l.override(t,"sendWithResponse",function(e,t,r){return o=!0,i=t,u=r,e!==g.component?n.Core.createPromiseSelfError(new p.Services.Erreur("L'agent n'envoie pas un message au bon composant. Il est de type "+g.component+" mais il envoie un message au composant "+e)):p.Services.Promesses.createPromiseSelfError(new p.Services.Erreur("Erreur de test"))}),p.Services.CoreCommon.getPromesseSelfResoved().then(function(){if(g.beforeEach){var e={agentLibrary:n,instance:s,isErrorMode:!0};return g.beforeEach(e)}}).then(function(){var e={agentLibrary:n,instance:s,isErrorMode:!0};return c.before?c.before(e):void 0}).then(function(){return s.init(n,t,r)}).then(function(){return c.agentHasMethodParams?s[c.agentMethod].apply(s,c.agentMethodParams):s[c.agentMethod].call(s)}).then(function(e){fail("Une erreur aurait dû se produire!")},function(e){if(expect(o).toBe(!0,"Le sendMessage doit être appelé"),expect(i).toBe(c.typeMessage,"Le message "+g.enumTypeMessage[c.typeMessage]+" doit être envoyé"),c.hasRequestMessage)switch(c.requestMessageTestMode){case l.TestMode.NoCheck:expect(!0).toBe(!0,"Vérification du message que l'agent a envoyé au manager [test ignoré]");break;case l.TestMode.StrictEquals:expect(u).toBe(c.requestMessage,"Vérification du message que l'agent a envoyé au manager");break;case l.TestMode.DeepEquals:default:expect(u).toEqual(c.requestMessage,"Vérification du message que l'agent a envoyé au manager")}else expect(u).toBe(void 0,"Vérification du message que l'agent a envoyé au manager");expect(e.codeLibelle).toBe(c.agentResultErreur,"Vérification de l'erreur renvoyée par l'agent")}).then(function(){if(g.afterEach){var e={agentLibrary:n,instance:s,isErrorMode:!0};return g.afterEach(e)}}).then(function(){var e={agentLibrary:n,instance:s,isErrorMode:!0};return c.after?c.after(e):void 0}).finally(e)}else fail("La class agent du type "+g.component+" n'est pas enregistrée auprès du RegistryAgent")})})}}}}((t=e.V1||(e.V1={})).Services||(t.Services={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-test-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var n,o,t;n=e.Services||(e.Services={}),o=n.Loggers||(n.Loggers={}),t=function(e){function t(){return e.call(this,n.Components.ComponentType.Loggers)||this}return __extends(t,e),t.prototype.getConfigurationDB=function(e){return this.sendMessage(o.LoggersMessageSubject.GetConfigDB,{nom:e}).then(function(e){return e.config})},t.prototype.setConfigurationDB=function(e,t){return this.sendMessage(o.LoggersMessageSubject.SetConfigDB,{nom:e,config:t})},t.prototype.getConfigurationActual=function(){return this.sendMessage(o.LoggersMessageSubject.GetConfigActual,{}).then(function(e){return e.config})},t.prototype.setConfigurationActual=function(e){return this.sendMessage(o.LoggersMessageSubject.SetConfigActual,{config:e})},t.prototype.loadConfiguration=function(e){return this.sendMessage(o.LoggersMessageSubject.LoadConfig,{nom:e})},t.prototype.saveConfiguration=function(e){return this.sendMessage(o.LoggersMessageSubject.SaveConfig,{nom:e})},t.prototype.getLoggers=function(){return this.sendMessage(o.LoggersMessageSubject.GetLoggers,{}).then(function(e){return e.loggers})},t.prototype.getNomConfigActuelle=function(){return this.sendMessage(o.LoggersMessageSubject.GetNomConfigAcuelle,{}).then(function(e){return e.nom})},t.prototype.isClassExists=function(e){return this.sendMessage(o.LoggersMessageSubject.IsClassExists,{nom:e}).then(function(e){return e.isExists})},t.prototype.reset=function(){return this.sendMessage(o.LoggersMessageSubject.Reset,{})},t}(n.Components.ComponentAgentBase),o.LoggerTechAgent=t,n.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),function(e){!function(s){var r=function(){function r(e,t,n,o){this.$q=e,this.instanceLoaderService=t,this.$timeout=n,this.$rootScope=o}return r.Instance=function(e,t,n,o){return null===r._techAgentExtended&&(r._techAgentExtended=new i(e,t,n,o)),r._techAgentExtended},r.prototype.init=function(e){var t=this,n=this.$q.defer();return r.Instance(this.$q,this.instanceLoaderService,this.$timeout,this.$rootScope).init(e).then(function(){n.resolve(r.Instance(t.$q,t.instanceLoaderService,t.$timeout,t.$rootScope))},function(){n.reject()}),n.promise},r.$inject=["$q","instanceLoaderService","$timeout","$rootScope"],r._techAgentExtended=null,r}();s.TechAgentProvider=r;var c=function(){function r(){}return r.addInitListener=function(e){r.onInitListener.push(e)},r.removeInitListener=function(t){s.CoreCommon.ArrayUtils.remove(r.onInitListener,function(e){return e===t})},r.prototype.init=function(t,e){var n=this,o=s.CoreCommon.ServiceDePromesse.defer();return this._errorCallback=o.reject,this.LoggerTechAgent=t.Loggers,r.onInitListener.forEach(function(e){e(n,t)}),o.resolve(),o.promise},r.onInitListener=[],r}();s.TechLibrary=c;var e=function(o){function e(){var e=o.call(this)||this;return e._techLibrary=new c,e}return __extends(e,o),e.prototype.init=function(e){var t=this,n=s.CoreCommon.ServiceDePromesse.defer();return o.prototype.init.call(this,e).then(function(){return t._techLibrary.init(t.Library,e)}).then(function(){n.resolve()}).catch(n.reject),n.promise},Object.defineProperty(e.prototype,"LoggerTechAgent",{get:function(){return this._techLibrary.LoggerTechAgent},enumerable:!0,configurable:!0}),e.prototype.SendRequest=function(e){return o.prototype.SendRequest.call(this,e)},e}(s.ServiceAgent);s.TechAgent=e;var i=function(i){function e(e,t,n,o){var r=i.call(this,e,t,n,o)||this;return r._techLibrary=new c,r}return __extends(e,i),e.prototype.init=function(e){var t=this,n=s.CoreCommon.ServiceDePromesse.defer();return i.prototype.init.call(this,e).then(function(){return t._techLibrary.init(t.Library,e)}).then(function(){n.resolve()}).catch(n.reject),n.promise},Object.defineProperty(e.prototype,"LoggerTechAgent",{get:function(){return this._techLibrary.LoggerTechAgent},enumerable:!0,configurable:!0}),e.prototype.SendRequest=function(e){return i.prototype.SendRequest.call(this,e)},e.$inject=["$q","instanceLoaderService","$timeout","$rootScope"],e}(s.ServiceAgentExtended);s.TechAgentExtended=i,"undefined"!=typeof angular&&(s.moduleAgent.provider("techAgentExtended",function(){this.$get=["$q","instanceLoaderService","$timeout","$rootScope",function(e,t,n,o){return r.Instance(e,t,n,o)}]}),s.moduleAgent.provider("techAgent",function(){this.$get=["$q","instanceLoaderService","$timeout","$rootScope",function(e,t,n,o){return r.Instance(e,t,n,o)}]}),s.moduleAgent.provider("serviceAgent",function(){this.$get=["$q","instanceLoaderService","$timeout","$rootScope",function(e,t,n,o){return r.Instance(e,t,n,o)}]}),s.moduleAgent.provider("serviceAgentExtended",function(){this.$get=["$q","instanceLoaderService","$timeout","$rootScope",function(e,t,n,o){return r.Instance(e,t,n,o)}]}))}(e.Services||(e.Services={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-core-tech-agent.min.js.map
var MyWay;!function(e){var r,o;r=e.Test||(e.Test={}),((o=r.V1||(r.V1={})).Services||(o.Services={})).generateEmptyLibraryManagerForApi=function(){var r=0;return{Core:{createPromiseSelfResolved:e.Services.CoreCommon.createPromiseSelfResolved,createPromiseSelfError:e.Services.CoreCommon.createPromiseSelfError,promesseTryCatch:e.Services.CoreCommon.promesseTryCatch,getPromesseSelfResoved:e.Services.CoreCommon.getPromesseSelfResoved,creerChaineAleatoire:function(e){return"abcde"+ ++r}},Context:{},ContexteClient:{},Display:{},Lisa:{},Evennements:{},Libelle:{}}}}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-test-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}r(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={})),function(e){var s,n,t;s=e.Services||(e.Services={}),n=s.Components||(s.Components={}),t=function(t){function e(e){var n=t.call(this,e)||this;return n.listenersEvennement=[],n}return __extends(e,t),e.prototype.init=function(e,n,t,r){return this.library=e,this.messageService=n,this.managerInitializer=t,s.CoreCommon.getPromesseSelfResoved()},e.prototype.SendEvent=function(e){this.library&&this.library.Evennements&&(e.ComponentName=this.name,this.library.Evennements.notifier(e))},e.prototype.sendMessage=function(e,n){return this.messageService.sendWithResponse(this.name,e,n)},e.prototype.sendMessageWithFrame=function(e,n,t){var r=s.CoreCommon.ServiceDePromesse.defer();if(this.messageService){var o,i;if(t.SimulateAppIFrame)o=window,i=window.location.protocol+"//"+window.location.host;else{if(!t||!t.IsMyWayUrl||t.IsProducteur)return r.resolve(null),r.promise;o=t.GetWindow(),i=t.FrameUrl}i?this.messageService.sendWithResponse(this.name,e,n,o,i,t.FrameId).then(r.resolve,r.reject):r.resolve(null)}else r.resolve(null);return r.promise},e.prototype.dispose=function(){var n=this;return this.library.Core.promesseTryCatch(function(e){n.listenersEvennement.forEach(function(e){n.library.Evennements.retirerListener(e)}),e.resolve()})},e.prototype.ajouterListenerEvent=function(e,n){this.listenersEvennement.push(n),this.library.Evennements.ajouterListener(n,e)},e}(n.ComponentBase),n.ComponentManagerBase=t}(MyWay||(MyWay={})),function(e){var n;(n=e.Services||(e.Services={})).Components||(n.Components={})}(MyWay||(MyWay={})),function(e){var o;(function(n){"use strict";var r;r=n.RegistryType||(n.RegistryType={});var e=function(t){function e(){var e=t.call(this,r.MANAGER,[r.COMMON,r.API])||this;return e._managerInitializer=null,e.messageService=null,e}return __extends(e,t),e.getInstance=function(){return null===e.instance&&(e.instance=new e,n.FactoryRegistries.getInstance().addRegistry(e.instance)),e.instance},Object.defineProperty(e.prototype,"managerInitializer",{set:function(e){this._managerInitializer=e},enumerable:!0,configurable:!0}),e.prototype.init=function(e){var n=this;return this.getRegistryCommon().getComponentsInstances().forEach(function(e){n._componentsInstancesByKey[e.name]||(n._componentsInstances.push(e),n._componentsInstancesByKey[e.name]=e)}),this.messageService||(this.messageService=o.Message.MessageManagerFactory.createMessageManager(this.getLibrary())),t.prototype.init.call(this,e)},e.prototype.getRegistryCommon=function(){return this._dependenciesInstances[0]},e.prototype.getRegistryApi=function(){return this._dependenciesInstances[1]},e.prototype.initializeComponent=function(e){return e.init(this._componentsInstancesByKey,this.messageService,this._managerInitializer,this.getRegistryApi().getComponentInstance(e.name))},e.instance=null,e}(n.AbstractRegistry);n.RegistryManager=e})((o=e.Services||(e.Services={})).Components||(o.Components={}))}(MyWay||(MyWay={})),function(e){var i,n;i=e.Services||(e.Services={}),n=function(o){function t(){var e=o.call(this,i.Components.ComponentType.Evennements)||this;return e.listenersParEvenement={},e.typesEvenements=null,e}return __extends(t,o),t.prototype.init=function(e,n,t,r){return this.typesEvenements=i.CoreCommon.EnumUtils.getValues(i.Component.ManagerEventType),o.prototype.init.call(this,e,n,t,r)},t.prototype.SendEvent=function(e){return o.prototype.SendEvent.call(this,e)},t.prototype.ajouterListener=function(n){for(var t=this,e=[],r=1;r<arguments.length;r++)e[r-1]=arguments[r];n&&(0===e.length&&(e=this.typesEvenements),e.forEach(function(e){t.listenersParEvenement[e]||(t.listenersParEvenement[e]=[]),t.listenersParEvenement[e].push(n)}))},t.prototype.retirerListener=function(n){for(var e in this.listenersParEvenement){var t=this.listenersParEvenement[e],r=[];t.forEach(function(e){e!==n&&r.push(e)}),this.listenersParEvenement[e]=r}},t.prototype.notifier=function(n){n&&n.EventType&&this.listenersParEvenement[n.EventType]&&this.listenersParEvenement[n.EventType].forEach(function(e){try{e(n)}catch(e){t.logger.error("Erreur lors de la remise d'un evennement : %1",JSON.pruned(n))}})},t.CLASS_NAME="MyWay.Services.Evennements",t.logger=i.Loggers.LoggerFactory.INSTANCE.getClass(t.CLASS_NAME),t}(i.Components.ComponentManagerBase),i.Evennements=n,i.Components.RegistryManager.getInstance().register(n)}(MyWay||(MyWay={})),function(e){var n,t;n=e.Services||(e.Services={}),t=function(){function t(e){this.$q=e}return t.Instance=function(){return null===t._phantomAgent&&(t._phantomAgent=new n.PhantomAgent),t._phantomAgent},t.prototype.init=function(e){var n=this.$q.defer();return n.resolve(t.Instance()),n.promise},t.$inject=["$q"],t._phantomAgent=null,t}(),n.PhantomAgentProvider=t,"undefined"!=typeof angular&&(n.moduleManager=angular.module("moduleManager",["ng"]),n.moduleManager.provider("serviceAgent",function(){this.$get=["$q",function(e){return t.Instance()}]}))}(MyWay||(MyWay={})),function(e){var o,n;o=e.Services||(e.Services={}),n=function(){function r(){this._serviceManager=o.ServiceManager.Instance()}return Object.defineProperty(r.prototype,"Core",{get:function(){return this._serviceManager.Library.Core},enumerable:!0,configurable:!0}),r.addListenerOnInit=function(e){r.onInitListeners.push(e)},r.removeListenerOnInit=function(n){o.CoreCommon.ArrayUtils.remove(r.onInitListeners,function(e){return n===e})},r.prototype.SendRequest=function(t){return o.CoreCommon.promesseTryCatch(function(n){var e=t;e.logger=r.logger,o.CoreCommon.SendRequest(e,function(e){n.resolve(e)},function(e){n.reject(e)})})},r.prototype.init=function(e){var n=this;return o.Promesses.getPromesseSelfResoved().then(function(){r.onInitListeners.forEach(function(e){e(n,n._serviceManager)})})},r.prototype.DisplayMessage=function(e){},r.prototype.SubscribeToNotification=function(e){},r.prototype.Dispose=function(){},r.prototype.OnNotification=function(e,n){},r.CLASS_NAME="MyWay.Services.PhantomAgent",r.logger=o.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME),r.onInitListeners=[],r}(),o.PhantomAgent=n}(MyWay||(MyWay={})),function(r){!function(c){var e;(e=c.ModeVerificationProcessus||(c.ModeVerificationProcessus={}))[e.Aucun=0]="Aucun",e[e.Warning=1]="Warning",e[e.Erreur=2]="Erreur";var n=function(){function a(){this.listenerEventFromPortail=null,a.logger.info("ServiceManager constructor begin"),a._instance=this}return a.Instance=function(){return a._instance},Object.defineProperty(a.prototype,"Library",{get:function(){return this.library},enumerable:!0,configurable:!0}),a.prototype.init=function(e){var n=this;a.logger.info("ServiceManager constructor init begin",Date.now(),!0),c.CoreCommon.VersionMySys=versionMySys;try{var t=c.Components.RegistryManager.getInstance();return t.managerInitializer={delegationPortail:e.delegationPortail,IFrameId:e.IFrameId,isTotemCapable:e.isTotemCapable,LogOnUrl:e.LogOnUrl,ModeVerificationProcessus:e.ModeVerificationProcessus,PortalType:e.PortalType},c.Components.RegistryApi.getInstance().setApiInitializer({privatePortalServiceParameters:c.PrivatePortalServiceParameters.Instance(),portalServiceParameters:c.PortalServiceParameters.Instance()}),c.Components.FactoryRegistries.getInstance().init().then(function(){n.library=t.getLibrary(),n.OnEvent=e.OnEvent,a.logger.info("ServiceManager StartManagers end",Date.now(),!1)})}catch(e){return a.logger.error("Erreur POESI1614 : "+e),r.Services.Promesses.createPromiseSelfError(new c.Erreur(e.message))}},Object.defineProperty(a.prototype,"OnEvent",{set:function(e){this.listenerEventFromPortail&&this.library.Evennements.retirerListener(this.listenerEventFromPortail),this.listenerEventFromPortail=e,this.library.Evennements.ajouterListener(e)},enumerable:!0,configurable:!0}),a.staticInit=function(){"undefined"!=typeof $&&$.ajaxSetup?$.ajaxSetup({cache:!1}):console.info("[Framework Technique MyWay - CoreCommon - init] JQuery n'est pas disponible"),window.onerror=function(e,n,t,r,o){if(-1<e.toString().toLowerCase().indexOf("script error"))a.logger.error("Script Error: See Browser Console for Detail");else{var i=["Message: "+e,"URL: "+n,"Line: "+t,"Column: "+r,"Error object: "+JSON.stringify(o)].join(" - ");a.logger.error(i)}return!1}},a.prototype.Dispose=function(){var n=this;return c.CoreCommon.promesseTryCatch(function(e){return n.listenerEventFromPortail&&n.library.Evennements.retirerListener(n.listenerEventFromPortail),c.Components.FactoryRegistries.getInstance().dispose().then(function(){})})},a.addActionOnInitialize=function(e,n){for(var t=[],r=2;r<arguments.length;r++)t[r-2]=arguments[r];a.actionsOnInitialize.push({name:e,callback:n,actionsRequises:t||[]})},a.prototype.Initialize=function(){var e=this,o={},i={},s=[];return a.actionsOnInitialize.forEach(function(e){o[e.name]=c.CoreCommon.ServiceDePromesse.defer()}),a.actionsOnInitialize.forEach(function(t){a.logger.debug("Prépare l'action %1",t.name);var r=[];t.actionsRequises.forEach(function(e){a.logger.debug("Ajoute comme condition %1",e);var n=o[e];if(!n)throw new c.Erreur("L'action "+e+", requise pour l'action "+t.name+" n'a jamais été définie!");r.push(n.promise)});var n=o[t.name];i[t.name]=n.promise,c.CoreCommon.executePromisesSimultaneousAndWaitAllResolves(r).then(function(){a.logger.debug("Initialize - Lancement de l'action %1",t.name),t.callback(e.library).then(function(){n.resolve()},function(e){a.logger.debug("Action "+t.name+" en erreur ",e),n.reject(e)}).finally(function(){a.logger.debug("Initialize - Fin de l'action %1",t.name)})},n.reject),s.push(n.promise)}),c.CoreCommon.executePromisesSimultaneousAndWaitAllResolves(s).then(function(){},function(e){})},a.CLASS_NAME="MyWay.Services.ServiceManager",a.logger=c.Loggers.LoggerFactory.INSTANCE.getClass(a.CLASS_NAME),a.actionsOnInitialize=[],a}();(c.ServiceManager=n).staticInit()}(r.Services||(r.Services={}))}(MyWay||(MyWay={})),function(e){var n,t,r,o;n=e.Services||(e.Services={}),t=n.Component||(n.Component={}),o=function(){function e(e,n){this.EventType=e,this.Detail=n}return e.prototype.onSend=function(e){return!0},e}(),t.ManagerEvent=o,(r=t.ManagerEventType||(t.ManagerEventType={}))[r.PortalContextChanged=1]="PortalContextChanged",r[r.FinDeTransition=2]="FinDeTransition",r[r.FinDeProcessus=3]="FinDeProcessus",r[r.NouvelleEtape=4]="NouvelleEtape",r[r.NouveauProcess=5]="NouveauProcess",r[r.NouveauSousProcess=6]="NouveauSousProcess",r[r.NouvelleAppliExterne=7]="NouvelleAppliExterne",r[r.BasculeProcess=8]="BasculeProcess",r[r.ChangementNomProcess=9]="ChangementNomProcess",r[r.DemandeDeDemarrageDeProcessus=10]="DemandeDeDemarrageDeProcessus",r[r.AcceptPhase=11]="AcceptPhase",r[r.ConnectionSignalR=12]="ConnectionSignalR",r[r.AfficherLogOn=13]="AfficherLogOn",r[r.MasquerLogOn=14]="MasquerLogOn",r[r.Extraction=15]="Extraction",r[r.Diagnostic=16]="Diagnostic",r[r.MiseAJourContexteClient=17]="MiseAJourContexteClient",r[r.Log=18]="Log",r[r.ChangementAuthentificationInfo=19]="ChangementAuthentificationInfo",r[r.BriqueCommunication=20]="BriqueCommunication",r[r.ContextRecharge=21]="ContextRecharge",r[r.ResetHabilitations=22]="ResetHabilitations",r[r.Communication=23]="Communication"}(MyWay||(MyWay={})),function(e){var n,s,t;n=e.Services||(e.Services={}),s=n.Loggers||(n.Loggers={}),t=function(i){function e(){return i.call(this,n.Components.ComponentType.Loggers)||this}return __extends(e,i),e.prototype.init=function(e,n,t,r){var o=this;return i.prototype.init.call(this,e,n,t,r).then(function(){o.loggerFactory=s.LoggerFactory.INSTANCE})},e.prototype.getClassByName=function(e){var n=window;return e.split(".").forEach(function(e){n=n[e]}),n},e.prototype.getConfigurationActual=function(){return this.loggerFactory.getConfigurationActual()},e.prototype.setConfigActual=function(e){this.loggerFactory.setConfigActual(e)},e.prototype.getConfigurationDB=function(e){var n=this.loggerFactory.getConfigurationDB(e);if(!n)switch(e){case s.LoggerFactory.LOGGER_PORTAIL:n=s.DEFAULT_CONFIGURATION_PORTAIL}return n},e.prototype.setConfigDB=function(e,n){return this.loggerFactory.setConfigDB(e,n)},e.prototype.saveConfiguration=function(e){return this.loggerFactory.saveConfiguration(e)},e.prototype.loadConfiguration=function(e){return this.loggerFactory.loadConfiguration(e)},e.prototype.getAllLogggersNames=function(){return this.loggerFactory.getAllLogggersNames()},e.prototype.getNomConfigActuelle=function(){return this.loggerFactory.getNomConfigActuelle()},e.prototype.clearConfigurations=function(){return this.loggerFactory.clearConfigurations()},e}(n.Components.ComponentManagerBase),s.LoggerManager=t,n.Components.RegistryManager.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var n,t;n=e.Services||(e.Services={}),(t=n.Loggers||(n.Loggers={})).DEFAULT_CONFIGURATION_PORTAIL={appenders:[{type:"CONSOLE",level:t.LEVEL.DEBUG,class:"MyWay.Services.Loggers.Appenders.ConsoleAppender",config:{format:"%d{HH:mm:ss,SSS} %class %X{action} : %msg, Details : %X{details}"}},{type:"DB",level:t.LEVEL.DEBUG,class:"MyWay.Services.Loggers.Appenders.DBAppender",config:{}},{type:"PORTAL",level:t.LEVEL.DEBUG,class:"MyWay.Services.Loggers.Appenders.PortalAppender",config:{format:"%d{HH:mm:ss,SSS} %class %X{action} : %msg, Details : %X{details}"}}],loggers:[{name:"MyWay.Services",level:t.LEVEL.INFO,appenders:["CONSOLE","PORTAL"]},{name:"MyWay.Services",level:t.LEVEL.INFO,appenders:["DB"]},{name:"*",level:t.LEVEL.INFO,appenders:["CONSOLE","DB"]}]},t.LoggerFactory.INSTANCE.loadConfiguration()}(MyWay||(MyWay={})),function(o){var s;(function(i){var e=function(r){function e(e,n,t){return r.call(this,n,t,s.PrivatePortalServiceParameters.Instance().AuthorizedDomains,"Agent","Manager",e,!0,!1)||this}return __extends(e,r),e}(i.MessageBase),n=function(t){function e(e){var n=t.call(this,e,null,null)||this;return window.addEventListener("message",n._ReceiveMessage),n}return __extends(e,t),e.prototype.dispose=function(){window.removeEventListener("message",this._ReceiveMessage)},e.prototype.postMessage=function(e,n,t,r){n.postMessage(e,t)},e}(i.MessageManagerBase=e);i.MessageManager=n;var t=function(n){function e(e){return n.call(this,e,null,null)||this}return __extends(e,n),e.prototype.dispose=function(){},e.prototype.postMessage=function(e,n,t,r){var o={};o.data=e,o.origin=t,o.source=n,i.MobileMessageAgent&&i.MobileMessageAgent.Instance&&i.MobileMessageAgent.Instance._ReceiveMessage(o)},e}(e);i.MobileMessageManager=t;var r=function(){function e(){}return e.createMessageManager=function(e){return o.Services.isMobile?new t(e):new n(e)},e}();i.MessageManagerFactory=r})((s=o.Services||(o.Services={})).Message||(s.Message={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-core-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,n;t=e.Services||(e.Services={}),((n=t.Components||(t.Components={})).ComponentType||(n.ComponentType={})).Context="Context"}(MyWay||(MyWay={})),function(e){var t,n,o;t=e.Services||(e.Services={}),n=t.Context||(t.Context={}),(o=n.ContextMessageSubject||(n.ContextMessageSubject={}))[o.AddToContext=0]="AddToContext",o[o.AddToContextTech=1]="AddToContextTech",o[o.ClearContext=2]="ClearContext",o[o.AddToSharedContext=3]="AddToSharedContext",o[o.RemoveFromSharedContext=4]="RemoveFromSharedContext",o[o.AddToProcessStepContext=5]="AddToProcessStepContext",o[o.AddToGlobalContext=6]="AddToGlobalContext",o[o.AddToTempoContext=7]="AddToTempoContext",o[o.AddListToContext=8]="AddListToContext",o[o.AddToMainProcessContext=9]="AddToMainProcessContext",o[o.GetFromMainProcessContext=10]="GetFromMainProcessContext",o[o.ChangeMainProcessName=11]="ChangeMainProcessName",o[o.GetFromContext=12]="GetFromContext",o[o.GetObjectFromContext=13]="GetObjectFromContext",o[o.GetTypedObjectFromContext=14]="GetTypedObjectFromContext",o[o.ReinitialisationServiceAgent=15]="ReinitialisationServiceAgent",o[o.GetCurrentStepInfo=16]="GetCurrentStepInfo",o[o.GetSharedStorage=17]="GetSharedStorage",o[o.GetWaitingProcesses=18]="GetWaitingProcesses",o[o.GetPortals=19]="GetPortals",o[o.GetGlobalStorage=20]="GetGlobalStorage",o[o.SetMyWayCompatible=21]="SetMyWayCompatible",o[o.GetListFromContext=22]="GetListFromContext",o[o.GetAuthentificationInfo=23]="GetAuthentificationInfo",o[o.GetParametresComptables=24]="GetParametresComptables",o[o.PutProcessInPortalContext=25]="PutProcessInPortalContext",o[o.PutTaskInPortalContext=26]="PutTaskInPortalContext",o[o.GetCurrentProcessId=27]="GetCurrentProcessId",o[o.GetCurrentMainProcess=28]="GetCurrentMainProcess",o[o.GetCurrentStepId=29]="GetCurrentStepId",o[o.Notification=30]="Notification",o[o.AnalyseApp=31]="AnalyseApp",o[o.RemoveFromContext=32]="RemoveFromContext",o[o.RemoveFromSharedContextContext=33]="RemoveFromSharedContextContext",o[o.GetPortalContext=34]="GetPortalContext",o[o.SwitchProcess=35]="SwitchProcess",o[o.EndProcess=36]="EndProcess",o[o.EndAllProcess=37]="EndAllProcess",o[o.Inconnu=38]="Inconnu",o[o.GetFromSharedContext=39]="GetFromSharedContext",t.Components.FactoryRegistries.getInstance().declareComponent(t.Components.ComponentType.Context,[t.Components.ComponentType.Persistence])}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Context||(t.Context={}),t.CoreCommon.addListenerOnAddMyWayHeaders(function(e,t){t.stepInfo?(e["X-identifiantProcessus"]=t.stepInfo.CurrentParentProcessId,e["X-nomComposant"]=t.stepInfo.NomComposant,e["X-niveauTrace"]=t.stepInfo.NiveauTrace.toString()):(e["X-identifiantProcessus"]="",e["X-nomComposant"]="",e["X-niveauTrace"]=""),t.authentificationInfo&&(e["X-codeEtablissement"]=t.authentificationInfo.codeEtablissement,e["X-identifiantPoste"]=t.authentificationInfo.numeroStationTravail,e["X-identifiantConnexionAgent"]=t.authentificationInfo.agentConnecte.referenceExterneAgent,e["X-identifiantNationalAgent"]||(e["X-identifiantNationalAgent"]=""),t.oldHeader&&(e.authentificationInfo=JSON.stringify(t.authentificationInfo)),t.authentificationInfo.agentConnecte.referenceExterneEdsRattachemen?e["X-agenceRattachement"]=t.authentificationInfo.agentConnecte.referenceExterneEdsRattachemen:e["X-agenceRattachement"]="0000000",t.authentificationInfo.agentConnecte.numeroInterneEds?e["X-posteFonctionnelAgent"]=t.authentificationInfo.agentConnecte.numeroInterneEds:e["X-posteFonctionnelAgent"]="0000000"),t.parametresComptables&&(e["X-identifiantGuichetOperation"]=t.parametresComptables.edsInterneGuichetComptable)})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t;(function(e){var t,n,o;(t=e.StorageLevel||(e.StorageLevel={}))[t.Global=0]="Global",t[t.Process=1]="Process",t[t.Step=2]="Step",t[t.Shared=3]="Shared",t[t.Tempo=4]="Tempo",t[t.MainProcess=5]="MainProcess",(n=e.PATH_PART||(e.PATH_PART={}))[n.MAIN_PROCESS_ID=0]="MAIN_PROCESS_ID",n[n.LAST_PROCESS_ID=1]="LAST_PROCESS_ID",n[n.PREVIOUS_PROCESS_ID=2]="PREVIOUS_PROCESS_ID",n[n.STEP_ID=3]="STEP_ID",(o=e.EtatEtape||(e.EtatEtape={}))[o.NONE=0]="NONE",o[o.STARTED=1]="STARTED",o[o.RESET=2]="RESET";var a=function(){};e.IStepAction=a;var r=function(){};e.IStepContrat=r;var i=function(){function e(){this.TotalWatchers=0,this.TotalWatchers2=0,this.TotalWatchers3=0,this.WatcherByScope=[]}return e.prototype.ToString=function(){return JSON.stringify(this)},e}();e.AnalyseResult=i;var s=function(e,t){this.Name=e,this.WatcherCount=t};e.AnalyseScope=s})((t=e.Services||(e.Services={})).Context||(t.Context={}))}(MyWay||(MyWay={})),function(e){var t;(function(e){var t=function(){this.Contrats=[],this.AuthorizedOutputs=[]},n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(e.StepInfo=t);e.StepInfoExtended=n;var o=function(){};e.ContratInfo=o;var a=function(){};e.DonneesLocales=a;var r=function(){this.agentConnecte=new C,this.guichetAgent=new p};e.AuthentificationInfo=r;var i=function(){};e.ParametresComptables=i;var s=function(){};e.ParametresNumerisation=s;var c=function(){};e.ParametresServeurPoste=c;var C=function(){};e.AgentConnecte=C;var p=function(){};e.GuichetAgent=p;var u=function(){};e.InfosUserPoste=u})((t=e.Services||(e.Services={})).Context||(t.Context={}))}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),((n=t.Components||(t.Components={})).ComponentType||(n.ComponentType={})).Display="Display"}(MyWay||(MyWay={})),function(e){var t,n,o;t=e.Services||(e.Services={}),n=t.Display||(t.Display={}),(o=n.DisplayMessageSubject||(n.DisplayMessageSubject={}))[o.Redirect=0]="Redirect",o[o.RedirectInStep=1]="RedirectInStep",o[o.PrepareSubmit=2]="PrepareSubmit",o[o.DisplayMessage=3]="DisplayMessage",o[o.GetMyIFrameId=4]="GetMyIFrameId",o[o.Refresh=5]="Refresh",t.Components.FactoryRegistries.getInstance().declareComponent(t.Components.ComponentType.Display,[t.Components.ComponentType.Context,t.Components.ComponentType.Core])}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-context-display-common.min.js.map
var MyWay;!function(y){var a;(a=y.Services||(y.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-performance-business-object.min.js.map
var MyWay;!function(i){var a,c;a=i.Services||(i.Services={}),c=function(){},(a.Application||(a.Application={})).ApplicationDTO=c}(MyWay||(MyWay={})),function(i){var a;(a=i.Services||(i.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-application-business-object.min.js.map
var MyWay;!function(e){var t,n,A;t=e.Services||(e.Services={}),n=t.ContexteClient||(t.ContexteClient={}),A=function(){function e(){}return e.RELOAD_FLAG_NAME="indicateurSynchroSynthese",e.RELOAD_FLAG_VALUE_NONE="0",e.RELOAD_FLAG_VALUE_SYNCHRO="1",e.RELOAD_FLAG_VALUE_RELOAD="2",e}(),n.ContexteClientStatusFlag=A}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-contexte-client-business-object.min.js.map
var MyWay;!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t,a,n;t=e.Services||(e.Services={}),a=t.Persistence||(t.Persistence={}),n=function(){function e(e,t,a,n){this.callbackToDisposeListener=null,this.callbackToSave=null,this.callbackOnEvent=null,this.keyStorage=e,this.callbackToDisposeListener=t,this.callbackToSave=a,this.callbackOnEvent=n}return e.prototype.saveValue=function(e){this.callbackToSave(e)},e.prototype.getValue=function(){var e=window.localStorage.getItem(this.keyStorage);if(!e||0===e.length)return null;var t=JSON.parse(e);return t&&t.data?t.data:null},e.prototype.onEvent=function(e){this.callbackOnEvent(e)},e.prototype.disposeListener=function(){this.callbackToDisposeListener()},e}(),a.StorageInstance=n}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-persistence-business-object.min.js.map
var MyWay;!function(y){var a;(a=y.Services||(y.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-donnees-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var n,r,e;n=t.Services||(t.Services={}),r=n.JAB||(n.JAB={}),e=function(t){function e(){return t.call(this,n.Components.ComponentType.JAB)||this}return __extends(e,t),e.prototype.Enregistrer=function(t){return this.sendMessage(r.JABMessageSubject.Enregistrer,{data:t})},e}(n.Components.ComponentAgentBase),r.JABAgent=e,n.Components.RegistryAgent.getInstance().register(e)}(MyWay||(MyWay={})),function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-jab-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var n,i,t;n=e.Services||(e.Services={}),i=n.Fichier||(n.Fichier={}),t=function(e){function t(){return e.call(this,n.Components.ComponentType.Fichier)||this}return __extends(t,e),t.prototype.saveAs=function(e,t,n,r){var o={data:e,type:t,nomFichier:n,typeDonnees:r};return this.sendMessage(i.FichierMessageSubject.SaveAs,o)},t}(n.Components.ComponentAgentBase),i.FichierAgent=t,n.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-fichier-agent.min.js.map
var MyWay;!function(y){var a;(a=y.Services||(y.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={})),function(y){var a;(a=y.Services||(y.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-dates-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var t in s)s.hasOwnProperty(t)&&(e[t]=s[t])};return function(e,s){function t(){this.constructor=e}n(e,s),e.prototype=null===s?Object.create(s):(t.prototype=s.prototype,new t)}}();!function(e){var t,n,s;t=e.Services||(e.Services={}),n=t.BaseDeDonnees||(t.BaseDeDonnees={}),s=function(e){function s(){return e.call(this,t.Components.ComponentType.BaseDeDonnees)||this}return __extends(s,e),s.prototype.getBases=function(){return this.sendMessage(n.Messages.BaseDeDonneesMessageSubject.GetBases,{})},s.prototype.get=function(e){return this.sendMessage(n.Messages.BaseDeDonneesMessageSubject.Get,{base:e.base,cle:e.cle,table:e.table})},s.prototype.getAll=function(e){return this.sendMessage(n.Messages.BaseDeDonneesMessageSubject.GetAll,{base:e.base,table:e.table})},s.prototype.find=function(e){return this.sendMessage(n.Messages.BaseDeDonneesMessageSubject.Find,{table:e.table})},s.prototype.count=function(e){return this.sendMessage(n.Messages.BaseDeDonneesMessageSubject.Count,{base:e.base,table:e.table})},s.prototype.ajouter=function(e){return this.sendMessage(n.Messages.BaseDeDonneesMessageSubject.Ajouter,{base:e.base,elements:[e.element],table:e.table})},s.prototype.supprimer=function(e){return this.sendMessage(n.Messages.BaseDeDonneesMessageSubject.Supprimer,{base:e.base,cles:[e.cle],table:e.table})},s.prototype.modifier=function(e){return this.sendMessage(n.Messages.BaseDeDonneesMessageSubject.MettreAJour,{base:e.base,elements:[{cle:e.cle,element:e.element}],table:e.table})},s.prototype.resetAll=function(){return this.sendMessage(n.Messages.BaseDeDonneesMessageSubject.ResetAll,{})},s}(t.Components.ComponentAgentBase),n.BaseDeDonneesAgent=s,t.Components.RegistryAgent.getInstance().register(s)}(MyWay||(MyWay={})),function(e){var s;(s=e.Services||(e.Services={})).Bug||(s.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-database-agent.min.js.map
var MyWay;!function(y){var a;(a=y.Services||(y.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-test-agent-addon.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var n,r,e;n=t.Services||(t.Services={}),r=n.TraitementNsdk||(n.TraitementNsdk={}),e=function(t){function e(){return t.call(this,n.Components.ComponentType.TraitementNsdk)||this}return __extends(e,t),e.prototype.Lancer=function(t,e){return this.sendMessage(r.TraitementNsdkMessageSubject.Lancer,{traitement:t,data:e})},e}(n.Components.ComponentAgentBase),r.TraitementNsdkAgent=e,n.Components.RegistryAgent.getInstance().register(e)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-traitement-nsdk-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(t,e){function o(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();!function(t){var o,n,e;o=t.Services||(t.Services={}),n=o.Export||(o.Export={}),e=function(t){function e(){return t.call(this,o.Components.ComponentType.Export)||this}return __extends(e,t),e.prototype.exporterFichier=function(t,e,o){var r={donnees:t,format:e,options:o};return this.sendMessage(n.ExportMessageSubject.ExporterFichier,r)},e.CLASS_NAME="MyWay.Services.Export.ExportAgent",e.logger=o.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(o.Components.ComponentAgentBase),n.ExportAgent=e,o.Components.RegistryAgent.getInstance().register(e)}(MyWay||(MyWay={})),function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-export-agent.min.js.map
var MyWay;!function(y){var a;(a=y.Services||(y.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-test-tech-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var n,t,r;n=e.Services||(e.Services={}),t=n.TraitementNsdk||(n.TraitementNsdk={}),r=function(e){function t(){return e.call(this,n.Components.ComponentType.TraitementNsdk)||this}return __extends(t,e),t.prototype.lancer=function(e,t){return this.libraryManager.Core.sendRequest({url:n.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/contexte/LancerTraitementNSDK?data="+t+"&traitement="+e,cache:!1,async:!1,method:n.MethodEnum.GET})},t}(n.Components.ComponentApiBase),t.TraitementNsdkApi=r,n.Components.RegistryApi.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-traitement-nsdk-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var e,n,r;e=t.Services||(t.Services={}),n=e.JAB||(e.JAB={}),r=function(o){function t(){return o.call(this,e.Components.ComponentType.JAB)||this}return __extends(t,o),t.prototype.init=function(t,e,n){var r=this;return o.prototype.init.call(this,t,e,n).then(function(){r._jabUrl=r.privatePortalServiceParameters.LocalServiceUrl+"/contexte/EnregistrerJournalBancaireNSDK"})},t.prototype.enregistrer=function(t){return this.libraryManager.Core.sendRequest({url:this._jabUrl+"?data="+t,method:e.MethodEnum.POST})},t}(e.Components.ComponentApiBase),n.JABApi=r,e.Components.RegistryApi.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-jab-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t,r,i;t=e.Services||(e.Services={}),r=t.Fichier||(t.Fichier={}),i=function(){function e(){this.currentFileName="telechargement",this.currentMimeType="application/octet-stream",this._responseData={},this._strFileName="",this._strMimeType="",this.toString=function(e){return String(e)}}return Object.defineProperty(e.prototype,"responseData",{get:function(){return this._responseData},set:function(e){this._responseData=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strFileName",{get:function(){return this._strFileName},set:function(e){this._strFileName=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"strMimeType",{get:function(){return this._strMimeType},set:function(e){this._strMimeType=e},enumerable:!0,configurable:!0}),e.prototype.initSaveFile=function(){var t=this;if(this.self=window,this.currentBlob=this.self.Blob||this.self.MozBlob||this.self.WebKitBlob||this.toString,this.currentBlob=this.currentBlob.call?this.currentBlob.bind(this.self):Blob,this.anchor=document.createElement("a"),0<this.strMimeType.length&&(this.currentMimeType=this.strMimeType),0<this.strFileName.length&&(this.currentFileName=this.strFileName),this.isSafari()&&this.checkSafariVersion())this.saveSafariFile();else{if(/^this.responseData\:[\w+\-]+\/[\w+\-]+[,;]/.test(this.responseData)){if(!(2096103.424<this.responseData.length&&this.currentBlob!==this.toString))return void(navigator.msSaveOrOpenBlob?navigator.msSaveOrOpenBlob(this.dataUrlToBlob(this.responseData),this.currentFileName):(this.url=this.responseData,this.saver()));this.responseData=this.dataUrlToBlob(this.responseData)}if(this.responseData instanceof this.currentBlob?this.blob=this.responseData:this.blob=new this.currentBlob([this.responseData],{type:this.currentMimeType}),navigator.msSaveOrOpenBlob)return void navigator.msSaveOrOpenBlob(this.blob,this.currentFileName);if(!this.self.URL){if("string"==typeof this.blob||this.blob.constructor===this.toString)try{this.url="data:"+this.currentMimeType+";base64,"+this.self.btoa(this.blob)}catch(e){this.url="data:"+this.currentMimeType+","+encodeURIComponent(this.blob)}else this.reader=new FileReader,this.reader.onload=function(e){t.url=e.result},this.reader.readAsDataURL(this.blob),this.saver();return}this.url=this.self.URL.createObjectURL(this.blob),this.saver(!0)}},e.prototype.dataUrlToBlob=function(e){for(var t=e.split(/[:;,]/),r=t[1],i=("base64"==t[2]?atob:decodeURIComponent)(t.pop()),s=i.length,n=0,o=new Uint8Array(s);n<s;++n)o[n]=i.charCodeAt(n);return new this.currentBlob([o],{type:r})},e.prototype.saver=function(e){if("download"in this.anchor)this.downloadFile(e);else{var t=document.createElement("iframe");document.body.appendChild(t),e||(this.url="data:"+this.url.replace(/^this.responseData:([\w\/\-\+]+)/,this.currentMimeType)),t.src=this.url,setTimeout(function(){document.body.removeChild(t)},333)}},e.prototype.saveSafariFile=function(){for(var e=new Uint8Array(this.responseData),t=e.length,r=new Array(t);t--;)r[t]=String.fromCharCode(e[t]);this.url="data:"+this.currentMimeType+";base64,"+window.btoa(r.join("")),window.open(this.url)||(window.location.href=this.url)},e.prototype.downloadFile=function(e){var t=this;this.anchor.href=this.url,this.anchor.setAttribute("download",this.currentFileName),this.anchor.className="download-js-link",this.anchor.innerHTML="téléchargement en cours...",this.anchor.style.display="none",document.body.appendChild(this.anchor),setTimeout(function(){t.anchor.click(),document.body.removeChild(t.anchor),e&&setTimeout(function(){t.self.URL.revokeObjectURL(t.anchor.href)},250)},66)},e.prototype.isSafari=function(){return!!/(Version)\/(\d+)\.(\d+)(?:\.(\d+))?.Safari\//.test(navigator.userAgent)},e.prototype.checkSafariVersion=function(){var e=navigator.userAgent.match(/version\/(\d+).(\d+)/i);return Number(e[1]+e[2])<=61},e}(),r.FileSaver=i}(MyWay||(MyWay={})),function(e){var s,n,t;s=e.Services||(e.Services={}),n=s.Fichier||(s.Fichier={}),t=function(i){function e(){return i.call(this,s.Components.ComponentType.Fichier)||this}return __extends(e,i),e.prototype.init=function(e,t,r){return this._isIE=s.CoreCommon.checkIsIE(),i.prototype.init.call(this,e,t,r)},e.prototype.saveAs=function(e,t,r){var i=new n.FileSaver;return i.responseData=e,i.strMimeType=t,i.strFileName=r,i.initSaveFile(),s.Promesses.createPromiseSelfResolved()},e.prototype.save=function(e,t,r){return this.saveAs(e,t,r),s.Promesses.createPromiseSelfResolved()},e}(s.Components.ComponentApiBase),n.FichierApi=t,s.Components.RegistryApi.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-fichier-api.min.js.map
var MyWay;!function(a){var e;(function(e){var n=function(){function i(e){this.Key=e,i.LocalStorageLimitInKb=4096,i.IndexedDBStorageLimitInKb=40960}return i.prototype.Set=function(e){if(this.Get()!==e){var t={};t.rev=a.Services.CoreCommon.creerChaineAleatoire(5),t.value=e;var n=JSON.stringify(t);this.onInternalStorageChanged&&this.onInternalStorageChanged(t.rev),localStorage[this.Key]=n,i.EvaluateStorageSize(this.onStorageLimit)}},i.prototype.Get=function(){var e=localStorage[this.Key];if(e)return JSON.parse(e).value},i.EvaluateStorageSize=function(e){var t,n=0,r=0;for(t in localStorage)n+=2*localStorage[t].length,"IDB/"===t.substring(0,4)&&(r+=parseInt(localStorage[t]));if(e){var a=0,o=0;1024*i.LocalStorageLimitInKb<n&&(a=n/1024),1024*i.IndexedDBStorageLimitInKb<r&&(o=r/1024),e(a,o)}},i}();e.BaseStorage=n;var t=function(){function t(){}return Object.defineProperty(t,"Key",{get:function(){return t._baseStorage.Key},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onInternalStorageChanged",{set:function(e){t._baseStorage.onInternalStorageChanged=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onStorageLimit",{set:function(e){t._baseStorage.onStorageLimit=e},enumerable:!0,configurable:!0}),t.Set=function(e){t._baseStorage.Set(e)},t.Get=function(){return t._baseStorage.Get()},t._baseStorage=new n("context"),t}();e.ContextStorage=t;var r=function(){function t(){}return Object.defineProperty(t,"Key",{get:function(){return t._baseStorage.Key},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onInternalStorageChanged",{set:function(e){t._baseStorage.onInternalStorageChanged=e},enumerable:!0,configurable:!0}),Object.defineProperty(t,"onStorageLimit",{set:function(e){t._baseStorage.onStorageLimit=e},enumerable:!0,configurable:!0}),t.Set=function(e){t._baseStorage.Set(e)},t.Get=function(){return t._baseStorage.Get()},t._baseStorage=new n("interop-message-bus"),t}();e.InteropMessageBusStorage=r})((e=a.Services||(a.Services={})).Storage||(e.Storage={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-storage-business-object.min.js.map
var MyWay;!function(y){var a;(a=y.Services||(y.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-core-manager-addon.min.js.map
var MyWay;!function(t){var e,r;e=t.Test||(t.Test={}),((r=e.V1||(e.V1={})).Services||(r.Services={})).generateEmptyLibraryManager=function(){var r=0,n=null,o={};return{BaseDeDonnees:{},Core:{createPromiseSelfResolved:t.Services.CoreCommon.createPromiseSelfResolved,createPromiseSelfError:t.Services.CoreCommon.createPromiseSelfError,promesseTryCatch:t.Services.CoreCommon.promesseTryCatch,getPromesseSelfResoved:t.Services.CoreCommon.getPromesseSelfResoved,creerChaineAleatoire:function(e){return"abcde"+ ++r}},Context:{},Dates:{},Display:{},Libelle:{},Persistence:{addStorage:function(e,r){return{getValue:function(){return n},saveValue:function(e){n=e}}}},Evennements:{notifier:function(r){r&&r.EventType&&o[r.EventType]&&o[r.EventType].forEach(function(e){try{e(r)}catch(e){}})},ajouterListener:function(r){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];e.forEach(function(e){o[e]||(o[e]=[]),o[e].push(r)})},retirerListener:function(r){for(var e in o)t.Services.CoreCommon.ArrayUtils.remove(o[e],function(e){return e===r})}}}}}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-test-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var t in s)s.hasOwnProperty(t)&&(e[t]=s[t])};return function(e,s){function t(){this.constructor=e}n(e,s),e.prototype=null===s?Object.create(s):(t.prototype=s.prototype,new t)}}();!function(e){var n,s,t;n=e.Services||(e.Services={}),s=n.Components||(n.Components={}),t=function(s){function e(e){return s.call(this,e)||this}return __extends(e,s),e.prototype.init=function(e,s){return this.managerInstance=e,this.library=s,n.CoreCommon.getPromesseSelfResoved()},e.prototype.reception=function(s){var t=this;return n.CoreCommon.promesseTryCatch(function(e){e.reject(new n.Erreur("Subject "+s.subject+" not implemented on "+t.name+" manager-message"))})},e.prototype.dispose=function(){return n.CoreCommon.getPromesseSelfResoved()},e}(s.ComponentBase),s.ComponentManagerMessageBase=t}(MyWay||(MyWay={})),function(e){var s;(s=e.Services||(e.Services={})).Components||(s.Components={})}(MyWay||(MyWay={})),function(e){var r;(function(s){"use strict";var n;(n=s.RegistryType||(s.RegistryType={})).MANAGER_MESSAGE="MANAGER_MESSAGE";var e=function(t){function e(){var e=t.call(this,n.MANAGER_MESSAGE,[n.COMMON,n.MANAGER])||this;return e.messageService=null,e}return __extends(e,t),e.getInstance=function(){return null===e.instance&&(e.instance=new e,s.FactoryRegistries.getInstance().addRegistry(e.instance)),e.instance},e.prototype.init=function(e){var s=this;return this.getRegistryCommon().getComponentsInstances().forEach(function(e){s._componentsInstancesByKey[e.name]||(s._componentsInstances.push(e),s._componentsInstancesByKey[e.name]=e)}),this.messageService||(this.messageService=r.Message.MessageManagerMessageFactory.createMessageManager(this.getLibrary())),t.prototype.init.call(this,e)},e.prototype.getRegistryCommon=function(){return this._dependenciesInstances[0]},e.prototype.getRegistryManager=function(){return this._dependenciesInstances[1]},e.prototype.initializeComponent=function(e){var s=this.getRegistryManager().getComponentInstance(e.name);return e.init(s,this.getRegistryCommon().getLibrary())},e.instance=null,e}(s.AbstractRegistry);s.RegistryManagerMessage=e})((r=e.Services||(e.Services={})).Components||(r.Components={}))}(MyWay||(MyWay={})),function(a){var o;(function(e){var s=function(n){function e(e,s,t){return n.call(this,s,t,o.PrivatePortalServiceParameters.Instance().AuthorizedDomains,"Agent","Manager",e,!1,!0)||this}return __extends(e,n),e}(e.MessageBase),t=function(t){function e(e){var s=t.call(this,e,null,null)||this;return window.addEventListener("message",s._ReceiveMessage),s}return __extends(e,t),e.prototype.dispose=function(){window.removeEventListener("message",this._ReceiveMessage)},e.prototype.postMessage=function(e,s,t,n){s.postMessage(e,t)},e}(e.MessageManagerMessageBase=s);e.MessageManagerMessage=t;var n=function(s){function e(e){return s.call(this,e,null,null)||this}return __extends(e,s),e.prototype.postMessage=function(e,s,t,n){var r={};r.data=e,r.origin=t,r.source=s,o.MobileMessageAgent&&o.MobileMessageAgent.Instance&&o.MobileMessageAgent.Instance._ReceiveMessage(r)},e.prototype.dispose=function(){},e}(s);e.MobileMessageManagerMessage=n;var r=function(){function e(){}return e.createMessageManager=function(e){return a.Services.isMobile?new n(e):new t(e)},e}();e.MessageManagerMessageFactory=r})((o=a.Services||(a.Services={})).Message||(o.Message={}))}(MyWay||(MyWay={})),function(e){var s,a,t;s=e.Services||(e.Services={}),a=s.Loggers||(s.Loggers={}),t=function(r){function e(){return r.call(this,s.Components.ComponentType.Loggers)||this}return __extends(e,r),e.prototype.reception=function(e){switch(e.subject){case a.LoggersMessageSubject.GetConfigActual:var s=e.message,t=this.managerInstance.getConfigurationActual();return this.library.Core.createPromiseSelfResolved({config:t});case a.LoggersMessageSubject.SetConfigActual:s=e.message,this.managerInstance.setConfigActual(s.config),this.library.Core.getPromesseSelfResoved();case a.LoggersMessageSubject.GetConfigDB:return s=e.message,t=this.managerInstance.getConfigurationDB(s.nom),this.library.Core.createPromiseSelfResolved({config:t});case a.LoggersMessageSubject.SetConfigDB:s=e.message,this.managerInstance.setConfigDB(s.nom,s.config),this.library.Core.getPromesseSelfResoved();case a.LoggersMessageSubject.SaveConfig:s=e.message,this.managerInstance.saveConfiguration(s.nom),this.library.Core.getPromesseSelfResoved();case a.LoggersMessageSubject.LoadConfig:s=e.message,this.managerInstance.loadConfiguration(s.nom),this.library.Core.getPromesseSelfResoved();case a.LoggersMessageSubject.GetLoggers:return s=e.message,this.library.Core.createPromiseSelfResolved({loggers:this.managerInstance.getAllLogggersNames()});case a.LoggersMessageSubject.GetNomConfigAcuelle:s=e.message;var n=this.managerInstance.getNomConfigActuelle();return this.library.Core.createPromiseSelfResolved({nom:n});case a.LoggersMessageSubject.IsClassExists:s=e.message;try{return this.managerInstance.getClassByName(s.nom),this.library.Core.createPromiseSelfResolved({isExists:!0})}catch(e){return this.library.Core.createPromiseSelfResolved({isExists:!1})}case a.LoggersMessageSubject.Reset:s=e.message,this.managerInstance.clearConfigurations(),this.library.Core.getPromesseSelfResoved();default:return r.prototype.reception.call(this,e)}},e}(s.Components.ComponentManagerMessageBase),a.LoggerManagerMessage=t,s.Components.RegistryManagerMessage.getInstance().register(t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-core-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}r(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var n,t,r;n=e.Services||(e.Services={}),t=n.Components||(n.Components={}),r=function(){function e(e){this._name=e}return e.prototype.init=function(e,n){return this.library=n,this.manager=e,this.library.Core.getPromesseSelfResoved()},e.prototype.dispose=function(){return this.library.Core.getPromesseSelfResoved()},Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),e}(),t.ComponentManagerExtendedBase=r}(MyWay||(MyWay={})),function(e){var n;(n=e.Services||(e.Services={})).Components||(n.Components={})}(MyWay||(MyWay={})),function(e){var n;(function(n){"use strict";var r;(r=n.RegistryType||(n.RegistryType={})).MANAGER_EXTENDED="MANAGER_EXTENDED";var e=function(t){function e(){return t.call(this,r.MANAGER_EXTENDED,[r.MANAGER,r.COMMON])||this}return __extends(e,t),e.getInstance=function(){return null===e.instance&&(e.instance=new e,n.FactoryRegistries.getInstance().addRegistry(e.instance)),e.instance},e.prototype.init=function(e){var n=this;return this.getRegistryCommon().getComponentsInstances().forEach(function(e){n._componentsInstancesByKey[e.name]||(n._componentsInstances.push(e),n._componentsInstancesByKey[e.name]=e)}),t.prototype.init.call(this,e)},e.prototype.initializeComponent=function(e){return e.init(this.getRegistryManager().getComponentInstance(e.name),this.getRegistryCommon().getLibrary())},e.prototype.getRegistryCommon=function(){return this._dependenciesInstances[1]},e.prototype.getRegistryManager=function(){return this._dependenciesInstances[0]},e.instance=null,e}(n.AbstractRegistry);n.RegistryManagerExtended=e})((n=e.Services||(e.Services={})).Components||(n.Components={}))}(MyWay||(MyWay={})),function(e){var r,n;r=e.Services||(e.Services={}),n=function(){function t(){this.library=null,this.libraryExtended=null,this._serviceManager=new r.ServiceManager}return t.setListenerOnInitContext=function(e){t.listenerOnInitContext=e},t.prototype.init=function(e){var n=this;return r.PrivatePortalServiceParameters.Instance().init(),this._serviceManager.init(e).then(function(){for(var e in n.libraryExtended=r.Components.RegistryManagerExtended.getInstance().getLibrary(),n.library=r.Components.RegistryManager.getInstance().getLibrary(),n.libraryExtended)n[e]=n.libraryExtended[e];return t.listenerOnInitContext?t.listenerOnInitContext(n.libraryExtended):r.CoreCommon.createPromiseSelfResolved(null)})},t.prototype.Initialize=function(){return this._serviceManager.Initialize()},Object.defineProperty(t.prototype,"OnEvent",{set:function(e){this._serviceManager.OnEvent=e},enumerable:!0,configurable:!0}),t.prototype.Dispose=function(){return this._serviceManager.Dispose()},t.prototype.VersionMySys=function(){return r.CoreCommon.VersionMySys},t.CLASS_NAME="MyWay.Services.ServiceManagerExtended",t.logger=r.Loggers.LoggerFactory.INSTANCE.getClass(t.CLASS_NAME),t.listenerOnInitContext=null,t}(),r.ServiceManagerExtended=n}(MyWay||(MyWay={})),function(e){var n,t;n=e.Services||(e.Services={}),t=function(){function t(e){this.$q=e}return t.Instance=function(){return null===t._serviceManager&&(t._serviceManager=new n.ServiceManagerExtended),t._serviceManager},t.prototype.init=function(e){var n=this.$q.defer();return t.Instance().init(e).then(function(){t.logger.info("Fin d'initialisation du serviceManager"),n.resolve(t.Instance())},function(){n.reject()}),n.promise},t.CLASS_NAME="MyWay.Services.ServiceManagerProvider",t.logger=n.Loggers.LoggerFactory.INSTANCE.getClass(t.CLASS_NAME),t.$inject=["$q"],t._serviceManager=null,t}(),n.ServiceManagerProvider=t,"undefined"!=typeof angular&&(n.moduleManager=angular.module("moduleManager",["ng"]),n.moduleManager.provider("serviceManager",function(){this.$get=["$q",function(e){return t.Instance()}]}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-core-manager-extended.min.js.map
var MyWay;!function(e){var r;(r=e.Services||(e.Services={})).Bug||(r.Bug={})}(MyWay||(MyWay={})),function(e){var r,n;r=e.Services||(e.Services={}),((n=r.Components||(r.Components={})).ComponentType||(n.ComponentType={})).Preferences="Preferences"}(MyWay||(MyWay={})),function(e){var r,n,o;r=e.Services||(e.Services={}),n=r.Preferences||(r.Preferences={}),(o=n.PreferencesMessageSubject||(n.PreferencesMessageSubject={}))[o.LirePreference=0]="LirePreference",o[o.EcrirePreference=1]="EcrirePreference",o[o.LireMultiPreference=2]="LireMultiPreference",r.Components.FactoryRegistries.getInstance().declareComponent(r.Components.ComponentType.Preferences,[r.Components.ComponentType.Context,r.Components.ComponentType.Core])}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-preferences-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(t,e){function a(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}}();!function(D){var t;(function(t){var e=function(){};t.InfoFichier=e;var a=function(t,e,a,n){this.ExecApp=t,this.ExecServ=a,this.ExecTransaction=e,this.ExecWeb=n};t.ExecutableWrapper=a;var n=function(t){this.Executable=t};t.ExecApp=n;var r=function(t){this.Numero=t};t.ExecTransaction=r;var o=function(t){this.CodeSortie=t};t.ExecServ=o;var i=function(t,e){this.Url=t,this.Libelle=e};t.ExecWeb=i;var c=function(t,e){this.ProcessId=t,this.StepId=e};t.ContexteMyway=c;var s=function(t,e){this.NumeroClient=t,this.Plan=e};t.ContexteClient=s;var p=function(t){this.Valeur=t};t.JsonStringArray=p;var h=function(){};t.infoDataStructNSDK=h;var f=function(){function e(t){}return Object.defineProperty(e.prototype,"StructData",{get:function(){return this._StructData},set:function(t){this._StructData=t,e.Size=this.CalcSize()},enumerable:!0,configurable:!0}),e.prototype.DeSerializeData=function(t){for(var e=0,a=this.StructData,n=0;n<this.StructData.length;n++)"cwlgqr"!=a[n].DataName&&(this[a[n].DataName]=t.substring(e,e+a[n].DataLength)),e+=a[n].DataLength;this.cwlgqr=e},e.prototype.SerializeData=function(){for(var t=this.StructData,e="",a=0;a<this.StructData.length;a++)"cwlgqr"!=t[a].DataName&&(e+=this[t[a].DataName]);return e},e.prototype.CalcSize=function(){for(var t=this.StructData,e=0,a=0;a<this.StructData.length;a++)e+=t[a].DataLength;return e},e}();t.SegmentNsdkClass=f;var u=function(e){function t(){var t=e.call(this)||this;return t.StructData=[{DataName:"cwlgqr",DataLength:4},{DataName:"cwlnqr",DataLength:8},{DataName:"cidfiej",DataLength:5},{DataName:"cnuf9cg",DataLength:10},{DataName:"cdtfkc0",DataLength:8},{DataName:"ccdtn",DataLength:2},{DataName:"cnocee1",DataLength:7},{DataName:"ccocee3",DataLength:7},{DataName:"cddf9tr",DataLength:8},{DataName:"cdff9tr",DataLength:8},{DataName:"cidct",DataLength:7},{DataName:"cidtiem",DataLength:9},{DataName:"cidit",DataLength:9},{DataName:"cmtf9op",DataLength:15},{DataName:"cmtf9o1",DataLength:15},{DataName:"ccdfadv",DataLength:3},{DataName:"cnsf9rq",DataLength:4},{DataName:"cdtfkcc",DataLength:8}],t}return __extends(t,e),t}(D.Services.Interop.SegmentNsdkClass);t.s_5s6f5a=u})((t=D.Services||(D.Services={})).Interop||(t.Interop={}))}(MyWay||(MyWay={})),function(t){var e,a;e=t.Services||(t.Services={}),((a=e.Components||(e.Components={})).ComponentType||(a.ComponentType={})).Interop="Interop"}(MyWay||(MyWay={})),function(t){var e,a,n,r;e=t.Services||(t.Services={}),a=e.Interop||(e.Interop={}),n=a.Messages||(a.Messages={}),(r=n.InteropMessageSubject||(n.InteropMessageSubject={}))[r.AfficherWindowParHandle=0]="AfficherWindowParHandle",r[r.AfficherWindowParPid=1]="AfficherWindowParPid",r[r.AfficherSynthese=2]="AfficherSynthese",r[r.ActiverApplicationAppelante=3]="ActiverApplicationAppelante",r[r.AddToContextInterop=4]="AddToContextInterop",r[r.AddListToContextInterop=5]="AddListToContextInterop",r[r.GetFromContextInterop=6]="GetFromContextInterop",r[r.GetListFromContextInterop=7]="GetListFromContextInterop",r[r.Lancer=8]="Lancer",r[r.EndStep=9]="EndStep",r[r.TriggerNotifications=10]="TriggerNotifications",r[r.LireFichier=11]="LireFichier",r[r.EcrireFichier=12]="EcrireFichier",r[r.ClearBus=13]="ClearBus",e.Components.FactoryRegistries.getInstance().declareComponent(e.Components.ComponentType.Interop,[e.Components.ComponentType.Context,e.Components.ComponentType.Persistence])}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-interop-common.min.js.map
var MyWay;!function(E){var R,_,I;R=E.Services||(E.Services={}),_=R.Libelle||(R.Libelle={}),(I=_.TYPE_AFFICHAGE||(_.TYPE_AFFICHAGE={}))[I.ERREUR=10]="ERREUR",I[I.AVERTISSEMENT=30]="AVERTISSEMENT",I[I.INFORMATION=50]="INFORMATION",I[I.OUI_NON=70]="OUI_NON",I[I.OUI_NON_ANNULER=90]="OUI_NON_ANNULER",I[I.VALIDER_ANNULER=110]="VALIDER_ANNULER",I[I.ANNULER=120]="ANNULER",I[I.VIDE=140]="VIDE"}(MyWay||(MyWay={})),function(E){var R,_;R=E.Services||(E.Services={}),((_=R.Components||(R.Components={})).ComponentType||(_.ComponentType={})).Libelle="Libelle"}(MyWay||(MyWay={})),function(E){var R,_,I;R=E.Services||(E.Services={}),_=R.Libelle||(R.Libelle={}),(I=_.LibelleMessageSubject||(_.LibelleMessageSubject={}))[I.afficherMessage=0]="afficherMessage",I[I.constituerLibelle=1]="constituerLibelle",R.Components.FactoryRegistries.getInstance().declareComponent(R.Components.ComponentType.Libelle,[R.Components.ComponentType.Context,R.Components.ComponentType.Core,R.Components.ComponentType.Display])}(MyWay||(MyWay={})),function(E){var R,_,I;R=E.Services||(E.Services={}),_=R.Libelle||(R.Libelle={}),I=function(){function E(){}return E.COM={MESSAGE_SANS_VARIABLE:"COM.MESSAGE_SANS_VARIABLE",RESULTATS:"COM.RESULTATS",ERREUR_PARAMETRE_MAUVAIS_TYPE:"COM.ERREUR_PARAMETRE_MAUVAIS_TYPE",ERREUR_PARAMETRES:"COM.ERREUR_PARAMETRES",ERREUR_FRAMEWORK:"COM.ERREUR_FRAMEWORK",ERREUR_SERVEUR:"COM.ERREUR_SERVEUR",ERREUR_TIMEOUT_SERVEUR:"COM.ERREUR_TIMEOUT_SERVEUR",ERREUR_TIMEOUT_CLIENT:"COM.ERREUR_TIMEOUT_CLIENT",ERREUR_ACCES_SERVEUR:"COM.ERREUR_ACCES_SERVEUR",ERREUR_CONFIGURATION_PAS_DE_CONFIG:"COM.ERREUR_CONFIGURATION_PAS_DE_CONFIG",ERREUR_HABILITATION_MAUVAIS_FORMAT:"COM.ERREUR_HABILITATION_MAUVAIS_FORMAT",ERREUR_HABILITATION_CODE_INCONNU:"COM.ERREUR_HABILITATION_CODE_INCONNU",ERREUR_HABILITATION_PARAMETRES_INSUFFISANTS:"COM.ERREUR_HABILITATION_PARAMETRES_INSUFFISANTS",ERREUR_HABILITATION_AUTHENTIFICATION_MANQUANTE:"COM.ERREUR_HABILITATION_AUTHENTIFICATION_MANQUANTE",ERREUR_INDEXED_DB_NON_SUPPORTE:"COM.ERREUR_INDEXED_DB_NON_SUPPORTE",ERREUR_INDEXED_DB_GENERIQUE:"COM.ERREUR_INDEXED_DB_GENERIQUE",ERREUR_INDEXED_DB_SUPPRESSION_IMPOSSIBLE:"COM.ERREUR_INDEXED_DB_SUPPRESSION_IMPOSSIBLE",ERREUR_INDEXED_DB_ACCES_IMPOSSIBLE:"COM.ERREUR_INDEXED_DB_ACCES_IMPOSSIBLE",ERREUR_INDEXED_DB_LECTURE_IMPOSSIBLE:"COM.ERREUR_INDEXED_DB_LECTURE_IMPOSSIBLE",ERREUR_INDEXED_DB_AJOUT_IMPOSSIBLE:"COM.ERREUR_INDEXED_DB_AJOUT_IMPOSSIBLE",ERREUR_INDEXED_DB_MAJ_IMPOSSIBLE:"COM.ERREUR_INDEXED_DB_MAJ_IMPOSSIBLE",ERREUR_INDEXED_DB_REQUETE_IMPOSSIBLE_INDEX:"COM.ERREUR_INDEXED_DB_REQUETE_IMPOSSIBLE_INDEX",ERREUR_INDEXED_DB_REQUETE_IMPOSSIBLE_CRITERE:"COM.ERREUR_INDEXED_DB_REQUETE_IMPOSSIBLE_CRITERE",ERREUR_INDEXED_DB_CALCUL_TAILLE:"COM.ERREUR_INDEXED_DB_CALCUL_TAILLE",ERREUR_CONTEXTE_RECUP_CODE_ETAB_IMPOSSIBLE:"COM.ERREUR_CONTEXTE_RECUP_CODE_ETAB_IMPOSSIBLE",ERREUR_CONTEXTE_RECUP_ID_AGENCE_IMPOSSIBLE:"COM.ERREUR_CONTEXTE_RECUP_ID_AGENCE_IMPOSSIBLE",ERREUR_DONNEESDELOC_OBJET_MAL_FORME:"COM.ERREUR_DONNEESDELOC_OBJET_MAL_FORME",ERREUR_DONNEESDELOC_PROPRIETE_ABSENTE:"COM.ERREUR_DONNEESDELOC_PROPRIETE_ABSENTE",ERREUR_DONNEESDELOC_RECUP_DERNMAJ_IMPOSSIBLE:"COM.ERREUR_DONNEESDELOC_RECUP_DERNMAJ_IMPOSSIBLE",ERREUR_LISA_NEXT_IMPOSSIBLE:"COM.ERREUR_LISA_NEXT_IMPOSSIBLE",ERREUR_LISA_START_IMPOSSIBLE:"COM.ERREUR_LISA_START_IMPOSSIBLE",ERREUR_LISA_GETPROCESSES_IMPOSSIBLE:"COM.ERREUR_LISA_GETPROCESSES_IMPOSSIBLE",ERREUR_LISA_GETTOOLS_IMPOSSIBLE:"COM.ERREUR_LISA_GETTOOLS_IMPOSSIBLE",ERREUR_NUMERISATION_RECUP_CODE_ETAB_IMPOSSIBLE:"COM.ERREUR_NUMERISATION_RECUP_CODE_ETAB_IMPOSSIBLE",ERREUR_NUMERISATION_RECUP_DONNEES_DELOCALISEES_IMPOSSIBLE:"COM.ERREUR_NUMERISATION_RECUP_DONNEES_DELOCALISEES_IMPOSSIBLE",ERREUR_INTEROP_SERVICE_LOCAL_APPEL_IMPOSSIBLE:"COM.ERREUR_INTEROP_SERVICE_LOCAL_APPEL_IMPOSSIBLE",ERREUR_FICHIER_PARAMETRE_DATA_VIDE:"COM.ERREUR_FICHIER_PARAMETRE_DATA_VIDE",ERREUR_FICHIER_PARAMETRE_B64_VIDE:"COM.ERREUR_FICHIER_PARAMETRE_B64_VIDE",ERREUR_APPLICATION:"COM.ERREUR_APPLICATION",ERREUR_APPLICATION_CODE_NON_RENSEIGNE:"COM.ERREUR_APPLICATION_CODE_NON_RENSEIGNE",ERREUR_APPLICATION_TYPE_INCONNU:"COM.ERREUR_APPLICATION_TYPE_INCONNU",ERREUR_APPLICATION_DEMARRAGE_IMPO:"COM.ERREUR_APPLICATION_DEMARRAGE_IMPOSSIBLE",ERREUR_APPLICATION_MAINTENANCE:"COM.ERREUR_APPLICATION_MAINTENANCE",ERREUR_MOBILITE_RECUP_RESEAU_IMPOSSIBLE:"COM.ERREUR_MOBILITE_RECUP_RESEAU_IMPOSSIBLE",ERREUR_MOBILITE_RECUP_LISTE_PERIPH_IMPOSSIBLE:"COM.ERREUR_MOBILITE_RECUP_LISTE_PERIPH_IMPOSSIBLE",ERREUR_MOBILITE_RECUP_LISTE_TABLETTES_SIGNATURES_IMPOSSIBLE:"COM.ERREUR_MOBILITE_RECUP_LISTE_TABLETTES_SIGNATURES_IMPOSSIBLE",ERREUR_MOBILITE_RECUP_INFO_MACHINE_IMPOSSIBLE:"COM.ERREUR_MOBILITE_RECUP_INFO_MACHINE_IMPOSSIBLE",ERREUR_MOBILITE_RECUP_PLATEFORME_MACHINE_IMPOSSIBLE:"COM.ERREUR_MOBILITE_RECUP_PLATEFORME_MACHINE_IMPOSSIBLE",ERREUR_MOBILITE_RECUP_RESOLUTION_ECRAN_IMPOSSIBLE:"COM.ERREUR_MOBILITE_RECUP_RESOLUTION_ECRAN_IMPOSSIBLE",ERREUR_MOBILITE_RECUP_TYPE_ECRAN_IMPOSSIBLE:"COM.ERREUR_MOBILITE_RECUP_TYPE_ECRAN_IMPOSSIBLE",ERREUR_CAPACITES_REGLE_INCONNU:"COM.ERREUR_CAPACITES_REGLE_INCONNU",ERREUR_COMMUNICATION_MESSAGE_INDISPONIBLE:"COM.MESSAGE_INDISPONIBLE",ERREUR_COMMUNICATION_FORMAT_MAIL_INCORRECT:"COM.ERREUR_COMMUNICATION_FORMAT_MAIL_INCORRECT",ERREUR_COMMUNICATION_FORMAT_NUMERO_INCORRECT:"COM.ERREUR_COMMUNICATION_FORMAT_NUMERO_INCORRECT",ERREUR_COMMUNICATION_DONNEES_APPEL_MANQUANTE:"COM.ERREUR_COMMUNICATION_DONNEES_APPEL_MANQUANTE",ERREUR_COMMUNICATION_PARAMETRES_INSUFFISANTS:"COM.ERREUR_COMMUNICATION_PARAMETRES_INSUFFISANTS",ERREUR_CONTROLE_STRING_ADRESSEIP_INCORRECT:"COM.ERREUR_CONTROLE_STRING_ADRESSEIP_INCORRECT",ERREUR_ACQUISITION_PARAMETRES_INSUFFISANTS:"COM.ERREUR_ACQUISITION_PARAMETRES_INSUFFISANTS",ERREUR_EXPORT_DONNEES_ENTREES_FORMAT_INVALIDE:"COM.ERREUR_EXPORT_DONNEES_ENTREES_FORMAT_INVALIDE",ERREUR_EXPORT_DONNEES_ENTREES_VIDE:"COM.ERREUR_EXPORT_DONNEES_ENTREES_VIDE",ERREUR_EXPORT_DONNEES_ENTREES_NB_INVALIDE:"COM.ERREUR_EXPORT_DONNEES_ENTREES_NB_INVALIDE",ERREUR_EXPORT_CONVERSION_CSV_IMPOSSIBLE:"COM.ERREUR_EXPORT_CONVERSION_CSV_IMPOSSIBLE",ERREUR_EXPORT_TELECHARGEMENT_IMPOSSIBLE:"COM.ERREUR_EXPORT_TELECHARGEMENT_IMPOSSIBLE",ERREUR_EXPORT_FORMAT_FICHIER_INCONNU:"COM.ERREUR_EXPORT_FORMAT_FICHIER_INCONNU"},E.TEC={CHAINE_VIDE:"TEC.CHAINE_VIDE",VALIDATION_ARRAY:"TEC.VALIDATION_ARRAY",IMPRESSION_GENERATION_EN_COURS:"TEC.IMPRESSION_GENERATION_EN_COURS",IMPRESSION_IMPRESSION_EN_COURS:"TEC.IMPRESSION_IMPRESSION_EN_COURS",IMPRESSION_GENERATION_IMPRESSION_EN_COURS:"TEC.IMPRESSION_GENERATION_IMPRESSION_EN_COURS",NUMERISATION_EN_COURS:"TEC.NUMERISATION_EN_COURS"},E}(),_.LibelleModel=I}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-libelle-common.min.js.map
var MyWay;!function(e){var n,t;n=e.Services||(e.Services={}),((t=n.Components||(n.Components={})).ComponentType||(t.ComponentType={})).Communication="Communication"}(MyWay||(MyWay={})),function(e){var n,t,o;n=e.Services||(e.Services={}),t=n.Communication||(n.Communication={}),(o=t.CommunicationMessageSubject||(t.CommunicationMessageSubject={}))[o.EnvoyerMail=0]="EnvoyerMail",o[o.DeclencherAppel=1]="DeclencherAppel",o[o.RaccrocherAppel=2]="RaccrocherAppel",o[o.EnvoyerMessageAppliKiosque=3]="EnvoyerMessageAppliKiosque",n.Components.FactoryRegistries.getInstance().declareComponent(n.Components.ComponentType.Communication,[n.Components.ComponentType.Context,n.Components.ComponentType.Core])}(MyWay||(MyWay={})),function(e){var o,n;o=e.Services||(e.Services={}),(n=o.Communication||(o.Communication={})).controleEnvoyerMail=function(e){var n="^[a-zA-Z]+[a-zA-Z0-9._-]*@[a-zA-Z0-9.-]+.[a-zA-Z]{2,3}(;[a-zA-Z]+[a-zA-Z0-9._-]*@[a-zA-Z0-9.-]+.[a-zA-Z]{2,3})*$",t="Le format de l'adresse mail du paramètre '{0}' ({1}) est incorrect";return o.Controle.StaticStringControle.isString(e.to)?e.to.match(n)?o.Controle.StaticStringControle.isString(e.cc)&&!e.cc.match(n)?t.replace("{0}","cc").replace("{1}",e.cc):o.Controle.StaticStringControle.isString(e.bcc)&&!e.bcc.match(n)?t.replace("{0}","bcc").replace("{1}",e.bcc):"":t.replace("{0}","to").replace("{1}",e.to):"Le paramètre 'to' doit être une chaine de caractères"},n.controleDeclencherAppel=function(e){return/^(0|\+33)[1-9]([-. ]?[0-9]{2}){4}$/.test(e.numeroDestinataire)?"":"Le format du numéro du destinataire ({0}) est incorrect".replace("{0}",e.numeroDestinataire)}}(MyWay||(MyWay={})),function(e){var c;(function(e){var n=function(e,n,t,o,c){this.to=e,this.subject=n,this.body=t,this.cc=o,this.bcc=c};e.Mail=n;var t=function(e){this.numeroDestinataire=e};e.Call=t;var o=function(e,n,t){this.IdAgent=e,this.Payload=new c.Payload(n,t)};e.MessageAgent=o})((c=e.Services||(e.Services={})).Communication||(c.Communication={}))}(MyWay||(MyWay={})),function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-communication-common.min.js.map
var MyWay;!function(e){var t,n;t=e.Services||(e.Services={}),((n=t.Components||(t.Components={})).ComponentType||(n.ComponentType={})).ContexteClient="ContexteClient"}(MyWay||(MyWay={})),function(e){var t,n,o;t=e.Services||(e.Services={}),n=t.ContexteClient||(t.ContexteClient={}),(o=n.ContextClientMessageSubject||(n.ContextClientMessageSubject={}))[o.GetContextesParClients=0]="GetContextesParClients",o[o.GetId=1]="GetId",o[o.GetClient=2]="GetClient",o[o.SetClient=3]="SetClient",o[o.GetProperty=4]="GetProperty",o[o.AddToList=5]="AddToList",o[o.SetProperty=6]="SetProperty",o[o.RemoveFromList=7]="RemoveFromList",o[o.DeleteProperty=8]="DeleteProperty",o[o.GetContenu=9]="GetContenu",o[o.SetContenu=10]="SetContenu",o[o.GetContextes=11]="GetContextes",o[o.DestroyContext=12]="DestroyContext",o[o.NewContext=13]="NewContext",o[o.ChangeContextProcess=14]="ChangeContextProcess",o[o.ChangeContextMode=15]="ChangeContextMode",o[o.DetailsContext=16]="DetailsContext",o[o.SetReloadSynthese=17]="SetReloadSynthese",o[o.getRefresh=18]="getRefresh",o[o.setDirty=19]="setDirty",t.Components.FactoryRegistries.getInstance().declareComponent(t.Components.ComponentType.ContexteClient,[t.Components.ComponentType.Context,t.Components.ComponentType.Core,t.Components.ComponentType.Display,t.Components.ComponentType.Persistence])}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t,n,o,C,s;t=e.Services||(e.Services={}),n=t.ContexteClient||(t.ContexteClient={}),o=n.Messages||(n.Messages={}),(C=o.ContexteClientMode||(o.ContexteClientMode={}))[C.AUTOMATIQUE="AUTOMATIQUE"]="AUTOMATIQUE",C[C.MANUEL="MANUEL"]="MANUEL",(s=o.MiseAJourContexteClientType||(o.MiseAJourContexteClientType={}))[s.addToList="addToList"]="addToList",s[s.removeFromList="removeFromList"]="removeFromList",s[s.deleteProperty="deleteProperty"]="deleteProperty",s[s.setProperty="setProperty"]="setProperty",s[s.setClient="setClient"]="setClient",s[s.nouveauContexte="nouveauContexte"]="nouveauContexte",s[s.detructionContexte="detructionContexte"]="detructionContexte",s[s.changementContexte="changementContexte"]="changementContexte"}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-contexte-client-common.min.js.map
var MyWay;!function(e){var r;(function(e){var t;(t=e.NIVEAUX_TRACE||(e.NIVEAUX_TRACE={}))[t.DEBUG=30]="DEBUG",t[t.INFO=50]="INFO",t[t.WARNING=70]="WARNING",t[t.ERROR=90]="ERROR";var n=function(){function e(){}return e.gererErreur=function(e){return e&&(e instanceof Error?e={message:e.message,stack:e.stack}:r.Controle.StaticObjectControle.isObjectSpecified(e,"DOMException")&&(e={code:e.code,message:e.message,name:e.name,stack:e.stack})),e},e}();e.Utils=n})((r=e.Services||(e.Services={})).Trace||(r.Trace={}))}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(s){var d;(function(u){var e=function(){function e(e,t,n){this._componentName=e,this._zoneName=t,this._library=n}return e.prototype.debug=function(e,t,n){this.send(u.NIVEAUX_TRACE.DEBUG,e,t,n)},e.prototype.info=function(e,t,n){this.send(u.NIVEAUX_TRACE.INFO,e,t,n)},e.prototype.warning=function(e,t,n){this.send(u.NIVEAUX_TRACE.WARNING,e,t,n)},e.prototype.error=function(e,t,n){this.send(u.NIVEAUX_TRACE.ERROR,e,t,n)},e.prototype.send=function(e,t,n,r){var o,i;i="Application"===this._zoneName?(o=this._componentName,null):(o=void 0!==s.Framework?s.Framework.NAME+" V"+s.Framework.VERSION:"Framework inconnu",this._componentName+this._zoneName);var a=this.createTrace(e,t,window.location.href,o,i,n,r);this._library&&this._library.Trace&&this._library.Trace.send(a)},e.prototype.createTrace=function(e,t,n,r,o,i,a){var s=(new Date).getTime();"ServiceAgentExtended"===i&&a&&a.lastDigestTime&&(s=a.lastDigestTime,a=null),a=u.Utils.gererErreur(a);var c="";if(d.Controle.StaticEnumControle.isAnEnumValue(e,u.NIVEAUX_TRACE)||(c+="Le paramètre 'niveau' est obligatoire et sa valeur doit faire partie de l'enum 'NIVEAUX_TRACE' / "),d.Controle.StaticStringControle.isStringNotEmpty(t)||(c+="Le paramètre 'message' est obligatoire et doit être de type string et non vide / "),d.Controle.StaticStringControle.isStringNotEmpty(n)||(c+="Le paramètre 'url' est obligatoire et doit être de type string et non vide / "),d.Controle.StaticStringControle.isStringNotEmpty(r)||(c+="Le paramètre 'application' est obligatoire et doit être de type string et non vide / "),d.Controle.StaticStringControle.isStringNotEmptyOrNullOrUndefined(o)||(c+="Le paramètre 'composant' doit être soit null soit undefined soit de type string et non vide / "),d.Controle.StaticStringControle.isStringNotEmptyOrNullOrUndefined(i)||(c+="Le paramètre 'action' doit être soit null soit undefined soit de type string et non vide / "),""!=c)throw c=c.substring(0,c.lastIndexOf("/")-1),new Error(c);var l=new p;return l.datetime=s,l.niveau=e,l.client="",l.serveur="",l.url=n,l.application=r,d.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o)?l.composant=o:l.composant="",d.Controle.StaticAnyControle.isNotUndefinedAndNotNull(i)?l.action=i:l.action="",l.message=t,d.Controle.StaticAnyControle.isNotUndefinedAndNotNull(a)?l.details=a:l.details=null,l},e}();u.Logger=e;var p=function(){};u.TraceModel=p})((d=s.Services||(s.Services={})).Trace||(d.Trace={}))}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),((n=t.Components||(t.Components={})).ComponentType||(n.ComponentType={})).Trace="Trace"}(MyWay||(MyWay={})),function(e){var t,n,r,o;t=e.Services||(e.Services={}),n=t.Trace||(t.Trace={}),r=n.Messages||(n.Messages={}),(o=r.TraceMessageSubject||(r.TraceMessageSubject={}))[o.Tracer=0]="Tracer",o[o.Logger=1]="Logger",o[o.GetIntervallePurge=2]="GetIntervallePurge",o[o.GetQuotaPurge=3]="GetQuotaPurge",o[o.PurgerTraces=4]="PurgerTraces",o[o.SendDiagnostic=5]="SendDiagnostic",o[o.SetModeDebug=6]="SetModeDebug",o[o.ReInitDbTraces=7]="ReInitDbTraces",t.Components.FactoryRegistries.getInstance().declareComponent(t.Components.ComponentType.Trace,[t.Components.ComponentType.Context,t.Components.ComponentType.Core,t.Components.ComponentType.BaseDeDonnees])}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-common.min.js.map
var MyWay;!function(e){var o,n;o=e.Services||(e.Services={}),((n=o.Components||(o.Components={})).ComponentType||(n.ComponentType={})).ConfigurationPoste="ConfigurationPoste"}(MyWay||(MyWay={})),function(e){var o,n,t;o=e.Services||(e.Services={}),n=o.ConfigurationPoste||(o.ConfigurationPoste={}),(t=n.ConfigurationPosteMessageSubject||(n.ConfigurationPosteMessageSubject={}))[t.GetConfiguration=0]="GetConfiguration",o.Components.FactoryRegistries.getInstance().declareComponent(o.Components.ComponentType.ConfigurationPoste,[o.Components.ComponentType.Context,o.Components.ComponentType.Core])}(MyWay||(MyWay={})),function(e){var o;(o=e.Services||(e.Services={})).Bug||(o.Bug={})}(MyWay||(MyWay={})),function(e){var o;(o=e.Services||(e.Services={})).Bug||(o.Bug={})}(MyWay||(MyWay={})),function(e){var o;(o=e.Services||(e.Services={})).Bug||(o.Bug={})}(MyWay||(MyWay={})),function(e){var o;(o=e.Services||(e.Services={})).Bug||(o.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-configuration-poste-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var p;(function(c){var r=function(){};c.ScopeData=r;var s=function(e,t){this.name=e,this.data=t};c.ServiceData=s;var e=function(o){function i(){var e=o.call(this,p.Components.ComponentType.Context)||this;return e.listenersNotificationsCorrespondance=[],e._listenedKey=null,e._listernerCallback=null,e}return __extends(i,o),i.prototype.init=function(e,t,n){var r=this;return this.sauvegardeScopeParam=n,this.sauvegardeScopeParam||(this.sauvegardeScopeParam={}),this.sauvegardeScopeParam.donneesScopeASauvegarder||(this.sauvegardeScopeParam.donneesScopeASauvegarder=["*"]),this.sauvegardeScopeParam.scopeType||(this.sauvegardeScopeParam.scopeType=c.ScopeType.View),null!==this.sauvegardeScopeParam.disableScopeSave&&void 0!==this.sauvegardeScopeParam.disableScopeSave||(this.sauvegardeScopeParam.disableScopeSave=!0),o.prototype.init.call(this,e,t,n).then(function(){return n&&!0===n.disableGetStepInfo?r.GetCurrentStepInfo().then(function(e){r.StepInfo=e}):r.SetMyWayCompatible().then(function(){},function(){})})},i.prototype.AddToContext=function(t,e){var n=this;return this.sendMessage(c.ContextMessageSubject.AddToContext,{key:t,value:e}).then(function(e){return n._checkKey(t),e})},i.prototype.AddToSharedContext=function(e,t){return this.sendMessage(c.ContextMessageSubject.AddToSharedContext,{key:e,value:t})},i.prototype.RemoveFromSharedContext=function(e){return this.sendMessage(c.ContextMessageSubject.RemoveFromSharedContext,{key:e})},i.prototype.AddToMainProcessContext=function(e,t){return this.sendMessage(c.ContextMessageSubject.AddToMainProcessContext,{key:e,value:t})},i.prototype.AddListToContext=function(t){var n=this;return this.sendMessage(c.ContextMessageSubject.AddListToContext,{kvp:t}).then(function(e){return n._checkKeys(t),e})},i.prototype.GetFromContext=function(e){return this.sendMessage(c.ContextMessageSubject.GetFromContext,{key:e})},i.prototype.GetFromSharedContext=function(e){return this.sendMessage(c.ContextMessageSubject.GetFromSharedContext,{key:e})},i.prototype.GetObjectFromContext=function(e){return this.sendMessage(c.ContextMessageSubject.GetObjectFromContext,{keyArray:e})},i.prototype.GetTypedObjectFromContext=function(e){return this.sendMessage(c.ContextMessageSubject.GetTypedObjectFromContext,{template:e})},i.prototype.GetListFromContext=function(e){return this.sendMessage(c.ContextMessageSubject.GetListFromContext,{keyArray:e})},i.prototype.GetAuthentificationInfo=function(){return this.sendMessage(c.ContextMessageSubject.GetAuthentificationInfo,{})},i.prototype.getAuthentificationInfo=function(){return this.GetAuthentificationInfo()},i.prototype.GetParametresComptables=function(){return this.sendMessage(c.ContextMessageSubject.GetParametresComptables,{})},i.prototype.Redirect=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=null),this.library.Display.redirect(e,t)},i.prototype.GetWaitingProcesses=function(){return this.sendMessage(c.ContextMessageSubject.GetWaitingProcesses,{})},i.prototype.PutProcessInPortalContext=function(e){return this.sendMessage(c.ContextMessageSubject.PutProcessInPortalContext,{processId:e})},i.prototype.PutTaskInPortalContext=function(e){return this.sendMessage(c.ContextMessageSubject.PutTaskInPortalContext,{taskId:e})},i.prototype.GetCurrentProcessId=function(){return this.sendMessage(c.ContextMessageSubject.GetCurrentProcessId,{})},i.prototype.GetCurrentStepId=function(){return this.sendMessage(c.ContextMessageSubject.GetCurrentStepId,{})},i.prototype.reinitialisationServiceAgent=function(e){return this.sendMessage(c.ContextMessageSubject.ReinitialisationServiceAgent,{idServiceAgentGenere:e})},i.prototype.GetCurrentStepInfo=function(){return this.sendMessage(c.ContextMessageSubject.GetCurrentStepInfo,{})},i.prototype.SetMyWayCompatible=function(){var t=this;return this.sendMessage(c.ContextMessageSubject.SetMyWayCompatible,{}).then(function(e){return t.VersionComposant=e.versionComposant,!0})},i.prototype.SubscribeToNotification=function(e,r){var o=this;return e.forEach(function(t){var n=!1;if(o.listenersNotificationsCorrespondance.every(function(e){return e.callbackExterne===t&&(n=!0),!n}),!n){var e={callbackExterne:t,callbackInterne:function(e){t(e,r)}};o.library.Core.addListenerOnNotification(e.callbackInterne),o.listenersNotificationsCorrespondance.push(e)}}),r&&this.library.Interop?this.library.Interop.triggerNotifications():p.Promesses.getPromesseSelfResoved()},i.prototype.retirerListenerNotification=function(t){var n=this;p.CoreCommon.ArrayUtils.remove(this.listenersNotificationsCorrespondance,function(e){return e.callbackExterne===t&&(n.library.Core.removeListenerOnNotification(e.callbackInterne),!0)})},i.prototype.ChangeMainProcessName=function(e){return this.sendMessage(c.ContextMessageSubject.ChangeMainProcessName,{name:e})},i.prototype.getAllElementsWithAttribute=function(e){for(var t=[],n=document.getElementsByTagName("*"),r=0,o=n.length;r<o;r++)null!==n[r].getAttribute(e)&&t.push(n[r]);return t},i.prototype.SauvegarderDonneesScope=function(){if(this.sauvegardeScopeParam.disableScopeSave||!this.StepInfo||!this.StepInfo.CurrentStepId)return null;if("undefined"==typeof angular)return null;var e=null;try{if(this.sauvegardeScopeParam.scopeType==c.ScopeType.Service){var t=this._getServiceData(this.sauvegardeScopeParam.donneesScopeASauvegarder);try{e=JSON.pruned(t)}catch(e){p.Loggers.FLASH.INSTANCE.setValue("action","SauvegarderDonneesScope"),i.logger.error("impossible de serialiser le scope")}}else{var n=this._getAngularScope();if(!n)return;var r=this._getOverallScopeContent(n);try{e=JSON.pruned(r)}catch(e){p.Loggers.FLASH.INSTANCE.setValue("action","SauvegarderDonneesScope"),i.logger.error("impossible de serialiser le scope")}}e&&(e.length<1e4?this._addToProcessStepContext("donneesScope",e,this.StepInfo.CurrentPath):(p.Loggers.FLASH.INSTANCE.setValue("action","SauvegarderDonneesScope"),i.logger.warn("Sauvegarde du scope non autorisee, le scope serialise depasse la taille limite de %1 caracteres : %2",1e4,e.length)))}catch(e){p.Loggers.FLASH.INSTANCE.setValue("action","SauvegarderDonneesScope"),i.logger.debug("impossible de récupérer le scope")}},i.prototype._addToProcessStepContext=function(e,t,n){return this.sendMessage(c.ContextMessageSubject.AddToProcessStepContext,{key:e,value:t,processStepId:n})},i.prototype._getAngularScope=function(){var e;if(this.sauvegardeScopeParam.scopeType===c.ScopeType.View){var t=this.getAllElementsWithAttribute("ng-view");if(0===t.length&&(t=this.getAllElementsWithAttribute("data-ng-view")),0===t.length)return null;e=angular.element(t).scope()}else this.sauvegardeScopeParam.scopeType===c.ScopeType.Root&&(e=angular.element(document).scope());return e},i.prototype._getOverallScopeContent=function(t){var s=this;if(this.sauvegardeScopeParam.scopeType!==c.ScopeType.View)return this.sauvegardeScopeParam.scopeType===c.ScopeType.Root?this._getScopeData(t,null):this.sauvegardeScopeParam.scopeType===c.ScopeType.Service?this._getServiceData(this.sauvegardeScopeParam.donneesScopeASauvegarder):void 0;var a={};return 1==this.sauvegardeScopeParam.donneesScopeASauvegarder.length&&"*"===this.sauvegardeScopeParam.donneesScopeASauvegarder[0]?a=this._getScopeContent(t):this.sauvegardeScopeParam.donneesScopeASauvegarder.forEach(function(e){var n=e.split(".");if(1===n.length)a[e]=s._getScopeContent(t[n[0]]);else{var r=t,o={};n.forEach(function(e,t){0===t?(a[e]||(a[e]={}),o=a[e],r=r[e]):t===n.length-1?o[e]=s._getScopeContent(r[e]):(o[e]||(o[e]={}),o=o[e],r=r[e])})}}),a},i.prototype._getScopeData=function(e,t){var n=new r;return n.id=e.$id,n.data=this._getScopeContent(e),e.$$childHead&&this._getScopeData(e.$$childHead,n),e.$$nextSibling&&this._getScopeData(e.$$nextSibling,t),t&&(t.children||(t.children=[]),t.children.push(n)),n},i.prototype._setScope=function(t,e){var n=this,r=this._getScopeById(t,e.id);if(r)for(var o in e.data)p.CoreCommon.applyProperties(e.data,r,o);e.children&&e.children.forEach(function(e){n._setScope(t,e)})},i.prototype._getServiceData=function(e){for(var t=[],n=0;n<e.length;n++){var r=e[n],o=angular.element(document.body).injector().get(r);t.push(new s(r,o))}return t},i.prototype._setServices=function(e){for(var t=0;t<e.length;t++){var n=e[t].name,r=e[t].data,o=angular.element(document.body).injector().get(n);for(var s in r)p.CoreCommon.applyProperties(r,o,s)}},i.prototype._getScopeById=function(e,t){return e.$id===t?e:e.$$childHead&&(n=this._getScopeById(e.$$childHead,t))?n:e.$$nextSibling&&(n=this._getScopeById(e.$$nextSibling,t))?n:null;var n},i.prototype._isObject=function(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)},i.prototype._getScopeContent=function(e){if(!this._isObject(e[n]))return e;var t={};for(var n in e)if("$"!==n[0]&&"function"!=typeof e[n]&&e[n]&&e.hasOwnProperty(n))if(this._isObject(e[n])){if(e[n].$$framework)continue;t[n]=this._getScopeContent(e[n])}else t[n]=e[n];return t},i.prototype.getId=function(e){return e.id?"#"+e.id:""},i.prototype.getClasses=function(e){return e.className?"."+e.className.replace(new RegExp(" ","g"),"."):""},i.prototype.InitialiserDonneesScope=function(e){var n=this;if(this.sauvegardeScopeParam.disableScopeSave||!e||!e.CurrentStepId||"undefined"==typeof angular){var t=p.Promesses.getServiceDePromesse().defer();return p.Loggers.FLASH.INSTANCE.setValue("action","InitialiserDonneesScope"),i.logger.debug("sauvegarde scope non utilisable"),t.resolve(!1),t.promise}i.logger.warn("InitialiserDonneesScope - Restauration du scope, log pour remonter sur Kibana qui utilise cette fonctionnalité");var r=this,o=!1;return this.GetFromContext("donneesScope").then(function(e){if(e)try{var s=JSON.parse(e),a=n._getAngularScope();if(a||r.sauvegardeScopeParam.scopeType!==c.ScopeType.View&&r.sauvegardeScopeParam.scopeType!==c.ScopeType.Root){if(r.sauvegardeScopeParam.scopeType===c.ScopeType.View){if(1==n.sauvegardeScopeParam.donneesScopeASauvegarder.length&&"*"===n.sauvegardeScopeParam.donneesScopeASauvegarder[0])for(var t in s)p.CoreCommon.applyProperties(s,a,t);else n.sauvegardeScopeParam.donneesScopeASauvegarder.forEach(function(e,t){var n=e.split(".");if(1===n.length)p.CoreCommon.applyProperties(s,a,t);else{var r=a,o={};n.forEach(function(e,t){0===t?(r[e]||(r[e]={}),o=s[e],r=r[e]):t===n.length-1?p.CoreCommon.applyProperties(o,r,e):(r[e]||(r[e]={}),o=o[e],r=r[e])})}});a.$apply()}else r.sauvegardeScopeParam.scopeType===c.ScopeType.Root?(n._setScope(a,s),a.$apply()):r.sauvegardeScopeParam.scopeType===c.ScopeType.Service&&n._setServices(s);o=!0}else p.Loggers.FLASH.INSTANCE.setValue("action","InitialiserDonneesScope"),i.logger.warn("pas de scope trouvé sur la vue")}catch(e){p.Loggers.FLASH.INSTANCE.setValue("action","InitialiserDonneesScope"),i.logger.error("Problème lors de l'initialisation des données du scope : %1",e.toString())}return o})},i.prototype.sendNotification=function(e){return this.library.Core.sendNotification(e),e&&"fin d etape"===e.Sujet&&this.SauvegarderDonneesScope(),p.Promesses.getPromesseSelfResoved()},i.prototype.reception=function(e){switch(e.subject){case c.ContextMessageSubject.Notification:var t=e.message;return this.sendNotification(t);case c.ContextMessageSubject.AnalyseApp:var n=this.AnalyseApp(),r=p.Promesses.getServiceDePromesse().defer();return r.resolve(n),r.promise;default:return o.prototype.reception.call(this,e)}},i.prototype.AnalyseApp=function(){if("undefined"==typeof angular)return null;for(var e=new c.AnalyseResult,t=document.getElementsByClassName("ng-scope"),n=0,r=[].slice.call(t);n<r.length;n++){var o=r[n],s=o.localName+this.getId(o)+this.getClasses(o),a=angular.element(o).scope();if(a)if(a.$$watchers){var i=a.$$watchers.length;e.TotalWatchers+=i,e.WatcherByScope.push(new c.AnalyseScope(s,i))}else e.WatcherByScope.push(new c.AnalyseScope(s,0))}return e.TotalWatchers2=this.CountWatcher2(),e.TotalWatchers3=this.CountWatcher3(),e},i.prototype.CountWatcher2=function(){var e=angular.element(document.getElementsByTagName("body")),n=[],r=function(t){angular.forEach(["$scope","$isolateScope"],function(e){t.data()&&t.data().hasOwnProperty(e)&&angular.forEach(t.data()[e].$$watchers,function(e){n.push(e)})}),angular.forEach(t.children(),function(e){r(angular.element(e))})};r(e);var t=[];return angular.forEach(n,function(e){t.indexOf(e)<0&&t.push(e)}),t.length},i.prototype.CountWatcher3=function(){var e=this.getAllElementsWithAttribute("ng-controller"),n=0;return e&&e.forEach(function(e){var t=angular.element(e).scope();t&&t.$$watchers&&(n+=t.$$watchers.length)}),n},i.prototype.SetContextListener=function(e,t){this._listenedKey=e,this._listernerCallback=t},i.prototype._checkKey=function(e){var t=!1;return this._listenedKey&&this._listernerCallback&&e===this._listenedKey&&(this._listernerCallback(),t=!0),t},i.prototype._checkKeys=function(e){for(var t=!1,n=0,r=e;n<r.length;n++){var o=r[n];if(this._checkKey(o.Key)){t=!0;break}}return t},i.CLASS_NAME="MyWay.Services.Context.ContextAgent",i.logger=p.Loggers.LoggerFactory.INSTANCE.getClass(i.CLASS_NAME),i}(p.Components.ComponentAgentBase);c.ContextAgent=e,p.Components.RegistryAgent.getInstance().register(e)})((p=e.Services||(e.Services={})).Context||(p.Context={}))}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).ServiceAgentExtended.prototype.OnContextEvent=function(){t.ServiceAgentExtended.logger_extended.info("Ajout au contexte de %1",this._listenedKey),t.ServiceAgentProvider._serviceAgentExtended._diagnostic.userTime=Date.now(),this.library.Context.SetContextListener(null,null)},t.ServiceAgentExtended.prototype.addToSharedContext=function(e,t){try{var n=this.$q.defer();return this.Context.AddToSharedContext(e,t).then(function(){n.resolve()},function(){n.reject()}),n.promise}catch(e){throw new Error("context pas initialise !")}},t.ServiceAgentExtended.prototype.removeFromSharedContext=function(e){try{var t=this.$q.defer();return this.Context.RemoveFromSharedContext(e).then(function(){t.resolve()},function(){t.reject()}),t.promise}catch(e){throw new Error("context pas initialise !")}},t.ServiceAgentExtended.prototype.addToContext=function(e,t){try{var n=this.$q.defer();return this.Context.AddToContext(e,t).then(function(){n.resolve()},function(){n.reject()}),n.promise}catch(e){throw new Error("context pas initialise !")}},t.ServiceAgentExtended.prototype.addListToContext=function(e){try{var t=this.$q.defer(),n=[];return angular.forEach(e,function(e,t){n.push({Key:t,Value:e})}),this.Context.AddListToContext(n).then(function(){t.resolve()},function(){t.reject()}),t.promise}catch(e){throw new Error("context pas initialise !")}},t.ServiceAgentExtended.prototype.getFromContext=function(e,t){var n=this;try{var r=this.$q.defer();return this.Context.GetFromContext(e).then(function(e){t&&(e=n.instanceLoaderService.createInstance(t,e)),r.resolve(e)},function(){r.reject()}),r.promise}catch(e){throw new Error("context pas initialise !")}},t.ServiceAgentExtended.prototype.getFromSharedContext=function(e,t){var n=this;try{var r=this.$q.defer();return this.Context.GetFromSharedContext(e).then(function(e){t&&(e=n.instanceLoaderService.createInstance(t,e)),r.resolve(e)},function(){r.reject()}),r.promise}catch(e){throw new Error("context pas initialise !")}},t.ServiceAgentExtended.prototype.getListFromContext=function(e){try{var t=this.$q.defer();return this.Context.GetListFromContext(e).then(function(e){t.resolve(e)},function(){t.reject()}),t.promise}catch(e){throw new Error("context pas initialise !")}},t.ServiceAgentExtended.prototype.getAuthentificationInfo=function(){try{var t=this.$q.defer();return this.Context.GetAuthentificationInfo().then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise}catch(e){throw new Error("context pas initialise !")}},t.ServiceAgentExtended.prototype.getParametresComptables=function(){try{var t=this.$q.defer();return this.Context.GetParametresComptables().then(function(e){t.resolve(e)},function(e){t.reject(e)}),t.promise}catch(e){throw new Error(e)}}}(MyWay||(MyWay={})),function(e){var s;(s=e.Services||(e.Services={})).Core.defineProperty(s.ServiceAgent,"Step",{get:function(){return this.Library.Context.StepInfo}}),s.ServiceAgent.prototype.SendRequest=function(e){var o=this;return s.Promesses.promesseTryCatch(function(t){var n=o,r=e;r.logger=s.ServiceAgent.logger,n.Library&&n.Library.Context&&n.Library.Context.StepInfo?(r.stepInfo=n.Library.Context.StepInfo,r.versionComposant=r.stepInfo.VersionComposant):n.Library&&n.Library.Context&&(r.stepInfo=null,r.versionComposant=n.Library.Context.VersionComposant),e.withHeaders?n.Context.GetAuthentificationInfo().then(function(e){r.authentificationInfo=e,n.Library.Context.GetParametresComptables().then(function(e){r.parametresComptables=e,s.CoreCommon.SendRequest(r,function(e){t.resolve(e)},function(e){t.reject(e)})}).catch(t.reject)}).catch(t.reject):s.CoreCommon.SendRequest(r,function(e){t.resolve(e)},function(e){t.reject(e)})})}}(MyWay||(MyWay={})),function(e){var r,o,t;r=e.Services||(e.Services={}),o=r.Display||(r.Display={}),t=function(t){function n(){var e=t.call(this,r.Components.ComponentType.Display)||this;return e.myIFrameId=null,e}return __extends(n,t),n.prototype.getMyIFrameId=function(){return this.myIFrameId},n.prototype.reception=function(e){switch(e.subject){case o.DisplayMessageSubject.Refresh:return e.message,this.Refresh(),r.Promesses.getPromesseSelfResoved();default:return t.prototype.reception.call(this,e)}},n.prototype.Refresh=function(){try{angular.element(document.body).injector().get("$route").reload()}catch(e){r.Loggers.FLASH.INSTANCE.setValue("details",e),n.logger.warn("Reload failed")}},n.prototype.RedirectInStep=function(e){return this.sendMessage(o.DisplayMessageSubject.RedirectInStep,{}).then(function(e){window.location.href=e})},n.prototype.PrepareSubmit=function(e){return this.sendMessage(o.DisplayMessageSubject.PrepareSubmit,{url:e})},n.prototype.redirect=function(e,t){return void 0===e&&(e=null),void 0===t&&(t=null),this.sendMessage(o.DisplayMessageSubject.Redirect,{url:e,previousUrl:t})},n.prototype.displayMessage=function(e){return this.sendMessage(o.DisplayMessageSubject.DisplayMessage,{message:e})},n.CLASS_NAME="MyWay.Services.Display.DisplayAgent",n.logger=r.Loggers.LoggerFactory.INSTANCE.getClass(n.CLASS_NAME),n}(r.Components.ComponentAgentBase),o.DisplayAgent=t,r.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),function(e){(e.Services||(e.Services={})).ServiceAgent.prototype.DisplayMessage=function(e){this.Library&&this.Library.Display?this.Library.Display.displayMessage(e):console.error("Erreur de chargement avant l'initialisation du service agent : ",e)}}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-context-display-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var n,t,r;n=e.Services||(e.Services={}),t=n.Context||(n.Context={}),r=function(){function e(){this.libraryManager=null,this.portalServiceParameters=null}return e.prototype.init=function(e,t){this.libraryManager=e,this.portalServiceParameters=t},e.prototype.GetDonneesLocales=function(){return n.Promesses.promesseTryCatch(function(e){e.resolve(null)})},e.prototype.ShareProcess=function(e,t){return n.Promesses.promesseTryCatch(function(e){e.resolve()})},e.prototype.RemoveProcess=function(e){return n.Promesses.promesseTryCatch(function(e){e.resolve(null)})},e.prototype.GetInfosUserApi=function(){return n.Promesses.promesseTryCatch(function(e){e.resolve(null)})},e.prototype.GetPortalInformation=function(e){var t="";return e&&(t=e.codeEtablissement),n.CoreCommon.SendRequestWithPromise({url:n.PrivatePortalServiceParameters.Instance().PortalInfoUrl+"/urlCultureNet?codeEtablissement="+t,withHeaders:!0,authentificationInfo:e}).then(function(e){return e&&e.donnee?{urlCultureNet:e.donnee}:null})},e.prototype.warnLocalServiceUnavailability=function(){return e.loggerContextApiBase.warn("Le service local n'a pu être joint et a été désactivé. Veuillez redémarrer le service local et recharger le portail"),n.Promesses.createPromiseSelfError(new n.Erreur("Le service local n'a pu être joint et a été désactivé. Veuillez redémarrer le service local et recharger le portail"))},e.CLASS_NAMEContextApiBase="MyWay.Services.Context.ContextApiWindows",e.loggerContextApiBase=n.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAMEContextApiBase),e}(),t.ContextApiBase=r}(MyWay||(MyWay={})),function(e){var t,s,n;t=e.Services||(e.Services={}),s=t.Context||(t.Context={}),n=function(o){function e(){return o.call(this,t.Components.ComponentType.Context)||this}return __extends(e,o),e.prototype.init=function(e,t,n){var r=this;return e.ServiceLocal?this.api=new s.ContextApiWindows:this.api=new s.ContextApiFullWeb,o.prototype.init.call(this,e,t,n).then(function(){r.api.init(t,n.portalServiceParameters)})},e.prototype.GetDonneesLocales=function(){return this.api.GetDonneesLocales()},e.prototype.ShareProcess=function(e,t){return this.api.ShareProcess(e,t)},e.prototype.RemoveProcess=function(e){return this.api.RemoveProcess(e)},e.prototype.GetInfosUserApi=function(){return this.api.GetInfosUserApi()},e.prototype.GetPortalInformation=function(e){return this.api.GetPortalInformation(e)},e}(t.Components.ComponentApiBase),s.ContextApiFactory=n,t.Components.RegistryApi.getInstance().register(n)}(MyWay||(MyWay={})),function(e){var s,t,n;s=e.Services||(e.Services={}),t=s.Context||(s.Context={}),n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.infosBaseToDonneesLocales=function(e,t,n){return{AuthentificationInfo:{agentConnecte:{referenceExterneAgent:n,adresseMessagerie:null,codeCivilite:null,codeIndicateurFinStructure:null,codeInseePays:null,codeQualiteAgent:null,dateDebutValidite:null,dateDebutValiditeReferentiel:null,dateFinValidite:null,designationLongueAgent:null,designationPosteFonctionnel:null,identifiantInterneSite:null,libelleEds:null,libelleTypeEds:null,LICEE1:null,ligne2Adresse:null,ligne3Adresse:null,ligne4Adresse:null,ligne5Adresse:null,ligne6Adresse:null,NODATP:null,nomFamillePersonnePhysique:null,nomUsagePersonnePhysique:null,numeroEdsSuperieur:null,numeroExterneEds:null,numeroInterneEds:null,prenom:null,referenceExterneEdsRattachemen:null,typeEds:null,typeEdsRattachement:null,typeFonction:null},codeEtablissement:e,numeroStationTravail:t,ENVIRON:null,guichetAgent:null},ParametresComptables:null,ParametresNumerisation:null,ParametresServeurPoste:null}},t.prototype.getFromUrl=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?null:decodeURIComponent(t[1].replace(/\+/g," "))},t.prototype.GetDonneesLocales=function(){var e=this.getFromUrl("authent");if(e){var t=JSON.parse(e),n=t.codeEtablissement||null,r=t.identifiantPoste||null,o=t.identifiantConnexionAgent||null;return n&&o&&r?(/([0-9]+)$/.test(o)&&(o=/([0-9]+)$/.exec(o)[0]),s.Promesses.createPromiseSelfResolved(this.infosBaseToDonneesLocales(n,r,o))):s.Promesses.createPromiseSelfResolved(null)}return s.Promesses.createPromiseSelfResolved(null)},t.prototype.ShareProcess=function(e,t){return s.Promesses.promesseTryCatch(function(e){e.resolve()})},t.prototype.RemoveProcess=function(e){return s.Promesses.promesseTryCatch(function(e){e.resolve(null)})},t.prototype.GetInfosUserApi=function(){return s.Promesses.promesseTryCatch(function(e){e.resolve(null)})},t}(t.ContextApiBase),t.ContextApiFullWeb=n}(MyWay||(MyWay={})),function(e){var r,t,n;r=e.Services||(e.Services={}),t=r.Context||(r.Context={}),n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.GetDonneesLocales=function(){return r.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():this.libraryManager.Core.sendRequest({url:r.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/contexte/GetDonneesLocales",contentType:r.ContentTypeEnum.JSON,method:r.MethodEnum.GET,async:!1,cache:!1}).catch(function(e){throw t.logger.error("Erreur de récupération des informations d'authentification de l'agent depuis le service local"),e})},t.prototype.ShareProcess=function(e,t){var n={Id:null,CodeAgent:t,Name:e.displayName,AddedDateAsLong:e.putInWaitTime,SerializedTask:JSON.stringify(e)};return this.libraryManager.Core.sendRequest({url:r.PrivatePortalServiceParameters.Instance().ShareServiceUrl+"/api/Task",method:r.MethodEnum.POST,data:n,withHeaders:!1})},t.prototype.RemoveProcess=function(e){return this.libraryManager.Core.sendRequest({url:r.PrivatePortalServiceParameters.Instance().ShareServiceUrl+"/api/Task?id="+e,method:r.MethodEnum.DELETE,withHeaders:!1}).then(function(e){return JSON.parse(e)})},t.prototype.GetInfosUserApi=function(){return r.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():this.libraryManager.Core.sendRequest({url:r.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/contexte/GetInfosUserPoste",type:"GET",async:!1,method:r.MethodEnum.GET,contentType:r.ContentTypeEnum.JSON,cache:!1})},t.CLASS_NAME="MyWay.Services.Context.ContextApiWindows",t.logger=r.Loggers.LoggerFactory.INSTANCE.getClass(t.CLASS_NAME),t}(t.ContextApiBase),t.ContextApiWindows=n}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-context-display-api.min.js.map
var MyWay;!function(e){var o,n;o=e.Services||(e.Services={}),((n=o.Components||(o.Components={})).ComponentType||(n.ComponentType={})).BriqueCommunication="BriqueCommunication"}(MyWay||(MyWay={})),function(e){var o,n;o=e.Services||(e.Services={}),(n=o.BriqueCommunication||(o.BriqueCommunication={})).BriqueCommunicationMessageSubject||(n.BriqueCommunicationMessageSubject={})}(MyWay||(MyWay={})),function(e){var o;(o=e.Services||(e.Services={})).Bug||(o.Bug={})}(MyWay||(MyWay={})),function(e){var o,n,E,t;o=e.Services||(e.Services={}),n=o.BriqueCommunication||(o.BriqueCommunication={}),E=n.Messages||(n.Messages={}),(t=E.EVENT_TYPE||(E.EVENT_TYPE={}))[t.CHAT=1]="CHAT",t[t.NOTIFICATION=2]="NOTIFICATION"}(MyWay||(MyWay={})),function(e){var o,n;o=e.Services||(e.Services={}),((n=o.Components||(o.Components={})).ComponentType||(n.ComponentType={})).Chat="Chat"}(MyWay||(MyWay={})),function(e){var o,n,E,t;o=e.Services||(e.Services={}),n=o.BriqueCommunication||(o.BriqueCommunication={}),E=n.Chat||(n.Chat={}),(t=E.ChatMessageSubject||(E.ChatMessageSubject={}))[t.OpenChatroom=0]="OpenChatroom",t[t.OpenChat=1]="OpenChat",t[t.SendMessage=2]="SendMessage",t[t.CloseChat=3]="CloseChat",t[t.GetUtilisateurs=4]="GetUtilisateurs",t[t.EnvoyerMessageVideoroom=5]="EnvoyerMessageVideoroom",t[t.ReceptionMessageVideoroom=6]="ReceptionMessageVideoroom",t[t.GetChatrooms=7]="GetChatrooms",t[t.GetChatroom=8]="GetChatroom",t[t.PrendreLaMainVideoroom=9]="PrendreLaMainVideoroom",t[t.DemarrerVideoChatroom=10]="DemarrerVideoChatroom",t[t.ArreterVideoChatroom=11]="ArreterVideoChatroom",t[t.AccepterDemanderExpert=12]="AccepterDemanderExpert",t[t.InviterPersonnesAUneChatroom=13]="InviterPersonnesAUneChatroom",t[t.SetStatut=14]="SetStatut",t[t.AddChatCapacity=15]="AddChatCapacity",t[t.WebRTC=16]="WebRTC",o.Components.FactoryRegistries.getInstance().declareComponent(o.Components.ComponentType.BriqueCommunication,[o.Components.ComponentType.Context]),o.Components.FactoryRegistries.getInstance().declareComponent(o.Components.ComponentType.Chat,[o.Components.ComponentType.BriqueCommunication,o.Components.ComponentType.Context,o.Components.ComponentType.Core,o.Components.ComponentType.Display,o.Components.ComponentType.Evennements,o.Components.ComponentType.Persistence])}(MyWay||(MyWay={})),function(e){var o;(o=e.Services||(e.Services={})).Bug||(o.Bug={})}(MyWay||(MyWay={})),function(e){var o,n,E,t,C,T,i,a;o=e.Services||(e.Services={}),n=o.BriqueCommunication||(o.BriqueCommunication={}),E=n.Chat||(n.Chat={}),t=E.Messages||(E.Messages={}),(C=t.TYPE||(t.TYPE={}))[C.OPEN_CHATROOM=1]="OPEN_CHATROOM",C[C.OPEN_CHAT=2]="OPEN_CHAT",C[C.SEND_MESSAGE=3]="SEND_MESSAGE",C[C.CLOSE_CHAT=4]="CLOSE_CHAT",C[C.GET_UTILISATEURS=5]="GET_UTILISATEURS",C[C.ENVOYER_MESSAGE_VIDEOROOM=6]="ENVOYER_MESSAGE_VIDEOROOM",C[C.RECEPTION_MESSAGE_VIDEOROOM=7]="RECEPTION_MESSAGE_VIDEOROOM",C[C.GET_CHATROOMS=8]="GET_CHATROOMS",C[C.GET_CHATROOM=16]="GET_CHATROOM",C[C.PRENDRE_LA_MAIN_VIDEOROOM=9]="PRENDRE_LA_MAIN_VIDEOROOM",C[C.DEMARRER_VIDEO_CHATROOM=10]="DEMARRER_VIDEO_CHATROOM",C[C.ARRETER_VIDEO_CHATROOM=11]="ARRETER_VIDEO_CHATROOM",C[C.ACCEPTER_DEMANDE_EXPERT=12]="ACCEPTER_DEMANDE_EXPERT",C[C.INVITER_PERSONNES_A_UNE_CHATROOM=13]="INVITER_PERSONNES_A_UNE_CHATROOM",C[C.SET_STATUT=14]="SET_STATUT",C[C.ADD_CHAT_CAPACITY=15]="ADD_CHAT_CAPACITY",(T=t.EVENT_TYPE||(t.EVENT_TYPE={}))[T.MESSAGE_RECU=1]="MESSAGE_RECU",T[T.CHAT_FERME=2]="CHAT_FERME",T[T.CHAT_OUVERT=3]="CHAT_OUVERT",T[T.MISE_A_JOUR_LISTE_UTILISATEURS=4]="MISE_A_JOUR_LISTE_UTILISATEURS",T[T.UTILISATEUR_CONNECTE_A_CHAT=5]="UTILISATEUR_CONNECTE_A_CHAT",T[T.UTILISATEUR_DECONNECTE_A_CHAT=6]="UTILISATEUR_DECONNECTE_A_CHAT",T[T.CHANGEMENT_MAIN_CHATROOM=7]="CHANGEMENT_MAIN_CHATROOM",T[T.DEMANDE_EXPERT=8]="DEMANDE_EXPERT",T[T.FIN_DEMANDE_EXPERT=9]="FIN_DEMANDE_EXPERT",T[T.CHAT_DIV_ELEMENT=10]="CHAT_DIV_ELEMENT",T[T.FIN_VIDEOROOM=11]="FIN_VIDEOROOM",(i=t.UTILISATEUR_TYPE||(t.UTILISATEUR_TYPE={}))[i.CONSEILLER=0]="CONSEILLER",i[i.EXPERT=1]="EXPERT",i[i.CLIENT=2]="CLIENT",i[i.PROSPECT=3]="PROSPECT",(a=t.UTILISATEUR_STATUT||(t.UTILISATEUR_STATUT={}))[a.CONNECTE=1]="CONNECTE",a[a.DECONNECTE=2]="DECONNECTE"}(MyWay||(MyWay={})),function(e){var o,n,E;o=e.Services||(e.Services={}),n=o.BriqueCommunication||(o.BriqueCommunication={}),function(e){var o;(o=e.TYPE||(e.TYPE={}))[o.ABONNEMENT=1]="ABONNEMENT",o[o.DESABONNEMENT=2]="DESABONNEMENT",o[o.GET_LISTE_SUJETS=3]="GET_LISTE_SUJETS";var n=function(){};e.INotificationMessageAbonnementRequest=n;var E=function(){};e.INotificationMessageDesabonnementRequest=E;var t,C=function(){};e.INotificationMessageListeSujetsResponse=C,(t=e.EVENT_TYPE||(e.EVENT_TYPE={}))[t.NOUVEL_ABONNEMENT=1]="NOUVEL_ABONNEMENT",t[t.DESABONNEMENT=2]="DESABONNEMENT",t[t.NOTIFICATION_MESSAGE=3]="NOTIFICATION_MESSAGE"}((E=n.Notification||(n.Notification={})).Messages||(E.Messages={}))}(MyWay||(MyWay={})),function(e){var o,n;o=e.Services||(e.Services={}),((n=o.Components||(o.Components={})).ComponentType||(n.ComponentType={})).Notification="Notification"}(MyWay||(MyWay={})),function(e){var o,n,E,t;o=e.Services||(e.Services={}),n=o.BriqueCommunication||(o.BriqueCommunication={}),E=n.Notification||(n.Notification={}),(t=E.NotificationMessageSubject||(E.NotificationMessageSubject={}))[t.Abonnement=0]="Abonnement",t[t.Desabonnement=1]="Desabonnement",t[t.GetListeSubjects=2]="GetListeSubjects",o.Components.FactoryRegistries.getInstance().declareComponent(o.Components.ComponentType.Notification,[o.Components.ComponentType.BriqueCommunication,o.Components.ComponentType.Context,o.Components.ComponentType.Core,o.Components.ComponentType.Evennements,o.Components.ComponentType.Persistence])}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-brique-communication-common.min.js.map
var MyWay;!function(e){var i,y;i=e.Services||(e.Services={}),((y=i.Components||(i.Components={})).ComponentType||(y.ComponentType={})).Mobilite="Mobilite"}(MyWay||(MyWay={})),function(e){var i,y,t,r;i=e.Services||(e.Services={}),y=i.Mobilite||(i.Mobilite={}),t=y.Messages||(y.Messages={}),(r=t.MobiliteMessageSubject||(t.MobiliteMessageSubject={}))[r.GetInfoMachine=0]="GetInfoMachine",r[r.GetPeripheriques=1]="GetPeripheriques",r[r.GetPeripheriquesParType=2]="GetPeripheriquesParType",r[r.GetReseau=3]="GetReseau",i.Components.FactoryRegistries.getInstance().declareComponent(i.Components.ComponentType.Mobilite,[i.Components.ComponentType.Context,i.Components.ComponentType.Core])}(MyWay||(MyWay={})),function(e){var i,y,t;i=e.Services||(e.Services={}),y=i.Mobilite||(i.Mobilite={}),t=function(){this.typePeripherique=y.TYPE_PERIPHERIQUE.CAISSE_AUTO},y.CaisseAuto=t}(MyWay||(MyWay={})),function(e){var i,y,t;i=e.Services||(e.Services={}),y=i.Mobilite||(i.Mobilite={}),(t=y.PLATEFORME||(y.PLATEFORME={}))[t.MYSYS=1]="MYSYS",t[t.WINDOWS=2]="WINDOWS",t[t.APPLE=3]="APPLE",t[t.ANDROID=4]="ANDROID",t[t.AUTRE=99]="AUTRE"}(MyWay||(MyWay={})),function(e){var i,y,t,r;i=e.Services||(e.Services={}),y=i.Mobilite||(i.Mobilite={}),(r=t=y.TYPE_PERIPHERIQUE||(y.TYPE_PERIPHERIQUE={}))[r.TABLETTE_SIGNATURE=0]="TABLETTE_SIGNATURE",r[r.CAISSE_AUTO=1]="CAISSE_AUTO",y.TypePeripherique=t}(MyWay||(MyWay={})),function(e){var i,y,t;i=e.Services||(e.Services={}),y=i.Mobilite||(i.Mobilite={}),(t=y.TYPE_RESEAU||(y.TYPE_RESEAU={}))[t.DECONNECTE=0]="DECONNECTE",t[t.VPN=10]="VPN",t[t.WIFI_AGENCE=20]="WIFI_AGENCE",t[t.FILAIRE=30]="FILAIRE",t[t.CONNECTE=99]="CONNECTE",t[t.INCONNU=99]="INCONNU"}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Mobilite||(i.Mobilite={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Mobilite||(i.Mobilite={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Mobilite||(i.Mobilite={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Mobilite||(i.Mobilite={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Mobilite||(i.Mobilite={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Mobilite||(i.Mobilite={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i,y,t;i=e.Services||(e.Services={}),y=i.Mobilite||(i.Mobilite={}),(t=y.RECUP_INFO||(y.RECUP_INFO={}))[t.FICHIER=0]="FICHIER",t[t.DETECTION=1]="DETECTION"}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i,r,y;i=e.Services||(e.Services={}),r=i.Mobilite||(i.Mobilite={}),y=function(e,i,y,t){this.typePeripherique=r.TYPE_PERIPHERIQUE.TABLETTE_SIGNATURE,this.type=e,this.modele=i,this.codeModele=y,this.idMateriel=t},r.TabletteSignature=y}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-mobilite-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var c=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,i){e.__proto__=i}||function(e,i){for(var n in i)i.hasOwnProperty(n)&&(e[n]=i[n])};return function(e,i){function n(){this.constructor=e}c(e,i),e.prototype=null===i?Object.create(i):(n.prototype=i.prototype,new n)}}();!function(e){var i,n;i=e.Services||(e.Services={}),((n=i.Components||(i.Components={})).ComponentType||(n.ComponentType={})).Acquisition="Acquisition"}(MyWay||(MyWay={})),function(e){var i,n,c,r;i=e.Services||(e.Services={}),n=i.Acquisition||(i.Acquisition={}),(c=n.Messages||(n.Messages={})).START_STATE="start",c.END_STATE="finish",c.ERROR="error",(r=c.AcquisitionMessageSubject||(c.AcquisitionMessageSubject={}))[r.AppelRADLAD=0]="AppelRADLAD",r[r.ChangeState=1]="ChangeState",r[r.ConvertBase64ToBin=2]="ConvertBase64ToBin",r[r.ConvertFileToImg=3]="ConvertFileToImg",r[r.FermetureSpiFactory=4]="FermetureSpiFactory",r[r.GetDocumentGEDAtAndOpen=5]="GetDocumentGEDAtAndOpen",r[r.GetDocumentGEDAndOpen=6]="GetDocumentGEDAndOpen",r[r.GetDocumentGEDAndSave=7]="GetDocumentGEDAndSave",r[r.GetProcessingTask=8]="GetProcessingTask",r[r.MergeAndOpenPDF=9]="MergeAndOpenPDF",r[r.MergerEtArchiver=10]="MergerEtArchiver",r[r.MergerEtUploader=11]="MergerEtUploader",r[r.OuvrirListeDocumentGED=12]="OuvrirListeDocumentGED",r[r.Purge=13]="Purge",r[r.RecupereListeDocumentGED=14]="RecupereListeDocumentGED",r[r.SetConfigurationScanner=15]="SetConfigurationScanner",r[r.GetListeScanner=16]="GetListeScanner",r[r.IsPrisEnMainADistance=17]="IsPrisEnMainADistance",r[r.UploadDocumentFrom=18]="UploadDocumentFrom",r[r.IsDocumentSigne=19]="IsDocumentSigne",i.Components.FactoryRegistries.getInstance().declareComponent(i.Components.ComponentType.Acquisition,[i.Components.ComponentType.Context])}(MyWay||(MyWay={})),function(e){var i,n,c;i=e.Services||(e.Services={}),n=i.Acquisition||(i.Acquisition={}),(c=n.ACQUISITION_TYPE||(n.ACQUISITION_TYPE={}))[c.BINARY=0]="BINARY",c[c.BASE64=1]="BASE64"}(MyWay||(MyWay={})),function(e){var i,n,c;i=e.Services||(e.Services={}),n=i.Acquisition||(i.Acquisition={}),(c=n.BINARIZE_METHOD||(n.BINARIZE_METHOD={}))[c.SIMPLE_THRESHOLD=0]="SIMPLE_THRESHOLD",c[c.GLOBAL_THRESHOLD=1]="GLOBAL_THRESHOLD",c[c.ADAPTIVE_THRESHOLD=2]="ADAPTIVE_THRESHOLD",c[c.DYNAMIC_THRESHOLD=3]="DYNAMIC_THRESHOLD"}(MyWay||(MyWay={})),function(e){var i,n,c;i=e.Services||(e.Services={}),n=i.Acquisition||(i.Acquisition={}),(c=n.FILE_FORMAT||(n.FILE_FORMAT={}))[c.BMP=0]="BMP",c[c.PNG=1]="PNG",c[c.GIF=2]="GIF",c[c.JPG_JPEG=3]="JPG_JPEG",c[c.PDF=4]="PDF",c[c.TIF_TIFF=5]="TIF_TIFF"}(MyWay||(MyWay={})),function(e){var i,n,c;i=e.Services||(e.Services={}),n=i.Acquisition||(i.Acquisition={}),(c=n.FORMAT_MERGE||(n.FORMAT_MERGE={}))[c.PDF=0]="PDF",c[c.ZIP=1]="ZIP"}(MyWay||(MyWay={})),function(e){var i,n,c;i=e.Services||(e.Services={}),n=i.Acquisition||(i.Acquisition={}),(c=n.OUVERTURE_ARCHIVE||(n.OUVERTURE_ARCHIVE={}))[c.NATIVE=0]="NATIVE",c[c.OUTLOOK=1]="OUTLOOK"}(MyWay||(MyWay={})),function(e){var i,n,c;i=e.Services||(e.Services={}),n=i.Acquisition||(i.Acquisition={}),(c=n.ROTATION_VALUES||(n.ROTATION_VALUES={}))[c.ANGLE_90=90]="ANGLE_90",c[c.ANGLE_180=180]="ANGLE_180",c[c.ANGLE_270=270]="ANGLE_270"}(MyWay||(MyWay={})),function(e){var i,n,c;i=e.Services||(e.Services={}),n=i.Acquisition||(i.Acquisition={}),(c=n.LOCALISATION_SCANNER||(n.LOCALISATION_SCANNER={}))[c.SCANNER_DISTANT=0]="SCANNER_DISTANT",c[c.SCANNER_LOCAL=1]="SCANNER_LOCAL",c[c.NONE=2]="NONE"}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i,n;i=e.Services||(e.Services={}),n=function(){},(i.Acquisition||(i.Acquisition={})).IConvertFileParams=n}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i,n;i=e.Services||(e.Services={}),n=function(){},(i.Acquisition||(i.Acquisition={})).ICreerImageBitonalParams=n}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i,n;i=e.Services||(e.Services={}),n=function(){},(i.Acquisition||(i.Acquisition={})).IPdfParams=n}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i,n,c;i=e.Services||(e.Services={}),n=i.Acquisition||(i.Acquisition={}),c=function(e){function i(){return null!==e&&e.apply(this,arguments)||this}return __extends(i,e),i}(n.IPdfParams),n.IGuidParams=c}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i,n;i=e.Services||(e.Services={}),n=function(){},(i.Acquisition||(i.Acquisition={})).IRadladParams=n}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i,n;i=e.Services||(e.Services={}),n=function(){},(i.Acquisition||(i.Acquisition={})).IScannerAccessibleResult=n}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={})),function(e){var i,n;i=e.Services||(e.Services={}),n=function(){},(i.Acquisition||(i.Acquisition={})).IProcessingTasks=n}(MyWay||(MyWay={})),function(e){var i;(i=e.Services||(e.Services={})).Bug||(i.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-acquisition-common.min.js.map
var MyWay;!function(e){var o;(function(e){var s=function(){function e(){this.StorageNotification=null,this._setMessages(),this._messages||this._init()}return e.prototype._setMessages=function(){o.Storage.InteropMessageBusStorage&&o.Storage.InteropMessageBusStorage.Get()?this._messages=JSON.parse(o.Storage.InteropMessageBusStorage.Get()):this._messages=[]},e.prototype._init=function(){this._messages=[],o.Storage.InteropMessageBusStorage.Set(JSON.stringify(this._messages)),this.Notify()},e.prototype.Notify=function(){this.StorageNotification&&this.StorageNotification.saveValue(Math.random())},e.prototype.Add=function(e){this._setMessages(),this._messages.push(e),o.Storage.InteropMessageBusStorage.Set(JSON.stringify(this._messages)),this.Notify()},e.prototype.SpliceByStepId=function(e){this._setMessages();for(var s=[],t=this._messages.length-1;0<=t;t--)this._messages[t].ProcessStepId==e&&s.push(this._messages.splice(t)[0]);return o.Storage.InteropMessageBusStorage.Set(JSON.stringify(this._messages)),0<s.length&&this.Notify(),s},e.prototype.Clear=function(){o.Storage.InteropMessageBusStorage.Set(""),this.Notify(),this._init()},Object.defineProperty(e.prototype,"Messages",{get:function(){return this._setMessages(),this._messages},enumerable:!0,configurable:!0}),e}();e.InteropMessageBus=s;var t=function(){};e.InteropMessageEvent=t})((o=e.Services||(e.Services={})).Interop||(o.Interop={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-interop-business-object.min.js.map
var MyWay;!function(e){var r;(r=e.Services||(e.Services={})).Core.defineProperty(r.PhantomAgent,"Dates",{get:function(){return this._serviceManager.Library.Dates}})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-dates-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var e,s,n;e=t.Services||(t.Services={}),s=e.Persistence||(e.Persistence={}),n=function(i){function t(){var o=i.call(this,e.Components.ComponentType.Persistence)||this;return o.CURRENT_ID_EMETTEUR=null,o.keysWatched={},o.listener=function(t){var e=t.key;if(o.keysWatched[e]){var n=JSON.parse(t.newValue);n.emetteur!==o.CURRENT_ID_EMETTEUR&&o.keysWatched[e].forEach(function(t){t.onEvent(n.data)})}},o}return __extends(t,i),t.prototype.init=function(t,e,n,o){var r=this;return this.CURRENT_ID_EMETTEUR=Math.random().toString(),i.prototype.init.call(this,t,e,n,o).then(function(){return r.initialize()})},t.prototype.initialize=function(){window.addEventListener("storage",this.listener)},t.prototype.dispose=function(){return window.removeEventListener("storage",this.listener),i.prototype.dispose.call(this)},t.prototype.addStorage=function(e,t){var n=this,o=new s.StorageInstance(e,function(){n.removeListener(e,o)},function(t){n.addElementToStore(e,t)},t),r=this.keysWatched[e];return r||(r=[],this.keysWatched[e]=r),r.push(o),o},t.prototype.removeListener=function(t,e){if(this.keysWatched[t]){for(var n=this.keysWatched[t].length,o=!1,r=0;r<n-1;r++)o||this.keysWatched[t][r]!==e||(o=!0),o&&(this.keysWatched[t][r]=this.keysWatched[t][r+1]);(o||this.keysWatched[t][n-1]===e)&&this.keysWatched[t].length--}},t.prototype.addElementToStore=function(t,e){var n={data:e,emetteur:this.CURRENT_ID_EMETTEUR};window.localStorage.setItem(t,JSON.stringify(n))},t}(e.Components.ComponentManagerBase),s.PersistenceManager=n,e.Components.RegistryManager.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-persistence-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var n,t,r;n=e.Services||(e.Services={}),t=n.JAB||(n.JAB={}),r=function(o){function r(){var e=o.call(this,n.Components.ComponentType.JAB)||this;return e.api=null,e}return __extends(r,o),r.prototype.init=function(e,t,r,n){return this.api=n,o.prototype.init.call(this,e,t,r,n)},r.prototype.enregistrer=function(t){return this.api.enregistrer(t).then(function(e){return n.Loggers.FLASH.INSTANCE.setValue("details",t),r.logger.debug("JAB Enregister Success"),e},function(e){throw n.Loggers.FLASH.INSTANCE.setValue("details",t),r.logger.error("JAB Enregister Failed - %1",JSON.stringify(e)),e})},r.CLASS_NAME="MyWay.Services.JAB.JABManager",r.logger=n.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME),r}(n.Components.ComponentManagerBase),t.JABManager=r,n.Components.RegistryManager.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-jab-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var r,e,n;r=t.Services||(t.Services={}),e=r.TraitementNsdk||(r.TraitementNsdk={}),n=function(o){function n(){var t=o.call(this,r.Components.ComponentType.TraitementNsdk)||this;return t.api=null,t}return __extends(n,o),n.prototype.init=function(t,e,n,r){return this.api=r,o.prototype.init.call(this,t,e,n,r)},n.prototype.Lancer=function(t,e){return r.CoreCommon.ServiceDePromesse.defer(),this.api.lancer(t,e).then(function(t){return n.logger.debug("Lancement du traitement NSDK ok - %1",t),t},function(t){throw n.logger.error("Lancement du traitement NSDK échoué - %1",JSON.stringify(t)),t})},n.CLASS_NAME="MyWay.Services.TraitementNsdk.TraitementNsdkManager",n.logger=r.Loggers.LoggerFactory.INSTANCE.getClass(n.CLASS_NAME),n}(r.Components.ComponentManagerBase),e.TraitementNsdkManager=n,r.Components.RegistryManager.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-traitement-nsdk-manager.min.js.map
var MyWay;!function(y){var a;(a=y.Services||(y.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-test-manager-addon.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var n,i,t;n=e.Services||(e.Services={}),i=n.BaseDeDonnees||(n.BaseDeDonnees={}),t=function(s){function e(){return s.call(this,n.Components.ComponentType.BaseDeDonnees)||this}return __extends(e,s),e.prototype.init=function(e,n,t,o){var r=this;return s.prototype.init.call(this,e,n,t,o).then(function(){r.dbs={}})},e.prototype.enregistrerDB=function(e,n){this.dbs[e]=n},e.prototype.disposeDB=function(e){delete this.dbs[e]},e.prototype.getBases=function(){var o=[],e=function(e){var n=r.dbs[e],t={nom:e,implementation:null,version:n.version,tables:[]};switch(n.implementation){case i.BaseDeDonneesImplementation.INDEXEDDB:t.implementation=i.messages.TYPE_BASE.INDEXEDDB;break;case i.BaseDeDonneesImplementation.LOCALSTORAGE:t.implementation=i.messages.TYPE_BASE.LOCALSTORAGE;break;case i.BaseDeDonneesImplementation.MEMORY:t.implementation=i.messages.TYPE_BASE.MEMORY}n.getTables().forEach(function(e){t.tables.push({nom:e})}),o.push(t)},r=this;for(var n in this.dbs)e(n);return this.library.Core.createPromiseSelfResolved(o)},e.prototype.getBase=function(e){return this.dbs[e.nom]},e}(n.Components.ComponentManagerBase),i.BaseDeDonneesManager=t,n.Components.RegistryManager.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t,n;t=e.Services||(e.Services={}),function(i){i.indexeddbIsSupported=!1;var e=function(){function e(){}return e.testImplementationIndexeddb=function(n){return void 0===n&&(n=!1),t.CoreCommon.promesseTryCatch(function(s){function e(r){void 0===r&&(r=!1);var n=window.indexedDB.deleteDatabase("testIndexeddb");n.onsuccess=function(){var e=indexedDB.open("testIndexeddb",1);e.onupgradeneeded=function(e){var n=e.target.result;n.createObjectStore("one",{keyPath:"key"}),n.createObjectStore("two",{keyPath:"key"})},e.onerror=function(){},e.onsuccess=function(e){var n,t=e.target.result;try{n=t.transaction(["one","two"],"readwrite")}catch(e){return i.indexeddbIsSupported=!1,void s.resolve(!1)}n.oncomplete=function(e){t.close(),i.indexeddbIsSupported=!r||i.indexeddbIsSupported,s.resolve(!0)};var o=n.objectStore("two").put({key:(new Date).valueOf()});o.onsuccess=function(e){},o.onerror=function(){}},n.onerror=function(){s.reject(new t.Erreur("Impossible de supprimer la base de test qui sert de support au test d'implémentation d'indexeddb"))}}}n?e(n):null===i.indexeddbIsSupported?"undefined"==typeof indexedDB?(i.indexeddbIsSupported=!1,s.resolve(!1)):null===window.indexedDB?(i.indexeddbIsSupported=!1,s.resolve(!1)):"undefined"==typeof IDBKeyRange?(i.indexeddbIsSupported=!1,s.resolve(!1)):e():s.resolve(i.indexeddbIsSupported)})},e.CLASS_NAME="MyWay.Services.BaseDeDonnees.Generique.Factory",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}();i.Factory=e}((n=t.BaseDeDonnees||(t.BaseDeDonnees={})).Generique||(n.Generique={}))}(MyWay||(MyWay={})),function(e){var n,t,o;n=e.Services||(e.Services={}),t=n.BaseDeDonnees||(n.BaseDeDonnees={}),(o=t.BaseDeDonneesImplementation||(t.BaseDeDonneesImplementation={}))[o.INDEXEDDB=0]="INDEXEDDB",o[o.LOCALSTORAGE=1]="LOCALSTORAGE",o[o.MEMORY=2]="MEMORY"}(MyWay||(MyWay={})),function(e){var o;(function(n){var f,e;(e=f||(f={}))[e.DB_NOT_EXISTS=0]="DB_NOT_EXISTS",e[e.DB_IS_OK=1]="DB_IS_OK",e[e.DB_IS_WRONG=2]="DB_IS_WRONG";var t=function(){function s(){}return s.testEtCorrectionSchema=function(){return o.CoreCommon.promesseTryCatch(function(e){if(s.isVerified)e.resolve();else if(s.defersEnAttente.push(e),!s.estEnCours){s.estEnCours=!0;var r=function(n){n?s.defersEnAttente.forEach(function(e){e.reject(n)}):s.defersEnAttente.forEach(function(e){e.resolve()})};n.Generique.Factory.testImplementationIndexeddb().then(function(e){if(!e)return s.isVerified=!0,void r();var n=[];n.push(s.testDB("DBTraceSuivi",["tracessuivi"])),n.push(s.testDB("DonneesDelocalisees",["storeTDT","storeData"])),n.push(s.testDB("Trace",["storeTrace"])),n.push(s.testDB("_base_technique_",["referentiel"])),o.CoreCommon.ServiceDePromesse.all(n).then(function(e){var n=!0;if(e.every(function(e){return e.status===f.DB_IS_WRONG&&(n=!1),n}),n)console.log("Indexeddb OK"),s.isVerified=!0,r();else{console.log("Indexeddb WRONG, fait un reset");var t=0,o=0;e.forEach(function(e){e.status!==f.DB_NOT_EXISTS&&(o++,window.indexedDB.deleteDatabase(e.db).onsuccess=function(){o<=++t&&(console.log("Indexeddb WRONG, reset terminé"),s.isVerified=!0,r())})}),0===o&&(console.log("Indexeddb WRONG, reset terminé"),s.isVerified=!0,r())}},function(e){console.error("Erreur lors de la vérification d'indexeddb!"),console.error(e),s.isVerified=!0,r(e)})})}})},s.testDB=function(c,u){return o.CoreCommon.promesseTryCatch(function(i){var a=window.indexedDB.open(c),d=!0;a.onupgradeneeded=function(){d=!1},a.onsuccess=function(){var e=a.result;if(!d)return e.close(),window.indexedDB.deleteDatabase(c),void i.resolve({db:c,status:f.DB_NOT_EXISTS});var n=e.objectStoreNames,t=[],o=[];u.forEach(function(e){o.push({table:e,estTrouve:!1})});for(var r=0;r<n.length;r++)t.push(n.item(r));e.close(),t.forEach(function(n){o.every(function(e){return n!==e.table||!(e.estTrouve=!0)})});var s=!0;o.every(function(e){return e.estTrouve||(s=!1),s}),i.resolve({db:c,status:s?f.DB_IS_OK:f.DB_IS_WRONG})}})},s.isVerified=!1,s.estEnCours=!1,s.defersEnAttente=[],s}();n.VerificationSchemaIndexeddb=t})((o=e.Services||(e.Services={})).BaseDeDonnees||(o.BaseDeDonnees={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-database-manager.min.js.map
var MyWay;!function(g){var e,a,c,m;e=g.Test||(g.Test={}),a=e.V1||(e.V1={}),c=a.Services||(a.Services={}),m=function(){function e(){}return e.getInstance=function(){return null===e.INSTANCE&&(e.INSTANCE=new e).init(),e.INSTANCE},e.prototype.init=function(){var n=this;this.componentsByKey={},g.Services.Components.RegistryManagerMessage.getInstance().components.forEach(function(e){var a=new e;n.componentsByKey[a.name.toString()]=e})},e.prototype.getClass=function(e){return this.componentsByKey[e.toString()]},e.INSTANCE=null,e}(),c.declareExterieurVersManagerMessageATester=function(u){var e=[];return e.push(function(){var e=it;!0===u.onlyBadMessageTest&&(e=fit),e("Si j'envoie un message erroné (en l'occurence MAUVAIS_MESSAGE_POUR_TEST) au manager-message j'ai bien le comportement attendu",function(e){c.generateMessageService();var a=m.getInstance().getClass(u.component);if(a){expect(!0).toBe(!0,"La class manager-message du type "+u.component+" est enregistrée auprès du RegistryManagerMessage");var n=new a,t={},s=c.generateEmptyLibraryManager();return g.Services.CoreCommon.getPromesseSelfResoved().then(function(){if(u.beforeEach){var e={instance:n};return u.beforeEach(e)}}).then(function(){return n.init(t,s)}).then(function(){return n.reception({subject:"MAUVAIS_MESSAGE_POUR_TEST",message:null,iframe:null})}).then(function(e){fail("L'envoi d'un message erroné n'a pas renvoyé une erreur!")},function(e){expect(e.codeLibelle).toBe("Subject MAUVAIS_MESSAGE_POUR_TEST not implemented on "+n.name+" manager-message","Une erreur a bien été générée suite à l'envoi d'un message erroné")}).finally(e)}fail("La class manager-message du type "+u.component+" n'est pas enregistrée auprès du RegistryManagerMessage")})}),{execute:function(){describe("Lorsque j'utilise le manager-message "+u.classManagerName,function(){e.forEach(function(e){e()})})},test:function(i){var a="";a="Si j'envoie le message "+i.typeMessage+" de l'agent correctement j'ai bien le comportement attendu",i.testMethodSuffix&&(a+=" [cas : "+i.testMethodSuffix+"]"),e.push(function(){var e=it;!0===i.only&&(e=fit),e(a,function(e){c.generateMessageService();var a=m.getInstance().getClass(u.component);if(a){expect(!0).toBe(!0,"La class manager-message du type "+u.component+" est enregistrée auprès du RegistryManagerMessage");var n=new a,t={},s=c.generateEmptyLibraryManager(),r=!1,o=void 0;return t[i.managerMethod]=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];return r=!0,o=e,i.managerHasMethodResponse?i.managerMethodResponse:void 0},g.Services.CoreCommon.getPromesseSelfResoved().then(function(){if(u.beforeEach){var e={instance:n};return u.beforeEach(e)}}).then(function(){var e={instance:n};return i.before?i.before(e):void 0}).then(function(){return n.init(t,s)}).then(function(){var e={subject:i.typeMessage,message:null,iframe:i.requestMessageIframe};return i.hasRequestMessage&&(e.message=i.requestMessage),n.reception(e)}).then(function(e){if(r?expect(!0).toBe(!0,"Le manager a été appelé!"):fail("Le manager n'a pas été appelé!"),i.managerHasMethodParams?expect(o).toEqual(i.managerMethodParams,"Vérification des paramètres passés à la méthode du manager"):expect(o).toEqual([],"Vérification des paramètres passés à la méthode du manager"),i.hasResponseMessage)switch(i.responseMessageTestMode){case c.TestMode.NoCheck:expect(!0).toBe(!0,"Vérification du message répondu par le manager-message qui est envoyé à l'agent [test ignoré]");break;case c.TestMode.StrictEquals:expect(e).toBe(i.responseMessage,"Vérification du message répondu par le manager-message qui est envoyé à l'agent");break;case c.TestMode.DeepEquals:default:expect(e).toEqual(i.responseMessage,"Vérification du message répondu par le manager-message qui est envoyé à l'agent")}else expect(e).toBe(void 0,"Vérification du message répondu par le manager-message qui est envoyé à l'agent")},function(e){fail(e),fail("Une erreur s'est produite! Details : "+e.codeLibelle),console.error(e)}).finally(e)}fail("La class manager-message du type "+u.component+" n'est pas enregistrée auprès du RegistryManagerMessage")})}),e.push(function(){a="Si j'envoie le message "+i.typeMessage+" de l'agent de manière incorrecte j'ai bien une erreur qui remonte",i.testMethodSuffix&&(a+=" [cas : "+i.testMethodSuffix+"]"),it(a,function(e){var a=m.getInstance().getClass(u.component);if(a){expect(!0).toBe(!0,"La class manager-message du type "+u.component+" est enregistrée auprès du RegistryManagerMessage");var n=new a,t={},s=c.generateEmptyLibraryManager(),r=!1,o=null;t[i.managerMethod]=function(){for(var e=[],a=0;a<arguments.length;a++)e[a]=arguments[a];if(r=!0,o=e,i.managerMethodeThrowError)throw i.managerMethodeError;return i.managerMethodeError},g.Services.CoreCommon.getPromesseSelfResoved().then(function(){if(u.beforeEach){var e={instance:n};return u.beforeEach(e)}}).then(function(){var e={instance:n};return i.before?i.before(e):void 0}).then(function(){return n.init(t,s)}).then(function(){var e={subject:i.typeMessage,message:null,iframe:i.requestMessageIframe};return i.hasRequestMessage&&(e.message=i.requestMessage),n.reception(e)}).then(function(e){fail("Une erreur aurait dû se produire!")},function(e){r?expect(!0).toBe(!0,"Le manager a été appelé!"):fail("Le manager n'a pas été appelé!"),i.managerHasMethodParams?expect(o).toEqual(i.managerMethodParams,"Vérification des paramètres passés à la méthode du manager"):expect(o).toEqual([],"Vérification des paramètres passés à la méthode du manager"),expect(e.codeLibelle).toBe(i.responseMessageErreur,"Vérification de l'erreur par le manager-message")}).finally(e)}else fail("La class manager-message du type "+u.component+" n'est pas enregistrée auprès du RegistryManagerMessage")})})}}}}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-test-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(a){!function(i){i.isMobile=!0;var r=function(){function i(e,n,t,o){this.$q=e,this.instanceLoaderService=n,this.$timeout=t,this.$rootScope=o}return i.Instance=function(e,n,t,o){return null===i._serviceAgentExtended&&(i._serviceAgentExtended=new c(e,n,t,o)),i._serviceAgentExtended},i.$inject=["$q","instanceLoaderService","$timeout","$rootScope"],i._serviceAgentExtended=null,i}();i.ServiceAgentMobileProvider=r;var c=function(r){function o(e,n,t,o){var i=r.call(this,e,n,t,o)||this;return i._$q=e,i._instanceLoaderService=n,i._$timeout=t,i._$rootScope=o,i}return __extends(o,r),o.addActionPostInit=function(e){},o.removeActionPostInit=function(n){i.CoreCommon.ArrayUtils.remove(o.actionsPostInit,function(e){return e===n})},o.prototype.init=function(e){var n=this,t=this._$q.defer();return(new i.ServiceManagerExtended).init({IFrameId:null,LogOnUrl:null,OnEvent:null,PortalType:"single",isTotemCapable:!1,ModeVerificationProcessus:a.Services.ModeVerificationProcessus.Aucun,delegationPortail:!1}).finally(function(){return i.ServiceManager.Instance().Initialize()}).finally(function(){var n=[];return o.actionsPostInit.forEach(function(e){n.push(e(i.ServiceManager.Instance().Library))}),i.CoreCommon.ServiceDePromesse.all(n)}).finally(function(){r.prototype.init.call(n,e).then(function(){t.resolve(i.ServiceAgentProvider.Instance(n._$q,n._instanceLoaderService,n._$timeout,n._$rootScope))},function(e){t.reject(e)})}),t.promise},o.actionsPostInit=[],o}(i.ServiceAgentExtended);i.ServiceAgentMobileExtended=c,"undefined"!=typeof angular&&(i.moduleAgent=angular.module("moduleAgent",["ng"]),i.moduleAgent.service("instanceLoaderService",i.InstanceLoaderService),i.moduleAgent.provider("serviceAgent",function(){this.$get=["$q","instanceLoaderService","$timeout","$rootScope",function(e,n,t,o){return r.Instance(e,n,t,o)}]}),i.moduleAgent.provider("serviceAgentExtended",function(){this.$get=["$q","instanceLoaderService","$timeout","$rootScope",function(e,n,t,o){return r.Instance(e,n,t,o)}]}),i.moduleAgent.provider("serviceAgentProvider",function(){this.$get=["$q","instanceLoaderService","$timeout","$rootScope",function(e,n,t,o){return r.Instance(e,n,t,o)}]}))}(a.Services||(a.Services={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-core-mobile.min.js.map
var MyWay;!function(u){var e,t,c;e=u.Test||(u.Test={}),t=e.V1||(e.V1={}),(c=t.Services||(t.Services={})).declareManagerExtendedATester=function(s){var t=[];return{execute:function(){describe("Lorsque j'utilise le "+s.className,function(){t.forEach(function(e){e()})})},testManagerExtended:function(i){var e=it;!0===i.only&&(e=fit),t.push(function(){e("Si j'appelle la méthode "+i.method+" correctement j'ai bien le comportement attendu",function(e){i.hasResult;var t,a={},r=new s.classManagerExtended,n=!1,o=void 0;a[i.managerMethod]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return n=!0,o=e,i.managerHasResult?i.managerResult:void 0},t=c.generateEmptyLibraryCommon(),u.Services.CoreCommon.getPromesseSelfResoved().then(function(){return s.beforeEach?s.beforeEach(a,t):void 0}).then(function(){return i.beforeTest?i.beforeTest(a,t):void 0}).then(function(){return r.init(a,t)}).then(function(){return i.hasParam?r[i.method].apply(r,i.params):r[i.method].call(r)}).then(function(e){if(expect(n).toBe(!0,"La méthode doit être appelée"),i.managerHasParam?expect(o).toEqual(i.managerParams,"Vérification des paramètres passés au manager"):expect(o).toEqual([],"Vérification des paramètres passés au manager"),i.hasResult)switch(i.resultType){case c.TestMode.StrictEquals:expect(e).toBe(i.result,"Vérification du résultat retourné");break;case c.TestMode.DeepEquals:default:expect(e).toEqual(i.result,"Vérification du résultat retourné")}}).finally(function(){return i.afterTest?i.afterTest(a,t):void 0}).finally(function(){return s.afterEach?s.afterEach(a,t):void 0}).finally(e)})}),t.push(function(){e("Si j'appelle la méthode "+i.method+" de manière erronée j'ai bien une erreur qui me remonte",function(e){var t,a={},r=new s.classManagerExtended,n=!1,o=void 0;a[i.managerMethod]=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];throw n=!0,o=e,new u.Services.Erreur("Message d'erreur de test")},t=c.generateEmptyLibraryCommon(),u.Services.CoreCommon.getPromesseSelfResoved().then(function(){return s.beforeEach?s.beforeEach(a,t):void 0}).then(function(){return i.beforeTest?i.beforeTest(a,t):void 0}).then(function(){return r.init(a,t)}).then(function(){return i.hasParam?r[i.method].apply(r,i.params):r[i.method].call(r)}).catch(function(e){expect(n).toBe(!0,"La méthode doit être appelée"),i.managerHasParam?expect(o).toEqual(i.managerParams,"Vérification des paramètres passés à la méthode"):expect(o).toEqual([],"Vérification des paramètres passés à la méthode"),expect(e.codeLibelle).toBe("Message d'erreur de test","Vérification de l'erreur retournée par la méthode")}).finally(function(){return i.afterTest?i.afterTest(a,t):void 0}).finally(function(){return s.afterEach?s.afterEach(a,t):void 0}).finally(e)})})}}}}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-test-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,n;t=e.Services||(e.Services={}),((n=t.Components||(t.Components={})).ComponentType||(n.ComponentType={})).Aide="Aide"}(MyWay||(MyWay={})),function(e){var t,n,o,s;t=e.Services||(e.Services={}),n=t.Aide||(t.Aide={}),o=n.Messages||(n.Messages={}),(s=o.AideMessageSubject||(o.AideMessageSubject={}))[s.GetContenuInfobulle=0]="GetContenuInfobulle",s[s.GetInfobullesAffichables=1]="GetInfobullesAffichables",t.Components.FactoryRegistries.getInstance().declareComponent(t.Components.ComponentType.Aide,[t.Components.ComponentType.Context,t.Components.ComponentType.Display,t.Components.ComponentType.Preferences])}(MyWay||(MyWay={})),function(e){var t;(function(e){var t=function(e){e&&(this.ChampsDeSaisie=e.ChampsDeSaisie,this.ModalePush=e.ModalePush,this.Totem=e.Totem,this.InfobullesAffichees=e.InfobullesAffichees,this.DetailInfobulleAffichee=e.DetailInfobulleAffichee)};e.AideResult=t;var n=function(e){e&&(this.Id=e.Id,this.IdChamp=e.IdChamp,this.MessageCommunautaire=e.MessageCommunautaire,this.MessageEtablissement=e.MessageEtablissement,this.EstUneNouveaute=e.EstUneNouveaute)};e.ChampDeSaisieResult=n;var o=function(e){e&&(this.Message=e.Message)};e.ModalePushResult=o;var s=function(e){e&&(this.Categorie=e.Categorie,this.Titre=e.Titre,this.FormatDocument=e.FormatDocument,this.Lien=e.Lien,this.EstUneNouveaute=e.EstUneNouveaute)};e.TotemResult=s;var i=function(){},a=function(o){function e(e,t){var n=o.call(this)||this;return n._estNouveaute="string"==typeof e?(n._nomChampLie=e||"",t||!1):"object"==typeof e?(n._nomChampLie=e&&e._nomChampLie?e._nomChampLie:"",!(!e||!e._estNouveaute)&&e._estNouveaute):(n._nomChampLie="",!1),n}return __extends(e,o),e.prototype.getNomChampLie=function(){return this._nomChampLie},e.prototype.getEstNouveaute=function(){return this._estNouveaute},e}(e.Infobulle=i),u=function(i){function e(e,t,n,o){var s=this;return s._image="string"==typeof e?((s=i.call(this,e,t)||this)._message=n||"",o||null):"object"==typeof e?((s=i.call(this,e)||this)._message=e&&e._message?e._message:"",e&&e._image?e._image:null):((s=i.call(this,"",!1)||this)._message="",null),s}return __extends(e,i),e.prototype.getNomChampLie=function(){return i.prototype.getNomChampLie.call(this)},e.prototype.getEstNouveaute=function(){return i.prototype.getEstNouveaute.call(this)},e.prototype.getMessage=function(){return this._message},e.prototype.getImage=function(){return this._image},e}(e.InfobulleAfficheeResult=a);e.DetailInfobulleAfficheeResult=u})((t=e.Services||(e.Services={})).Aide||(t.Aide={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-aide-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){var n,t,r;n=e.Services||(e.Services={}),t=n.Preferences||(n.Preferences={}),r=function(e){function r(){return e.call(this,n.Components.ComponentType.Preferences)||this}return __extends(r,e),r.prototype.LirePreference=function(e,r){var n={nomVariable:e,isChargerServeur:r};return this.sendMessage(t.PreferencesMessageSubject.LirePreference,n).then(function(e){return e.valeurVariable})},r.prototype.EcrirePreference=function(e,r){var n={preferences:[{cle:e,valeur:r}]};return this.sendMessage(t.PreferencesMessageSubject.EcrirePreference,n)},r.prototype.lireMultiPreference=function(e){var r={codesPreference:e};return this.sendMessage(t.PreferencesMessageSubject.LireMultiPreference,r).then(function(e){return e.preferences})},r.prototype.ecrireMultiPreference=function(e){var r={preferences:e};return this.sendMessage(t.PreferencesMessageSubject.EcrirePreference,r)},r}(n.Components.ComponentAgentBase),t.PreferencesAgent=r,n.Components.RegistryAgent.getInstance().register(r)}(MyWay||(MyWay={})),function(e){var r;(r=e.Services||(e.Services={})).Bug||(r.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-preferences-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();!function(e){var r;(r=e.Services||(e.Services={})).Bug||(r.Bug={})}(MyWay||(MyWay={})),function(e){var o,r,t;o=e.Services||(e.Services={}),r=o.Preferences||(o.Preferences={}),t=function(e){function r(){return e.call(this,o.Components.ComponentType.Preferences)||this}return __extends(r,e),r.prototype.ObtenirPreferences=function(e){return this.libraryManager.Core.sendRequest({withHeaders:!0,url:o.PrivatePortalServiceParameters.Instance().PreferencesUrl+"/multi?codeAgent="+e,method:o.MethodEnum.GET}).then(function(e){var r=[];for(var t in e)r.push({cle:t,valeur:e[t]});return r})},r.prototype.EcrirePreference=function(e,r){var t={};r.forEach(function(e){t[e.cle]=e.valeur});var n={};return n.method=o.MethodEnum.POST,n.url=o.PrivatePortalServiceParameters.Instance().PreferencesUrl+"/multi?codeAgent="+e,n.async=!0,n.data={preferences:t},n.contentType=o.ContentTypeEnum.JSON,this.libraryManager.Core.sendRequest(n)},r}(o.Components.ComponentApiBase),r.PreferencesApi=t,o.Components.RegistryApi.getInstance().register(t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-preferences-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var n,s,t;n=e.Services||(e.Services={}),s=n.Interop||(n.Interop={}),t=function(e){function t(){return e.call(this,n.Components.ComponentType.Interop)||this}return __extends(t,e),t.prototype.lireFichier=function(e){var t={nomFichier:e};return this.sendMessage(s.Messages.InteropMessageSubject.LireFichier,t).then(function(e){return e.data})},t.prototype.ecrireFichier=function(e,t,n,r){var o={nomFichier:e,fluxdonnees:t,ajouter:n,creeDir:r};return this.sendMessage(s.Messages.InteropMessageSubject.EcrireFichier,o).then(function(e){return e.data})},t.prototype.AfficherSynthese=function(e){return this.sendMessage(s.Messages.InteropMessageSubject.AfficherSynthese,{numeroClient:e})},t.prototype.triggerNotifications=function(){return this.sendMessage(s.Messages.InteropMessageSubject.TriggerNotifications)},t}(n.Components.ComponentAgentBase),s.InteropAgent=t,n.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-interop-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,s,n;t=e.Services||(e.Services={}),s=t.Libelle||(t.Libelle={}),n=function(e){function i(){return e.call(this,t.Components.ComponentType.Libelle)||this}return __extends(i,e),i.prototype.afficherMessage=function(e,t,n,r){i.logger.info("Méthode à surveiller - afficherMessage");var o={codeLibelle:e,typeAffichage:t,valeurs:n,delai:r};return this.sendMessage(s.LibelleMessageSubject.afficherMessage,o)},i.prototype.constituerLibelle=function(e,t){i.logger.info("Méthode à surveiller - constituerLibelle");var n={codeLibelle:e,valeurs:t};return this.sendMessage(s.LibelleMessageSubject.constituerLibelle,n)},i.CLASS_NAME="MyWay.Services.Libelle.LibelleAgent",i.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(i.CLASS_NAME),i}(t.Components.ComponentAgentBase),s.LibelleAgent=n,t.Components.RegistryAgent.getInstance().register(n)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-libelle-agent.min.js.map
var MyWay;!function(e){var n,r;n=e.Services||(e.Services={}),((r=n.Components||(n.Components={})).ComponentType||(r.ComponentType={})).Impression="Impression"}(MyWay||(MyWay={})),function(e){var n,r,o,i;n=e.Services||(e.Services={}),r=n.Impression||(n.Impression={}),o=r.Messages||(r.Messages={}),(i=o.ImpressionMessageSubject||(o.ImpressionMessageSubject={}))[i.Generer=0]="Generer",i[i.GetJsonConverti=1]="GetJsonConverti",i[i.Imprimer=2]="Imprimer",i[i.ImprimerLot=3]="ImprimerLot",i[i.GenererImprimer=4]="GenererImprimer",n.Components.FactoryRegistries.getInstance().declareComponent(n.Components.ComponentType.Impression,[n.Components.ComponentType.Context,n.Components.ComponentType.Core,n.Components.ComponentType.Display,n.Components.ComponentType.Fichier,n.Components.ComponentType.Libelle])}(MyWay||(MyWay={})),function(e){var n,r,o,i,s,t;n=e.Services||(e.Services={}),r=n.Impression||(n.Impression={}),(o=r.RESTITUTION_VERSION||(r.RESTITUTION_VERSION={}))[o.V180=180]="V180",(i=r.GENERATION_ACTION||(r.GENERATION_ACTION={}))[i.archiver=10]="archiver",i[i.archiverAndGetFichier=20]="archiverAndGetFichier",i[i.getFichier=30]="getFichier",(s=r.GENERATION_IMPRESSION_ACTION||(r.GENERATION_IMPRESSION_ACTION={}))[s.archiverAndGetFichier=20]="archiverAndGetFichier",s[s.getFichier=30]="getFichier",(t=r.TYPE_IMAGE||(r.TYPE_IMAGE={}))[t.Id=0]="Id",t[t.Flux=1]="Flux"}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-impression-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var o in r)r.hasOwnProperty(o)&&(e[o]=r[o])};return function(e,r){function o(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(o.prototype=r.prototype,new o)}}();!function(s){var u,E,e;u=s.Services||(s.Services={}),E=u.Export||(u.Export={}),e=function(r){function l(){var e=r.call(this,u.Components.ComponentType.Export)||this;return e.contextKey="EXPORT",e}return __extends(l,r),l.prototype.verificationDonneesAExporter=function(e){return null===e||void 0===e.contenu||void 0===e.entetes?this.library.Core.createPromiseSelfError(new u.Erreur(s.Services.Libelle.LibelleModel.COM.ERREUR_EXPORT_DONNEES_ENTREES_FORMAT_INVALIDE)):null===e.entetes||null===e.contenu?this.library.Core.createPromiseSelfError(new u.Erreur(s.Services.Libelle.LibelleModel.COM.ERREUR_EXPORT_DONNEES_ENTREES_VIDE)):this.library.Core.getPromesseSelfResoved()},l.prototype.convertionDonneesEnCsv=function(e,r){var a,o="",t=r&&void 0!==r.localisation?r.localisation:E.LOCALISATION.FR,c=r&&void 0!==r.columnDetails?r.columnDetails:[];a=t===E.LOCALISATION.FR?";":",";var n="";for(var i in e.entetes)n+=e.entetes[i]+a;return n=n.slice(0,-1),o+=n+"\r\n",e.contenu.forEach(function(e){var i="";e.ligne.forEach(function(r,o){var e=function(e){return r.cellule},t=s.Services.CoreCommon.ArrayUtils.getOne(c,function(e){return e.index===o});null===t&&(t={index:o,addquote:!0,format:e});var n=void 0!==t.format?t.format(r.cellule):e(r.cellule);n=void 0===t.addquote||!0===t.addquote?'"'+n+'"':n,i+=n+a}),i.slice(0,i.length-1),o+=i+"\r\n"}),u.Loggers.FLASH.INSTANCE.setValue("details",o),l.logger.debug("Convertion des données en CSV - Success"),o},l.prototype.telechargerFichier=function(e,r){var o=r&&r.nomFichier?r.nomFichier.replace(/ /g,"_"):"defaut";if(u.CoreCommon.checkIsIE()){e="\ufeff"+e;var t=Blob?new Blob([e],{type:"text/csv;charset=utf-8;"}):null;return window.navigator&&window.navigator.msSaveBlob?(window.navigator.msSaveBlob(t,o+"."+E.FORMAT_FICHIER.CSV),l.logger.debug("Téléchargement fichier sous IE - Success"),this.library.Core.createPromiseSelfResolved(e)):(l.logger.error("Téléchargement fichier sous IE - Failed"),this.library.Core.createPromiseSelfError(new u.Erreur(s.Services.Libelle.LibelleModel.COM.ERREUR_EXPORT_TELECHARGEMENT_IMPOSSIBLE)))}var n="data:text/csv;charset=utf-8,%EF%BB%BF"+encodeURI(e),i=document.createElement("a");return i.href=n,i.style="visibility:hidden",i.download=o+"."+E.FORMAT_FICHIER.CSV,document.body.appendChild(i),i.click(),document.body.removeChild(i),l.logger.debug("Téléchargement fichier avec navigateur non IE - Success"),this.library.Core.createPromiseSelfResolved(e)},l.prototype.exporterFichier=function(r,o,t){var n=this;return this.verificationDonneesAExporter(r).then(function(){switch(o){case E.FORMAT_FICHIER.CSV:var e=n.convertionDonneesEnCsv(r,t);return n.telechargerFichier(e,t);default:throw l.logger.error("Format d'exportation demandé inconnu  - Success"),new u.Erreur(s.Services.Libelle.LibelleModel.COM.ERREUR_EXPORT_FORMAT_FICHIER_INCONNU)}}).catch(function(e){throw l.logger.error("Format d'exportation demandé inconnu  - Success"),e})},l.CLASS_NAME="MyWay.Services.Export.ExportManager",l.logger=u.Loggers.LoggerFactory.INSTANCE.getClass(l.CLASS_NAME),l}(u.Components.ComponentManagerBase),E.ExportManager=e,u.Components.RegistryManager.getInstance().register(e)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-export-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var a,t,r;a=e.Services||(e.Services={}),t=a.Libelle||(a.Libelle={}),r=function(i){function o(){var e=i.call(this,a.Components.ComponentType.Libelle)||this;return e.messages=null,e.managerLibelleIsReady=!1,e.constituerLibellesEnAttente=[],e}return __extends(o,i),o.prototype.constituerLibelle=function(t,r){var n=this;return this.managerLibelleIsReady?this.libraryManager.Libelle.constituerLibelle(t,r):this.libraryManager.Core.promesseTryCatch(function(e){n.constituerLibellesEnAttente.push(function(){n.libraryManager.Libelle.constituerLibelle(t,r).then(e.resolve,e.reject)})})},o.prototype.init=function(e,r,t){var n=this;return i.prototype.init.call(this,e,r,t).then(function(){var e=null;e=n.portalServiceParameters.CDNUrl?n.portalServiceParameters.CDNUrl+n.privatePortalServiceParameters.FichierMessage:n.privatePortalServiceParameters.FichierMessage;var t={};return t.method=a.MethodEnum.GET,t.url=e,t.responseType=a.ResponseTypeEnum.JSON,t.withHeaders=!1,r.Core.sendRequest(t).then(function(e){n.messages=e},function(){}).finally(function(){n.managerLibelleSetToReady()})},function(e){throw o.logger.info("ServiceApiBase constructor SendRequest callbackError : %1",e.codeLibelle),e})},o.prototype.managerLibelleSetToReady=function(){this.managerLibelleIsReady=!0,this.constituerLibellesEnAttente.forEach(function(e){return e()})},o.CLASS_NAME="MyWay.Services.Libelle.LibelleApi",o.logger=a.Loggers.LoggerFactory.INSTANCE.getClass(o.CLASS_NAME),o}(a.Components.ComponentApiBase),t.LibelleApi=r,a.Components.RegistryApi.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-libelle-api.min.js.map
var MyWay;!function(e){var s,n;s=e.Services||(e.Services={}),((n=s.Components||(s.Components={})).ComponentType||(n.ComponentType={})).DonneesDelocalisees="DonneesDelocalisees"}(MyWay||(MyWay={})),function(e){var s,n,o,t;s=e.Services||(e.Services={}),n=s.DonneesDelocalisees||(s.DonneesDelocalisees={}),o=n.Messages||(n.Messages={}),(t=o.DonneesDelocaliseesMessageSubject||(o.DonneesDelocaliseesMessageSubject={}))[t.GetDonneesDelocalisees=0]="GetDonneesDelocalisees",t[t.GetListeDonneesDelocalisees=1]="GetListeDonneesDelocalisees",t[t.GetRubriqueLibelle=2]="GetRubriqueLibelle",t[t.GetDonneesParCriteres=3]="GetDonneesParCriteres",t[t.ReInitDbDonneesDelocalisees=4]="ReInitDbDonneesDelocalisees",t[t.GetTDTById=5]="GetTDTById",t[t.DeleteTDTById=6]="DeleteTDTById",s.Components.FactoryRegistries.getInstance().declareComponent(s.Components.ComponentType.DonneesDelocalisees,[s.Components.ComponentType.Context,s.Components.ComponentType.Dates,s.Components.ComponentType.Libelle,s.Components.ComponentType.BaseDeDonnees])}(MyWay||(MyWay={})),function(e){var s,n,o;s=e.Services||(e.Services={}),n=s.DonneesDelocalisees||(s.DonneesDelocalisees={}),(o=n.CRITERES_OPERATEUR||(n.CRITERES_OPERATEUR={}))[o.EGAL=0]="EGAL",o[o.CONTIENT=1]="CONTIENT"}(MyWay||(MyWay={})),function(e){var s;(s=e.Services||(e.Services={})).Bug||(s.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-donnees-delocalisees-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var t,o,n;t=e.Services||(e.Services={}),o=t.Communication||(t.Communication={}),n=function(e){function n(){return e.call(this,t.Components.ComponentType.Communication)||this}return __extends(n,e),n.prototype.envoyerMail=function(e){return this.sendMessage(o.CommunicationMessageSubject.EnvoyerMail,{mail:e})},n.prototype.declencherAppel=function(e){return this.sendMessage(o.CommunicationMessageSubject.DeclencherAppel,{call:e})},n.prototype.raccrocherAppel=function(){return this.sendMessage(o.CommunicationMessageSubject.RaccrocherAppel,{})},n}(t.Components.ComponentAgentBase),o.CommunicationAgent=n,t.Components.RegistryAgent.getInstance().register(n)}(MyWay||(MyWay={})),function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={})),function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-communication-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}r(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={})),function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={})),function(r){var i,o,e;i=r.Services||(r.Services={}),o=i.Communication||(i.Communication={}),e=function(){function e(){this.libraryManager=null,this._numerotationTelephoniqueUrl=i.PrivatePortalServiceParameters.Instance().NumerotationTelephoniqueUrl}return e.prototype.initApi=function(e){this.libraryManager=e},e.prototype.declencherAppel=function(e,n){if(e.numeroDestinataire&&n.codeEtablissement&&n.agentConnecte.referenceExterneAgent){var t={url:this._numerotationTelephoniqueUrl+"?numeroDestinataire="+e.numeroDestinataire,method:i.MethodEnum.PUT,authentificationInfo:n};return this.libraryManager.Core.sendRequest(t).catch(function(e){throw o.CommunicationApiFullWeb.loggerCommunicationApiBase.error("SendRequest declencherAppel Failed - %1",JSON.stringify(e)),e})}return this.libraryManager.Core.createPromiseSelfError(new i.Erreur(r.Services.Libelle.LibelleModel.COM.ERREUR_COMMUNICATION_PARAMETRES_INSUFFISANTS))},e.prototype.raccrocherAppel=function(e){if(e.codeEtablissement&&e.agentConnecte.referenceExterneAgent){var n={url:this._numerotationTelephoniqueUrl,method:i.MethodEnum.DELETE,authentificationInfo:e};return this.libraryManager.Core.sendRequest(n).catch(function(e){throw o.CommunicationApiFullWeb.loggerCommunicationApiBase.error("SendRequest raccrocherAppel Failed - %1",JSON.stringify(e)),e})}return this.libraryManager.Core.createPromiseSelfError(new i.Erreur(r.Services.Libelle.LibelleModel.COM.ERREUR_COMMUNICATION_PARAMETRES_INSUFFISANTS))},e.prototype.envoyerMessageAppliKiosque=function(e){return i.Promesses.createPromiseSelfResolved("")},e.CLASS_NAME_BASE="MyWay.Services.Communication.CommunicationApiBase",e.loggerCommunicationApiBase=i.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME_BASE),e}(),o.CommunicationApiBase=e}(MyWay||(MyWay={})),function(e){var n,o,t;n=e.Services||(e.Services={}),o=n.Communication||(n.Communication={}),t=function(i){function e(){var e=i.call(this,n.Components.ComponentType.Communication)||this;return e.wrapped=null,e}return __extends(e,i),e.prototype.init=function(e,n,t){var r=this;return e.ServiceLocal?this.wrapped=new o.CommunicationApiWindows:this.wrapped=new o.CommunicationApiFullWeb,i.prototype.init.call(this,e,n,t).then(function(){return r.wrapped.initApi(n)})},e.prototype.initApi=function(e){},e.prototype.declencherAppel=function(e,n){return this.wrapped.declencherAppel(e,n)},e.prototype.raccrocherAppel=function(e){return this.wrapped.raccrocherAppel(e)},e.prototype.envoyerMessageAppliKiosque=function(e){return this.wrapped.envoyerMessageAppliKiosque(e)},e}(n.Components.ComponentApiBase),o.CommunicationApiFactory=t,n.Components.RegistryApi.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var n,t,r;n=e.Services||(e.Services={}),t=n.Communication||(n.Communication={}),r=function(e){function n(){return e.call(this)||this}return __extends(n,e),n}(t.CommunicationApiBase),t.CommunicationApiFullWeb=r}(MyWay||(MyWay={})),function(e){var r,n,t;r=e.Services||(e.Services={}),n=r.Communication||(r.Communication={}),t=function(n){function t(){var e=n.call(this)||this;return e._localServiceUrl=r.PrivatePortalServiceParameters.Instance().LocalServiceUrl,e}return __extends(t,n),t.prototype.envoyerMessageAppliKiosque=function(e){var n={url:this._localServiceUrl+"/com/SendMessage",method:r.MethodEnum.POST,async:!0,contentType:r.ContentTypeEnum.JSON,data:e,cache:!1};return t.logger.debug("Envoi du message "+e+"à l'application externe"),this.libraryManager.Core.sendRequest(n).then(function(){return t.logger.debug("Message envoyé à l'application externe - Success"),"Message Envoyé à l'agent"},function(){return t.logger.error("Message non envoyé à l'application externe - Failed"),"Message non Envoyé à l'agent"})},t.CLASS_NAME="MyWay.Services.Communication.CommunicationApiWindows",t.logger=r.Loggers.LoggerFactory.INSTANCE.getClass(t.CLASS_NAME),t}(n.CommunicationApiBase),n.CommunicationApiWindows=t}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-communication-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,o,n;t=e.Services||(e.Services={}),o=t.ContexteClient||(t.ContexteClient={}),n=function(i){function e(){return i.call(this,t.Components.ComponentType.ContexteClient)||this}return __extends(e,i),e.prototype.init=function(e,t,n){var r=this;return e.ServiceLocal?e.InteropAppliBancaire?this.api=new o.ContexteClientApiPetra:this.api=new o.ContexteClientApiWindows:this.api=new o.ContexteClientApiFullWeb,i.prototype.init.call(this,e,t,n).then(function(){return r.initApi(t,n)})},e.prototype.initApi=function(e,t){return this.api.initApi(e,t)},e.prototype.setContexteClientNSDK=function(e,t){return this.api.setContexteClientNSDK(e,t)},e.prototype.getContexteClientPCM=function(){return this.api.getContexteClientPCM()},e}(t.Components.ComponentApiBase),o.ContexteClientApiFactory=n,t.Components.RegistryApi.getInstance().register(n)}(MyWay||(MyWay={})),function(e){var t,n,r;t=e.Services||(e.Services={}),n=t.ContexteClient||(t.ContexteClient={}),r=function(){function e(){this.libraryManager=null}return e.prototype.initApi=function(e,t){return this.libraryManager=e,this.libraryManager.Core.getPromesseSelfResoved()},e.prototype.setContexteClientNSDK=function(e,t){return this.libraryManager.Core.createPromiseSelfResolved(!1)},e.prototype.getContexteClientPCM=function(){return this.libraryManager.Core.createPromiseSelfResolved(null)},e}(),n.ContexteClientApiFullWeb=r}(MyWay||(MyWay={})),function(e){var n,r,t;n=e.Services||(e.Services={}),r=n.ContexteClient||(n.ContexteClient={}),t=function(){function e(){this.libraryManager=null,this.privatePortalServiceParameters=null}return e.prototype.initApi=function(e,t){return this.libraryManager=e,this.privatePortalServiceParameters=t.privatePortalServiceParameters,this.libraryManager.Core.getPromesseSelfResoved()},e.prototype.setContexteClientNSDK=function(e,t){switch(t[r.ContexteClientStatusFlag.RELOAD_FLAG_NAME]){case r.ContexteClientStatusFlag.RELOAD_FLAG_VALUE_NONE:return this.libraryManager.Core.createPromiseSelfResolved(!0);case r.ContexteClientStatusFlag.RELOAD_FLAG_VALUE_RELOAD:return this._reloadNSDK(e);case r.ContexteClientStatusFlag.RELOAD_FLAG_VALUE_SYNCHRO:default:return this._setContexteClientNSDK(e,t)}},e.prototype.getContexteClientPCM=function(){var i=[];return this.libraryManager.Core.sendRequest({url:this.privatePortalServiceParameters.LocalServiceUrl+"/contexte/GetListeClientIdentifiesPCM",method:n.MethodEnum.GET,contentType:n.ContentTypeEnum.JSON}).then(function(e){for(var t=0,n=e;t<n.length;t++){var r=n[t];i.push(r.NumeroPersonne)}return i}).catch(function(){return i})},e.prototype._setContexteClientNSDK=function(e,t){return this.libraryManager.Core.sendRequest({url:this.privatePortalServiceParameters.LocalServiceUrl+"/contexte/SetContexteClientNSDK?numeroClient="+e,method:n.MethodEnum.POST,contentType:n.ContentTypeEnum.JSON,data:t}).then(function(){return!0})},e.prototype._reloadNSDK=function(e){return this.libraryManager.Core.sendRequest({url:this.privatePortalServiceParameters.LocalServiceUrl+"/contexte/DemandeMAJSyntheseNSDK?numeroClient="+e,method:n.MethodEnum.POST}).then(function(){return!0})},e}(),r.ContexteClientApiPetra=t}(MyWay||(MyWay={})),function(e){var t,n,r;t=e.Services||(e.Services={}),n=t.ContexteClient||(t.ContexteClient={}),r=function(){function e(){this.libraryManager=null}return e.prototype.initApi=function(e,t){return this.libraryManager=e,this.libraryManager.Core.getPromesseSelfResoved()},e.prototype.setContexteClientNSDK=function(e,t){return this.libraryManager.Core.createPromiseSelfResolved(!1)},e.prototype.getContexteClientPCM=function(){return this.libraryManager.Core.createPromiseSelfResolved(null)},e}(),n.ContexteClientApiWindows=r}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-contexte-client-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var o,r,t;o=e.Services||(e.Services={}),r=o.Trace||(o.Trace={}),t=function(){function e(){this._url=o.PrivatePortalServiceParameters.Instance().TraceUrl,this.libraryManager=null}return e.prototype.initApi=function(e){this.libraryManager=e},e.prototype.convertirEnumNiveau=function(e){var t;switch(e){case r.NIVEAUX_TRACE.DEBUG:t="DEBUG";break;case r.NIVEAUX_TRACE.INFO:t="INFO";break;case r.NIVEAUX_TRACE.WARNING:t="WARN";break;case r.NIVEAUX_TRACE.ERROR:t="ERROR";break;default:t="INFO"}return t},e.prototype.convertirTraceModel=function(e,r){var n=this,a=[];return e.forEach(function(e){var t={level:"INFO",message:"",details:{}};t.level=n.convertirEnumNiveau(e.niveau),t.message=e.message,t.details.DateTime=e.datetime,t.details.IdentifiantPoste=r.numeroStationTravail,t.details.IdentifiantProcessus=e.idProcessus,t.details.IdentifiantEtape=e.cheminInstances,r.agentConnecte.numeroInterneEds?t.details.AgenceRattachement=r.agentConnecte.referenceExterneEdsRattachemen:t.details.AgenceRattachement="0000000",t.details.NiveauTrace="INFO",t.details.CodeEtablissement=e.COCXBQ,r.agentConnecte.numeroInterneEds?t.details.PosteFonctionnelAgent=r.agentConnecte.numeroInterneEds:t.details.PosteFonctionnelAgent="0000000",t.details.NomComposant=e.composant?e.composant:e.application,t.details.TypeCanal="01",t.details.VersionComposant=o.CoreCommon.VersionMySys,t.details.TypeDevice="01",t.details.IdentifiantConnexionAgent=r.agentConnecte.referenceExterneAgent,t.details.Autres=e.details,a.push(t)}),a},e.prototype.envoyerTraces=function(e,t){var r={};return r.url=this._url,r.method=o.MethodEnum.POST,r.async=!0,r.contentType=o.ContentTypeEnum.JSON,r.data=this.convertirTraceModel(e,t),r.cache=!1,r.withHeaders=!0,r.authentificationInfo=t,this.libraryManager.Core.sendRequest(r)},e.prototype.setModeDebug=function(e){return o.Promesses.getPromesseSelfResoved()},e.prototype.readFileModeDebug=function(){return o.Promesses.createPromiseSelfResolved(void 0)},e}(),r.TraceApiBase=t}(MyWay||(MyWay={})),function(e){var t,o,r;t=e.Services||(e.Services={}),o=t.Trace||(t.Trace={}),r=function(a){function e(){var e=a.call(this,t.Components.ComponentType.Trace)||this;return e.wrapped=null,e}return __extends(e,a),e.prototype.init=function(e,t,r){var n=this;return e.ServiceLocal?this.wrapped=new o.TraceApiWindows:this.wrapped=new o.TraceApiFullWeb,a.prototype.init.call(this,e,t,r).then(function(){return n.wrapped.initApi(t)})},e.prototype.initApi=function(e){},e.prototype.envoyerTraces=function(e,t){return this.wrapped.envoyerTraces(e,t)},e.prototype.setModeDebug=function(e){return this.wrapped.setModeDebug(e)},e.prototype.readFileModeDebug=function(){return this.wrapped.readFileModeDebug()},e}(t.Components.ComponentApiBase),o.TraceApiFactory=r,t.Components.RegistryApi.getInstance().register(r)}(MyWay||(MyWay={})),function(e){var t,r,n;t=e.Services||(e.Services={}),r=t.Trace||(t.Trace={}),n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t}(r.TraceApiBase),r.TraceApiFullWeb=n}(MyWay||(MyWay={})),function(e){var a,t,r;a=e.Services||(e.Services={}),t=a.Trace||(a.Trace={}),r=function(n){function e(){var e=n.call(this)||this;return e._urlLireFichier=a.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/fichier/lire",e}return __extends(e,n),e.prototype.envoyerTraces=function(e,t){n.prototype.envoyerTraces.call(this,e,t);var r={};return r.method=a.MethodEnum.POST,r.url=a.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/Trace/PurgeTraces",r.async=!0,r.contentType=a.ContentTypeEnum.JSON,r.data=JSON.stringify(e),this.libraryManager.Core.sendRequest(r)},e.prototype.setModeDebug=function(e){return a.CoreCommon.SendRequestWithPromise({url:a.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/Trace/SetModeDegug?timeToLive="+e,method:a.MethodEnum.POST})},e.prototype.readFileModeDebug=function(){return this.libraryManager.Core.sendRequest({url:this._urlLireFichier+"?pathFichier=C:/perso/ModeDebugMyway.json",method:a.MethodEnum.GET,cache:!1}).then(function(e){var t;try{t=JSON.parse(e)}catch(e){throw e}return t})},e}(t.TraceApiBase),t.TraceApiWindows=r}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var n,t,o;n=e.Services||(e.Services={}),t=n.ConfigurationPoste||(n.ConfigurationPoste={}),o=function(t){function r(){var e=t.call(this,n.Components.ComponentType.ConfigurationPoste)||this;return e.urlServiceRest=n.PrivatePortalServiceParameters.Instance().ConfigurationPosteUrl,e}return __extends(r,t),r.prototype.getConfigurationPoste=function(e){var t=this,o=this.urlServiceRest+"/"+(e.dateConfig?e.dateConfig.toString():"")+"?computer="+e.poste+"&establishment="+e.etablissement;return this.libraryManager.Core.sendRequest({withHeaders:!0,url:o,method:n.MethodEnum.GET,originalResponse:!0}).then(function(e){switch(e.status){case 200:return r.loggerConfigurationPosteApi.debug("Send request getConfigurationPoste Successed - status 200"),t.libraryManager.Core.createPromiseSelfResolved(JSON.parse(e.responseText));case 204:return r.loggerConfigurationPosteApi.debug("Send request getConfigurationPoste Successed - status 204"),t.libraryManager.Core.createPromiseSelfResolved(null);default:throw new n.Erreur("SendRequest getConfigurationPoste status incorrect ",["Status: "+e.status])}},function(e){throw r.loggerConfigurationPosteApi.error("Send request getConfigurationPoste Failed -  %1",JSON.stringify(e)),e})},r.CLASS_NAME_BASE="MyWay.Services.ConfigurationPoste.ConfigurationPosteApi",r.loggerConfigurationPosteApi=n.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME_BASE),r}(n.Components.ComponentApiBase),t.ConfigurationPosteApi=o,n.Components.RegistryApi.getInstance().register(o)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-configuration-poste-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,o,n;t=e.Services||(e.Services={}),o=t.Performance||(t.Performance={}),n=function(e){function r(){return e.call(this,t.Components.ComponentType.Performance)||this}return __extends(r,e),r.prototype.etape=function(e,t){var n={id:e,label:t};return r.logger.info("Début de la mesure d'étape "+e),this.sendMessage(o.PerformanceMessageSubject.STEP,n)},r.prototype.fin=function(e,t){var n={id:e,label:t};return r.logger.info("Fin de la mesure d'étape "+e),this.sendMessage(o.PerformanceMessageSubject.END,n)},r.prototype.annuler=function(e){return r.logger.info("Annulation de la mesure d'étape "+e),this.sendMessage(o.PerformanceMessageSubject.CANCEL,e)},r.prototype.finChargementManuel=function(){var t=this;return this.getId().then(function(e){return r.logger.info("Fin manuel de la mesure d'étape "+e),t.fin(e,o.AppLoadingPerformanceStep.MANUAL_END)})},r.prototype.getId=function(){var t=""+Date.now()+Math.random();return this.library.Context.GetCurrentStepInfo().then(function(e){return e?e.CurrentStepId:t})},r.CLASS_NAME="MyWay.Services.Performance.PerformanceAgent",r.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME),r}(t.Components.ComponentAgentBase),o.PerformanceAgent=n,t.Components.RegistryAgent.getInstance().register(n)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-performance-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,s,n;t=e.Services||(e.Services={}),s=t.ContexteClient||(t.ContexteClient={}),n=function(r){function e(){return r.call(this,t.Components.ComponentType.ContexteClient)||this}return __extends(e,r),e.prototype.init=function(e,t,n){return r.prototype.init.call(this,e,t,n)},e.prototype.getExpediteur=function(){var e="agent";return this.library.Context&&this.library.Context.StepInfo&&(e=this.library.Context.StepInfo.CurrentParentProcessId),e},e.prototype.getContextesParClients=function(){return this.sendMessage(s.ContextClientMessageSubject.GetContextesParClients).then(function(e){return e.ids})},e.prototype.getId=function(){return this.sendMessage(s.ContextClientMessageSubject.GetId).then(function(e){return e.id})},e.prototype.getClient=function(){return this.sendMessage(s.ContextClientMessageSubject.GetClient).then(function(e){return e.id})},e.prototype.setClient=function(e){var t={client:e,expediteur:this.getExpediteur()};return this.sendMessage(s.ContextClientMessageSubject.SetClient,t)},e.prototype.getProperty=function(e){var t={cle:e};return this.sendMessage(s.ContextClientMessageSubject.GetProperty,t).then(function(e){return e.valeur})},e.prototype.addToList=function(e,t){var n={cle:e,valeur:t,expediteur:this.getExpediteur()};return this.sendMessage(s.ContextClientMessageSubject.AddToList,n).then(function(e){return e.estOk})},e.prototype.setProperty=function(e,t){var n={cle:e,valeur:t,expediteur:this.getExpediteur()};return this.sendMessage(s.ContextClientMessageSubject.SetProperty,n).then(function(e){return e.estOk})},e.prototype.removeFromList=function(e){var t={cle:e,expediteur:this.getExpediteur()};return this.sendMessage(s.ContextClientMessageSubject.RemoveFromList,t).then(function(e){return e.estOk})},e.prototype.deleteProperty=function(e){var t={cle:e,expediteur:this.getExpediteur()};return this.sendMessage(s.ContextClientMessageSubject.DeleteProperty,t).then(function(e){return e.estOk})},e.prototype.getContenu=function(e){var t={idClient:e};return this.sendMessage(s.ContextClientMessageSubject.GetContenu,t).then(function(e){return e.valeur})},e.prototype.setContenu=function(e,t){var n={idClient:e,valeur:t,expediteur:this.getExpediteur()};return this.sendMessage(s.ContextClientMessageSubject.SetContenu,n).then(function(e){return e.estOk})},e.prototype.setReloadSynthese=function(e){var t={idClient:e,expediteur:this.getExpediteur()};return this.sendMessage(s.ContextClientMessageSubject.SetReloadSynthese,t).then(function(e){return e.estOk})},e.prototype.getRefresh=function(e,t){var n={idBlocMetierListen:e,params:t,expediteur:this.getExpediteur()};return this.sendMessage(s.ContextClientMessageSubject.getRefresh,n).then(function(e){return e.estOk})},e.prototype.setDirty=function(e,t){var n={idBlocMetierNotify:e,params:t,expediteur:this.getExpediteur()};return this.sendMessage(s.ContextClientMessageSubject.setDirty,n).then(function(e){return e.estOk})},e}(t.Components.ComponentAgentBase),s.ContexteClientAgent=n,t.Components.RegistryAgent.getInstance().register(n)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-contexte-client-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var e;(e=t.Services||(t.Services={})).Core.defineProperty(e.TechAgentExtended,"ContextTechAgent",{get:function(){return this._techLibrary.ContextTechAgent}}),e.TechAgentExtended.prototype.AddToGlobalContext=function(t){return this._techLibrary.AddToGlobalContext(t)},e.TechAgentExtended.prototype.AddToTempoContext=function(t){return this._techLibrary.AddToTempoContext(t)},e.TechAgentExtended.prototype.AddToMainProcessContext=function(t,e){return this._techLibrary.AddToMainProcessContext(t,e)},e.TechAgentExtended.prototype.GetFromMainProcessContext=function(t){return this._techLibrary.GetFromMainProcessContext(t)},e.TechAgentExtended.prototype.GetCurrentMainProcess=function(){return this._techLibrary.GetCurrentMainProcess()}}(MyWay||(MyWay={})),function(t){var e;(e=t.Services||(t.Services={})).Core.defineProperty(e.TechAgent,"ContextTechAgent",{get:function(){return this._techLibrary.ContextTechAgent}}),e.TechAgent.prototype.AddToGlobalContext=function(t){return this.ContextTechAgent.AddToGlobalContext(t)},e.TechAgent.prototype.AddToTempoContext=function(t){return this.ContextTechAgent.AddToTempoContext(t)},e.TechAgent.prototype.AddToMainProcessContext=function(t,e){return this.ContextTechAgent.AddToMainProcessContext(t,e)},e.TechAgent.prototype.GetFromMainProcessContext=function(t){return this.ContextTechAgent.GetFromMainProcessContext(t)},e.TechAgent.prototype.GetCurrentMainProcess=function(){return this.ContextTechAgent.GetCurrentMainProcess()}}(MyWay||(MyWay={})),function(t){var e;(e=t.Services||(t.Services={})).TechLibrary.addInitListener(function(t,e){t.ContextTechAgent=e.Context}),e.TechLibrary.prototype.AddToGlobalContext=function(t){return this.ContextTechAgent.AddToGlobalContext(t)},e.TechLibrary.prototype.AddToTempoContext=function(t){return this.ContextTechAgent.AddToTempoContext(t)},e.TechLibrary.prototype.AddToMainProcessContext=function(t,e){return this.ContextTechAgent.AddToMainProcessContext(t,e)},e.TechLibrary.prototype.GetFromMainProcessContext=function(t){return this.ContextTechAgent.GetFromMainProcessContext(t)},e.TechLibrary.prototype.GetCurrentMainProcess=function(){return this.ContextTechAgent.GetCurrentMainProcess()}}(MyWay||(MyWay={})),function(t){var e,r,n;e=t.Services||(t.Services={}),r=e.Context||(e.Context={}),n=function(o){function t(){return o.call(this)||this}return __extends(t,o),t.prototype.GetSharedStorage=function(){return this.sendMessage(r.ContextMessageSubject.GetSharedStorage,{})},t.prototype.GetWaitingProcesses=function(){return this.sendMessage(r.ContextMessageSubject.GetWaitingProcesses,{})},t.prototype.GetPortals=function(){return this.sendMessage(r.ContextMessageSubject.GetPortals,{})},t.prototype.GetGlobalStorage=function(){return this.sendMessage(r.ContextMessageSubject.GetGlobalStorage,{})},t.prototype.ClearContext=function(){return this.sendMessage(r.ContextMessageSubject.ClearContext,{})},t.prototype.ClearBus=function(){return this.library.Interop?this.library.Interop.clearBus():this.library.Core.getPromesseSelfResoved()},t.prototype.AddToContext=function(t,e,n){return"string"==typeof e?o.prototype.AddToContext.call(this,t,e):this.sendMessage(r.ContextMessageSubject.AddToContextTech,{level:t,kvp:e,elementId:n})},t.prototype.AddToGlobalContext=function(t){return this.sendMessage(r.ContextMessageSubject.AddToGlobalContext,{kvp:t})},t.prototype.AddToTempoContext=function(t){return this.sendMessage(r.ContextMessageSubject.AddToTempoContext,{kvp:t})},t.prototype.AddToMainProcessContext=function(t,e){return this.sendMessage(r.ContextMessageSubject.AddToMainProcessContext,{key:t,value:e})},t.prototype.AddToProcessStepContext=function(t,e,n){return this.sendMessage(r.ContextMessageSubject.AddToProcessStepContext,{key:t,value:e,processStepId:n})},t.prototype.GetFromMainProcessContext=function(t){return this.sendMessage(r.ContextMessageSubject.GetFromMainProcessContext,{key:t})},t.prototype.GetCurrentMainProcess=function(){return this.sendMessage(r.ContextMessageSubject.GetCurrentMainProcess,{})},t}(r.ContextAgent),r.ContextTechAgent=n,e.Components.RegistryAgent.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-context-display-tech-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var i in t)t.hasOwnProperty(i)&&(e[i]=t[i])};return function(e,t){function i(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(i.prototype=t.prototype,new i)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var o;(o=e.Services||(e.Services={})).ServiceAgentExtended.prototype._diagnostic=null,o.ServiceAgentExtended.prototype.demarrerDiagnostic=function(e,t){var i=this;if(this._diagnostic.stepId!==this.Step.CurrentStepId)return this._diagnostic.previousStepEndTime=this.Step.PreviousStepEndTime,this._diagnostic.stepStartTime=this.Step.StartTime,this._diagnostic.displayTime=this.Step.DisplayTime,this._diagnostic.initTime=t,this._diagnostic.lastDigestCycleTime=t,this._diagnostic.userTime=0,this._diagnostic.codeApplication=e.codeApplication,this._diagnostic.stepId=this.Step.CurrentStepId,this._diagnostic.stepPath=this.Step.CurrentPath,this._diagnostic.finalDiagnostic=this.Step.DiagnosticTraceSentForStep,this._diagnostic.timeBeforeTransition=0,"Connaissance Client Particulier"!==this.Step.NomComposant||e.listenedContextKey||(e.listenedContextKey="MAJSYNTHESENSDK"),this._listenedContextKey=e.listenedContextKey,this.prepareTracesTechniques(),this.Step.Diagnostic&&this.countWatchers(),this.Library.Context.GetFromContext(o.Trace.KEY_TIME_BEFORE_TRANSITION).then(function(e){if(null!==e){var t=Number(e);isNaN(t)||(i._diagnostic.timeBeforeTransition=t),i.Library.Context.AddToContext(o.Trace.KEY_TIME_BEFORE_TRANSITION,"")}})},o.ServiceAgentExtended.prototype.prepareTracesTechniques=function(){var n=this;o.ServiceAgentExtended.logger_extended.info("Fin d'initialisation du serviceAgent"),n._clearWatchListener=n.$rootScope.$watch(function(e,t,i){n._diagnostic.digestCycles++,n._diagnostic.lastDigestCycleTime=Date.now(),n.Step&&n.Step.Diagnostic&&n.Library.Trace.sendDiagnostic(n._diagnostic),n._lastDigestTimerHandle&&window.clearTimeout(n._lastDigestTimerHandle),n._lastDigestTimerHandle=window.setTimeout(function(){n.OnPremiereAction(null)},1e4)}),n.$rootScope.$on("$includeContentLoaded",function(){o.ServiceAgentExtended.logger_extended.debug("$includeContentLoaded")}),n.$rootScope.$on("$viewContentLoaded",function(){o.ServiceAgentExtended.logger_extended.debug("$viewContentLoaded")}),this.ajouteEvenementsUtilisateurs(),this._listenedContextKey&&this.Library.Context.SetContextListener(this._listenedContextKey,this.OnContextEvent)},o.ServiceAgentExtended.prototype.ajouteEvenementsUtilisateurs=function(){var t=this;window.addEventListener("mousedown",function(e){t.OnPremiereAction(e)},!1),window.addEventListener("wheel",function(e){t.OnPremiereAction(e)},!1),window.addEventListener("scroll",function(e){t.OnPremiereAction(e)},!1),window.addEventListener("keypress",function(e){t.OnPremiereAction(e)},!1)},o.ServiceAgentExtended.prototype.retireEvenementsUtilisateurs=function(){var t=this;window.removeEventListener("mousedown",function(e){t.OnPremiereAction(e)},!1),window.removeEventListener("wheel",function(e){t.OnPremiereAction(e)},!1),window.removeEventListener("scroll",function(e){t.OnPremiereAction(e)},!1),window.removeEventListener("keypress",function(e){t.OnPremiereAction(e)},!1)},o.ServiceAgentExtended.prototype.stringify=function(e,t){var i="";return i+="|stepId|"+e.stepId,i+="|digestCycles|"+e.digestCycles,i+="|totalDisplayDuration|"+(e.totalDisplayDuration+e.timeBeforeTransition),i+="|stepStartDuration|"+e.stepStartDuration,i+="|totalStartDuration|"+e.totalStartDuration,t&&t.type?i+="|type|"+t.type:i+="|type|timer",i+="|staticFilesLoadDuration|"+e.staticFilesLoadDuration,i+="|digestDuration|"+e.digestDuration,i+="|userDuration|"+(e.userDuration+e.timeBeforeTransition),i+="|totalUserDuration|"+e.totalUserDuration,i+="|userDurationEnabled|"+e.userDurationEnabled},o.ServiceAgentExtended.prototype.OnPremiereAction=function(e){this._diagnostic.finalDiagnostic||(o.Loggers.FLASH.INSTANCE.setValue("action","ServiceAgentExtended"),o.Loggers.FLASH.INSTANCE.setValue("details",{lastDigestTime:this._diagnostic.lastDigestCycleTime}),o.ServiceAgentExtended.logger_extended.info("fin de chargement de l'application %1",this.stringify(this._diagnostic,e)),this._diagnostic.finalDiagnostic=!0,this.Library.Trace.sendDiagnostic(this._diagnostic)),this._clearWatchListener&&this._clearWatchListener(),this._lastDigestTimerHandle&&window.clearTimeout(this._lastDigestTimerHandle),this.retireEvenementsUtilisateurs()},o.ServiceAgentExtended.prototype.cleanTimers=function(){this._clearWatchListener&&this._clearWatchListener(),this._lastDigestTimerHandle&&window.clearTimeout(this._lastDigestTimerHandle),this.retireEvenementsUtilisateurs(),this._watcherCountTimeout&&window.clearTimeout(this._watcherCountTimeout)},o.ServiceAgentExtended.prototype.countWatchers=function(){var e=this,t=this.Context.AnalyseApp();this._diagnostic.watchers=Math.max(t.TotalWatchers,t.TotalWatchers2,t.TotalWatchers3),this.Library.Trace.sendDiagnostic(this._diagnostic),this._watcherCountTimeout=window.setTimeout(function(){e.countWatchers()},5e3)},o.ServiceAgentExtended.onNewInstance(function(e){e.addListenerBeforeInitialization(function(){this._diagnostic?this.cleanTimers():this._diagnostic=new o.ApplicationDiagnostic}),e.addListenerAfterInitialization(function(e,t){this.Step&&this.demarrerDiagnostic(e,t)})})}(MyWay||(MyWay={})),function(e){var n,o;(n=e.Services||(e.Services={})).Core.defineProperty(n.ServiceAgent,"Trace",{get:function(){return o},set:function(){}}),n.onInitUsableLoggerForServiceAgent=function(e,t){var i;i=t||"LocalLauncher",o=new n.Trace.Logger(i,"Application",e.Library)}}(MyWay||(MyWay={})),function(e){var t;((t=e.Services||(e.Services={})).Trace||(t.Trace={})).KEY_TIME_BEFORE_TRANSITION="TempsAvantTransition"}(MyWay||(MyWay={})),function(e){var r,t,i;r=e.Services||(e.Services={}),t=r.Trace||(r.Trace={}),i=function(o){function e(){var e=o.call(this,r.Components.ComponentType.Trace)||this;return e.regExpSTC=/^MyWay\.Services\./,e}return __extends(e,o),e.prototype.init=function(e,t,i){var n=this;return this._application=i.codeApplication,this._applicationVersion=i.applicationVersion,o.prototype.init.call(this,e,t,i).then(function(){r.Loggers.Appenders.BroadcastAppender.METHODE_PURGE_TRACES=function(e){n.sendLog(e)}})},e.prototype.dispose=function(){return r.Loggers.Appenders.BroadcastAppender.METHODE_PURGE_TRACES=null,this.library.Core.getPromesseSelfResoved()},e.prototype.send=function(e){return r.CoreCommon.ServiceDePromesse.defer(),this.sendMessage(t.Messages.TraceMessageSubject.Tracer,{trace:e})},e.prototype.sendLog=function(e){return r.CoreCommon.ServiceDePromesse.defer(),this.sendMessage(t.Messages.TraceMessageSubject.Logger,{log:e})},e.prototype.sendDiagnostic=function(e){return this.sendMessage(t.Messages.TraceMessageSubject.SendDiagnostic,{diagnostic:e})},e.prototype.setTempsAvantTransition=function(e){return this.library.Context.AddToContext(t.KEY_TIME_BEFORE_TRANSITION,e.toString())},e}(r.Components.ComponentAgentBase),t.TraceAgent=i,r.Components.RegistryAgent.getInstance().register(i)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(e,t){function o(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(s){var a,e,m,u,t;a=s.Services||(s.Services={}),e=a.BriqueCommunication||(a.BriqueCommunication={}),m=e.Chat||(e.Chat={}),u=function(){function e(e,t,o,r,i,s){var n=this;this.producerConsumer=e,this.chatroom=t,this.onGetDivVideo=o,this.onCloseVideo=r,this.myUserId=i,this.userDistantId=s,this.onAcceptOffer=function(){n.aDemarre=!0,n.webRTCLib.createStream({audio:!0,video:!0},function(e){n.localStream=e,null===n.chatroom.streamLocal&&(n.chatroom.streamLocal=e,null!==n.chatroom.htmlElementStream?WebRtcCDN.WebRTCLib.attachStream(n.chatroom.streamLocal,n.chatroom.htmlElementStream):n.onGetDivVideo({cestmoi:!0,chatroom_id:n.chatroom.id,user_id:n.myUserId,doitLancerAutresVideos:!0}))},function(e){n.remoteStream=e,n.remoteStreamVideo?WebRtcCDN.WebRTCLib.attachStream(e,n.remoteStreamVideo):n.onGetDivVideo({cestmoi:!1,chatroom_id:n.chatroom.id,user_id:n.userDistantId,doitLancerAutresVideos:!0})})},this.onClose=function(){n.aDemarre=!1,n.onCloseVideo()},this.aDemarre=!1,this.webRTCLib=new WebRtcCDN.WebRTCLib(e),this.init()}return e.prototype.start=function(e){this.aDemarre?(this.onGetDivVideo({cestmoi:!0,chatroom_id:this.chatroom.id,user_id:this.myUserId,doitLancerAutresVideos:e}),this.onGetDivVideo({cestmoi:!1,chatroom_id:this.chatroom.id,user_id:this.userDistantId,doitLancerAutresVideos:e})):this.createOffer()},e.prototype.close=function(){this.webRTCLib.close()},e.prototype.getLocalStream=function(){return this.localStream},e.prototype.setVideoElement=function(e){this.remoteStreamVideo,this.remoteStreamVideo=e,this.remoteStream&&WebRtcCDN.WebRTCLib.attachStream(this.remoteStream,this.remoteStreamVideo)},e.prototype.init=function(){this.webRTCLib.onAcceptOffer(this.onAcceptOffer),this.webRTCLib.onClose(this.onClose)},e.prototype.createOffer=function(){var t=this;this.aDemarre=!0,this.webRTCLib.createStream({audio:!0,video:!0},function(e){t.localStream=e,null===t.chatroom.streamLocal&&(t.chatroom.streamLocal=e,null!==t.chatroom.htmlElementStream?WebRtcCDN.WebRTCLib.attachStream(t.chatroom.streamLocal,t.chatroom.htmlElementStream):t.onGetDivVideo({cestmoi:!0,chatroom_id:t.chatroom.id,user_id:t.myUserId,doitLancerAutresVideos:!0})),t.webRTCLib.createOffer()},function(e){t.remoteStream=e,t.remoteStreamVideo?WebRtcCDN.WebRTCLib.attachStream(e,t.remoteStreamVideo):t.onGetDivVideo({cestmoi:!1,chatroom_id:t.chatroom.id,user_id:t.userDistantId,doitLancerAutresVideos:!0})})},e.CLASS_NAME="MyWay.Services.BriqueCommunication.Chat.VideoRoom",e.logger=a.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(),t=function(i){function c(){var e=i.call(this,a.Components.ComponentType.Chat)||this;return e.noop=function(){},e.producersConsumers=[],e.producersConsumersById={},e.promesseCodeAgent=null,e.numMessage=0,e}return __extends(c,i),c.prototype.init=function(e,t,o){var r=this;return i.prototype.init.call(this,e,t,o).then(function(){r.library.Context.SubscribeToNotification([function(e){"NotificationEvent"===e.Sujet&&r.traiterEvennement(e)}],null)})},c.prototype.sendNotification=function(e){var t={mainEventType:a.BriqueCommunication.Messages.EVENT_TYPE.CHAT,event:e};this.library.Context.sendNotification({Sujet:"NotificationEvent",type:s.Services.CommonEventType.BriqueCommunication,Contenu:t})},c.prototype.addChatCapacity=function(){this.sendMessage(m.ChatMessageSubject.AddChatCapacity,{})},c.prototype.getMe=function(){var t=this;return this.promesseCodeAgent||(this.promesseCodeAgent=this.library.Context.getAuthentificationInfo().then(function(e){return t.getMyCode(e)})),this.promesseCodeAgent},c.prototype.setStatut=function(e){return this.sendMessage(m.ChatMessageSubject.SetStatut,{statut:e})},c.prototype.openChat=function(e){return this.sendMessage(m.ChatMessageSubject.OpenChat,{destinataire:e})},c.prototype.openTchatroom=function(e){return this.sendMessage(m.ChatMessageSubject.OpenChatroom,{idChat:e})},c.prototype.closeChat=function(e){var t=this.producersConsumersById[e];if(t)for(var o in t.videorooms)t.videorooms[o].close();return this.sendMessage(m.ChatMessageSubject.CloseChat,{idChat:e})},c.prototype.sendMessageChat=function(e,t){return this.sendMessage(m.ChatMessageSubject.SendMessage,{idChat:e,message:t})},c.prototype.getUtilisateurs=function(){return this.sendMessage(m.ChatMessageSubject.GetUtilisateurs,{})},c.prototype.getChatrooms=function(){return this.sendMessage(m.ChatMessageSubject.GetChatrooms,{})},c.prototype.getChatroom=function(e){return this.sendMessage(m.ChatMessageSubject.GetChatroom,{chatroom_id:e})},c.prototype.accepterInvitationExpert=function(e,t,o){return this.sendMessage(m.ChatMessageSubject.AccepterDemanderExpert,{chatroom_id:e,domaine:t,prospect_id:o})},c.prototype.inviterPersonnesAUneChatroom=function(e){for(var t=[],o=1;o<arguments.length;o++)t[o-1]=arguments[o];return this.sendMessage(m.ChatMessageSubject.InviterPersonnesAUneChatroom,{chatroom_id:e,users_id:t})},c.prototype.setHtmlElementVideo=function(e,o,r){var i=this.producersConsumersById[e];i&&this.getMe().then(function(e){if(o===e)return i.htmlElementStream=r,void(null!==i.streamLocal&&WebRtcCDN.WebRTCLib.attachStream(i.streamLocal,i.htmlElementStream));var t=i.videorooms[o];t&&t.setVideoElement(r)})},c.prototype.commencerVideo=function(e){var t=this.producersConsumersById[e];if(t){for(var o in t.videorooms)t.videorooms[o].start(!1);this.sendMessage(m.ChatMessageSubject.DemarrerVideoChatroom,{idChat:e})}},c.prototype.arreterVideo=function(e){var t=this.producersConsumersById[e];if(t){for(var o in t.videorooms)t.videorooms[o].close();this.sendMessage(m.ChatMessageSubject.ArreterVideoChatroom,{idChat:e})}},c.prototype.devenirFramePrincipalePourChatroomVideo=function(e){this.sendMessage(m.ChatMessageSubject.PrendreLaMainVideoroom,{idChat:e})},c.prototype.reception=function(e){switch(e.subject){case m.ChatMessageSubject.AddChatCapacity:var t=e.message;return this.handleMessageWebRTC(t),this.library.Core.getPromesseSelfResoved();default:return i.prototype.reception.call(this,e)}},c.prototype.traiterEvennement=function(e){switch(e.type){case s.Services.CommonEventType.BriqueCommunication:this.traiterEvennementBriqueCommunication(e)}},c.prototype.traiterEvennementBriqueCommunication=function(e){switch(e.Contenu.mainEventType){case s.Services.BriqueCommunication.Messages.EVENT_TYPE.CHAT:this.traiterEvennementChat(e.Contenu.event)}},c.prototype.traiterEvennementChat=function(e){switch(e.eventType){case s.Services.BriqueCommunication.Chat.Messages.EVENT_TYPE.CHAT_OUVERT:var t=e;this.etablirVideorooms(t.chatroom_id,t.membres,t.estFramePrincipale);break;case s.Services.BriqueCommunication.Chat.Messages.EVENT_TYPE.CHAT_FERME:t=e,this.terminerToutesVideorooms(t.chatroom_id);break;case s.Services.BriqueCommunication.Chat.Messages.EVENT_TYPE.UTILISATEUR_CONNECTE_A_CHAT:var o=e;this.ajouterVideoroom(o.chatroom_id,o.user_id,o.estFramePrincipale);break;case s.Services.BriqueCommunication.Chat.Messages.EVENT_TYPE.UTILISATEUR_DECONNECTE_A_CHAT:var r=e;this.terminerVideoroom(r.chatroom_id,r.user_id);break;case s.Services.BriqueCommunication.Chat.Messages.EVENT_TYPE.CHANGEMENT_MAIN_CHATROOM:var i=e;this.changementMainChatroom(i.chatroom_id,i.estFramePrincipale,i.videoEstEnCours)}},c.prototype.changementMainChatroom=function(o,r,e){var i=this,s=this.producersConsumersById[o];if(s){var n=[];s.membres.forEach(function(e){var t=s.videorooms[e];!r&&t?(t.close(),delete s.videorooms[e]):r&&!t&&n.push(i.ajouterVideoroom(o,e,r))}),r&&e&&a.CoreCommon.ServiceDePromesse.all(n).then(function(){i.commencerVideo(o)})}},c.prototype.ajouterVideoroom=function(i,s,e){var n=this,a=this.producersConsumersById[i];a||(a={id:i,htmlElementStream:null,streamLocal:null,videorooms:{},membres:[]},this.producersConsumersById[i]=a);var t=!1;if(a.membres.every(function(e){return e===s&&(t=!0),t}),t||a.membres.push(s),e)return this.getMe().then(function(r){if(r!==s){var e=a.videorooms[s];if(!e){var t={producer:function(e){c.logger.debug("Emission %1",JSON.pruned(e));var t=JSON.stringify(e);n.sendMessage(m.ChatMessageSubject.EnvoyerMessageVideoroom,{chatroom_id:i,user_id:s,message:t})},setConsumer:function(e){t.consumer=e},consumer:function(){}},o=new u(t,a,function(e){if(n.sendNotification({eventType:m.Messages.EVENT_TYPE.CHAT_DIV_ELEMENT,cestmoi:e.cestmoi,chatroom_id:e.chatroom_id,user_id:e.user_id}),e.doitLancerAutresVideos)for(var t in a.videorooms)if(t!==s){var o=!1;/^agent/.test(t)||(o=!0),r.localeCompare(t)<0&&(o=!0),o&&a.videorooms[t].start(!1)}},function(){if(delete a.videorooms[s],a.streamLocal===o.getLocalStream())for(var e in a.videorooms){var t=a.videorooms[e].getLocalStream();if(t){a.streamLocal=t,n.sendNotification({eventType:m.Messages.EVENT_TYPE.CHAT_DIV_ELEMENT,cestmoi:!0,chatroom_id:a.id,user_id:r});break}}n.sendNotification({eventType:m.Messages.EVENT_TYPE.FIN_VIDEOROOM,chatroom_id:a.id,user_id:s})},r,s);return a.videorooms[s]=o,a.membres.push(s),e}}})},c.prototype.terminerVideoroom=function(e,t){var o=this.producersConsumersById[e];if(o){var r=o[t];r&&(r.close(),delete o[t])}},c.prototype.getMyCode=function(e){return"agent-S"+this.library.Core.StringUtils.leftPad(e.agentConnecte.referenceExterneAgent,"0",7)},c.prototype.etablirVideorooms=function(o,e,r){var i=this;this.getMe().then(function(t){e.forEach(function(e){e!==t&&i.ajouterVideoroom(o,e,r)})})},c.prototype.terminerToutesVideorooms=function(e){var t=this.producersConsumersById[e];if(t)for(var o in t.videorooms)t.videorooms[o].close()},c.prototype.handleMessageWebRTC=function(e){var t=this.producersConsumersById[e.chatroom_id];if(t){var o=t.videorooms[e.user_id];o&&o.producerConsumer&&o.producerConsumer.consumer&&(c.logger.debug("EmissionReception %1",JSON.pruned(e)),o.producerConsumer.consumer(JSON.stringify(e.content)))}},c.CLASS_NAME="MyWay.Services.BriqueCommunication.Chat.ChatAgent",c.logger=a.Loggers.LoggerFactory.INSTANCE.getClass(c.CLASS_NAME),c}(a.Components.ComponentAgentBase),m.ChatAgent=t,a.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var o,t,r,i;o=e.Services||(e.Services={}),t=o.BriqueCommunication||(o.BriqueCommunication={}),r=t.Notification||(t.Notification={}),i=function(e){function t(){return e.call(this,o.Components.ComponentType.Notification)||this}return __extends(t,e),t.prototype.abonnement=function(e){return this.sendMessage(r.NotificationMessageSubject.Abonnement,{subject:e})},t.prototype.desabonnement=function(e){return this.sendMessage(r.NotificationMessageSubject.Desabonnement,{subject:e})},t.prototype.getListeSujets=function(){return this.sendMessage(r.NotificationMessageSubject.GetListeSubjects,{})},t}(o.Components.ComponentAgentBase),r.NotificationAgent=i,o.Components.RegistryAgent.getInstance().register(i)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-brique-communication-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var c;(function(e){var n;e.URLBASE_CONFIGURATION="ws://126.246.166.113:8000/jms",e.TOPIC_CONFIGURATION_GENERALE="/topic/BGC_CONFIGURATION",(n=e.KaazingCanalType||(e.KaazingCanalType={}))[n.JMS=0]="JMS";var t,o=function(){function e(e){var n=this;this._close=e,this._reader=null,this._lastMessage=null,this._hasMessage=!1,this._reader=function(e){n._lastMessage=e,n._hasMessage=!0}}return Object.defineProperty(e.prototype,"reader",{get:function(){return this._reader},set:function(e){this._reader=e,this._hasMessage&&this._reader(this._lastMessage)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"close",{get:function(){return this._close},enumerable:!0,configurable:!0}),e}(),r=function(t){function e(e){var n=t.call(this,e)||this;return n.writer=null,n}return __extends(e,t),e}(e.CanalControlerReadOnly=o);e.CanalControler=r,(t=e.InfosAgentType||(e.InfosAgentType={}))[t.CLIENT="CLIENT"]="CLIENT",t[t.ADVISER="ADVISOR"]="ADVISER",t[t.EXPERT="EXPERT"]="EXPERT",t[t.PROSPECT="PROSPECT"]="PROSPECT";var i=function(e){function s(){return e.call(this,c.Components.ComponentType.BriqueCommunication)||this}return __extends(s,e),s.prototype.connect=function(a,n){var t=this;return c.CoreCommon.promesseTryCatch(function(o){var e=new JmsConnectionFactory(a);if(s.logger.debug("Création de la connexion vers %1",a),a.match("jmssec")){var r=t.generateToken(n);e.getWebSocketFactory().setChallengeHandler(new function(){this.canHandle=function(e){return null!=e&&"token"==e.authenticationScheme.trim().toLowerCase()},this.handle=function(e,n){var t=null;null!=e.location&&null!=r&&(t=new ChallengeResponse("Token "+r,null)),n(t)}})}var i=e.createConnection(function(){s.logger.debug("Connexion OK de %1",a);try{var n=i.getValue(),e=n.createSession(!1,Session.AUTO_ACKNOWLEDGE),t=e.close;e.close=function(e){return t(function(){n.close(e)})},n.start(function(){o.resolve(e)})}catch(e){s.logger.error("Erreur: %1",JSON.pruned(e))}})})},s.prototype.generateToken=function(e){var n=c.CoreCommon.StringUtils.leftPad(e.agentConnecte.referenceExterneAgent,"0",7);return JSON.stringify({login:"agent-S"+n,userid:"agent-S"+n,type:"CLIENT",token:"token",establishment:e.codeEtablissement})},s.CLASS_NAME="MyWay.Services.BriqueCommunication.BriqueCommunicationApi",s.logger=c.Loggers.LoggerFactory.INSTANCE.getClass(s.CLASS_NAME),s}(c.Components.ComponentApiBase);e.BriqueCommunicationApi=i,c.Components.RegistryApi.getInstance().register(i)})((c=e.Services||(e.Services={})).BriqueCommunication||(c.BriqueCommunication={}))}(MyWay||(MyWay={})),function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-brique-communication-api.min.js.map
var MyWay;!function(e){var a,t;a=e.Services||(e.Services={}),((t=a.Components||(a.Components={})).ComponentType||(t.ComponentType={})).Capacites="Capacites"}(MyWay||(MyWay={})),function(e){var a,t,C,E;a=e.Services||(e.Services={}),t=a.Capacites||(a.Capacites={}),C=t.Messages||(t.Messages={}),(E=C.CapacitesMessageSubject||(C.CapacitesMessageSubject={}))[E.GetCapacite=0]="GetCapacite",a.Components.FactoryRegistries.getInstance().declareComponent(a.Components.ComponentType.Capacites,[a.Components.ComponentType.Context,a.Components.ComponentType.Mobilite])}(MyWay||(MyWay={})),function(e){var a,t,C;a=e.Services||(e.Services={}),t=a.Capacites||(a.Capacites={}),(C=t.REGLE||(t.REGLE={}))[C.INTEROP_APPLI_BANCAIRE=0]="INTEROP_APPLI_BANCAIRE",C[C.INTEROP_WINDOWS=1]="INTEROP_WINDOWS",C[C.TABLETTE_SIGNATURE=2]="TABLETTE_SIGNATURE",C[C.CAISSE_AUTO=3]="CAISSE_AUTO",C[C.CONNECTE=4]="CONNECTE",C[C.MODIFIER_HABILITATION=5]="MODIFIER_HABILITATION",C[C.ECRAN_COMPATIBLE_MYWAY=6]="ECRAN_COMPATIBLE_MYWAY",C[C.RESEAU_INTERNE=7]="RESEAU_INTERNE",C[C.PORTAIL_MYWAY=8]="PORTAIL_MYWAY"}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-capacites-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])};return function(e,t){function s(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}}();!function(e){var t,i,s;t=e.Services||(e.Services={}),i=t.Mobilite||(t.Mobilite={}),s=function(e){function s(){return e.call(this,t.Components.ComponentType.Mobilite)||this}return __extends(s,e),s.prototype.getCaissesAuto=function(){return this.sendMessage(i.Messages.MobiliteMessageSubject.GetPeripheriquesParType,{typePeripherique:i.TYPE_PERIPHERIQUE.CAISSE_AUTO})},s.prototype.getInfoMachine=function(){return this.sendMessage(i.Messages.MobiliteMessageSubject.GetInfoMachine,{})},s.prototype.GetPeripheriques=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];return s.logger.debug("Attention, cette méthode est dépréciée, Il faut utiliser la méthode mobilite.getPeripheriques()"),this.getPeripheriques.apply(this,e)},s.prototype.getPeripheriques=function(){return this.sendMessage(i.Messages.MobiliteMessageSubject.GetPeripheriques,{})},s.prototype.getReseau=function(){return this.sendMessage(i.Messages.MobiliteMessageSubject.GetReseau,{})},s.prototype.getTablettesSignature=function(e){return this.sendMessage(i.Messages.MobiliteMessageSubject.GetPeripheriquesParType,{typePeripherique:i.TYPE_PERIPHERIQUE.TABLETTE_SIGNATURE,params:e})},s.CLASS_NAME="MyWay.Services.Mobilite.MobiliteAgent",s.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(s.CLASS_NAME),s}(t.Components.ComponentAgentBase),i.MobiliteAgent=s,t.Components.RegistryAgent.getInstance().register(s)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-mobilite-agent.min.js.map
var MyWay;!function(e){var n,o;n=e.Services||(e.Services={}),o=function(){},(n.TraceSuivi||(n.TraceSuivi={})).TraceSuiviModel=o}(MyWay||(MyWay={})),function(e){var n,o;n=e.Services||(e.Services={}),((o=n.Components||(n.Components={})).ComponentType||(o.ComponentType={})).TraceSuivi="TraceSuivi"}(MyWay||(MyWay={})),function(e){var n,o,i,a;n=e.Services||(e.Services={}),o=n.TraceSuivi||(n.TraceSuivi={}),i=o.Messages||(o.Messages={}),(a=i.TraceSuiviMessageSubject||(i.TraceSuiviMessageSubject={}))[a.SendTraceSuivi=0]="SendTraceSuivi",a[a.SendTraceSuiviForcee=1]="SendTraceSuiviForcee",n.Components.FactoryRegistries.getInstance().declareComponent(n.Components.ComponentType.TraceSuivi,[n.Components.ComponentType.Context,n.Components.ComponentType.Core,n.Components.ComponentType.Mobilite,n.Components.ComponentType.BaseDeDonnees])}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-suivi-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var t in s)s.hasOwnProperty(t)&&(e[t]=s[t])};return function(e,s){function t(){this.constructor=e}n(e,s),e.prototype=null===s?Object.create(s):(t.prototype=s.prototype,new t)}}();!function(i){var r,o,e;r=i.Services||(i.Services={}),o=r.Acquisition||(r.Acquisition={}),e=function(n){function e(){var e=n.call(this,r.Components.ComponentType.Acquisition)||this;return e.defers={},e}return __extends(e,n),e.prototype.appelRADLAD=function(e,s){return this.sendMessage(o.Messages.AcquisitionMessageSubject.AppelRADLAD,{fileInfos:e,params:s})},e.prototype.convertFileToImg=function(e,s,t){return void 0===s&&(s=null),void 0===t&&(t=!0),null===s&&(s={dpi:300,quality:90,thumbQuality:30}),this.sendMessage(o.Messages.AcquisitionMessageSubject.ConvertFileToImg,{fileInfo:e,params:s,autoriseDocumentSigne:t})},e.prototype.mergerEtArchiver=function(e,s){return this.sendMessage(o.Messages.AcquisitionMessageSubject.MergerEtArchiver,{fileInfos:e,putDocumentInput:s})},e.prototype.mergerEtUploader=function(e){return this.sendMessage(o.Messages.AcquisitionMessageSubject.MergerEtUploader,{fileInfos:e})},e.prototype.convertBase64ToBin=function(e){return this.sendMessage(o.Messages.AcquisitionMessageSubject.ConvertBase64ToBin,{urls:e})},e.prototype.purge=function(e){return void 0===e&&(e=8),this.sendMessage(o.Messages.AcquisitionMessageSubject.Purge,{hour:e})},e.prototype.fermetureSpiFactory=function(){return this.sendMessage(o.Messages.AcquisitionMessageSubject.FermetureSpiFactory,{})},e.prototype.setConfigurationScanner=function(e){return this.sendMessage(o.Messages.AcquisitionMessageSubject.SetConfigurationScanner,{typeScanner:e})},e.prototype.mergeAndOpenPDF=function(e){var s=this;return this.sendMessage(o.Messages.AcquisitionMessageSubject.MergeAndOpenPDF,{params:e}).then(function(e){return{guid:e,promise:s.getProcessingTask(e)}},function(e){throw e})},e.prototype.recupereListeDocumentGED=function(e,s){return this.sendMessage(o.Messages.AcquisitionMessageSubject.RecupereListeDocumentGED,{params:e,formatResultat:s}).catch(function(e){throw e})},e.prototype.ouvrirListeDocumentGED=function(e,s,t){return this.sendMessage(o.Messages.AcquisitionMessageSubject.OuvrirListeDocumentGED,{params:e,formatResultat:s,formatOuverture:t}).catch(function(e){throw e})},e.prototype.getDocumentGedAndOpen=function(e){var s=this;return this.sendMessage(o.Messages.AcquisitionMessageSubject.GetDocumentGEDAndOpen,{params:e}).then(function(e){return{guid:e,promise:s.getProcessingTask(e)}},function(e){throw e})},e.prototype.getProcessingTask=function(s){var t=this;return this.defers[s]?this.defers[s].promise:r.Promesses.promesseTryCatch(function(e){t.defers[s]=e,t.sendMessage(o.Messages.AcquisitionMessageSubject.GetProcessingTask,{guid:s})})},e.prototype.getDocumentGEDAndSave=function(e){return this.sendMessage(o.Messages.AcquisitionMessageSubject.GetDocumentGEDAndSave,{params:e})},e.prototype.getListeScanner=function(e){return this.sendMessage(o.Messages.AcquisitionMessageSubject.GetListeScanner,{checkRemote:e})},e.prototype.isPrisEnMainADistance=function(){return this.sendMessage(o.Messages.AcquisitionMessageSubject.IsPrisEnMainADistance,{})},e.prototype.getDocumentGedSaveAtAndOpen=function(e){return this.sendMessage(o.Messages.AcquisitionMessageSubject.GetDocumentGEDAtAndOpen,{params:e}).catch(function(e){throw e})},e.prototype.uploadDocumentFrom=function(e){return this.sendMessage(o.Messages.AcquisitionMessageSubject.UploadDocumentFrom,{cheminDuFichierSurLePoste:e}).catch(function(e){throw e})},e.prototype.reception=function(e){if(e.subject!==o.Messages.AcquisitionMessageSubject.ChangeState)return n.prototype.reception.call(this,e);var s=e.message;if(s.state===o.Messages.END_STATE)return this.defers[s.guid].resolve(s),delete this.defers[s.guid],r.Promesses.createPromiseSelfResolved();if(s.state!==o.Messages.ERROR)return this.defers[s.guid].notify(s),r.Promesses.createPromiseSelfResolved();var t=new i.Services.Erreur(s.detail);return this.defers[s.guid].reject(t),delete this.defers[s.guid],r.Promesses.createPromiseSelfError(t)},e.prototype.isDocumentSigne=function(e){return this.sendMessage(o.Messages.AcquisitionMessageSubject.IsDocumentSigne,{fileinfos:e}).catch(function(e){throw e})},e}(r.Components.ComponentAgentBase),o.AcquisitionAgent=e,r.Components.RegistryAgent.getInstance().register(e)}(MyWay||(MyWay={})),function(e){var s;(s=e.Services||(e.Services={})).Bug||(s.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-acquisition-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t,i,r;t=e.Services||(e.Services={}),i=t.Acquisition||(t.Acquisition={}),r=function(o){function e(){var e=o.call(this,t.Components.ComponentType.Acquisition)||this;return e.api=null,e}return __extends(e,o),e.prototype.init=function(e,t,r){var n=this;return e.ServiceLocal?this.api=new i.AcquisitionApiWindows:this.api=new i.AcquisitionApiFullWeb,o.prototype.init.call(this,e,t,r).then(function(){return n.api.initApi(t)})},e.prototype.initApi=function(e){},e.prototype.recuperationImageKofax=function(e){return this.api.recuperationImageKofax(e)},e.prototype.creerImagesBitonales=function(e,t){return this.api.creerImagesBitonales(e,t)},e.prototype.traitementRADLAD=function(e,t,r){return this.api.traitementRADLAD(e,t,r)},e.prototype.convertFileToImg=function(e,t,r){return this.api.convertFileToImg(e,t,r)},e.prototype.mergerPdfs=function(e){return this.api.mergerPdfs(e)},e.prototype.mergerDocuments=function(e,t){return this.api.mergerDocuments(e,t)},e.prototype.manipulerArchives=function(e,t,r){return this.api.manipulerArchives(e,t,r)},e.prototype.archiver=function(e,t){return this.api.archiver(e,t)},e.prototype.convertBase64ToBin=function(e){return this.api.convertBase64ToBin(e)},e.prototype.purge=function(e){return this.api.purge(e)},e.prototype.fermetureSpiFactory=function(){return this.api.fermetureSpiFactory()},e.prototype.setConfigurationScanner=function(e){return this.api.setConfigurationScanner(e)},e.prototype.retrieveGedDocument=function(e,t,r){return this.api.retrieveGedDocument(e,t,r)},e.prototype.saveDocument=function(e){return this.api.saveDocument(e)},e.prototype.saveDocumentGedAtAndOpen=function(e){return this.api.saveDocumentGedAtAndOpen(e)},e.prototype.uploadDocumentFrom=function(e){return this.api.uploadDocumentFrom(e)},e.prototype.openDocument=function(e){return this.api.openDocument(e)},e.prototype.isPrisEnMainADistance=function(){return this.api.isPrisEnMainADistance()},e.prototype.getListeScanner=function(e){return this.api.getListeScanner(e)},e.prototype.isDocumentSigne=function(e){return this.api.isDocumentSigne(e)},e}(t.Components.ComponentApiBase),i.AcquisitionApiFactory=r,t.Components.RegistryApi.getInstance().register(r)}(MyWay||(MyWay={})),function(e){var o,t,r;o=e.Services||(e.Services={}),t=o.Acquisition||(o.Acquisition={}),r=function(){function e(){this.libraryManager=null}return e.prototype.initApi=function(e){this.libraryManager=e},e.prototype.recuperationImageKofax=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return t.resolve(),t.promise},e.prototype.creerImagesBitonales=function(e,t){var r=o.CoreCommon.ServiceDePromesse.defer();return r.resolve(),r.promise},e.prototype.traitementRADLAD=function(e,t,r){var n=o.CoreCommon.ServiceDePromesse.defer();return n.resolve(),n.promise},e.prototype.convertFileToImg=function(e,t,r){var n=o.CoreCommon.ServiceDePromesse.defer();return n.resolve(),n.promise},e.prototype.mergerPdfs=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return t.resolve(),t.promise},e.prototype.mergerDocuments=function(e,t){var r=o.CoreCommon.ServiceDePromesse.defer();return r.resolve(),r.promise},e.prototype.manipulerArchives=function(e,t,r){var n=o.CoreCommon.ServiceDePromesse.defer();return n.resolve(),n.promise},e.prototype.archiver=function(e,t){var r=o.CoreCommon.ServiceDePromesse.defer();return r.resolve(),r.promise},e.prototype.convertBase64ToBin=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return t.resolve(),t.promise},e.prototype.purge=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return t.resolve(),t.promise},e.prototype.fermetureSpiFactory=function(){var e=o.CoreCommon.ServiceDePromesse.defer();return e.resolve(),e.promise},e.prototype.setConfigurationScanner=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return t.resolve(),t.promise},e.prototype.retrieveGedDocument=function(e,t,r){var n=o.CoreCommon.ServiceDePromesse.defer();return n.resolve(),n.promise},e.prototype.saveDocument=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return t.resolve(),t.promise},e.prototype.saveDocumentGedAtAndOpen=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return t.resolve(),t.promise},e.prototype.uploadDocumentFrom=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return t.resolve(),t.promise},e.prototype.openDocument=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return t.resolve(),t.promise},e.prototype.isPrisEnMainADistance=function(){var e=o.CoreCommon.ServiceDePromesse.defer();return e.resolve(),e.promise},e.prototype.getListeScanner=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return t.resolve(),t.promise},e.prototype.isDocumentSigne=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return t.resolve(),t.promise},e}(),t.AcquisitionApiFullWeb=r}(MyWay||(MyWay={})),function(e){var o,t,r;o=e.Services||(e.Services={}),t=o.Acquisition||(o.Acquisition={}),r=function(){function e(){this.libraryManager=null,this._url=o.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/acquisition/",this._RADLADUrl=o.PrivatePortalServiceParameters.Instance().RADLADUrl,this._StockageUrl=o.PrivatePortalServiceParameters.Instance().StockageUrl,this._GedUrl=o.PrivatePortalServiceParameters.Instance().GedUrl}return e.prototype.initApi=function(e){this.libraryManager=e},e.prototype.recuperationImageKofax=function(e){var t={url:this._url+"/RecuperationImageKofax",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify(e),cache:!1};return this.libraryManager.Core.sendRequest(t)},e.prototype.creerImagesBitonales=function(e,t){var r={url:this._url+"/CreerImagesBitonales",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify({base64List:JSON.parse(e),creerImageBitonalParams:t})};return this.libraryManager.Core.sendRequest(r)},e.prototype.traitementRADLAD=function(e,t,r){var n={url:this._RADLADUrl,method:o.MethodEnum.POST,data:{docElect:e,activationVRS:t.activationVRS,activationLAD:t.activationLAD,typeDocumentRAD:t.typeDocumentRAD},withHeaders:!0,authentificationInfo:r};return e.forEach(function(e){e.replace(/(?:\r\n|\r|\n)/g,"")}),this.libraryManager.Core.sendRequest(n)},e.prototype.convertFileToImg=function(e,t,r){var n={url:this._url+"/ConvertFileToImg",method:o.MethodEnum.POST,async:!0,timeout:6e4,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify({fileInfo:e,convertFileParams:t,autoriseDocumentSigne:r})};return this.libraryManager.Core.sendRequest(n)},e.prototype.mergerPdfs=function(e){var t={url:this._url+"/MergerPdfs",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify(e),timeout:12e4};return this.libraryManager.Core.sendRequest(t)},e.prototype.mergerDocuments=function(e,t){var r={url:this._url+"/MergerDocuments",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify({mergeFileInfo:e,formatResultatMerge:t}),timeout:12e4};return this.libraryManager.Core.sendRequest(r)},e.prototype.manipulerArchives=function(e,t,r){var n={url:this._url+"/ManipulerArchives",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify({mergeFileInfo:e,formatResultatMerge:t,systemeOuvertureArchive:r}),timeout:12e4};return this.libraryManager.Core.sendRequest(n)},e.prototype.archiver=function(e,t){var r={withHeaders:!0,url:this._StockageUrl,method:o.MethodEnum.PUT,data:e,authentificationInfo:t,timeout:12e4};return this.libraryManager.Core.sendRequest(r)},e.prototype.convertBase64ToBin=function(e){var t={url:this._url+"/ConvertBase64ToBin",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify(e)};return this.libraryManager.Core.sendRequest(t)},e.prototype.purge=function(e){var t={url:this._url+"/Purge",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify(e)};return this.libraryManager.Core.sendRequest(t)},e.prototype.fermetureSpiFactory=function(){var e={url:this._url+"/FermetureSpiFactory",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON};return this.libraryManager.Core.sendRequest(e)},e.prototype.setConfigurationScanner=function(e){var t={url:this._url+"/SetConfigurationScanner?typeScanner="+e,method:o.MethodEnum.POST};return this.libraryManager.Core.sendRequest(t)},e.prototype.retrieveGedDocument=function(e,t,r){var n={url:this._GedUrl,method:o.MethodEnum.GET,timeout:12e4,withHeaders:!0,params:{idDocument:t.id,codeApplication:e,indicateurDocument:!0}};return void 0!==t.nature&&null!==t.nature&&(n.params.codeTypeNatrDoc=t.nature),this.libraryManager.Core.sendRequest(n).catch(function(e){throw e})},e.prototype.saveDocument=function(e){var t={url:this._url+"/SaveDocument",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify(e),timeout:6e4};return this.libraryManager.Core.sendRequest(t)},e.prototype.saveDocumentGedAtAndOpen=function(e){var t={url:this._url+"/SaveDocumentGedAtAndOpen",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify(e),timeout:6e4};return this.libraryManager.Core.sendRequest(t)},e.prototype.uploadDocumentFrom=function(e){var t={url:this._url+"/UploadDocumentFrom",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify(e),timeout:6e4};return this.libraryManager.Core.sendRequest(t)},e.prototype.openDocument=function(e){var t={url:this._url+"/OpenDocument",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify(e),timeout:6e4};return this.libraryManager.Core.sendRequest(t)},e.prototype.getListeScanner=function(e){var t={url:this._url+"/GetListeScanner/?checkRemote="+e,method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON};return this.libraryManager.Core.sendRequest(t)},e.prototype.isPrisEnMainADistance=function(){var e={url:this._url+"/IsPrisEnMainADistance",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON};return this.libraryManager.Core.sendRequest(e)},e.prototype.isDocumentSigne=function(e){var t={url:this._url+"/IsDocumentSigne",method:o.MethodEnum.POST,async:!0,contentType:o.ContentTypeEnum.JSON,data:JSON.stringify(e),timeout:6e4};return this.libraryManager.Core.sendRequest(t)},e}(),t.AcquisitionApiWindows=r}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-acquisition-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t,i,n;t=e.Services||(e.Services={}),i=t.Interop||(t.Interop={}),n=function(r){function e(){var e=r.call(this,t.Components.ComponentType.Interop)||this;return e.wrapped=null,e}return __extends(e,r),e.prototype.init=function(e,t,n){var o=this;return e.ServiceLocal?this.wrapped=new i.InteropApiWindows:this.wrapped=new i.InteropApiFullWeb,r.prototype.init.call(this,e,t,n).then(function(){return o.wrapped.initApi(t)})},e.prototype.initApi=function(){},e.prototype.lancer=function(e,t,n,o,r){return this.wrapped.lancer(e,t,n,o,r)},e.prototype.addToContextInterop=function(e,t,n,o,r){return this.wrapped.addToContextInterop(e,t,n,o,r)},e.prototype.addListToContextInterop=function(e,t,n,o){return this.wrapped.addListToContextInterop(e,t,n,o)},e.prototype.getVarEnv=function(e,t,n){return this.wrapped.getVarEnv(e,t,n)},e.prototype.getRegistryValue=function(e,t,n,o,r){return this.wrapped.getRegistryValue(e,t,n,o,r)},e.prototype.ecrireFichier=function(e,t,n,o){return this.wrapped.ecrireFichier(e,t,n,o)},e.prototype.lireFichier=function(e){return this.wrapped.lireFichier(e)},e.prototype.getInfoFichier=function(e,t,n){return this.wrapped.getInfoFichier(e,t,n)},e.prototype.afficherWindowParHandle=function(e,t){return this.wrapped.afficherWindowParHandle(e,t)},e.prototype.afficherWindowParPid=function(e,t){return this.wrapped.afficherWindowParPid(e,t)},e.prototype.afficherSynthese=function(e){return this.wrapped.afficherSynthese(e)},e.prototype.activerApplicationAppelante=function(e){return this.wrapped.activerApplicationAppelante(e)},e.prototype.notifierFinStep=function(e){return this.wrapped.notifierFinStep(e)},e.prototype.notifierEtatProcessus=function(e,t){return this.wrapped.notifierEtatProcessus(e,t)},e.prototype.notifierFinProcessus=function(e,t){return this.wrapped.notifierFinProcessus(e,t)},e.prototype.notifierChangementNomProcessus=function(e,t){return this.wrapped.notifierChangementNomProcessus(e,t)},e.prototype.subscribeToEvent=function(e,t,n){return this.wrapped.subscribeToEvent(e,t,n)},e.prototype.testLocalService=function(){return this.wrapped.testLocalService()},e.prototype.getListFromContextInterop=function(e,t,n,o){return this.wrapped.getListFromContextInterop(e,t,n,o)},e.prototype.getFromContextInterop=function(e,t,n,o){return this.wrapped.getFromContextInterop(e,t,n,o)},e.prototype.getCommonDataInteropToUpdate=function(){return this.wrapped.getCommonDataInteropToUpdate()},e}(t.Components.ComponentApiBase),i.InteropApiFactory=n,t.Components.RegistryApi.getInstance().register(n)}(MyWay||(MyWay={})),function(e){var t,n,o;t=e.Services||(e.Services={}),n=t.Interop||(t.Interop={}),o=function(){function e(){}return e.prototype.initApi=function(e){this.libraryManager=e},e.prototype.lancer=function(e,t,n,o,r){},e.prototype.addToContextInterop=function(e,t,n,o,r){},e.prototype.addListToContextInterop=function(e,t,n,o){},e.prototype.getListFromContextInterop=function(e,t,n,o){},e.prototype.getFromContextInterop=function(e,t,n,o){},e.prototype.getVarEnv=function(e,t,n){},e.prototype.getRegistryValue=function(e,t,n,o,r){},e.prototype.ecrireFichier=function(e,t,n,o){return this.libraryManager.Core.createPromiseSelfResolved()},e.prototype.lireFichier=function(e){return this.libraryManager.Core.createPromiseSelfResolved()},e.prototype.getInfoFichier=function(e,t,n){},e.prototype.afficherWindowParHandle=function(e,t){},e.prototype.afficherWindowParPid=function(e,t){},e.prototype.afficherSynthese=function(e){},e.prototype.activerApplicationAppelante=function(e){},e.prototype.activerWindow=function(e){},e.prototype.notifierFinStep=function(e){},e.prototype.notifierEtatProcessus=function(e,t){},e.prototype.notifierFinProcessus=function(e,t){},e.prototype.notifierChangementNomProcessus=function(e,t){},e.prototype.activerApplication=function(e,t){},e.prototype.getHandlePetra=function(e){},e.prototype.subscribeToEvent=function(e){},e.prototype.testLocalService=function(){},e.prototype.sendConnectionInfo=function(e,t){},e.prototype.getCommonDataInteropToUpdate=function(){var e=t.CoreCommon.ServiceDePromesse.defer();return e.resolve([]),e.promise},e}(),n.InteropApiFullWeb=o}(MyWay||(MyWay={})),function(e){var c,o,t;c=e.Services||(e.Services={}),o=c.Interop||(c.Interop={}),t=function(){function e(){}return e.prototype.initApi=function(e){this._localServiceUrl=c.PrivatePortalServiceParameters.Instance().LocalServiceUrl,this.libraryManager=e},e.prototype.testLocalService=function(){var e=this,t={url:this._localServiceUrl+"/Contexte/GetAllVarEnv",cache:!1,async:!1};c.CoreCommon.SendRequest(t,function(){},function(){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled=!0,e.warnLocalServiceUnavailability()})},e.prototype.lancer=function(e,t,n,o,r){if(c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled)this.warnLocalServiceUnavailability();else{var i=JSON.stringify(e),a=JSON.stringify(t);c.CoreCommon.SendRequest({url:this._localServiceUrl+"/lanceur/lancer?exec="+i+"&parametres="+n+"&contexte="+a+"&sync="+o,contentType:c.ContentTypeEnum.JSON,method:c.MethodEnum.POST},function(){},r)}},e.prototype.addToContextInterop=function(e,t,n,o,r){var i;c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():(i="/Myway/"+e+"/","process"==e.toLowerCase()&&"courant"!=t.toLowerCase()&&(i+="courant/"),t=i+t,c.CoreCommon.SendRequest({url:this._localServiceUrl+"/contexte/setvaleur?cle="+t+"&valeur="+n,method:c.MethodEnum.GET,contentType:c.ContentTypeEnum.JSON,async:!1,cache:!1},function(e){o&&o(e)},r))},e.prototype.addListToContextInterop=function(e,t,n,o){var r;c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():(r="/Myway/"+e+"/courant/",c.CoreCommon.SendRequest({url:this._localServiceUrl+"/contexte/AddListToContextInterop?racinePath="+r+"&datas="+JSON.stringify(t),method:c.MethodEnum.GET,contentType:c.ContentTypeEnum.JSON,async:!1,cache:!1},function(e){n&&n(e)},o))},e.prototype.getFromContextInterop=function(e,t,n,o){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():(t="/Myway/"+e+"/"+t,c.CoreCommon.SendRequest({url:this._localServiceUrl+"/contexte/getvaleur?cle="+t,data:void 0,method:c.MethodEnum.GET,contentType:c.ContentTypeEnum.JSON,async:!1,cache:!1},function(e){n&&n(e)},o))},e.prototype.getListFromContextInterop=function(e,t,n,o){var r;c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():(r="/Myway/"+e+"/courant/",c.CoreCommon.SendRequest({url:this._localServiceUrl+"/contexte/GetListFromContextInterop?racinePath="+r+"&datas="+JSON.stringify(t),method:c.MethodEnum.GET,contentType:c.ContentTypeEnum.JSON,async:!1,cache:!1},function(e){n&&n(e)},o))},e.prototype.getVarEnv=function(e,t,n){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/environment/getvaleur?nom="+e,data:void 0,async:!1,method:c.MethodEnum.GET,contentType:c.ContentTypeEnum.JSON,cache:!1},function(e){t&&t(e)},n)},e.prototype.getRegistryValue=function(e,t,n,o,r){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/window/GetRegistryValue?niveau="+e+"&souscle="+t+"&nom="+n,data:void 0,async:!1,method:c.MethodEnum.GET,contentType:c.ContentTypeEnum.JSON,cache:!1},function(e){o&&o(e)},r)},e.prototype.lireFichier=function(e){if(!c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled)return this.libraryManager.Core.sendRequest({url:c.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/fichier/lire?pathFichier="+e,contentType:c.ContentTypeEnum.JSON,method:c.MethodEnum.GET,async:!1,cache:!1}).then(function(e){return e});this.warnLocalServiceUnavailability()},e.prototype.getInfoFichier=function(e,t,n){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/fichier/GetInfo?pathFichier="+e,data:void 0,type:"GET",async:!1,method:c.MethodEnum.GET,contentType:c.ContentTypeEnum.JSON,cache:!1},function(e){t&&t(e)},n)},e.prototype.ecrireFichier=function(e,t,n,o){if(!c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled)return this.libraryManager.Core.sendRequest({url:c.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/fichier/ecrire?pathFichier="+e+"&ajouter="+n+"&creeDir="+o,data:t,contentType:c.ContentTypeEnum.JSON,method:c.MethodEnum.POST,type:"POST",async:!1}).then(function(e){return e});this.warnLocalServiceUnavailability()},e.prototype.afficherWindowParHandle=function(e,t){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/lanceur/AfficherWindowParHandle?handle="+e+"&affiche="+t,data:void 0,async:!1,method:c.MethodEnum.POST,contentType:c.ContentTypeEnum.JSON},function(){},function(){})},e.prototype.afficherWindowParPid=function(e,t){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/lanceur/AfficherWindowParPid?pid="+e+"&affiche="+t,data:void 0,async:!1,method:c.MethodEnum.POST,contentType:c.ContentTypeEnum.JSON},function(){},function(){})},e.prototype.afficherSynthese=function(e){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/lanceur/AfficherSynthese?numeroClient="+e,data:void 0,async:!1,method:c.MethodEnum.POST,contentType:c.ContentTypeEnum.JSON},function(){},function(){})},e.prototype.activerApplicationAppelante=function(e){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/lanceur/ActiverApplicationAppelante?numeroPlan="+e,data:void 0,async:!1,method:c.MethodEnum.POST,contentType:c.ContentTypeEnum.JSON},function(){},function(){})},e.prototype.notifierFinStep=function(e){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/lanceur/NotifierFinStep?stepId="+e,data:void 0,async:!1,method:c.MethodEnum.POST,contentType:c.ContentTypeEnum.JSON},function(){},function(){})},e.prototype.notifierEtatProcessus=function(e,t){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/lanceur/NotifierEtatProcessus?processId="+e+"&cId="+this._connectionId+"&Etat="+t,data:void 0,async:!1,method:c.MethodEnum.POST,contentType:c.ContentTypeEnum.JSON},function(){},function(e){console.log(e)})},e.prototype.notifierFinProcessus=function(e,t){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/lanceur/NotifierFinProcessusAvecData?processId="+e+"&cId="+this._connectionId+"&datas="+JSON.stringify(t),data:void 0,async:!1,method:c.MethodEnum.POST,contentType:c.ContentTypeEnum.JSON},function(){},function(e){console.log(e)})},e.prototype.notifierChangementNomProcessus=function(e,t){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/lanceur/NotifierChangementNomProcessus?processId="+e+"&nomProcessus="+encodeURIComponent(t),data:void 0,async:!1,method:c.MethodEnum.POST,contentType:c.ContentTypeEnum.JSON},function(){},function(e){console.log(e)})},e.prototype.notifierNomProcessus=function(e,t){c.PrivatePortalServiceParameters.Instance().LocalServiceDisabled?this.warnLocalServiceUnavailability():c.CoreCommon.SendRequest({url:this._localServiceUrl+"/lanceur/NotifierNomProcessus?nom="+e+"&processId="+t,data:void 0,async:!1,method:c.MethodEnum.POST,contentType:c.ContentTypeEnum.JSON},function(){},function(e){console.log(e)})},e.prototype.subscribeToEvent=function(e,t,o){this._onEvent=e,this._onAcceptEvent=t,this._onConnection=o;try{var r=this;$.getScript(this._localServiceUrl+"/signalr/hubs").done(function(e,t){$.connection.simpleEventHub.client.sendMessage=function(e){r._setConnection($.connection.hub.id),r._treatMessage(e)};var n=$.connection.hub;n.url=r._localServiceUrl+"/signalr",n.logging=!0,n.start({transport:["serverSentEvents","longPolling"]}).done(function(){r._setConnection($.connection.hub.id)}),n.disconnected(function(){setTimeout(function(){n.start({transport:["serverSentEvents","longPolling"]}).done(function(){r._connectionId=$.connection.hub.id,o(r._connectionId)})},5e3)}),window.onbeforeunload=function(e){r._disconnect()}}).fail(function(e,t,n){$("div.log").text("Triggered ajaxError handler.")})}catch(e){console.log("can't load hub evenHub: "+e)}},e.prototype.getCommonDataInteropToUpdate=function(){var e,t=[];return this._localServiceUrl?(e=this._localServiceUrl+"/donnees-interop.json",this.libraryManager.Core.sendRequest({url:e,method:c.MethodEnum.GET,withHeaders:!1,timeout:3e3}).then(function(e){return e},function(){return t})):this.libraryManager.Core.createPromiseSelfResolved(t)},e.prototype._setConnection=function(e){e!==this._connectionId&&(this._connectionId=e,this._onConnection(e))},e.prototype._treatMessage=function(e){if("accept"===e.Destinataire){(n=new o.InteropMessageEvent).ProcessStepId=e.Destinataire,n.Subject=e.Sujet,n.Contenu=e.Contenu,n.DeliverTries=0;var t=this._onAcceptEvent(n);c.CoreCommon.SendRequest({url:this._localServiceUrl+"/Evenements/AcceptMessage?connectionId="+this._connectionId+"&messageId="+e.Contenu.MessageId+"&accept="+t,method:c.MethodEnum.GET,withHeaders:!1},null,null)}else{var n;c.CoreCommon.SendRequest({url:this._localServiceUrl+"/Evenements/Acknowledge?status=SUCCESS&messageId="+e.Id+"&responseText=ok",method:c.MethodEnum.GET,withHeaders:!1},null,null),(n=new o.InteropMessageEvent).ProcessStepId=e.Destinataire,n.Subject=e.Sujet,n.Contenu=e.Contenu,n.DeliverTries=0,this._onEvent(n,null)}},e.prototype._disconnect=function(){c.CoreCommon.SendRequest({url:this._localServiceUrl+"/Evenements/Disconnect/"+this._connectionId,method:c.MethodEnum.GET,withHeaders:!1},null,null)},e.prototype.warnLocalServiceUnavailability=function(){e.logger.warn("Le service local n'a pu être joint et a été désactivé. Veuillez redémarrer le service local et recharger le portail")},e.CLASS_NAME="MyWay.Services.Interop.InteropApiWindows",e.logger=c.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(),o.InteropApiWindows=t}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-interop-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(o){var l;(function(h){l.CoreCommon.addListenerOnCheckSettings(function(e){!e.authentificationInfo&&e.withHeaders&&l.ServiceManager&&l.ServiceManager.Instance()&&l.ServiceManager.Instance().Library&&l.ServiceManager.Instance().Library.Context&&(e.authentificationInfo=l.ServiceManager.Instance().Library.Context.GetAuthentificationInfo())}),l.ServiceManager.addActionOnInitialize("Context.GetInfosUserApi",function(e){return e.Context.GetInfosUserApi()}),l.ServiceManager.addActionOnInitialize("Context.GetDonneesLocales",function(e){return e.Context.GetDonneesLocales()}),l.ServiceManager.addActionOnInitialize("Context.SetPortalInformation",function(e){return e.Context.SetPortalInformation()},"Context.GetDonneesLocales");var a=function(e,t){this.level=e,this.value=t},e=function(s){function i(){var e=s.call(this,l.Components.ComponentType.Context)||this;return e.api=null,e._portalIndex=0,e._storageNotification=null,e._useDiagnostic=!1,e.listenerOnTerminerProcessus=[],e._infosUser=null,e._pathFileSharedContext="%APPDATA%\\sharedContext.txt",e.listenerOnChangePortailType=null,e}return __extends(i,s),i.prototype.init=function(e,t,r,o){var n=this;return this.api=o,this._context=i._initContext(),this._portalIndex=0,this._useDiagnostic=r.isTotemCapable,this._storageNotification=e.Persistence.addStorage("notifications.context",function(){n.OnContextStorageChanged()}),s.prototype.init.call(this,e,t,r,o)},i.prototype.AddToContextAsync=function(r,o,n){var s=this;return l.CoreCommon.promesseTryCatch(function(e){var t=s.AddToContext(r,o,n);e.resolve(t)})},i.prototype.RemoveFromContextAsync=function(r,o){var n=this;return l.CoreCommon.promesseTryCatch(function(e){var t=n.RemoveFromContext(r,o);e.resolve(t)})},i.prototype.AddListToContextAsync=function(r,o,n){var s=this;return l.CoreCommon.promesseTryCatch(function(e){var t=s.AddListToContext(r,o,n);e.resolve(t)})},i.prototype.GetFromContextAsync=function(r){var o=this;return l.CoreCommon.promesseTryCatch(function(e){var t=o._getFromContext(r);t?(i.logger.debug("lecture dans le contexte %1 de %2: %3",t.level,r,t.value),e.resolve(t.value)):e.resolve(null)})},i.prototype.GetFromSharedContextAsync=function(r){var o=this;return l.CoreCommon.promesseTryCatch(function(e){var t=o._getFromSharedContext(r);t?(i.logger.debug("lecture dans le contexte %1 de %2: %3",t.level,r,t.value),e.resolve(t.value)):e.resolve(null)})},i.prototype.GetCurrentStepInfoAsync=function(){var r=this;return l.CoreCommon.promesseTryCatch(function(e){var t=r.GetCurrentStepInfo();e.resolve(t)})},i.prototype.GetListFromContextAsync=function(r){var o=this;return l.CoreCommon.promesseTryCatch(function(e){var t=o.GetListFromContext(r);e.resolve(t)})},i.prototype.GetAuthentificationInfoAsync=function(){var r=this;return l.CoreCommon.promesseTryCatch(function(e){var t=r.GetAuthentificationInfo(!1);e.resolve(t)})},i.prototype.GetParametresComptablesAsync=function(){var r=this;return l.CoreCommon.promesseTryCatch(function(e){var t=r.GetParametresComptables();e.resolve(t)})},i.prototype.GetWaitingProcessesAsync=function(){var r=this;return l.CoreCommon.promesseTryCatch(function(e){var t=r.GetWaitingProcesses();e.resolve(t)})},i.prototype.GetCurrentProcessIdAsync=function(){var r=this;return l.CoreCommon.promesseTryCatch(function(e){var t=r.GetCurrentProcessId();e.resolve(t)})},i.prototype.GetCurrentStepIdAsync=function(){var r=this;return l.CoreCommon.promesseTryCatch(function(e){var t=r.GetCurrentStepId();e.resolve(t)})},i.prototype.GetCurrentMainProcessAsync=function(){var r=this;return l.CoreCommon.promesseTryCatch(function(e){var t=r.GetCurrentMainProcess();e.resolve(t)})},i.prototype.setIsMyWayUrl=function(e){this.library.Display.CurrentFrame.IsMyWayUrl=e},i.prototype.SendEvent=function(e){return s.prototype.SendEvent.call(this,e)},i.prototype.InitSinglePortalContext=function(){this._singlePortalContext&&this._singlePortalContext.processes&&1<=this._singlePortalContext.processes.length&&this.SetSingleProcess(this._singlePortalContext.processes[0].id)},i._initContext=function(){var e,t=l.Storage.ContextStorage.Get();if(t&&(e=o.Services.Context.ContextImpl.clone(JSON.parse(t))),!e){(e=new o.Services.Context.ContextImpl).portals=[],e.waitingProcesses=[],e.globalStorage=[],e.sharedStorage=[];var r=i.AddNewPortalToContext(e);i._saveContext(r)}return e},i._saveContext=function(e){l.Storage.ContextStorage.Set(JSON.stringify(e))},i.prototype.SaveContext=function(){i._saveContext(this._context),this._storageNotification.saveValue(Math.random())},i.AddNewPortalToContext=function(e){var t=i.CreatePortalContext();return e.portals.push(t),e},i.CreatePortalContext=function(){var e=new o.Services.Context.PortalContext;return e.temporayContextStorage=[],e.processes=[],e.currentPath=null,e},Object.defineProperty(i.prototype,"PortalCount",{get:function(){return this._context.portals.length},enumerable:!0,configurable:!0}),i.prototype.OnContextStorageChanged=function(){this._context=i._initContext();var e=this._portalIndex;e>=this._context.portals.length&&(e=this._context.portals.length-1),e!==this._portalIndex&&(this._portalIndex=e),this.InitSinglePortalContext();var t=this.GetPortalContext();this.SendPortalContext(!0,"OnContextStorageChanged"),this.SendEvent(new l.Component.ManagerEvent(l.Component.ManagerEventType.PortalContextChanged,{portalContext:t,info:"OnContextStorageChanged"})),this.SendEvent(new l.Component.ManagerEvent(l.Component.ManagerEventType.ContextRecharge,{}))},i.prototype.DisplayProcesses=function(e){void 0===e&&(e=!1),i.logger.debug("DisplayProcesses");var t=!1,r=l.CoreCommon.ServiceDePromesse.defer();this.library.Display.CleanFrames(this.GetPortalContext().processes);var o=this.GetCurrentProcess();if(o){var n=this.GetCurrentStep(o);n&&(i.logger.debug("Current step is : %1",n.getPath()),n.displayTime||(n.displayTime=Date.now()),t=!0,this.DisplayProcessUrl(n.url,null,e).then(function(e){e&&(n.displayTime=Date.now(),i.logger.info("Display Step "+n.id)),r.resolve(e)}))}return t||r.resolve(!1),r.promise},i.prototype.DisplayProcessUrl=function(e,t,r){return void 0===r&&(r=!1),i.logger.debug("DisplayProcessUrl"),t||(t=this.GetMainProcessId()),this.library.Display.AfficherUrl(e,t,r)},i.prototype.GetPortalContext=function(e){return void 0===e&&(e=!0),this._singlePortalContext&&e?this._singlePortalContext:this._context.portals[this._portalIndex]},i.prototype.GetCurrentProcessId=function(){var e=this.GetCurrentProcess();return e?e.id:null},i.prototype.GetMainProcessId=function(){var e=this.GetPortalContext();return h.PortalContext.GetPathPart(e.currentPath,h.PATH_PART.MAIN_PROCESS_ID)},i.prototype.GetCurrentStepId=function(){var e=this.GetCurrentProcess();if(e){var t=this.GetCurrentStep(e);if(t)return t.id}return null},i.prototype.IsSingleProcess=function(){return!(!this._singlePortalContext||!this._singlePortalContext.currentPath)},i.prototype.GetCurrentProcess=function(){return this.GetPortalContext().GetCurrentProcess()},i.prototype.GetCurrentMainProcess=function(){return this.GetPortalContext().GetCurrentMainProcess()},i.prototype.GetParentProcess=function(e){var t=this.GetPortalContext();return h.PortalContext.GetProcessByPath(e.id,t.processes)},i.prototype.GetCurrentProcessCode=function(){var e=this.GetCurrentProcess();if(e){var t=e.getPath(),r=h.PortalContext.GetPathPart(t,h.PATH_PART.LAST_PROCESS_ID);return r&&0<r.indexOf("-")&&(r=r.split("-")[0]),r}return null},i.prototype.GetProcessById=function(e,t){for(var r in t||(t=this.GetPortalContext().processes),t){var o=t[r];if("Process"===o.type){var n=o;if(n.id===e)return n;var s=this.GetProcessById(e,n.subElements);if(s)return s}}return null},i.prototype.GetAllProcessFromAllPortails=function(){var t=[],e=this.GetWaitingProcesses();e&&e.forEach(function(e){t.push(e)});var r=this.getPortails();return r&&r.forEach(function(e){e.processes&&e.processes.forEach(function(e){t.push(e)})}),t},i.prototype.GetProcessByIdFromAllPortails=function(t){var r=null,e=this.GetWaitingProcesses();if(e)for(var o=0,n=e;o<n.length;o++){var s=n[o];if(s.id===t){r=s;break}}if(!r){var i=this.getPortails();i&&i.every(function(e){if(e.processes)return e.processes.every(function(e){return e.id===t&&(r=e),null===r}),null===r})}return r},i.prototype.GetProcessStepById=function(e){var t=h.PortalContext.GetPathPart(e,h.PATH_PART.STEP_ID),r=e.replace("|"+t,""),o=this.GetProcessById(r);if(o)for(var n in o.subElements){var s=o.subElements[n];if(s.id===t)return s}return null},i.prototype.GetWaitingProcess=function(e){for(var t in this._context.waitingProcesses){var r=this._context.waitingProcesses[t];if(r.id===e)return r}return null},i.prototype.GetCurrentStep=function(e){if(!e)return null;for(var t in e.subElements){var r=e.subElements[t];if(r.id===e.currentInnerElementPath)return r}return null},i.prototype.SetSingleProcess=function(e){var t=!1;for(var r in this._singlePortalContext=i.CreatePortalContext(),this._singlePortalContext.isSingle=!0,this.listenerOnChangePortailType&&this.listenerOnChangePortailType("singleWithProcess"),this._context.waitingProcesses){var o=this._context.waitingProcesses[r];if(o.id===e){this._singlePortalContext.processes.push(o),this._singlePortalContext.currentPath=o.getPath(),t=!0;break}}return t},i.prototype.setOnChangePortailType=function(e){this.listenerOnChangePortailType=e},i.prototype.GetWaitingProcesses=function(){return this._context.waitingProcesses},i.prototype.getPortails=function(){return this._context.portals},i.prototype.PutProcessInWait=function(e){var t=this._context.portals[this._portalIndex],r=i._removeProcess(t,e);return r&&(r.putInWaitTime=Date.now(),this._context.waitingProcesses.push(r),this.SaveContext()),t},i.prototype.PutProcessInWaitAsync=function(t,r){var o=this,e=new l.NotificationMessage;e.Sujet="MEP",this.Notify(e).then(function(){var e=o.PutProcessInWait(t);r(e)})},i.prototype.PutProcessInPortalContext=function(e){for(var t=-1,r=0;r<this._context.waitingProcesses.length;r++)if(this._context.waitingProcesses[r].id===e){t=r;break}var o=this._context.portals[this._portalIndex];if(0<=t){var n=this._context.waitingProcesses.splice(t,1)[0];o.processes.push(n),o.currentPath=n.getPath(),this.SaveContext()}return o},i.prototype.Notify=function(e){return this.sendMessageWithFrame(h.ContextMessageSubject.Notification,e,this.library.Display.CurrentFrame)},i.prototype.NotifyFrame=function(e,t){return this.sendMessageWithFrame(h.ContextMessageSubject.Notification,e,t)},i.prototype.Share=function(t,e,r){var o=this,n=this.GetPortalContext().GetProcess(t);n&&(n.putInWaitTime=Date.now(),this.api.ShareProcess(n,e).then(function(){var e=o._context.portals[o._portalIndex];i._removeProcess(e,t),o.SaveContext(),r(e)},function(e){}))},i.prototype.PutTaskInPortalContext=function(e){var r=this;return this.api.RemoveProcess(e).then(function(e){var t=r._context.portals[r._portalIndex];return t.processes.push(e),t.currentPath=e.getPath(),r.SaveContext(),t})},i.prototype.RemoveCurrentPortal=function(){if(0==this._portalIndex)throw"can't remove first portal";var e=this.GetPortalContext();if(0<e.processes.length)throw"can't remove portal with processes";return e=this.ChangePortalIndex(this._portalIndex-1),this._context.portals.splice(this._portalIndex+1,1),this.SaveContext(),e},i.prototype.AddToContext=function(e,t,r){return this.AddListToContext(e,[{Key:t,Value:r}])},i.prototype.RemoveFromContext=function(e,t){return this.RemoveListFromContext(e,[t])},i.prototype.ClearContext=function(){l.Storage.ContextStorage.Set(""),this._context=i._initContext(),this.InitSinglePortalContext()},i.prototype.GetDonneesLocales=function(){var t=this;return this.api?(i.logger.debug("ServiceApi Start GetDonneesLocales"),this.api.GetDonneesLocales().then(function(e){i.logger.debug("ServiceApi End GetDonneesLocales"),e&&(e.AuthentificationInfo&&t.SetContextAuthentificationInfo(e.AuthentificationInfo),e.ParametresComptables&&t.AddToContext(h.StorageLevel.Global,"ParametresComptables",JSON.stringify(e.ParametresComptables)),e.ParametresNumerisation&&t.AddToContext(h.StorageLevel.Global,"ParametresNumerisation",JSON.stringify(e.ParametresNumerisation)),e.ParametresServeurPoste&&t.AddToContext(h.StorageLevel.Global,"ParametresServeurPoste",JSON.stringify(e.ParametresServeurPoste)))})):l.Promesses.getPromesseSelfResoved()},i.prototype.GetAuthentificationInfo=function(e){void 0===e&&(e=!0);var t=this._getAuthenticationInfoFromContext();return null!=t||e||"DUA"!==t.ENVIRON||this.library.Display.DisplayLogOn(),t},i.prototype.getAuthentificationInfo=function(){var n=this;return this.library.Core.promesseTryCatch(function(r){var e=n.GetAuthentificationInfo(!1);if(null!==e)r.resolve(e);else{var o=function(e){var t=n.GetAuthentificationInfo();t?(n.library.Evennements.retirerListener(o),r.resolve(t)):r.reject(new l.Erreur("Il n'a pas été possible de récupérer les informations d'authenfications."))};n.ajouterListenerEvent(l.Component.ManagerEventType.ChangementAuthentificationInfo,o)}})},i.prototype.SetContextAuthentificationInfo=function(e){this.AddToContext(h.StorageLevel.Global,"AuthentificationInfo",JSON.stringify(e)),this.SendEvent(new l.Component.ManagerEvent(l.Component.ManagerEventType.ChangementAuthentificationInfo,{}))},i.prototype._getAuthenticationInfoFromContext=function(){var e=this.GetFromContext("AuthentificationInfo");return e?JSON.parse(e):null},i.prototype.GetParametresComptables=function(){var e=this.GetFromContext("ParametresComptables");return e?JSON.parse(e):null},i.prototype.GetInfosUserApi=function(){var t=this;return this.api.GetInfosUserApi().then(function(e){e&&t.AddToContext(h.StorageLevel.Global,"InfosUser",JSON.stringify(e))})},i.prototype.GetInfosUser=function(){var e=this.GetFromContext("InfosUser");return e?JSON.parse(e):null},i.prototype.GetInfosUserOnce=function(){return this._infosUser||(this._infosUser=this.GetInfosUser()),this._infosUser},i.prototype.ClearParametresComptables=function(){this.AddToContext(h.StorageLevel.Global,"ParametresComptables","")},i.prototype.AddListToContext=function(e,t,r){var o=this._getStorage(e,r);if(o){this.CheckData(e,t);for(var n=[],s=0,i=t;s<i.length;s++){var a=i[s];a.Key&&null!==a.Value&&(n.push(a.Key),this._addToContextArray(o,{Key:a.Key,Value:a.Value}),e===h.StorageLevel.Global&&"AuthentificationInfo"===a.Key&&this.SendEvent(new l.Component.ManagerEvent(l.Component.ManagerEventType.ChangementAuthentificationInfo,{})))}if(this.SaveContext(),e===h.StorageLevel.Global&&this.SendPortalContext(!0,"Add to global context: "+JSON.stringify(n)),e===h.StorageLevel.Shared){var c=JSON.stringify(this._context.sharedStorage);l.CoreCommon.SendRequest({url:l.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/fichier/ecrire?pathFichier="+this._pathFileSharedContext+"&ajouter=false&creeDir=false",data:c,contentType:l.ContentTypeEnum.JSON,method:l.MethodEnum.POST,type:"POST",async:!1},function(e){},function(e){})}return!0}return!1},i.prototype.CheckData=function(e,t){if(e===h.StorageLevel.MainProcess||e===h.StorageLevel.Process){var r=0;for(var o in t){var n=t[o];if(n&&n.Value){var s=this.GetLength(n.Value);5e3<s&&i.logger.warn("Attention, la donnée ajoutée dans le contexte dépasse %3 caractères. Clé=%1; Taille=%2",n.Key,s,5e3),r+=s}}1e5<(r+=this.GetCurrentProcessContextSize())&&i.logger.warn("Attention, les données ajoutées dans le contexte de processus dépasse %2 caractères. Taille=%1",r,1e5)}},i.prototype.GetLength=function(e){return"object"==typeof e?JSON.stringify(e).length:"string"==typeof e?e.length:0},i.prototype.GetCurrentProcessContextSize=function(){return this.GetProcessContextSize(this.GetCurrentMainProcess())},i.prototype.GetProcessContextSize=function(e){var t=0;for(var r in e.contextStorage)e.contextStorage[r]&&e.contextStorage[r].Value&&(t+=this.GetLength(e.contextStorage[r].Value));for(var r in e.subElements){var o=e.subElements[r];"Process"==o.type&&(t+=this.GetProcessContextSize(o))}return t},i.prototype.RemoveListFromContext=function(e,n,t){var s=this,r=this._getStorage(e,t);if(r){for(var o in n)this._removeFromContextArray(r,n[o]);return e===h.StorageLevel.Shared&&l.CoreCommon.SendRequest({url:l.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/fichier/lire?pathFichier="+this._pathFileSharedContext,contentType:l.ContentTypeEnum.JSON,method:l.MethodEnum.GET,async:!1,cache:!1},function(e){var r=JSON.parse(e);for(var o in n)r.some(function(e,t){n[o]===e.Key&&r.splice(t,1)[0]});var t=JSON.stringify(r);l.CoreCommon.SendRequest({url:l.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/fichier/ecrire?pathFichier="+s._pathFileSharedContext+"&ajouter=false&creeDir=false",data:t,contentType:l.ContentTypeEnum.JSON,method:l.MethodEnum.POST,type:"POST",async:!1},function(e){},function(e){})},function(e){}),this.SaveContext(),!0}return!1},i.prototype._getStorage=function(e,t){var r;if(e===h.StorageLevel.Global)r=this._context.globalStorage;else if(e===h.StorageLevel.Shared)r=this._context.sharedStorage;else if(e===h.StorageLevel.Tempo)r=this._context.portals[this._portalIndex].temporayContextStorage;else if(e===h.StorageLevel.Process){var o=null;if(!(o=t?this.GetProcessById(t):this.GetCurrentProcess()))throw"process not found";r=o.contextStorage}else if(e===h.StorageLevel.Step){var n=null;if(!(n=t?this.GetProcessStepById(t):this.GetCurrentStep(this.GetCurrentProcess())))throw"processStep not found";r=n.contextStorage}else{if(e!==h.StorageLevel.MainProcess)throw"le niveau '"+e+"' n'est pas valable";var s=this.GetCurrentProcess();if(!s)throw"no current process";for(var i=s;s;)(s=this.GetParentProcess(s))&&(i=s);r=i.contextStorage}return r},i.prototype.setContextClientIdOnProcessus=function(e,t,r){for(var o in t.contexteClientId=e,t.subElements){var n=t.subElements[o];"Process"===n.type&&this.setContextClientIdOnProcessus(e,n,!0)}r||this.SaveContext()},i.prototype.GetFromContext=function(e){var t=this._getFromContext(e);return t?t.value:null},i.prototype.ChangeMainProcessNameAsync=function(r){var o=this;return l.CoreCommon.promesseTryCatch(function(e){var t=o.ChangeMainProcessName(r);e.resolve(t)})},i.prototype.ChangeMainProcessName=function(e){return this.ChangeProcessName(e,this.GetMainProcessId())},i.prototype.ChangeProcessName=function(e,t){var r=this.GetProcessById(t,null);if(r&&(r.displayName=e,this.SaveContext()),this.onProcessNameChanged)try{this.onProcessNameChanged(t,e)}catch(e){l.Loggers.FLASH.INSTANCE.setValue("action","ChangeProcessName"),l.Loggers.FLASH.INSTANCE.setValue("details",e),i.logger.error("une erreur est survenue lors de la notification de changement de nom")}return this.GetPortalContext()},i.prototype.GetCurrentStepInfo=function(){var e=this.GetCurrentProcess();if(!e)return null;var t=this.GetCurrentStep(e);if(!t)return null;var r,o=new h.StepInfoExtended;o.StepCode=t.codeEtape,o.BusinessCode=t.codeMetier,o.ProcessCode=e.codeProcess,o.ProcessType=e.typeProcess,o.ValeurEntree=t.valeurEntree,o.PreviousStepEndTime=e.lastNextTime,o.DiagnosticTraceSentForStep=t.diagnosticTraceSentForStep,o.StartTime=t.creationDate;var n=t.displayTime;for(var s in n<e.lastNextTime&&(n=e.lastNextTime),o.DisplayTime=n,t.authorizedOutputs)o.AuthorizedOutputs.push(t.authorizedOutputs[s]);for(var i in t.contrats)(r=new h.ContratInfo).NomData=t.contrats[i].Code,r.Mode=t.contrats[i].Mode,o.Contrats.push(r);switch(o.CurrentProcessId=e.id,o.CurrentParentProcessId=h.PortalContext.GetPathPart(e.id,h.PATH_PART.MAIN_PROCESS_ID),o.CurrentStepId=t.id,o.CurrentPath=o.CurrentProcessId+"|"+o.CurrentStepId,o.NomComposant=t.nomApplication,o.VersionComposant=l.CoreCommon.VersionMySys,l.PrivatePortalServiceParameters.Instance().ModeDebug){case!0:o.NiveauTrace=4;break;default:o.NiveauTrace=3}return o.Diagnostic=this._useDiagnostic,o},i.prototype.GetObjectFromContext=function(e){for(var t={},r=0,o=this.GetListFromContext(e);r<o.length;r++){var n=o[r];t[n.Key]=n.Value}return t},i.prototype.GetTypedObjectFromContext=function(e){var t=Object.keys(e),r=this.GetListFromContext(t),o={};for(var n in r){var s=r[n];o[s.Key]=s.Value}return o},i.prototype.GetListFromContext=function(e,t,r){var o;for(var n in o=[],e){var s=e[n],i=void 0;(i=!t||s.indexOf(".")<0?this._getFromContext(s,r):this._getObjectPropFromContext(s,r))&&o.push({Key:s,Value:i.value})}return o},i.prototype.SwitchToProcess=function(e){var t,r=this._context.portals[this._portalIndex];for(var o in r.processes){var n=r.processes[o];if(n.id===e){t=n;break}}if(!t)throw"process '"+e+"' not found";return r.currentPath!==t.getPath()&&(r.currentPath=t.getPath(),this.SaveContext(),!0)},i.prototype.SwitchToProcessAsync=function(e,t){this.SwitchToProcess(e),t(this.GetPortalContext())},i.prototype.RemoveProcess=function(e){var r=this,t=this.GetPortalContext(),o=i._removeProcess(t,e);return o&&(this._singlePortalContext&&this._context.waitingProcesses.some(function(e,t){if(e.id===o.id)return r._context.waitingProcesses.splice(t,1)[0],!0}),this.SaveContext()),this.GetPortalContext()},i.prototype.RemoveCurrentProcess=function(){var r,o=this,e=this.GetCurrentProcess(),t=this.GetPortalContext();return(r=0===e.id.indexOf("|")?i._removeProcess(t,e.id):(t.isSingle,this.RemoveSubProcess(t,e.id+"|",t.processes,this.GetParentProcess(e))))&&(this._singlePortalContext&&this._context.waitingProcesses.some(function(e,t){if(e.id===r.id)return o._context.waitingProcesses.splice(t,1)[0],!0}),this.SaveContext()),this.GetPortalContext()},i.prototype.RemoveWaitingProcesses=function(){var e=[];for(var t in this._context.waitingProcesses)e.push(t);for(var r=e.length;r--;0<=r)this._context.waitingProcesses.splice(e[r],1);return this.SaveContext(),this.GetPortalContext()},i._removeProcess=function(e,t){for(var r=-1,o=0;o<e.processes.length;o++)if(e.processes[o].id===t){r=o;break}var n=null;return 0<=r&&(n=e.processes.splice(r,1)[0],0===e.processes.length?e.currentPath=null:r<=e.processes.length-1?e.currentPath=e.processes[r].getPath():e.currentPath=e.processes[e.processes.length-1].getPath()),n},i.prototype.RemoveSubProcess=function(e,t,r,o){for(var n=-1,s=h.PortalContext.GetPathPart(t,h.PATH_PART.MAIN_PROCESS_ID),i=h.PortalContext.GetPathPart(t,h.PATH_PART.LAST_PROCESS_ID),a=0;a<r.length;a++)if("Process"===(u=r[a]).type){var c=u;if(h.PortalContext.GetPathPart(c.id,h.PATH_PART.STEP_ID)===s){if(s!==i)return this.RemoveSubProcess(e,t.replace(s+"|",""),c.subElements,c);n=a;break}}var l=null;if(0<=n){l=r.splice(n,1)[0];var u,p=this.GetParentProcess(l);0<r.length?"Process"===(u=r[r.length-1]).type?e.currentPath=u.getPath():(p.currentInnerElementPath=u.id,e.currentPath=p.id+"|"+u.id):e.currentPath=""}return l},i.prototype.RemoveCurrentStep=function(e){var t;if(this.GetPortalContext(),!(t=this.GetCurrentProcess()))throw"no current process";for(var r=t.currentInnerElementPath;0<t.currentInnerElementPath.indexOf("|");){var o=h.PortalContext.GetPathPart(t.currentInnerElementPath,h.PATH_PART.MAIN_PROCESS_ID),n=this.GetProcessById(t.id+"|"+o,t.subElements);if(e&&n.codeEtape===e){r=n.id;break}r=(t=n).currentInnerElementPath}return this.RemoveStep(r,t.id)},i.prototype.RemoveStep=function(e,t){var r,o,n=this.GetPortalContext(),s=this.GetProcessById(t),i=this._getStepById(s,e);if(i&&i.boundId)o=this._getIndexesByBoundId(s,i.boundId);else{o=[];var a=this._getStepIndexById(s,e);0<=a&&o.push(a)}if(o&&0<o.length){s.subElements.splice(o[0],o.length);var c=void 0;r=0<s.subElements.length?(c=o[0]<=s.subElements.length-1?s.subElements[o[0]]:s.subElements[s.subElements.length-1],s.currentInnerElementPath=c.id,n.currentPath=s.getPath(),this.SaveContext(),n):this.RemoveProcess(s.id)}return r},i.prototype.ChangePortalIndex=function(e){return 0<=e&&e<this._context.portals.length&&(this._portalIndex=e,this.SaveContext()),this._context.portals[this._portalIndex]},i.prototype.AddAndGetNewPortal=function(){return this._context=i.AddNewPortalToContext(this._context),this._portalIndex=this._context.portals.length-1,this.SaveContext(),this._context.portals[this._portalIndex]},i.prototype.AddNewPortal=function(){return this._context=i.AddNewPortalToContext(this._context),this.SaveContext(),this._context.portals.length-1},i.prototype.GetPortalIndex=function(){return this._portalIndex},i.prototype.ClearCurrentPath=function(){this.GetPortalContext().currentPath=null,this.SaveContext()},i.prototype._getObjectPropFromContext=function(e,t){var r=e.split("."),o=this._getFromContext(r[0]);if(!o)return t?new a("unknown",""):null;var n=null;t&&(n="");try{for(var s=JSON.parse(o.value),i=1;i<r.length;i++)s=n=s[r[i]]}catch(e){}return new a(o.level,n)},i.prototype._getFromContext=function(e,t){var r=this.GetCurrentProcess(),o="",n=this._getFromContextArray(this._context.portals[this._portalIndex].temporayContextStorage,e);if(null!=n&&(o="tempo",this._removeFromContextArray(this._context.portals[this._portalIndex].temporayContextStorage,e),this.SaveContext()),null==n&&r){var s=this.GetCurrentStep(r);s&&(o="processStep",n=this._getFromContextArray(s.contextStorage,e))}for(var i=r;null==n&&i;)o="process",(n=this._getFromContextArray(i.contextStorage,e))||(i=this.GetParentProcess(i));return null==n&&(o="global",n=this._getFromContextArray(this._context.globalStorage,e)),null==n&&(o="shared",n=this._getFromContextArray(this._context.sharedStorage,e)),null!=n?new a(o,n):t?new a(o,""):null},i.prototype._getFromSharedContext=function(e,t){this.GetCurrentProcess();var r="",o=this._getFromContextArray(this._context.portals[this._portalIndex].temporayContextStorage,e);return null==o&&(r="shared",this.ReloadSharedContext(),o=this._getFromContextArray(this._context.sharedStorage,e)),null!=o?new a(r,o):t?new a(r,""):void 0},i.prototype.ReloadSharedContext=function(){var r=this;l.CoreCommon.SendRequest({url:l.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/fichier/lire?pathFichier="+this._pathFileSharedContext,contentType:l.ContentTypeEnum.JSON,method:l.MethodEnum.GET,async:!1,cache:!1},function(e){r._context.sharedStorage=JSON.parse(e)},function(e){var t=JSON.stringify([]);l.CoreCommon.SendRequest({url:l.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/fichier/ecrire?pathFichier="+r._pathFileSharedContext+"&ajouter=false&creeDir=false",data:t,contentType:l.ContentTypeEnum.JSON,method:l.MethodEnum.POST,async:!1},function(e){},function(e){})})},i.prototype._addToContextArray=function(e,t){for(var r in e){var o=e[r];if(t.Key===o.Key)return void(o.Value=t.Value)}e.push(t)},i.prototype._getFromContextArray=function(e,t){for(var r in e){var o=e[r];if(t===o.Key)return o.Value}},i.prototype._removeFromContextArray=function(r,o){r.some(function(e,t){if(o===e.Key)return r.splice(t,1)[0],!0})},i.prototype._getStepById=function(e,t){if(e&&e.subElements)for(var r in e.subElements){var o=e.subElements[r];if(o.id===t)return o}return null},i.prototype._getStepIndexById=function(e,r){var o=-1;return e&&e.subElements&&e.subElements.forEach(function(e,t){e.id===r&&(o=t)}),o},i.prototype._getIndexesByBoundId=function(e,r){var o=[];return e&&e.subElements&&e.subElements.forEach(function(e,t){e.boundId===r&&o.push(t)}),o},i.prototype.SendPortalContext=function(e,t){var r=this.GetPortalContext();this.SendEvent(new l.Component.ManagerEvent(l.Component.ManagerEventType.PortalContextChanged,{portalContext:r,demandeDeDemarrageDeProcessusDetail:{onlyHeader:e},info:t}))},i.prototype.AnalyseApp=function(e){this.sendMessage(h.ContextMessageSubject.AnalyseApp).then(e)},i.prototype.SetPortalInformation=function(){var r=this,o=l.CoreCommon.ServiceDePromesse.defer();if(this.api){i.logger.debug("GetPortalInformation");var e=this.GetAuthentificationInfo();e?this.api.GetPortalInformation(e).then(function(e){if(i.logger.debug("GetPortalInformation"),e&&e.urlCultureNet)r.AddToContext(h.StorageLevel.Global,"URLCultureNet",e.urlCultureNet),o.resolve();else{var t="Aucune information trouvée. portalInformation: "+JSON.stringify(e);i.logger.error(t),o.reject(new l.Erreur(t))}},function(e){i.logger.error("Erreur lors de SetPortalInformation: %1",JSON.stringify(e)),o.reject(e)}):(i.logger.error("Aucune données d'authentification présente"),o.reject())}else o.resolve();return o.promise},i.prototype.SetDiagnosticTraceSentForStep=function(e){this.GetProcessStepById(e).diagnosticTraceSentForStep=!0,this.SaveContext()},i.prototype._portail_terminerProcess=function(e){i.logger.info("TerminerProcess");var t=l.CoreCommon.ServiceDePromesse.defer(),r=this.GetProcessByIdFromAllPortails(e);if(!r)return t.resolve(!1),t.promise;this.listenerOnTerminerProcessus.forEach(function(e){e(r)});var o=this.RemoveProcess(e);return this.library.Display.RemoveProcessIFrame(e),this.SendEvent(new l.Component.ManagerEvent(l.Component.ManagerEventType.FinDeProcessus,{portalContext:o,info:e})),0<o.processes.length&&(this.DisplayProcesses(),this.SendEvent(new l.Component.ManagerEvent(l.Component.ManagerEventType.BasculeProcess,{portalContext:o,info:e}))),t.resolve(!0),t.promise},i.prototype._portail_terminerAllProcess=function(){var t=this;i.logger.info("TerminerTousLesProcess");var e=l.CoreCommon.ServiceDePromesse.defer(),r=this.GetPortalContext(),o=[];return r?(r.processes.forEach(function(e){o.push(t._portail_terminerProcess(e.id))}),l.Promesses.all(o).then(function(){return!0},function(e){throw i.logger.warn("EndAllProcess Failed",JSON.stringify(e)),e})):(e.resolve(!1),e.promise)},i.prototype.addListenerOnTerminerProcessus=function(e){this.listenerOnTerminerProcessus.push(e)},i.prototype.removeListenerOnTerminerProcessus=function(t){l.CoreCommon.ArrayUtils.remove(this.listenerOnTerminerProcessus,function(e){return e===t})},i.prototype._portail_extraireProcess=function(e){var t=l.CoreCommon.ServiceDePromesse.defer(),r=this.PutProcessInWait(e);this.library.Display.RemoveProcessIFrame(e),this.SendEvent(new l.Component.ManagerEvent(l.Component.ManagerEventType.Extraction,{portalContext:r})),0<r.processes.length&&(this.DisplayProcesses(),this.SendEvent(new l.Component.ManagerEvent(l.Component.ManagerEventType.BasculeProcess,{portalContext:r})));var o=l.PrivatePortalServiceParameters.Instance().LisaPlaceholders["URL-SPA"]+l.PrivatePortalServiceParameters.Instance().LisaPlaceholders.ALIASPORTAIL+"/?i="+e;return window.open(o),t.resolve(!0),t.promise},i.prototype._tester=function(){var e="C:\\PERSO\\sharedContext_"+this.GetInfosUser().IdentifiantUser+".json";l.CoreCommon.SendRequest({url:l.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/fichier/ecrire?pathFichier="+e+"&ajouter=false&creeDir=false",data:"",contentType:l.ContentTypeEnum.JSON,method:l.MethodEnum.POST,type:"POST",async:!1},function(e){},function(e){})},i.CLASS_NAME="MyWay.Services.Context.ContextManager",i.logger=l.Loggers.LoggerFactory.INSTANCE.getClass(i.CLASS_NAME),i}(l.Components.ComponentManagerBase);h.ContextManager=e,l.Components.RegistryManager.getInstance().register(e)})((l=o.Services||(o.Services={})).Context||(l.Context={}))}(MyWay||(MyWay={})),function(e){var o;(function(c){var e=function(){};c.ContextKeyValuePair=e;var t=function(){function i(){}return i.clone=function(e){var t=new i;for(var r in t.portals=[],e.portals){var o=e.portals[r];t.portals.push(a.clone(o))}for(var r in t.globalStorage=[],e.globalStorage){var n=e.globalStorage[r];t.globalStorage.push({Key:n.Key,Value:n.Value})}for(var r in t.sharedStorage=[],e.sharedStorage)n=e.sharedStorage[r],t.sharedStorage.push({Key:n.Key,Value:n.Value});for(var r in t.waitingProcesses=[],e.waitingProcesses){var s=e.waitingProcesses[r];t.waitingProcesses.push(l.clone(s))}return t},i}();c.ContextImpl=t;var a=function(){function a(){}return a.clone=function(e){var t=new a;for(var r in t.temporayContextStorage=[],e.temporayContextStorage){var o=e.temporayContextStorage[r];t.temporayContextStorage.push({Key:o.Key,Value:o.Value})}for(var r in t.processes=[],e.processes){var n=e.processes[r];t.processes.push(l.clone(n))}return t.currentPath=e.currentPath,t.isSingle=e.isSingle,t},a.GetPathPart=function(e,t){var r=null;if(e){var o=e.split("|");switch(t){case c.PATH_PART.MAIN_PROCESS_ID:r=o[0];break;case c.PATH_PART.STEP_ID:r=o[o.length-1];break;case c.PATH_PART.LAST_PROCESS_ID:r=o[o.length-2];break;case c.PATH_PART.PREVIOUS_PROCESS_ID:r=o[o.length-3]}}return r},a.GetProcessByPath=function(e,t){var r=a.GetPathPart(e,c.PATH_PART.MAIN_PROCESS_ID),o=a.GetPathPart(e,c.PATH_PART.LAST_PROCESS_ID);for(var n in t){var s=t[n];if("Process"===s.type){var i=s;if(a.GetPathPart(i.id,c.PATH_PART.STEP_ID)===r)return r==o?i:this.GetProcessByPath(e.replace(r+"|",""),i.subElements)}}return null},a.prototype.GetProcess=function(e){if(o.Controle.StaticStringControle.isString(e))for(var t in this.processes){var r=this.processes[t];if(r.id===e)return r}return null},a.prototype.GetProcessByPathPart=function(e,t){return this.GetProcess(a.GetPathPart(e,t))},a.prototype.GetCurrentProcess=function(){return a.GetProcessByPath(this.currentPath,this.processes)},a.prototype.GetCurrentMainProcess=function(){return this.GetProcessByPathPart(this.currentPath,c.PATH_PART.MAIN_PROCESS_ID)},a.prototype.GetCurrentStep=function(e){if(!e)return null;for(var t in e.subElements){var r=e.subElements[t];if(r.id===e.currentInnerElementPath)return r}return null},a}();c.PortalContext=a;var l=function(){function a(){this.type="Process",this.creationDate=Date.now(),this.outputContracts=[]}return a.clone=function(e){var t=new a;for(var r in t.contextStorage=[],e.contextStorage){var o=e.contextStorage[r];t.contextStorage.push({Key:o.Key,Value:o.Value})}for(var r in t.subElements=[],e.subElements){var n=e.subElements[r];"ProcessStep"==n.type?t.subElements.push(u.clone(n)):"Process"==n.type&&t.subElements.push(a.clone(n))}for(var s in t.currentInnerElementPath=e.currentInnerElementPath,t.displayName=e.displayName,t.icon=e.icon,t.id=e.id,t.putInWaitTime=e.putInWaitTime,t.knownSteps=e.knownSteps,t.codeEtape=e.codeEtape,t.codeProcess=e.codeProcess,t.typeProcess=e.typeProcess,t.creationDate=e.creationDate,t.estApplicationExterne=e.estApplicationExterne,t.outputContracts=[],e.outputContracts)t.outputContracts.push(e.outputContracts[s]);for(var r in t.authorizedOutputs=[],e.authorizedOutputs){var i=e.authorizedOutputs[r];t.authorizedOutputs.push(i)}return t.isSubProcess=e.isSubProcess,t.contexteClientId=e.contexteClientId,t.lastNextTime=e.lastNextTime,t},a.prototype.getPath=function(){return this.id+"|"+this.currentInnerElementPath},a}();c.Process=l;var u=function(){function a(){this.type="ProcessStep"}return a.clone=function(e){var t=new a;for(var r in t.contextStorage=[],e.contextStorage){var o=e.contextStorage[r];t.contextStorage.push({Key:o.Key,Value:o.Value})}for(var r in t.codeMetier=e.codeMetier,t.nomApplication=e.nomApplication,t.valeurEntree=e.valeurEntree,t.parentPath=e.parentPath,t.id=e.id,t.codeEtape=e.codeEtape,t.codeApplication=e.codeApplication,t.url=e.url,t.boundId=e.boundId,t.isEnd=e.isEnd,e.nextStep&&(t.nextStep=a.clone(e.nextStep)),t.actions=[],e.actions){var n=e.actions[r];t.actions.push(p.clone(n))}for(var r in t.contrats=[],e.contrats){var s=e.contrats[r];t.contrats.push(h.clone(s))}for(var r in t.processusMaitre=e.processusMaitre,t.processName=e.processName,t.maintienIFrame=e.maintienIFrame,t.maintienIFrameLastAction=e.maintienIFrameLastAction,t.authorizedOutputs=[],e.authorizedOutputs){var i=e.authorizedOutputs[r];t.authorizedOutputs.push(i)}return t.etapeResultAsString=e.etapeResultAsString,t.isRouteur=e.isRouteur,t.etatEtape=e.etatEtape,t.creationDate=e.creationDate,t.displayTime=e.displayTime,t.diagnosticTraceSentForStep=e.diagnosticTraceSentForStep,t},a.prototype.getPath=function(){return this.parentPath+"|"+this.id},a}();c.ProcessStep=u;var p=function(){function r(){}return r.clone=function(e){var t=new r;return t.Nom=e.Nom,t.CodeEtape=e.CodeEtape,t.ValeurSortie=e.ValeurSortie,t.EstExterne=e.EstExterne,t.Options=e.Options,t},r}();c.StepAction=p;var h=function(){function r(){}return r.clone=function(e){var t=new r;return t.Code=e.Code,t.Type=e.Type,t.Longueur=e.Longueur,t.Nullable=e.Nullable,t.Mode=e.Mode,t},r}();c.StepContrat=h})((o=e.Services||(e.Services={})).Context||(o.Context={}))}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var s;(s=e.Services||(e.Services={})).PhantomAgent.addListenerOnInit(function(e,t){e.Context=new s.Context.PhantomContextAgent(t)}),s.PhantomAgent.prototype.SendRequest=function(e){var n=this;return s.CoreCommon.promesseTryCatch(function(t){var r=n,o=e;o.logger=s.PhantomAgent.logger,r.Context&&r.Context.StepInfo?(o.stepInfo=r.Context.StepInfo,o.versionComposant=o.stepInfo.VersionComposant):r._serviceManager&&r.Context&&(o.stepInfo=null,o.versionComposant=r.Context.VersionComposant),e.withHeaders?r.Context.GetAuthentificationInfo().then(function(e){o.authentificationInfo=e,r.Context.GetParametresComptables().then(function(e){o.parametresComptables=e,s.CoreCommon.SendRequest(o,function(e){t.resolve(e)},function(e){t.reject(e)})}).catch(t.reject)}).catch(t.reject):s.CoreCommon.SendRequest(o,function(e){t.resolve(e)},function(e){t.reject(e)})})}}(MyWay||(MyWay={})),function(e){var o,n,t;o=e.Services||(e.Services={}),n=o.Context||(o.Context={}),t=function(){function e(e){this.serviceManager=e}return Object.defineProperty(e.prototype,"VersionComposant",{get:function(){return o.CoreCommon.VersionMySys},enumerable:!0,configurable:!0}),e.prototype.AddToContext=function(e,t){var r=o.CoreCommon.ServiceDePromesse.defer();return this.serviceManager.Library.Context.AddToContext(n.StorageLevel.Process,e,t),r.resolve(),r.promise},e.prototype.AddToMainProcessContext=function(e,t){var r=o.CoreCommon.ServiceDePromesse.defer();return this.serviceManager.Library.Context.AddToContext(n.StorageLevel.MainProcess,e,t),r.resolve(),r.promise},e.prototype.AddListToContext=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return this.serviceManager.Library.Context.AddListToContext(n.StorageLevel.Process,e),t.resolve(),t.promise},e.prototype.GetFromContext=function(e){var t=o.CoreCommon.ServiceDePromesse.defer(),r=this.serviceManager.Library.Context.GetFromContext(e);return t.resolve(r),t.promise},e.prototype.GetObjectFromContext=function(e){var t=o.CoreCommon.ServiceDePromesse.defer(),r=this.serviceManager.Library.Context.GetObjectFromContext(e);return t.resolve(r),t.promise},e.prototype.GetTypedObjectFromContext=function(e){var t=o.CoreCommon.ServiceDePromesse.defer(),r=this.serviceManager.Library.Context.GetTypedObjectFromContext(e);return t.resolve(r),t.promise},e.prototype.GetListFromContext=function(e){var t=o.CoreCommon.ServiceDePromesse.defer(),r=this.serviceManager.Library.Context.GetListFromContext(e,null,null);return t.resolve(r),t.promise},e.prototype.GetAuthentificationInfo=function(){var e=o.CoreCommon.ServiceDePromesse.defer(),t=this.serviceManager.Library.Context.GetAuthentificationInfo(!1);return e.resolve(t),e.promise},e.prototype.getAuthentificationInfo=function(){return this.GetAuthentificationInfo()},e.prototype.sendNotification=function(e,t,r){r&&r(t,null,null)},e.prototype.GetParametresComptables=function(){var e=o.CoreCommon.ServiceDePromesse.defer(),t=this.serviceManager.Library.Context.GetParametresComptables();return e.resolve(t),e.promise},e.prototype.Redirect=function(e,t){throw new o.Erreur("not implemented")},e.prototype.GetWaitingProcesses=function(){throw new o.Erreur("not implemented")},e.prototype.PutProcessInPortalContext=function(e){throw new o.Erreur("not implemented")},e.prototype.PutTaskInPortalContext=function(e){throw new o.Erreur("not implemented")},e.prototype.GetCurrentProcessId=function(){throw new o.Erreur("not implemented")},e.prototype.GetCurrentStepId=function(){throw new o.Erreur("not implemented")},e.prototype.reinitialisationServiceAgent=function(e){throw new o.Erreur("not implemented")},e.prototype.GetCurrentStepInfo=function(){throw new o.Erreur("not implemented")},e.prototype.SetMyWayCompatible=function(){throw new o.Erreur("not implemented")},e.prototype.SubscribeToNotification=function(e,t){throw new o.Erreur("not implemented")},e.prototype.retirerListenerNotification=function(e){throw new o.Erreur("not implemented")},e.prototype.AnalyseApp=function(){throw new o.Erreur("not implemented")},e.prototype.ChangeMainProcessName=function(e){throw new o.Erreur("not implemented")},e.prototype.AddToSharedContext=function(e,t){throw new o.Erreur("not implemented")},e.prototype.RemoveFromSharedContext=function(e){throw new o.Erreur("not implemented")},Object.defineProperty(e.prototype,"StepInfo",{get:function(){return null},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ErreurCallback",{get:function(){return null},enumerable:!0,configurable:!0}),e.prototype.SetContextListener=function(e,t){},e}(),n.PhantomContextAgent=t}(MyWay||(MyWay={})),function(e){var h;(function(u){var p=function(){function r(e,t,r){this.FrameId=e,this._baseFrameElement=t,this.displayManager=r,this._frameElement=document.getElementById(this.FrameId),this.TempId="",this.Redirected=!1,this.IsHidden=!0}return Object.defineProperty(r.prototype,"SimulateAppIFrame",{get:function(){return h.PrivatePortalServiceParameters.Instance().SimulateAppIFrame},enumerable:!0,configurable:!0}),Object.defineProperty(r.prototype,"FrameElement",{get:function(){return this._frameElement||(r.logger.debug("Tentative de récupération de _frameElement, Id %1",this.FrameId),this._frameElement=document.getElementById(this.FrameId)),this._frameElement?this._frameElement:(r.logger.debug("Impossible de récupérer _frameElement, Id %1",this.FrameId),null)},enumerable:!0,configurable:!0}),r.prototype.CreateFrameElement=function(){if(!this.SimulateAppIFrame&&!this._frameElement){var e=document.createElement("IFRAME");e.id=this.FrameId,this._baseFrameElement.parentElement.appendChild(e),this._frameElement=document.getElementById(this.FrameId),this._frameElement&&r.logger.debug("Création de la frame %1",this.FrameElement.id)}},r.prototype.RemoveFrameElement=function(){!this.SimulateAppIFrame&&this.FrameElement&&this._baseFrameElement&&this._baseFrameElement.parentElement.contains(this.FrameElement)&&(this.FrameElement&&r.logger.debug("Suppression de la frame %1",this.FrameElement.id),this._baseFrameElement.parentElement.removeChild(this.FrameElement))},r.prototype.SetUrl=function(e){var t=this.FrameElement;return t?(t.setAttribute("src",e),r.logger.debug("Changement de l'url de la frame %1: %2",t.id,e),this.FrameUrl=e,!0):!!this.SimulateAppIFrame&&(this.FrameUrl=e,!0)},r.prototype.Show=function(){var e=!1;if(!this.SimulateAppIFrame&&this.FrameElement&&this.FrameElement.hasAttribute("style")&&this.FrameElement.removeAttribute("style"),this.IsHidden){this.FrameElement&&r.logger.debug("Affichage de la frame %1",this.FrameElement.id);var t=new h.NotificationMessage;t.Sujet="FrameShown",this.displayManager.getManagerLibrary().Context.NotifyFrame(t,this),e=!(this.IsHidden=!1)}return e},r.prototype.Hide=function(){if(!this.SimulateAppIFrame&&this.FrameElement&&this.FrameElement.setAttribute("style","display:none"),!this.IsHidden){this.FrameElement&&r.logger.debug("Masquage de la frame %1",this.FrameElement.id);var e=new h.NotificationMessage;e.Sujet="FrameHidden",this.displayManager.getManagerLibrary().Context.NotifyFrame(e,this),this.IsHidden=!0}},r.prototype.SetId=function(){this.FrameElement&&(r.logger.debug("Changement de l'id de la frame %1 pour %2",this.FrameElement.id,this.FrameId),this.FrameElement.id=this.FrameId)},r.prototype.GetWindow=function(){return this.FrameElement?this.FrameElement.contentWindow:null},r.CLASS_NAME="MyWay.Services.Display.FrameModel",r.logger=h.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME),r}();u.FrameModel=p;var e=function(s){function l(){var e=s.call(this,h.Components.ComponentType.Display)||this;return e.formatObjectNotificationListeners={},e}return __extends(l,s),l.prototype.setFormatObjectNotificationListener=function(e,t){this.formatObjectNotificationListeners[e]=t},l.prototype.init=function(e,t,r,o){var n=this;return this._logOnUrl=r.LogOnUrl||null,this.Frames=[],this.BaseFrame=new p(r.IFrameId,null,this),this.Frames.push(this.BaseFrame),this.CurrentFrame=this.BaseFrame,s.prototype.init.call(this,e,t,r,o).then(function(){n.library.Evennements.ajouterListener(function(t){if(n.Frames){var r={Contenu:null,type:null,Sujet:"NotificationEvent"};n.formatObjectNotificationListeners[t.EventType]&&(n.formatObjectNotificationListeners[t.EventType](t,r),n.Frames.forEach(function(e){t.onSend&&t.onSend(e.FrameId),n.library.Context.NotifyFrame(r,e)}))}})})},l.prototype.getManagerLibrary=function(){return this.library},l.prototype.AfficherUrl=function(e,t,r){void 0===r&&(r=!1),l.logger.debug("AfficherUrl, ulr: "+e);var o=h.CoreCommon.ServiceDePromesse.defer();return t?this.DisplayIFrameUrl(e,t,r,function(e){l.logger.debug("L'url est affiché dans la frame correspondant au processus %1",t),o.resolve(e)}):(this.DisplayBaseUrl(e),l.logger.debug("L'url est affiché dans la frame de base"),o.resolve(!0)),o.promise},l.prototype.OuvrirUrl=function(e){return l.logger.debug("L'url est affiché dans une nouvelle instance de navigateur"),window.open(e)},l.prototype.DisplayBaseFrame=function(){l.logger.debug("Masque toutes les frames sauf celle correspondant à l'id %1",this.BaseFrame.FrameId),this.ShowOnlyIFrame(this.BaseFrame.FrameId)},l.prototype.DisplayLogOn=function(){l.logger.debug("Display logon"),this.SendEvent(new h.Component.ManagerEvent(h.Component.ManagerEventType.AfficherLogOn,null)),this._logOnUrl&&(!this.BaseFrame.FrameUrl||this.BaseFrame.FrameUrl.indexOf(this._logOnUrl)<0)&&this.Redirect(this._logOnUrl,this.CurrentFrame)},l.prototype.Redirect=function(e,t,r){var o,n;void 0===e&&(e=null),void 0===t&&(t=null),void 0===r&&(r=null);var s=null;if(t&&"string"==typeof t?(o=t,n=this.CurrentFrame):t&&"object"==typeof t&&(n=t),l.logger.debug("Redirect, url: "+e+", previousUrl: "+o),n)this.SavedUrl=o||n.FrameUrl,this.SavedFrameId=n.FrameId,this.SavedProcessId=n.ProcessId,s=this.AfficherUrl(e,null,!1);else if(e)null===r||r===this.BaseFrame.FrameId?s=this.AfficherUrl(e,null,!1):(s=this.AfficherUrl(e,this.SavedProcessId,!1),this.SavedUrl=null,this.SavedFrameId=null,this.SavedProcessId=null);else if(this.SavedUrl)s=this.Redirect(this.SavedUrl,null,this.SavedFrameId);else{this.SendEvent(new h.Component.ManagerEvent(h.Component.ManagerEventType.MasquerLogOn,null));var i=h.CoreCommon.ServiceDePromesse.defer();i.resolve(!0),s=i.promise}return s},l.prototype.CleanFrames=function(e){var t=[];l.logger.debug("CleanFrames %1",JSON.stringify(e));for(var r=0;r<this.Frames.length;r++){var o=this.Frames[r];if(o.ProcessId){var n=!1;for(var s in e)if(e[s].id===o.ProcessId){n=!0;break}n||(this.RemoveProcessIFrame(o.ProcessId),t.push(r))}}var i=t.reverse();for(var a in i)r=i[a],this.Frames.splice(r,1)},l.prototype.CleanLastProcessFrame=function(){var r=this,e=this.library.Context.GetCurrentMainProcess();if(l.logger.debug("CleanLastProcessFrame %1",JSON.stringify(e)),e){var o=this.GetLastFrameModelByProcessId(e.id);o&&o.RemoveFrameElement(),this.Frames.some(function(e,t){if(e.FrameId===o.FrameId)return r.Frames.splice(t,1),!0})}},l.prototype.RemoveProcessIFrame=function(e){var r=this,t=this.GetFrameModelsByProcessId(e);for(var o in l.logger.debug("Suppression de la frame du processus %1",e),t){var n=t[o];n.RemoveFrameElement(),this.Frames.some(function(e,t){if(e.FrameId===n.FrameId)return r.Frames.splice(t,1),!0})}},l.prototype.DisplayMessage=function(e){l.logger.debug("DisplayMessage"),this.onNotificationDeMessage&&this.onNotificationDeMessage(e)},l.prototype.FermerModalMessage=function(){l.logger.debug("FermerModalMessage"),this.onFermerModalMessage&&this.onFermerModalMessage()},l.prototype.AfficherModalMessage=function(e,t,r,o,n,s){l.logger.debug("Lancement de l'évènement d'affichage d'une modale Message"),this.onAffichageModalMessage&&this.onAffichageModalMessage(e,t,r,o,n,s)},l.prototype.AfficherModalAide=function(e,t,r,o){l.logger.debug("Lancement de l'évènement d'affichage d'une modale Aide"),this.onAffichageModalAide&&this.onAffichageModalAide(e,t,r,o)},l.prototype.getMyIFrameId=function(t){var r=null;return this.Frames&&this.Frames.every(function(e){return e.GetWindow()===t&&(r=e.FrameId),null===r}),r},l.prototype.DisplayIFrameUrl=function(e,t,r,o){l.logger.debug("DisplayIFrameUrl, url: "+e);var n=this.library.Context.GetCurrentProcess(),s=null;if(n&&(s=this.library.Context.GetCurrentStep(n)),s.isRouteur)s.etatEtape==h.Context.EtatEtape.RESET&&(s.etatEtape=h.Context.EtatEtape.STARTED,this.ExecuteJS(s.url));else{var i=!1;s.etatEtape==h.Context.EtatEtape.RESET&&(s.etatEtape=h.Context.EtatEtape.STARTED,i=!0),this.AddProcessIFrame(e,t,r,!1,i),o&&o(!0)}},l.prototype.DisplayBaseUrl=function(e){return l.logger.debug("DisplayBaseUrl, url: "+e),!(!this.ShowOnlyIFrame(this.BaseFrame.FrameId)||this.BaseFrame.FrameUrl!==e)||(this.BaseFrame.FrameUrl===e&&(0<=this.BaseFrame.FrameUrl.indexOf("?")?e+="&":e+="?",e+=h.CoreCommon.creerChaineAleatoire(7)),this.BaseFrame.IsMyWayUrl=!1,!!this.BaseFrame.SetUrl(e))},l.prototype.GetFrameModelById=function(e){for(var t=0;t<this.Frames.length;t++){var r=this.Frames[t];if(r.FrameId===e)return r}return null},l.prototype.GetLastFrameModelByProcessId=function(e){for(var t=this.Frames.length-1;0<=t;t--)if((r=this.Frames[t]).ProcessId===e&&""===r.TempId)return r;for(t=this.Frames.length-1;0<=t;t--){var r;if((r=this.Frames[t]).ProcessId===e)return r}return null},l.prototype.GetFrameModelsByProcessId=function(e){for(var t=[],r=this.Frames.length-1;0<=r;r--){var o=this.Frames[r];o.ProcessId===e&&t.push(o)}return t},l.prototype.ShowOnlyIFrame=function(e,t){var r;if(!e)throw"iframeId is mandatory";if(null==(n=this.GetFrameModelById(e)))throw"can't find frame with id "+e;for(var o in r=n.Show(),this.CurrentFrame=n,this.Frames){var n;(n=this.Frames[o]).FrameId!=e&&n.Hide()}return(r||t)&&this.onShowFrame&&this.onShowFrame(this.CurrentFrame),r},l.prototype.AddProcessIFrame=function(e,t,r,o,n){l.logger.debug("AddProcessIFrame");var s,i="iframe-"+t,a=this.GetLastFrameModelByProcessId(t),c=null;a&&r?(this.AddTempId(a,t,"-"+h.CoreCommon.creerChaineAleatoire(8)),c=a,a=null):a&&a.TempId&&this.AddTempId(a,t,""),!(s=a?this.ShowOnlyIFrame(a.FrameId):((a=new p(i,this.BaseFrame.FrameElement,this)).ProcessId=t,c&&(a.PreviousFrame=c),this.Frames.push(a),a.CreateFrameElement(),this.ShowOnlyIFrame(a.FrameId,!0)))&&a.FrameUrl===e&&n&&a.IsMyWayUrl&&(l.logger.debug("refresh demandé"),this.sendMessage(u.DisplayMessageSubject.Refresh)),(!a.IsProducteur&&a.FrameUrl!=e||a.IsProducteur&&a.FrameUrlOrigine!=e)&&(a.Redirected?l.logger.warn("Frame has a Redirected flag, set url cannot be done"):(l.logger.debug("SetUrl"),a.SetUrl(e))),s||(a.Redirected=o),this.CurrentFrame=a,!s&&n&&(this.CurrentFrame.IsMyWayUrl=!1)},l.prototype.AddTempId=function(e,t,r){e.FrameId="iframe-"+t+r,e.TempId=r,e.SetId()},l.prototype.ExecuteJS=function(e){l.logger.info("execution d'une étape de routage: %1",e),h.CoreCommon.loadScript(e)},l.prototype.RedirectInStep=function(e){var t=this.library.Context.GetCurrentProcess();this.AddProcessIFrame(e,t.id,!1,!0,!0)},l.prototype.PrepareSubmit=function(e){l.logger.debug("Prepare frame for submit");var t=this.library.Context.GetCurrentMainProcess(),r=this.GetLastFrameModelByProcessId(t.id);r.FrameUrlOrigine=r.FrameUrl,r.FrameUrl=e,r.Redirected=!0,r.IsMyWayUrl=!1,r.IsProducteur=!0},l.prototype.FinishSubmit=function(){var e=this.library.Context.GetCurrentMainProcess();if(e){var t=this.GetLastFrameModelByProcessId(e.id);t&&t.Redirected&&(l.logger.debug("cancel redirected flag"),t.Redirected=!1,t.FrameUrlOrigine="")}},l.CLASS_NAME="MyWay.Services.Display.DisplayManager",l.logger=h.Loggers.LoggerFactory.INSTANCE.getClass(l.CLASS_NAME),l}(h.Components.ComponentManagerBase);u.DisplayManager=e,h.Components.RegistryManager.getInstance().register(e)})((h=e.Services||(e.Services={})).Display||(h.Display={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-context-display-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])};return function(e,t){function s(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}}();!function(e){var t,n,s;t=e.Services||(e.Services={}),n=t.BaseDeDonnees||(t.BaseDeDonnees={}),s=function(s){function e(){return s.call(this,t.Components.ComponentType.BaseDeDonnees)||this}return __extends(e,s),e.prototype.onGetBases=function(){return this.managerInstance.getBases()},e.prototype.onGet=function(e){var t=e.base,s=e.table,n=e.cle;return this.managerInstance.getBase(t).getTable(s).get(n)},e.prototype.onGetAll=function(e){var t=e.base,s=e.table;return this.managerInstance.getBase(t).getTable(s).getAll()},e.prototype.onFind=function(e){var t=e.base,s=e.table,n=e.critere;return this.managerInstance.getBase(t).getTable(s).chercher(n)},e.prototype.onCount=function(e){var t=e.base,s=e.table,n=e.critere;return this.managerInstance.getBase(t).getTable(s).count(n)},e.prototype.onAjouter=function(e){var t=e.base,s=e.table,n=e.elements;return this.managerInstance.getBase(t).getTable(s).ajouter(n)},e.prototype.onSupprimer=function(e){var t=e.base,s=e.table,n=e.cles;return this.managerInstance.getBase(t).getTable(s).supprimer(n)},e.prototype.onModifier=function(e){var t=e.base,s=e.table,n=e.elements;return this.managerInstance.getBase(t).getTable(s).mettreAJour(n)},e.prototype.onResetAll=function(){var n=this;return this.managerInstance.getBases().then(function(e){var s=[];return e.forEach(function(e){var t=n.managerInstance.getBase(e);t.getTables().forEach(function(e){s.push(t.getTable(e).resetAll())})}),n.library.Core.getServiceDePromesse().all(s).then(function(){})})},e.prototype.reception=function(e){switch(e.subject){case n.Messages.BaseDeDonneesMessageSubject.GetBases:var t=e.message;return this.onGetBases();case n.Messages.BaseDeDonneesMessageSubject.Get:return t=e.message,this.onGet(t);case n.Messages.BaseDeDonneesMessageSubject.GetAll:return t=e.message,this.onGetAll(t);case n.Messages.BaseDeDonneesMessageSubject.Find:return t=e.message,this.onFind(t);case n.Messages.BaseDeDonneesMessageSubject.Count:return t=e.message,this.onCount(t);case n.Messages.BaseDeDonneesMessageSubject.Ajouter:return t=e.message,this.onAjouter(t);case n.Messages.BaseDeDonneesMessageSubject.Supprimer:return t=e.message,this.onSupprimer(t);case n.Messages.BaseDeDonneesMessageSubject.MettreAJour:return t=e.message,this.onModifier(t);case n.Messages.BaseDeDonneesMessageSubject.ResetAll:return t=e.message,this.onResetAll();default:return s.prototype.reception.call(this,e)}},e}(t.Components.ComponentManagerMessageBase),n.BaseDeDonneesManagerMessage=s,t.Components.RegistryManagerMessage.getInstance().register(s)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-database-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,r,n;t=e.Services||(e.Services={}),r=t.JAB||(t.JAB={}),n=function(n){function e(){return n.call(this,t.Components.ComponentType.JAB)||this}return __extends(e,n),e.prototype.reception=function(e){switch(e.subject){case r.JABMessageSubject.Enregistrer:var t=e.message.data;return this.managerInstance.enregistrer(t);default:return n.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.JAB.JABManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),r.JABManagerMessage=n,t.Components.RegistryManagerMessage.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-jab-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,s,n;t=e.Services||(e.Services={}),s=t.TraitementNsdk||(t.TraitementNsdk={}),n=function(a){function e(){return a.call(this,t.Components.ComponentType.TraitementNsdk)||this}return __extends(e,a),e.prototype.reception=function(e){switch(e.subject){case s.TraitementNsdkMessageSubject.Lancer:var t=e.message,n=t.data,r=t.traitement;return this.managerInstance.Lancer(r,n);default:return a.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.TraitementNsdk.TraitementNsdkManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),s.TraitementNsdkManagerMessage=n,t.Components.RegistryManagerMessage.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-traitement-nsdk-manager-message.min.js.map
var MyWay;!function(y){var a;(a=y.Services||(y.Services={})).Bug||(a.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-test-mobile.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var n,s,t;n=e.Services||(e.Services={}),s=n.Aide||(n.Aide={}),t=function(e){function t(){return e.call(this,n.Components.ComponentType.Aide)||this}return __extends(t,e),t.prototype.GetContenuInfobulle=function(e,t,n,o){return this.sendMessage(s.Messages.AideMessageSubject.GetContenuInfobulle,{idChampLie:e,horsProcessus:t,codeProcessus:n,codeEtape:o}).then(function(e){var t=new s.DetailInfobulleAfficheeResult(e);return new s.DetailInfobulleAfficheeResult(t)})},t.prototype.GetInfobullesAffichables=function(e,t,n){return this.sendMessage(s.Messages.AideMessageSubject.GetInfobullesAffichables,{horsProcessus:e,codeProcessus:t,codeEtape:n}).then(function(e){for(var t=[],n=0;n<e.length;n++)t.push(new s.InfobulleAfficheeResult(e[n]));return t})},t}(n.Components.ComponentAgentBase),s.AideAgent=t,n.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-aide-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,n,r;t=e.Services||(e.Services={}),n=t.Aide||(t.Aide={}),r=function(r){function e(){return r.call(this,t.Components.ComponentType.Aide)||this}return __extends(e,r),e.prototype.init=function(e,t,n){return r.prototype.init.call(this,e,t,n)},e.prototype.GetContenuInfobulle=function(e){return this.libraryManager.Core.sendRequest({url:t.PrivatePortalServiceParameters.Instance().AideUrl+"/recherche/infobulle?codeEtablissement="+e.codeEtablissement+"&processus="+e.codeProcessus+"&etape="+e.codeEtape+"&date="+e.dateTraitement+"&nomChamp="+e.idChampLie,method:t.MethodEnum.GET,withHeaders:!0})},e.prototype.GetInfobullesAffichables=function(e){return this.libraryManager.Core.sendRequest({url:t.PrivatePortalServiceParameters.Instance().AideUrl+"/recherche/presenceinfobulle?codeEtablissement="+e.codeEtablissement+"&processus="+e.codeProcessus+"&etape="+e.codeEtape+"&date="+e.dateTraitement,method:t.MethodEnum.GET,withHeaders:!0})},e.prototype.GetAideFlash=function(e){return this.libraryManager.Core.sendRequest({url:t.PrivatePortalServiceParameters.Instance().AideUrl+"/recherche/flash/?codeEtablissement="+e.codeEtablissement+"&etape="+e.codeEtape+"&date="+e.dateTraitement,method:t.MethodEnum.GET,withHeaders:!0})},e}(t.Components.ComponentApiBase),n.AideApi=r,t.Components.RegistryApi.getInstance().register(r)}(MyWay||(MyWay={})),function(e){var t;(function(e){e.CODE_ETAPE_KEY="codeEtape",e.ID_FLASH_CODE_KEY="idFlashCode";var t=function(){function e(){}return e.prototype.estEgal=function(e){return this.codeEtablissement==e.codeEtablissement&&this.codeEtape==e.codeEtape&&this.codeProcessus==e.codeProcessus&&this.dateTraitement==e.dateTraitement&&this.pointEntree==e.pointEntree},e}(),n=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.estEgal=function(e){return t.prototype.estEgal.call(this,e)&&this.idChampLie==e.idChampLie},e}(e.InfobulleAfficheeParametres=t);e.DetailInfobulleAfficheeParametres=n})((t=e.Services||(e.Services={})).Aide||(t.Aide={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-aide-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t;(t=e.Services||(e.Services={})).Core.defineProperty(t.TechAgentExtended,"InteropTechAgent",{get:function(){return this._techLibrary.InteropTechAgent}}),t.TechAgentExtended.prototype.Lancer=function(e,t,n,r,o){return this._techLibrary.Lancer(e,t,n,r,o)},t.TechAgentExtended.prototype.AddToContextInterop=function(e,t,n,r,o){return this._techLibrary.AddToContextInterop(e,t,n,r,o)},t.TechAgentExtended.prototype.AddListToContextInterop=function(e,t,n,r){return this._techLibrary.AddListToContextInterop(e,t,n,r)},t.TechAgentExtended.prototype.GetListFromContextInterop=function(e,t,n,r){return this._techLibrary.GetListFromContextInterop(e,t,n,r)},t.TechAgentExtended.prototype.GetFromContextInterop=function(e,t,n,r,o){return this._techLibrary.GetFromContextInterop(e,t,n,r,o)},t.TechAgentExtended.prototype.EndStep=function(){return this._techLibrary.EndStep()},t.TechAgentExtended.prototype.AfficherWindowParHandle=function(e,t){return this._techLibrary.AfficherWindowParHandle(e,t)},t.TechAgentExtended.prototype.AfficherWindowParPid=function(e,t){return this._techLibrary.AfficherWindowParPid(e,t)},t.TechAgentExtended.prototype.AfficherSynthese=function(e){return this._techLibrary.AfficherSynthese(e)},t.TechAgentExtended.prototype.ActiverApplicationAppelante=function(e){return this.InteropTechAgent.ActiverApplicationAppelante(e)}}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Core.defineProperty(t.TechAgent,"InteropTechAgent",{get:function(){return this._techLibrary.InteropTechAgent}}),t.TechAgent.prototype.Lancer=function(e,t,n,r,o){return this.InteropTechAgent.Lancer(e,t,n,r,o)},t.TechAgent.prototype.AddToContextInterop=function(e,t,n,r,o){return this.InteropTechAgent.AddToContextInterop(e,t,n,r,o)},t.TechAgent.prototype.AddListToContextInterop=function(e,t,n,r){return this.InteropTechAgent.AddListToContextInterop(e,t,n,r)},t.TechAgent.prototype.GetListFromContextInterop=function(e,t,n,r){return this.InteropTechAgent.GetListFromContextInterop(e,t,n,r)},t.TechAgent.prototype.GetFromContextInterop=function(e,t,n,r,o){return this.InteropTechAgent.GetFromContextInterop(e,t,n,r,o)},t.TechAgent.prototype.EndStep=function(){return this.InteropTechAgent.EndStep()},t.TechAgent.prototype.AfficherWindowParHandle=function(e,t){return this.InteropTechAgent.AfficherWindowParHandle(e,t)},t.TechAgent.prototype.AfficherWindowParPid=function(e,t){return this.InteropTechAgent.AfficherWindowParPid(e,t)},t.TechAgent.prototype.AfficherSynthese=function(e){return this.InteropTechAgent.AfficherSynthese(e)},t.TechAgent.prototype.ActiverApplicationAppelante=function(e){return this.InteropTechAgent.ActiverApplicationAppelante(e)}}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).TechLibrary.addInitListener(function(e,t){e.InteropTechAgent=t.Interop}),t.TechLibrary.prototype.Lancer=function(e,t,n,r,o){return this.InteropTechAgent.Lancer(e,t,n,r,o)},t.TechLibrary.prototype.AddToContextInterop=function(e,t,n,r,o){return this.InteropTechAgent.AddToContextInterop(e,t,n,r,o)},t.TechLibrary.prototype.AddListToContextInterop=function(e,t,n,r){return this.InteropTechAgent.AddListToContextInterop(e,t,n,r)},t.TechLibrary.prototype.GetListFromContextInterop=function(e,t,n,r){return this.InteropTechAgent.GetListFromContextInterop(e,t,n,r)},t.TechLibrary.prototype.GetFromContextInterop=function(e,t,n,r,o){return this.InteropTechAgent.GetFromContextInterop(e,t,n,r,o)},t.TechLibrary.prototype.EndStep=function(){return this.InteropTechAgent.EndStep()},t.TechLibrary.prototype.AfficherWindowParHandle=function(e,t){return this.InteropTechAgent.AfficherWindowParHandle(e,t)},t.TechLibrary.prototype.AfficherWindowParPid=function(e,t){return this.InteropTechAgent.AfficherWindowParPid(e,t)},t.TechLibrary.prototype.AfficherSynthese=function(e){return this.InteropTechAgent.AfficherSynthese(e)},t.TechLibrary.prototype.ActiverApplicationAppelante=function(e){return this.InteropTechAgent.ActiverApplicationAppelante(e)}}(MyWay||(MyWay={})),function(e){var t,i,n;t=e.Services||(e.Services={}),i=t.Interop||(t.Interop={}),n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.Lancer=function(e,t,n,r,o){return this.sendMessage(i.Messages.InteropMessageSubject.Lancer,{executableWrapper:e,contexte:t,parametres:n,sync:r}).catch(function(e){throw o&&o(e),e})},t.prototype.AddToContextInterop=function(e,t,n,r,o){return this.sendMessage(i.Messages.InteropMessageSubject.AddToContextInterop,{level:e,key:t,value:n}).then(function(e){return r&&r(e),e},function(e){throw o&&o(e),e})},t.prototype.AddListToContextInterop=function(e,t,n,r){return this.sendMessage(i.Messages.InteropMessageSubject.AddListToContextInterop,{level:e,datas:t}).then(function(e){return n&&n(e),e},function(e){throw r&&r(e),e})},t.prototype.GetListFromContextInterop=function(e,t,n,r){return this.sendMessage(i.Messages.InteropMessageSubject.GetListFromContextInterop,{level:e,datas:t}).then(function(e){return n&&n(e),e},function(e){throw r&&r(e),e})},t.prototype.GetFromContextInterop=function(e,t,n,r,o){return this.sendMessage(i.Messages.InteropMessageSubject.GetFromContextInterop,{level:e,key:t,value:n}).then(function(e){return r&&r(e),e},function(e){throw o&&o(e),e})},t.prototype.EndStep=function(){return this.sendMessage(i.Messages.InteropMessageSubject.EndStep,{})},t.prototype.AfficherWindowParHandle=function(e,t){return this.sendMessage(i.Messages.InteropMessageSubject.AfficherWindowParHandle,{handle:e,affiche:t})},t.prototype.AfficherWindowParPid=function(e,t){return this.sendMessage(i.Messages.InteropMessageSubject.AfficherWindowParPid,{pid:e,affiche:t})},t.prototype.AfficherSynthese=function(e){return this.sendMessage(i.Messages.InteropMessageSubject.AfficherSynthese,{numeroClient:e})},t.prototype.ActiverApplicationAppelante=function(e){return this.sendMessage(i.Messages.InteropMessageSubject.ActiverApplicationAppelante,{numeroPlan:e})},t.prototype.LireFichier=function(e,t,n){return this.sendMessage(i.Messages.InteropMessageSubject.LireFichier,{nomFichier:e}).then(function(e){return t&&t(e),e},function(e){throw n&&n(e),e})},t.prototype.clearBus=function(){return this.sendMessage(i.Messages.InteropMessageSubject.ClearBus,{})},t}(i.InteropAgent),i.InteropTechAgent=n,t.Components.RegistryAgent.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-interop-tech-agent.min.js.map
var MyWay;!function(l){var c;(function(r){function n(e){var o;return e.hasOwnProperty("typeName")?"Le paramètre impressionParams doit être du nouveau type ImpressionParams":""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"obligatoires",value:e.obligatoires,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull}]))?o:""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"nomFichier",value:e.obligatoires.nomFichier,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull}]))?o:""}function i(e){var o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametreActiveX)){if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametreActiveX.annul)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"annul",value:e.optionnels.parametreActiveX.annul,controle:l.Services.Controle.CONTROLES.isBoolean}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametreActiveX.voir)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"voir",value:e.optionnels.parametreActiveX.voir,controle:l.Services.Controle.CONTROLES.isBoolean}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametreActiveX.enregistrer)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"enregistrer",value:e.optionnels.parametreActiveX.enregistrer,controle:l.Services.Controle.CONTROLES.isBoolean}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametreActiveX.blocnbex)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"blocnbex",value:e.optionnels.parametreActiveX.blocnbex,controle:l.Services.Controle.CONTROLES.isBoolean}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametreActiveX.nbcopiesdef)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"nbcopiesdef",value:e.optionnels.parametreActiveX.nbcopiesdef,controle:l.Services.Controle.CONTROLES.isNumber}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametreActiveX.mincop)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"mincop",value:e.optionnels.parametreActiveX.mincop,controle:l.Services.Controle.CONTROLES.isNumber}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametreActiveX.maxcop)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"maxcop",value:e.optionnels.parametreActiveX.maxcop,controle:l.Services.Controle.CONTROLES.isNumber}])))return o}return""}function t(e){var o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels)&&c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametresActiveXIndividuels)){if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametresActiveXIndividuels.voir)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"voir",value:e.optionnels.parametresActiveXIndividuels.voir,controle:l.Services.Controle.CONTROLES.isBoolean}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametresActiveXIndividuels.enregistrer)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"enregistrer",value:e.optionnels.parametresActiveXIndividuels.enregistrer,controle:l.Services.Controle.CONTROLES.isBoolean}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametresActiveXIndividuels.blocnbex)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"blocnbex",value:e.optionnels.parametresActiveXIndividuels.enregistrer,controle:l.Services.Controle.CONTROLES.isBoolean}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametresActiveXIndividuels.nbcopiesdef)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"nbcopiesdef",value:e.optionnels.parametresActiveXIndividuels.nbcopiesdef,controle:l.Services.Controle.CONTROLES.isNumber}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametresActiveXIndividuels.mincop)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"mincop",value:e.optionnels.parametresActiveXIndividuels.mincop,controle:l.Services.Controle.CONTROLES.isNumber}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametresActiveXIndividuels.maxcop)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"maxcop",value:e.optionnels.parametresActiveXIndividuels.maxcop,controle:l.Services.Controle.CONTROLES.isNumber}])))return o}return""}function a(e){var o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e)){if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.annul)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"annul",value:e.annul,controle:l.Services.Controle.CONTROLES.isBoolean}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.impdef)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"impdef",value:e.impdef,controle:l.Services.Controle.CONTROLES.isBoolean}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.affred)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"affred",value:e.affred,controle:l.Services.Controle.CONTROLES.isBoolean}])))return o;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.reimp)&&""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"reimp",value:e.reimp,controle:l.Services.Controle.CONTROLES.isBoolean}])))return o}return""}r.controleGenerer=function(e,o){var t;if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"data",value:e,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull},{name:"generationParams",value:o,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull}])))return t;if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"systeme",value:o.systeme,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull},{name:"obligatoires",value:o.obligatoires,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull}])))return t;if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"typeName",value:o.systeme.typeName,controle:l.Services.Controle.CONTROLES.isStringNotEmpty},{name:"typeFullName",value:o.systeme.typeFullName,controle:l.Services.Controle.CONTROLES.isStringNotEmpty},{name:"librairie",value:o.systeme.librairie,controle:l.Services.Controle.CONTROLES.isStringNotEmpty}])))return t;if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"action",value:o.obligatoires.action,controle:l.Services.Controle.CONTROLES.isAnEnumValue,enumName:"Impression.GENERATION_ACTION",enumObject:r.GENERATION_ACTION},{name:"parametresGenerationFichier",value:o.obligatoires.parametresGenerationFichier,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull}])))return t;if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"typeFichier",value:o.obligatoires.parametresGenerationFichier.typeFichier,controle:l.Services.Controle.CONTROLES.isAnEnumValue,enumName:"Fichier.TYPE_FICHIER",enumObject:c.Fichier.TYPE_FICHIER},{name:"restitutionVersion",value:o.obligatoires.parametresGenerationFichier.restitutionVersion,controle:l.Services.Controle.CONTROLES.isAnEnumValue,enumName:"Impression.RESTITUTION_VERSION",enumObject:r.RESTITUTION_VERSION},{name:"sousRepModele",value:o.obligatoires.parametresGenerationFichier.sousRepModele,controle:l.Services.Controle.CONTROLES.isString}])))return t;if((o.obligatoires.action==r.GENERATION_ACTION.archiverAndGetFichier||o.obligatoires.action==r.GENERATION_ACTION.getFichier)&&!c.Controle.StaticStringControle.isStringNotEmpty(o.optionnels.nomFichier))return"L'action demandée implique que le nom du fichier soit renseigné";if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.mentionsLegales)&&""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"numEtablissement",value:o.optionnels.mentionsLegales.numEtablissement,controle:l.Services.Controle.CONTROLES.isStringNotEmptyOrNull}])))return t;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage)){if(!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc))return"Le paramètre aQstnCreerDoc de l'archivage doit être renseigné";if(!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc.donnCntx)||!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc.document))return"Les paramètres document et donnCntx de l'aQstnCreerDoc doivent être renseignés";if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"idntCmpstApplf",value:o.optionnels.archivage.aQstnCreerDoc.donnCntx.idntCmpstApplf,controle:l.Services.Controle.CONTROLES.isString}])))return t;if(!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc.document.fichierDoc)||!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc))return"Les paramètres fichierDoc et proprietesDoc de document doivent être renseignés";if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"nomFich",value:o.optionnels.archivage.aQstnCreerDoc.document.fichierDoc.nomFich,controle:l.Services.Controle.CONTROLES.isString},{name:"codeTypeNatrDoc",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeNatrDoc,controle:l.Services.Controle.CONTROLES.isString},{name:"codeTypeAttrb",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeAttrb,controle:l.Services.Controle.CONTROLES.isString},{name:"idntAttrb",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.idntAttrb,controle:l.Services.Controle.CONTROLES.isString},{name:"dateDeliv",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.dateDeliv,controle:l.Services.Controle.CONTROLES.isDate},{name:"dateNumr",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.dateNumr,controle:l.Services.Controle.CONTROLES.isDate},{name:"inttAttr",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.inttAttr,controle:l.Services.Controle.CONTROLES.isString}])))return t;if((!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeStck)||"A"===o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeStck)&&""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"codeTypeModeAcqs",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeModeAcqs,controle:l.Services.Controle.CONTROLES.isString},{name:"codeTypeOrigAcqs",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeOrigAcqs,controle:l.Services.Controle.CONTROLES.isString},{name:"codeTypeSign",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeSign,controle:l.Services.Controle.CONTROLES.isString}])))return t}return""},r.controleImprimer=function(e,o){var t;return""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"data",value:e,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull},{name:"impressionParams",value:o,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull}]))?t:""!==(t=n(o))?t:i(o)},r.controleImprimerLot=function(e,o){var t;return""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"data",value:e,controle:l.Services.Controle.CONTROLES.isArray}]))?t:e.length<=0?"Le lot de documents à imprimer est vide":a(o)},r.controleDocumentImpressionLot=function(e){var o;return""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"data",value:e,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull}]))?o:c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.fichier)||c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.idGed)?""!==(o=c.Controle.StaticParametresControle.checkParameters([{name:"numeroOrdre",value:e.numeroOrdre,controle:l.Services.Controle.CONTROLES.isNumber}]))?o:""!==(o=n(e.impressionParams))?o:t(e.impressionParams):'L\'un des paramètres "fichier" ou "idGed" de DocumentImpressionLot doit être renseigné'},r.controleImpressionParams=n,r.controleGenererImprimer=function(e,o){var t;if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"data",value:e,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull},{name:"generationImpressionParams",value:o,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull}])))return t;if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"systeme",value:o.systeme,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull},{name:"obligatoires",value:o.obligatoires,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull}])))return t;if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"typeName",value:o.systeme.typeName,controle:l.Services.Controle.CONTROLES.isStringNotEmpty},{name:"typeFullName",value:o.systeme.typeFullName,controle:l.Services.Controle.CONTROLES.isStringNotEmpty},{name:"librairie",value:o.systeme.librairie,controle:l.Services.Controle.CONTROLES.isStringNotEmpty}])))return t;if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"action",value:o.obligatoires.action,controle:l.Services.Controle.CONTROLES.isAnEnumValue,enumName:"Impression.GENERATION_ACTION",enumObject:r.GENERATION_ACTION},{name:"parametresGenerationFichier",value:o.obligatoires.parametresGenerationFichier,controle:l.Services.Controle.CONTROLES.isNotUndefinedAndNotNull}])))return t;if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"typeFichier",value:o.obligatoires.parametresGenerationFichier.typeFichier,controle:l.Services.Controle.CONTROLES.isAnEnumValue,enumName:"Fichier.TYPE_FICHIER",enumObject:c.Fichier.TYPE_FICHIER},{name:"restitutionVersion",value:o.obligatoires.parametresGenerationFichier.restitutionVersion,controle:l.Services.Controle.CONTROLES.isAnEnumValue,enumName:"Impression.RESTITUTION_VERSION",enumObject:r.RESTITUTION_VERSION},{name:"sousRepModele",value:o.obligatoires.parametresGenerationFichier.sousRepModele,controle:l.Services.Controle.CONTROLES.isString}])))return t;if(c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage)){if(!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc))return"Le paramètre aQstnCreerDoc de l'archivage doit être renseigné";if(!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc.donnCntx)||!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc.document))return"Les paramètres document et donnCntx de l'aQstnCreerDoc doivent être renseignés";if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"idntCmpstApplf",value:o.optionnels.archivage.aQstnCreerDoc.donnCntx.idntCmpstApplf,controle:l.Services.Controle.CONTROLES.isString}])))return t;if(!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc.document.fichierDoc)||!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc))return"Les paramètres fichierDoc et proprietesDoc de document doivent être renseignés";if(""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"nomFich",value:o.optionnels.archivage.aQstnCreerDoc.document.fichierDoc.nomFich,controle:l.Services.Controle.CONTROLES.isString},{name:"codeTypeNatrDoc",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeNatrDoc,controle:l.Services.Controle.CONTROLES.isString},{name:"codeTypeAttrb",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeAttrb,controle:l.Services.Controle.CONTROLES.isString},{name:"idntAttrb",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.idntAttrb,controle:l.Services.Controle.CONTROLES.isString},{name:"dateDeliv",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.dateDeliv,controle:l.Services.Controle.CONTROLES.isDate},{name:"dateNumr",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.dateNumr,controle:l.Services.Controle.CONTROLES.isDate},{name:"inttAttr",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.inttAttr,controle:l.Services.Controle.CONTROLES.isString}])))return t;if((!c.Controle.StaticAnyControle.isNotUndefinedAndNotNull(o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeStck)||"A"===o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeStck)&&""!==(t=c.Controle.StaticParametresControle.checkParameters([{name:"codeTypeModeAcqs",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeModeAcqs,controle:l.Services.Controle.CONTROLES.isString},{name:"codeTypeOrigAcqs",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeOrigAcqs,controle:l.Services.Controle.CONTROLES.isString},{name:"codeTypeSign",value:o.optionnels.archivage.aQstnCreerDoc.document.proprietesDoc.codeTypeSign,controle:l.Services.Controle.CONTROLES.isString}])))return t}return i(o)},r.controleParametreActiveX=i,r.controleParametreActiveXIndividuels=t,r.controleParametreActiveXGlobaux=a})((c=l.Services||(l.Services={})).Impression||(c.Impression={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-impression-business-object.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])};return function(e,t){function s(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}}();!function(e){var s,n,t;s=e.Services||(e.Services={}),n=s.Impression||(s.Impression={}),t=function(e){function t(){return e.call(this,s.Components.ComponentType.Impression)||this}return __extends(t,e),t.prototype.generer=function(e,t){return this.sendMessage(n.Messages.ImpressionMessageSubject.Generer,{data:e,generationParams:t})},t.prototype.imprimer=function(e,t){return this.sendMessage(n.Messages.ImpressionMessageSubject.Imprimer,{data:e,impressionParams:t})},t.prototype.imprimerLot=function(e,t){return this.sendMessage(n.Messages.ImpressionMessageSubject.ImprimerLot,{data:e,parametresActiveXGlobaux:t})},t.prototype.genererImprimer=function(e,t){return this.sendMessage(n.Messages.ImpressionMessageSubject.GenererImprimer,{data:e,generationImpressionParams:t})},t.prototype.getJsonConverti=function(e){return this.sendMessage(n.Messages.ImpressionMessageSubject.GetJsonConverti,{data:e})},t.prototype.imprimerEcran=function(){return window.print()},t}(s.Components.ComponentAgentBase),n.ImpressionAgent=t,s.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-impression-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t,a,r;t=e.Services||(e.Services={}),a=t.Export||(t.Export={}),r=function(s){function e(){return s.call(this,t.Components.ComponentType.Export)||this}return __extends(e,s),e.prototype.reception=function(e){switch(e.subject){case a.ExportMessageSubject.ExporterFichier:var t=e.message,r=t.donnees,o=t.format,n=t.options;return this.managerInstance.exporterFichier(r,o,n);default:return s.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Export.ExportManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),a.ExportManagerMessage=r,t.Components.RegistryManagerMessage.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-export-manager-message.min.js.map
var MyWay;!function(e){var n,o;n=e.Services||(e.Services={}),((o=n.Components||(n.Components={})).ComponentType||(o.ComponentType={})).Numerisation="Numerisation"}(MyWay||(MyWay={})),function(e){var n,o,t;n=e.Services||(e.Services={}),o=n.Numerisation||(n.Numerisation={}),(t=o.NumerisationMessageSubject||(o.NumerisationMessageSubject={}))[t.Numeriser=0]="Numeriser",t[t.GetSpiFactoryActivationStatut=1]="GetSpiFactoryActivationStatut",t[t.NumeriserArcade=2]="NumeriserArcade",n.Components.FactoryRegistries.getInstance().declareComponent(n.Components.ComponentType.Numerisation,[n.Components.ComponentType.Context,n.Components.ComponentType.Core,n.Components.ComponentType.Display,n.Components.ComponentType.DonneesDelocalisees,n.Components.ComponentType.Libelle])}(MyWay||(MyWay={})),function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-numerisation-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var n,t,o;n=e.Services||(e.Services={}),t=n.DonneesDelocalisees||(n.DonneesDelocalisees={}),o=function(e){function t(){return e.call(this,n.Components.ComponentType.DonneesDelocalisees)||this}return __extends(t,e),t.prototype.getDistantObjectData=function(e){return this.sendRequest(e)},t.prototype.getDistantTDT=function(e){return this.sendRequest(e)},t.prototype.getTDTById=function(e){return this.sendRequest(e)},t.prototype.sendRequest=function(e){return this.libraryManager.Core.sendRequest(e)},t}(n.Components.ComponentApiBase),t.DonneesDelocaliseesApi=o,n.Components.RegistryApi.getInstance().register(o)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-donnees-delocalisees-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var n,s,t;n=e.Services||(e.Services={}),s=n.DonneesDelocalisees||(n.DonneesDelocalisees={}),t=function(e){function t(){return e.call(this,n.Components.ComponentType.DonneesDelocalisees)||this}return __extends(t,e),t.prototype.getDonneesDelocalisees=function(e,t){return this.sendMessage(s.Messages.DonneesDelocaliseesMessageSubject.GetDonneesDelocalisees,{numEtablissement:e,objectDataName:t})},t.prototype.getListeDonneesDelocalisees=function(e,t){return this.sendMessage(s.Messages.DonneesDelocaliseesMessageSubject.GetListeDonneesDelocalisees,{numEtablissement:e,objectDataNames:t})},t.prototype.getRubriqueLibelle=function(e,t,n){return this.sendMessage(s.Messages.DonneesDelocaliseesMessageSubject.GetRubriqueLibelle,{numEtablissement:e,objectDataName:t,code:n})},t.prototype.getDonneesParCriteres=function(e,t,n){return this.sendMessage(s.Messages.DonneesDelocaliseesMessageSubject.GetDonneesParCriteres,{numEtablissement:e,objectDataName:t,criteres:n})},t}(n.Components.ComponentAgentBase),s.DonneesDelocaliseesAgent=t,n.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).ServiceAgentExtended.prototype.getDonneesDelocalisees=function(e,t){try{var n=this.$q.defer();return this.DonneesDelocalisees.getDonneesDelocalisees(e,t).then(function(e){n.resolve(e)},function(e){n.reject(e)}),n.promise}catch(e){throw new Error("context pas initialise !")}},t.ServiceAgentExtended.prototype.getListDonneesDelocalisees=function(t,n){var s=this;try{var o=this.$q.defer();return this.getAuthentificationInfo().then(function(e){s.DonneesDelocalisees.getDonneesDelocalisees(e.codeEtablissement,t).then(function(e){var t=[];n&&void 0!==e.donnees?e.donnees.forEach(function(e){t.push(s.instanceLoaderService.createInstance(n,e))}):t=e.donnees,o.resolve(t)},function(e){o.reject(e)})}),o.promise}catch(e){throw new Error("utilisateur pas authentifie ou service local pas demarre !")}}}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-donnees-delocalisees-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t;(t=e.Services||(e.Services={})).Core.defineProperty(t.TechAgentExtended,"ContexteClientTechAgent",{get:function(){return this._techLibrary.ContexteClientTechAgent}})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Core.defineProperty(t.TechAgent,"ContexteClientTechAgent",{get:function(){return this._techLibrary.ContexteClientTechAgent}})}(MyWay||(MyWay={})),function(e){(e.Services||(e.Services={})).TechLibrary.addInitListener(function(e,t){e.ContexteClientTechAgent=t.ContexteClient})}(MyWay||(MyWay={})),function(e){var t,r,n;t=e.Services||(e.Services={}),r=t.ContexteClient||(t.ContexteClient={}),n=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.getContextes=function(){return this.sendMessage(r.ContextClientMessageSubject.GetContextes).then(function(e){return e.idContextes})},t.prototype.detruireContexte=function(e){var t={idContexte:e,expediteur:this.getExpediteur()};return this.sendMessage(r.ContextClientMessageSubject.DestroyContext,t).then(function(e){return e.isDestroy})},t.prototype.nouveauContexte=function(e){var t={idClient:e,expediteur:this.getExpediteur()};return this.sendMessage(r.ContextClientMessageSubject.NewContext,t).then(function(e){return e.idContexte})},t.prototype.changerContexteDuProcessus=function(e,t){var n={idContexte:e,codeProcessus:t,expediteur:this.getExpediteur()};return this.sendMessage(r.ContextClientMessageSubject.ChangeContextProcess,n)},t.prototype.changerModeContexteClient=function(e,t){var n={idContexte:e,mode:t};return this.sendMessage(r.ContextClientMessageSubject.ChangeContextMode,n)},t.prototype.getDetailsContexte=function(e){var t={idContexte:e};return this.sendMessage(r.ContextClientMessageSubject.DetailsContext,t)},t.prototype.setClientOfContexteSpecifique=function(e,t){var n={idContexteClient:e,client:t,expediteur:this.getExpediteur()};return this.sendMessage(r.ContextClientMessageSubject.SetClient,n)},t.prototype.getPropertyOfContexteSpecifique=function(e,t){var n={idContexteClient:e,cle:t};return this.sendMessage(r.ContextClientMessageSubject.GetProperty,n).then(function(e){return e.valeur})},t.prototype.addToListOfContexteSpecifique=function(e,t,n){var i={idContexteClient:e,cle:t,valeur:n,expediteur:this.getExpediteur()};return this.sendMessage(r.ContextClientMessageSubject.AddToList,i).then(function(e){return e.estOk})},t.prototype.setPropertyOfContexteSpecifique=function(e,t,n){var i={idContexteClient:e,cle:t,valeur:n,expediteur:"tech-agent"};return this.sendMessage(r.ContextClientMessageSubject.SetProperty,i).then(function(e){return e.estOk})},t.prototype.removeFromListOfContexteSpecifique=function(e,t){var n={idContexteClient:e,cle:t,expediteur:this.getExpediteur()};return this.sendMessage(r.ContextClientMessageSubject.RemoveFromList,n).then(function(e){return e.estOk})},t.prototype.deletePropertyOfContexteSpecifique=function(e,t){var n={idContexteClient:e,cle:t,expediteur:this.getExpediteur()};return this.sendMessage(r.ContextClientMessageSubject.DeleteProperty,n).then(function(e){return e.estOk})},t}(r.ContexteClientAgent),r.ContexteClientTechAgent=n,t.Components.RegistryAgent.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-contexte-client-tech-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();!function(e){var r;(r=e.Services||(e.Services={})).Core.defineProperty(r.TechAgentExtended,"TraceTechAgent",{get:function(){return this._techLibrary.TraceTechAgent}}),r.TechAgentExtended.prototype.purgerTraces=function(){return this.Library.Trace.purgeTrace()}}(MyWay||(MyWay={})),function(e){var r;(r=e.Services||(e.Services={})).Core.defineProperty(r.TechAgent,"TraceTechAgent",{get:function(){return this._techLibrary.TraceTechAgent}}),r.TechAgent.prototype.purgerTraces=function(){return this.Library.Trace.purgeTrace()}}(MyWay||(MyWay={})),function(e){(e.Services||(e.Services={})).TechLibrary.addInitListener(function(e,r){e.TraceTechAgent=r.Trace})}(MyWay||(MyWay={})),function(e){var n,o,r;n=e.Services||(e.Services={}),o=n.Trace||(n.Trace={}),r=function(e){function r(){return e.call(this)||this}return __extends(r,e),r.prototype.getIntervallePurge=function(r,e){return this.sendMessage(o.Messages.TraceMessageSubject.GetIntervallePurge,{}).then(function(e){return r&&r(e),e},e)},r.prototype.getQuotaPurge=function(r,e){return this.sendMessage(o.Messages.TraceMessageSubject.GetQuotaPurge,{}).then(function(e){return r&&r(e),e},e)},r.prototype.getEnregistrerTracesDansBD=function(e,r){return r&&r(new n.Erreur("Not implemented")),this.library.Core.createPromiseSelfError(new n.Erreur("Not implemented"))},r.prototype.setNiveauMinimumTraceConsole=function(e,r,t){return t&&t(new n.Erreur("Not implemented")),this.library.Core.createPromiseSelfError(new n.Erreur("Not implemented"))},r.prototype.getNiveauMinimumTraceConsole=function(e,r){return r&&r(new n.Erreur("Not implemented")),this.library.Core.createPromiseSelfError(new n.Erreur("Not implemented"))},r.prototype.setNiveauMinimumTraceBD=function(e,r,t){return t&&t(new n.Erreur("Not implemented")),this.library.Core.createPromiseSelfError(new n.Erreur("Not implemented"))},r.prototype.getNiveauMinimumTraceBD=function(e,r){return r&&r(new n.Erreur("Not implemented")),this.library.Core.createPromiseSelfError(new n.Erreur("Not implemented"))},r.prototype.getAfficherTracesDansConsole=function(e,r){return r&&r(new n.Erreur("Not implemented")),this.library.Core.createPromiseSelfError(new n.Erreur("Not implemented"))},r.prototype.reInitDbTraces=function(e,r){return this.sendMessage(o.Messages.TraceMessageSubject.ReInitDbTraces,{}).then(function(){e&&e()},r)},r.prototype.addOldTraces=function(e,r,t){return t&&t(new n.Erreur("Not implemented")),this.library.Core.createPromiseSelfError(new n.Erreur("Not implemented"))},r.prototype.purgeTrace=function(e,r,t){return this.sendMessage(o.Messages.TraceMessageSubject.PurgerTraces,{}).then(function(){r&&r()},t)},r.prototype.getTracesByLevel=function(e,r,t){return t&&t(new n.Erreur("Not implemented")),this.library.Core.createPromiseSelfError(new n.Erreur("Not implemented"))},r.prototype.setModeDebug=function(e,r,t){return this.sendMessage(o.Messages.TraceMessageSubject.SetModeDebug,{active:e}).then(function(){return r&&r([]),[]},t)},r}(o.TraceAgent),o.TraceTechAgent=r,n.Components.RegistryAgent.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-tech-agent.min.js.map
var MyWay;!function(i){var t,a;t=i.Services||(i.Services={}),((a=t.Components||(t.Components={})).ComponentType||(a.ComponentType={})).Habilitation="Habilitation"}(MyWay||(MyWay={})),function(i){var t,a,n;t=i.Services||(i.Services={}),a=t.Habilitation||(t.Habilitation={}),(n=a.HabilitationMessageSubject||(a.HabilitationMessageSubject={}))[n.EstHabilite=0]="EstHabilite",n[n.ChargerHabilitations=1]="ChargerHabilitations",n[n.ObtenirHabilitations=2]="ObtenirHabilitations",n[n.ObtenirHabilitation=3]="ObtenirHabilitation",n[n.ModifierHabilitation=4]="ModifierHabilitation",t.Components.FactoryRegistries.getInstance().declareComponent(t.Components.ComponentType.Habilitation,[t.Components.ComponentType.Capacites,t.Components.ComponentType.Context,t.Components.ComponentType.Core])}(MyWay||(MyWay={})),function(i){var t;(function(i){var t;(t=i.DOMAIN||(i.DOMAIN={}))[t.MYSYS="mysys"]="MYSYS",t[t.IAM="iam"]="IAM",t[t.CULTURENET="cultureNet"]="CULTURENET";var a,n=function(i,t){this[i]=t};i.HabilitationModel=n,(a=i.EHabilitationType||(i.EHabilitationType={}))[a.MYSYS=0]="MYSYS",a[a.IAM=1]="IAM",a[a.CULTURENET=2]="CULTURENET"})((t=i.Services||(i.Services={})).Habilitation||(t.Habilitation={}))}(MyWay||(MyWay={})),function(i){var t;(t=i.Services||(i.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-habilitation-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var n,o,t;n=e.Services||(e.Services={}),o=n.Capacites||(n.Capacites={}),t=function(e){function t(){return e.call(this,n.Components.ComponentType.Capacites)||this}return __extends(t,e),t.prototype.getCapacite=function(e){return this.sendMessage(o.Messages.CapacitesMessageSubject.GetCapacite,{regle:e})},t}(n.Components.ComponentAgentBase),o.CapacitesAgent=t,n.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-capacites-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var n,r,t;n=e.Services||(e.Services={}),r=n.TraceSuivi||(n.TraceSuivi={}),t=function(e){function t(){return e.call(this,n.Components.ComponentType.TraceSuivi)||this}return __extends(t,e),t.prototype.tracer=function(e){return this.sendMessage(r.Messages.TraceSuiviMessageSubject.SendTraceSuivi,{trace:e})},t}(n.Components.ComponentAgentBase),r.TraceSuiviAgent=t,n.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-suivi-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();!function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var i,e,r;i=t.Services||(t.Services={}),e=i.TraceSuivi||(i.TraceSuivi={}),r=function(n){function t(){var t=n.call(this,i.Components.ComponentType.TraceSuivi)||this;return t._isSiris=null,t}return __extends(t,n),t.prototype.init=function(t,e,r){return this._url=i.PrivatePortalServiceParameters.Instance().TraceSuiviUrl,this._isSiris=t.SIRIS,n.prototype.init.call(this,t,e,r)},t.prototype.envoyerTracesSuivi=function(t,e){if(0==t.length)return this.libraryManager.Core.getPromesseSelfResoved();var r={method:i.MethodEnum.POST,url:this._url,async:!0,contentType:i.ContentTypeEnum.JSON,data:t,withHeaders:!0,authentificationInfo:e};return this.libraryManager.Core.sendRequest(r)},t.prototype.isSiris=function(){return this._isSiris},t}(i.Components.ComponentApiBase),e.TraceSuiviApiBase=r,i.Components.RegistryApi.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-suivi-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){var c;(function(e){c.ServiceManager.addActionOnInitialize("Preferences.ObtenirPreferences",function(e){return e.Preferences.ObtenirPreferences().then(function(){})},"Context.GetDonneesLocales");var r=function(i){function o(){var e=i.call(this,c.Components.ComponentType.Preferences)||this;return e.api=null,e.derniereEcritureEnAttente=null,e}return __extends(o,i),o.prototype.init=function(e,r,n,t){return this.api=t,i.prototype.init.call(this,e,r,n,t)},o.prototype.ObtenirPreferences=function(){var r=this;return this.library.Context.getAuthentificationInfo().then(function(e){if(e)return r.api.ObtenirPreferences(e.agentConnecte.referenceExterneAgent).then(function(e){return r.internalSavePreferences(e),o.logger.debug("ServiceApi.Preferences.ObtenirPreferences Success - %1",JSON.stringify(e)),e},function(e){throw o.logger.error("ServiceApi.Preferences.ObtenirPreferences Failed - %1",JSON.stringify(e)),e});throw o.logger.error("Impossible de récupérer les données d'authentification"),new c.Erreur("Impossible de récupérer les données d'authentification")})},o.prototype.LirePreference=function(r,e){var n=this;return e?this.internalGetPreferencesChargementServeur().then(function(e){return n.preferenceTrouve(r,e)}):this.internalGetPreferences().then(function(e){return n.preferenceTrouve(r,e)})},o.prototype.preferenceTrouve=function(r,e){if(e){var n=!1,t=null;return e.every(function(e){return e.cle===r&&(n=!0,t=e.valeur),!n}),t}var i=new c.Erreur("JSON des préférences mal formé");throw o.logger.error("GetFromContext Failed - 1%",JSON.stringify(i)),i},o.prototype.EcrirePreference=function(n){var t=this,e=this.library.Core.getPromesseSelfResoved();this.derniereEcritureEnAttente&&(e=this.derniereEcritureEnAttente);var i=null;return this.derniereEcritureEnAttente=e.then(function(){return t.library.Context.getAuthentificationInfo()}).then(function(e){return i=e,t.internalGetPreferences()}).then(function(e){if(e)return t.internalMettreAJourDonnee(e,n),t.api.EcrirePreference(i.agentConnecte.referenceExterneAgent,n).catch(function(e){o.logger.error("ServiceApi.Preferences.EcrirePreference Failed - 1%",JSON.stringify(e))}),t.library.Core.getPromesseSelfResoved();if(t.controlePreferences(e)){var r=new c.Erreur("Une préférence avec une clef ou une valeur vide(s) ou trop long(s).");throw o.logger.error("ServiceApi.Preferences.EcrirePreference Failed - 1%",JSON.stringify(r)),r}return t.api.EcrirePreference(i.agentConnecte.referenceExterneAgent,n).then(function(){return t.ObtenirPreferences().then(function(){})},function(e){throw o.logger.error("ServiceApi.Preferences.EcrirePreference Failed - 1%",JSON.stringify(e)),e})}),this.derniereEcritureEnAttente},o.prototype.controlePreferences=function(e){return e.forEach(function(e){if(!c.Controle.StaticObjectControle.isObject(e.cle)||!c.Controle.StaticObjectControle.isObject(e.valeur)||!c.Controle.StaticStringControle.isStringNotEmpty(e.cle)||!c.Controle.StaticStringControle.isStringNotEmpty(e.valeur)||500<e.cle.length||500<e.valeur.length)return!0}),!1},o.prototype.LireMultiPreference=function(r){return this.internalGetPreferences().then(function(e){var t={preferences:[]};return r.forEach(function(r){var n=!1;e.every(function(e){return r===e.cle&&(n=!0,t.preferences.push({cle:e.cle,valeur:e.valeur})),!n}),n||t.preferences.push(null)}),t})},o.prototype.internalGetPreferences=function(){var e=null;try{e=JSON.parse(this.library.Context.GetFromContext("preferences"))}catch(e){var r=new c.Erreur("JSON des préférences mal formé");return o.logger.error("GetFromContext Failed - 1%",JSON.stringify(r)),this.library.Core.createPromiseSelfError(r)}return e?this.library.Core.createPromiseSelfResolved(e):this.ObtenirPreferences()},o.prototype.internalGetPreferencesChargementServeur=function(){try{JSON.parse(this.library.Context.GetFromContext("preferences"))}catch(e){var r=new c.Erreur("JSON des préférences mal formé");return o.logger.error("GetFromContext Failed - 1%",JSON.stringify(r)),this.library.Core.createPromiseSelfError(r)}return this.ObtenirPreferences()},o.prototype.internalSavePreferences=function(e){this.library.Context.AddToContext(c.Context.StorageLevel.Global,"preferences",JSON.stringify(e))},o.prototype.internalMettreAJourDonnee=function(e,r){r.forEach(function(r){var n=!1;e.every(function(e){return e.cle===r.cle&&(e.valeur=r.valeur,n=!0),!n}),n||e.push({cle:r.cle,valeur:r.valeur})}),this.internalSavePreferences(e)},o.CLASS_NAME="MyWay.Services.Preferences.PreferencesManager",o.logger=c.Loggers.LoggerFactory.INSTANCE.getClass(o.CLASS_NAME),o}(c.Components.ComponentManagerBase);e.PreferencesManager=r,c.Components.RegistryManager.getInstance().register(r)})((c=e.Services||(e.Services={})).Preferences||(c.Preferences={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-preferences-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){var c,u,r;c=e.Services||(e.Services={}),u=c.Libelle||(c.Libelle={}),r=function(o){function l(){var e=o.call(this,c.Components.ComponentType.Libelle)||this;return e.api=null,e}return __extends(l,o),l.prototype.init=function(e,r,n,t){return this.api=t,o.prototype.init.call(this,e,r,n,t)},l.prototype.constituerLibelle=function(e,r){if(null==e||0===e.trim().length)throw new c.ErreurClient(u.LibelleModel.TEC.CHAINE_VIDE,["codeLibelle",e]);var n,t=this.api.messages,o=e.split(".");if(t instanceof Object){var a=t[o[0]];a?"string"==typeof o[1]?(n=a[o[1]])||(l.logger.warn("Code message manquant : %1",e),n=this.codeValeurs(e,r)):(l.logger.warn("Code incorrect : %1",e),n=e):(l.logger.warn("Code incorrect, domaine fonctionnel manquant : %1",o[0]),n=e)}else l.logger.warn("Fichier Libelles manquants."),n=e;if(r instanceof Array)for(var i=0;i<r.length;++i){var s="{"+i+"}";n.indexOf(s)<0?l.logger.warn("PlaceHolder %1 manquant pour le code libelle %2",s,e):n=n.replace(s,r[i])}return n=n.replace(/{[0-9]*}/g,""),this.library.Core.createPromiseSelfResolved(n)},l.prototype.codeValeurs=function(e,r){var n=e;return r instanceof Array&&r.forEach(function(e){n=n+" "+e}),n},l.prototype.afficherMessage=function(e,o,r,a,i,s){var l=this;this.constituerLibelle(e,r).then(function(e){var r=e;if(o===u.TYPE_AFFICHAGE.INFORMATION){var n={Type:"Info",Message:r};l.library.Display.DisplayMessage(n)}else{var t={oui:!1,non:!1,valider:!1,ok:!1,annuler:!1};switch(o){case u.TYPE_AFFICHAGE.ERREUR:case u.TYPE_AFFICHAGE.AVERTISSEMENT:t.ok=!0;break;case u.TYPE_AFFICHAGE.OUI_NON:t.oui=!0,t.non=!0;break;case u.TYPE_AFFICHAGE.OUI_NON_ANNULER:t.oui=!0,t.non=!0,t.annuler=!0;break;case u.TYPE_AFFICHAGE.VALIDER_ANNULER:t.valider=!0,t.annuler=!0;break;case u.TYPE_AFFICHAGE.ANNULER:t.annuler=!0;break;case u.TYPE_AFFICHAGE.VIDE:}l.library.Display.FermerModalMessage(),setTimeout(function(){l.library.Display.AfficherModalMessage("MESSAGE",r,t,a,i,s)},500)}})},l.prototype.afficherMessageAsync=function(r,n,t,o){var a=this;return this.library.Core.promesseTryCatch(function(e){a.afficherMessage(r,n,t,o,e.resolve,function(){var e=new c.NotificationMessage;e.Sujet="modaleOuverte",a.Notify(e,function(){})})})},l.prototype.Notify=function(e,r){this.library.Context.Notify(e).then(r)},l.CLASS_NAME="MyWay.Services.Libelle.LibelleManager",l.logger=c.Loggers.LoggerFactory.INSTANCE.getClass(l.CLASS_NAME),l}(c.Components.ComponentManagerBase),u.LibelleManager=r,c.Components.RegistryManager.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-libelle-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();!function(t){var o,e,n;o=t.Services||(t.Services={}),e=o.ConfigurationPoste||(o.ConfigurationPoste={}),n=function(i){function e(){var t=i.call(this,o.Components.ComponentType.ConfigurationPoste)||this;return t.api=null,t.localStorageKey="configurationPoste",t.storage=null,t}return __extends(e,i),e.prototype.init=function(t,e,o,n){var r=this;return this.api=n,i.prototype.init.call(this,t,e,o,n).then(function(){r.storage=r.library.Persistence.addStorage(r.localStorageKey,r.listenerOnConfigurationPosteLocalStorage),r.getConfigurationPoste({refreshLocalStorage:!0}).catch(function(t){})})},e.prototype.getConfigPosteInLocalStorage=function(){var t=this.storage.getValue();return t&&t.configuration&&t.dateConfig?t:null},e.prototype.listenerOnConfigurationPosteLocalStorage=function(t){e.logger.warn("configurationPoste - %1",JSON.stringify(t))},e.prototype.getConfigurationPoste=function(t){var o=this,n=void 0!==t?t:{poste:null,etablissement:null,refreshLocalStorage:null};return this._cacheConfigurationPosteIsExpired()?this.library.Core.createPromiseSelfResolved(this._getCacheConfigurationPoste()):this.library.Context.getAuthentificationInfo().then(function(t){if(!n.etablissement&&!n.poste||t.numeroStationTravail===n.poste&&t.codeEtablissement===n.etablissement){var e=o.getConfigPosteInLocalStorage();return n.refreshLocalStorage||!e?o.api.getConfigurationPoste({etablissement:t.codeEtablissement,poste:t.numeroStationTravail,dateConfig:e?e.dateConfig:null}).then(function(t){return t&&o.storage.saveValue(t),o._setCacheConfigurationToContext(JSON.stringify(t)),t||e}):e}return o.api.getConfigurationPoste({etablissement:n.etablissement,poste:n.poste,dateConfig:null})})},e.prototype._cacheConfigurationPosteIsExpired=function(){var t=new Date,e=this.library.Context.GetFromContext("_cache_configuration_poste_last_date");return 864e5<new Date(e).getTime()-t.getTime()},e.prototype._getCacheConfigurationPoste=function(){return JSON.parse(this.library.Context.GetFromContext("_cache_configuration_poste"))},e.prototype._setCacheConfigurationToContext=function(t){this.library.Context.AddToContext(o.Context.StorageLevel.Global,"_cache_configuration_poste",t);var e=new Date;this.library.Context.AddToContext(o.Context.StorageLevel.Global,"_cache_configuration_poste_last_date",e.getTime().toString())},e.CLASS_NAME="MyWay.Services.ConfigurationPoste.ConfigurationPosteManager",e.logger=o.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(o.Components.ComponentManagerBase),e.ConfigurationPosteManager=n,o.Components.RegistryManager.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-configuration-poste-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])};return function(e,t){function s(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}}();!function(e){var G,T,t;G=e.Services||(e.Services={}),T=G.Context||(G.Context={}),t=function(j){function f(){return j.call(this,G.Components.ComponentType.Context)||this}return __extends(f,j),f.prototype.getAuthentificationInfo=function(){return this.managerInstance.getAuthentificationInfo()},f.prototype.reception=function(e){var t=this;switch(e.subject){case T.ContextMessageSubject.AddToContext:var s=(c=e.message).key,n=c.value,a=T.StorageLevel.Process;return f.logger.debug("Ajout au contexte %1 de la clé %2",a,s),this.managerInstance.AddToContextAsync(a,s,n);case T.ContextMessageSubject.AddToContextTech:var r=(c=e.message).kvp,o=(a=c.level,c.elementId);return f.logger.debug("Ajout au contexte %1 des clés valeurs %2",a,JSON.pruned(r)),this.managerInstance.AddListToContextAsync(a,r,o);case T.ContextMessageSubject.ClearContext:var c=e.message;return f.logger.debug("Efface le contexte"),this.managerInstance.ClearContext(),(b=G.CoreCommon.ServiceDePromesse.defer()).resolve(),b.promise;case T.ContextMessageSubject.AddToSharedContext:var g=(c=e.message).key;return n=c.value,a=T.StorageLevel.Shared,f.logger.debug("Ajout au contexte %1 de la clé %2",a,g),this.managerInstance.AddToContextAsync(a,g,n);case T.ContextMessageSubject.RemoveFromSharedContext:var i=(c=e.message).key;return a=T.StorageLevel.Shared,f.logger.debug("Ajout au contexte "+a+" de la clé "+i),this.managerInstance.RemoveFromContextAsync(a,i);case T.ContextMessageSubject.AddToProcessStepContext:var m=(c=e.message).key,u=(n=c.value,c.processStepId);return a=T.StorageLevel.Step,f.logger.debug("Ajout au contexte %1 de la clé %2",a,m),this.managerInstance.AddListToContextAsync(a,[{Key:m,Value:n}],u);case T.ContextMessageSubject.AddToGlobalContext:return r=(c=e.message).kvp,a=T.StorageLevel.Global,f.logger.debug("Ajout au contexte %1 de %2",a,JSON.stringify(r)),this.managerInstance.AddListToContextAsync(a,r);case T.ContextMessageSubject.AddToTempoContext:return r=(c=e.message).kvp,a=T.StorageLevel.Tempo,f.logger.debug("Ajout au contexte %1 de %2",a,JSON.stringify(r)),this.managerInstance.AddListToContextAsync(a,r);case T.ContextMessageSubject.AddListToContext:return r=(c=e.message).kvp,a=T.StorageLevel.Process,f.logger.debug("Ajout au contexte %1 de %2",a,JSON.stringify(r)),this.managerInstance.AddListToContextAsync(a,r);case T.ContextMessageSubject.AddToMainProcessContext:var C=(c=e.message).key;return n=c.value,a=T.StorageLevel.MainProcess,f.logger.debug("Ajout au contexte %1 de la clé %2",a,C),this.managerInstance.AddToContextAsync(a,C,n).then(function(e){return t.managerInstance.SendPortalContext(!0,"AddToMainProcessContext"),e});case T.ContextMessageSubject.GetFromMainProcessContext:var l=(c=e.message).key;return this.managerInstance.GetFromContextAsync(l);case T.ContextMessageSubject.ChangeMainProcessName:var S=(c=e.message).name;return this.managerInstance.ChangeMainProcessNameAsync(S).then(function(e){t.managerInstance.SendEvent(new G.Component.ManagerEvent(G.Component.ManagerEventType.ChangementNomProcess,{portalContext:e,info:S}))});case T.ContextMessageSubject.GetFromContext:return l=(c=e.message).key,this.managerInstance.GetFromContextAsync(l);case T.ContextMessageSubject.GetFromSharedContext:return l=(c=e.message).key,this.managerInstance.GetFromSharedContextAsync(l);case T.ContextMessageSubject.GetCurrentStepInfo:return c=e.message,this.managerInstance.GetCurrentStepInfoAsync().then(function(e){return t.managerInstance.setIsMyWayUrl(!0),e});case T.ContextMessageSubject.GetSharedStorage:c=e.message;var d=this.managerInstance._context.sharedStorage;return(b=G.CoreCommon.ServiceDePromesse.defer()).resolve(d),b.promise;case T.ContextMessageSubject.GetPortals:c=e.message;var x=this.managerInstance.getPortails();return(b=G.CoreCommon.ServiceDePromesse.defer()).resolve(x),b.promise;case T.ContextMessageSubject.GetGlobalStorage:c=e.message;var p=this.managerInstance._context.globalStorage;return(b=G.CoreCommon.ServiceDePromesse.defer()).resolve(p),b.promise;case T.ContextMessageSubject.SetMyWayCompatible:return c=e.message,this.managerInstance.setIsMyWayUrl(!0),(b=G.CoreCommon.ServiceDePromesse.defer()).resolve({versionComposant:G.CoreCommon.VersionMySys}),b.promise;case T.ContextMessageSubject.GetListFromContext:var y=(c=e.message).keyArray;return this.managerInstance.GetListFromContextAsync(y);case T.ContextMessageSubject.GetAuthentificationInfo:return c=e.message,this.managerInstance.GetAuthentificationInfoAsync();case T.ContextMessageSubject.GetParametresComptables:return c=e.message,this.managerInstance.GetParametresComptablesAsync();case T.ContextMessageSubject.GetWaitingProcesses:return c=e.message,this.managerInstance.GetWaitingProcessesAsync();case T.ContextMessageSubject.PutProcessInPortalContext:var v=(c=e.message).processId;return this.managerInstance.PutProcessInPortalContext(v),this.managerInstance.SendPortalContext(!1,"PutProcessInPortalContext"),(b=G.CoreCommon.ServiceDePromesse.defer()).resolve(),b.promise;case T.ContextMessageSubject.PutTaskInPortalContext:var M=(c=e.message).taskId;return this.managerInstance.PutTaskInPortalContext(M).then(function(e){t.managerInstance.SendPortalContext(!1,"PutTaskInPortalContext")});case T.ContextMessageSubject.GetCurrentProcessId:return c=e.message,this.managerInstance.GetCurrentProcessIdAsync();case T.ContextMessageSubject.GetCurrentMainProcess:return c=e.message,this.managerInstance.GetCurrentMainProcessAsync();case T.ContextMessageSubject.GetCurrentStepId:return c=e.message,this.managerInstance.GetCurrentStepIdAsync();case T.ContextMessageSubject.GetObjectFromContext:return c=e.message,(b=G.CoreCommon.ServiceDePromesse.defer()).resolve(this.managerInstance.GetObjectFromContext(c.keyArray)),b.promise;case T.ContextMessageSubject.GetTypedObjectFromContext:return c=e.message,(b=G.CoreCommon.ServiceDePromesse.defer()).resolve(this.managerInstance.GetTypedObjectFromContext(c.template)),b.promise;case T.ContextMessageSubject.GetPortalContext:var h=(c=e.message).getSingleIfSingle;return(b=G.CoreCommon.ServiceDePromesse.defer()).resolve(this.managerInstance.GetPortalContext(h)),b.promise;case T.ContextMessageSubject.SwitchProcess:var I=(c=e.message).processId,b=G.CoreCommon.ServiceDePromesse.defer(),A=this.managerInstance.SwitchToProcess(I);return this.managerInstance.DisplayProcesses(),A&&this.managerInstance.SendEvent(new G.Component.ManagerEvent(G.Component.ManagerEventType.BasculeProcess,{portalContext:this.managerInstance.GetPortalContext()})),b.resolve(!1),b.promise;case T.ContextMessageSubject.EndProcess:var P=(c=e.message).processId;return this.managerInstance._portail_terminerProcess(P);case T.ContextMessageSubject.EndAllProcess:return c=e.message,this.managerInstance._portail_terminerAllProcess();default:return j.prototype.reception.call(this,e)}},f.CLASS_NAME="MyWay.Services.Context.ContextManagerMessage",f.logger=G.Loggers.LoggerFactory.INSTANCE.getClass(f.CLASS_NAME),f}(G.Components.ComponentManagerMessageBase),T.ContextManagerMessage=t,G.Components.RegistryManagerMessage.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t,c,s;t=e.Services||(e.Services={}),c=t.Display||(t.Display={}),s=function(o){function e(){return o.call(this,t.Components.ComponentType.Display)||this}return __extends(e,o),e.prototype.reception=function(t){var s=this;switch(t.subject){case c.DisplayMessageSubject.Redirect:var e=(r=t.message).url,n=r.previousUrl;return this.managerInstance.Redirect(e,n);case c.DisplayMessageSubject.RedirectInStep:return e=(r=t.message).url,this.managerInstance.RedirectInStep(e),this.library.Core.getPromesseSelfResoved();case c.DisplayMessageSubject.PrepareSubmit:return e=(r=t.message).url,this.managerInstance.PrepareSubmit(e),this.library.Core.getPromesseSelfResoved();case c.DisplayMessageSubject.DisplayMessage:var a=(r=t.message).message;return this.managerInstance.DisplayMessage(a),this.library.Core.getPromesseSelfResoved();case c.DisplayMessageSubject.GetMyIFrameId:var r=t.message;return this.library.Core.promesseTryCatch(function(e){e.resolve(s.managerInstance.getMyIFrameId(t.iframe))});default:return o.prototype.reception.call(this,t)}},e.CLASS_NAME="MyWay.Services.Display.DisplayManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),c.DisplayManagerMessage=s,t.Components.RegistryManagerMessage.getInstance().register(s)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-context-display-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var l,S,t;l=e.Services||(e.Services={}),S=l.Acquisition||(l.Acquisition={}),t=function(o){function f(){var e=o.call(this,l.Components.ComponentType.Acquisition)||this;return e.api=null,e.stateTasks={},e}return __extends(f,o),f.prototype.init=function(e,t,r,n){return this.api=n,o.prototype.init.call(this,e,t,r,n)},f.prototype.appelRADLAD=function(e,r){var n=this;return this.api.recuperationImageKofax(e).then(function(e){var t={save:r.save||!1,binarizeMethod:r.binarizeMethod||S.BINARIZE_METHOD.SIMPLE_THRESHOLD};return n.api.creerImagesBitonales(e,t).then(function(t){return n.library.Context.getAuthentificationInfo().then(function(e){return n.api.traitementRADLAD(JSON.parse(t),r,e).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("traitementRADLAD Success"),e},function(e){throw f.logger.error("traitementRADLAD failed - %1",JSON.stringify(e)),e})})},function(e){throw f.logger.error("creerImagesBitonales failed - %1",JSON.stringify(e)),e})},function(e){throw f.logger.error("recuperationImageKofax failed - %1",JSON.stringify(e)),e})},f.prototype.convertFileToImg=function(t,e,r){return void 0===r&&(r=!0),this.api.convertFileToImg(t,e,r).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("convertFileToImg Success"),JSON.parse(e)},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",t),f.logger.error("convertFileToImg failed - %1",JSON.stringify(e)),e})},f.prototype.mergerEtArchiver=function(r,n){var o=this;return this.api.mergerPdfs(r).then(function(e){var t=JSON.parse(e);return n.docElect=t.base64,o.library.Context.getAuthentificationInfo().then(function(e){return o.api.archiver(n,e).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("archiver Success"),e},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",r),f.logger.error("archiver failed - %1",JSON.stringify(e)),e})})},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",r),f.logger.error("merge Pdf failed - %1",JSON.stringify(e)),e})},f.prototype.mergerEtUploader=function(e){return this.api.mergerPdfs(e).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("mergerPdfs Success"),JSON.parse(e).base64},function(e){throw f.logger.error("mergerPdfs failed - %1",JSON.stringify(e)),e})},f.prototype.convertBase64ToBin=function(e){return this.api.convertBase64ToBin(e).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("convertBase64ToBin Success"),e},function(e){throw f.logger.error("convertBase64ToBin failed - %1",JSON.stringify(e)),e})},f.prototype.purge=function(e){return this.api.purge(e).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("purge Success"),e},function(e){throw f.logger.error("purge failed - %1",JSON.stringify(e)),e})},f.prototype.fermetureSpiFactory=function(){return this.api.fermetureSpiFactory().then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("fermeture Spifactory Success"),e},function(e){throw f.logger.error("Spifactory failed - %1",JSON.stringify(e)),e})},f.prototype.setConfigurationScanner=function(e){return this.api.setConfigurationScanner(e).then(function(){return f.logger.debug("setConfigurationScanner Success"),!0},function(e){return f.logger.error("setConfigurationScanner failed - %1",JSON.stringify(e)),!1})},f.prototype.onMergeAndOpenPDF=function(n,e){var o=this,i=l.CoreCommon.ServiceDePromesse.defer(),s=this.generateGuid();this.stateTasks[s]={guid:s,state:S.Messages.START_STATE,frames:[]};var a,u,c=n.documents instanceof Array?n.documents.length:1,g=0;if(e){var t=this.library.Display.getMyIFrameId(e),r=this.library.Display.GetFrameModelById(t);this.stateTasks[s].frames.push(r)}return u=n.documents instanceof Array?n.documents:[n.documents],this.library.Context.getAuthentificationInfo().then(function(t){var r=[];return u.forEach(function(e){r.push(o.api.retrieveGedDocument(n.applicationCode,e,t).then(function(e){return g++,o.changeState(s,g/(c+1)*100),e}))}),l.Promesses.all(r).then(function(t){var n=[];return t.forEach(function(e){n.push({base64:e.fichier.contenu,type:S.ACQUISITION_TYPE.BASE64}),a=1===t.length?e.fichier.nom:"merge.pdf"}),o.api.mergerPdfs(n).then(function(e){var t=JSON.parse(e);l.Loggers.FLASH.INSTANCE.setValue("details",t.base64),f.logger.debug("mergerPdfs Success"),g++,o.changeState(s,g/(c+1)*100);var r={path:s,name:a,base64:t.base64};return o.api.saveDocument(r).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("SaveDocument Success"),o.api.openDocument(r).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("openDocument Success"),o.changeState(s,S.Messages.END_STATE),JSON.parse(e)},function(e){l.Loggers.FLASH.INSTANCE.setValue("details",n),f.logger.error("openDocument failed - %1",JSON.stringify(e)),o.changeState(s,S.Messages.ERROR,e.codeLibelle),i.reject(e)})},function(e){l.Loggers.FLASH.INSTANCE.setValue("details",n),f.logger.error("SaveDocument failed - %1",JSON.stringify(e)),o.changeState(s,S.Messages.ERROR,e.codeLibelle),i.reject(e)})},function(e){l.Loggers.FLASH.INSTANCE.setValue("details",n),f.logger.error("mergerPdfs failed - %1",JSON.stringify(e)),o.changeState(s,S.Messages.ERROR,e.codeLibelle),i.reject(e)})},function(e){l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("retrieveGedDocument failed - %1",JSON.stringify(e)),o.changeState(s,S.Messages.ERROR,e.codeLibelle),i.reject(e)})},function(e){l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("getAuthentificationInfo failed - %1",JSON.stringify(e)),o.changeState(s,S.Messages.ERROR,e.codeLibelle),i.reject(e)}),i.resolve(s),i.promise},f.prototype.onRecupereListeDocumentGED=function(n,o){var e,i=this;return e=n.documents instanceof Array?n.documents:[n.documents],this.library.Context.getAuthentificationInfo().then(function(t){var r=[];return e.forEach(function(e){r.push(i.api.retrieveGedDocument(n.applicationCode,e,t).then(function(e){return f.logger.debug("onRecupereListeDocumentGED : le document a été retrouvé en GED"),e}))}),l.Promesses.all(r).then(function(e){var t=[];return e.forEach(function(e){t.push({base64:e.fichier.contenu,type:S.ACQUISITION_TYPE.BASE64,nomDocumentEnGed:e.fichier.nom})}),i.api.mergerDocuments(t,o).then(function(e){return f.logger.debug("mergerDocuments Success"),e.replace(/@@/gi,"\\")},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",t),f.logger.error("mergerPdfs failed - %1",JSON.stringify(e)),e})},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("retrieveGedDocument failed - %1",JSON.stringify(e)),e})},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("getAuthentificationInfo failed - %1",JSON.stringify(e)),e})},f.prototype.onOuvrirListeDocumentGED=function(n,o,i){var e,s=this;return e=n.documents instanceof Array?n.documents:[n.documents],this.library.Context.getAuthentificationInfo().then(function(t){var r=[];return e.forEach(function(e){r.push(s.api.retrieveGedDocument(n.applicationCode,e,t).then(function(e){return f.logger.debug("onOuvrirListeDocumentGED : le document a été retrouvé en GED"),e}))}),l.Promesses.all(r).then(function(e){var t=[];return e.forEach(function(e){t.push({base64:e.fichier.contenu,type:S.ACQUISITION_TYPE.BASE64,nomDocumentEnGed:e.fichier.nom})}),s.api.manipulerArchives(t,o,i).then(function(){return f.logger.debug("manipulerArchives Success"),!0},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",t),f.logger.error("manipulerArchives failed - %1",JSON.stringify(e)),e})},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("retrieveGedDocument failed - %1",JSON.stringify(e)),e})},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("getAuthentificationInfo failed - %1",JSON.stringify(e)),e})},f.prototype.changeState=function(t,r,n){var o=this;this.stateTasks[t].state=r,this.stateTasks[t].detail=n,0<this.stateTasks[t].frames.length?this.stateTasks[t].frames.forEach(function(e){o.sendMessageWithFrame(S.Messages.AcquisitionMessageSubject.ChangeState,{guid:t,state:r,detail:n},e)}):this.sendMessage(S.Messages.AcquisitionMessageSubject.ChangeState,{guid:t,state:r,detail:n})},f.prototype.onGetProcessingTask=function(e){var t=l.CoreCommon.ServiceDePromesse.defer();return t.resolve(this.stateTasks[e]),t.promise},f.prototype.onGetDocumentGEDAndSave=function(r){var n=this;return l.CoreCommon.ServiceDePromesse.defer(),this.library.Context.getAuthentificationInfo().then(function(e){var t;if(r.documents instanceof Array)throw new Error("Tableau de document impossibles, uniquement un seul document peut être traité");return t=r.documents,n.api.retrieveGedDocument(r.applicationCode,t,e).then(function(e){var t={path:n.generateGuid(),name:e.fichier.nom,base64:e.fichier.contenu};return n.api.saveDocument(t).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("SaveDocument Success"),JSON.parse(e)},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("SaveDocument failed - %1",JSON.stringify(e)),e})})})},f.prototype.onGetDocumentGedSaveAtAndOpen=function(r){var n=this;return this.library.Context.getAuthentificationInfo().then(function(e){var t={id:null,nature:null};return t.id=r.id,t.nature=r.nature,n.api.retrieveGedDocument(r.applicationCode,t,e).then(function(e){var t={path:r.cheminSauvegardeSurLePoste,name:e.fichier.nom,base64:e.fichier.contenu};return n.api.saveDocumentGedAtAndOpen(t).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("onGetDocumentGedSaveAtAndOpen - saveDocumentGedAtAndOpen Success"),e},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("onGetDocumentGedSaveAtAndOpen - saveDocumentGedAtAndOpen failed - %1",JSON.stringify(e)),e})},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("onGetDocumentGedSaveAtAndOpen - retrieveGedDocument failed - %1",JSON.stringify(e)),e})},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("onGetDocumentGedSaveAtAndOpen - GetAuthentificationInfo failed - %1",JSON.stringify(e)),e})},f.prototype.onUploadDocumentFrom=function(e){return this.api.uploadDocumentFrom(e).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("onUploadDocumentFrom - uploadDocumentFrom : Success"),e},function(e){throw f.logger.error("onUploadDocumentFrom - uploadDocumentFrom : failed - %1",JSON.stringify(e)),e})},f.prototype.onGetDocumentGEDAndOpen=function(r){var n=this;return l.CoreCommon.ServiceDePromesse.defer(),this.library.Context.getAuthentificationInfo().then(function(e){var t={id:null,nature:null};return t.id=r.id,t.nature=r.nature,n.api.retrieveGedDocument(r.applicationCode,t,e).then(function(e){var t={path:n.generateGuid(),name:e.fichier.nom,base64:e.fichier.contenu};return n.api.saveDocument(t).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("SaveDocument Success"),n.api.openDocument(t).then(function(e){return l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.debug("openDocument Success"),JSON.parse(e)},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("openDocument failed - %1",JSON.stringify(e)),e})},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("SaveDocument failed - %1",JSON.stringify(e)),e})}).catch(function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("retrieveGedDocument failed - %1",JSON.stringify(e)),e})}).catch(function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("getAuthentificationInfo failed - %1",JSON.stringify(e)),e})},f.prototype.onGetListeScanner=function(e){return this.api.getListeScanner(e).then(function(e){return f.logger.debug("onGetListeScanner Success"),JSON.parse(e)},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("onGetListeScanner failed - %1",JSON.stringify(e)),e})},f.prototype.onIsPrisEnMainADistance=function(){return this.api.isPrisEnMainADistance().then(function(e){return f.logger.debug("onIsPrisEnMainADistance Success"),JSON.parse(e)},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("onIsPrisEnMainADistance failed - %1",JSON.stringify(e)),e})},f.prototype.S4=function(){return(65536*(1+Math.random())|0).toString(16).substring(1)},f.prototype.generateGuid=function(){return(this.S4()+this.S4()+"-"+this.S4()+"-4"+this.S4().substr(0,3)+"-"+this.S4()+"-"+this.S4()+this.S4()+this.S4()).toLowerCase()},f.prototype.isDocumentSigne=function(e){return this.api.isDocumentSigne(e).then(function(e){return f.logger.debug("isDocumentSigne Success"),e},function(e){throw l.Loggers.FLASH.INSTANCE.setValue("details",e),f.logger.error("isDocumentSigne failed - %1",JSON.stringify(e)),e})},f.CLASS_NAME="MyWay.Services.Acquisition.AcquisitionManager",f.logger=l.Loggers.LoggerFactory.INSTANCE.getClass(f.CLASS_NAME),f}(l.Components.ComponentManagerBase),S.AcquisitionManager=t,l.Components.RegistryManager.getInstance().register(t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-acquisition-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var n;(n=e.Services||(e.Services={})).ServiceManagerExtended.setListenerOnInitContext(function(e){for(var t in n.PrivatePortalServiceParameters.Instance().LisaPlaceholders)e.Context.AddToContext("global",t,n.PrivatePortalServiceParameters.Instance().LisaPlaceholders[t]);return e.Context.AddToContext("global","URL_SERVICE_LOCAL",n.PrivatePortalServiceParameters.Instance().LocalServiceUrl),e.Core.createPromiseSelfResolved(e.Context.GetPortalContext())})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var o,a,t;o=e.Services||(e.Services={}),a=o.Context||(o.Context={}),t=function(e){function r(){return e.call(this,o.Components.ComponentType.Context)||this}return __extends(r,e),r.prototype.AddToContext=function(e,t,n){var r;switch(e){case"global":r=a.StorageLevel.Global;break;case"tempo":r=a.StorageLevel.Tempo;break;default:r=a.StorageLevel.Process}return this.manager.AddToContext(r,t,n)},r.prototype.GetDonneesLocales=function(){return this.manager.GetDonneesLocales()},r.prototype.GetAuthentificationInfo=function(e){return void 0===e&&(e=!1),this.manager.GetAuthentificationInfo(e)},r.prototype.GetFromContext=function(e){return this.manager.GetFromContext(e)},r.prototype.DedierPortail=function(e){return this.manager.SetSingleProcess(e)?(this.manager.DisplayProcesses(),this.manager.GetCurrentStep(this.manager.GetCurrentProcess())):null},r.prototype.TerminerProcess=function(e){return this.manager._portail_terminerProcess(e)},r.prototype.BasculerProcess=function(e){r.logger.debug("BasculerProcess");var t=o.CoreCommon.ServiceDePromesse.defer(),n=this.manager.SwitchToProcess(e);return this.manager.DisplayProcesses(),n&&this.manager.SendEvent(new o.Component.ManagerEvent(o.Component.ManagerEventType.BasculeProcess,{portalContext:this.manager.GetPortalContext()})),t.resolve(!1),t.promise},r.prototype.ChangerNomProcessPrincipal=function(e){return this.manager.ChangeMainProcessName(e)},r.prototype.RemoveWaitingProcesses=function(){return this.manager.RemoveWaitingProcesses()},r.prototype.AnalyseApp=function(){var t=o.CoreCommon.ServiceDePromesse.defer();return this.manager.AnalyseApp(function(e){t.resolve(e)}),t.promise},r.prototype.GetPortalContext=function(e){return void 0===e&&(e=!0),this.manager.GetPortalContext(e)},r.prototype.ExtraireProcess=function(e){return this.manager._portail_extraireProcess(e)},r.CLASS_NAME="MyWay.Services.Context.ContextManagerExtended",r.logger=o.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME),r}(o.Components.ComponentManagerExtendedBase),a.ContextManagerExtended=t,o.Components.RegistryManagerExtended.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var n,t,r;n=e.Services||(e.Services={}),t=n.Display||(n.Display={}),r=function(e){function t(){return e.call(this,n.Components.ComponentType.Display)||this}return __extends(t,e),Object.defineProperty(t.prototype,"onNotificationDeMessage",{set:function(e){this.manager.onNotificationDeMessage=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onFermerModalMessage",{set:function(e){this.manager.onFermerModalMessage=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onAffichageModalMessage",{set:function(e){this.manager.onAffichageModalMessage=e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"onAffichageModalAide",{set:function(e){this.manager.onAffichageModalAide=e},enumerable:!0,configurable:!0}),t.prototype.AfficherUrl=function(e,t){return this.manager.AfficherUrl(e,t,!1)},t.prototype.OuvrirUrl=function(e){return this.manager.OuvrirUrl(e)},Object.defineProperty(t.prototype,"onChangementDeFrame",{set:function(e){this.manager.onShowFrame=e},enumerable:!0,configurable:!0}),t}(n.Components.ComponentManagerExtendedBase),t.DisplayManagerExtended=r,n.Components.RegistryManagerExtended.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-context-display-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(c){var a,l,e;a=c.Services||(c.Services={}),l=a.Communication||(a.Communication={}),e=function(o){function i(){var e=o.call(this,a.Components.ComponentType.Communication)||this;return e.api=null,e}return __extends(i,o),i.prototype.init=function(e,r,n,t){return this.api=t,o.prototype.init.call(this,e,r,n,t)},i.prototype.envoyerMail=function(e){var r;if(""!==(r=l.controleEnvoyerMail(e))){var n=new a.Erreur(c.Services.Libelle.LibelleModel.COM.ERREUR_COMMUNICATION_FORMAT_MAIL_INCORRECT,[r]);return i.logger.error("envoyerMail Failed - %1",JSON.stringify(n)),this.library.Core.createPromiseSelfError(n)}var t="mailto:{0}?{1}{2}{3}{4}";return(t=(t=(t=(t=(t=(t=t.replace("{0}",e.to)).replace("{1}",a.Controle.StaticStringControle.isString(e.subject)?"subject="+e.subject+"&":"")).replace("{2}",a.Controle.StaticStringControle.isString(e.body)?"body="+e.body.replace(/\n/g,"%0D%0A")+"&":"")).replace("{3}",a.Controle.StaticStringControle.isString(e.cc)?"cc="+e.cc+"&":"")).replace("{4}",a.Controle.StaticStringControle.isString(e.bcc)?"bcc="+e.bcc:"")).replace("?&","?")).lastIndexOf("&")!=t.length-1&&t.lastIndexOf("?")!=t.length-1||(t=t.substring(0,t.length-1)),i.logger.debug("envoyerMail Success - %1",t),this.library.Core.createPromiseSelfResolved(t)},i.prototype.declencherAppel=function(r){var e,n=this;if(""===(e=l.controleDeclencherAppel(r)))return this.library.Context.getAuthentificationInfo().then(function(e){if(null!==e)return n.api.declencherAppel(r,e).then(function(e){return i.logger.debug("API NumerotationTelephonique.declencherAppel Success"),e},function(e){throw i.logger.error("API NumerotationTelephonique.declencherAppel Failed - %1",JSON.stringify(e)),e});throw i.logger.error("Données d'appel manquantes"),new a.Erreur(c.Services.Libelle.LibelleModel.COM.ERREUR_COMMUNICATION_DONNEES_APPEL_MANQUANTE)});var t=new a.Erreur(c.Services.Libelle.LibelleModel.COM.ERREUR_COMMUNICATION_FORMAT_NUMERO_INCORRECT,[e]);return i.logger.error("envoyerMail Failed - %1",JSON.stringify(t)),this.library.Core.createPromiseSelfError(t)},i.prototype.raccrocherAppel=function(){var r=this;return this.library.Context.getAuthentificationInfo().then(function(e){return r.api.raccrocherAppel(e).then(function(e){return i.logger.debug("API NumerotationTelephonique.raccrocherAppel Success"),e},function(e){throw i.logger.error("API NumerotationTelephonique.raccrocherAppel Failed - %1",JSON.stringify(e)),e})})},i.prototype.envoyerMessageAppliKiosque=function(e){return this.api.envoyerMessageAppliKiosque(e).then(function(e){return i.logger.debug("API NumerotationTelephonique.raccrocherAppel Success"),e},function(e){throw i.logger.error("API NumerotationTelephonique.raccrocherAppel Failed - %1",JSON.stringify(e)),e})},i.CLASS_NAME="MyWay.Services.Communication.CommunicationManager",i.logger=a.Loggers.LoggerFactory.INSTANCE.getClass(i.CLASS_NAME),i}(a.Components.ComponentManagerBase),l.CommunicationManager=e,a.Components.RegistryManager.getInstance().register(e)}(MyWay||(MyWay={})),function(e){var n;(n=e.Services||(e.Services={})).PhantomAgent.addListenerOnInit(function(e,r){e.Communication=new n.Communication.PhantomCommunicationAgent(r)})}(MyWay||(MyWay={})),function(e){var r,n,t;r=e.Services||(e.Services={}),n=r.Communication||(r.Communication={}),t=function(){function e(e){this.serviceManager=e}return e.prototype.envoyerMail=function(e){return this.serviceManager.Library.Communication.envoyerMail(e)},e.prototype.declencherAppel=function(e){return this.serviceManager.Library.Communication.declencherAppel(e)},e.prototype.raccrocherAppel=function(){return this.serviceManager.Library.Communication.raccrocherAppel()},e}(),n.PhantomCommunicationAgent=t}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-communication-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var u,l,t;u=e.Services||(e.Services={}),l=u.ContexteClient||(u.ContexteClient={}),t=function(s){function c(){var t=s.call(this,u.Components.ComponentType.ContexteClient)||this;return t.contextes=[],t.contextesById={},t.storage=null,t.api=null,t.listenerOnContexteChange=function(){var e=JSON.parse(localStorage.getItem("contextesClients"));t.load(e)},t.listenerOnProcessEnd=function(e){e.contexteClientId&&t.library.ContexteClient.changeContexteOfProcess(null,e.id,null)},t}return __extends(c,s),Object.defineProperty(c,"RELOAD_FLAG_NAME",{get:function(){return l.ContexteClientStatusFlag.RELOAD_FLAG_NAME},enumerable:!0,configurable:!0}),Object.defineProperty(c,"RELOAD_FLAG_VALUE_NONE",{get:function(){return l.ContexteClientStatusFlag.RELOAD_FLAG_VALUE_NONE},enumerable:!0,configurable:!0}),Object.defineProperty(c,"RELOAD_FLAG_VALUE_SYNCHRO",{get:function(){return l.ContexteClientStatusFlag.RELOAD_FLAG_VALUE_SYNCHRO},enumerable:!0,configurable:!0}),Object.defineProperty(c,"RELOAD_FLAG_VALUE_RELOAD",{get:function(){return l.ContexteClientStatusFlag.RELOAD_FLAG_VALUE_RELOAD},enumerable:!0,configurable:!0}),c.prototype.init=function(e,t,n,r){var o=this;return this.api=r,s.prototype.init.call(this,e,t,n,r).then(function(){o.storage=o.library.Persistence.addStorage("notification.contextesclient",o.listenerOnContexteChange),o.load(),o.library.Evennements.ajouterListener(function(e){o.notifierRechargementContexte()},u.Component.ManagerEventType.ContextRecharge),o.library.Context.addListenerOnTerminerProcessus(o.listenerOnProcessEnd)})},c.prototype.dispose=function(){return this.library.Context.removeListenerOnTerminerProcessus(this.listenerOnProcessEnd),s.prototype.dispose.call(this)},c.prototype.nouveauContexte=function(e){var t=this.getByIdClient(e);if(t)return c.loggerContexteClientManagerBase.debug("reutilisation contexte client : %1",t.getId()),t;for(var n=this.library.Core.creerChaineAleatoire(16);this.contextesById[n];)n=this.library.Core.creerChaineAleatoire(16);var r=new l.ContexteClientClass(n,this.library.Core,this);return e&&r.setClient(e),this.contextesById[n]=r,this.contextes.push(r),c.loggerContexteClientManagerBase.debug("creation nouveau contexte client : %1",r.getId()),this.save(),r},c.prototype.getByIdClient=function(t){var n=null;return t?(this.contextes.every(function(e){return e.getClient()===t&&(n=e),null===n}),n):null},c.prototype.getCurrentContexteClient=function(){var e=this.library.Context.GetCurrentProcess();if(!e)return null;var t=e.contexteClientId;return t?this.getContexte(t):null},c.prototype.setCurrentContexteClient=function(e){var t=this.library.Context.GetCurrentProcess();if(!t)throw new u.Erreur("Il n'y a pas de processus courant");this.library.Context.setContextClientIdOnProcessus(e.getId(),t)},c.prototype.getContexte=function(e){return this.contextesById[e]},c.prototype.getContextes=function(){return this.contextes},c.prototype.getContextesAsync=function(){var o,s=this,i=[];return this.api.getContexteClientPCM().then(function(e){if(null==e)return s.contextes;for(var t=0,n=e;t<n.length;t++){var r=n[t];null!=(o=s.getByIdClient(r))&&i.push(o)}return i})},c.prototype.detruireContexte=function(e,t){var n=this,r=this.getContexte(t);if(!r)throw new u.Erreur("Contexte client "+t+" inexistant");r.getMode()===l.Messages.ContexteClientMode.AUTOMATIQUE&&(this.changeContexteMode(t,l.Messages.ContexteClientMode.MANUEL),c.loggerContexteClientManagerBase.debug("Le contexte d'identifiant %1 cherche à être détruit, mais il est en mode automatique. Changement de son statut en manuel.",t));var o=[];r.getProcessus().forEach(function(e){o.push(e),e.contexteClientId=null,n.library.Context.setContextClientIdOnProcessus(null,e)}),delete this.contextesById[t];for(var s=this.contextes.length-1,i=!1,a=0;a<s+1;a++)this.contextes[a]===r&&(i=!0),i&&(this.contextes[a]=this.contextes[a+1]);return this.contextes.length--,this.save(),this.broadcastUpdateEventByProcess(null,e,o,l.Messages.MiseAJourContexteClientType.detructionContexte),!0},c.prototype.changeTousContexteMode=function(e){var t=[];this.getContextes().forEach(function(e){t.push(e.getId())}),this.changeContexteModes(t,l.Messages.ContexteClientMode.AUTOMATIQUE)},c.prototype.getClient=function(e){return this.getCurrentContexteOrByIdAndThrowIfNothing(e).getClient()},c.prototype.setClient=function(e,t,n){var r=this;if(!t)throw new u.Erreur("Impossible de supprimer l'id du client dans le contexte client courant.");var o=this.getCurrentContexteOrByIdAndThrowIfNothing(n);if(void 0!==o.getClient())throw new u.Erreur("Impossible de modifier le client courant du contexte client car il est déjà défini.");var s=void 0;if(this.getContextes().every(function(e){return e.getClient()===t&&(s=e),void 0===s}),void 0===s)return o.setClient(t),this.save(),this.broadcastUpdateEvent(null,e,o,l.Messages.MiseAJourContexteClientType.setClient),!0;var i=[],a=o.getMode();return o.getProcessus().forEach(function(e){i.push(e),o.retirerProcessus(e),s.ajouterProcessus(e),r.library.Context.setContextClientIdOnProcessus(s.getId(),e)}),a!==l.Messages.ContexteClientMode.AUTOMATIQUE&&this.detruireContexte(e,o.getId()),this.save(),this.broadcastUpdateEventByProcess(null,e,i,l.Messages.MiseAJourContexteClientType.changementContexte),!0},c.prototype.getContextesParClients=function(){var n=[];return this.getContextes().forEach(function(e){var t=e.getClient();t&&n.push(t)}),n},c.prototype.getContextesParClientsAsync=function(){var t=this;return this.api.getContexteClientPCM().then(function(e){return null==e?t.getContextesParClients():e})},c.prototype.addToList=function(t,n,e,r){var o=this,s=this.getCurrentContexteOrByIdAndThrowIfNothing(r);return s.addToList(n,e).then(function(e){return o.save(),o.broadcastUpdateEvent(n,t,s,l.Messages.MiseAJourContexteClientType.addToList),e})},c.prototype.getContenu=function(e){var t=u.CoreCommon.ServiceDePromesse.defer(),n=this.getByIdClient(e);return n?n.getProperty(null):(t.reject(new u.Erreur("Impossible de trouver une contexte client avec l'id client "+e)),t.promise)},c.prototype.getProperty=function(e,t){return this.getCurrentContexteOrByIdAndThrowIfNothing(t).getProperty(e)},c.prototype.setContenu=function(r,e,o){var s=this;return this.library.Core.promesseTryCatch(function(t){var n=s.getByIdClient(e);n?(o[c.RELOAD_FLAG_NAME]||(o[c.RELOAD_FLAG_NAME]=c.RELOAD_FLAG_VALUE_NONE),n.setProperty(null,o).then(function(e){s.save(),s.broadcastUpdateEvent(null,r,n,l.Messages.MiseAJourContexteClientType.setProperty),t.resolve(e)},t.reject)):t.reject(new u.Erreur("Impossible de trouver une contexte client avec l'id client "+e))})},c.prototype.setReloadSynthese=function(r,e){var o=this;return this.library.Core.promesseTryCatch(function(t){var n=o.getByIdClient(e);n?n.setProperty(l.ContexteClientStatusFlag.RELOAD_FLAG_NAME,l.ContexteClientStatusFlag.RELOAD_FLAG_VALUE_RELOAD).then(function(e){o.save(),o.broadcastUpdateEvent(null,r,n,l.Messages.MiseAJourContexteClientType.setProperty),t.resolve(e)},t.reject):t.reject(new u.Erreur("Impossible de trouver une contexte client avec l'id client "+e))})},c.prototype.setProperty=function(t,n,e,r){var o=this,s=this.getCurrentContexteOrByIdAndThrowIfNothing(r);return s.setProperty(n,e).then(function(e){return o.save(),o.broadcastUpdateEvent(n,t,s,l.Messages.MiseAJourContexteClientType.setProperty),e})},c.prototype.removeFromList=function(t,n,e){var r=this,o=this.getCurrentContexteOrByIdAndThrowIfNothing(e);return o.removeFromList(n).then(function(e){return r.save(),r.broadcastUpdateEvent(n,t,o,l.Messages.MiseAJourContexteClientType.removeFromList),e})},c.prototype.deleteProperty=function(t,n,e){var r=this,o=this.getCurrentContexteOrByIdAndThrowIfNothing(e);return o.deleteProperty(n).then(function(e){return r.save(),r.broadcastUpdateEvent(n,t,o,l.Messages.MiseAJourContexteClientType.deleteProperty),e})},c.prototype.notifierRechargementContexte=function(){var r=this,e=this.library.Context.GetAllProcessFromAllPortails(),o={},s=[];e.forEach(function(t){if((o[t.id]=t).contexteClientId){var e=r.getContexte(t.contexteClientId);if(e){var n=!1;e.getProcessus().every(function(e){return e.id!==t.id||!(n=!0)}),n||(s.push(t),e.ajouterProcessus(t))}}}),this.contextes.forEach(function(n){var r=[];n.getProcessus().forEach(function(e){var t=o[e.id];t?t.contexteClientId!==n.getId()&&(-1===s.indexOf(t)&&s.push(t),r.push(e)):n.retirerProcessus(e)}),r.forEach(function(e){n.retirerProcessus(e)})}),this.broadcastUpdateEventByProcess(null,"load",s,l.Messages.MiseAJourContexteClientType.changementContexte)},c.prototype.changeContexteOfProcess=function(e,t,n){var r=this.library.Context.GetProcessByIdFromAllPortails(t);if(!r)throw new u.Erreur("Le processus "+t+" n'a pas été trouvé");var o=null;if(r.contexteClientId&&(o=this.getContexte(r.contexteClientId)),!n)return this.library.Context.setContextClientIdOnProcessus(null,r),o&&o.retirerProcessus(r),this.save(),void this.broadcastUpdateEventByProcess(null,e,[r],l.Messages.MiseAJourContexteClientType.changementContexte);var s=this.getContexte(n);if(!s)throw new u.Erreur("Le contexte client d'identifiant technique "+n+" n'a pas été trouvé");o&&o.retirerProcessus(r),s.ajouterProcessus(r),this.library.Context.setContextClientIdOnProcessus(s.getId(),r),this.save(),this.broadcastUpdateEventByProcess(null,e,[r],l.Messages.MiseAJourContexteClientType.changementContexte)},c.prototype.getMode=function(e){return this.getCurrentContexteOrByIdAndThrowIfNothing(e).getMode()},c.prototype.changeContexteMode=function(e,t){return this.changeContexteModes([e],t)},c.prototype.changeContexteModes=function(e,n){var r=this;e.forEach(function(e){var t=r.getContexte(e);if(!t)throw new u.Erreur("Le contexte client d'identifiant technique "+e+" n'a pas été trouvé");t.setMode(n)}),this.save()},c.prototype.getListeProcessus=function(e){return this.getCurrentContexteOrByIdAndThrowIfNothing(e).getProcessus()},c.prototype.getDetailsContexte=function(e){var t=this.getContexte(e);if(!t)throw new u.Erreur("Le contexte client d'identifiant technique "+e+" n'a pas été trouvé");var n={idContexte:t.getId(),idClient:t.getClient(),mode:t.getMode(),processus:[],content:t.getCurrentDatas()};return t.getProcessus().forEach(function(e){n.processus.push(e.id)}),n},c.prototype.getCurrentContexteOrById=function(e){return e?this.contextesById[e]:this.getCurrentContexteClient()},c.prototype.getCurrentContexteOrByIdAndThrowIfNothing=function(e){var t=null;if(!(t=e?this.contextesById[e]:this.getCurrentContexteClient()))throw e?new u.Erreur("Le contexte client "+e+" n'existe pas!"):new u.Erreur("Il n'y a pas de contexte client courant.");return t},c.prototype.save=function(){var t={version:1,contextes:[]};this.contextes.forEach(function(e){t.contextes.push({id:e.getId(),client:e.getClient(),mode:e.getMode(),content:e.getCurrentDatas()})}),localStorage.setItem("contextesClients",JSON.stringify(t)),this.storage.saveValue(Math.random())},c.prototype.load=function(e){var r=this,t=null;if(!(t=e||JSON.parse(localStorage.getItem("contextesClients"))))return this.contextes=[],void(this.contextesById={});if(1!==t.version)return c.loggerContexteClientManagerBase.error("Impossible de charger les contextes du local storage car la version "+t.version+" n'est pas correcte! Repars de zéro."),this.contextes=[],void(this.contextesById={});var n=this.contextesById;this.contextes=[],this.contextesById={};var o=[],s=this.library.Context.GetWaitingProcesses();s&&s.forEach(function(e){o.push(e)});var i=this.library.Context.getPortails();i&&i.forEach(function(e){e.processes.forEach(function(e){o.push(e)})}),t.contextes.forEach(function(t){var n=new l.ContexteClientClass(t.id,r.library.Core,r);r.contextes.push(n),(r.contextesById[t.id]=n).setClient(t.client),o.forEach(function(e){e.contexteClientId===t.id&&n.ajouterProcessus(e)}),n.setProperty(null,t.content),n.setMode(t.mode)}),o.forEach(function(e){r.contextesById[e.contexteClientId]||r.library.Context.setContextClientIdOnProcessus(null,e)}),this.contextes.forEach(function(e){n[e.getId()]?(n[e.getId()].getClient()!==e.getClient()&&r.broadcastUpdateEvent(null,"load",e,l.Messages.MiseAJourContexteClientType.setClient),r.library.Core.ObjectUtils.deepEquals(n[e.getId()].getCurrentDatas(),e.getCurrentDatas())||r.broadcastUpdateEvent(null,"load",e,l.Messages.MiseAJourContexteClientType.setProperty)):(r.broadcastUpdateEvent(null,"load",e,l.Messages.MiseAJourContexteClientType.setClient),r.broadcastUpdateEvent(null,"load",e,l.Messages.MiseAJourContexteClientType.setProperty))})},c.prototype.broadcastUpdateEvent=function(e,n,t,r){var o=this,s={cleModifie:e,contexteClientId:t?t.getId():null,type:r};"portail"!==n&&this.SendEvent(new u.Component.ManagerEvent(u.Component.ManagerEventType.MiseAJourContexteClient,{contexteClientMiseAJourInfo:s}));var i=void 0;t&&(i=t.getProcessus()),i&&(i.forEach(function(e){if(e.id!==n){var t=new u.NotificationMessage;t.Sujet="MiseAJourContexteClient",t.Contenu=s,o.library.Display.Frames&&o.library.Display.Frames.every(function(e){return o.library.Context.NotifyFrame(t,e),!0})}}),"interop"!==n&&"load"!==n&&t.getProperty(null).then(function(e){o.api.setContexteClientNSDK(t.getClient(),e).then(function(e){e&&(t.setProperty(c.RELOAD_FLAG_NAME,c.RELOAD_FLAG_VALUE_NONE),u.Loggers.FLASH.INSTANCE.setValue("action","broadcastUpdateEvent"),c.loggerContexteClientManagerBase.debug("update ok"))}).catch(function(e){u.Loggers.FLASH.INSTANCE.setValue("action","broadcastUpdateEvent"),u.Loggers.FLASH.INSTANCE.setValue("details",e),c.loggerContexteClientManagerBase.error("Impossible de mettre à jour la synthèse NSDK")})}))},c.prototype.broadcastUpdateEventByProcess=function(r,o,e,s){var i=this;e.forEach(function(t){var e={cleModifie:r,contexteClientId:t.contexteClientId,type:s};if("portail"!==o&&i.SendEvent(new u.Component.ManagerEvent(u.Component.ManagerEventType.MiseAJourContexteClient,{contexteClientMiseAJourInfo:e})),t.id!==o){var n=new u.NotificationMessage;n.Sujet="MiseAJourContexteClient",n.Contenu=e,i.library.Display.Frames&&i.library.Display.Frames.every(function(e){return e.ProcessId!==t.id||(i.library.Context.NotifyFrame(n,e),!1)})}})},c.CLASS_NAME_BASE="MyWay.Services.Context.ContexteClientManagerBase",c.loggerContexteClientManagerBase=u.Loggers.LoggerFactory.INSTANCE.getClass(c.CLASS_NAME_BASE),c}(u.Components.ComponentManagerBase),l.ContexteClientManagerBase=t,u.Components.RegistryManager.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var u,r,t;u=e.Services||(e.Services={}),r=u.ContexteClient||(u.ContexteClient={}),t=function(){function e(e,t,n){this.coreCommon=t,this.contexteClientManager=n,this.contexte=null,this.id=e,this.client=void 0,this.contexte={},this.mode=r.Messages.ContexteClientMode.MANUEL,this.processus=[]}return e.prototype.getId=function(){return this.id},e.prototype.getMode=function(){return this.mode},e.prototype.setMode=function(e){this.mode=e,this.checkSiDoitDetruireContexteClient()},e.prototype.getProcessus=function(){return this.processus},e.prototype.ajouterProcessus=function(e){this.processus.push(e)},e.prototype.retirerProcessus=function(e){for(var t=!1,n=0;n<this.processus.length;n++)t||this.processus[n]!==e||(t=!0),t&&(this.processus[n]=this.processus[n+1]);return t||this.processus[this.processus.length-1]!==e||(t=!0),t&&(this.processus.length--,this.checkSiDoitDetruireContexteClient()),t},e.prototype.checkSiDoitDetruireContexteClient=function(){this.mode===r.Messages.ContexteClientMode.AUTOMATIQUE&&0===this.processus.length&&this.detruireContexte()},e.prototype.getClient=function(){return this.client},e.prototype.setClient=function(e){if(this.client)throw new u.Erreur("Impossible de modifier le client courant du contexte client car il est déjà défini.");this.client=e},e.prototype.getCurrentDatas=function(){return this.contexte},e.prototype.getProperty=function(r){var o=this;return this.coreCommon.promesseTryCatch(function(e){if(r){var t=r.split("."),n=o.contexte;t.every(function(e,t){return null!=(n=n[e])}),e.resolve(n)}else e.resolve(o.contexte)})},e.prototype.addToList=function(s,i){var a=this;return this.coreCommon.promesseTryCatch(function(e){if(s){var t=s.split("."),n=a.contexte,r=t.length,o=!1;t.forEach(function(e,t){if(r<=t+1)return n[e]||(n[e]=[]),(n=n[e]).push?(n.push(i),void(o=!0)):void(o=!1);n[e]||(n[e]={}),n=n[e]}),e.resolve(o)}else e.reject(new u.Erreur("La clé ne peut être nulle ni vide"))})},e.prototype.setProperty=function(o,s){var i=this;return this.coreCommon.promesseTryCatch(function(e){if(!o)return i.contexte=s,void e.resolve(!0);var t=o.split("."),n=i.contexte,r=t.length;t.forEach(function(e,t){r<=t+1?n[e]=s:(n[e]||(n[e]={}),n=n[e])}),e.resolve(!0)})},e.prototype.removeFromList=function(n){var r=this;return this.coreCommon.promesseTryCatch(function(e){if(n){var t=n.split("."),i=r.contexte,a=t.length,c=!1;t.every(function(e,t){if(a<=t+1){var n=i;if(!n.push)return void(c=!1);var r=Number(e);if(isNaN(r))return c=!1;for(var o=n.length,s=r;s<o-1;s++)n[s]=n[s+1];return delete n[n.length-1],n.length--,c=!0}return!!i[e]&&(i=i[e],!0)}),e.resolve(c)}else e.reject(new u.Erreur("La clé ne peut être nulle ni vide"))})},e.prototype.deleteProperty=function(s){var i=this;return this.coreCommon.promesseTryCatch(function(e){if(!s)return i.contexte={},void e.resolve(!0);var t=s.split("."),n=i.contexte,r=t.length,o=!1;t.every(function(e,t){return r<=t+1?o=!!n[e]&&(delete n[e],!0):!!n[e]&&(n=n[e],!0)}),e.resolve(o)})},e.prototype.detruireContexte=function(){this.contexteClientManager.detruireContexte(null,this.id)},e}(),r.ContexteClientClass=t}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-contexte-client-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var s,p,t;s=e.Services||(e.Services={}),p=s.BriqueCommunication||(s.BriqueCommunication={}),t=function(a){function f(){var i=a.call(this,s.Components.ComponentType.BriqueCommunication)||this;return i.initialization=null,i.api=null,i.configuration=null,i.configurationEtablissement=null,i.AVAILABLE=null,i.CONNECTED=null,i.TO_DEVICE=null,i.FROM_DEVICE=null,i.CONFIGURATION_ETABLISSEMENT=null,i.agentCourant=null,i.loadConfig=function(o){return f.logger.error("Chargement de la configuration globale KAAZING"),s.CoreCommon.promesseTryCatch(function(t){var n=null,r=function(e){n.close(),i.configuration=e,i.configuration.forEach(function(e){switch(e.code){case"USERS_TODEVICE":i.TO_DEVICE=e;break;case"USERS_FROMDEVICE":i.FROM_DEVICE=e;break;case"USERS_AVAILABLE":i.AVAILABLE=e;break;case"USERS_ONLINE":i.CONNECTED=e;break;case"CHANNELS_SEC_CONFIGURATION":i.CONFIGURATION_ETABLISSEMENT=e}}),i.loadConfigEtablissement(o,t)};i.ouvrirCanal(p.URLBASE_CONFIGURATION,p.TOPIC_CONFIGURATION_GENERALE,{readable:!0,writable:!1},o).then(function(e){(n=e).reader=r},function(e){f.logger.error("Impossible de charger la configuration KAAZING : %1",JSON.pruned(e)),t.reject(e)})}).then(function(){return i.enregistrerAgent()})},i.sessions={},i.connexionsInProgress={},i.connexionsEnFileDAttente={},i}return __extends(f,a),f.prototype.init=function(e,t,n,r){var o=this;return this.api=r,a.prototype.init.call(this,e,t,n,r).then(function(){if(window.JmsConnectionFactory)return e.Context.getAuthentificationInfo().then(function(e){return o.loadConfig(e)}).then(function(){o.library.Display.setFormatObjectNotificationListener(s.Component.ManagerEventType.BriqueCommunication,function(e,t){t.type=s.CommonEventType.BriqueCommunication,t.Contenu=e.Detail.chat})})})},f.prototype.getConfiguration=function(){return this.configuration},f.prototype.getConfigurationEtablissement=function(){return this.configurationEtablissement},f.prototype.getInfosAgentCourant=function(){return this.agentCourant},f.prototype.loadConfigEtablissement=function(e,t){var n=this;f.logger.error("Chargement de la configuration de l'établissement");var r=null,o=function(e){r.close(),n.configurationEtablissement=e,f.logger.error("Fin de chargement de la configuration"),t.resolve()};this.ouvrirCanal(this.CONFIGURATION_ETABLISSEMENT.url,this.replaceTokens(this.CONFIGURATION_ETABLISSEMENT.destination,{establishment:e.codeEtablissement}),{readable:!0,writable:!1},e).then(function(e){(r=e).reader=o},function(e){f.logger.error("Impossible de charger la configuration par établissement de KAAZING : %1",JSON.pruned(e)),t.reject(e)})},f.prototype.enregistrerAgent=function(){var o=this;return s.CoreCommon.promesseTryCatch(function(r){o.library.Context.getAuthentificationInfo().then(function(e){var n=null,t=function(t){n.close(),t.firstname=e.agentConnecte.prenom,t.lastname=e.agentConnecte.nomFamillePersonnePhysique,t.establishment=e.codeEtablissement,t.persisted=!0,o.agentCourant=t,o.ouvrirCanal(o.FROM_DEVICE.url,o.FROM_DEVICE.destination,{readable:!1,writable:!0},e).then(function(e){e.writer(t),e.close(),r.resolve()},r.reject)};o.ouvrirCanal(o.TO_DEVICE.url,o.TO_DEVICE.destination,{readable:!0,writable:!1},e).then(function(e){(n=e).reader=t},r.reject)},r.reject)})},f.prototype.setStatutEnLigne=function(t){var n=this;return this.library.Context.getAuthentificationInfo().then(function(e){return n.agentCourant.onlineStatus=t,n.ouvrirCanal(n.FROM_DEVICE.url,n.FROM_DEVICE.destination,{readable:!1,writable:!0},e).then(function(e){e.writer(n.agentCourant),e.close()})})},f.prototype.getUtilisateursConnectes=function(){var t=this;return this.library.Context.getAuthentificationInfo().then(function(e){return t.ouvrirCanal(t.CONNECTED.url,t.replaceTokens(t.CONNECTED.destination,{establishment:e.codeEtablissement}),{readable:!0,writable:!1},e).then(function(e){return e})})},f.prototype.getUtilisateurs=function(){var t=this;return this.library.Context.getAuthentificationInfo().then(function(e){return t.ouvrirCanal(t.AVAILABLE.url,t.AVAILABLE.destination,{readable:!0,writable:!1},e).then(function(e){return e})})},f.prototype.dispose=function(){var o=this;return s.CoreCommon.promesseTryCatch(function(e){var t=[];for(var n in o.sessions){var r=s.CoreCommon.ServiceDePromesse.defer();o.sessions[n].session.close(function(){r.resolve()}),delete o.sessions[n],t.push(r.promise)}s.CoreCommon.ServiceDePromesse.all(t).finally(e.resolve)})},f.prototype.ouvrirCanal=function(c,l,m,e){var h=this;return s.CoreCommon.promesseTryCatch(function(u){h.connect(c,e).then(function(e){var t=null!==l.match(/^\/queue\//);f.logger.debug("Connexion à %1, sur %2",c,l);var n=null,r=h.sessions[e].session;n=t?r.createQueue(l):r.createTopic(l);var o=null,i=null,a=new p.CanalControler;if(a.messagesEnAttente=null,a.close=function(){f.logger.debug("Deconnexion de %1, sur %2",c,l),o&&o.close(function(){}),i&&i.close(),h.sessions[e]&&(h.sessions[e].count--,null!==h.sessions[e].timeoutToClose&&window.clearTimeout(h.sessions[e].timeoutToClose),h.sessions[e].timeoutToClose=window.setTimeout(function(){h.sessions[e].count<=0&&(f.logger.debug("Tente de fermer la connexion à %1",c),h.sessions[e].session.close(function(){f.logger.debug("Session fermée à %1",c)}),delete h.sessions[e],delete h.connexionsInProgress[e],delete h.connexionsEnFileDAttente[e])},5e3))},m.readable&&(o=r.createConsumer(n)).setMessageListener(function(e){f.logger.debug("Message arrivé sur %1 : %2",l,JSON.pruned(e.getText()));var t=e.getText(),n=JSON.parse(t);a.reader(n)}),m.writable){i=r.createProducer(n);var s=function(e){var t=r.createTextMessage(e);i.send(t,function(){var e=a.messagesEnAttente,t=null,n=null;if(e&&0<e.length){n=e[0],t=[];for(var r=1;r<e.length;r++)t.push(e[r])}a.messagesEnAttente=t,n&&s(n)})};a.writer=function(e){var t=JSON.stringify(e);a.messagesEnAttente?a.messagesEnAttente.push(t):(a.messagesEnAttente=[],s(t))}}u.resolve(a)})})},f.prototype.replaceTokens=function(e,t){var n;for(n in t){var r=t[n];e=e.replace("["+n+"]",r)}return e},f.prototype.connect=function(r,e){var o=this;return s.CoreCommon.promesseTryCatch(function(n){return o.sessions[r]?(o.sessions[r].count++,void n.resolve(r)):o.connexionsInProgress[r]?(o.connexionsEnFileDAttente[r]||(o.connexionsEnFileDAttente[r]=[]),void o.connexionsEnFileDAttente[r].push(n)):(o.connexionsInProgress[r]=!0,void o.api.connect(r,e).then(function(e){var t=e;o.sessions[r]={count:1,session:t,timeoutToClose:null},o.connexionsEnFileDAttente[r]&&(o.connexionsEnFileDAttente[r].forEach(function(e){o.sessions[r].count++,e.resolve(r)}),delete o.connexionsEnFileDAttente[r]),delete o.connexionsInProgress[r],n.resolve(r)}))})},f.CLASS_NAME="MyWay.Services.BriqueCommunication.BriqueCommunicationManager",f.logger=s.Loggers.LoggerFactory.INSTANCE.getClass(f.CLASS_NAME),f}(s.Components.ComponentManagerBase),p.BriqueCommunicationManager=t,s.Components.RegistryManager.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var s,t,u,n;s=e.Services||(e.Services={}),t=s.BriqueCommunication||(s.BriqueCommunication={}),u=t.Chat||(t.Chat={}),n=function(i){function a(){var t=i.call(this,s.Components.ComponentType.Chat)||this;return t.conf_chat_request=null,t.conf_chat_request_experts=null,t.conf_chat_rooms=null,t.storageInstance=null,t.storageValue=null,t.storageSaveTimeout=null,t.chatManagerCanaux=null,t.onChangeStorage=function(e){e.chats.forEach(function(e){t.chatManagerCanaux.getChatRoomById(e.chatroom_id)||t.openChatroom.apply(t,[e.chatroom_id,null].concat(e.membres))})},t.onChangeAuthentificationInfo=function(){t.chatManagerCanaux.closeAndOpenAll()},t}return __extends(a,i),a.prototype.init=function(e,t,n,r){var o=this;return i.prototype.init.call(this,e,t,n,r).then(function(){if(window.JmsConnectionFactory)return o.chatManagerCanaux=new u.ChatManagerCanaux(e),o.load()})},a.prototype.sendNotification=function(e,t){var n={mainEventType:s.BriqueCommunication.Messages.EVENT_TYPE.CHAT,event:e},r=new s.Component.ManagerEvent(s.Component.ManagerEventType.BriqueCommunication,{chat:n});r.onSend=t,this.library.Evennements.notifier(r)},a.prototype.getCurrentFramePrincipale=function(){if(this.library.Display.CurrentFrame&&this.library.Display.CurrentFrame.capaciteChat)return this.library.Display.CurrentFrame.FrameId;var t=null;return this.library.Display.Frames&&this.library.Display.Frames.every(function(e){return e.capaciteChat&&(t=e.FrameId),null===t}),t},a.prototype.load=function(){var a=this;return this.storageInstance=this.library.Persistence.addStorage("Chats",this.onChangeStorage),this.chatManagerCanaux.init({fermerChatroom:function(e){a.closeChat(e)},ouvrirChatroom:function(e,t,n){n.push(t),a.openChatroom.apply(a,[e,a.getCurrentFramePrincipale()].concat(n))},notifierChangementListeUtilisateurs:function(o){var i=!1;a.storageValue.chats.forEach(function(e){var n=[],r=a.chatManagerCanaux.getChatRoomById(e.chatroom_id);e.membres.forEach(function(t){o.every(function(e){return e.id!==t||(e.isConnected?n.push(t):(i=!0,r&&r.utilisateurDeconnecte(t)),!1)})}),i&&(e.membres=n)}),a.sendNotification({eventType:u.Messages.EVENT_TYPE.MISE_A_JOUR_LISTE_UTILISATEURS,utilisateurs:o})},demanderExpert:function(e,t,n){a.sendNotification({eventType:u.Messages.EVENT_TYPE.DEMANDE_EXPERT,chatroom_id:e,expertise:t,user_id:n})},finDemandeExpert:function(e,t,n){a.sendNotification({eventType:u.Messages.EVENT_TYPE.FIN_DEMANDE_EXPERT,chatroom_id:e,expertise:t,user_id:n})}}),this.storageValue=this.storageInstance.getValue(),this.storageValue||(this.storageValue={chats:[]}),this.onChangeStorage(this.storageValue),this.ajouterListenerEvent(s.Component.ManagerEventType.ChangementAuthentificationInfo,this.onChangeAuthentificationInfo),this.library.BriqueCommunication.getConfiguration().forEach(function(e){switch(e.code){case"CHAT_REQUEST":a.conf_chat_request=e;break;case"CHATROOM":a.conf_chat_rooms=e;break;case"CHAT_REQUEST_PROSPECT":a.conf_chat_request_experts=e}}),this.library.Core.getPromesseSelfResoved()},a.prototype.addChatroomReader=function(e){var t=this;e.reader=function(e){t.sendNotification({eventType:u.Messages.EVENT_TYPE.MESSAGE_RECU,message:e})}},a.prototype.setChatCapacite=function(e){var t=this.library.Display.getMyIFrameId(e);this.library.Display.Frames&&this.library.Display.Frames.every(function(e){return e.FrameId===t&&(e.capaciteChat=!0),!0}),this.library.Display.CurrentFrame&&(this.library.Display.CurrentFrame.capaciteChat=!0)},a.prototype.getUtilisateurs=function(){return this.chatManagerCanaux.getUtilisateurs()},a.prototype.setStatut=function(e){return this.library.BriqueCommunication.setStatutEnLigne(e===u.Messages.UTILISATEUR_STATUT.CONNECTE)},a.prototype.getChatrooms=function(e){var n=this,r=this.library.Display.getMyIFrameId(e);return this.library.Core.promesseTryCatch(function(e){var t=[];n.chatManagerCanaux.getChatrooms().forEach(function(e){t.push({id:e.id,membres:e.membres,framePrincipale:e.framePrincipale,estFramePrincipale:e.framePrincipale===r,videoEstEnCours:!1})}),e.resolve(t)})},a.prototype.getChatroom=function(r,e){var o=this,i=this.library.Display.getMyIFrameId(e);return this.library.Core.promesseTryCatch(function(e){var t=o.chatManagerCanaux.getChatRoomById(r),n={id:t.id,membres:t.membres,framePrincipale:t.framePrincipale,estFramePrincipale:t.framePrincipale===i,videoEstEnCours:!1};e.resolve(n)})},a.prototype.closeChat=function(n){var r=this;return this.library.Core.promesseTryCatch(function(e){var t=r.chatManagerCanaux.getChatRoomById(n);null!==t?(t.writeEnd(),t.close(),r.chatManagerCanaux.retirerChatroom(t),r.supprimerStorageInstance(n),r.sendNotification({eventType:u.Messages.EVENT_TYPE.CHAT_FERME,chatroom_id:n}),e.resolve()):e.reject(new s.Erreur("Chat room "+n+" isn't found!"))})},a.prototype.accepterDemandeExpert=function(e,t,n,r){var o=this;return this.openChatroom(e,r,n).then(function(){o.chatManagerCanaux.accepterDemandeExpert(e,t,n)})},a.prototype.inviterPersonnesAUneChatroom=function(o){for(var i=this,e=[],t=1;t<arguments.length;t++)e[t-1]=arguments[t];return this.library.Context.getAuthentificationInfo().then(function(t){var n=i.chatManagerCanaux.getChatRoomById(o);if(n){var r=[];n.membres.forEach(function(e){r.push(e)}),e.forEach(function(e){n.membresObject[e]||r.push(e)}),e.forEach(function(e){i.inviterPersonneARejoindreUneChatroomApi.apply(i,[o,e,t].concat(r))})}})},a.prototype.changerFramePrincipale=function(e,t){var n=this.chatManagerCanaux.getChatRoomById(e);if(n&&n.framePrincipale!==t){n.framePrincipale=t;var r={eventType:u.Messages.EVENT_TYPE.CHAT_OUVERT,chatroom_id:e,framePrincipale:n.framePrincipale,videoEstEnCours:n.videoEstEnCours,estFramePrincipale:!1};this.sendNotification(r,function(e){return e===n.framePrincipale?r.estFramePrincipale=!0:r.estFramePrincipale=!1,!0})}},a.prototype.demarrerVideoChatroom=function(e){var t=this.chatManagerCanaux.getChatRoomById(e);t&&(t.videoEstEnCours=!0)},a.prototype.arreterVideoChatroom=function(e){var t=this.chatManagerCanaux.getChatRoomById(e);t&&(t.videoEstEnCours=!1)},a.prototype.openChat=function(r,e){var o=this,i=this.library.Display.getMyIFrameId(e);return this.library.Core.promesseTryCatch(function(n){var t=null;if(o.chatManagerCanaux.getChatrooms().every(function(e){if(!(2<e.membres.length))return e.membres[0]!==r&&e.membres[1]!==r||(t=e),null===t}),t){var e={id:t.id,membres:t.membres,framePrincipale:t.framePrincipale,estFramePrincipale:t.framePrincipale===i,videoEstEnCours:!1};n.resolve(e)}else o.openChatApi(r).then(function(e){e.framePrincipale=i;var t={id:e.id,membres:e.membres,framePrincipale:e.framePrincipale,estFramePrincipale:e.framePrincipale===i,videoEstEnCours:!1};o.enregistrerVideoroomsOuvertes(e),o.chatManagerCanaux.ajouterChatroom(e),o.addChatroomReader(e),o.sendNotification({eventType:u.Messages.EVENT_TYPE.CHAT_OUVERT,chatroom_id:e.id,membres:e.membres,framePrincipale:e.framePrincipale,estFramePrincipale:e.framePrincipale===i}),n.resolve(t)},n.reject)})},a.prototype.openChatroom=function(r,e){for(var o=this,i=[],t=2;t<arguments.length;t++)i[t-2]=arguments[t];var a=null;return a="string"==typeof e?e:this.library.Display.getMyIFrameId(e),this.library.Core.promesseTryCatch(function(n){var e=o.chatManagerCanaux.getChatRoomById(r);if(e){var t={id:e.id,membres:e.membres,framePrincipale:e.framePrincipale,estFramePrincipale:e.framePrincipale===a,videoEstEnCours:!1};n.resolve(t)}else o.library.Context.getAuthentificationInfo().then(function(e){o.library.Core.StringUtils.leftPad(e.agentConnecte.referenceExterneAgent,"0",7);var t=[r];i&&i.forEach(function(e){t.push(e)}),o.openTchatroomApi.apply(o,[r].concat(i)).then(function(e){e.framePrincipale=a,e.writeResponse(!0);var t={id:e.id,membres:e.membres,framePrincipale:e.framePrincipale,estFramePrincipale:e.framePrincipale===a,videoEstEnCours:!1};i&&i.forEach(function(e){}),o.enregistrerVideoroomsOuvertes(e),o.chatManagerCanaux.ajouterChatroom(e),o.addChatroomReader(e),o.sendNotification({eventType:u.Messages.EVENT_TYPE.CHAT_OUVERT,chatroom_id:e.id,membres:e.membres,framePrincipale:e.framePrincipale,estFramePrincipale:e.framePrincipale===a}),n.resolve(t)},n.reject)},n.reject)})},a.prototype.enregistrerVideoroomsOuvertes=function(o){var i=this,n=function(t){if(!o.membresObject[t]){var n={eventType:u.Messages.EVENT_TYPE.UTILISATEUR_CONNECTE_A_CHAT,chatroom_id:o.id,user_id:t,framePrincipale:o.framePrincipale,estFramePrincipale:!1};i.sendNotification(n,function(e){return e===o.framePrincipale?n.estFramePrincipale=!0:n.estFramePrincipale=!1,!0})}var r=o.videosrooms[t].canal.writer;o.videosrooms[t].canal.writer=function(e){var t=JSON.parse(e);a.logger.debug("Envoi d'un message sur la chatroom %1 : %2",o.id,JSON.pruned(t)),r(t)},o.videosrooms[t].canal.reader=function(e){a.logger.debug("Reception d'un message sur la chatroom %1 : %2",o.id,JSON.pruned(e)),i.sendMessage(u.ChatMessageSubject.WebRTC,{chatroom_id:o.id,user_id:t,content:e})}};o.utilisateurConnecte=function(e){var t={eventType:u.Messages.EVENT_TYPE.UTILISATEUR_CONNECTE_A_CHAT,chatroom_id:o.id,user_id:e,framePrincipale:o.framePrincipale,estFramePrincipale:!1};i.sendNotification(t,function(e){return e===o.framePrincipale?t.estFramePrincipale=!0:t.estFramePrincipale=!1,!0}),i.ajouterStorageInstance(o)},o.utilisateurDeconnecte=function(e){i.sendNotification({eventType:u.Messages.EVENT_TYPE.UTILISATEUR_DECONNECTE_A_CHAT,chatroom_id:o.id,user_id:e}),i.ajouterStorageInstance(o)},o.videoroomAjoutee=function(e,t){n(t)},o.membres.forEach(function(e){o.videosrooms[e]&&n(e)}),this.ajouterStorageInstance(o)},a.prototype.sendMessageToStream=function(n,r){var o=this;return this.library.Core.promesseTryCatch(function(e){var t=o.chatManagerCanaux.getChatRoomById(n);null!==t?(t.writeMessage(r),e.resolve()):e.reject(new s.Erreur("Chat room "+n+" isn't found!"))})},a.prototype.envoyerMessageVideoroom=function(r,o,i){var a=this;return this.library.Core.promesseTryCatch(function(e){var t=a.chatManagerCanaux.getChatRoomById(r);if(null!==t){var n=t.videosrooms[o];n?(n.canal.writer(i),e.resolve()):e.reject(new s.Erreur("Video room "+r+" to user "+o+" isn't found!"))}else e.reject(new s.Erreur("Chat room "+r+" isn't found!"))})},a.prototype.demarrerVideo=function(t){var r=this;return this.library.Core.promesseTryCatch(function(e){var n=r.chatManagerCanaux.getChatRoomById(t);n?n.membres.forEach(function(e){var t=n.videosrooms[e];t&&t.start()}):e.reject(new s.Erreur("Chat "+t+" not found!"))})},a.prototype.arreterVideo=function(t){var r=this;return this.library.Core.promesseTryCatch(function(e){var n=r.chatManagerCanaux.getChatRoomById(t);n?n.membres.forEach(function(e){var t=n.videosrooms[e];t&&t.stop()}):e.reject(new s.Erreur("Chat "+t+" not found!"))})},a.prototype.saveStorageValue=function(){var e=this;null!==this.storageSaveTimeout&&(window.clearTimeout(this.storageSaveTimeout),this.storageSaveTimeout=null),this.storageSaveTimeout=window.setTimeout(function(){e.storageInstance.saveValue(e.storageValue)},100)},a.prototype.ajouterStorageInstance=function(e){var t=this.getStorageInstance(e.id);t||(t={chatroom_id:e.id,membres:[]},this.storageValue.chats.push(t)),t.membres=e.membres,this.saveStorageValue()},a.prototype.supprimerStorageInstance=function(e){for(var t=!1,n=0;n<this.storageValue.chats.length-1;n++)this.storageValue.chats[n].chatroom_id===e&&(t=!0),t&&(this.storageValue.chats[n]=this.storageValue.chats[n+1]);(t||this.storageValue.chats[this.storageValue.chats.length-1].chatroom_id===e)&&this.storageValue.chats.length--,this.saveStorageValue()},a.prototype.getStorageInstance=function(t){var n=null;return this.storageValue.chats.every(function(e){return e.chatroom_id===t&&(n=e),null===n}),n},a.prototype.ecouterCanalDeDemandeApi=function(t){var n=this;return this.library.Context.getAuthentificationInfo().then(function(e){return n.library.BriqueCommunication.ouvrirCanal(n.conf_chat_request.url,n.library.BriqueCommunication.replaceTokens(n.conf_chat_request.destination,{user_id:t}),{readable:!0,writable:!1},e).then(function(e){return e})})},a.prototype.ecouterCanalExpertiseApi=function(t){var n=this;return this.library.Context.getAuthentificationInfo().then(function(e){return n.library.BriqueCommunication.ouvrirCanal(n.conf_chat_request_experts.url,n.library.BriqueCommunication.replaceTokens(n.conf_chat_request_experts.destination,{domain:t}),{readable:!0,writable:!0},e).then(function(e){return e})})},a.prototype.inviterPersonneARejoindreUneChatroomApi=function(n,e,t){for(var r=[],o=3;o<arguments.length;o++)r[o-3]=arguments[o];var i="agent-S"+this.library.Core.StringUtils.leftPad(t.agentConnecte.referenceExterneAgent,"0",7);this.library.BriqueCommunication.ouvrirCanal(this.conf_chat_request.url,this.library.BriqueCommunication.replaceTokens(this.conf_chat_request.destination,{user_id:e}),{readable:!1,writable:!0},t).then(function(e){var t={chatroom_id:n,type:"request",user_id:i,users_ids:r};e.writer(t),e.close()})},a.prototype.openChatApi=function(n){var r=this,o=this.generateRoomId();return this.library.Context.getAuthentificationInfo().then(function(t){return r.openTchatroomApi(o,n).then(function(e){return e.membresObject[n]||(e.membres.push(n),e.membresObject[n]=!0),r.inviterPersonneARejoindreUneChatroomApi(o,n,t),e})})},a.prototype.openTchatroomApi=function(i){for(var a=this,t=[],e=1;e<arguments.length;e++)t[e-1]=arguments[e];return this.library.Context.getAuthentificationInfo().then(function(e){var r="agent-S"+a.library.Core.StringUtils.leftPad(e.agentConnecte.referenceExterneAgent,"0",7),o={membres:[],membresObject:{},myUserId:r,id:i,close:null,reader:null,writeMessage:null,writeResponse:null,writeEnd:null,videosrooms:{},videoroomAjoutee:null,utilisateurConnecte:null,utilisateurDeconnecte:null,framePrincipale:null,videoEstEnCours:!1};o.membres.push(r),o.membresObject[r]=!0,t&&t.forEach(function(e){o.membresObject[e]||(o.membres.push(e),o.membresObject[e]=!0)});var n=function(t){if(!o.membresObject[t.user_id]){if("response"===t.type&&!t.accepted)return;o.membres.push(t.user_id),o.membresObject[t.user_id]=!0,o.utilisateurConnecte&&o.utilisateurConnecte(t.user_id),t.user_id!==r&&a.ouvrirCanalVideoApi(o,t.user_id).then(function(e){o.videosrooms[t.user_id]=e,o.videoroomAjoutee&&o.videoroomAjoutee(e,t.user_id)})}if("end"!==t.type)"message"===t.type&&o.reader&&o.reader(t);else if(o.membresObject[t.user_id]){for(var e=!1,n=0;n<o.membres.length-1;n++)o.membres[n]===t.user_id&&(e=!0),e&&(o.membres[n]=o.membres[n+1]);(e||o.membres[o.membres.length-1]===t.user_id)&&o.membres.length--,delete o.membresObject[t.user_id],o.utilisateurDeconnecte&&o.utilisateurDeconnecte(t.user_id)}};return a.library.BriqueCommunication.ouvrirCanal(a.conf_chat_rooms.url,a.library.BriqueCommunication.replaceTokens(a.conf_chat_rooms.destination,{chatroom_id:i}),{readable:!0,writable:!0},e).then(function(t){return t.reader=n,o.membres.forEach(function(t){t!==r&&a.ouvrirCanalVideoApi(o,t).then(function(e){o.videosrooms[t]=e,o.videoroomAjoutee&&o.videoroomAjoutee(e,t)})}),o.close=function(){o.membres.forEach(function(e){o.videosrooms[e]&&o.videosrooms[e].canal.close()}),t.close()},o.writeMessage=function(e){t.writer({chatroom_id:i,message:e,type:"message",user_id:r})},o.writeResponse=function(e){t.writer({chatroom_id:i,accepted:e,type:"response",user_id:r})},o.writeEnd=function(){t.writer({chatroom_id:i,type:"end",user_id:r})},o})})},a.prototype.ouvrirCanalVideoApi=function(e,t){var n=this,r=this.library.BriqueCommunication.replaceTokens(this.conf_chat_rooms.destination,{chatroom_id:e.id})+"/webrtc/"+(e.myUserId.localeCompare(t)<0?e.myUserId+"_"+t:t+"_"+e.myUserId);return a.logger.debug("Ouverture vidéo vers %1",r),this.library.Context.getAuthentificationInfo().then(function(e){return n.library.BriqueCommunication.ouvrirCanal(n.conf_chat_rooms.url,r,{readable:!0,writable:!0},e).then(function(e){return{start:null,stop:null,canal:e}})})},a.prototype.generateRoomId=function(){return Math.random().toString(36).substring(2)},a.CLASS_NAME="MyWay.Services.BriqueCommunication.Chat.ChatManagerBase",a.logger=s.Loggers.LoggerFactory.INSTANCE.getClass(a.CLASS_NAME),a}(s.Components.ComponentManagerBase),u.ChatManagerBase=n,s.Components.RegistryManager.getInstance().register(n)}(MyWay||(MyWay={})),function(e){var t,m,h,n;t=e.Services||(e.Services={}),m=t.BriqueCommunication||(t.BriqueCommunication={}),h=m.Chat||(m.Chat={}),n=function(){function e(e){this.library=e,this.listenerOnChangeAuthentificationInfo=null,this.currentCodeAgent=null,this.currentCodeEtablissement=null,this.doitEcouterMiseAJourListeUtilisateurs=!1,this.utilisateurs=null,this.currentListenerListeUtilisateurs=null,this.promessesGetUtilisateursEnAttente=[],this.doitEcouterCanalDemandeChat=!0,this.currentListenerDemandeChat=null,this.currentCanauxEcouteExpertises=[],this.currentCanauxEcouteExpertisesParDomaine={},this.chatrooms=[],this.controleur=null}return e.prototype.init=function(e){this.controleur=e,this.closeAndOpenAll()},e.prototype.Dispose=function(){var t=this;null!==this.currentListenerListeUtilisateurs&&(this.currentListenerListeUtilisateurs.close(),this.currentListenerListeUtilisateurs=null),null!==this.currentListenerDemandeChat&&(this.currentListenerDemandeChat.close(),this.currentListenerDemandeChat=null),this.chatrooms.forEach(function(e){t.controleur.fermerChatroom(e.id)})},e.prototype.closeAndOpenAll=function(){var r=this;this.library.Context.getAuthentificationInfo().then(function(e){var t=null,n=null;e&&(t=e.agentConnecte.referenceExterneAgent,n=e.codeEtablissement),r.currentCodeAgent!==t&&null!==r.currentListenerListeUtilisateurs&&(r.currentListenerListeUtilisateurs.close(),r.currentListenerListeUtilisateurs=null),r.currentCodeEtablissement!==n&&null!==r.currentListenerDemandeChat&&(r.currentListenerDemandeChat.close(),r.currentListenerDemandeChat=null),e&&(r.currentCodeAgent!==t&&(r.chatrooms.forEach(function(e){r.controleur.fermerChatroom(e.id)}),r.currentCanauxEcouteExpertises.forEach(function(e){e.canal.close(),delete r.currentCanauxEcouteExpertisesParDomaine[e.domaine]}),r.doitEcouterMiseAJourListeUtilisateurs&&r.ecouterMiseAJourListeUtilisateurs(e.codeEtablissement),r.ecouterCanauxExpertises(),r.currentCodeAgent=t),r.currentCodeEtablissement!==n&&r.doitEcouterCanalDemandeChat&&(r.ecouterCanalDeDemande(e.agentConnecte.referenceExterneAgent),r.currentCodeEtablissement=n))})},e.prototype.getUtilisateurs=function(){var n=this;return this.doitEcouterMiseAJourListeUtilisateurs=!0,this.library.Core.promesseTryCatch(function(t){null!==n.promessesGetUtilisateursEnAttente?0<n.promessesGetUtilisateursEnAttente.length?n.promessesGetUtilisateursEnAttente.push(t):(n.promessesGetUtilisateursEnAttente.push(t),n.library.Context.getAuthentificationInfo().then(function(e){n.ecouterMiseAJourListeUtilisateurs(e.codeEtablissement).then(function(){n.promessesGetUtilisateursEnAttente.forEach(function(e){e.resolve(n.utilisateurs)}),n.promessesGetUtilisateursEnAttente=null},t.reject)},t.reject)):t.resolve(n.utilisateurs)})},e.prototype.getChatrooms=function(){return this.chatrooms},e.prototype.ajouterChatroom=function(e){this.chatrooms.push(e)},e.prototype.retirerChatroom=function(e){for(var t=!1,n=0;n<this.chatrooms.length-1;n++)this.chatrooms[n].id===e.id&&(t=!0),t&&(this.chatrooms[n]=this.chatrooms[n+1]);(t||this.chatrooms[this.chatrooms.length-1].id===e.id)&&this.chatrooms.length--},e.prototype.getChatRoomById=function(t){var n=null;return this.chatrooms.every(function(e){return e.id===t&&(n=e),null===n}),n},e.prototype.accepterDemandeExpert=function(e,t,n){if(this.currentCanauxEcouteExpertisesParDomaine[t]){var r=this.library.BriqueCommunication.getInfosAgentCourant();this.currentCanauxEcouteExpertisesParDomaine[t].canal.writer({type:"response",accepted:!0,chatroom_id:e,date:Date.now(),domain:t,user_id:r.userid})}},e.prototype.ecouterCanauxExpertises=function(){var r=this,e=this.library.BriqueCommunication.getInfosAgentCourant();e.type===m.InfosAgentType.EXPERT&&e.preferences.expertises.forEach(function(t){r.library.Chat.ecouterCanalExpertiseApi(t).then(function(e){r.currentCanauxEcouteExpertisesParDomaine[t]={canal:e,domaine:t},r.currentCanauxEcouteExpertises.push(r.currentCanauxEcouteExpertisesParDomaine[t]),e.reader=function(e){switch(e.type){case"request":var t=e;r.controleur.demanderExpert(t.chatroom_id,t.domain,t.user_id);break;case"response":var n=e;r.controleur.finDemandeExpert(n.chatroom_id,n.domain,n.user_id)}}})})},e.prototype.ecouterMiseAJourListeUtilisateurs=function(c){var l=this;return this.library.Core.promesseTryCatch(function(t){var n=null,r=null,a={};l.utilisateurs=[];var o={close:function(){l.currentListenerListeUtilisateurs=null,n.close(),r.close()}},s=function(){l.controleur.notifierChangementListeUtilisateurs(l.utilisateurs)},i=function(e){e.forEach(function(e){if(e.establishment===c&&!a[e.userid]){var t=e.label.match(/^([^ ]+) ([^-]+)/),n=3<=t.length?t[2].trim():"?",r=2<=t.length?t[1].trim():"?",o={id:e.userid,isConnected:!1,nom:n,prenom:r,type:null};switch(e.type){case m.InfosAgentType.ADVISER:o.type=h.Messages.UTILISATEUR_TYPE.CONSEILLER;break;case m.InfosAgentType.CLIENT:o.type=h.Messages.UTILISATEUR_TYPE.CLIENT;break;case m.InfosAgentType.EXPERT:o.type=h.Messages.UTILISATEUR_TYPE.EXPERT;break;case m.InfosAgentType.PROSPECT:o.type=h.Messages.UTILISATEUR_TYPE.PROSPECT}a[o.id]=o,l.utilisateurs.push(o)}}),s()},u=function(e){var t=[],i={};l.utilisateurs.forEach(function(e){t.push(e),i[e.id]=e}),e.forEach(function(e){if(e.establishment===c){if(a[e.userid])a[e.userid].isConnected=!0;else{var t=e.label.match(/^([^ ]+) ([^-]+)/),n=3<=t.length?t[2].trim():"?",r=2<=t.length?t[1].trim():"?",o={id:e.userid,isConnected:!0,nom:n,prenom:r,type:null};switch(e.type){case m.InfosAgentType.ADVISER:o.type=h.Messages.UTILISATEUR_TYPE.CONSEILLER;break;case m.InfosAgentType.CLIENT:o.type=h.Messages.UTILISATEUR_TYPE.CLIENT;break;case m.InfosAgentType.EXPERT:o.type=h.Messages.UTILISATEUR_TYPE.EXPERT;break;case m.InfosAgentType.PROSPECT:o.type=h.Messages.UTILISATEUR_TYPE.PROSPECT}a[o.id]=o,l.utilisateurs.push(o)}delete i[e.userid]}}),t.forEach(function(e){i[e.id]&&(e.isConnected=!1)}),s()};l.library.BriqueCommunication.getUtilisateurs().then(function(e){(n=e).reader=i,r&&(l.currentListenerListeUtilisateurs=o,t.resolve())}),l.library.BriqueCommunication.getUtilisateursConnectes().then(function(e){(r=e).reader=u,n&&(l.currentListenerListeUtilisateurs=o,t.resolve())})})},e.prototype.ecouterCanalDeDemande=function(r){var o=this;return this.doitEcouterCanalDemandeChat=!0,this.library.Core.promesseTryCatch(function(t){var n=function(e){"request"===e.type&&o.controleur.ouvrirChatroom(e.chatroom_id,e.user_id,e.users_ids)},e="agent-S"+o.library.Core.StringUtils.leftPad(r,"0",7);o.library.Chat.ecouterCanalDeDemandeApi(e).then(function(e){e.reader=n,o.currentListenerDemandeChat=e,t.resolve(e)},t.reject)})},e}(),h.ChatManagerCanaux=n}(MyWay||(MyWay={})),function(e){var s,t,u,n;s=e.Services||(e.Services={}),t=s.BriqueCommunication||(s.BriqueCommunication={}),u=t.Notification||(t.Notification={}),n=function(i){function e(){var a=i.call(this,s.Components.ComponentType.Notification)||this;return a.CONF_NOTIFICATIONS=null,a.subjetsConnected=[],a.subjetsConnectedByName={},a.subjects=null,a.subjectsByName={},a.storageInstance=null,a.abonnements=null,a.onChangeStorage=function(e){e||(e={sujetsAbonnees:[],version:1});var t=[],n=[],r=[],o={};a.abonnements&&a.abonnements.sujetsAbonnees.forEach(function(e){r.push(e),o[e]=!0});var i={};e.sujetsAbonnees.forEach(function(e){i[e]=!0,o[e]||n.push(e)}),r.forEach(function(e){i[e]||t.push(e)}),t.forEach(function(e){a._arreterNotifications(e)}),n.forEach(function(e){a._ecouterNotifications(e)}),a.abonnements=e,a.save()},a.load=function(){return a.library.BriqueCommunication.getConfigurationEtablissement().forEach(function(e){switch(e.code){case"CLIENTS":a.CONF_NOTIFICATIONS=e}}),a.subjects=a.CONF_NOTIFICATIONS.parameters.subjects,a.subjects.forEach(function(e){a.subjectsByName[e.name]=e}),a.storageInstance=a.library.Persistence.addStorage("Notifications",a.onChangeStorage),a.onChangeStorage(a.storageInstance.getValue()),a.library.Core.getPromesseSelfResoved()},a}return __extends(e,i),e.prototype.init=function(e,t,n,r){var o=this;return i.prototype.init.call(this,e,t,n,r).then(function(){if(window.JmsConnectionFactory)return o.load()})},e.prototype.save=function(){this.storageInstance.saveValue(this.abonnements)},e.prototype.sendNotification=function(e){var t={mainEventType:s.BriqueCommunication.Messages.EVENT_TYPE.NOTIFICATION,event:e};this.library.Evennements.notifier(new s.Component.ManagerEvent(s.Component.ManagerEventType.BriqueCommunication,{chat:t}))},e.prototype._ecouterNotifications=function(n){var e,r=this;if(!this.subjectsByName[n])return(e=s.CoreCommon.ServiceDePromesse.defer()).reject(new s.Erreur("Canal "+n+" inconnu")),e.promise;if(this.subjetsConnectedByName[n])return(e=s.CoreCommon.ServiceDePromesse.defer()).resolve(),e.promise;var o=function(e){r.sendNotification({eventType:u.Messages.EVENT_TYPE.NOTIFICATION_MESSAGE,subject:n,message:e})},i=this.subjectsByName[n],a=this.library.BriqueCommunication.getInfosAgentCourant();return this.library.Context.getAuthentificationInfo().then(function(e){var t=r.library.BriqueCommunication.replaceTokens(r.CONF_NOTIFICATIONS.destination,{user_id:a.userid,subject:i.code});return r.library.BriqueCommunication.ouvrirCanal(r.CONF_NOTIFICATIONS.url,t,{readable:!0,writable:!1},e).then(function(e){e.reader=o,r.subjetsConnectedByName[n]={name:n,canal:e},r.subjetsConnected.push(r.subjetsConnectedByName[n]),r.sendNotification({eventType:u.Messages.EVENT_TYPE.NOUVEL_ABONNEMENT,subject:n})})})},e.prototype._arreterNotifications=function(e){var t=this.subjetsConnectedByName[e];if(t){t.canal.close(),delete this.subjetsConnectedByName[e];for(var n=!1,r=0;r<this.subjetsConnected.length-1;r++)this.subjetsConnected[r]===t&&(n=!0),n&&(this.subjetsConnected[r]=this.subjetsConnected[r+1]);(n||this.subjetsConnected[this.subjetsConnected.length-1]===t)&&(this.subjetsConnected.length--,n=!0),n&&this.sendNotification({eventType:u.Messages.EVENT_TYPE.DESABONNEMENT,subject:e})}},e.prototype.ecouterNotifications=function(n){var e=this;return this._ecouterNotifications(n).then(function(){var t=!1;e.abonnements.sujetsAbonnees.every(function(e){return!(t=e===n)}),t||(e.abonnements.sujetsAbonnees.push(n),e.save())})},e.prototype.arreterNotifications=function(e){this._arreterNotifications(e);for(var t=!1,n=0;n<this.abonnements.sujetsAbonnees.length-1;n++)this.abonnements.sujetsAbonnees[n]===e&&(t=!0),t&&(this.abonnements.sujetsAbonnees[n]=this.abonnements.sujetsAbonnees[n+1]);(t||this.abonnements.sujetsAbonnees[this.abonnements.sujetsAbonnees.length-1]===e)&&(this.abonnements.sujetsAbonnees.length--,t=!0),t&&this.save()},e.prototype.getListeSujets=function(){var t=this,n=[];return this.subjects.forEach(function(e){n.push({nom:e.name,estAbonne:!!t.subjetsConnectedByName[e.name]})}),this.library.Core.createPromiseSelfResolved({sujets:n})},e.prototype.ecouterNotificationsApi=function(e){var n=this;if(this.subjectsByName[e]){var r=this.subjectsByName[e],o=this.library.BriqueCommunication.getInfosAgentCourant();return this.library.Context.getAuthentificationInfo().then(function(e){var t=n.library.BriqueCommunication.replaceTokens(n.CONF_NOTIFICATIONS.destination,{user_id:o.userid,subject:r.code});return n.library.BriqueCommunication.ouvrirCanal(n.CONF_NOTIFICATIONS.url,t,{readable:!0,writable:!1},e)})}},e}(s.Components.ComponentManagerBase),u.NotificationManagerBase=n,s.Components.RegistryManager.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-brique-communication-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();!function(e){var r,t;r=e.Services||(e.Services={}),(t=r.Trace||(r.Trace={})).DB_STORE_TRACES="storeTrace",t.DB_STORE_TRACES_INDEX_NIVEAU="indexNiveau",t.DB_STORE_TRACES_INDEX_DATETIME="indexDatetime",t.TIMEOUT_ENVOI_TRACE=3e5,t.NB_ESSAIS_MAX_TRACES=5}(MyWay||(MyWay={})),function(e){var d;(function(e){var p,r;(r=p=e.EventSizeChangeType||(e.EventSizeChangeType={}))[r.SET=0]="SET",r[r.ADD=1]="ADD";var t=function(){function g(e,r,t){this.hasIndexedDb=e,this.library=r,this.onSizeChange=t,this.memoryDB=[],this.memoryDBAutoincrement=0}return g.prototype.get=function(c){var u=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(i){u.actionOnDB(function(e){var r=e.transaction([g.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var o=r.objectStore(g.TABLE_NOM),a=[],s=function(r){if(r>=c.length)i.resolve(a);else{var t=c[r],n=o.get(t);n.onsuccess=function(e){n.result?(a.push(u.elementToInstanceAvecCle(n.result)),a.push({cle:t,element:n.result})):(a.push(null),console.warn("Trace "+t+" isn't found!")),s(r+1)},n.onerror=function(e){console.error(e),i.reject(new d.Erreur("Erreur lors de la purge des traces de la base de données - Moment de la lecture"))}}};s(0)})});var e=[];return this.memoryDB.forEach(function(r){var t=null;c.every(function(e){return e===r.id&&(t=r),null===t}),e.push(u.elementToInstanceAvecCle(t))}),this.library.Core.createPromiseSelfResolved(e)},g.prototype.getAll=function(){var r=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(a){r.actionOnDB(function(e){var r=e.transaction([g.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(g.TABLE_NOM).openCursor(),o=[];t.onsuccess=function(e){var r=e.target.result;if(r){var t=r.value,n=r.key;o.push({cle:n,element:t}),r.continue()}else a.resolve(o)},t.onerror=function(e){console.error(e),a.reject(new d.Erreur("Erreur lors du comptage du nombre de traces"))}})});var t=[];return this.memoryDB.forEach(function(e){t.push(r.elementToInstanceAvecCle(e))}),this.library.Core.createPromiseSelfResolved(t)},g.prototype.chercher=function(s){var i=this;if(!s)return this.getAll();if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(a){i.actionOnDB(function(e){var r=e.transaction([g.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(g.TABLE_NOM).openCursor(),o=[];t.onsuccess=function(e){var r=e.target.result;if(r){var t=r.value;if(i.testTrace(t,s)){var n=r.key;o.push({cle:n,element:t})}r.continue()}else a.resolve(o)},t.onerror=function(e){console.error(e),a.reject(new d.Erreur("Erreur lors du comptage du nombre de traces"))}})});var r=[];return this.memoryDB.forEach(function(e){i.testTrace(e,s)&&r.push(i.elementToInstanceAvecCle(e))}),this.library.Core.createPromiseSelfResolved(r)},g.prototype.count=function(e){var r=this;return e||!this.hasIndexedDb?this.chercher(e).then(function(e){return e.length}):this.library.Core.promesseTryCatch(function(n){r.actionOnDB(function(e){var r=e.transaction([g.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(g.TABLE_NOM).count();t.onsuccess=function(){var e=t.result;n.resolve(e)},t.onerror=function(e){console.error(e),n.reject(new d.Erreur("Erreur lors du comptage du nombre de traces"))}})})},g.prototype.ajouter=function(i){var c=this;return this.hasIndexedDb?this.library.Core.promesseTryCatch(function(s){c.actionOnDB(function(e){var r=e.transaction([g.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var n=r.objectStore(g.TABLE_NOM),o=0,a=function(e){if(e>=i.length)return c.onSizeChange(o,p.ADD),void s.resolve();var r=i[e];o+=JSON.stringify(r.trace).length;var t=n.add(r);t.onsuccess=function(){a(e+1)},t.onerror=function(e){console.error(e),s.reject(new d.Erreur("Erreur lors de la sauvegarde d'une trace"))}};a(0)})}):(i.forEach(function(e){void 0===e.id?e.id=c.memoryDBAutoincrement++:e.id>c.memoryDBAutoincrement&&(c.memoryDBAutoincrement=e.id+1),c.memoryDB.push(e)}),this.library.Core.getPromesseSelfResoved())},g.prototype.supprimer=function(u){var l=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(c){l.actionOnDB(function(e){var r=e.transaction([g.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var a=r.objectStore(g.TABLE_NOM),s=0,i=function(t){if(t>=u.length)return l.onSizeChange(-1*s,p.ADD),void c.resolve();var n=u[t],o=a.get(n);o.onsuccess=function(e){if(!o.result)return console.warn("Trace "+n+" isn't found!"),void i(t+1);s+=JSON.stringify(o.result.trace).length;var r=a.delete(n);r.onsuccess=function(){i(t+1)},r.onerror=function(e){console.error(e),c.reject(new d.Erreur("Erreur lors de la purge des traces de la base de données - Moment de la suppression"))}},o.onerror=function(e){console.error(e),c.reject(new d.Erreur("Erreur lors de la purge des traces de la base de données - Moment de la lecture"))}};i(0)})});var e=[];return this.memoryDB.forEach(function(r){var t=!1;u.every(function(e){return!(t=e===r.id)}),t||e.push(r)}),this.memoryDB=e,this.library.Core.getPromesseSelfResoved()},g.prototype.mettreAJour=function(s){var o=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(a){o.actionOnDB(function(e){var r=e.transaction([g.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var n=r.objectStore(g.TABLE_NOM),o=function(e){if(e>=s.length)a.resolve();else{var r=s[e],t=n.put(r.element,r.cle);t.onsuccess=function(){o(e+1)},t.onerror=function(e){console.error(e),a.reject(new d.Erreur("Erreur lors du reset de la base de données"))}}};o(0)})});var e=[];return s.forEach(function(t){var n=!1;o.memoryDB.every(function(e,r){return t.cle===e.id&&(o.memoryDB[r]=t.element,n=!0),!n}),n||e.push(t.element)}),0<e.length?this.ajouter(e):this.library.Core.getPromesseSelfResoved()},g.prototype.resetAll=function(){var o=this;return this.hasIndexedDb?this.library.Core.promesseTryCatch(function(n){o.actionOnDB(function(e){var r=e.transaction([g.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(g.TABLE_NOM).clear();t.onsuccess=function(e){o.onSizeChange(0,p.SET),n.resolve()},t.onerror=function(e){console.error(e),n.reject(new d.Erreur("Erreur lors du reset de la base de données"))}})}):(this.memoryDB.length=0,this.library.Core.getPromesseSelfResoved())},g.prototype.getTracesToPurge=function(){var e=this;if(!this.hasIndexedDb)return this.library.Core.createPromiseSelfResolved(this.memoryDB);var o=[];return this.library.Core.promesseTryCatch(function(n){e.actionOnDB(function(e){var r=e.transaction([g.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(g.TABLE_NOM).openCursor();t.onsuccess=function(e){var r=e.target.result;if(r){var t=r.value;t.id=r.key,o.push(t),r.continue()}else n.resolve(o)},t.onerror=function(e){console.error(e),n.reject(new d.Erreur("Erreur lors de la récupération des traces à purger"))}})})},g.prototype.actionOnDB=function(t){var e=window.indexedDB.open("myway_stc_traces",g.VERSION);e.onupgradeneeded=function(e){var r=e.target.result;switch(e.oldVersion){case 0:r.createObjectStore(g.TABLE_NOM,{autoIncrement:!0}).createIndex("datetime","datetime",{unique:!1})}},e.onsuccess=function(e){var r=e.target.result;t(r)}},g.prototype.testTrace=function(e,r){return!!e.trace.message.match(r)},g.prototype.elementToInstanceAvecCle=function(e){return e?{cle:e.id,element:e}:null},g.VERSION=1,g.TABLE_NOM="traces",g}();e.TraceDB=t})((d=e.Services||(e.Services={})).Trace||(d.Trace={}))}(MyWay||(MyWay={})),function(p){var d;(function(c){d.CoreCommon.addListenerOnCheckSettings(function(e){d.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.stepInfo)&&!d.Controle.StaticNumberControle.isNumber(e.stepInfo.NiveauTrace)&&(e.stepInfo.NiveauTrace=c.NIVEAUX_TRACE.DEBUG)}),c.QUOTA_PURGE=102400;var i,e,u=!(c.INTERVALLE_PURGE=6e5),l=0,g=0;(e=i||(i={}))[e.DEBUT="DEBUT"]="DEBUT",e[e.FIN="FIN"]="FIN";var r=function(a){function s(){var r=a.call(this,d.Components.ComponentType.Trace)||this;return r.api=null,r.storageInstanceSize=null,r.storageInstancePurge=null,r.traceDB=null,r.onCallbackOnFinProcessus=function(e){r.purgerTraces()},r._modeDebugDuration=72e5,r._dateDebutDebug=0,r._dateFinDebug=0,r}return __extends(s,a),s.prototype.createPrivateTrace=function(e,r,t,n){var o=new c.TraceModel;o.niveau=e,o.composant="TraceManager",o.action=r,o.application=p.Framework.NAME+" V"+p.Framework.VERSION,o.datetime=(new Date).getTime(),o.message=t,o.details=n,this.traceModelToLogger(o)},s.prototype.init=function(e,r,t,n){var o=this;return this.api=n,a.prototype.init.call(this,e,r,t,n).then(function(){return o.storageInstanceSize=o.library.Persistence.addStorage("traces_size",function(e){g=e.newSize}),o.storageInstancePurge=o.library.Persistence.addStorage("traces_size",function(e){u=e.action===i.FIN,l=e.nbPurgesError}),d.BaseDeDonnees.Generique.Factory.testImplementationIndexeddb().then(function(t){return o.traceDB=new c.TraceDB(t,o.library,function(e,r){if(t){switch(r){case c.EventSizeChangeType.ADD:g+=e;break;case c.EventSizeChangeType.SET:g=e;break;default:s.logger.error("L'evennement de type %1 n'est pas geré par le callback onSizeChanged() sur la base de données des traces",r)}o.storageInstanceSize.saveValue({newSize:g})}}),o.library.BaseDeDonnees.enregistrerDB("TRACE",{version:c.TraceDB.VERSION,implementation:t?d.BaseDeDonnees.BaseDeDonneesImplementation.INDEXEDDB:d.BaseDeDonnees.BaseDeDonneesImplementation.MEMORY,getTables:function(){return[c.TraceDB.TABLE_NOM]},getTable:function(e){switch(e){case c.TraceDB.TABLE_NOM:return o.traceDB;default:return null}}}),o.traceDB.getAll().then(function(e){var r=0;e.forEach(function(e){e&&(r+=JSON.stringify(e.element.trace).length)}),g=r,o.storageInstanceSize.saveValue({newSize:g}),o.recordCheckpoints(),o.startTimerPurge()})})}).then(function(){o.library.Context.addListenerOnTerminerProcessus(o.onCallbackOnFinProcessus)}).then(function(){o.initializeModeDebug()})},s.prototype.startTimerPurge=function(){if(this._timerPurgeId)throw"un timer est déjà en cours d'éxécution";this.createPrivateTrace(c.NIVEAUX_TRACE.DEBUG,"startTimerPurge","Démarrage du timer de purge");var e=this;this._timerPurgeId=window.setInterval(function(){e.purgerTraces()},c.INTERVALLE_PURGE)},s.prototype.dispose=function(){return this.library.Context.removeListenerOnTerminerProcessus(this.onCallbackOnFinProcessus),this._timerPurgeId&&(this.createPrivateTrace(c.NIVEAUX_TRACE.DEBUG,"Dispose","Arrêt du timer de purge"),clearInterval(this._timerPurgeId),this._timerPurgeId=null),d.Loggers.Appenders.DBAppender.SERVICE_TRACE=null,this.library.BaseDeDonnees.disposeDB("TRACE"),a.prototype.dispose.call(this)},s.prototype.traceToLogger=function(e){d.Loggers.LoggerFactory.INSTANCE.getClass(e.packageName).tracer(e)},s.prototype.traceModelToLogger=function(e){var r=d.Loggers.LoggerFactory.INSTANCE.getClass("MyWay.SPA."+e.composant);switch(d.Loggers.FLASH.INSTANCE.setValue("details",e.details),d.Loggers.FLASH.INSTANCE.setValue("action",e.action),e.datetime&&d.Loggers.FLASH.INSTANCE.setValue("dateLog",new Date(e.datetime)),e.niveau){case c.NIVEAUX_TRACE.DEBUG:r.debug(e.message);break;case c.NIVEAUX_TRACE.INFO:r.info(e.message);break;case c.NIVEAUX_TRACE.WARNING:r.warn(e.message);break;case c.NIVEAUX_TRACE.ERROR:r.error(e.message);break;default:throw"Niveau de trace "+e.niveau+" non supporté"}},s.prototype.recupererInfosContexte=function(e){var r=this.library.Context.GetAuthentificationInfo();r&&(e.COCXBQ=r.codeEtablissement,e.client=r.numeroStationTravail,r.agentConnecte&&(e.COCEAG=r.agentConnecte.referenceExterneAgent,e.CTCEAG=r.agentConnecte.typeFonction,e.NOCEEL=r.agentConnecte.numeroInterneEds)),e.idProcessus=d.Donnees.StaticStringExtension.getEmptyStringIfNotStringOrGetItSelf(this.library.Context.GetMainProcessId()),e.cheminInstances=d.Donnees.StaticStringExtension.getEmptyStringIfNotStringOrGetItSelf(this.library.Context.GetPortalContext().currentPath)},s.prototype.logToTrace=function(e,r){var t=null;switch(e.niveau){case d.Loggers.LEVEL.DEBUG:t=c.NIVEAUX_TRACE.DEBUG;break;case d.Loggers.LEVEL.INFO:t=c.NIVEAUX_TRACE.INFO;break;case d.Loggers.LEVEL.WARN:t=c.NIVEAUX_TRACE.WARNING;break;case d.Loggers.LEVEL.ERROR:t=c.NIVEAUX_TRACE.ERROR}var n=r.format(e),o=e.context.details,a=e.context.action;e.date,"ServiceAgentExtended"===a&&o&&o.lastDigestTime&&(o.lastDigestTime,o=null);var s=null,i=null;return a||(a=""),(i=/^MyWay\.Service.*/.test(e.packageName)?(s=void 0!==p.Framework?p.Framework.NAME+" V"+p.Framework.VERSION:"Framework inconnu",e.packageName):(s=e.packageName,null))||(i=""),o||(o=null),{action:a,application:s,cheminInstances:null,client:null,COCEAG:null,COCXBQ:null,composant:i,CTCEAG:null,datetime:e.date,details:o,idProcessus:null,message:n,niveau:t,NOCEEL:null,serveur:null,url:window.location.href}},s.prototype.sendMultipleLogs=function(e,t){var n=this,o=[];return e.forEach(function(e){var r=n.logToTrace(e,t);n.recupererInfosContexte(r),o.push({dateDernierEnvoi:0,nbEssais:0,trace:r})}),this.traceDB.ajouter(o).then(function(){n.gererPurge()})},s.prototype.sendLog=function(e,r){var t=this,n=this.logToTrace(e,r);this.recupererInfosContexte(n);var o={dateDernierEnvoi:0,nbEssais:0,trace:n};return this.traceDB.ajouter([o]).then(function(){t.gererPurge()})},s.prototype.send=function(e,r){var t=this;this.recupererInfosContexte(e);var n={dateDernierEnvoi:0,nbEssais:0,trace:e};return this.traceDB.ajouter([n]).then(function(){t.gererPurge()})},s.prototype.recordCheckpoints=function(e){var r=this;for(var t in IndependantLogger.Memory._checkpoints){var n=new c.TraceModel;n.datetime=IndependantLogger.Memory._checkpoints[t].timestamp,n.message=IndependantLogger.Memory._checkpoints[t].message,n.niveau=c.NIVEAUX_TRACE.INFO,this.traceModelToLogger(n)}e&&0<e.length&&e.forEach(function(e){r.traceModelToLogger(n)}),IndependantLogger.Memory._checkpoints=[],IndependantLogger.Memory._traceManager=this,d.Loggers.Appenders.DBAppender.SERVICE_TRACE=this},s.prototype.gererPurge=function(){u||g>c.QUOTA_PURGE&&this.purgerTraces()},s.prototype.resetDB=function(){return this.traceDB.resetAll()},s.prototype.purgerTraces=function(){var t=this;if(!u){this.createPrivateTrace(c.NIVEAUX_TRACE.DEBUG,"purgerTraces","Début de la purge"),u=!0,this.storageInstancePurge.saveValue({action:i.DEBUT,nbPurgesError:l});var n=[],o=[],a=null;return this.traceDB.getTracesToPurge().then(function(e){if(0===(a=e).length)return u=!1,void t.storageInstancePurge.saveValue({action:i.FIN,nbPurgesError:l});var r=(new Date).getTime();return e.every(function(e){return e.dateDernierEnvoi=r,n.push(e.trace),o.push({cle:e.id,element:e}),n.length<30}),t.traceDB.mettreAJour(o)}).then(function(){return t.library.Context.getAuthentificationInfo()}).then(function(e){return t.api.envoyerTraces(n,e)}).then(function(){l=0;var r=[];o.forEach(function(e){r.push(e.cle)}),t.traceDB.supprimer(r)},function(e){console.error(e),t.finDePurgeFail(o)}).finally(function(){u=!1,t.storageInstancePurge.saveValue({action:i.FIN,nbPurgesError:l}),30<=a.length&&t.purgerTraces()})}},s.prototype.finDePurgeFail=function(e){var r=this;if(!(5<=++l)){var t=[],n=[];return e.forEach(function(e){e.element.nbEssais<c.NB_ESSAIS_MAX_TRACES?(e.element.nbEssais++,t.push(e)):n.push(e.cle)}),this.traceDB.mettreAJour(t).then(function(){return r.traceDB.supprimer(n)}).then(function(){0<t.length&&r.createPrivateTrace(c.NIVEAUX_TRACE.WARNING,"purgerTraces","Des traces n'ont pas pu être envoyées, incrémentation de leur compteur de tentative d'envois"),0<n.length&&r.createPrivateTrace(c.NIVEAUX_TRACE.ERROR,"purgerTraces","Des traces ont atteint leur quota de tentative d'envois, elles sont donc supprimées")})}this.traceDB.resetAll()},s.prototype.sendDiagnostic=function(e){var r=null,t=this.library.Context.GetCurrentProcess();t&&(r=this.library.Context.GetCurrentStep(t)),r&&(r.id===e.stepId&&(e.contextSize=this.library.Context.GetCurrentProcessContextSize(),this.SendEvent(new d.Component.ManagerEvent(d.Component.ManagerEventType.Diagnostic,{diagnostic:e}))),e.finalDiagnostic&&(this.library.Context.SetDiagnosticTraceSentForStep(e.stepPath),r.diagnosticTraceSentForStep=e.finalDiagnostic))},s.prototype.formatageDate=function(e){if(!1===/^(0[1-9]|1\d|2\d|3[01])\/(0[1-9]|1\d|2\d|3[01])\/(19|20)\d{2}\s+(0[0-9]|1[0-9]|2[0-3])\:(0[0-9]|[1-5][0-9])\:(0[0-9]|[1-5][0-9])$/.test(e))return null;var r=e.split(" "),t=r[0].split("/");t.reverse();var n=t.join("/")+" "+r[1];return new Date(n)},s.prototype.initializeModeDebug=function(){var e=0;try{var r=this.library.Context.GetFromContext("MODEDEBUG");r&&(e=parseInt(r,10))}catch(e){}Date.now()<this._dateFinDebug&&this._dateDebutDebug<Date.now()?d.PrivatePortalServiceParameters.Instance().TTLModeDebug=this._dateFinDebug:d.PrivatePortalServiceParameters.Instance().TTLModeDebug=0<e?e+this._modeDebugDuration:0,this.api.setModeDebug(d.PrivatePortalServiceParameters.Instance().TTLModeDebug)},s.prototype.setModeDebug=function(e){var n=this;e?(s.logger.info("Activation du mode debug"),this.library.Context.AddToContext(d.Context.StorageLevel.Global,"MODEDEBUG",Date.now().toString()),d.PrivatePortalServiceParameters.Instance().TTLModeDebug=Date.now()+this._modeDebugDuration,this.api.readFileModeDebug().then(function(e){try{var r=n.formatageDate(e.DateHeureDebut),t=n.formatageDate(e.DateHeureFin);r.getTime()<Date.now()&&Date.now()<t.getTime()&&(n._dateDebutDebug=r.getTime(),n._dateFinDebug=t.getTime(),d.PrivatePortalServiceParameters.Instance().TTLModeDebug=n._dateFinDebug)}catch(e){s.logger.warn("Format des dates incorrectes dans le fichier ModeDebugMyway.json : %1",e.codeLibelle)}}).catch(function(e){s.logger.warn("Erreur lors de la lecture du fichier ModeDebugMyway.json : %1",e.codeLibelle)}).finally(function(){s.logger.info("Mode débug activité jusqu'à : %1",new Date(d.PrivatePortalServiceParameters.Instance().TTLModeDebug)),n.api.setModeDebug(d.PrivatePortalServiceParameters.Instance().TTLModeDebug)})):(s.logger.info("Desactivation du mode debug"),this.library.Context.AddToContext(d.Context.StorageLevel.Global,"MODEDEBUG","0"),d.PrivatePortalServiceParameters.Instance().TTLModeDebug=0,this.api.setModeDebug(d.PrivatePortalServiceParameters.Instance().TTLModeDebug))},s.CLASS_NAME="MyWay.Services.Trace.TraceManager",s.logger=d.Loggers.LoggerFactory.INSTANCE.getClass(s.CLASS_NAME),s}(d.Components.ComponentManagerBase);c.TraceManager=r,d.Components.RegistryManager.getInstance().register(r)})((d=p.Services||(p.Services={})).Trace||(d.Trace={}))}(MyWay||(MyWay={})),function(e){var r;(r=e.Services||(e.Services={})).Core.defineProperty(r.PhantomAgent,"Trace",{get:function(){return new r.Trace.Logger("PhantomAgent","Manager",this._serviceManager.Library)}})}(MyWay||(MyWay={})),function(e){var r,s,t,n;r=e.Services||(e.Services={}),s=r.Loggers||(r.Loggers={}),t=s.Appenders||(s.Appenders={}),n=function(o){function a(e,r,t){var n=o.call(this,e,a.CLASSNAME,r,t)||this;return n.niveauxDeclenchementPurgeDebug=[],n.niveauMaxTrace=null,n.nbTracesAStocker=null,n.messagesAPurgerSiError=[],n.indexMessagesAPurgerSiError=0,n.niveauxDeclenchementPurgeDebug=t.niveauxDeclenchementPurgeDebug||[{name:"*",level:s.LEVEL.ERROR}],n.niveauMaxTrace=t.niveauMaxTrace||s.LEVEL.WARN,n.nbTracesAStocker=t.nbTracesAStocker||50,n}return __extends(a,o),Object.defineProperty(a,"SERVICE_TRACE",{set:function(e){null!==(a._SERVICE_TRACE=e)&&0<a.tracesAEnregistrer.length&&(a._SERVICE_TRACE.sendMultipleLogs(a.tracesAEnregistrer,a.messageFormater),a.tracesAEnregistrer.length=0)},enumerable:!0,configurable:!0}),a.prototype.append=function(e){return!!o.prototype.append.call(this,e)||(this.messagesAPurgerSiError.length<this.nbTracesAStocker?this.messagesAPurgerSiError.push(e):(this.messagesAPurgerSiError[this.indexMessagesAPurgerSiError]=e,this.indexMessagesAPurgerSiError++,this.indexMessagesAPurgerSiError%=this.nbTracesAStocker),!1)},a.prototype.onAppend=function(e){this.verificationEtEnvoiTracesSiNiveauDelenchementAtteint(e),this.envoyerTrace(e)},a.prototype.verificationEtEnvoiTracesSiNiveauDelenchementAtteint=function(r){var t=null,n=s.LEVEL.NONE;if(this.niveauxDeclenchementPurgeDebug.forEach(function(e){("*"===e.name||new RegExp("^"+e.name.replace(".","\\.")).test(r.packageName))&&(null===t||t.length<e.name.length)&&(n=e.level,t=e.name)}),s.LoggerHelper.INSTANCE.testLevel(r.niveau,n)){for(var e=this.indexMessagesAPurgerSiError;e<this.messagesAPurgerSiError.length;)this.envoyerTrace(this.messagesAPurgerSiError[e]),e++;for(e=0;e<this.indexMessagesAPurgerSiError;)this.envoyerTrace(this.messagesAPurgerSiError[e]),e++;this.messagesAPurgerSiError.length=0,this.indexMessagesAPurgerSiError=0}},a.prototype.envoyerTrace=function(e){null!==a._SERVICE_TRACE?a._SERVICE_TRACE.sendLog(e,a.messageFormater):a.tracesAEnregistrer.push(e)},a.CLASSNAME="MyWay.Services.Loggers.Appenders.DBAppender",a._SERVICE_TRACE=null,a.tracesAEnregistrer=[],a.messageFormater=new s.Formaters.MessageFormater,a}(t.AbstractAppender),t.DBAppender=n,s.LoggerFactory.INSTANCE.declareAppender(n.CLASSNAME,n)}(MyWay||(MyWay={})),function(e){var n,s,r,t;n=e.Services||(e.Services={}),s=n.Loggers||(n.Loggers={}),r=s.Appenders||(s.Appenders={}),t=function(o){function a(e,r,t){var n=o.call(this,e,a.CLASSNAME,r,t)||this;return n.format=null,n._eventsToSend=null,n.parse(t.format),n}return __extends(a,o),a.prototype.onAppend=function(r){var t="";this.format.forEach(function(e){t+=e.format(r)});var e=new n.Component.ManagerEvent(n.Component.ManagerEventType.Log,{trace:{content:t,level:null}});switch(e.ComponentName=n.Components.ComponentType.Trace,r.niveau){case s.LEVEL.DEBUG:e.Detail.trace.level="DEBUG",this.send(e);break;case s.LEVEL.INFO:e.Detail.trace.level="INFO",this.send(e);break;case s.LEVEL.WARN:e.Detail.trace.level="WARN",this.send(e);break;case s.LEVEL.ERROR:e.Detail.trace.level="ERROR",this.send(e)}},a.prototype.send=function(e){var r=null;n.ServiceManager.Instance()&&n.ServiceManager.Instance().Library&&n.ServiceManager.Instance().Library.Evennements&&(r=n.ServiceManager.Instance().Library.Evennements),r?(null!==this._eventsToSend&&(this._eventsToSend.forEach(function(e){n.ServiceManager.Instance().Library.Evennements.notifier(e)}),this._eventsToSend=null),n.ServiceManager.Instance().Library.Evennements.notifier(e)):(null===this._eventsToSend&&(this._eventsToSend=[]),this._eventsToSend.push(e))},a.prototype.parse=function(e){var t=this,r=e.split(/%([^ ]+)/g);this.format=[],r.forEach(function(r){if(0!==r.length){if(/^d/.test(r)){var e=r.split(/d{([^}]+)}/);return 3!==e.length?void t.format.push(new s.Formaters.DateFormater):void t.format.push(new s.Formaters.DateFormater(e[1]))}/^level$/.test(r)?t.format.push({format:function(e){return e.niveau.toString()}}):/^class/.test(r)?t.format.push({format:function(e){return e.packageName}}):/^msg/.test(r)?t.format.push(new s.Formaters.MessageFormater):t.format.push({format:function(e){return r}})}})},a.CLASSNAME="MyWay.Services.Loggers.Appenders.PortalAppender",a}(r.AbstractAppender),r.PortalAppender=t,s.LoggerFactory.INSTANCE.declareAppender(t.CLASSNAME,t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t,n,r;t=e.Services||(e.Services={}),n=t.Numerisation||(t.Numerisation={}),r=function(e){function r(){return e.call(this,t.Components.ComponentType.Numerisation)||this}return __extends(r,e),r.prototype.numeriser=function(e,t){return r.logger.info("Méthode à déprécier - numeriser"),this.sendMessage(n.NumerisationMessageSubject.Numeriser,{data:e,numerisationParams:t})},r.prototype.numeriserArcade=function(e,t){return r.logger.info("Méthode à surveiller - numeriserArcade"),this.sendMessage(n.NumerisationMessageSubject.NumeriserArcade,{data:e,numerisationParams:t})},r.prototype.getSpiFactoryActivationStatut=function(){return r.logger.info("Méthode à surveiller - getSpiFactoryActivationStatut"),this.sendMessage(n.NumerisationMessageSubject.GetSpiFactoryActivationStatut,{})},r.CLASS_NAME="MyWay.Services.Numerisation.NumerisationAgent",r.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME),r}(t.Components.ComponentAgentBase),n.NumerisationAgent=r,t.Components.RegistryAgent.getInstance().register(r)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-numerisation-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(t,e){function r(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();!function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var n,e,r;n=t.Services||(t.Services={}),e=n.Numerisation||(n.Numerisation={}),r=function(){function t(t){this.libraryManager=null,this._url=t}return t.prototype.initApi=function(t){this.libraryManager=t},t.prototype.numeriserDocument=function(t,e){var r={};return r.url=this._url+"/NumeriserSpifactory",r.method=n.MethodEnum.POST,r.params=e,r.async=!0,r.contentType=n.ContentTypeEnum.JSON,r.data=JSON.stringify(t),r.cache=!1,this.libraryManager.Core.sendRequest(r)},t.prototype.getSpiFactoryActivationStatutOnServeur=function(){var t={};return t.url=this._url+"/GetSpiFactoryActivationStatut",t.method=n.MethodEnum.GET,t.async=!0,t.contentType=n.ContentTypeEnum.JSON,this.libraryManager.Core.sendRequest(t)},t.prototype.numeriserDocumentArcade=function(t,e){var r={};return r.url=this._url+"/NumeriserSpifactoryArcade",r.method=n.MethodEnum.POST,r.params=e,r.async=!0,r.contentType=n.ContentTypeEnum.JSON,r.data=JSON.stringify(t),this.libraryManager.Core.sendRequest(r)},t}(),e.NumerisationApiBase=r}(MyWay||(MyWay={})),function(t){var e,o,r;e=t.Services||(t.Services={}),o=e.Numerisation||(e.Numerisation={}),r=function(i){function t(){var t=i.call(this,e.Components.ComponentType.Numerisation)||this;return t.wrapped=null,t}return __extends(t,i),t.prototype.init=function(t,e,r){var n=this;return t.ServiceLocal?this.wrapped=new o.NumerisationApiWindows:this.wrapped=new o.NumerisationApiFullWeb,i.prototype.init.call(this,t,e,r).then(function(){return n.wrapped.initApi(e)})},t.prototype.initApi=function(t){},t.prototype.numeriserDocument=function(t,e){return this.wrapped.numeriserDocument(t,e)},t.prototype.getSpiFactoryActivationStatutOnServeur=function(){return this.wrapped.getSpiFactoryActivationStatutOnServeur()},t.prototype.numeriserDocumentArcade=function(t,e){return this.wrapped.numeriserDocumentArcade(t,e)},t}(e.Components.ComponentApiBase),o.NumerisationApiFactory=r,e.Components.RegistryApi.getInstance().register(r)}(MyWay||(MyWay={})),function(t){var r,e,n;r=t.Services||(t.Services={}),e=r.Numerisation||(r.Numerisation={}),n=function(t){function e(){return t.call(this,r.PrivatePortalServiceParameters.Instance().NumerisationUrl)||this}return __extends(e,t),e}(e.NumerisationApiBase),e.NumerisationApiFullWeb=n}(MyWay||(MyWay={})),function(t){var r,e,n;r=t.Services||(t.Services={}),e=r.Numerisation||(r.Numerisation={}),n=function(t){function e(){return t.call(this,r.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/numerisation/")||this}return __extends(e,t),e}(e.NumerisationApiBase),e.NumerisationApiWindows=n}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-numerisation-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}s(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var n;(n=e.Services||(e.Services={})).Core.defineProperty(n.TechAgentExtended,"DonneesDelocaliseesTechAgent",{get:function(){return this._techLibrary.DonneesDelocaliseesTechAgent}})}(MyWay||(MyWay={})),function(e){var n;(n=e.Services||(e.Services={})).Core.defineProperty(n.TechAgent,"DonneesDelocaliseesTechAgent",{get:function(){return this._techLibrary.DonneesDelocaliseesTechAgent}})}(MyWay||(MyWay={})),function(e){(e.Services||(e.Services={})).TechLibrary.addInitListener(function(e,n){e.DonneesDelocaliseesTechAgent=n.DonneesDelocalisees})}(MyWay||(MyWay={})),function(e){var n,s,t;n=e.Services||(e.Services={}),s=n.DonneesDelocalisees||(n.DonneesDelocalisees={}),t=function(e){function n(){return e.call(this)||this}return __extends(n,e),n.prototype.reInitDbDonneesDelocalisees=function(e,n){return this.sendMessage(s.Messages.DonneesDelocaliseesMessageSubject.ReInitDbDonneesDelocalisees,{}).then(function(){e&&e()},function(e){throw n&&n(e),e})},n.prototype.getTDTById=function(e,n,t){return this.sendMessage(s.Messages.DonneesDelocaliseesMessageSubject.GetTDTById,{idTDT:e}).then(function(e){n&&n(e)},function(e){throw t&&t(e),e})},n.prototype.deleteTDTById=function(e,n,t){return this.sendMessage(s.Messages.DonneesDelocaliseesMessageSubject.DeleteTDTById,{}).then(function(){n&&n()},function(e){throw t&&t(e),e})},n}(s.DonneesDelocaliseesAgent),s.DonneesDelocaliseesTechAgent=t,n.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-donnees-delocalisees-tech-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var n,o,e;n=t.Services||(t.Services={}),o=n.Habilitation||(n.Habilitation={}),e=function(t){function e(){return t.call(this,n.Components.ComponentType.Habilitation)||this}return __extends(e,t),e.prototype.EstHabilite=function(t){var e=n.Controle.StaticArrayControle.isArray(t);return this.sendMessage(o.HabilitationMessageSubject.EstHabilite,{code:e?t:[t]}).then(function(t){return e?t:t[0]})},e}(n.Components.ComponentAgentBase),o.HabilitationAgent=e,n.Components.RegistryAgent.getInstance().register(e)}(MyWay||(MyWay={})),function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-habilitation-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(a){var s,e,t;s=a.Services||(a.Services={}),e=s.Habilitation||(s.Habilitation={}),t=function(r){function e(){return r.call(this,s.Components.ComponentType.Habilitation)||this}return __extends(e,r),e.prototype.init=function(e,t,n){return this._habilitationUrl=s.PrivatePortalServiceParameters.Instance().HabilitationUrl,r.prototype.init.call(this,e,t,n)},e.prototype.GetHabilitations=function(e,t,n,r,i){try{if(i.agentConnecte.referenceExterneAgent&&i.codeEtablissement&&i.agentConnecte.typeFonction){var o=void 0;if(o=this._habilitationUrl+"/?mysys="+e+"&iam="+t+"&cultureNet="+n+"&codeAgent=T"+i.agentConnecte.referenceExterneAgent+"&codeEtablissement="+i.codeEtablissement+"&typeFonction="+i.agentConnecte.typeFonction,t||n){if(null==r||!r.IdentifiantUser||!r.DomaineADUser)return s.Promesses.createPromiseSelfError(new s.Erreur(a.Services.Libelle.LibelleModel.COM.ERREUR_HABILITATION_PARAMETRES_INSUFFISANTS));o+="&userAD="+r.IdentifiantUser,o+="&domaineUtilisateur="+r.DomaineADUser}return this.libraryManager.Core.sendRequest({url:o,method:s.MethodEnum.GET,authentificationInfo:i})}return s.Promesses.createPromiseSelfError(new s.Erreur(a.Services.Libelle.LibelleModel.COM.ERREUR_HABILITATION_PARAMETRES_INSUFFISANTS))}catch(e){return s.Promesses.createPromiseSelfError(new s.Erreur(e))}},e}(s.Components.ComponentApiBase),e.HabilitationApi=t,s.Components.RegistryApi.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-habilitation-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var o in e)e.hasOwnProperty(o)&&(t[o]=e[o])};return function(t,e){function o(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(o.prototype=e.prototype,new o)}}();!function(t){var e,o;e=t.Services||(t.Services={}),o=function(){},(e.Lisa||(e.Lisa={})).LisaCallbackResult=o}(MyWay||(MyWay={})),function(t){var e,o;e=t.Services||(t.Services={}),((o=e.Components||(e.Components={})).ComponentType||(o.ComponentType={})).Lisa="Lisa"}(MyWay||(MyWay={})),function(t){var e,o,n,s;e=t.Services||(t.Services={}),o=e.Lisa||(e.Lisa={}),n=o.Messages||(o.Messages={}),(s=n.LisaMessageSubject||(n.LisaMessageSubject={}))[s.Next=0]="Next",s[s.StartProcess=1]="StartProcess",s[s.StartSubProcess=2]="StartSubProcess",s[s.StartExternalApp=3]="StartExternalApp",s[s.GetProcesses=4]="GetProcesses",s[s.GetTools=5]="GetTools",s[s.GetCodesProcessus=6]="GetCodesProcessus",s[s.GetInfoProcessus=7]="GetInfoProcessus",s[s.StartUrl=8]="StartUrl",s[s.StartUrlPortal=9]="StartUrlPortal",s[s.StartProcessPortal=10]="StartProcessPortal",e.Components.FactoryRegistries.getInstance().declareComponent(e.Components.ComponentType.Lisa,[e.Components.ComponentType.Aide,e.Components.ComponentType.Context,e.Components.ComponentType.ContexteClient,e.Components.ComponentType.Core,e.Components.ComponentType.Display,e.Components.ComponentType.Habilitation,e.Components.ComponentType.Interop,e.Components.ComponentType.TraceSuivi])}(MyWay||(MyWay={})),function(t){var e;(function(t){var e=function(){function t(){}return t.prototype.Init=function(t){t&&(t.ProcessDemarre&&(this.ProcessDemarre=new s(t.ProcessDemarre)),t.ProchaineEtape&&(this.ProchaineEtape=new i(t.ProchaineEtape)))},t}(),o=function(o){function t(t){var e=o.call(this)||this;return t&&(e.CodeEtape=t.CodeEtape,e.ValeurSortie=t.ValeurSortie,e.FinProcess=t.FinProcess,e.ValeurFinProcess=t.ValeurFinProcess),e.Init(t),e}return __extends(t,o),t}(t.ResultBase=e);t.NextResult=o;var n=function(o){function t(t){var e=o.call(this)||this;return t&&(e.CodeProcessus=t.CodeProcessus,e.VersionExport=t.VersionExport),e.Init(t),e}return __extends(t,o),t}(e);t.StartResult=n;var s=function(t){t&&(this.Code=t.Code,this.ValeurDepart=t.ValeurDepart,this.Nom=t.Nom,this.EtapesConnues=t.EtapesConnues,this.CodeEtape=t.CodeEtape,this.OptionsProcess=t.OptionsProcess,this.OptionsProcessAsEtape=t.OptionsProcessAsEtape,this.Actions=t.Actions)};t.ProcessResult=s;var i=function(t){if(t){if(this.CodeEtape=t.CodeEtape,this.CodeMetier=t.CodeMetier,this.TypeApplication=t.TypeApplication,this.ValeurEntree=t.ValeurEntree,this.CodeApplication=t.CodeApplication,this.NomApplication=t.NomApplication,this.Icone=t.Icone,this.LocalisationAbsolue=t.LocalisationAbsolue,this.LocalisationRelative=t.LocalisationRelative,this.Contrats=[],t.Contrats)for(var e=0;e<t.Contrats.length;e++){var o=t.Contrats[e],n=new r(o);this.Contrats.push(n)}if(this.Actions=[],t.Actions)for(e=0;e<t.Actions.length;e++){var s=t.Actions[e],i=new a(s);this.Actions.push(i)}this.OptionsEtape=t.OptionsEtape,this.OptionsPointEntree=t.OptionsPointEntree}};t.EtapeResult=i;var r=function(t){t&&(this.Code=t.Code,this.Type=t.Type,this.Longueur=t.Longueur,this.Nullable=t.Nullable,this.Mode=t.Mode,this.OptionsContrat=t.OptionsContrat)};t.ContratResult=r;var a=function(t){if(t&&(this.ValeurSortie=t.ValeurSortie,this.EstExterne=t.EstExterne,this.NomExterne=t.NomExterne,this.OptionsAction=t.OptionsAction,this.ValeursFinProcessPossibles=[],t.ValeursFinProcessPossibles))for(var e=0;e<t.ValeursFinProcessPossibles.length;e++){var o=t.ValeursFinProcessPossibles[e];this.ValeursFinProcessPossibles.push(o)}};t.ActionResult=a;var p=function(t,e,o){this.Nom=t,this.Icone=e,this.Url=o};t.ApplicationResult=p})((e=t.Services||(t.Services={})).Lisa||(e.Lisa={}))}(MyWay||(MyWay={})),function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var e,o;e=t.Services||(t.Services={}),o=function(){function o(){}return o.setImplementation=function(t){o.implementation=t},Object.defineProperty(o.prototype,"StepInfo",{get:function(){return o.implementation.StepInfo},enumerable:!0,configurable:!0}),o.prototype.Next=function(t){return o.implementation.Next(t)},o.prototype.AddToContext=function(t,e){return o.implementation.AddToContext(t,e)},o.prototype.GetFromContext=function(t){return o.implementation.GetFromContext(t)},o.prototype.LireFichier=function(t){return o.implementation.LireFichier(t)},o.prototype.Previous=function(){return o.implementation.Previous()},o.CLASS_NAME="MyWay.Services.RouteurAgent",o.logger=e.Loggers.LoggerFactory.INSTANCE.getClass(o.CLASS_NAME),o}(),e.RouteurAgent=o}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-lisa-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t;(t=e.Services||(e.Services={})).Core.defineProperty(t.TechAgentExtended,"TraceSuiviTechAgent",{get:function(){return this._techLibrary.TraceSuiviTechAgent}})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Core.defineProperty(t.TechAgent,"TraceSuiviTechAgent",{get:function(){return this._techLibrary.TraceSuiviTechAgent}})}(MyWay||(MyWay={})),function(e){(e.Services||(e.Services={})).TechLibrary.addInitListener(function(e,t){e.TraceSuiviTechAgent=t.TraceSuivi})}(MyWay||(MyWay={})),function(e){var t,r,n;t=e.Services||(e.Services={}),r=t.TraceSuivi||(t.TraceSuivi={}),n=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.forcerTrace=function(e){return this.sendMessage(r.Messages.TraceSuiviMessageSubject.SendTraceSuiviForcee,{trace:e})},t}(r.TraceSuiviAgent),r.TraceSuiviTechAgent=n,t.Components.RegistryAgent.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-suivi-tech-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){var r,o,n;r=e.Services||(e.Services={}),o=r.Preferences||(r.Preferences={}),n=function(c){function e(){return c.call(this,r.Components.ComponentType.Preferences)||this}return __extends(e,c),e.prototype.reception=function(e){switch(e.subject){case o.PreferencesMessageSubject.LirePreference:var r=(s=e.message).nomVariable,n=s.isChargerServeur;return this.managerInstance.LirePreference(r,n).then(function(e){return{valeurVariable:e}});case o.PreferencesMessageSubject.EcrirePreference:var t=(s=e.message).preferences;return this.managerInstance.EcrirePreference(t);case o.PreferencesMessageSubject.LireMultiPreference:var s,a=(s=e.message).codesPreference;return this.managerInstance.LireMultiPreference(a);default:return c.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Preferences.PreferencesManagerMessage",e.logger=r.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(r.Components.ComponentManagerMessageBase),o.PreferencesManagerMessage=n,r.Components.RegistryManagerMessage.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-preferences-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(n){var o,d,e;o=n.Services||(n.Services={}),d=o.Aide||(o.Aide={}),e=function(s){function f(){var e=s.call(this,o.Components.ComponentType.Aide)||this;return e.ClePreferenceModaleAide="AideModalePush",e._listeCodesEtapesVues=[],e}return __extends(f,s),f.prototype.init=function(e,t,r,n){return this.api=n,s.prototype.init.call(this,e,t,r,n)},f.prototype.displayAideFlash=function(n){var s=this;if(n){if(!n.dateTraitement){var e=new Date(Date.now()),t=e.getDate().toString();t[1]||(t="0"+t[0]);var r=(e.getMonth()+1).toString();r[1]||(r="0"+r[0]);var o=e.getFullYear().toString();n.dateTraitement=o+"-"+r+"-"+t}if(!n.codeEtablissement){var i=this.library.Context.GetAuthentificationInfo();i&&(n.codeEtablissement=i.codeEtablissement)}this.api.GetAideFlash(n).then(function(r){r&&s.lireEtapesDansPreference(function(e){if(e){var t={codeEtape:n.codeEtape,idFlashCode:r.id};s._listeCodesEtapesVues&&null!=s.aidePrefExist(t,s._listeCodesEtapesVues)&&(r=null)}r&&s.library.Display.AfficherModalAide(r.titre,r.contenu,n.codeEtape,r.id)}),f.logger.debug("GetAideFlash success")},function(e){f.logger.error("GetAideFlash Failed - %1",JSON.stringify(e))}),f.logger.debug("DisplayAideFlash success")}else f.logger.error("DisplayAideFlash error : le paramètre params est null ou undefined")},f.prototype.lireEtapesDansPreference=function(t){var r=this;this.library.Preferences.LirePreference(this.ClePreferenceModaleAide).then(function(e){if(e)try{f.logger.debug("LirePreference success - %1",e),r._listeCodesEtapesVues=JSON.parse(e)}catch(e){return f.logger.error("LirePreference : JSON parse of the result Failed - %1",e),void t(!1)}t(!0)},function(){f.logger.error("LirePreference Failed - ClePreferenceModaleAide : %1",r.ClePreferenceModaleAide),t&&t(!1)})},f.prototype.ajouterEtapeDansPreference=function(r){var n=this;this.lireEtapesDansPreference(function(e){if(e){if(n._listeCodesEtapesVues){if(null!=n.aidePrefExist(r,n._listeCodesEtapesVues))return}else n._listeCodesEtapesVues=[];null!=n.aidePrefExistForOnlyCodeEtape(r,n._listeCodesEtapesVues)&&o.CoreCommon.ArrayUtils.remove(n._listeCodesEtapesVues,function(e){return e.codeEtape===r.codeEtape}),n._listeCodesEtapesVues.push(r);var t=[{cle:n.ClePreferenceModaleAide,valeur:JSON.stringify(n._listeCodesEtapesVues)}];n.library.Preferences.EcrirePreference(t),f.logger.debug("AjouterEtapeDansPreference success")}})},f.prototype.aidePrefExistForOnlyCodeEtape=function(e,t){var r=[];return r.push({Key:d.CODE_ETAPE_KEY,Value:e.codeEtape}),n.Services.CoreCommon.ObjectUtils.objectExistsByKeyValueList(r,t)},f.prototype.aidePrefExist=function(e,t){var r=[];return r.push({Key:d.CODE_ETAPE_KEY,Value:e.codeEtape}),r.push({Key:d.ID_FLASH_CODE_KEY,Value:e.idFlashCode}),n.Services.CoreCommon.ObjectUtils.objectExistsByKeyValueList(r,t)},f.prototype.GetContenuInfobulle=function(e){var r=this;return this.api.GetContenuInfobulle(e).then(function(e){return e?(t=new d.DetailInfobulleAfficheeResult(e.nomChamp,e.nouveaute,r.ValoriserMessage(e.token,e.contenu),e.image),f.logger.debug("GetContenuInfobulle success- %1",JSON.stringify(t)),t):null;var t},function(e){throw f.logger.error("GetContenuInfobulle Failed - %1",JSON.stringify(e)),e})},f.prototype.GetInfobullesAffichables=function(e){var s=this;return this.api.GetInfobullesAffichables(e).then(function(e){if(!e)return null;var t=new Array,r=new Array;r=e;for(var n=0;n<r.length;n++)t.push(new d.InfobulleAfficheeResult(r[n].nomChamp,s.DeterminerNouveaute(r[n].dateFinNouveaute,r[n].nouveaute)));return f.logger.debug("GetInfobullesAffichables success- %1",JSON.stringify(t)),t},function(e){throw f.logger.error("GetInfobullesAffichables Failed - %1",JSON.stringify(e)),e})},f.prototype.getParametresContexte=function(e,t,r,n){var s;s=new d.DetailInfobulleAfficheeParametres;var o,i=new Date,a=("0"+i.getUTCDate()).slice(-2),l=("0"+(i.getMonth()+1)).slice(-2),u=i.getUTCFullYear().toString();if(s.dateTraitement=u+"-"+l+"-"+a,s.idChampLie=null!=e?e:"",null!=(o=this.library.Context.GetAuthentificationInfo())?s.codeEtablissement=o.codeEtablissement:(s.codeEtablissement=null,f.logger.debug("code Etablissement non récupéré à partir de GetAuthentificationInfo() => valorisé à null")),s.codeEtape=null,!(s.pointEntree=null)===t)return s.codeProcessus=null,s;if(null!=r)return s.codeProcessus=r,null!=n&&(s.codeEtape=n),s;if(s.codeProcessus=this.library.Context.GetCurrentProcessCode(),void 0===s.codeProcessus)s.codeProcessus=null;else if(null!==s.codeProcessus){var c=this.library.Context.GetCurrentStep(this.library.Context.GetCurrentProcess());null!=c&&(s.codeEtape=c.codeEtape)}return s},f.prototype.ValoriserMessage=function(e,t){var r=t;return e&&(r=this.RemplacerTokens(t)),r},f.prototype.RemplacerTokens=function(e){var t=e;if(null!=e){for(var r=new Array,n=0,s="";0<=n;)if(t.length>=n+s.length&&(n=t.indexOf(f.INDICATEUR_DE_TOKEN,n+s.length)),0<=n)if(0<=t.indexOf(f.INDICATEUR_DE_TOKEN,n+f.INDICATEUR_DE_TOKEN.length)){var o="";null!=(s=t.substr(n,t.indexOf(f.INDICATEUR_DE_TOKEN,n+f.INDICATEUR_DE_TOKEN.length)+f.INDICATEUR_DE_TOKEN.length-n))&&(o=s.substr(f.INDICATEUR_DE_TOKEN.length,s.length-2*f.INDICATEUR_DE_TOKEN.length)),r.indexOf(o)<0&&r.push(o)}else n=-1;if(0<r.length)for(var i=this.library.Context.GetListFromContext(r),a=0;a<i.length;a++)t=t.replace(new RegExp(f.INDICATEUR_DE_TOKEN+i[a].Key+f.INDICATEUR_DE_TOKEN,"g"),i[a].Value)}return f.logger.debug("RemplacerTokens Success: %1",t),t},f.prototype.DeterminerNouveaute=function(e,t){var r=t;if(null!=e&&10==e.length&&!isNaN(Number(e.substr(6,4)))&&!isNaN(Number(e.substr(3,2)))&&!isNaN(Number(e.substr(0,2)))){var n,s=new Date,o=("0"+(s.getMonth()+1)).slice(-2),i=("0"+s.getUTCDate()).slice(-2),a=s.getUTCFullYear().toString()+o+i;n=e.substr(6,4)+e.substr(3,2)+e.substr(0,2),r=!0===t&&!(n<a)}return f.logger.debug("DeterminerNouveaute Success : %1",r),r},f.INDICATEUR_DE_TOKEN="##",f.CLASS_NAME="MyWay.Services.Aide.AideManager",f.logger=o.Loggers.LoggerFactory.INSTANCE.getClass(f.CLASS_NAME),f}(o.Components.ComponentManagerBase),d.AideManager=e,o.Components.RegistryManager.getInstance().register(e)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-aide-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){var r;(r=e.Services||(e.Services={})).Bug||(r.Bug={})}(MyWay||(MyWay={})),function(e){var n,r,t;n=e.Services||(e.Services={}),r=n.Preferences||(n.Preferences={}),t=function(e){function r(){return e.call(this,n.Components.ComponentType.Preferences)||this}return __extends(r,e),r.prototype.LirePreference=function(e,r){return this.manager.LirePreference(e,r)},r.prototype.EcrirePreference=function(e,r){var n=[{cle:e,valeur:r}];return this.manager.EcrirePreference(n)},r.prototype.lireMultiPreference=function(e){return this.manager.LireMultiPreference(e).then(function(e){return e.preferences})},r.prototype.ecrireMultiPreference=function(e){return this.manager.EcrirePreference(e)},r}(n.Components.ComponentManagerExtendedBase),r.PreferencesManagerExtended=t,n.Components.RegistryManagerExtended.getInstance().register(t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-preferences-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,c,n;t=e.Services||(e.Services={}),c=t.Libelle||(t.Libelle={}),n=function(i){function a(){return i.call(this,t.Components.ComponentType.Libelle)||this}return __extends(a,i),a.prototype.constituerLibelle=function(e,t){return this.managerInstance.constituerLibelle(e,t)},a.prototype.reception=function(e){switch(e.subject){case c.LibelleMessageSubject.afficherMessage:var t=(o=e.message).codeLibelle,n=o.typeAffichage,r=o.valeurs,s=o.delai;return this.managerInstance.afficherMessageAsync(t,n,r,s).then(function(e){return a.logger.debug("afficherMessage Success : %1",JSON.stringify(e)),e});case c.LibelleMessageSubject.constituerLibelle:var o;return t=(o=e.message).codeLibelle,r=o.valeurs,this.managerInstance.constituerLibelle(t,r).then(function(e){return a.logger.debug("constituerLibelle Success : %1",e),e}).catch(function(e){throw a.logger.error("constituerLibelle Failed : %1",JSON.stringify(e)),e});default:return i.prototype.reception.call(this,e)}},a.CLASS_NAME="MyWay.Services.Libelle.LibelleManagerMessage",a.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(a.CLASS_NAME),a}(t.Components.ComponentManagerMessageBase),c.LibelleManagerMessage=n,t.Components.RegistryManagerMessage.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-libelle-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}o(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();!function(e){var _,s,r;_=e.Services||(e.Services={}),s=_.Fichier||(_.Fichier={}),r=function(n){function E(){var e=n.call(this,_.Components.ComponentType.Fichier)||this;return e.api=null,e}return __extends(E,n),E.prototype.init=function(e,r,t,o){return this.api=o,n.prototype.init.call(this,e,r,t,o)},E.prototype.saveAs=function(e,r,t,o){var n=this;if(void 0===o&&(o=s.TYPE_DONNEES_A_SAUVER.BLOB),null==e){var i=new _.Erreur(_.Libelle.LibelleModel.COM.ERREUR_FICHIER_PARAMETRE_DATA_VIDE);return _.Loggers.FLASH.INSTANCE.setValue("action","saveAs"),this.library.Libelle.constituerLibelle(i.codeLibelle).then(function(e){E.logger.error(e)}),_.Promesses.createPromiseSelfError(i)}var a=e;return _.Promesses.getPromesseSelfResoved().then(function(){return!o||o!==s.TYPE_DONNEES_A_SAUVER.BASE64||n.b64toBlob(e,null,null).then(function(e){return a=e,!0})}).then(function(e){if(e)return n.api.save(a,n.getFormatFichier(r),t)})},E.prototype.b64toBlob=function(e,r,t){if(void 0===r&&(r=null),void 0===t&&(t=null),!_.Controle.StaticStringControle.isStringNotEmptyOrNull(e)){var o=new _.Erreur(_.Libelle.LibelleModel.COM.ERREUR_FICHIER_PARAMETRE_B64_VIDE);return _.Loggers.FLASH.INSTANCE.setValue("action","saveAsb64toBlob"),this.library.Libelle.constituerLibelle(o.codeLibelle).then(function(e){E.logger.error(e)}),_.Promesses.createPromiseSelfError(o)}null===r&&(r="application/pdf"),null===t&&(t=512);for(var n=atob(e),i=[],a=0;a<n.length;a+=t){for(var s=n.slice(a,a+t),l=new Array(s.length),c=0;c<s.length;c++)l[c]=s.charCodeAt(c);i.push(new Uint8Array(l))}return _.Promesses.createPromiseSelfResolved(new Blob(i,{type:r}))},E.prototype.getFormatFichier=function(e){var r;switch(e){case s.TYPE_FICHIER.PDF:case s.TYPE_FICHIER.PDF_EMBED:case s.TYPE_FICHIER.PDFA_1A:case s.TYPE_FICHIER.PDFA_1B:case s.TYPE_FICHIER.PDFX_1_2001:case s.TYPE_FICHIER.PDFX_1A_2001:case s.TYPE_FICHIER.PDFX_1A_2003:case s.TYPE_FICHIER.PDFX_3_2002:case s.TYPE_FICHIER.PDFX_3_2003:r="application/pdf";break;case s.TYPE_FICHIER.JSON:r="application/json";break;case s.TYPE_FICHIER.TAR_GZ:r="application/x-compressed";break;default:r="application/pdf"}return r},E.CLASS_NAME="MyWay.Services.Fichier.FichierManager",E.logger=_.Loggers.LoggerFactory.INSTANCE.getClass(E.CLASS_NAME),E}(_.Components.ComponentManagerBase),s.FichierManager=r,_.Components.RegistryManager.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-fichier-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();!function(e){var r;(r=e.Services||(e.Services={})).Bug||(r.Bug={})}(MyWay||(MyWay={})),function(e){var r,n,t;r=e.Services||(e.Services={}),n=r.DonneesDelocalisees||(r.DonneesDelocalisees={}),t=function(){function r(){}return r.actionOnDB=function(t){var e=window.indexedDB.open("myway_stc_donneesdelocalisees",r.DB_VERSION);e.onupgradeneeded=function(e){var r=e.target.result;switch(e.oldVersion){case 0:r.createObjectStore(n.DonneesDelocaliseesTDTDB.TABLE_NOM,{autoIncrement:!1,keyPath:"id"}),r.createObjectStore(n.DonneesDelocaliseesTableDB.TABLE_NOM,{autoIncrement:!1,keyPath:"id"})}},e.onsuccess=function(e){var r=e.target.result;t(r)}},r.DB_VERSION=1,r.DB_NAME="myway_stc_donneesdelocalisees",r}(),n.DBDonneesDelocs=t}(MyWay||(MyWay={})),function(e){var u;(function(l){var i,a;u.ServiceManager.addActionOnInitialize("DonneesDelocalisees.openIDBAndGetDistantTDTAndCloseIDB",function(e){return e.DonneesDelocalisees.openIDBAndGetDistantTDTAndCloseIDB(null).then(function(){u.Loggers.FLASH.INSTANCE.setValue("action","Initialize()"),u.ServiceManager.logger.debug("Pré-chargement TDT OK!")},function(e){u.Loggers.FLASH.INSTANCE.setValue("action","Initialize()"),u.Loggers.FLASH.INSTANCE.setValue("details",e),u.ServiceManager.logger.warn("Impossible de pré-charger la TDT: %1 / %2",e.codeLibelle,e.valeurs)})},"Habilitation.ObtenirHabilitations");var e=function(s){function c(){var e=s.call(this,u.Components.ComponentType.DonneesDelocalisees)||this;return e.api=null,e.dbTDT=null,e.dbTable=null,e}return __extends(c,s),c.prototype.init=function(e,r,t,n){var o=this;return this.api=n,i=u.PrivatePortalServiceParameters.Instance().DonneesDelocaliseesUrl+"tableDesTables",a=u.PrivatePortalServiceParameters.Instance().DonneesDelocaliseesUrl+"objetDelocalise",s.prototype.init.call(this,e,r,t,n).then(function(){return u.BaseDeDonnees.Generique.Factory.testImplementationIndexeddb(!0).then(function(e){o.dbTDT=new l.DonneesDelocaliseesTDTDB(e,o.library),o.dbTable=new l.DonneesDelocaliseesTableDB(e,o.library);var r={version:l.DBDonneesDelocs.DB_VERSION,implementation:e?u.BaseDeDonnees.BaseDeDonneesImplementation.INDEXEDDB:u.BaseDeDonnees.BaseDeDonneesImplementation.MEMORY,getTable:function(e){switch(e){case l.DonneesDelocaliseesTDTDB.TABLE_NOM:return o.dbTDT;case l.DonneesDelocaliseesTableDB.TABLE_NOM:return o.dbTable;default:return null}},getTables:function(){return[l.DonneesDelocaliseesTDTDB.TABLE_NOM,l.DonneesDelocaliseesTableDB.TABLE_NOM]}};o.library.BaseDeDonnees.enregistrerDB("DonneesDelocalisees",r)})})},c.prototype.getDonneesDelocalisees=function(e,r){var t=u.CoreCommon.ServiceDePromesse.defer(),n="";return u.Controle.StaticStringControle.isStringNotEmptyOrNull(e)||(n+="Le paramètre 'numEtablissement' doit être une chaine de caractères non vide ou null / "),u.Controle.StaticStringControle.isStringNotEmpty(r)||(n+="Le paramètre 'objectDataName' est obligatoire et doit être une chaine de caractères non vide / "),""!=n?(n=n.substring(0,n.lastIndexOf("/")-1),u.Loggers.FLASH.INSTANCE.setValue("action","getDonneesDelocalisees"),c.logger.error(n),t.reject(new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[n]))):null===e&&null===(e=this._getCodeEtablissement(t.reject))||(u.Loggers.FLASH.INSTANCE.setValue("action","getDonneesDelocalisees"),c.logger.debug("Début récupération '%1' (%2) avec support DB",r,e),this.getDonneesDelocaliseesIDB(e,r).then(function(e){u.Loggers.FLASH.INSTANCE.setValue("action","getDonneesDelocalisees"),c.logger.debug("Fin récupération objet '%1' OK",e.id),t.resolve(e)},function(e){u.Loggers.FLASH.INSTANCE.setValue("action","getDonneesDelocalisees"),c.logger.debug("Fin récupération objet KO: %1",e.libelle),t.reject(e)})),t.promise},c.prototype.getListeDonneesDelocalisees=function(t,e){var n=this,o=u.CoreCommon.ServiceDePromesse.defer(),r="";if(u.Controle.StaticStringControle.isStringNotEmptyOrNull(t)||(r+="Le paramètre 'numEtablissement' doit être une chaine de caractères non vide ou null / "),u.Controle.StaticArrayControle.isArray(e)||(r+="Le paramètre 'objectDataNames' est obligatoire et doit être un tableau d'objets de type String / "),""!=r)return r=r.substring(0,r.lastIndexOf("/")-1),u.Loggers.FLASH.INSTANCE.setValue("action","getListeDonneesDelocalisees"),c.logger.error(r),o.reject(new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[r])),o.promise;if(null===t&&null===(t=this._getCodeEtablissement(o.reject)))return o.promise;var s=!1,i=e.length,a=[],l=0;return e.forEach(function(e,r){n.getDonneesDelocalisees(t,e).then(function(e){a[r]=e,++l===i&&o.resolve(a)},function(e){s||(s=!0,o.reject(e))})}),o.promise},c.prototype.getRubriqueLibelle=function(e,s,i){var a=u.CoreCommon.ServiceDePromesse.defer(),r="";return u.Controle.StaticStringControle.isStringNotEmptyOrNull(e)||(r+="Le paramètre 'numEtablissement' doit être une chaine de caractères non vide ou null / "),u.Controle.StaticStringControle.isStringNotEmpty(s)||(r+="Le paramètre 'objectDataName' est obligatoire et doit être une chaine de caractères non vide / "),u.Controle.StaticStringControle.isStringNotEmpty(i)||(r+="Le paramètre 'code' est obligatoire et doit être une chaine de caractères non vide / "),""!=r?(r=r.substring(0,r.lastIndexOf("/")-1),u.Loggers.FLASH.INSTANCE.setValue("action","getRubriqueLibelle"),c.logger.error(r),a.reject(new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[r]))):null===e&&null===(e=this._getCodeEtablissement(a.reject))||this.getDonneesDelocalisees(e,s).then(function(e){if("rubrique"===e.referentiel){u.Loggers.FLASH.INSTANCE.setValue("action","getRubriqueLibelle"),c.logger.debug("L'objet de données '%1' est bien une rubrique",s);for(var r=e.donnees.length,t=null,n=0;n<r;n++)if(e.donnees[n].Key===i){t=e.donnees[n].Value;break}if(t)u.Loggers.FLASH.INSTANCE.setValue("action","getRubriqueLibelle"),c.logger.debug("Récupération du libellé du code '%1' : '%2'",i,t),a.resolve(t);else{u.Loggers.FLASH.INSTANCE.setValue("action","getRubriqueLibelle");var o="Le code '"+i+"' n'a pas été trouvé dans la rubrique '"+s+"'";c.logger.error(o),a.reject(new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[o]))}}else u.Loggers.FLASH.INSTANCE.setValue("action","getRubriqueLibelle"),o="L'objet de données '"+s+"' n'est pas une rubrique",c.logger.error(o),a.reject(new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[o]))},function(e){u.Loggers.FLASH.INSTANCE.setValue("action","getRubriqueLibelle"),c.logger.error("Erreur lors de la récupération de la rubrique '%1'",s),a.reject(e)}),a.promise},c.prototype.getDonneesParCriteres=function(r,s,i){var t=u.CoreCommon.ServiceDePromesse.defer(),e="";return u.Controle.StaticStringControle.isStringNotEmptyOrNull(r)||(e+="Le paramètre 'numEtablissement' doit être une chaine de caractères non vide ou null / "),u.Controle.StaticStringControle.isStringNotEmpty(s)||(e+="Le paramètre 'objectDataName' est obligatoire et doit être une chaine de caractères non vide / "),u.Controle.StaticArrayControle.isArray(i)||(e+="Le paramètre 'criteres' est obligatoire et doit être un tableau d'objets de type ObjectDataCritere / "),""!=e?(e=e.substring(0,e.lastIndexOf("/")-1),u.Loggers.FLASH.INSTANCE.setValue("action","getDonneesParCriteres"),c.logger.error(e),t.reject(new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[e]))):null===r&&null===(r=this._getCodeEtablissement(t.reject))||this.getDonneesDelocalisees(r,s).then(function(e){try{var o=[],r=u.Donnees.StaticArrayExtension.filtrer(e.donnees,function(t){var n=!0;return i.forEach(function(e){if(!t.hasOwnProperty(e.propriete)){var r="L'objet de données ne contient pas la propriété '"+e.propriete+"' de la table "+s;return u.Loggers.FLASH.INSTANCE.setValue("action","getDonneesParCriteres"),c.logger.error(r),o.push(e.propriete),n=null,!1}switch(e.operateur){case l.CRITERES_OPERATEUR.CONTIENT:-1===t[e.propriete].indexOf(e.valeur)&&(n=!1);break;default:t[e.propriete]!==e.valeur&&(n=!1)}if(!n)return!1}),n});u.Controle.StaticArrayControle.isArray(r)?t.resolve(r):t.reject(new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_DONNEESDELOC_PROPRIETE_ABSENTE,o))}catch(e){t.reject(new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_DONNEESDELOC_OBJET_MAL_FORME,[e]))}},function(e){u.Loggers.FLASH.INSTANCE.setValue("action","getDonneesParCriteres"),c.logger.error("Erreur lors de la récupération de l'objet de données '%1' pour l'établissement '%2'",s,r),t.reject(e)}),t.promise},c.prototype.openIDBAndGetDistantTDTAndCloseIDB=function(e){var r=u.CoreCommon.ServiceDePromesse.defer(),t="";return u.Controle.StaticStringControle.isStringNotEmptyOrNull(e)||(t+="Le paramètre 'numEtablissement' doit être une chaine de caractères non vide ou null / "),""!=t?(t=t.substring(0,t.lastIndexOf("/")-1),u.Loggers.FLASH.INSTANCE.setValue("action","openIDBAndGetDistantTDTAndCloseIDB"),c.logger.error(t),r.reject(new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[t]))):null===e&&null===(e=this._getCodeEtablissement(r.reject))||(u.Loggers.FLASH.INSTANCE.setValue("action","openIDBAndGetDistantTDTAndCloseIDB"),c.logger.debug("Le navigateur supporte IndexedDB"),u.Loggers.FLASH.INSTANCE.setValue("action","openIDBAndGetDistantTDTAndCloseIDB"),c.logger.debug("Début récupération TDT (%1) avec support IndexedDB",e),this.getTDTIDB(e).then(r.resolve,r.reject)),r.promise},c.prototype._getCodeEtablissement=function(e){var r=null,t=this.library.Context.GetAuthentificationInfo();if(t&&(r=t.codeEtablissement),u.Controle.StaticStringControle.isStringNotEmpty(r))return r;var n=new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_CONTEXTE_RECUP_CODE_ETAB_IMPOSSIBLE);return u.Loggers.FLASH.INSTANCE.setValue("action","_getCodeEtablissement"),this.library.Libelle.constituerLibelle(n.codeLibelle).then(function(e){c.logger.error(e)}),e(n),null},c.prototype.getDonneesDelocaliseesIDB=function(t,n){var o=this,s=u.CoreCommon.ServiceDePromesse.defer();return this.getTDTIDB(t).then(function(e){var r=o.getRefData(e,n);r?(u.Loggers.FLASH.INSTANCE.setValue("action","getDonneesDelocaliseesIDB"),c.logger.debug("Date de dernière mise à jour de l'objet de données '%1' dans la TDT '%2': %3",n,t,r.datemaj),o.getObjectDataIDB(t,r).then(function(e){s.resolve(e)},function(e){s.reject(e)})):(u.Loggers.FLASH.INSTANCE.setValue("action","getDonneesDelocaliseesIDB"),c.logger.error("Impossible de récupérer la date de dernière mise à jour de l'objet de données '%1' dans la TDT '%2'",n,t),s.reject(new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_DONNEESDELOC_RECUP_DERNMAJ_IMPOSSIBLE,[n,t])))},s.reject),s.promise},c.prototype.getTDTIDB=function(o){var s=this;return this.dbTDT.get([o]).then(function(e){var r,t=s.library.Dates.getDateDuJour(u.Dates.FORMATS_DATE.aaaammjj);if(e[0]){var n=e[0].element;return r=n.datemaj,u.Loggers.FLASH.INSTANCE.setValue("action","getTDTIDB"),c.logger.debug("Date de dernière mise à jour de la TDT '%1': %2",o,r),r<t?s.getDistantTDT(o):n}return s.getDistantTDT(o)})},c.prototype.getDistantTDT=function(r){var t=this,e={};e.method=u.MethodEnum.GET,e.url=i,e.params={codeEtablissement:r},e.withHeaders=!0;var n=null;return this.api.getDistantTDT(e).then(function(e){return n=e,t.dbTDT.mettreAJour([{cle:n.id,element:n}])}).then(function(){return u.Loggers.FLASH.INSTANCE.setValue("action","getDistantTDT"),c.logger.debug("La TDT '%1' a bien été mise à jour dans le store %2",r,l.DonneesDelocaliseesTDTDB.TABLE_NOM),n}).catch(function(e){if(n)return u.Loggers.FLASH.INSTANCE.setValue("action","getDistantTDT"),c.logger.error("La TDT '%1' n'a pas été mise à jour dans le store %2",r,l.DonneesDelocaliseesTDTDB.TABLE_NOM),n;throw u.Loggers.FLASH.INSTANCE.setValue("action","getDistantTDT"),c.logger.error("Impossible de récupérer la TDT '%1' auprès du serveur distant",r),e})},c.prototype.getObjectDataIDB=function(n,o){var s=this,i=o.referentiel+"-"+o.nom,a=null;return this.dbTable.get([i]).then(function(e){if(e[0]){var r=e[0].element,t=(a=r).datemaj;return u.Loggers.FLASH.INSTANCE.setValue("action","getObjectDataIDB"),c.logger.debug("Date de dernière mise à jour de l'objet de données '%1' dans le store %2: %3",i,l.DonneesDelocaliseesTableDB.TABLE_NOM,t),t<o.datemaj?s.getDistantObjectData(n,o.nom):r}return s.getDistantObjectData(n,o.nom)}).catch(function(e){if("O"===o.utildonneesperimees)return u.Loggers.FLASH.INSTANCE.setValue("action","getObjectDataIDB"),c.logger.error("Impossible de récupérer l'objet de données '%1' mis à jour le '%2' du central. L'objet du store local mis à jour le '%3' sera utilisé",i,o.datemaj,null),a;throw e})},c.prototype.getDistantObjectData=function(e,r){var t=this,n={};n.method=u.MethodEnum.GET,n.url=a,n.params={codeEtablissement:e,nom:r},n.withHeaders=!0;var o=null;return this.api.getDistantObjectData(n).then(function(e){return o=e,t.dbTable.mettreAJour([{cle:e.id,element:e}])}).then(function(){return u.Loggers.FLASH.INSTANCE.setValue("action","getDistantObjectData"),c.logger.debug("L'objet de données '%1' a bien été mis à jour dans le store %2",r,l.DonneesDelocaliseesTableDB.TABLE_NOM),o},function(e){throw u.Loggers.FLASH.INSTANCE.setValue("action","getDistantObjectData"),c.logger.error("L'objet de données '%1' n'a pas été mis à jour dans le store %2",r,l.DonneesDelocaliseesTableDB.TABLE_NOM),e})},c.prototype.getRefData=function(e,r){for(var t=e.tables.length,n=0;n<t;n++)if(e.tables[n].nom===r)return e.tables[n];return null},c.prototype.reInitDbDonneesDelocalisees=function(){var e=this;return this.dbTDT.resetAll().then(function(){return e.dbTable.resetAll()})},c.prototype.getTDTById=function(e){return this.dbTDT.get([e]).then(function(e){return e[0]?e[0].element:null})},c.prototype.deleteTDTById=function(e){return this.dbTDT.supprimer([e])},c.prototype.getEnumCriteresOperateur=function(){var e=u.CoreCommon.ServiceDePromesse.defer();return e.resolve(l.CRITERES_OPERATEUR),e.promise},c.CLASS_NAME="MyWay.Services.DonneesDelocalisees.DonneesDelocaliseesManager",c.logger=u.Loggers.LoggerFactory.INSTANCE.getClass(c.CLASS_NAME),c}(u.Components.ComponentManagerBase);l.DonneesDelocaliseesManager=e,u.Components.RegistryManager.getInstance().register(e)})((u=e.Services||(e.Services={})).DonneesDelocalisees||(u.DonneesDelocalisees={}))}(MyWay||(MyWay={})),function(e){var D,t,r;D=e.Services||(e.Services={}),t=D.DonneesDelocalisees||(D.DonneesDelocalisees={}),r=function(){function u(e,r){this.hasIndexedDb=e,this.library=r,this.memoryDB=[]}return u.prototype.get=function(l){var c=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(a){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var o=r.objectStore(u.TABLE_NOM),s=[],i=function(r){if(r>=l.length)a.resolve(s);else{var t=l[r],n=o.get(t);n.onsuccess=function(e){n.result?s.push(c.elementToInstanceAvecCle(n.result)):(s.push(null),console.warn("Table "+t+" isn't found!")),i(r+1)},n.onerror=function(e){console.error(e),a.reject(new D.Erreur("Erreur lors de la récupération d'une Table de la base de données - Moment de la lecture"))}}};i(0)})});var e=[];return this.memoryDB.forEach(function(r){var t=null;l.every(function(e){return e===r.id&&(t=r),null===t}),e.push(c.elementToInstanceAvecCle(t))}),this.library.Core.createPromiseSelfResolved(e)},u.prototype.getAll=function(){var s=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(o){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(u.TABLE_NOM).openCursor(),n=[];t.onsuccess=function(e){var r=e.target.result;if(r){var t=r.value;n.push(s.elementToInstanceAvecCle(t)),r.continue()}else o.resolve(n)},t.onerror=function(e){console.error(e),o.reject(new D.Erreur("Erreur lors de la récupération de l'ensemble des Table"))}})});var r=[];return this.memoryDB.forEach(function(e){r.push(s.elementToInstanceAvecCle(e))}),this.library.Core.createPromiseSelfResolved(r)},u.prototype.chercher=function(s){var i=this;if(!s)return this.getAll();if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(o){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(u.TABLE_NOM).openCursor(),n=[];t.onsuccess=function(e){var r=e.target.result;if(r){var t=r.value;i.testTable(t,s)&&n.push(i.elementToInstanceAvecCle(t)),r.continue()}else o.resolve(n)},t.onerror=function(e){console.error(e),o.reject(new D.Erreur("Erreur lors de la recherche de Table"))}})});var r=[];return this.memoryDB.forEach(function(e){i.testTable(e,s)&&r.push(i.elementToInstanceAvecCle(e))}),this.library.Core.createPromiseSelfResolved(r)},u.prototype.count=function(e){return e||!this.hasIndexedDb?this.chercher(e).then(function(e){return e.length}):this.library.Core.promesseTryCatch(function(n){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(u.TABLE_NOM).count();t.onsuccess=function(){var e=t.result;n.resolve(e)},t.onerror=function(e){console.error(e),n.reject(new D.Erreur("Erreur lors du comptage du nombre de Table"))}})})},u.prototype.ajouter=function(i){var r=this;return this.hasIndexedDb?this.library.Core.promesseTryCatch(function(s){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var n=r.objectStore(u.TABLE_NOM),o=function(e){if(e>=i.length)s.resolve();else{var r=i[e],t=n.add(r);t.onsuccess=function(){o(e+1)},t.onerror=function(e){console.error(e),s.reject(new D.Erreur("Erreur lors de la sauvegarde d'une Table"))}}};o(0)})}):(i.forEach(function(e){r.memoryDB.push(e)}),this.library.Core.getPromesseSelfResoved())},u.prototype.supprimer=function(i){if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(s){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var n=r.objectStore(u.TABLE_NOM),o=function(r){if(r>=i.length)s.resolve();else{var e=i[r],t=n.delete(e);t.onsuccess=function(){o(r+1)},t.onerror=function(e){o(r+1)}}};o(0)})});var e=[];return this.memoryDB.forEach(function(r){var t=!1;i.every(function(e){return!(t=e===r.id)}),t||e.push(r)}),this.memoryDB=e,this.library.Core.getPromesseSelfResoved()},u.prototype.mettreAJour=function(i){var o=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(s){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var n=r.objectStore(u.TABLE_NOM),o=function(e){if(e>=i.length)s.resolve();else{var r=i[e],t=n.put(r.element);t.onsuccess=function(){o(e+1)},t.onerror=function(e){console.error(e),s.reject(new D.Erreur("Erreur lors de la mise à jour d'une Table"))}}};o(0)})});var e=[];return i.forEach(function(t){var n=!1;o.memoryDB.every(function(e,r){return t.cle===e.id&&(o.memoryDB[r]=t.element,n=!0),!n}),n||e.push(t.element)}),0<e.length?this.ajouter(e):this.library.Core.getPromesseSelfResoved()},u.prototype.resetAll=function(){return this.hasIndexedDb?this.library.Core.promesseTryCatch(function(n){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(u.TABLE_NOM).clear();t.onsuccess=function(e){n.resolve()},t.onerror=function(e){console.error(e),n.reject(new D.Erreur("Erreur lors du reset de la base de données"))}})}):(this.memoryDB.length=0,this.library.Core.getPromesseSelfResoved())},u.prototype.testTable=function(e,r){return!!e.id.match(r)},u.prototype.elementToInstanceAvecCle=function(e){return e?{cle:e.id,element:e}:null},u.TABLE_NOM="TABLES",u}(),t.DonneesDelocaliseesTableDB=r}(MyWay||(MyWay={})),function(e){var D,t,r;D=e.Services||(e.Services={}),t=D.DonneesDelocalisees||(D.DonneesDelocalisees={}),r=function(){function u(e,r){this.hasIndexedDb=e,this.library=r,this.memoryDB=[]}return u.prototype.get=function(l){var c=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(a){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var o=r.objectStore(u.TABLE_NOM),s=[],i=function(r){if(r>=l.length)a.resolve(s);else{var t=l[r],n=o.get(t);n.onsuccess=function(e){n.result?s.push(c.elementToInstanceAvecCle(n.result)):(s.push(null),console.warn("TDT "+t+" isn't found!")),i(r+1)},n.onerror=function(e){console.error(e),a.reject(new D.Erreur("Erreur lors de la récupération d'une table de la base de données - Moment de la lecture"))}}};i(0)})});var e=[];return this.memoryDB.forEach(function(r){var t=null;l.every(function(e){return e===r.id&&(t=r),null===t}),e.push(c.elementToInstanceAvecCle(t))}),this.library.Core.createPromiseSelfResolved(e)},u.prototype.getAll=function(){var s=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(o){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(u.TABLE_NOM).openCursor(),n=[];t.onsuccess=function(e){var r=e.target.result;if(r){var t=r.value;n.push(s.elementToInstanceAvecCle(t)),r.continue()}else o.resolve(n)},t.onerror=function(e){console.error(e),o.reject(new D.Erreur("Erreur lors de la récupération de l'ensemble des tables"))}})});var r=[];return this.memoryDB.forEach(function(e){r.push(s.elementToInstanceAvecCle(e))}),this.library.Core.createPromiseSelfResolved(r)},u.prototype.chercher=function(s){var i=this;if(!s)return this.getAll();if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(o){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(u.TABLE_NOM).openCursor(),n=[];t.onsuccess=function(e){var r=e.target.result;if(r){var t=r.value;i.testTDT(t,s)&&n.push(i.elementToInstanceAvecCle(t)),r.continue()}else o.resolve(n)},t.onerror=function(e){console.error(e),o.reject(new D.Erreur("Erreur lors de la recherche de table"))}})});var r=[];return this.memoryDB.forEach(function(e){i.testTDT(e,s)&&r.push(i.elementToInstanceAvecCle(e))}),this.library.Core.createPromiseSelfResolved(r)},u.prototype.count=function(e){return e||!this.hasIndexedDb?this.chercher(e).then(function(e){return e.length}):this.library.Core.promesseTryCatch(function(n){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(u.TABLE_NOM).count();t.onsuccess=function(){var e=t.result;n.resolve(e)},t.onerror=function(e){console.error(e),n.reject(new D.Erreur("Erreur lors du comptage du nombre de table"))}})})},u.prototype.ajouter=function(i){var r=this;return this.hasIndexedDb?this.library.Core.promesseTryCatch(function(s){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var n=r.objectStore(u.TABLE_NOM),o=function(e){if(e>=i.length)s.resolve();else{var r=i[e],t=n.add(r);t.onsuccess=function(){o(e+1)},t.onerror=function(e){console.error(e),s.reject(new D.Erreur("Erreur lors de la sauvegarde d'une table"))}}};o(0)})}):(i.forEach(function(e){r.memoryDB.push(e)}),this.library.Core.getPromesseSelfResoved())},u.prototype.supprimer=function(i){if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(s){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var n=r.objectStore(u.TABLE_NOM),o=function(r){if(r>=i.length)s.resolve();else{var e=i[r],t=n.delete(e);t.onsuccess=function(){o(r+1)},t.onerror=function(e){o(r+1)}}};o(0)})});var e=[];return this.memoryDB.forEach(function(r){var t=!1;i.every(function(e){return!(t=e===r.id)}),t||e.push(r)}),this.memoryDB=e,this.library.Core.getPromesseSelfResoved()},u.prototype.mettreAJour=function(i){var o=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(s){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var n=r.objectStore(u.TABLE_NOM),o=function(e){if(e>=i.length)s.resolve();else{var r=i[e],t=n.put(r.element);t.onsuccess=function(){o(e+1)},t.onerror=function(e){console.error(e),s.reject(new D.Erreur("Erreur lors de la mise à jour d'une table"))}}};o(0)})});var e=[];return i.forEach(function(t){var n=!1;o.memoryDB.every(function(e,r){return t.cle===e.id&&(o.memoryDB[r]=t.element,n=!0),!n}),n||e.push(t.element)}),0<e.length?this.ajouter(e):this.library.Core.getPromesseSelfResoved()},u.prototype.resetAll=function(){return this.hasIndexedDb?this.library.Core.promesseTryCatch(function(n){t.DBDonneesDelocs.actionOnDB(function(e){var r=e.transaction([u.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(u.TABLE_NOM).clear();t.onsuccess=function(e){n.resolve()},t.onerror=function(e){console.error(e),n.reject(new D.Erreur("Erreur lors du reset de la base de données"))}})}):(this.memoryDB.length=0,this.library.Core.getPromesseSelfResoved())},u.prototype.testTDT=function(e,r){return!!e.id.match(r)},u.prototype.elementToInstanceAvecCle=function(e){return e?{cle:e.id,element:e}:null},u.TABLE_NOM="TDT",u}(),t.DonneesDelocaliseesTDTDB=r}(MyWay||(MyWay={})),function(e){var r;(r=e.Services||(e.Services={})).Bug||(r.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-donnees-delocalisees-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(t){var r,e,o;r=t.Services||(t.Services={}),e=r.Mobilite||(r.Mobilite={}),o=function(){function e(){this.libraryManager=null}return e.prototype.initApi=function(e){this.libraryManager=e},e.prototype.estConnecte=function(){return navigator&&void 0!==navigator.onLine?navigator.onLine?r.Promesses.createPromiseSelfResolved(!0):r.Promesses.createPromiseSelfResolved(!1):r.Promesses.createPromiseSelfError(new r.Erreur(t.Services.Libelle.LibelleModel.COM.ERREUR_MOBILITE_RECUP_RESEAU_IMPOSSIBLE))},e.prototype.estEcranTactile=function(){return"onstarttouch"in window||0<navigator.maxTouchPoints||0<navigator.msMaxTouchPoints?r.Promesses.createPromiseSelfResolved(!0):r.Promesses.createPromiseSelfResolved(!1)},e.prototype.listePeripheriques=function(){return r.Promesses.createPromiseSelfResolved([])},e.prototype.listeTablettesSignatures=function(e){return r.Promesses.createPromiseSelfResolved([])},e.prototype.getPlagesReseau=function(){return this.libraryManager.ConfigurationPoste.getConfigurationPoste()},e}(),e.MobiliteApiBase=o}(MyWay||(MyWay={})),function(e){var t,i,r;t=e.Services||(e.Services={}),i=t.Mobilite||(t.Mobilite={}),r=function(n){function e(){var e=n.call(this,t.Components.ComponentType.Mobilite)||this;return e.wrapped=null,e}return __extends(e,n),e.prototype.init=function(e,t,r){var o=this;return e.ServiceLocal?e.SIRIS?this.wrapped=new i.MobiliteApiSIRIS:this.wrapped=new i.MobiliteApiWindows:this.wrapped=new i.MobiliteApiFullWeb,n.prototype.init.call(this,e,t,r).then(function(){return o.wrapped.initApi(t)})},e.prototype.initApi=function(e){},e.prototype.getPlagesReseau=function(){return this.wrapped.getPlagesReseau()},e.prototype.estConnecte=function(){return this.wrapped.estConnecte()},e.prototype.estEcranTactile=function(){return this.wrapped.estEcranTactile()},e.prototype.listeTablettesSignatures=function(e){return this.wrapped.listeTablettesSignatures(e)},e.prototype.getPlateforme=function(){return this.wrapped.getPlateforme()},e.prototype.getResolutionEcran=function(){return this.wrapped.getResolutionEcran()},e.prototype.getAdresseIp=function(){return this.wrapped.getAdresseIp()},e}(t.Components.ComponentApiBase),i.MobiliteApiFactory=r,t.Components.RegistryApi.getInstance().register(r)}(MyWay||(MyWay={})),function(e){var r,o,t;r=e.Services||(e.Services={}),o=r.Mobilite||(r.Mobilite={}),t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.getResolutionEcran=function(){var e={largeur:null,hauteur:null};return window.screen?(e.hauteur=window.screen.height,e.largeur=window.screen.width):(e.hauteur=document.body.clientHeight,e.largeur=document.body.clientWidth),r.Promesses.createPromiseSelfResolved(e)},t.prototype.getPlateforme=function(){var e;return e=navigator&&navigator.platform?-1!=navigator.platform.indexOf("Win")?o.PLATEFORME.WINDOWS:-1!=navigator.platform.indexOf("Mac")?o.PLATEFORME.APPLE:-1!=navigator.platform.indexOf("iP")?o.PLATEFORME.APPLE:-1!=navigator.platform.indexOf("Android")?o.PLATEFORME.ANDROID:o.PLATEFORME.AUTRE:o.PLATEFORME.AUTRE,r.Promesses.createPromiseSelfResolved(e)},t.prototype.getFromUrl=function(e){e=e.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var t=new RegExp("[\\?&]"+e+"=([^&#]*)").exec(location.search);return null===t?null:decodeURIComponent(t[1].replace(/\+/g," "))},t.prototype.getAdresseIp=function(){var e=this.getFromUrl("ip");return e?r.Promesses.createPromiseSelfResolved(e):r.Promesses.createPromiseSelfError(new r.Erreur("Aucune adresse Ip passée en paramètre d'url"))},t}(o.MobiliteApiBase),o.MobiliteApiFullWeb=t}(MyWay||(MyWay={})),function(e){var r,i,t;r=e.Services||(e.Services={}),i=r.Mobilite||(r.Mobilite={}),t=function(t){function e(){var e=t.call(this)||this;return e._periphUrl=r.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/periph/",e._contexteUrl=r.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/contexte/",e}return __extends(e,t),e.prototype.listeTablettesSignatures=function(e){var t="";return t=e&&e.methode?this._periphUrl+"getliste?methode="+e.methode:this._periphUrl+"getliste",this.libraryManager.Core.sendRequest({url:t,method:r.MethodEnum.GET,cache:!1}).then(function(e){var t=[];for(var r in e){var o=JSON.parse(e[r].Info),n=new i.TabletteSignature(o.Type,o.Modele,o.CodeModele,o.IdMateriel);t.push(n)}return t},function(e){throw e})},e.prototype.getResolutionEcran=function(){return this.libraryManager.Core.sendRequest({url:this._contexteUrl+"GetResolutionEcran",method:r.MethodEnum.GET,cache:!1}).then(function(e){return e},function(e){throw e})},e.prototype.getPlateforme=function(){return r.Promesses.createPromiseSelfResolved(i.PLATEFORME.WINDOWS)},e.prototype.getAdresseIp=function(){return this.libraryManager.Core.sendRequest({withHeaders:!0,url:r.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/contexte/GetIpPoste",method:r.MethodEnum.GET}).then(function(e){return e},function(e){throw e})},e}(i.MobiliteApiBase),i.MobiliteApiWindows=t}(MyWay||(MyWay={})),function(e){var r,o,t;r=e.Services||(e.Services={}),o=r.Mobilite||(r.Mobilite={}),t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.getPlateforme=function(){return r.Promesses.createPromiseSelfResolved(o.PLATEFORME.MYSYS)},t}(o.MobiliteApiWindows),o.MobiliteApiSIRIS=t}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-mobilite-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}s(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var t,s,n;t=e.Services||(e.Services={}),s=t.Acquisition||(t.Acquisition={}),n=function(n){function e(){return n.call(this,t.Components.ComponentType.Acquisition)||this}return __extends(e,n),e.prototype.onAppelRADLAD=function(e){var n=e.fileInfos,t=e.params;return this.managerInstance.appelRADLAD(n,t)},e.prototype.onConvertFileToImg=function(e){var n=e.fileInfo,t=e.params,s=e.autoriseDocumentSigne;return this.managerInstance.convertFileToImg(n,t,s)},e.prototype.onMergerEtArchiver=function(e){var n=e.fileInfos,t=e.putDocumentInput;return this.managerInstance.mergerEtArchiver(n,t)},e.prototype.onMergerEtUploader=function(e){var n=e.fileInfos;return this.managerInstance.mergerEtUploader(n)},e.prototype.onConvertBase64ToBin=function(e){var n=e.urls;return this.managerInstance.convertBase64ToBin(n)},e.prototype.onPurge=function(e){var n=e.hour;return this.managerInstance.purge(n)},e.prototype.onFermetureSpiFactory=function(e){return this.managerInstance.fermetureSpiFactory()},e.prototype.onSetConfigurationScanner=function(e){var n=e.typeScanner;return this.managerInstance.setConfigurationScanner(n)},e.prototype.onMergeAndOpenPDF=function(e,n){var t=e.params;return this.managerInstance.onMergeAndOpenPDF(t,n)},e.prototype.onRecupereListeDocumentGED=function(e){var n=e.params,t=e.formatResultat;return this.managerInstance.onRecupereListeDocumentGED(n,t)},e.prototype.onOuvrirListeDocumentGED=function(e){var n=e.params,t=e.formatResultat,s=e.formatOuverture;return this.managerInstance.onOuvrirListeDocumentGED(n,t,s)},e.prototype.onGetProcessingTask=function(e){var n=e.guid;return this.managerInstance.onGetProcessingTask(n)},e.prototype.onGetDocumentGEDAndSave=function(e){var n=e.params;return this.managerInstance.onGetDocumentGEDAndSave(n)},e.prototype.onGetDocumentGedSaveAtAndOpen=function(e){var n=e.params;return this.managerInstance.onGetDocumentGedSaveAtAndOpen(n)},e.prototype.onGetDocumentGEDAndOpen=function(e){var n=e.params;return this.managerInstance.onGetDocumentGEDAndOpen(n)},e.prototype.onUploadDocumentFrom=function(e){var n=e.cheminDuFichierSurLePoste;return this.managerInstance.onUploadDocumentFrom(n)},e.prototype.onGetListeScanner=function(e){return this.managerInstance.onGetListeScanner(e.checkRemote)},e.prototype.onIsPrisEnMainADistance=function(e){return this.managerInstance.onIsPrisEnMainADistance()},e.prototype.onIsDocumentSigne=function(e){return this.managerInstance.isDocumentSigne(e.fileinfos)},e.prototype.reception=function(e){switch(e.subject){case s.Messages.AcquisitionMessageSubject.AppelRADLAD:return this.onAppelRADLAD(e.message);case s.Messages.AcquisitionMessageSubject.ConvertFileToImg:return this.onConvertFileToImg(e.message);case s.Messages.AcquisitionMessageSubject.MergerEtArchiver:return this.onMergerEtArchiver(e.message);case s.Messages.AcquisitionMessageSubject.MergerEtUploader:return this.onMergerEtUploader(e.message);case s.Messages.AcquisitionMessageSubject.ConvertBase64ToBin:return this.onConvertBase64ToBin(e.message);case s.Messages.AcquisitionMessageSubject.Purge:return this.onPurge(e.message);case s.Messages.AcquisitionMessageSubject.FermetureSpiFactory:return this.onFermetureSpiFactory(e.message);case s.Messages.AcquisitionMessageSubject.SetConfigurationScanner:return this.onSetConfigurationScanner(e.message);case s.Messages.AcquisitionMessageSubject.MergeAndOpenPDF:return this.onMergeAndOpenPDF(e.message,e.iframe);case s.Messages.AcquisitionMessageSubject.OuvrirListeDocumentGED:return this.onOuvrirListeDocumentGED(e.message);case s.Messages.AcquisitionMessageSubject.RecupereListeDocumentGED:return this.onRecupereListeDocumentGED(e.message);case s.Messages.AcquisitionMessageSubject.GetProcessingTask:return this.onGetProcessingTask(e.message);case s.Messages.AcquisitionMessageSubject.GetDocumentGEDAndSave:return this.onGetDocumentGEDAndSave(e.message);case s.Messages.AcquisitionMessageSubject.GetDocumentGEDAtAndOpen:return this.onGetDocumentGedSaveAtAndOpen(e.message);case s.Messages.AcquisitionMessageSubject.GetDocumentGEDAndOpen:return this.onGetDocumentGEDAndOpen(e.message);case s.Messages.AcquisitionMessageSubject.GetListeScanner:return this.onGetListeScanner(e.message);case s.Messages.AcquisitionMessageSubject.IsPrisEnMainADistance:return this.onIsPrisEnMainADistance(e.message);case s.Messages.AcquisitionMessageSubject.UploadDocumentFrom:return this.onUploadDocumentFrom(e.message);case s.Messages.AcquisitionMessageSubject.IsDocumentSigne:return this.onIsDocumentSigne(e.message);default:return n.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Acquisition.AcquisitionManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),s.AcquisitionManagerMessage=n,t.Components.RegistryManagerMessage.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-acquisition-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={})),function(e){var t,n,o;t=e.Services||(e.Services={}),n=t.Communication||(t.Communication={}),o=function(e){function n(){return e.call(this,t.Components.ComponentType.Communication)||this}return __extends(n,e),n.prototype.envoyerMail=function(e){return this.manager.envoyerMail(e)},n.prototype.declencherAppel=function(e){return this.manager.declencherAppel(e)},n.prototype.raccrocherAppel=function(){return this.manager.raccrocherAppel()},n.prototype.envoyerMessageAppliKiosque=function(e){return this.manager.envoyerMessageAppliKiosque(e)},n}(t.Components.ComponentManagerExtendedBase),n.CommunicationManagerExtended=o,t.Components.RegistryManagerExtended.getInstance().register(o)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-communication-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}a(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var n,s,t;n=e.Services||(e.Services={}),s=n.Communication||(n.Communication={}),t=function(o){function e(){return o.call(this,n.Components.ComponentType.Communication)||this}return __extends(e,o),e.prototype.reception=function(e){switch(e.subject){case s.CommunicationMessageSubject.EnvoyerMail:var n=e.message.mail;return this.managerInstance.envoyerMail(n);case s.CommunicationMessageSubject.DeclencherAppel:var t=e.message.call;return this.managerInstance.declencherAppel(t);case s.CommunicationMessageSubject.RaccrocherAppel:return e.message,this.managerInstance.raccrocherAppel();case s.CommunicationMessageSubject.EnvoyerMessageAppliKiosque:var a=e.message.messageAgent;return this.managerInstance.envoyerMessageAppliKiosque(a);default:return o.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Communication.CommunicationManagerMessage",e.logger=n.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(n.Components.ComponentManagerMessageBase),s.CommunicationManagerMessage=t,n.Components.RegistryManagerMessage.getInstance().register(t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-communication-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,o,n;t=e.Services||(e.Services={}),o=t.ContexteClient||(t.ContexteClient={}),n=function(n){function e(){return n.call(this,t.Components.ComponentType.ContexteClient)||this}return __extends(e,n),e.prototype.onGetContextesParClients=function(){return this.managerInstance.getContextesParClientsAsync().then(function(e){return{ids:e}})},e.prototype.onGetId=function(){var t=this;return this.library.Core.promesseTryCatch(function(e){e.resolve({id:t.managerInstance.getCurrentContexteClient().getId()})})},e.prototype.onGetClient=function(){var t=this;return this.library.Core.promesseTryCatch(function(e){e.resolve({id:t.managerInstance.getCurrentContexteClient().getClient()})})},e.prototype.onSetClient=function(t){var n=this;return this.library.Core.promesseTryCatch(function(e){n.managerInstance.setClient(t.expediteur,t.client,t.idContexteClient),e.resolve()})},e.prototype.onGetContenu=function(e){return this.managerInstance.getContenu(e.idClient).then(function(e){return{valeur:e}})},e.prototype.onGetProperty=function(e){return this.managerInstance.getProperty(e.cle,e.idContexteClient).then(function(e){return{valeur:e}})},e.prototype.onAddToList=function(e){return this.managerInstance.addToList(e.expediteur,e.cle,e.valeur,e.idContexteClient).then(function(e){return{estOk:e}})},e.prototype.onSetContenu=function(e){return this.managerInstance.setContenu(e.expediteur,e.idClient,e.valeur).then(function(e){return{estOk:e}})},e.prototype.onSetReloadSynthese=function(e){return this.managerInstance.setReloadSynthese(e.expediteur,e.idClient).then(function(e){return{estOk:e}})},e.prototype.onSetProperty=function(e){return this.managerInstance.setProperty(e.expediteur,e.cle,e.valeur,e.idContexteClient).then(function(e){return{estOk:e}})},e.prototype.onRemoveFromList=function(e){return this.managerInstance.removeFromList(e.expediteur,e.cle,e.idContexteClient).then(function(e){return{estOk:e}})},e.prototype.onDeleteProperty=function(e){return this.managerInstance.deleteProperty(e.expediteur,e.cle,e.idContexteClient).then(function(e){return{estOk:e}})},e.prototype.onGetContextes=function(){var t=[];return this.managerInstance.getContextesAsync().then(function(e){return e.forEach(function(e){t.push(e.getId())}),{idContextes:t}})},e.prototype.onDestroyContext=function(t){var n=this;return this.library.Core.promesseTryCatch(function(e){e.resolve({isDestroy:n.managerInstance.detruireContexte(t.expediteur,t.idContexte)})})},e.prototype.onNewContexte=function(t){var n=this;return this.library.Core.promesseTryCatch(function(e){e.resolve({idContexte:n.managerInstance.nouveauContexte(t.idClient).getId()})})},e.prototype.onChangeContexteProcess=function(t){var n=this;return this.library.Core.promesseTryCatch(function(e){n.managerInstance.changeContexteOfProcess(t.expediteur,t.codeProcessus,t.idContexte),e.resolve()})},e.prototype.onChangeContexteMode=function(t){var n=this;return this.library.Core.promesseTryCatch(function(e){n.managerInstance.changeContexteMode(t.idContexte,t.mode),e.resolve()})},e.prototype.onDetailsContexte=function(t){var n=this;return this.library.Core.promesseTryCatch(function(e){e.resolve(n.managerInstance.getDetailsContexte(t.idContexte))})},e.prototype.reception=function(e){var t=null;switch(e.subject){case o.ContextClientMessageSubject.GetContextesParClients:t=this.onGetContextesParClients;break;case o.ContextClientMessageSubject.GetId:t=this.onGetId;break;case o.ContextClientMessageSubject.GetClient:t=this.onGetClient;break;case o.ContextClientMessageSubject.SetClient:t=this.onSetClient;break;case o.ContextClientMessageSubject.GetProperty:t=this.onGetProperty;break;case o.ContextClientMessageSubject.AddToList:t=this.onAddToList;break;case o.ContextClientMessageSubject.SetProperty:t=this.onSetProperty;break;case o.ContextClientMessageSubject.RemoveFromList:t=this.onRemoveFromList;break;case o.ContextClientMessageSubject.DeleteProperty:t=this.onDeleteProperty;break;case o.ContextClientMessageSubject.GetContenu:t=this.onGetContenu;break;case o.ContextClientMessageSubject.SetContenu:t=this.onSetContenu;break;case o.ContextClientMessageSubject.SetReloadSynthese:t=this.onSetReloadSynthese;break;case o.ContextClientMessageSubject.GetContextes:t=this.onGetContextes;break;case o.ContextClientMessageSubject.DestroyContext:t=this.onDestroyContext;break;case o.ContextClientMessageSubject.NewContext:t=this.onNewContexte;break;case o.ContextClientMessageSubject.ChangeContextProcess:t=this.onChangeContexteProcess;break;case o.ContextClientMessageSubject.ChangeContextMode:t=this.onChangeContexteMode;break;case o.ContextClientMessageSubject.DetailsContext:t=this.onDetailsContexte;break;default:return n.prototype.reception.call(this,e)}return t.call(this,e.message)},e.CLASS_NAME="MyWay.Services.Context.ContexteClientManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),o.ContexteClientManagerMessage=n,t.Components.RegistryManagerMessage.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-contexte-client-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var n,e,o;n=t.Services||(t.Services={}),e=n.ContexteClient||(n.ContexteClient={}),o=function(t){function e(){return t.call(this,n.Components.ComponentType.ContexteClient)||this}return __extends(e,t),e.prototype.nouveauContexte=function(t){return this.manager.nouveauContexte(t).getId()},e.prototype.detruireContexte=function(t){return this.manager.detruireContexte("portail",t)},e.prototype.changerContexteClientDunProcessus=function(t,e){this.manager.changeContexteOfProcess("portail",e,t)},e.prototype.getClientDuContexte=function(t){return this.manager.getClient(t)},e.prototype.setClientDuContexte=function(t,e){return this.manager.setClient("portail",e,t)},e.prototype.getModeDuContexte=function(t){return this.manager.getMode(t)},e.prototype.setModeDuContexte=function(t,e){this.manager.changeContexteMode(t,e)},e.prototype.getContextes=function(){var e=[];return this.manager.getContextes().forEach(function(t){e.push(t.getId())}),e},e.prototype.getProcessusDuContexte=function(t){var e=[];return this.manager.getListeProcessus(t).forEach(function(t){e.push(t.id)}),e},e.prototype.getProprieteDuContexte=function(t,e){return this.manager.getProperty(e,t)},e.prototype.setProprieteDuContexte=function(t,e,n){return this.manager.setProperty("portail",e,n,t)},e.prototype.ajouterAListeDuContexte=function(t,e,n){return this.manager.addToList("portail",e,n,t)},e.prototype.retirerDeListeDuContexte=function(t,e){return this.manager.removeFromList("portail",e,t)},e.prototype.supprimerProprieteDuContexte=function(t,e){return this.manager.deleteProperty("portail",e,t)},e}(n.Components.ComponentManagerExtendedBase),e.ContexteClientManagerExtended=o,n.Components.RegistryManagerExtended.getInstance().register(o)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-contexte-client-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var n,e,o,r;n=t.Services||(t.Services={}),e=n.BriqueCommunication||(n.BriqueCommunication={}),o=e.Chat||(e.Chat={}),r=function(t){function e(){return t.call(this,n.Components.ComponentType.Chat)||this}return __extends(e,t),e.prototype.closeChat=function(t){return this.manager.closeChat(t)},e.prototype.openChat=function(t){return this.manager.openChat(t,null)},e.prototype.openChatroom=function(t){return this.manager.openChatroom(t,null)},e.prototype.sendMessage=function(t,e){return this.manager.sendMessageToStream(t,e)},e.prototype.getUtilisateurs=function(){return this.manager.getUtilisateurs()},e}(n.Components.ComponentManagerExtendedBase),o.ChatManagerExtended=r,n.Components.RegistryManagerExtended.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-brique-communication-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(e,t){function a(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var t,a,n,s;t=e.Services||(e.Services={}),a=t.BriqueCommunication||(t.BriqueCommunication={}),n=a.Chat||(a.Chat={}),s=function(s){function e(){return s.call(this,t.Components.ComponentType.Chat)||this}return __extends(e,s),e.prototype.reception=function(e){var t;switch(e.subject){case n.ChatMessageSubject.AddChatCapacity:var a=e.message;return this.managerInstance.setChatCapacite(e.iframe),this.library.Core.getPromesseSelfResoved();case n.ChatMessageSubject.SetStatut:return a=e.message,this.managerInstance.setStatut(a.statut);case n.ChatMessageSubject.CloseChat:return a=e.message,this.managerInstance.closeChat(a.idChat);case n.ChatMessageSubject.OpenChat:return a=e.message,this.managerInstance.openChat(a.destinataire,e.iframe);case n.ChatMessageSubject.OpenChatroom:return a=e.message,this.managerInstance.openChatroom(a.idChat,e.iframe);case n.ChatMessageSubject.SendMessage:return a=e.message,this.managerInstance.sendMessageToStream(a.idChat,a.message);case n.ChatMessageSubject.AccepterDemanderExpert:return a=e.message,this.managerInstance.accepterDemandeExpert(a.chatroom_id,a.domaine,a.prospect_id,e.iframe);case n.ChatMessageSubject.GetUtilisateurs:return a=e.message,this.managerInstance.getUtilisateurs();case n.ChatMessageSubject.EnvoyerMessageVideoroom:return a=e.message,this.managerInstance.envoyerMessageVideoroom(a.chatroom_id,a.user_id,a.message);case n.ChatMessageSubject.GetChatrooms:return a=e.message,this.managerInstance.getChatrooms(e.iframe);case n.ChatMessageSubject.GetChatroom:return a=e.message,this.managerInstance.getChatroom(a.chatroom_id,e.iframe);case n.ChatMessageSubject.DemarrerVideoChatroom:return a=e.message,this.managerInstance.demarrerVideoChatroom(a.idChat),this.library.Core.getPromesseSelfResoved();case n.ChatMessageSubject.ArreterVideoChatroom:return a=e.message,this.managerInstance.arreterVideoChatroom(a.idChat),this.library.Core.getPromesseSelfResoved();case n.ChatMessageSubject.InviterPersonnesAUneChatroom:return a=e.message,(t=this.managerInstance).inviterPersonnesAUneChatroom.apply(t,[a.chatroom_id].concat(a.users_id));default:return s.prototype.reception.call(this,e)}},e}(t.Components.ComponentManagerMessageBase),n.ChatManagerMessage=s,t.Components.RegistryManagerMessage.getInstance().register(s)}(MyWay||(MyWay={})),function(e){var a,t,s,n;a=e.Services||(e.Services={}),t=a.BriqueCommunication||(a.BriqueCommunication={}),s=t.Notification||(t.Notification={}),n=function(t){function e(){return t.call(this,a.Components.ComponentType.Notification)||this}return __extends(e,t),e.prototype.onAbonnement=function(e){return this.managerInstance.ecouterNotifications(e.subject)},e.prototype.onDesabonnement=function(e){this.managerInstance.arreterNotifications(e.subject)},e.prototype.onGetSujets=function(e){return this.managerInstance.getListeSujets()},e.prototype.reception=function(e){switch(e.subject){case s.NotificationMessageSubject.Abonnement:return e.message,this.onAbonnement(e.message);case s.NotificationMessageSubject.Desabonnement:return e.message,this.onDesabonnement(e.message),this.library.Core.getPromesseSelfResoved();case s.NotificationMessageSubject.GetListeSubjects:return e.message,this.onGetSujets(e.message);default:return t.prototype.reception.call(this,e)}},e}(a.Components.ComponentManagerMessageBase),s.NotificationManagerMessage=n,a.Components.RegistryManagerMessage.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-brique-communication-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var r in s)s.hasOwnProperty(r)&&(e[r]=s[r])};return function(e,s){function r(){this.constructor=e}t(e,s),e.prototype=null===s?Object.create(s):(r.prototype=s.prototype,new r)}}();!function(e){var a,n,s;a=e.Services||(e.Services={}),n=a.Trace||(a.Trace={}),s=function(t){function e(){return t.call(this,a.Components.ComponentType.Trace)||this}return __extends(e,t),e.prototype.send=function(e,s){return this.managerInstance.send(e,s)},e.prototype.reception=function(e){switch(e.subject){case n.Messages.TraceMessageSubject.Tracer:var s=e.message;return this.managerInstance.traceModelToLogger(s.trace),this.library.Core.getPromesseSelfResoved();case n.Messages.TraceMessageSubject.Logger:return s=e.message,this.managerInstance.traceToLogger(s.log),this.library.Core.getPromesseSelfResoved();case n.Messages.TraceMessageSubject.GetIntervallePurge:return s=e.message,this.library.Core.createPromiseSelfResolved(n.INTERVALLE_PURGE);case n.Messages.TraceMessageSubject.GetQuotaPurge:return s=e.message,this.library.Core.createPromiseSelfResolved(n.QUOTA_PURGE);case n.Messages.TraceMessageSubject.PurgerTraces:return s=e.message,this.managerInstance.purgerTraces(),this.library.Core.getPromesseSelfResoved();case n.Messages.TraceMessageSubject.SendDiagnostic:s=e.message;var r=new a.ApplicationDiagnostic;return r.clone(s.diagnostic),this.managerInstance.sendDiagnostic(r),this.library.Core.getPromesseSelfResoved();case n.Messages.TraceMessageSubject.SetModeDebug:return s=e.message,this.managerInstance.setModeDebug(s.active),this.library.Core.getPromesseSelfResoved();case n.Messages.TraceMessageSubject.ReInitDbTraces:return s=e.message,this.managerInstance.resetDB();default:return t.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Trace.TraceManagerMessage",e.logger=a.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(a.Components.ComponentManagerMessageBase),n.TraceManagerMessage=s,a.Components.RegistryManagerMessage.getInstance().register(s)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])};return function(e,t){function o(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(o.prototype=t.prototype,new o)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var r,t,o;r=e.Services||(e.Services={}),t=r.Trace||(r.Trace={}),o=function(e){function n(){return e.call(this,r.Components.ComponentType.Trace)||this}return __extends(n,e),n.prototype.debug=function(e,t,o){r.Loggers.FLASH.INSTANCE.setValue("action",t),r.Loggers.FLASH.INSTANCE.setValue("details",o),n.logger.debug(e)},n.prototype.info=function(e,t,o){r.Loggers.FLASH.INSTANCE.setValue("action",t),r.Loggers.FLASH.INSTANCE.setValue("details",o),n.logger.info(e)},n.prototype.warning=function(e,t,o){r.Loggers.FLASH.INSTANCE.setValue("action",t),r.Loggers.FLASH.INSTANCE.setValue("details",o),n.logger.warn(e)},n.prototype.error=function(e,t,o){r.Loggers.FLASH.INSTANCE.setValue("action",t),r.Loggers.FLASH.INSTANCE.setValue("details",o),n.logger.error(e)},n.prototype.send=function(e){this.manager.send(e)},n.CLASS_NAME="MyWay.Services.Trace.TraceManagerExtended",n.logger=r.Loggers.LoggerFactory.INSTANCE.getClass(n.CLASS_NAME),n}(r.Components.ComponentManagerExtendedBase),t.TraceManagerExtended=o,r.Components.RegistryManagerExtended.getInstance().register(o)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r])};return function(t,e){function r(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(r.prototype=e.prototype,new r)}}();!function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var n,e,r;n=t.Services||(t.Services={}),e=n.Performance||(n.Performance={}),r=function(o){function t(){return o.call(this,n.Components.ComponentType.Performance)||this}return __extends(t,o),t.prototype.init=function(t,e,r){return this._isIE=n.CoreCommon.checkIsIE(),o.prototype.init.call(this,t,e,r)},t.prototype.send=function(t){var o=this;return t.forEach(function(t){var e="Fin de chargement de l'application ";e+="|stepId|id:"+t.stepId+";label:"+t.label+"|",e+="digestCycles||totalDisplayDuration||stepStartDuration||",e+="totalStartDuration|"+t.totalStartDuration+"|",e+="type|timer|staticFilesLoadDuration||digestDuration||userDuration||",e+="totalUserDuration|"+t.totalUserDuration+"|userDurationEnabled||",e+="isAuto|"+t.isAuto+"|isTimeout|"+t.isTimeout;var r={date:Date.now(),arguments:[],context:{},message:e,niveau:n.Loggers.LEVEL.INFO,packageName:"PerformanceManager"};o.libraryManager.Trace.traceToLogger(r)}),n.Promesses.createPromiseSelfResolved()},t}(n.Components.ComponentApiBase),e.PerformanceApi=r,n.Components.RegistryApi.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-performance-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])};return function(t,i){function e(){this.constructor=t}n(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}();!function(t){var i;(i=t.Services||(t.Services={})).Core.defineProperty(i.TechAgentExtended,"HabilitationTechAgent",{get:function(){return this._techLibrary.HabilitationTechAgent}})}(MyWay||(MyWay={})),function(t){var i;(i=t.Services||(t.Services={})).Core.defineProperty(i.TechAgent,"HabilitationTechAgent",{get:function(){return this._techLibrary.HabilitationTechAgent}})}(MyWay||(MyWay={})),function(t){(t.Services||(t.Services={})).TechLibrary.addInitListener(function(t,i){t.HabilitationTechAgent=i.Habilitation})}(MyWay||(MyWay={})),function(t){var i,e,n;i=t.Services||(t.Services={}),e=i.Habilitation||(i.Habilitation={}),n=function(n){function t(){return n.call(this)||this}return __extends(t,n),t.prototype.init=function(t,i,e){return t.HabilitationTech=this,n.prototype.init.call(this,t,i,e)},t.prototype.ObtenirHabilitations=function(){return this.sendMessage(e.HabilitationMessageSubject.ObtenirHabilitations,{})},t.prototype.ObtenirHabilitation=function(t){return this.sendMessage(e.HabilitationMessageSubject.ObtenirHabilitation,{code:t})},t.prototype.ModifierHabilitation=function(t,i){return this.sendMessage(e.HabilitationMessageSubject.ModifierHabilitation,{code:t,valeur:i})},t.prototype.ChargerHabilitations=function(){return this.sendMessage(e.HabilitationMessageSubject.ChargerHabilitations,{})},t}(e.HabilitationAgent),e.HabilitationTechAgent=n,i.Components.RegistryAgent.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-habilitation-tech-agent.min.js.map
var MyWay;!function(e){var n,o;n=e.Services||(e.Services={}),((o=n.Components||(n.Components={})).ComponentType||(o.ComponentType={})).Application="Application"}(MyWay||(MyWay={})),function(e){var n,o,p,t;n=e.Services||(e.Services={}),o=n.Application||(n.Application={}),p=o.Messages||(o.Messages={}),(t=p.ApplicationMessageSubject||(p.ApplicationMessageSubject={}))[t.Demarrer=0]="Demarrer",t[t.DemarrerProcessus=1]="DemarrerProcessus",n.Components.FactoryRegistries.getInstance().declareComponent(n.Components.ComponentType.Application,[n.Components.ComponentType.Context,n.Components.ComponentType.ContexteClient,n.Components.ComponentType.Core,n.Components.ComponentType.Display,n.Components.ComponentType.Evennements,n.Components.ComponentType.Lisa])}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-application-common.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var e,n,o;e=t.Services||(t.Services={}),n=e.Lisa||(e.Lisa={}),o=function(r){function t(){return r.call(this,e.Components.ComponentType.Lisa)||this}return __extends(t,r),t.prototype.init=function(t,e,n){var o=this;return r.prototype.init.call(this,t,e,n).then(function(){if(!n.disableGetStepInfo||!0!==n.disableGetStepInfo)return o.library.Context.GetCurrentStepInfo().then(function(t){o.StepCode=t.StepCode,o.library.Context.StepInfo=t});o.StepCode=n.codeApplication})},t.prototype.Next=function(t){return this.NextWithStep(this.StepCode,t)},t.prototype.NextWithStep=function(t,e){return this.sendMessage(n.Messages.LisaMessageSubject.Next,{valeurSortie:e,stepCode:t}).then(function(t){return t.processInAgent&&(window.location.href=t.url),t})},t}(e.Components.ComponentAgentBase),n.LisaAgent=o,e.Components.RegistryAgent.getInstance().register(o)}(MyWay||(MyWay={})),function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-lisa-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])};return function(e,r){function s(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}}();!function(v){var P;(function(o){var n=function(e,r,s,t){if(this.Nom=e,this.LocalisationAbsolue=r,t)for(var o in t)this.LocalisationAbsolue=this.LocalisationAbsolue.replace("["+o+"]",t[o]);this.Type=s};o.LisaComposantApplicatif=n;var a=function(e,r,s,t,o,i){this.ComposantApplicatif=e,this.Nom=r,this.Code=s,this.Icone=t,this.LocalisationRelative=o,this.Type="PointDEntree",this.EstUnOutil=!1,null!=i&&(this.EstUnOutil=i)};o.LisaPointEntree=a;var c=function(e,r,s,t){this.Code=e,this.Nom=r,this.Type="Process",this.Options=s,this.Habilitation=t};o.LisaProcess=c;var u=function(e,r,s,t,o,i,n){this.ElementDeProcessus=r,this.InProcess=t,this.ValeurEntree=o,this.ValeurDepartProcessus=i,e?this.Code=e:(this.InProcess?this.Code=this.InProcess.Code+":":this.Code="",this.Code+=this.ElementDeProcessus.Code),this.Options=n,this.CodeMetier=s,this.Actions=[]};o.LisaEtape=u;var l=function(e,r,s,t,o,i,n){void 0===i&&(i=!1),void 0===n&&(n=null),this.Etape=e,this.ValeurSortie=r,this.VersEtape=s,this.EstExterne=t,this.NomExterne=o,this.FinProcess=i,this.ValeurFinProcess=n};o.LisaAction=l;var p=function(e,r,s,t,o,i){this.PointEntree=e,this.Code=r,this.Longueur=s,this.Type=i,this.Nullable=o,this.Mode=t};o.LisaContrat=p;var e=function(){function e(e,r,s,t){void 0===s&&(s=!0),void 0===t&&(t=[]),this.composantsApplicatifs=[],this.pointDEntrees=[],this.contrats=[],this.etapes=[],this.actions=[],this.processes=[],this.libraryManager=null,this._isLocalServiceAvailable=s,t&&0<t.length&&(v.Services.PrivatePortalServiceParameters.Instance().AuthorizedDomains=t),P.PrivatePortalServiceParameters.Instance().LisaFileUrl&&this.addSettingsFromJSON(e,r)}return e.prototype.initApi=function(e){this.libraryManager=e},e.prototype.addSettingsFromJSON=function(e,t){var r,s;s=P.PrivatePortalServiceParameters.Instance().LisaFileUrl?(r=P.PrivatePortalServiceParameters.Instance().LisaFileUrl,e?r+"/"+e:r):(r="/v1/data/lisa","/v1/data/lisa/"+e);var o=this,i=s+"/composants-applicatifs.json";P.CoreCommon.SendRequest({url:i,withHeaders:!1,async:!1,cache:!1},function(e){for(var r in o.composantsApplicatifs=[],e){var s=e[r];if(!s)throw"ca is null: url="+i;o.composantsApplicatifs[s.Nom]=new n(s.Nom,s.LocalisationAbsolue,s.Type,t)}},null),i=r+"/points-entrees.json",P.CoreCommon.SendRequest({url:i,withHeaders:!1,async:!1,cache:!1},function(e){for(var r in o.pointDEntrees=[],e){var s=e[r];o.pointDEntrees[s.Code]=new a(o.composantsApplicatifs[s.ComposantApplicatif],s.Nom,s.Code,s.Icone,s.LocalisationRelative,s.EstUnOutil)}},null),i=r+"/processus.json",P.CoreCommon.SendRequest({url:i,withHeaders:!1,async:!1,cache:!1},function(e){for(var r in o.processes=[],e){var s=e[r];o.processes[s.Code]=new c(s.Code,s.Nom,s.Options,s.Habilitation)}},null),i=r+"/etapes.json",P.CoreCommon.SendRequest({url:i,withHeaders:!1,async:!1,cache:!1},function(e){for(var r in o.etapes=[],e){var s=e[r],t=s.ElementDeProcessus.split("|");"PointDEntree"===t[1]?o.etapes[s.Code]=new u(s.Code,o.pointDEntrees[t[0]],s.CodeMetier,o.processes[s.InProcess],s.ValeurEntree,s.ValeurDepartProcessus,s.Options):o.etapes[s.Code]=new u(s.Code,o.processes[t[0]],s.CodeMetier,o.processes[s.InProcess],s.ValeurEntree,s.ValeurDepartProcessus,s.Options)}},null),i=r+"/actions.json",P.CoreCommon.SendRequest({url:i,withHeaders:!1,async:!1,cache:!1},function(e){for(var r in o.actions=[],e){var s=e[r],t=new l(o.etapes[s.Etape],s.ValeurSortie,o.etapes[s.VersEtape],s.EstExterne,s.NomExterne,s.FinProcess,s.ValeurFinProcess);o.actions.push(t),o.etapes[s.Etape].Actions.push(t)}},null),i=r+"/contrats.json",P.CoreCommon.SendRequest({url:i,withHeaders:!1,async:!1,cache:!1},function(e){for(var r in o.contrats=[],e){var s=e[r];o.contrats.push(new p(o.pointDEntrees[s.PointEntree],s.Code,s.Longueur,s.Mode,s.Nullable,s.Type))}},null),i=r+"/addons.json",P.CoreCommon.SendRequest({url:i,withHeaders:!1,async:!1,cache:!1},function(e){o.addOns=e},null)},e.prototype.next=function(e,r){var s=P.CoreCommon.ServiceDePromesse.defer();try{var t=null;for(var o in this.actions){var i=this.actions[o];if(i.Etape.Code===e&&i.ValeurSortie===r){if((t=new v.Services.Lisa.NextResult(null)).CodeEtape=e,t.ValeurSortie=r,i.FinProcess)t.FinProcess=!0,t.ValeurFinProcess=i.ValeurFinProcess;else if("PointDEntree"===i.VersEtape.ElementDeProcessus.Type){var n=this.setSequencePE(i.VersEtape);t.ProchaineEtape=n}else if("Process"===i.VersEtape.ElementDeProcessus.Type){var a=this.setSequencePR(i.VersEtape.ElementDeProcessus,i.VersEtape.ValeurEntree);for(var c in t.ProchaineEtape=a,t.ProcessDemarre=new P.Lisa.ProcessResult({Code:i.VersEtape.ElementDeProcessus.Code,Nom:i.VersEtape.ElementDeProcessus.Nom}),t.ProcessDemarre.EtapesConnues=this.getKnownSteps(i.VersEtape.ElementDeProcessus.Code),t.ProcessDemarre.CodeEtape=i.VersEtape.Code,t.ProcessDemarre.OptionsProcess=i.VersEtape.ElementDeProcessus.Options,t.ProcessDemarre.Actions=[],this.actions){var u=this.actions[c];if(u.Etape&&u.Etape.Code===i.VersEtape.Code){var l=new v.Services.Lisa.ActionResult(null);l.ValeurSortie=u.ValeurSortie,l.NomExterne=u.NomExterne,l.EstExterne=u.EstExterne,t.ProcessDemarre.Actions.push(l)}}for(var p in i.VersEtape.Options&&(t.ProcessDemarre.OptionsProcessAsEtape=i.VersEtape.Options),t.ProcessDemarre.Actions){var h=t.ProcessDemarre.Actions[p];h.ValeursFinProcessPossibles=this.getSortiesPossiblesPourEtapeEtSortie(i.VersEtape,h.ValeurSortie)}}return s.resolve(t),s.promise}}s.reject(new P.Erreur("Sortie "+r+" inexistante pour l'étape "+e))}catch(e){s.reject(new P.Erreur("Impossible de réaliser l'enchainement: "+JSON.stringify(e)))}return s.promise},e.prototype.start=function(e,r){var s=P.CoreCommon.ServiceDePromesse.defer();try{var t=null;for(var o in e||s.reject(new P.Erreur("pas de code processus fourni en paramètre")),this.processes){var i=this.processes[o];if(i.Code===e){var n=this.setSequencePR(i,r);return(t=new v.Services.Lisa.StartResult(null)).CodeProcessus=i.Code,t.ProchaineEtape=n,t.ProcessDemarre=new P.Lisa.ProcessResult({Code:i.Code,ValeurDepart:r,Nom:i.Nom}),t.ProcessDemarre.EtapesConnues=this.getKnownSteps(i.Code),t.ProcessDemarre.Actions=[],t.ProcessDemarre.OptionsProcess=i.Options,s.resolve(t),s.promise}}s.resolve(null)}catch(e){s.reject(new P.Erreur("Impossible de démarrer un processus: "+JSON.stringify(e)))}return s.promise},e.prototype.getProcesses=function(){if(this.processes){var e=[];for(var r in this.processes){var s=this.processes[r],t=new o.ProcessResult(null);t.Code=s.Code,t.Nom=s.Nom,t.OptionsProcess=s.Options,e.push(t)}return this.libraryManager.Core.createPromiseSelfResolved(e)}return this.libraryManager.Core.createPromiseSelfError(new P.Erreur("pas de processus trouvé"))},e.prototype.getTools=function(){if(this.pointDEntrees){var e=[];for(var r in this.pointDEntrees){var s=this.pointDEntrees[r];if(s.EstUnOutil){var t=new o.ApplicationResult(s.Nom,s.Icone,s.ComposantApplicatif.LocalisationAbsolue+s.LocalisationRelative);e.push(t)}}return this.libraryManager.Core.createPromiseSelfResolved(e)}return this.libraryManager.Core.createPromiseSelfError(new P.Erreur("pas d'outil trouvé"))},e.prototype.setSequencePE=function(e){var r=(e=this.getEtape(e.Code)).ElementDeProcessus,s=new v.Services.Lisa.EtapeResult(null);for(var t in s.CodeApplication=r.Code,s.CodeEtape=e.Code,s.CodeMetier=e.CodeMetier,s.NomApplication=e.ElementDeProcessus.Nom,s.LocalisationAbsolue=r.ComposantApplicatif.LocalisationAbsolue,s.LocalisationRelative=r.LocalisationRelative,s.TypeApplication=r.ComposantApplicatif.Type,s.ValeurEntree=e.ValeurEntree,s.Actions=[],this.actions){var o=this.actions[t];if(o.Etape&&o.Etape.Code===s.CodeEtape){var i=new v.Services.Lisa.ActionResult(null);i.ValeurSortie=o.ValeurSortie,i.NomExterne=o.NomExterne,i.EstExterne=o.EstExterne,s.Actions.push(i)}}for(var n in s.Contrats=[],this.contrats){var a=this.contrats[n];if(a.PointEntree.Code===r.Code){var c=new v.Services.Lisa.ContratResult(null);c.Code=a.Code,c.Longueur=a.Longueur,c.Mode=a.Mode,c.Nullable=a.Nullable,c.Type=a.Type,s.Contrats.push(c)}}for(var u in s.OptionsEtape=e.Options,s.OptionsPointEntree=r.Options,s.Actions){var l=s.Actions[u];l.ValeursFinProcessPossibles=this.getSortiesPossiblesPourEtapeEtSortie(e,l.ValeurSortie)}return s},e.prototype.setSequencePR=function(e,r){var s=this.getDepart(e.Code,r);return"PointDEntree"===s.ElementDeProcessus.Type?this.setSequencePE(s):this.setSequencePR(s.ElementDeProcessus,r)},e.prototype.getDepart=function(e,r){for(var s in this.etapes){var t=this.etapes[s];if(t.InProcess.Code===e)if(r){if(t.ValeurDepartProcessus&&t.ValeurDepartProcessus===r)return t}else if(1===t.ValeurDepartProcessus)return t}throw"pas de première étape trouvée"},e.prototype.getEtape=function(e){for(var r in this.etapes){var s=this.etapes[r];if(s.Code==e)return s}return null},e.prototype.getActionsForAStep=function(e,r){var s=[];for(var t in this.actions)this.actions[t].Etape.Code===e+":"+r&&s.push(this.actions[t]);return s},e.prototype.getKnownSteps=function(e){var r=[],s="",t=[];for(s=this.getDepart(e).ElementDeProcessus.Code,r.push(s),t=this.getActionsForAStep(e,s);1===t.length&&!0!==t[0].FinProcess&&t[0].VersEtape&&-1===r.indexOf(t[0].VersEtape.ElementDeProcessus.Code);)s=t[0].VersEtape.ElementDeProcessus.Code,r.push(s),t=this.getActionsForAStep(e,s);return 1<t.length?r.push("..."):t.length<1&&r.push("???"),r},e.prototype.getSortiesPossiblesPourEtapeEtSortie=function(e,r){var s=[];for(var t in e.Actions){var o=e.Actions[t];if(o.ValeurSortie===r){if(o.FinProcess)s.push(o.ValeurFinProcess);else{var i=this.getSortiesPossiblesPourEtape(o.VersEtape);for(var n in i){var a=i[n];s.indexOf(a)<0&&s.push(a)}}break}}return s},e.prototype.getSortiesPossiblesPourEtape=function(e){var r=[];if(e.Actions)for(var s in e.Actions){var t=e.Actions[s];if(!t.ValeursFinProcessPossibles)if(t.FinProcess)t.ValeursFinProcessPossibles=[],t.ValeursFinProcessPossibles.push(t.ValeurFinProcess);else{t.ValeursFinProcessPossibles=[];var o=t.VersEtape,i=this.getSortiesPossiblesPourEtape(o);for(var n in i){var a=i[n];t.ValeursFinProcessPossibles.indexOf(a)<0&&t.ValeursFinProcessPossibles.push(a)}}for(var c in t.ValeursFinProcessPossibles)a=t.ValeursFinProcessPossibles[c],r.indexOf(a)<0&&r.push(a)}else console.log(e);return r},e.prototype.getCodesProcessus=function(){return this.getProcesses().then(function(e){var r=[];for(var s in e)r.push(e[s].Code);return r})},e.prototype.getInfoProcessus=function(e){var r=P.CoreCommon.ServiceDePromesse.defer();return r.resolve(null),r.promise},e.prototype.DemarrerSousProcessusExterne=function(e,r,s,t,o,i,n){var a=P.CoreCommon.ServiceDePromesse.defer();return a.resolve(null),a.promise},e.prototype.getHabilitationProcessus=function(e){var r=P.CoreCommon.ServiceDePromesse.defer();for(var s in this.processes){var t=this.processes[s];if(t.Code===e)return r.resolve(t.Habilitation),r.promise}return r.resolve(null),r.promise},e.prototype.getAddOns=function(){var e=P.CoreCommon.ServiceDePromesse.defer();return e.resolve(this.addOns),e.promise},e}();o.FakeLisaApi=e})((P=v.Services||(v.Services={})).Lisa||(P.Lisa={}))}(MyWay||(MyWay={})),function(e){var r;(r=e.Services||(e.Services={})).Bug||(r.Bug={})}(MyWay||(MyWay={})),function(e){var a,c,r;a=e.Services||(e.Services={}),c=a.Lisa||(a.Lisa={}),r=function(n){function e(e,r,s,t){void 0===s&&(s=!0),void 0===t&&(t=[]);var o=n.call(this,e,r,s,t)||this;return o.processusVersions={},o._lisaUrl=a.PrivatePortalServiceParameters.Instance().LisaUrl,o._referentielProcessusSiUrl=a.PrivatePortalServiceParameters.Instance().ReferentielProcessusSiUrl,o.getAddOns().then(function(e){o.addOns=e}),o}return __extends(e,n),e.prototype.next=function(e,o){var i=this;return(a.PrivatePortalServiceParameters.Instance().LisaFileUrl?n.prototype.next.call(this,e,o):this._next(e,o)).then(function(e){var r=new c.NextResult(e);if(r.ProcessDemarre){var s;if(r.ProcessDemarre.OptionsProcessAsEtape)if(null!=(s=JSON.parse(r.ProcessDemarre.OptionsProcessAsEtape))&&s.HorsProcessus)return r;var t=null;if(t=void 0!==e.ProcessDemarre.ValeurDepart?{actionsFinSousProcessus:e.ProcessDemarre.Actions,codeEtape:e.ProcessDemarre.CodeEtape,valeurDepartSousProcessus:e.ProcessDemarre.ValeurDepart,valeurSortie:o}:i._getEtapeAddOn(r.ProcessDemarre.CodeEtape))return i._handleSubProcess(r,t)}return r})},e.prototype.start=function(r,e){var s=this;return a.Promesses.getPromesseSelfResoved().then(function(){return a.PrivatePortalServiceParameters.Instance().LisaFileUrl?n.prototype.start.call(s,r,e).then(function(e){return new c.StartResult(e)}):s._start(r,e)}).then(function(e){return void 0!==e.VersionExport?s.processusVersions[r]=Number(e.VersionExport):s.processusVersions[r]=0,e})},e.prototype._next=function(e,r){return a.CoreCommon.SendRequestWithPromise({url:this._lisaUrl+"/next/"+e+"/"+r,method:a.MethodEnum.GET,withHeaders:!1})},e.prototype._start=function(e,r){var s=a.CoreCommon.ServiceDePromesse.defer(),t=this._lisaUrl+"/start/"+e;return r&&(t+="/"+r),a.CoreCommon.SendRequestWithPromise({url:t,method:a.MethodEnum.GET,withHeaders:!1}).then(function(e){var r=new c.StartResult(e);s.resolve(r)}).catch(function(e){s.reject(e)}),s.promise},e.prototype._handleSubProcess=function(s,t){var e=s.ProcessDemarre.ValeurDepart;return void 0===e&&(e=t.valeurDepartSousProcessus),this.start(s.ProcessDemarre.Code,e).then(function(e){for(var r in s.ProchaineEtape=new c.EtapeResult(e.ProchaineEtape),s.ProcessDemarre.Actions=[],t.actionsFinSousProcessus)s.ProcessDemarre.Actions.push(new c.ActionResult(t.actionsFinSousProcessus[r]));return s}).catch(function(e){throw e})},e.prototype.getTools=function(){return n.prototype.getTools.call(this)},e.prototype.getCodesProcessus=function(){return a.PrivatePortalServiceParameters.Instance().LisaFileUrl?n.prototype.getCodesProcessus.call(this):a.CoreCommon.SendRequestWithPromise({url:this._lisaUrl+"/_index_",withHeaders:!1})},e.prototype.getInfoProcessus=function(e){return a.PrivatePortalServiceParameters.Instance().LisaFileUrl?n.prototype.getInfoProcessus.call(this,e):a.CoreCommon.SendRequestWithPromise({url:this._lisaUrl+"/"+e+".infos",withHeaders:!1})},e.prototype.getHabilitationProcessus=function(e){if(a.PrivatePortalServiceParameters.Instance().LisaFileUrl)return n.prototype.getHabilitationProcessus.call(this,e);var r=a.CoreCommon.ServiceDePromesse.defer();return a.CoreCommon.SendRequest({url:this._referentielProcessusSiUrl+"/recherche/processus?codeProcessus="+e},function(e){e&&e.codeHabilitation?r.resolve(e.codeHabilitation):r.reject(new a.Erreur("les données renvoyées ne sont pas valables",[JSON.stringify(e)]))},function(e){r.reject(e)}),r.promise},e.prototype.getAddOns=function(){if(a.PrivatePortalServiceParameters.Instance().LisaFileUrl)return n.prototype.getAddOns.call(this);var r=a.CoreCommon.ServiceDePromesse.defer();return a.CoreCommon.SendRequest({url:this._lisaUrl+"/importExport/addons",withHeaders:!1},function(e){r.resolve(e)},function(e){r.reject(e)}),r.promise},e.prototype._getEtapeAddOn=function(e){if(this.addOns&&this.addOns.nextsSubProcess)for(var r in this.addOns.nextsSubProcess){var s=this.addOns.nextsSubProcess[r];if(s&&s.codeEtape===e)return s}return null},e.prototype.DemarrerSousProcessusExterne=function(e,r,s,t,o,i,n){return this.libraryManager.Core.createPromiseSelfResolved(!0)},e}(c.FakeLisaApi),c.LisaApiBase=r}(MyWay||(MyWay={})),function(e){var r,i,s;r=e.Services||(e.Services={}),i=r.Lisa||(r.Lisa={}),s=function(o){function e(){var e=o.call(this,r.Components.ComponentType.Lisa)||this;return e.wrapped=null,e}return __extends(e,o),e.prototype.init=function(e,r,s){var t=this;return e.ServiceLocal?e.InteropAppliBancaire?this.wrapped=new i.LisaApiPetra:this.wrapped=new i.LisaApiWindows:this.wrapped=new i.LisaApiFullWeb,o.prototype.init.call(this,e,r,s).then(function(){return t.wrapped.initApi(r)})},e.prototype.initApi=function(e){},e.prototype.next=function(e,r){return this.wrapped.next(e,r)},e.prototype.start=function(e,r){return this.wrapped.start(e,r)},e.prototype.DemarrerSousProcessusExterne=function(e,r,s,t,o,i,n){return this.wrapped.DemarrerSousProcessusExterne(e,r,s,t,o,i,n)},e.prototype.getTools=function(){return this.wrapped.getTools()},e.prototype.getCodesProcessus=function(){return this.wrapped.getCodesProcessus()},e.prototype.getInfoProcessus=function(e){return this.wrapped.getInfoProcessus(e)},e.prototype.getHabilitationProcessus=function(e){return this.wrapped.getHabilitationProcessus(e)},e.prototype.getAddOns=function(){return this.wrapped.getAddOns()},e}(r.Components.ComponentApiBase),i.LisaApiFactory=s,r.Components.RegistryApi.getInstance().register(s)}(MyWay||(MyWay={})),function(s){var e,r,t;e=s.Services||(s.Services={}),r=e.Lisa||(e.Lisa={}),t=function(e){function r(){return e.call(this,s.Services.PrivatePortalServiceParameters.Instance().Environnement,s.Services.PrivatePortalServiceParameters.Instance().LisaPlaceholders)||this}return __extends(r,e),r}(r.LisaApiBase),r.LisaApiFullWeb=t}(MyWay||(MyWay={})),function(r){var n,e,s;n=r.Services||(r.Services={}),e=n.Lisa||(n.Lisa={}),s=function(i){function e(){var e=i.call(this,r.Services.PrivatePortalServiceParameters.Instance().Environnement,r.Services.PrivatePortalServiceParameters.Instance().LisaPlaceholders)||this;return e._surchargeNext=null,e._surchargeStart=null,e._localServiceUrl=null,e._localServiceUrl=n.PrivatePortalServiceParameters.Instance().LocalServiceUrl,e}return __extends(e,i),e.prototype.initApi=function(e){var r=this;i.prototype.initApi.call(this,e),n.PrivatePortalServiceParameters.Instance().LocalServiceDisabled||(this.getSurchargeNext(function(e){r._surchargeNext=e}),this.getSurchargeStart(function(e){r._surchargeStart=e}))},e.prototype.next=function(e,r){var s=n.CoreCommon.ServiceDePromesse.defer();for(var t in this._surchargeNext){var o=this._surchargeNext[t];if(o.CodeEtape===e&&o.ValeurSortie===r)return s.resolve(o),s.promise}return i.prototype.next.call(this,e,r)},e.prototype.start=function(e,r){var s=n.CoreCommon.ServiceDePromesse.defer();for(var t in this._surchargeStart){var o=this._surchargeStart[t];if(o.CodeProcessus===e)return s.resolve(o),s.promise}return i.prototype.start.call(this,e,r)},e.prototype.getSurchargeNext=function(o){var e;if(this._localServiceUrl)return e=this._localServiceUrl+"/surcharge-next.json",this.libraryManager.Core.sendRequest({url:e}).then(function(e){var r=[];for(var s in e){var t=e[s];r.push(t)}o(r)},function(e){})},e.prototype.getSurchargeStart=function(o){var e;if(this._localServiceUrl)return e=this._localServiceUrl+"/surcharge-start.json",this.libraryManager.Core.sendRequest({url:e}).then(function(e){var r=[];for(var s in e){var t=e[s];r.push(t)}o(r)},function(e){})},e}(e.LisaApiBase),e.LisaApiWindows=s}(MyWay||(MyWay={})),function(s){var p,e,r;p=s.Services||(s.Services={}),e=p.Lisa||(p.Lisa={}),r=function(r){function l(){var e=r.call(this,s.Services.PrivatePortalServiceParameters.Instance().Environnement,s.Services.PrivatePortalServiceParameters.Instance().LisaPlaceholders)||this;return e._localServiceUrl=null,e._localServiceUrl=p.PrivatePortalServiceParameters.Instance().LocalServiceUrl,e}return __extends(l,r),l.prototype.DemarrerSousProcessusExterne=function(e,r,s,t,o,i,n){var a=this,c=JSON.stringify(s),u="";return u=n?this._localServiceUrl+"/lanceur/DemarrerProcessus?codeProcessus="+e+"&initData="+c+"&valeurEntree="+(null==t?"":t)+"&horsPortail="+o+"&surTablette="+i+"&nameDevice="+n:this._localServiceUrl+"/lanceur/DemarrerProcessus?codeProcessus="+e+"&initData="+c+"&valeurEntree="+(null==t?"":t)+"&horsPortail="+o+"&surTablette="+i,this.libraryManager.Core.sendRequest({url:u,contentType:p.ContentTypeEnum.JSON,method:p.MethodEnum.GET,cache:!1}).then(function(){return p.Loggers.FLASH.INSTANCE.setValue("details",e),l.logger.debug("DemarrerProcessus du Service Local - Success"),a.libraryManager.Core.createPromiseSelfResolved(!0)},function(){return l.logger.error("DemarrerProcessus du Service Local - Failed"),a.libraryManager.Core.createPromiseSelfResolved(!1)})},l.CLASS_NAME="MyWay.Services.Application.LisaApiPetra",l.logger=p.Loggers.LoggerFactory.INSTANCE.getClass(l.CLASS_NAME),l}(e.LisaApiBase),e.LisaApiPetra=r}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-lisa-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var n,t,r;n=e.Services||(e.Services={}),t=n.Aide||(n.Aide={}),r=function(e){function t(){return e.call(this,n.Components.ComponentType.Aide)||this}return __extends(t,e),t.prototype.MemoriserEtape=function(e){return this.manager.ajouterEtapeDansPreference(e)},t}(n.Components.ComponentManagerExtendedBase),t.AideManagerExtended=r,n.Components.RegistryManagerExtended.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-aide-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var t in s)s.hasOwnProperty(t)&&(e[t]=s[t])};return function(e,s){function t(){this.constructor=e}o(e,s),e.prototype=null===s?Object.create(s):(t.prototype=s.prototype,new t)}}();!function(e){var t,o,s;t=e.Services||(e.Services={}),o=t.Aide||(t.Aide={}),s=function(s){function e(){return s.call(this,t.Components.ComponentType.Aide)||this}return __extends(e,s),e.prototype.onGetContenuInfobulle=function(e){var s=null!==e.idChampLie&&void 0!==e.idChampLie?e.idChampLie:"",t=null!==e.horsProcessus&&void 0!==e.horsProcessus?e.horsProcessus:null,o=null!==e.codeProcessus&&void 0!==e.codeProcessus?e.codeProcessus:null,n=null!==e.codeEtape&&void 0!==e.codeEtape?e.codeEtape:null,r=this.managerInstance.getParametresContexte(s,t,o,n);return this.managerInstance.GetContenuInfobulle(r)},e.prototype.onGetInfobullesAffichables=function(e){var s=null!==e.horsProcessus&&void 0!==e.horsProcessus?e.horsProcessus:null,t=null!==e.codeProcessus&&void 0!==e.codeProcessus?e.codeProcessus:null,o=null!==e.codeEtape&&void 0!==e.codeEtape?e.codeEtape:null,n=this.managerInstance.getParametresContexte("",s,t,o);return this.managerInstance.GetInfobullesAffichables(n)},e.prototype.reception=function(e){switch(e.subject){case o.Messages.AideMessageSubject.GetContenuInfobulle:return this.onGetContenuInfobulle(e.message);case o.Messages.AideMessageSubject.GetInfobullesAffichables:return this.onGetInfobullesAffichables(e.message);default:return s.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Aide.AideManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),o.AideManagerMessage=s,t.Components.RegistryManagerMessage.getInstance().register(s)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-aide-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t,i,n;t=e.Services||(e.Services={}),i=t.Fichier||(t.Fichier={}),n=function(a){function e(){return a.call(this,t.Components.ComponentType.Fichier)||this}return __extends(e,a),e.prototype.reception=function(e){switch(e.subject){case i.FichierMessageSubject.SaveAs:var t=e.message,n=t.data,r=t.type,o=t.nomFichier,s=t.typeDonnees;return this.managerInstance.saveAs(n,r,o,s);default:return a.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Fichier.FichierManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),i.FichierManagerMessage=n,t.Components.RegistryManagerMessage.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-fichier-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();!function(e){var r;(r=e.Services||(e.Services={})).Bug||(r.Bug={})}(MyWay||(MyWay={})),function(c){var u,p,e;u=c.Services||(c.Services={}),p=u.Impression||(u.Impression={}),e=function(r){function t(){var e=r.call(this,u.Components.ComponentType.Impression)||this;return e._urlDistantGeneration=u.PrivatePortalServiceParameters.Instance().ImpressionUrl+"/ServiceRestGcedoc/api/Restitution/RestitutionGceDocAvecGed",e._urlGetFichierFromGED=u.PrivatePortalServiceParameters.Instance().GetFichierFromGEDUrl,e}return __extends(t,r),t.prototype.isLocal=function(){return!1},t.prototype.genererDocument=function(e,r,t){var n={};return n.url=this._urlDistantGeneration,n.responseType=u.ResponseTypeEnum.JSON,n.authentificationInfo=t,n.method=u.MethodEnum.POST,n.params=r,n.withHeaders=!0,n.async=!0,n.timeout=6e4,n.contentType=u.ContentTypeEnum.JSON,n.data=this.convertJson(e),this.libraryManager.Core.sendRequest(n)},t.prototype.convertJson=function(e){var r=JSON.stringify(e).replace(/_attribute_Content\":0/g,'@Content":"Id"').replace(/_attribute_Content:\"1/g,'@Content":"Flux"').replace(/_attribute_/g,"@");return r=r.replace(/attributeContent\":0/g,'@Content":"Id"').replace(/attributeContent:\"1/g,'@Content":"Flux"').replace(/attributeId/g,"@id").replace(/attributeXmlns/g,"@xmlns").replace(/attributeCamel/g,"@camel")},t.prototype.getJsonConverti=function(e){try{return u.Promesses.createPromiseSelfResolved(this.convertJson(e))}catch(e){return u.Promesses.createPromiseSelfError(new u.Erreur(e))}},t.prototype.imprimerDocument=function(e,r){return u.Promesses.createPromiseSelfResolved(0)},t.prototype.imprimerDocumentLot=function(e,r){return u.Promesses.createPromiseSelfResolved(0)},t.prototype.getDocumentGEDLot=function(i,s){var a=this;return u.Promesses.promesseTryCatch(function(t){for(var e,n=0;n<i.length;n++){if(""===i[n].fichier&&(i[n].fichier=void 0),""===i[n].idGed&&(i[n].idGed=void 0),""!==(e=p.controleDocumentImpressionLot(i[n]))){var r="Le contrôle du document {0} a rapporté une erreur : {1}";return r=(r=r.replace("{0}",String(n+1))).replace("{1}",e),void t.reject(new u.Erreur(r))}if(u.Controle.StaticStringControle.isStringNotEmpty(i[n].composantApplicatif)||(i[n].composantApplicatif="CONTELEC"),u.Controle.StaticStringControle.isStringNotEmpty(i[n].codeEtablissement)&&(s.codeEtablissement=i[n].codeEtablissement),!u.Controle.StaticAnyControle.isNotUndefinedAndNotNull(i[n].fichier)){if(!s.codeEtablissement||!s.agentConnecte)return void t.reject(new u.Erreur(c.Services.Libelle.LibelleModel.COM.ERREUR_COMMUNICATION_PARAMETRES_INSUFFISANTS));var o={};o.url=a._urlGetFichierFromGED,o.responseType=u.ResponseTypeEnum.JSON,o.authentificationInfo=s,o.method=u.MethodEnum.GET,o.params={idDocument:i[n].idGed,codeApplication:i[n].composantApplicatif},o.withHeaders=!0,o.async=!1,o.contentType=u.ContentTypeEnum.JSON,o.timeout=6e4,u.CoreCommon.SendRequest(o,function(e){i[n].fichier=e.fichier.contenu},function(e){var r="La récupération du document {0} du lot a généré une erreur : {1}";r=(r=r.replace("{0}",String(n+1))).replace("{1}",e.libelle),t.reject(new u.Erreur(r))})}}t.resolve(i)})},t.prototype.gererErreur=function(e){return t.logger.error(e),u.Promesses.createPromiseSelfError(new u.Erreur(u.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[e]))},t.CLASS_NAME="MyWay.Services.Impression.ImpressionApiBase",t.logger=u.Loggers.LoggerFactory.INSTANCE.getClass(t.CLASS_NAME),t}(u.Components.ComponentApiBase),p.ImpressionApiBase=e}(MyWay||(MyWay={})),function(e){var r,i,t;r=e.Services||(e.Services={}),i=r.Impression||(r.Impression={}),t=function(o){function e(){var e=o.call(this,r.Components.ComponentType.Impression)||this;return e.wrapped=null,e}return __extends(e,o),e.prototype.init=function(e,r,t){var n=this;return e.ServiceLocal&&e.SIRIS&&e.InteropAppliBancaire?this.wrapped=new i.ImpressionApiPetra:this.wrapped=new i.ImpressionApiFullWeb,o.prototype.init.call(this,e,r,t).then(function(){return n.wrapped.init(e,r,t)})},e.prototype.genererDocument=function(e,r,t){return this.wrapped.genererDocument(e,r,t)},e.prototype.getJsonConverti=function(e){return this.wrapped.getJsonConverti(e)},e.prototype.imprimerDocument=function(e,r){return this.wrapped.imprimerDocument(e,r)},e.prototype.imprimerDocumentLot=function(e,r){return this.wrapped.imprimerDocumentLot(e,r)},e.prototype.getDocumentGEDLot=function(e,r){return this.wrapped.getDocumentGEDLot(e,r)},e}(r.Components.ComponentApiBase),i.ImpressionApiFactory=t,r.Components.RegistryApi.getInstance().register(t)}(MyWay||(MyWay={})),function(o){var i,t,e;i=o.Services||(o.Services={}),t=i.Impression||(i.Impression={}),e=function(e){function r(){return e.call(this)||this}return __extends(r,e),r.prototype.imprimerDocument=function(e,r){return t.ImpressionApiBase.logger.debug("Lancement de la sauvegarde du PDF"),this.libraryManager.Fichier.saveAs(e,o.Services.Fichier.TYPE_FICHIER.PDF,r.serializedImpressionParams.obligatoires.nomFichier,o.Services.Fichier.TYPE_DONNEES_A_SAUVER.BASE64).then(function(){return 0})},r.prototype.imprimerDocumentLot=function(e,r){for(var t=[],n=0;n<e.length;n++)t.push(this.libraryManager.Fichier.saveAs(e[n].fichier,o.Services.Fichier.TYPE_FICHIER.PDF,e[n].impressionParams.obligatoires.nomFichier,o.Services.Fichier.TYPE_DONNEES_A_SAUVER.BASE64));return i.Promesses.getServiceDePromesse().all(t).then(function(){return 0},function(e){var r="Une erreur est survenue lors de la sauvegarde des documents du lot : {0}";throw r=r.replace("{0}",e.codeLibelle),new i.Erreur(i.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[r])})},r}(t.ImpressionApiBase),t.ImpressionApiFullWeb=e}(MyWay||(MyWay={})),function(e){var o,i,r;o=e.Services||(e.Services={}),i=o.Impression||(o.Impression={}),r=function(r){function e(){var e=r.call(this)||this;return e._urlLocal=o.PrivatePortalServiceParameters.Instance().LocalServiceUrl+"/impression/",e}return __extends(e,r),e.prototype.imprimerDocument=function(e,t){var n=this;return o.Promesses.promesseTryCatch(function(r){n.libraryManager.Libelle.afficherMessage(o.Libelle.LibelleModel.TEC.IMPRESSION_IMPRESSION_EN_COURS,o.Libelle.TYPE_AFFICHAGE.VIDE,null,0,null,function(){n._imprimerDocument(e,t).then(function(e){o.ServiceManager.Instance().Library.Display.FermerModalMessage(),i.ImpressionApiBase.logger.debug("ServiceApi.Impression.imprimerDocument Success"),r.resolve(e)},function(e){o.ServiceManager.Instance().Library.Display.FermerModalMessage(),i.ImpressionApiBase.logger.error("ServiceApi.Impression.imprimerDocument failed %1",JSON.stringify(e)),r.reject(e)})})})},e.prototype.imprimerDocumentLot=function(e,r){var n=this;return o.Promesses.promesseTryCatch(function(t){n.libraryManager.Libelle.afficherMessage(o.Libelle.LibelleModel.TEC.IMPRESSION_IMPRESSION_EN_COURS,o.Libelle.TYPE_AFFICHAGE.VIDE,null,0,null,function(){n._imprimerDocumentLot(e,r).then(function(e){o.ServiceManager.Instance().Library.Display.FermerModalMessage(),i.ImpressionApiBase.logger.debug("ServiceApi.Impression.imprimerDocumentLot success"),t.resolve(e)},function(e){o.ServiceManager.Instance().Library.Display.FermerModalMessage();var r="Une erreur est survenue lors de la l'impression des documents du lot : {0}";r=r.replace("{0}",e.libelle),t.reject(new o.Erreur(o.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[r]))})})})},e.prototype._imprimerDocument=function(e,r){var t={};return t.url=this._urlLocal+"ImprimerSansGceDoc",t.responseType=null,t.method=o.MethodEnum.POST,t.params=r,t.async=!0,t.timeout=36e5,t.contentType=o.ContentTypeEnum.JSON,t.data=e,t.cache=!1,t.originalResponse=!0,this.libraryManager.Core.sendRequest(t).then(function(e){switch(e.status){case 200:return 0;case 204:return 2;default:throw new Error("Code retour non reconnu : "+e.status)}})},e.prototype._imprimerDocumentLot=function(e,r){var t={};return t.url=this._urlLocal+"ImprimerLotSansGceDoc",t.responseType=null,t.params=r,t.method=o.MethodEnum.POST,t.async=!0,t.timeout=36e5,t.contentType=o.ContentTypeEnum.JSON,t.data=e,t.originalResponse=!0,this.libraryManager.Core.sendRequest(t).then(function(e){switch(e.status){case 200:return 0;case 204:return 2;default:throw new Error("Code retour non reconnu : "+e.status)}})},e}(i.ImpressionApiBase),i.ImpressionApiPetra=r}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-impression-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var n in s)s.hasOwnProperty(n)&&(e[n]=s[n])};return function(e,s){function n(){this.constructor=e}a(e,s),e.prototype=null===s?Object.create(s):(n.prototype=s.prototype,new n)}}();!function(e){var s,l,n;s=e.Services||(e.Services={}),l=s.DonneesDelocalisees||(s.DonneesDelocalisees={}),n=function(i){function e(){return i.call(this,s.Components.ComponentType.DonneesDelocalisees)||this}return __extends(e,i),e.prototype.reception=function(e){switch(e.subject){case l.Messages.DonneesDelocaliseesMessageSubject.GetDonneesDelocalisees:var s=(r=e.message).numEtablissement,n=r.objectDataName;return this.managerInstance.getDonneesDelocalisees(s,n);case l.Messages.DonneesDelocaliseesMessageSubject.GetListeDonneesDelocalisees:s=(r=e.message).numEtablissement;var a=r.objectDataNames;return this.managerInstance.getListeDonneesDelocalisees(s,a);case l.Messages.DonneesDelocaliseesMessageSubject.GetRubriqueLibelle:s=(r=e.message).numEtablissement,n=r.objectDataName;var t=r.code;return this.managerInstance.getRubriqueLibelle(s,n,t);case l.Messages.DonneesDelocaliseesMessageSubject.GetDonneesParCriteres:s=(r=e.message).numEtablissement,n=r.objectDataName;var o=r.criteres;return this.managerInstance.getDonneesParCriteres(s,n,o);case l.Messages.DonneesDelocaliseesMessageSubject.ReInitDbDonneesDelocalisees:var r=e.message;return this.managerInstance.reInitDbDonneesDelocalisees();case l.Messages.DonneesDelocaliseesMessageSubject.GetTDTById:var c=(r=e.message).idTDT;return this.managerInstance.getTDTById(c);case l.Messages.DonneesDelocaliseesMessageSubject.DeleteTDTById:return c=(r=e.message).idTDT,this.managerInstance.deleteTDTById(c);default:return i.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.DonneesDelocalisees.DonneesDelocaliseesManagerMessage",e.logger=s.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(s.Components.ComponentManagerMessageBase),l.DonneesDelocaliseesManagerMessage=n,s.Components.RegistryManagerMessage.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-donnees-delocalisees-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}o(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={})),function(e){var t,n,o;t=e.Services||(e.Services={}),n=t.DonneesDelocalisees||(t.DonneesDelocalisees={}),o=function(e){function n(){return e.call(this,t.Components.ComponentType.DonneesDelocalisees)||this}return __extends(n,e),n.prototype.getDonneesDelocalisees=function(e,n){return this.manager.getDonneesDelocalisees(e,n)},n.prototype.getListeDonneesDelocalisees=function(e,n){return this.manager.getListeDonneesDelocalisees(e,n)},n.prototype.getRubriqueLibelle=function(e,n,t){return this.manager.getRubriqueLibelle(e,n,t)},n.prototype.getDonneesParCriteres=function(e,n,t){return this.manager.getDonneesParCriteres(e,n,t)},n}(t.Components.ComponentManagerExtendedBase),n.DonneesDelocaliseesManagerExtended=o,t.Components.RegistryManagerExtended.getInstance().register(o)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-donnees-delocalisees-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();!function(e){var g;(function(e){var r=function(i){function c(){var e=i.call(this,g.Components.ComponentType.Numerisation)||this;return e.api=null,e}return __extends(c,i),c.prototype.init=function(e,r,t,n){return this.api=n,i.prototype.init.call(this,e,r,t,n)},c.prototype.numeriser=function(e,n){var i=this,r="",o="";if(g.Controle.StaticStringControle.isStringNotEmpty(e)||(r+="Le paramètre 'data' est obligatoire et doit être une chaine de caractères non vide / "),g.Controle.StaticAnyControle.isNotUndefinedAndNotNull(n)?(g.Controle.StaticStringControle.isStringNotEmpty(n.dropZonePath)||(r+="Le paramètre 'numerisationParams.dropZonePath' est obligatoire et doit être une chaine de caractères non vide / "),g.Controle.StaticStringControle.isStringNotEmpty(n.configurationFilePath)||(r+="Le paramètre 'numerisationParams.configurationFilePath' est obligatoire et doit être une chaine de caractères non vide / ")):r+="Le paramètre 'numerisationParams' est obligatoire et doit être de type 'NumerisationParams' / ",""!=r)return r=r.substring(0,r.lastIndexOf("/")-1),g.Loggers.FLASH.INSTANCE.setValue("action","numeriser"),c.logger.error(r),this.library.Core.createPromiseSelfError(new g.Erreur(g.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[r]));var s={};return s.data=e,this.library.Core.promesseTryCatch(function(t){i.library.Libelle.afficherMessage(g.Libelle.LibelleModel.TEC.NUMERISATION_EN_COURS,g.Libelle.TYPE_AFFICHAGE.VIDE,null,0,null,function(){i.library.Context.getAuthentificationInfo().then(function(e){if(e&&(o=e.codeEtablissement),""===o){var r=new g.Erreur(g.Libelle.LibelleModel.COM.ERREUR_CONTEXTE_RECUP_CODE_ETAB_IMPOSSIBLE);return g.Loggers.FLASH.INSTANCE.setValue("action","numeriser"),i.library.Libelle.constituerLibelle(r.codeLibelle).then(function(e){c.logger.error(e)}),i.library.Display.FermerModalMessage(),void t.reject(r)}i.getDonneesDelocaliseesNumerisation(o,s,"").then(function(){var e=new a(n.dropZonePath,n.configurationFilePath,o,!0);i.api.numeriserDocument(s,e).then(function(){i.library.Display.FermerModalMessage(),c.logger.debug("numeriserDocument success"),t.resolve()},function(e){i.library.Display.FermerModalMessage(),c.logger.error("numeriserDocument failed - %1",JSON.stringify(e)),t.reject(e)})},function(){g.Loggers.FLASH.INSTANCE.setValue("action","numeriser"),i.library.Libelle.constituerLibelle(g.Libelle.LibelleModel.COM.ERREUR_NUMERISATION_RECUP_DONNEES_DELOCALISEES_IMPOSSIBLE).then(function(e){c.logger.warn(e)}),s.CCLI_TYP={},s.CCLI_UTL={},s.NATURE={};var e=new a(n.dropZonePath,n.configurationFilePath,o,!1);i.api.numeriserDocument(s,e).then(function(){i.library.Display.FermerModalMessage(),c.logger.debug("numeriserDocument success"),t.resolve()},function(e){i.library.Display.FermerModalMessage(),c.logger.error("numeriserDocument failed - %1",JSON.stringify(e)),t.reject(e)})})},t.reject)})})},c.prototype.getSpiFactoryActivationStatut=function(){return this.api.getSpiFactoryActivationStatutOnServeur().then(function(e){return c.logger.debug("Statut de la présence du jeton d'activation SpiFactory sur le serveur d'agence : %1",e),e},function(e){throw c.logger.error("Statut de la présence du jeton d'activation SpiFactory sur le serveur d'agence : %1",JSON.stringify(e)),e})},c.prototype.numeriserArcade=function(e,r){var o=this,t="",s="",a="";if(g.Controle.StaticStringControle.isStringNotEmpty(e)||(t+="Le paramètre 'data' est obligatoire et doit être une chaine de caractères non vide / "),""!=t)return t=t.substring(0,t.lastIndexOf("/")-1),g.Loggers.FLASH.INSTANCE.setValue("action","numeriserArcade"),c.logger.error(t),this.library.Core.createPromiseSelfError(new g.Erreur(g.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[t]));var l={};return l.data=e,this.library.Core.promesseTryCatch(function(i){o.library.Libelle.afficherMessage(g.Libelle.LibelleModel.TEC.NUMERISATION_EN_COURS,g.Libelle.TYPE_AFFICHAGE.VIDE,null,0,null,function(){o.library.Context.getAuthentificationInfo().then(function(e){s=e.codeEtablissement;var r=o.library.Context.GetParametresComptables();if(r&&(a=r.edsExterneGuichetComptable),!g.Controle.StaticStringControle.isStringNotEmpty(s)){var t=new g.Erreur(g.Libelle.LibelleModel.COM.ERREUR_CONTEXTE_RECUP_CODE_ETAB_IMPOSSIBLE);return g.Loggers.FLASH.INSTANCE.setValue("action","numeriserArcade"),o.library.Libelle.constituerLibelle(t.codeLibelle).then(function(e){c.logger.error(e)}),o.library.Display.FermerModalMessage(),void i.reject(t)}if(!g.Controle.StaticStringControle.isStringNotEmpty(a)){var n=new g.Erreur(g.Libelle.LibelleModel.COM.ERREUR_CONTEXTE_RECUP_ID_AGENCE_IMPOSSIBLE);return g.Loggers.FLASH.INSTANCE.setValue("action","numeriserArcade"),o.library.Libelle.constituerLibelle(n.codeLibelle).then(function(e){c.logger.error(e)}),o.library.Display.FermerModalMessage(),void i.reject(n)}o.getDonneesDelocaliseesNumerisationArcade(s,l,"").then(function(){var e=new u(s,a,!0);o.api.numeriserDocumentArcade(l,e).then(function(){o.library.Display.FermerModalMessage(),c.logger.debug("numeriserDocumentArcade success"),i.resolve()},function(e){o.library.Display.FermerModalMessage(),c.logger.error("numeriserDocumentArcade failed - %1",JSON.stringify(e)),i.reject(e)})},function(){g.Loggers.FLASH.INSTANCE.setValue("action","numeriserArcade"),o.library.Libelle.constituerLibelle(g.Libelle.LibelleModel.COM.ERREUR_NUMERISATION_RECUP_DONNEES_DELOCALISEES_IMPOSSIBLE).then(function(e){c.logger.warn(e)}),l.D93F={},l.D93G={},l.D93J={},l.D93K={},l.D93M={},l.D93T={},l.D93V={},l.D93Y={};var e=new u(s,a,!1);o.api.numeriserDocumentArcade(l,e).then(function(){o.library.Display.FermerModalMessage(),c.logger.debug("numeriserDocumentArcade success"),i.resolve()},function(e){o.library.Display.FermerModalMessage(),c.logger.error("numeriserDocumentArcade failed - %1",JSON.stringify(e)),i.reject(e)})})})})})},c.prototype.getDonneesDelocaliseesNumerisation=function(r,t,e){var n=this;switch(e){case"CCLI_TYP":return this.library.DonneesDelocalisees.getDonneesDelocalisees(r,e).then(function(e){return t.CCLI_TYP=e,n.getDonneesDelocaliseesNumerisation(r,t,"CCLI_UTL")});case"CCLI_UTL":return this.library.DonneesDelocalisees.getDonneesDelocalisees(r,e).then(function(e){return t.CCLI_UTL=e,n.getDonneesDelocaliseesNumerisation(r,t,"NATURE")});case"NATURE":return this.library.DonneesDelocalisees.getDonneesDelocalisees(r,e).then(function(e){t.NATURE=e});default:return this.getDonneesDelocaliseesNumerisation(r,t,"CCLI_TYP")}},c.prototype.getDonneesDelocaliseesNumerisationArcade=function(r,t,e){var n=this;switch(e){case"D93F":return this.library.DonneesDelocalisees.getDonneesDelocalisees(r,e).then(function(e){return t.D93F=e,n.getDonneesDelocaliseesNumerisationArcade(r,t,"D93G")});case"D93G":return this.library.DonneesDelocalisees.getDonneesDelocalisees(r,e).then(function(e){return t.D93G=e,n.getDonneesDelocaliseesNumerisationArcade(r,t,"D93J")});case"D93J":return this.library.DonneesDelocalisees.getDonneesDelocalisees(r,e).then(function(e){return t.D93J=e,n.getDonneesDelocaliseesNumerisationArcade(r,t,"D93K")});case"D93K":return this.library.DonneesDelocalisees.getDonneesDelocalisees(r,e).then(function(e){return t.D93K=e,n.getDonneesDelocaliseesNumerisationArcade(r,t,"D93M")});case"D93M":return this.library.DonneesDelocalisees.getDonneesDelocalisees(r,e).then(function(e){return t.D93M=e,n.getDonneesDelocaliseesNumerisationArcade(r,t,"D93T")});case"D93T":return this.library.DonneesDelocalisees.getDonneesDelocalisees(r,e).then(function(e){return t.D93T=e,n.getDonneesDelocaliseesNumerisationArcade(r,t,"D93V")});case"D93V":return this.library.DonneesDelocalisees.getDonneesDelocalisees(r,e).then(function(e){return t.D93V=e,n.getDonneesDelocaliseesNumerisationArcade(r,t,"D93Y")});case"D93Y":return this.library.DonneesDelocalisees.getDonneesDelocalisees(r,e).then(function(e){t.D93Y=e});default:return this.getDonneesDelocaliseesNumerisationArcade(r,t,"D93F")}},c.CLASS_NAME="MyWay.Services.Numerisation.NumerisationManager",c.logger=g.Loggers.LoggerFactory.INSTANCE.getClass(c.CLASS_NAME),c}(g.Components.ComponentManagerBase);e.NumerisationManager=r;var a=function(e,r,t,n){this.dropZonePath=e,this.configurationFilePath=r,this.codeEtablissement=t,this.donneesDelocalisees=n},u=function(e,r,t){this.codeEtablissement=e,this.idAgence=r,this.donneesDelocalisees=t};g.Components.RegistryManager.getInstance().register(r)})((g=e.Services||(e.Services={})).Numerisation||(g.Numerisation={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-numerisation-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();!function(e){var r,t,n;r=e.Services||(e.Services={}),t=r.Mobilite||(r.Mobilite={}),n=function(){function e(){}return e.isAdresseIpValide=function(e){return!(!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)&&!/(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))/.test(e))},e}(),t.OutilsIp=n}(MyWay||(MyWay={})),function(e){var o;(function(i){i.PLAGES_IP=/^126|^172/;var e=function(){function e(e){this._data=e,this._plagesReseau=null;try{this._plagesReseau=this.formatagePlages(e)}catch(e){throw e}}return e.prototype.formatagePlages=function(e){var r=e.split("*");switch(r[0]){case"1":return r[1].split(",").map(function(e){var r=e.split("/"),t=r[0];if(!i.OutilsIp.isAdresseIpValide(t))throw new o.Erreur("La valeur de l'adresseIp est incorrecte :"+t);var n=Number(r[1]);if(isNaN(n)||n<0||32<n)throw new o.Erreur("La valeur du masque réseau est incorrecte :"+n);return{adresseIP:t,masque:n}});default:throw new o.Erreur("Type de plage réseau incorrecte")}},e.prototype.isDansPlageReseau=function(n){var i=this;return this._plagesReseau.some(function(e){var r=i.convertirMasqueEnBinaire(e.masque),t=i.convertirIPEnBinaire(n);if(i.recupererSousReseau(i.convertirIPEnBinaire(e.adresseIP),r)===i.recupererSousReseau(t,r))return!0})},e.prototype.convertirIPEnBinaire=function(e){var n="";return e.split(".").map(Number).forEach(function(e){var r=e.toString(2),t=8-r.length;r=Array(t+1).join("0")+r,n+=r}),n},e.prototype.convertirMasqueEnBinaire=function(e){return Array(e).join("1")+Array(32-e).join("0")},e.prototype.recupererSousReseau=function(e,r){var t=parseInt(e,2);return(parseInt(r,2)&t).toString(2)},e}();i.PlageReseau=e})((o=e.Services||(e.Services={})).Mobilite||(o.Mobilite={}))}(MyWay||(MyWay={})),function(r){var a,s,e;a=r.Services||(r.Services={}),s=a.Mobilite||(a.Mobilite={}),e=function(o){function i(){var e=o.call(this,a.Components.ComponentType.Mobilite)||this;return e.api=null,e.contextKey="MOBILITE",e.recupIpPromesse=null,e.recupIpTimeout=null,e.maximumTimeout=36e5,e}return __extends(i,o),i.prototype.init=function(e,r,t,n){var i=this;return this.api=n,o.prototype.init.call(this,e,r,t,n).then(function(){i.recupererAdresseIp()})},i.prototype.getCaisseAuto=function(){var e=this.library.Context.GetParametresComptables();return!(!e||!e.typeCA)},i.prototype.getEcranTactile=function(){return this.api.estEcranTactile().then(function(e){return i.logger.debug("Ecran principal tactile - statut : %1",e),e},function(e){throw i.logger.warn("Erreur lors de la récupération de l'information: écran tactile",JSON.stringify(e)),new a.Erreur(r.Services.Libelle.LibelleModel.COM.ERREUR_MOBILITE_RECUP_TYPE_ECRAN_IMPOSSIBLE)})},i.prototype.getNavigateur=function(){var e={nom:null,version:null};return e.nom=this.library.Core.GetBrowser(),e.version=this.library.Core.GetBrowserVersion(),i.logger.debug("Le navigateur utilisé est %1",JSON.stringify(e)),this.library.Core.createPromiseSelfResolved(e)},i.prototype.getPlateforme=function(){return this.api.getPlateforme().then(function(e){return i.logger.debug("La plateforme de l'utilisateur est %1",s.PLATEFORME[e]),e},function(e){throw i.logger.warn("Impossible de récupérer la plateforme de la machine"),new a.Erreur(r.Services.Libelle.LibelleModel.COM.ERREUR_MOBILITE_RECUP_PLATEFORME_MACHINE_IMPOSSIBLE)})},i.prototype.getResolutionEcran=function(){return this.api.getResolutionEcran().then(function(e){return i.logger.debug("La résolution de l'écran principal est %1",JSON.stringify(e)),e},function(e){throw i.logger.warn("Impossible de récupérer la résolution de l'écran"),new a.Erreur(r.Services.Libelle.LibelleModel.COM.ERREUR_MOBILITE_RECUP_RESOLUTION_ECRAN_IMPOSSIBLE)})},i.prototype.getInfoMachine=function(){var r={},e=[];return i.logger.debug("Start getInfoMachine"),e.push(this.getPlateforme().then(function(e){r.plateforme=e})),e.push(this.getResolutionEcran().then(function(e){r.hauteurEcran=e.hauteur,r.largeurEcran=e.largeur})),e.push(this.getEcranTactile().then(function(e){r.ecranTactile=e})),e.push(this.getNavigateur().then(function(e){r.navigateur=e})),a.Promesses.all(e).then(function(){return r},function(e){throw i.logger.warn("getInfoMachine Failed",JSON.stringify(e)),e})},i.prototype.recupererAdresseIp=function(){var n=this;return null!==this.recupIpPromesse&&Date.now()-this.recupIpTimeout<this.maximumTimeout||a.Promesses.promesseTryCatch(function(t){n.recupIpPromesse=t.promise,n.recupIpTimeout=Date.now();var e=JSON.parse(n.library.Context.GetFromContext(n.contextKey));e&&null!==e.adresseIp&&Date.now()-e.timeout<n.maximumTimeout?t.resolve(e.adresseIp):n.api.getAdresseIp().then(function(e){if(!s.OutilsIp.isAdresseIpValide(e))return t.reject(new a.Erreur("Format de l'adresse IP est incorrect"));var r={adresseIp:e,timeout:n.recupIpTimeout};n.library.Context.AddToContext(a.Context.StorageLevel.Global,n.contextKey,JSON.stringify(r)),t.resolve(e)},function(e){n.recupIpPromesse=null,i.logger.warn(e.codeLibelle,JSON.stringify(e)),t.reject(e)})}),this.recupIpPromesse},i.prototype.determinerTypeReseau=function(n){return s.PLAGES_IP.test(n)?this.api.getPlagesReseau().then(function(e){var r=new s.PlageReseau(e.configuration.VPN),t=new s.PlageReseau(e.configuration.WIFI);return r.isDansPlageReseau(n)?(i.logger.debug("Type de réseau: %1",s.TYPE_RESEAU[s.TYPE_RESEAU.VPN]),s.TYPE_RESEAU.VPN):t.isDansPlageReseau(n)?(i.logger.debug("Type de réseau: %1",s.TYPE_RESEAU[s.TYPE_RESEAU.WIFI_AGENCE]),s.TYPE_RESEAU.WIFI_AGENCE):(i.logger.debug("Type de réseau: %1",s.TYPE_RESEAU[s.TYPE_RESEAU.FILAIRE]),s.TYPE_RESEAU.FILAIRE)}):(i.logger.warn("Type de réseau: %1 - Adresse IP: %2",s.TYPE_RESEAU[s.TYPE_RESEAU.INCONNU],n),this.library.Core.createPromiseSelfResolved(s.TYPE_RESEAU.INCONNU))},i.prototype.getReseau=function(){var r=this;return this.recupererAdresseIp().then(function(e){return i.logger.debug("Adresse IP du poste %1",e),r.determinerTypeReseau(e)},function(e){return i.logger.warn("Impossible de récupérer l'adresse IP du poste : %1",JSON.stringify(e.codeLibelle)),s.TYPE_RESEAU.INCONNU})},i.prototype.getPeripheriques=function(e){var r=[];this.getCaisseAuto()&&r.push(new s.CaisseAuto);var t=[];return t.push(this.getTablettesSignatures(e).then(function(e){r=r.concat(e)})),a.Promesses.all(t).then(function(){return i.logger.debug("Liste des périphériques connectés: %1",JSON.stringify(r)),r},function(e){throw i.logger.warn("Erreur lors de la récupération la liste des périphériques connectés: %1",JSON.stringify(e)),e})},i.prototype.getPeripheriquesParType=function(t,e){return this.getPeripheriques(e).then(function(e){var r=e.filter(function(e){return e.typePeripherique===t}).map(function(e){return e});return i.logger.debug("Liste de périphériques de type %1 connectées: %2",s.TYPE_PERIPHERIQUE[t],JSON.stringify(r)),r}).catch(function(e){throw i.logger.warn("Erreur lors de la récupération la liste des périphériques connectés: %1",JSON.stringify(e)),e})},i.prototype.getTablettesSignatures=function(e){return i.logger.info(JSON.stringify(e)),this.api.listeTablettesSignatures(e).catch(function(e){throw new a.Erreur(r.Services.Libelle.LibelleModel.COM.ERREUR_MOBILITE_RECUP_LISTE_TABLETTES_SIGNATURES_IMPOSSIBLE)})},i.CLASS_NAME="MyWay.Services.Mobilite.MobiliteManager",i.logger=a.Loggers.LoggerFactory.INSTANCE.getClass(i.CLASS_NAME),i}(a.Components.ComponentManagerBase),s.MobiliteManager=e,a.Components.RegistryManager.getInstance().register(e)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-mobilite-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var n,a,t;n=e.Services||(e.Services={}),a=n.Performance||(n.Performance={}),t=function(o){function r(){var e=o.call(this,n.Components.ComponentType.Performance)||this;return e.api=null,e.tracesInProgress={},e}return __extends(r,o),r.prototype.init=function(e,t,r,s){return this.api=s,o.prototype.init.call(this,e,t,r,s)},r.prototype.step=function(e,t,r){return this.tracesInProgress[e]||(this.tracesInProgress[e]={id:e,startAt:Date.now(),timeout:null,traces:[]}),this.refreshTimeout(e),this.tracesInProgress[e].traces.push({label:t,timestamp:Date.now(),type:r}),n.Promesses.createPromiseSelfResolved()},r.prototype.end=function(e,t){var r=this;return this.tracesInProgress[e]?this.step(e,t).then(function(){return r.send(e,!1)}):n.Promesses.getPromesseSelfResoved()},r.prototype.cancel=function(e){if(!this.tracesInProgress[e])return n.Promesses.getPromesseSelfResoved();this.tracesInProgress[e].timeout&&clearTimeout(this.tracesInProgress[e].timeout),delete this.tracesInProgress[e]},r.prototype.refreshTimeout=function(e){var t=this;this.tracesInProgress[e].timeout&&clearTimeout(this.tracesInProgress[e].timeout),this.tracesInProgress[e].timeout=setTimeout(function(){t.send(e,!0)},r.TIMEOUT)},r.prototype.send=function(e,t){this.tracesInProgress[e].timeout&&clearTimeout(this.tracesInProgress[e].timeout);var r=Date.now(),s=this.tracesInProgress[e];if(delete this.tracesInProgress[e],0===s.traces.length)return n.Promesses.createPromiseSelfResolved();var o=s.traces[s.traces.length-1];return this.api.send([{stepId:e,label:o.label,totalStartDuration:r-s.startAt,totalUserDuration:r-s.startAt,isAuto:s.traces[s.traces.length-1].label===a.AppLoadingPerformanceStep.AUTO_END,isTimeout:t,isHttpRequest:o.type===a.PerformanceType.HTTP_REQUEST}])},r.CLASS_NAME="MyWay.Services.Performance.PerformanceManager",r.logger=n.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME),r.TIMEOUT=6e4,r}(n.Components.ComponentManagerBase),a.PerformanceManager=t,n.Components.RegistryManager.getInstance().register(t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-performance-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var n,r,t;n=e.Services||(e.Services={}),r=n.Application||(n.Application={}),t=function(e){function t(){return e.call(this,n.Components.ComponentType.Application)||this}return __extends(t,e),t.prototype.Demarrer=function(e){return this.sendMessage(r.Messages.ApplicationMessageSubject.Demarrer,{codeApplication:e})},t.prototype.DemarrerProcessus=function(e,t,n,o){return void 0===t&&(t=null),void 0===o&&(o=null),this.sendMessage(r.Messages.ApplicationMessageSubject.DemarrerProcessus,{codeProcessus:e,delegationPortail:t,initData:n,valeurDepart:o})},t}(n.Components.ComponentAgentBase),r.ApplicationAgent=t,n.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-application-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])};return function(e,t){function s(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}}();!function(e){var t;(t=e.Services||(e.Services={})).Core.defineProperty(t.TechAgentExtended,"LisaTechAgent",{get:function(){return this._techLibrary.LisaTechAgent}}),t.TechAgentExtended.prototype.StartProcess=function(e,t,s){return this._techLibrary.StartProcess(e,t,s)},t.TechAgentExtended.prototype.StartSubProcess=function(e,t){return this._techLibrary.StartSubProcess(e,t)},t.TechAgentExtended.prototype.StartExternalApp=function(e,t,s){return this._techLibrary.StartExternalApp(e,t,s)},t.TechAgentExtended.prototype.GetProcesses=function(){return this._techLibrary.GetProcesses()},t.TechAgentExtended.prototype.GetTools=function(){return this._techLibrary.GetTools()},t.TechAgentExtended.prototype.GetCodesProcessus=function(){return this._techLibrary.GetCodesProcessus()},t.TechAgentExtended.prototype.GetInfoProcessus=function(e){return this._techLibrary.GetInfoProcessus(e)}}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Core.defineProperty(t.TechAgent,"LisaTechAgent",{get:function(){return this._techLibrary.LisaTechAgent}}),t.TechAgent.prototype.StartProcess=function(e,t,s){return this.LisaTechAgent.StartProcess(e,t,s)},t.TechAgent.prototype.StartSubProcess=function(e,t){return this.LisaTechAgent.StartSubProcess(e,t)},t.TechAgent.prototype.StartExternalApp=function(e,t,s){return this.LisaTechAgent.StartExternalApp(e,t,s)},t.TechAgent.prototype.GetProcesses=function(){return this.LisaTechAgent.GetProcesses()},t.TechAgent.prototype.GetTools=function(){return this.LisaTechAgent.GetTools()},t.TechAgent.prototype.GetCodesProcessus=function(){return this.LisaTechAgent.GetCodesProcessus()},t.TechAgent.prototype.GetInfoProcessus=function(e){return this.LisaTechAgent.GetInfoProcessus(e)}}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).TechLibrary.addInitListener(function(e,t){e.LisaTechAgent=t.Lisa}),t.TechLibrary.prototype.StartProcess=function(e,t,s){return this.LisaTechAgent.StartProcess(e,t,s)},t.TechLibrary.prototype.StartSubProcess=function(e,t){return this.LisaTechAgent.StartSubProcess(e,t)},t.TechLibrary.prototype.StartExternalApp=function(e,t,s){return this.LisaTechAgent.StartExternalApp(e,t,s)},t.TechLibrary.prototype.GetProcesses=function(){return this.LisaTechAgent.GetProcesses()},t.TechLibrary.prototype.GetTools=function(){return this.LisaTechAgent.GetTools()},t.TechLibrary.prototype.GetCodesProcessus=function(){return this.LisaTechAgent.GetCodesProcessus()},t.TechLibrary.prototype.GetInfoProcessus=function(e){return this.LisaTechAgent.GetInfoProcessus(e)}}(MyWay||(MyWay={})),function(e){var s,r,t;s=e.Services||(e.Services={}),r=s.Lisa||(s.Lisa={}),t=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.StartProcess=function(e,t,s){return this.sendMessage(r.Messages.LisaMessageSubject.StartProcess,{processCode:e,initData:t,valeurDepart:s})},t.prototype.StartSubProcess=function(e,t){return this.sendMessage(r.Messages.LisaMessageSubject.StartSubProcess,{processCode:e,valeurDepart:t})},t.prototype.StartExternalApp=function(e,t,s){return this.sendMessage(r.Messages.LisaMessageSubject.StartExternalApp,{name:e,url:t,standAlone:s})},t.prototype.GetProcesses=function(){return this.library.Core.createPromiseSelfError(new s.Erreur("Not implemented"))},t.prototype.GetTools=function(){return this.sendMessage(r.Messages.LisaMessageSubject.GetTools,{})},t.prototype.GetCodesProcessus=function(){return this.sendMessage(r.Messages.LisaMessageSubject.GetCodesProcessus,{})},t.prototype.GetInfoProcessus=function(e){return this.sendMessage(r.Messages.LisaMessageSubject.GetInfoProcessus,{codeProcessus:e})},t}(r.LisaAgent),r.LisaTechAgent=t,s.Components.RegistryAgent.getInstance().register(t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-lisa-tech-agent.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();!function(r){var m;(function(l){var e=function(n){function s(){var e=n.call(this,m.Components.ComponentType.Impression)||this;return e.api=null,e}return __extends(s,n),s.prototype.init=function(e,r,i,t){return this.api=t,n.prototype.init.call(this,e,r,i,t)},s.prototype.getAuthentificationInfo=function(){return this.library.Context.getAuthentificationInfo().catch(function(e){throw s.logger.error("Les données d'authentification n'ont pas pu être récupérées"),new m.Erreur(m.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,["Les données d'authentification n'ont pas pu être récupérées"])})},s.prototype.gererErreur=function(e){return s.logger.error(e),this.library.Core.createPromiseSelfError(new m.Erreur(m.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,[e]))},s.prototype.generer=function(i,t){var e,n=this;return s.logger.debug("Start API Impression.generer"),""!==(e=l.controleGenerer(i,t))?this.gererErreur(e):this.getAuthentificationInfo().then(function(e){var r=new p(t);return n.api.genererDocument(i,r,e).then(function(e){return s.logger.debug("ServiceApi.Impression.genererDocument success"),e},function(e){throw s.logger.error("ServiceApi.Impression.genererDocument failed - %1",JSON.stringify(e)),e})})},s.prototype.imprimer=function(e,r){var i;if(s.logger.debug("Start API Impression.imprimer"),""!==(i=l.controleImprimer(e,r)))return this.gererErreur(i);var t=new c(r);return this.api.imprimerDocument(e,t)},s.prototype.imprimerLot=function(r,t){var e,n=this;return s.logger.debug("Start API Impression.imprimerLot"),""!==(e=l.controleImprimerLot(r,t))?this.gererErreur(e):this.library.Core.promesseTryCatch(function(i){n.getAuthentificationInfo().then(function(e){n.library.Libelle.afficherMessage("Récupération des documents en GED en cours. Merci de patienter.",m.Libelle.TYPE_AFFICHAGE.VIDE,null,0,null,function(){n.api.getDocumentGEDLot(r,e).then(function(e){r=e,n.library.Display.FermerModalMessage()}).then(function(){var e=new o(t);return n.api.imprimerDocumentLot(r,e).then(i.resolve,i.reject)}).catch(function(e){var r="Une erreur est survenue lors de la récupération de document en GED : {0}";r=r.replace("{0}",e.codeLibelle),n.library.Display.FermerModalMessage(),n.gererErreur(r).then(i.resolve,i.reject)})})},i.reject)})},s.prototype.genererImprimer=function(n,o){var e,a=this;return s.logger.debug("Start API Impression.genererImprimer"),""!==(e=l.controleGenererImprimer(n,o))?this.gererErreur(e):this.library.Core.promesseTryCatch(function(t){a.getAuthentificationInfo().then(function(e){var r=new p(o),i=new c(o);s.logger.debug("Contrôle de paramètres OK"),a.library.Libelle.afficherMessage(m.Libelle.LibelleModel.TEC.IMPRESSION_GENERATION_IMPRESSION_EN_COURS,m.Libelle.TYPE_AFFICHAGE.VIDE,null,0,null,function(){s.logger.debug("Modale ouverte -> Appel au service de génération"),a.api.genererDocument(n,r,e).then(function(r){m.Controle.StaticAnyControle.isNotUndefinedAndNotNull(r)?a.api.imprimerDocument(r.Fichier,i).then(function(e){a.library.Display.FermerModalMessage(),r.codeRetour=e,t.resolve(r)},function(e){a.library.Display.FermerModalMessage(),s.logger.error("ServiceApi.Impression.genererDocument Failed - %1",JSON.stringify(e)),t.reject(e)}):a.gererErreur("Erreur: document non généré").then(t.resolve,function(e){a.library.Display.FermerModalMessage(),s.logger.error("ServiceApi.Impression.genererDocument Failed - %1",JSON.stringify(e)),t.reject(e)})},function(e){a.library.Display.FermerModalMessage(),s.logger.error("ServiceApi.Impression.genererDocument Failed - %1",JSON.stringify(e)),t.reject(e)})})})})},s.prototype.getJsonConverti=function(r){return this.api.getJsonConverti(r).then(function(e){return m.Loggers.FLASH.INSTANCE.setValue("details",e),s.logger.debug("getJsonConverti Success"),m.Promesses.createPromiseSelfResolved(e)}).catch(function(e){return m.Loggers.FLASH.INSTANCE.setValue("details",r),s.logger.error("getJsonConverti failed - %1",JSON.stringify(e)),m.Promesses.createPromiseSelfError(e)})},s.CLASS_NAME="MyWay.Services.Impression.ImpressionManager",s.logger=m.Loggers.LoggerFactory.INSTANCE.getClass(s.CLASS_NAME),s}(m.Components.ComponentManagerBase);l.ImpressionManager=e;var p=function(e){this.serializedGenerationParams={},this.serializedGenerationParams.parametreGenerationSysteme=e.systeme,this.serializedGenerationParams.parametresGenerationObligatoires={},this.serializedGenerationParams.parametresGenerationObligatoires.action=r.Services.CoreCommon.EnumUtils.getName(l.GENERATION_ACTION,e.obligatoires.action),this.serializedGenerationParams.parametresGenerationObligatoires.parametresGenerationFichier={typeFichier:r.Services.CoreCommon.EnumUtils.getName(m.Fichier.TYPE_FICHIER,e.obligatoires.parametresGenerationFichier.typeFichier),restitutionVersion:e.obligatoires.parametresGenerationFichier.restitutionVersion,sousRepModele:e.obligatoires.parametresGenerationFichier.sousRepModele},this.serializedGenerationParams.parametresGenerationOptionnels={archivage:e.optionnels.archivage,blocGenerique:null}},c=function(e){this.serializedImpressionParams={},this.serializedImpressionParams.obligatoires={nomFichier:e.obligatoires.nomFichier},this.serializedImpressionParams.optionnels={},this.serializedImpressionParams.optionnels.parametreActiveX={annul:!1,voir:!1,enregistrer:!1,blocnbex:!1,nbcopiesdef:0},m.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametreActiveX)&&m.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e.optionnels.parametreActiveX)&&(m.Controle.StaticBooleanControle.isBoolean(e.optionnels.parametreActiveX.annul)&&(this.serializedImpressionParams.optionnels.parametreActiveX.annul=e.optionnels.parametreActiveX.annul),m.Controle.StaticBooleanControle.isBoolean(e.optionnels.parametreActiveX.voir)&&(this.serializedImpressionParams.optionnels.parametreActiveX.voir=e.optionnels.parametreActiveX.voir),m.Controle.StaticBooleanControle.isBoolean(e.optionnels.parametreActiveX.enregistrer)&&(this.serializedImpressionParams.optionnels.parametreActiveX.enregistrer=e.optionnels.parametreActiveX.enregistrer),m.Controle.StaticBooleanControle.isBoolean(e.optionnels.parametreActiveX.blocnbex)&&(this.serializedImpressionParams.optionnels.parametreActiveX.blocnbex=e.optionnels.parametreActiveX.blocnbex),m.Controle.StaticNumberControle.isNumber(e.optionnels.parametreActiveX.mincop)&&(this.serializedImpressionParams.optionnels.parametreActiveX.mincop=e.optionnels.parametreActiveX.mincop),m.Controle.StaticNumberControle.isNumber(e.optionnels.parametreActiveX.nbcopiesdef)&&(this.serializedImpressionParams.optionnels.parametreActiveX.nbcopiesdef=e.optionnels.parametreActiveX.nbcopiesdef>=this.serializedImpressionParams.optionnels.parametreActiveX.mincop?e.optionnels.parametreActiveX.nbcopiesdef:this.serializedImpressionParams.optionnels.parametreActiveX.mincop),m.Controle.StaticNumberControle.isNumber(e.optionnels.parametreActiveX.maxcop)&&(this.serializedImpressionParams.optionnels.parametreActiveX.maxcop=e.optionnels.parametreActiveX.maxcop))},o=function(e){this.serializedImpressionParams={annul:!1,impdef:!1,affred:!1,reimp:!1},m.Controle.StaticAnyControle.isNotUndefinedAndNotNull(e)&&(m.Controle.StaticBooleanControle.isBoolean(e.annul)&&(this.serializedImpressionParams.annul=e.annul),m.Controle.StaticBooleanControle.isBoolean(e.impdef)&&(this.serializedImpressionParams.impdef=e.impdef),m.Controle.StaticBooleanControle.isBoolean(e.affred)&&(this.serializedImpressionParams.affred=e.affred),m.Controle.StaticBooleanControle.isBoolean(e.reimp)&&(this.serializedImpressionParams.reimp=e.reimp))};m.Components.RegistryManager.getInstance().register(e)})((m=r.Services||(r.Services={})).Impression||(m.Impression={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-impression-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t,o,r;t=e.Services||(e.Services={}),o=t.Numerisation||(t.Numerisation={}),r=function(s){function e(){return s.call(this,t.Components.ComponentType.Numerisation)||this}return __extends(e,s),e.prototype.reception=function(e){switch(e.subject){case o.NumerisationMessageSubject.Numeriser:var t=(a=e.message).data,r=a.numerisationParams;return this.managerInstance.numeriser(t,r);case o.NumerisationMessageSubject.GetSpiFactoryActivationStatut:var a=e.message;return this.managerInstance.getSpiFactoryActivationStatut();case o.NumerisationMessageSubject.NumeriserArcade:t=(a=e.message).data;var n=a.numerisationParams;return this.managerInstance.numeriserArcade(t,n);default:return s.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Numerisation.NumerisationManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),o.NumerisationManagerMessage=r,t.Components.RegistryManagerMessage.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-numerisation-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var s in t)t.hasOwnProperty(s)&&(e[s]=t[s])};return function(e,t){function s(){this.constructor=e}r(e,t),e.prototype=null===t?Object.create(t):(s.prototype=t.prototype,new s)}}();!function(e){var t,a,s;t=e.Services||(e.Services={}),a=t.Mobilite||(t.Mobilite={}),s=function(n){function e(){return n.call(this,t.Components.ComponentType.Mobilite)||this}return __extends(e,n),e.prototype.reception=function(e){switch(e.subject){case a.Messages.MobiliteMessageSubject.GetInfoMachine:var t=e.message;return this.managerInstance.getInfoMachine();case a.Messages.MobiliteMessageSubject.GetPeripheriques:return t=e.message,this.managerInstance.getPeripheriques();case a.Messages.MobiliteMessageSubject.GetPeripheriquesParType:var s=(t=e.message).typePeripherique,r=t.params;return this.managerInstance.getPeripheriquesParType(s,r);case a.Messages.MobiliteMessageSubject.GetReseau:return t=e.message,this.managerInstance.getReseau();default:return n.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Mobilite.MobiliteManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),a.MobiliteManagerMessage=s,t.Components.RegistryManagerMessage.getInstance().register(s)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-mobilite-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}i(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(o){var E,s,e;E=o.Services||(o.Services={}),s=E.Capacites||(E.Capacites={}),e=function(i){function a(){var e=i.call(this,E.Components.ComponentType.Capacites)||this;return e._isTotemCapable=!0,e}return __extends(a,i),a.prototype.init=function(e,t,r){return this.capabilities=e,i.prototype.init.call(this,e,t,r)},a.prototype.setTotemCapable=function(e){this._isTotemCapable=e},a.prototype.resolve=function(e){var r=E.CoreCommon.ServiceDePromesse.defer();switch(e){case s.REGLE.MODIFIER_HABILITATION:var t=this.libraryManager.Context.GetFromContext(a.URL_SPA_KEY);/myway-[pP]+/.test(t)?r.resolve(!1):r.resolve(!0),E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.MODIFIER_HABILITATION"),a.logger.debug("GetFromContext of URL_SPA_KEY Success");break;case s.REGLE.CAISSE_AUTO:this.libraryManager.Mobilite.getPeripheriquesParType(E.Mobilite.TYPE_PERIPHERIQUE.CAISSE_AUTO).then(function(e){0<e.length?r.resolve(!0):r.resolve(!1),E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.CAISSE_AUTO"),a.logger.debug("getPeripheriquesParType Success")}).catch(function(e){E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.CAISSE_AUTO"),a.logger.error("getPeripheriquesParType failed - %1",JSON.stringify(e)),r.reject(e)});break;case s.REGLE.ECRAN_COMPATIBLE_MYWAY:this.libraryManager.Mobilite.getInfoMachine().then(function(e){var t=e.hauteurEcran&&e.hauteurEcran>=a.HAUTEUR_MINIMALE_MYWAY&&e.largeurEcran&&e.largeurEcran>=a.LARGEUR_MINIMALE_MYWAY;!0===t?r.resolve(!0):r.resolve(!1),E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.ECRAN_COMPATIBLE_MYWAY"),a.logger.debug("getInfoMachine Success - %1",t)}).catch(function(e){E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.ECRAN_COMPATIBLE_MYWAY"),a.logger.error("getInfoMachine failed - %1",JSON.stringify(e)),r.reject(e)});break;case s.REGLE.INTEROP_APPLI_BANCAIRE:E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.INTEROP_APPLI_BANCAIRE"),a.logger.debug("deviceCapabilities.InteropAppliBancaire Success - %1",this.capabilities.InteropAppliBancaire),r.resolve(this.capabilities.InteropAppliBancaire);break;case s.REGLE.INTEROP_WINDOWS:E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.INTEROP_WINDOWS"),a.logger.debug("deviceCapabilities.ServiceLocal Success - %1",this.capabilities.ServiceLocal),r.resolve(this.capabilities.ServiceLocal);break;case s.REGLE.RESEAU_INTERNE:this.libraryManager.Mobilite.getReseau().then(function(e){e===E.Mobilite.TYPE_RESEAU.FILAIRE||e===E.Mobilite.TYPE_RESEAU.WIFI_AGENCE||e===E.Mobilite.TYPE_RESEAU.VPN?r.resolve(!0):r.resolve(!1),E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.RESEAU_INTERNE"),a.logger.debug("getReseau Success - %1",e)}).catch(function(e){E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.RESEAU_INTERNE"),a.logger.error("getReseau failed - %1",JSON.stringify(e)),r.reject(e)});break;case s.REGLE.TABLETTE_SIGNATURE:this.libraryManager.Mobilite.getPeripheriquesParType(E.Mobilite.TYPE_PERIPHERIQUE.TABLETTE_SIGNATURE).then(function(e){0<e.length?r.resolve(!0):r.resolve(!1),E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.TABLETTE_SIGNATURE"),a.logger.debug("getPeripheriquesParType Success - %1",JSON.stringify(e))}).catch(function(e){E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.TABLETTE_SIGNATURE"),a.logger.error("getPeripheriquesParType failed - %1",JSON.stringify(e)),r.reject(e)});break;case s.REGLE.CONNECTE:this.libraryManager.Mobilite.getReseau().then(function(e){e!==E.Mobilite.TYPE_RESEAU.DECONNECTE?r.resolve(!0):r.resolve(!1),E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.CONNECTE"),a.logger.debug("getReseau Success - %1",e)}).catch(function(e){E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.CONNECTE"),a.logger.error("getReseau failed - %1",JSON.stringify(e)),r.reject(e)});break;case s.REGLE.PORTAIL_MYWAY:E.Loggers.FLASH.INSTANCE.setValue("action","REGLE.PORTAIL_MYWAY"),a.logger.debug("deviceCapabilities.PORTAIL_MYWAY Success - %1",this._isTotemCapable),r.resolve(this._isTotemCapable);break;default:var i=new E.Erreur(o.Services.Libelle.LibelleModel.COM.ERREUR_CAPACITES_REGLE_INCONNU);a.logger.error("Règle capacité inconnue"),r.reject(i)}return r.promise},a.CLASS_NAME="MyWay.Services.Capacites.CapacitesApi",a.logger=E.Loggers.LoggerFactory.INSTANCE.getClass(a.CLASS_NAME),a.URL_SPA_KEY="URL-SPA",a.LARGEUR_MINIMALE_MYWAY=1280,a.HAUTEUR_MINIMALE_MYWAY=800,a}(E.Components.ComponentApiBase),s.CapacitesApi=e,E.Components.RegistryApi.getInstance().register(e)}(MyWay||(MyWay={})),function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-capacites-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}n(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();!function(e){var r;(r=e.Services||(e.Services={})).Bug||(r.Bug={})}(MyWay||(MyWay={})),function(e){var r,t;r=e.Services||(e.Services={}),(t=r.TraceSuivi||(r.TraceSuivi={})).VERSION_BASE=10,t.DB_TRACES_NAME="DBTraceSuivi",t.DB_TABLE_TRACES="tracessuivi"}(MyWay||(MyWay={})),function(e){var f;(function(e){var v,r;(r=v=e.EventSizeChangeType||(e.EventSizeChangeType={}))[r.SET=0]="SET",r[r.ADD=1]="ADD";var t=function(){function d(e,r,t){this.hasIndexedDb=e,this.library=r,this.onSizeChange=t,this.memoryDB=[],this.memoryDBAutoincrement=0}return d.prototype.get=function(c){var e=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(a){e.actionOnDB(function(e){var r=e.transaction([d.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var o=r.objectStore(d.TABLE_NOM),s=[],i=function(r){if(r>=c.length)a.resolve(s);else{var t=c[r],n=o.get(t);n.onsuccess=function(e){n.result?s.push({cle:t,element:n.result}):(s.push(null),console.warn("Trace "+t+" isn't found!")),i(r+1)},n.onerror=function(e){console.error(e),a.reject(new f.Erreur("Erreur lors de la purge des traces de la base de données - Moment de la lecture"))}}};i(0)})});var n=[];return this.memoryDB.forEach(function(r){var t=null;c.every(function(e){return e===r.id&&(t=r),null===t}),n.push(e.elementToInstanceAvecCle(t))}),this.library.Core.createPromiseSelfResolved(n)},d.prototype.getAll=function(){var r=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(s){r.actionOnDB(function(e){var r=e.transaction([d.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(d.TABLE_NOM).openCursor(),o=[];t.onsuccess=function(e){var r=e.target.result;if(r){var t=r.value,n=r.key;o.push({cle:n,element:t}),r.continue()}else s.resolve(o)},t.onerror=function(e){console.error(e),s.reject(new f.Erreur("Erreur lors du comptage du nombre de traces"))}})});var t=[];return this.memoryDB.forEach(function(e){t.push(r.elementToInstanceAvecCle(e))}),this.library.Core.createPromiseSelfResolved(t)},d.prototype.chercher=function(i){var a=this;if(!i)return this.getAll();if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(s){a.actionOnDB(function(e){var r=e.transaction([d.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(d.TABLE_NOM).openCursor(),o=[];t.onsuccess=function(e){var r=e.target.result;if(r){var t=r.value;if(a.testTrace(t,i)){var n=r.key;o.push({cle:n,element:t})}r.continue()}else s.resolve(o)},t.onerror=function(e){console.error(e),s.reject(new f.Erreur("Erreur lors du comptage du nombre de traces"))}})});var r=[];return this.memoryDB.forEach(function(e){a.testTrace(e,i)&&r.push(a.elementToInstanceAvecCle(e))}),this.library.Core.createPromiseSelfResolved(r)},d.prototype.count=function(e){var r=this;return e||!this.hasIndexedDb?this.chercher(e).then(function(e){return e.length}):this.library.Core.promesseTryCatch(function(n){r.actionOnDB(function(e){var r=e.transaction([d.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(d.TABLE_NOM).count();t.onsuccess=function(){var e=t.result;n.resolve(e)},t.onerror=function(e){console.error(e),n.reject(new f.Erreur("Erreur lors du comptage du nombre de traces"))}})})},d.prototype.ajouter=function(a){var c=this;return this.hasIndexedDb?this.library.Core.promesseTryCatch(function(i){c.actionOnDB(function(e){var r=e.transaction([d.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var n=r.objectStore(d.TABLE_NOM),o=0,s=function(e){if(e>=a.length)return c.onSizeChange(o,v.ADD),void i.resolve();var r=a[e];o+=JSON.stringify(r.trace).length;var t=n.add(r);t.onsuccess=function(){s(e+1)},t.onerror=function(e){console.error(e),i.reject(new f.Erreur("Erreur lors de la sauvegarde d'une trace"))}};s(0)})}):(a.forEach(function(e){void 0===e.id?e.id=c.memoryDBAutoincrement++:e.id>c.memoryDBAutoincrement&&(c.memoryDBAutoincrement=e.id+1),c.memoryDB.push(e)}),this.library.Core.getPromesseSelfResoved())},d.prototype.supprimer=function(u){var l=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(c){l.actionOnDB(function(e){var r=e.transaction([d.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var s=r.objectStore(d.TABLE_NOM),i=0,a=function(t){if(t>=u.length)return l.onSizeChange(-1*i,v.ADD),void c.resolve();var n=u[t],o=s.get(n);o.onsuccess=function(e){if(!o.result)return console.warn("Trace "+n+" isn't found!"),void a(t+1);i+=JSON.stringify(o.result.trace).length;var r=s.delete(n);r.onsuccess=function(){a(t+1)},r.onerror=function(e){console.error(e),c.reject(new f.Erreur("Erreur lors de la purge des traces de la base de données - Moment de la suppression"))}},o.onerror=function(e){console.error(e),c.reject(new f.Erreur("Erreur lors de la purge des traces de la base de données - Moment de la lecture"))}};a(0)})});var e=[];return this.memoryDB.forEach(function(r){var t=!1;u.every(function(e){return!(t=e===r.id)}),t||e.push(r)}),this.memoryDB=e,this.library.Core.getPromesseSelfResoved()},d.prototype.mettreAJour=function(i){var o=this;if(this.hasIndexedDb)return this.library.Core.promesseTryCatch(function(s){o.actionOnDB(function(e){var r=e.transaction([d.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var n=r.objectStore(d.TABLE_NOM),o=function(e){if(e>=i.length)s.resolve();else{var r=i[e],t=n.put(r.element,r.cle);t.onsuccess=function(){o(e+1)},t.onerror=function(e){console.error(e),s.reject(new f.Erreur("Erreur lors du reset de la base de données"))}}};o(0)})});var e=[];return i.forEach(function(t){var n=!1;o.memoryDB.every(function(e,r){return t.cle===e.id&&(o.memoryDB[r]=t.element,n=!0),!n}),n||e.push(t.element)}),0<e.length?this.ajouter(e):this.library.Core.getPromesseSelfResoved()},d.prototype.resetAll=function(){var o=this;return this.hasIndexedDb?this.library.Core.promesseTryCatch(function(n){o.actionOnDB(function(e){var r=e.transaction([d.TABLE_NOM],"readwrite");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(d.TABLE_NOM).clear();t.onsuccess=function(e){o.onSizeChange(0,v.SET),n.resolve()},t.onerror=function(e){console.error(e),n.reject(new f.Erreur("Erreur lors du reset de la base de données"))}})}):(this.memoryDB.length=0,this.library.Core.getPromesseSelfResoved())},d.prototype.getTracesToPurge=function(){var e=this;if(!this.hasIndexedDb)return this.library.Core.createPromiseSelfResolved(this.memoryDB);var o=[];return this.library.Core.promesseTryCatch(function(n){e.actionOnDB(function(e){var r=e.transaction([d.TABLE_NOM],"readonly");r.oncomplete=function(){e.close()},r.onabort=r.oncomplete;var t=r.objectStore(d.TABLE_NOM).openCursor();t.onsuccess=function(e){var r=e.target.result;if(r){var t=r.value;t.id=r.key,o.push(t),r.continue()}else n.resolve(o)},t.onerror=function(e){console.error(e),n.reject(new f.Erreur("Erreur lors de la récupération des traces à purger"))}})})},d.prototype.actionOnDB=function(t){var e=window.indexedDB.open("myway_stc_traces_suivis",d.VERSION);e.onupgradeneeded=function(e){var r=e.target.result;switch(e.oldVersion){case 0:r.createObjectStore("traces_suivis",{autoIncrement:!0})}},e.onsuccess=function(e){var r=e.target.result;t(r)}},d.prototype.testTrace=function(e,r){return!!e.trace.processIdCurrent.match(r)},d.prototype.elementToInstanceAvecCle=function(e){return e?{cle:e.id,element:e}:null},d.VERSION=1,d.TABLE_NOM="traces_suivis",d}();e.TraceSuiviDB=t})((f=e.Services||(e.Services={})).TraceSuivi||(f.TraceSuivi={}))}(MyWay||(MyWay={})),function(e){var m;(function(c){var u,e,l=!1,d=0,s=0;(e=u||(u={}))[e.DEBUT="DEBUT"]="DEBUT",e[e.FIN="FIN"]="FIN";var r=function(i){function a(){var s=i.call(this,m.Components.ComponentType.TraceSuivi)||this;return s.tempsDePurgeMax=120,s.storageInstanceSize=null,s.storageInstancePurge=null,s.nombreMaximumDeTraceAvantPurge=20,s.traceSuiviDB=null,s.api=null,s.timerRunPurge=null,s.PURGE_TIME_WAIT_NEXT_TRACE=2e3,s.onCallbackOnFinProcessus=function(e){!function(e){var r,t;for(var n in e.subElements){var o=e.subElements[n];if(o.getPath()===e.getPath()){"ProcessStep"===o.type?((r=new c.TraceSuiviModel).state="FE",s.library.TraceSuivi.SetProcessAndStepId(r,o.getPath(),!1),s.library.TraceSuivi.tracer(r,!1)):"Process"==o.type&&s.onCallbackOnFinProcessus(o);break}}r=new c.TraceSuiviModel,t=e.isSubProcess?(r.state="FS",e.id+"|"):(r.state="FP",e.id+"|"+e.id+"|"),r.processIdCurrent===r.processIdMaster&&"FS"===r.state||(s.library.TraceSuivi.SetProcessAndStepId(r,t,!1),s.library.TraceSuivi.tracer(r,!1))}(e),s.library.TraceSuivi.purgerTraces()},s.ecrituresTracesEnCours=[],s.doitRelancerPurge=!1,s}return __extends(a,i),a.prototype.init=function(e,r,t,n){var o=this;return this.api=n,i.prototype.init.call(this,e,r,t,n).then(function(){return o.storageInstanceSize=o.library.Persistence.addStorage("traces_suivis_size",function(e){s=e.newSize}),o.storageInstancePurge=o.library.Persistence.addStorage("traces_suivis_size",function(e){l=e.action===u.FIN,d=e.nbPurgesError}),m.BaseDeDonnees.Generique.Factory.testImplementationIndexeddb().then(function(t){return o.traceSuiviDB=new c.TraceSuiviDB(t,o.library,function(e,r){if(t){switch(r){case c.EventSizeChangeType.ADD:s+=e;break;case c.EventSizeChangeType.SET:s=e;break;default:a.logger.error("L'evennement de type %1 n'est pas geré par le callback onSizeChanged() sur la base de données des traces de suivis",r)}o.storageInstanceSize.saveValue({newSize:s})}}),o.library.BaseDeDonnees.enregistrerDB("TRACE_SUIVIS",{version:c.TraceSuiviDB.VERSION,implementation:t?m.BaseDeDonnees.BaseDeDonneesImplementation.INDEXEDDB:m.BaseDeDonnees.BaseDeDonneesImplementation.MEMORY,getTables:function(){return[c.TraceSuiviDB.TABLE_NOM]},getTable:function(e){switch(e){case c.TraceSuiviDB.TABLE_NOM:return o.traceSuiviDB;default:return null}}}),o.traceSuiviDB.getAll().then(function(e){var r=0;e.forEach(function(e){e&&(r+=JSON.stringify(e.element.trace).length)}),s=r,o.storageInstanceSize.saveValue({newSize:s})})})}).then(function(){o.library.Context.addListenerOnTerminerProcessus(o.onCallbackOnFinProcessus)})},a.prototype.dispose=function(){return this.library.Context.removeListenerOnTerminerProcessus(this.onCallbackOnFinProcessus),i.prototype.dispose.call(this)},a.prototype.recupererInfos=function(r,e){if(this.library.Context){var t=this.library.Context.GetAuthentificationInfo();t&&(r.establishment=e&&void 0!==r.establishment?r.establishment:t.codeEtablissement,r.deviceId=e&&void 0!==r.deviceId?r.deviceId:t.numeroStationTravail,t.agentConnecte&&(r.agentCode=e&&void 0!==r.agentCode?r.agentCode:t.agentConnecte.referenceExterneAgent,r.computerEdsInternalId=e&&void 0!==r.computerEdsInternalId?r.computerEdsInternalId:t.agentConnecte.numeroInterneEds,r.agentEdsType=e&&void 0!==r.agentEdsType?r.agentEdsType:t.agentConnecte.typeEdsRattachement,r.agentEdsCode=e&&void 0!==r.agentEdsCode?r.agentEdsCode:t.agentConnecte.referenceExterneEdsRattachemen,r.agentEdsInternalRef=e&&void 0!==r.agentEdsInternalRef?r.agentEdsInternalRef:t.agentConnecte.numeroEdsSuperieur));var n=new Date,o=n.getTimezoneOffset(),s=Math.floor(Math.abs(o/60)),i=Math.abs(o)-60*s,a=(o<0?"+":"-")+m.CoreCommon.StringUtils.leftPad(s,"0",2)+m.CoreCommon.StringUtils.leftPad(i,"0",2);null!==r.dateUse&&void 0!==r.dateUse||(r.dateUse=n.getTime()),r.timezone=e&&void 0!==r.timezone?r.timezone:a,r.computerSi=e&&void 0!==r.computerSi?r.computerSi:m.CoreCommon.VersionMySys;var c=this.library.Context.GetPortalContext().currentPath;this.SetProcessAndStepId(r,c,e),null!==r.data&&void 0!==r.data||(r.data={});var u=this.library.Context.GetCurrentStepInfo();if(u&&u.BusinessCode?r.processIdBusiness=e&&void 0!==r.processIdBusiness?r.processIdBusiness:u.BusinessCode:r.processIdBusiness=e&&void 0!==r.processIdBusiness?r.processIdBusiness:"",u&&u.Contrats)for(var l=0;l<u.Contrats.length;l++){var d=u.Contrats[l];if(d){var v=d.NomData;0<d.NomData.indexOf("=>")&&(v=d.NomData.split("=>")[1]);var f=this.library.Context.GetFromContext(v);if(null!=f){var h=0;"object"==typeof f?h=JSON.stringify(f).length:"string"==typeof f&&(h=f.trim().length),0<h&&h<50&&(r.data[v]=e&&void 0!==r.data[v]?r.data[v]:f)}}}return this.library.Mobilite.getReseau().then(function(e){switch(e){case m.Mobilite.TYPE_RESEAU.CONNECTE:case m.Mobilite.TYPE_RESEAU.INCONNU:r.deviceType="I";break;case m.Mobilite.TYPE_RESEAU.DECONNECTE:r.deviceType="D";break;case m.Mobilite.TYPE_RESEAU.FILAIRE:r.deviceType="F";break;case m.Mobilite.TYPE_RESEAU.VPN:r.deviceType="V";break;case m.Mobilite.TYPE_RESEAU.WIFI_AGENCE:r.deviceType="W";break;default:r.deviceType="I"}}).catch(function(){r.deviceType="I"}).then(function(){return r})}var p=m.CoreCommon.ServiceDePromesse.defer();return p.resolve(r),p.promise},a.prototype.SetProcessAndStepId=function(e,r,t){var n=m.Context.PortalContext.GetPathPart(r,m.Context.PATH_PART.MAIN_PROCESS_ID),o=m.Context.PortalContext.GetPathPart(r,m.Context.PATH_PART.LAST_PROCESS_ID),s=m.Context.PortalContext.GetPathPart(r,m.Context.PATH_PART.STEP_ID);e.processIdMaster=t&&void 0!==e.processIdMaster?e.processIdMaster:this.CleanProcessId(n,20),e.processIdCurrent=t&&void 0!==e.processIdCurrent?e.processIdCurrent:this.CleanProcessId(o,20),e.stepIdCurrent=t&&void 0!==e.stepIdCurrent?e.stepIdCurrent:this.CleanStepId(s,20,24)},a.prototype.GetCodeAndUId=function(e,r){if(!e)return null;var t=e.lastIndexOf(r);return 0<=t?{code:e.substring(0,t),uid:e.substring(t+1,e.length)}:null},a.prototype.CleanProcessId=function(e,r){if(!e)return e;var t=this.GetCodeAndUId(e,"-");if(t){var n=t.code,o=t.uid;return n.length>r&&(n=n.substring(0,r)),n+"-"+o}return e.length>r+9?e.substring(0,r+9):e},a.prototype.CleanStepId=function(e,r,t){if(!e)return e;var n=this.GetCodeAndUId(e,"-");if(n){var o=n.code,s=n.uid,i=this.GetCodeAndUId(o,":");if(i){var a=i.code,c=i.uid;a.length>r&&(a=a.substring(0,r));var u=this.GetCodeAndUId(c,"_");if(u){var l=u.code,d=u.uid;l.length>r&&(l=l.substring(0,r)),c=l+"_"+d}else c.length>r&&(c=c.substring(0,r));o=a+":"+c}else o.length>r+t+1&&(o=o.substring(0,r+t+1));return o+"-"+s}return e.length>r+t+1+9?e.substring(0,r+t+1+9):e},a.prototype.tracer=function(e,r){var t=this,n=m.CoreCommon.ServiceDePromesse.defer();return this.ecrituresTracesEnCours.push(n.promise),this.recupererInfos(e,!1===r).then(function(e){return e.processIdMaster&&0===e.processIdMaster.indexOf("TECH_")?(n.resolve(),t.checkTailleDB()):t.recordInIDB(e).then(function(e){return n.resolve(),e})})},a.prototype.recordInIDB=function(e){var r=this;a.logger.debug("Ecriture d'une trace de suivi %1",JSON.stringify(e));var t={trace:e,datePurge:null,nbEssais:0};return this.traceSuiviDB.ajouter([t]).then(function(){return r.checkTailleDB()})},a.prototype.checkTailleDB=function(e){var r=this;return null!==this.timerRunPurge&&(clearTimeout(this.timerRunPurge),this.timerRunPurge=null),this.timerRunPurge=setTimeout(function(){r.purgerTraces()},this.PURGE_TIME_WAIT_NEXT_TRACE),this.library.Core.createPromiseSelfResolved(0)},a.prototype.purgerTraces=function(){var s=this;if(!l){null!==this.timerRunPurge&&(clearTimeout(this.timerRunPurge),this.timerRunPurge=null),l=!0,this.doitRelancerPurge=!1,this.storageInstancePurge.saveValue({action:u.DEBUT,nbPurgesError:d});var r=0,e=this.ecrituresTracesEnCours;return this.ecrituresTracesEnCours=[],a.logger.debug("Demarrage de la purge des traces de suivi"),m.CoreCommon.ServiceDePromesse.all(e).then(function(){},function(e){}).then(function(){var t=[],n=[],o=[];return s.traceSuiviDB.getTracesToPurge().then(function(e){if(0===e.length)return l=!1,void s.storageInstancePurge.saveValue({action:u.FIN,nbPurgesError:d});var r=(new Date).getTime();return e.forEach(function(e){e.datePurge=r,t.push(e.trace),n.push({cle:e.id,element:e}),o.push(e.id)}),s.traceSuiviDB.mettreAJour(n)}).then(function(){return s.library.Context.getAuthentificationInfo()}).then(function(e){return s.api.envoyerTracesSuivi(t,e)}).then(function(){return d=0,r=o.length,s.traceSuiviDB.supprimer(o)},function(e){return r=0,console.error(e),s.finDePurgeFail(n)}).finally(function(){l=!1,s.storageInstancePurge.saveValue({action:u.FIN,nbPurgesError:d}),s.doitRelancerPurge&&s.purgerTraces()}).then(function(){return r})})}},a.prototype.finDePurgeFail=function(e){var r=this;if(!(5<=++d)){var t=[],n=[];return e.forEach(function(e){e.element.nbEssais<5?(e.element.nbEssais++,t.push(e)):n.push(e.cle)}),this.traceSuiviDB.mettreAJour(t).then(function(){return r.traceSuiviDB.supprimer(n)}).then(function(){0<t.length&&a.logger.warn("Des traces n'ont pas pu être envoyées, incrémentation de leur compteur de tentative d'envois"),0<n.length&&a.logger.warn("Des traces ont atteint leur quota de tentative d'envois, elles sont donc supprimées")})}},a.CLASS_NAME="MyWay.Services.Lisa.TraceSuiviManager",a.logger=m.Loggers.LoggerFactory.INSTANCE.getClass(a.CLASS_NAME),a}(m.Components.ComponentManagerBase);c.TraceSuiviManager=r,m.Components.RegistryManager.getInstance().register(r)})((m=e.Services||(e.Services={})).TraceSuivi||(m.TraceSuivi={}))}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-suivi-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var n in r)r.hasOwnProperty(n)&&(e[n]=r[n])};return function(e,r){function n(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(n.prototype=r.prototype,new n)}}();!function(e){var r,o,n;r=e.Services||(e.Services={}),o=r.Performance||(r.Performance={}),n=function(s){function e(){return s.call(this,r.Components.ComponentType.Performance)||this}return __extends(e,s),e.prototype.reception=function(e){switch(e.subject){case o.PerformanceMessageSubject.STEP:var r=(a=e.message).id,n=a.label;return this.managerInstance.step(r,n);case o.PerformanceMessageSubject.CANCEL:var t=e.message;return this.managerInstance.cancel(t);case o.PerformanceMessageSubject.END:var a;return r=(a=e.message).id,n=a.label,this.managerInstance.end(r,o.AppLoadingPerformanceStep.MANUAL_END);default:return s.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Performance.PerformanceManagerMessage",e.logger=r.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(r.Components.ComponentManagerMessageBase),o.PerformanceManagerMessage=n,r.Components.RegistryManagerMessage.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-performance-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var r in s)s.hasOwnProperty(r)&&(e[r]=s[r])};return function(e,s){function r(){this.constructor=e}n(e,s),e.prototype=null===s?Object.create(s):(r.prototype=s.prototype,new r)}}();!function(e){var s,m,r;s=e.Services||(e.Services={}),m=s.Impression||(s.Impression={}),r=function(i){function e(){return i.call(this,s.Components.ComponentType.Impression)||this}return __extends(e,i),e.prototype.reception=function(e){switch(e.subject){case m.Messages.ImpressionMessageSubject.Generer:var s=(a=e.message).data,r=a.generationParams;return this.managerInstance.generer(s,r);case m.Messages.ImpressionMessageSubject.GetJsonConverti:return s=(a=e.message).data,this.managerInstance.getJsonConverti(s);case m.Messages.ImpressionMessageSubject.Imprimer:s=(a=e.message).data;var n=a.impressionParams;return this.managerInstance.imprimer(s,n);case m.Messages.ImpressionMessageSubject.ImprimerLot:s=(a=e.message).data;var t=a.parametresActiveXGlobaux;return this.managerInstance.imprimerLot(s,t);case m.Messages.ImpressionMessageSubject.GenererImprimer:s=(a=e.message).data;var a,o=a.generationImpressionParams;return this.managerInstance.genererImprimer(s,o);default:return i.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Impression.ImpressionManagerMessage",e.logger=s.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(s.Components.ComponentManagerMessageBase),m.ImpressionManagerMessage=r,s.Components.RegistryManagerMessage.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-impression-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(r){var o,a,e;o=r.Services||(r.Services={}),a=o.Capacites||(o.Capacites={}),e=function(n){function t(){var e=n.call(this,o.Components.ComponentType.Capacites)||this;return e.api=null,e}return __extends(t,n),t.prototype.init=function(e,t,r,o){return this.api=o,this.api.setTotemCapable(r.isTotemCapable),n.prototype.init.call(this,e,t,r)},t.prototype.getCapacite=function(e){return void 0===a.REGLE[e]?(t.logger.error("Règle capacité inconnue"),o.Promesses.createPromiseSelfError(new o.Erreur(r.Services.Libelle.LibelleModel.COM.ERREUR_CAPACITES_REGLE_INCONNU))):this.api.resolve(e).then(function(e){return t.logger.debug("resolve success - %1",e),e}).catch(function(e){throw t.logger.error("resolve failed - %1",JSON.stringify(e)),e})},t.CLASS_NAME="MyWay.Services.Capacites.CapacitesManager",t.logger=o.Loggers.LoggerFactory.INSTANCE.getClass(t.CLASS_NAME),t}(o.Components.ComponentManagerBase),a.CapacitesManager=e,o.Components.RegistryManager.getInstance().register(e)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-capacites-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t,a,r;t=e.Services||(e.Services={}),a=t.TraceSuivi||(t.TraceSuivi={}),r=function(r){function e(){return r.call(this,t.Components.ComponentType.TraceSuivi)||this}return __extends(e,r),e.prototype.reception=function(e){switch(e.subject){case a.Messages.TraceSuiviMessageSubject.SendTraceSuivi:var t=e.message.trace;return this.managerInstance.tracer(t);case a.Messages.TraceSuiviMessageSubject.SendTraceSuiviForcee:return t=e.message.trace,this.managerInstance.tracer(t,!1);default:return r.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Lisa.TraceSuiviManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),a.TraceSuiviManagerMessage=r,t.Components.RegistryManagerMessage.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-suivi-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var r,t,n;r=e.Services||(e.Services={}),t=r.TraceSuivi||(r.TraceSuivi={}),n=function(e){function t(){return e.call(this,r.Components.ComponentType.TraceSuivi)||this}return __extends(t,e),t.prototype.forcerTrace=function(t){var r=this;return this.library.Core.promesseTryCatch(function(e){r.manager.tracer(t,!1).then(function(){e.resolve()},e.reject)})},t.prototype.purgerTraces=function(){return this.manager.checkTailleDB(!0)},t}(r.Components.ComponentManagerExtendedBase),t.TraceSuiviManagerExtended=n,r.Components.RegistryManagerExtended.getInstance().register(n)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-trace-suivi-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(d){var h,s,e;h=d.Services||(d.Services={}),s=h.Interop||(h.Interop={}),e=function(i){function p(){var t=i.call(this,h.Components.ComponentType.Interop)||this;return t.api=null,t.EndTransition=function(e){p.logger.debug("Start de EndTransition"),t.SendEvent(new h.Component.ManagerEvent(h.Component.ManagerEventType.FinDeTransition,e)),t.library.Context.SendPortalContext(!0,"Interop: EndTransition"),t.library.Context.DisplayProcesses()},t}return __extends(p,i),p.prototype.init=function(e,t,r,n){var o=this;return this.api=n,i.prototype.init.call(this,e,t,r,n).then(function(){return o._disableStorageEvent=!1,o._messageBus=new s.InteropMessageBus,o.PortalType=r.PortalType,(p._instance=o)._subscribeToEvent(),o._messageBus.StorageNotification=o.library.Persistence.addStorage("notifications.interop",function(){o.OnInteropMessageBusStorageChanged()}),o._getCommonDataInteropToUpdate()}).then(function(){o.library.Context.setOnChangePortailType(function(e){o.PortalType+=e})})},p.prototype.dispose=function(){return this.library.Context.setOnChangePortailType(null),i.prototype.dispose.call(this)},p.prototype.Lancer=function(e,t,r,n,o){p.logger.debug("Start de Lancer"),this.api.lancer(e,t,r,n,o)},p.prototype.AddToContextInterop=function(e,t,r,n,o){p.logger.debug("Start de AddToContextInterop"),this.api.addToContextInterop(e,t,r,function(e){n()},o)},p.prototype.AddListToContextInterop=function(e,t,r,n){p.logger.debug("Start de AddListToContextInterop"),this.api.addListToContextInterop(e,t,function(e){r()},n)},p.prototype.GetFromContextInterop=function(e,t,r,n){p.logger.debug("Start de GetFromContextInterop"),this.api.getFromContextInterop(e,t,function(e){r()},n)},p.prototype.GetListFromContextInterop=function(e,t,r,n){p.logger.debug("Start de GetFromContextInterop"),this.api.getListFromContextInterop(e,t,function(e){r()},n)},p.prototype.EndStep=function(){p.logger.debug("Start de EndStep"),this.library.Context.RemoveCurrentStep(),this.api.notifierFinStep(this.library.Context.GetCurrentStepId())},p.prototype.NotifyEndProcessus=function(e){p.logger.debug("Start de NotifyEndProcessus - Id du process %1",e),this.library.TraceSuivi.purgerTraces(),this.library.Trace.purgerTraces();var t=this.library.Context.GetFromContext("CommonDataInterop"),r=this.library.Context.GetListFromContext(JSON.parse(t));this._notifierFinProcessusInterop(e,r)},p.prototype._notifierFinProcessusInterop=function(e,t){var r=this;setTimeout(function(){r.api.notifierFinProcessus(e,t)},500)},p.prototype.NotifyBeginProcessus=function(e){p.logger.debug("Start de NotifyBeginProcessus - Id du process %1",e),this.api.notifierEtatProcessus(e,"ON")},p.prototype.NotifierChangementNomProcessus=function(e,t){p.logger.debug("Start de NotifierChangementNomProcessus - Id du process %1, nom de processus %2",e,t),this.api.notifierChangementNomProcessus(e,t)},p.prototype.AfficherWindowParHandle=function(e,t){p.logger.debug("Lancement de Afficher Windows par handle - handle: %1, affiche: %2",e,t),this.api.afficherWindowParHandle(e,t)},p.prototype.AfficherWindowParPid=function(e,t){p.logger.debug("Lancement de Afficher Windows par pid - pid: %1, affiche: %2",e,t),this.api.afficherWindowParPid(e,t)},p.prototype.AfficherSynthese=function(e){p.logger.debug("Lancement de Afficher Synthèse - numero client : %1",e),this.api.afficherSynthese(e)},p.prototype.ActiverApplicationAppelante=function(e){p.logger.debug("Lancement de activation application appelante - numero plan : %1",e),this.api.activerApplicationAppelante(e)},p.prototype.GetVarEnv=function(e,t,r){this.api.getVarEnv(e,function(e){t&&t(e),p.logger.debug("GetVarEnv success - %1",e)},function(e){r&&r(e),p.logger.error("GetVarEnv failed - %1",JSON.stringify(e))})},p.prototype.GetRegistryValue=function(e,t,r,n,o){this.api.getRegistryValue(e,t,r,function(e){n&&n(e),p.logger.debug("GetRegistryValue success - %1",e)},function(e){o(e),p.logger.error("GetRegistryValue failed - %1",JSON.stringify(e))})},p.prototype.LireFichier=function(e){var t=this.getPathFichier(e),r=h.CoreCommon.ServiceDePromesse.defer();return this.api.lireFichier(t).then(function(e){p.logger.debug("LireFichier success - path Fichier  %1, donnees: %2",t,e),r.resolve(e)}).catch(function(e){p.logger.error("LireFichier failed - path Fichier %1, erreurs: %2",t,JSON.stringify(e)),r.reject(e)}),r.promise},p.prototype.GetInfoFichier=function(e,t,r){this.api.getInfoFichier(e,function(e){t&&t(e),p.logger.debug("GetInfoFichier success - %1",JSON.stringify(e))},function(e){r&&r(e),p.logger.error("GetInfoFichier failed - %1",JSON.stringify(e))})},p.prototype.EcrireFichier=function(e,t,r,n){var o=this.getPathFichier(e),i=h.CoreCommon.ServiceDePromesse.defer();return this.api.ecrireFichier(o,t,r,n).then(function(e){p.logger.debug("EcrireFichier Success - path Fichier  %1, donnees: %2",o,e),i.resolve(e)}).catch(function(e){p.logger.error("EcrireFichier failed - %1",JSON.stringify(e)),i.reject(e)}),i.promise},p.prototype._subscribeToEvent=function(){var r=this;this.api&&this.api.subscribeToEvent(p._onEvent,p._onAcceptEvent,p._onConnection),this.library.Context&&(this.library.Context.onProcessNameChanged=function(e,t){r.NotifierChangementNomProcessus(e,t)})},p._onEvent=function(e,t){var r=p._instance;r.Deliver(e).then(function(){t&&t()},function(){r._shelveEvent(e),t&&t()})},p.prototype._getCommonDataInteropToUpdate=function(){var t=this;return this.api.getCommonDataInteropToUpdate().then(function(e){t.library.Context.AddToContext(h.Context.StorageLevel.Global,"CommonDataInterop",JSON.stringify(e))}).catch(function(){})},p._onAcceptEvent=function(e){var t=!1,r=p._instance,n=e.Contenu.Destinataire,o=r.library.Context.GetPortalContext().processes.length;if(r.PortalType!==n)t=!!r.library.Context.GetProcessStepById(n);else switch(r.PortalType){case"single":t="DemarreProcess"!==e.Subject||0===o;break;case"portal":t=!0;break;default:t=!1}return h.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),p.logger.debug("accept process: portalType=%1, destinataire=%2, subject=%3, processLength=%4 => accept=%5",r.PortalType,n,e.Subject,o,t),r.SendEvent(new h.Component.ManagerEvent(h.Component.ManagerEventType.AcceptPhase,{info:t.toString()})),t},p._onConnection=function(e){var t=p._instance;t._connectionId=e,t.SendEvent(new h.Component.ManagerEvent(h.Component.ManagerEventType.ConnectionSignalR,{info:e}))},p.prototype._shelveEvent=function(e){e.DeliverTries++,this._messageBus.Add(e)},p.prototype.Deliver=function(e){if(p.logger.debug("Start de Deliver"),this.library.Display.CurrentFrame.ProcessId||this.library.Context.IsSingleProcess()){var t=this.library.Context.GetCurrentProcess();if(t){var r=this.library.Context.GetCurrentStep(t);if(e.ProcessStepId===r.getPath())return this._deliverMessage(e)}}return"portal"===e.ProcessStepId||"single"===e.ProcessStepId||e.ProcessStepId===this._connectionId?this._handlePortalMessage(e):(p.logger.error("Deliver failed"),this.library.Core.createPromiseSelfError(new h.Erreur("Erreur deliver failed")))},p.prototype.DeliverUndeliveredMessage=function(e){var t=this,r=this._messageBus.SpliceByStepId(e);if(0===r.length)return this.library.Core.getPromesseSelfResoved();for(var n in h.Loggers.MDC.INSTANCE.setValue("action","DeliverUndeliveredMessage"),r)p.logger.debug(r[n].Subject);return h.Loggers.MDC.INSTANCE.remove("action"),this._disableStorageEvent=!0,this._deliverMessages(r).then(function(){t._disableStorageEvent=!1})},p.prototype._deliverMessages=function(e){var t=this;if(0<e.length){var r=e.pop();return this._deliverMessage(r).then(function(){return t._deliverMessages(e)},function(){return t._shelveEvent(r),t._deliverMessages(e)})}return this.library.Core.getPromesseSelfResoved()},p.prototype._deliverMessage=function(e){var t=new h.NotificationMessage;return t.Sujet=e.Subject,t.Contenu=e.Contenu,this.library.Context.Notify(t)},p.prototype._handlePortalMessage=function(e){var t=this;switch(e.Subject){case"Guichet":return"O"===e.Contenu?this.library.Context.GetDonneesLocales():(this.library.Context.ClearParametresComptables(),this.library.Core.getPromesseSelfResoved());case"DemarreProcess":var r=e.Contenu.Code,n=e.Contenu.ValeurDepart,o=JSON.stringify(e.Contenu.InitData),i=new h.Component.ManagerEvent(h.Component.ManagerEventType.DemandeDeDemarrageDeProcessus,{demandeDeDemarrageDeProcessusDetail:{codeProcessus:r,initData:o,valeurDepart:n}});return h.Loggers.FLASH.INSTANCE.setValue("action","_handlePortalMessage"),p.logger.info("Send event 'DemarreProcess' : process=%1, valeurDepart=%2, initData=%3",r,n,o),this.SendEvent(i),this.library.Core.getPromesseSelfResoved();case"ChangeModeTrace":var s;return s="ON"==e.Contenu,p.logger.info("Positonnement mode debug trace : %1",s),this.library.Trace.setModeDebug(s),this.library.Core.getPromesseSelfResoved();case"Communication":return i=new h.Component.ManagerEvent(h.Component.ManagerEventType.Communication,{communicationDetail:{message:e.Contenu}}),h.Loggers.FLASH.INSTANCE.setValue("action","_handlePortalMessage"),p.logger.info("Send event 'Communication' : message=%1",e.Contenu),this.SendEvent(i),this.library.Core.getPromesseSelfResoved();case"UpdateContexteClient":var a=(g=e.Contenu).NumeroClient,c=g.FluxJSON;return(u=this.library.ContexteClient.nouveauContexte(a))&&this.library.ContexteClient.setContenu("interop",a,JSON.parse(c)),this.library.Core.getPromesseSelfResoved();case"DeleteContexteClient":var g;if(a=(g=e.Contenu).NumeroClient,p.logger.debug("DeleteContexteclient : contenu=%1 numeroclient=%2",g,a),"tous"===a){this.library.ContexteClient.changeTousContexteMode(d.Services.ContexteClient.Messages.ContexteClientMode.AUTOMATIQUE),this.library.Context.RemoveWaitingProcesses();var l=this.library.ContexteClient.getContextes();p.logger.debug("DeleteContexteclient : suppression de tous les contextes client"),l.forEach(function(e){t.library.ContexteClient.detruireContexte("interop",e.getId())})}else{var u;(u=this.library.ContexteClient.getByIdClient(a))&&(p.logger.debug("DeleteContexteclient : change mode en automatique contexte client=%1 de contexte id=%2",a,u.getId()),this.library.ContexteClient.changeContexteMode(u.getId(),d.Services.ContexteClient.Messages.ContexteClientMode.AUTOMATIQUE))}return this.library.Core.getPromesseSelfResoved();default:return this.library.Core.getPromesseSelfResoved()}},p.prototype.ClearBus=function(){this._messageBus.Clear()},Object.defineProperty(p.prototype,"Bus",{get:function(){return this._messageBus},enumerable:!0,configurable:!0}),p.prototype.OnInteropMessageBusStorageChanged=function(){if(h.Loggers.FLASH.INSTANCE.setValue("action","OnInteropMessageBusStorageChanged"),p.logger.debug("Start de OnInteropMessageBusStorageChanged"),!this._disableStorageEvent&&this.library.Display.CurrentFrame.ProcessId){var e=this.library.Context.GetCurrentProcess();if(e){var t=this.library.Context.GetCurrentStep(e);return this.DeliverUndeliveredMessage(t.getPath())}}return this.library.Core.getPromesseSelfResoved()},p.prototype.TestLocalService=function(){p.logger.debug("Start de TestLocalService"),this.api.testLocalService()},p.prototype.TriggerNotifications=function(){h.Loggers.FLASH.INSTANCE.setValue("action","OnInteropMessageBusStorageChanged"),p.logger.debug("TriggerNotifications");var e=this.library.Context.GetCurrentProcess();if(e){var t=this.library.Context.GetCurrentStep(e);return t?this.DeliverUndeliveredMessage(t.getPath()):this.library.Core.getPromesseSelfResoved()}return this.library.Core.getPromesseSelfResoved()},p.prototype.getPathFichier=function(e){var t=e;return 0!==e.toLowerCase().lastIndexOf("c:",0)&&0!==e.toLowerCase().lastIndexOf("d:",0)&&(t=p.TempFolderPath+e),t},p.CLASS_NAME="MyWay.Services.Interop.InteropManager",p.logger=h.Loggers.LoggerFactory.INSTANCE.getClass(p.CLASS_NAME),p.TempFolderPath="%TEMP%\\",p}(h.Components.ComponentManagerBase),s.InteropManager=e,h.Components.RegistryManager.getInstance().register(e)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-interop-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var a in t)t.hasOwnProperty(a)&&(e[a]=t[a])};return function(e,t){function a(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(a.prototype=t.prototype,new a)}}();!function(e){var t,n,a;t=e.Services||(e.Services={}),n=t.Capacites||(t.Capacites={}),a=function(a){function e(){return a.call(this,t.Components.ComponentType.Capacites)||this}return __extends(e,a),e.prototype.reception=function(e){switch(e.subject){case n.Messages.CapacitesMessageSubject.GetCapacite:var t=e.message.regle;return this.managerInstance.getCapacite(t);default:return a.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Capacites.CapacitesManagerMessage",e.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(t.Components.ComponentManagerMessageBase),n.CapacitesManagerMessage=a,t.Components.RegistryManagerMessage.getInstance().register(a)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-capacites-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,i){t.__proto__=i}||function(t,i){for(var e in i)i.hasOwnProperty(e)&&(t[e]=i[e])};return function(t,i){function e(){this.constructor=t}a(t,i),t.prototype=null===i?Object.create(i):(e.prototype=i.prototype,new e)}}();!function(l){var c;(function(s){c.ServiceManager.addActionOnInitialize("Habilitation.ObtenirHabilitations",function(t){return t.Habilitation.ObtenirHabilitations().then(function(){})},"Context.GetDonneesLocales");var t=function(o){function r(){var t=o.call(this,c.Components.ComponentType.Habilitation)||this;return t.isTotemCapable=!0,t.contextKey="HABILITATIONS",t.maximumTimeBeforeReload=432e5,t.api=null,t}return __extends(r,o),r.prototype.init=function(t,i,e,a){return this.api=a,this.isTotemCapable=e.isTotemCapable,o.prototype.init.call(this,t,i,e,a)},r.prototype.transformContextDTOIntoArray=function(t){var i={};for(var e in t.codesHabilites)i[t.codesHabilites[e]]=!0;for(var e in t.codesNonHabilites)i[t.codesNonHabilites[e]]=!1;return i},r.prototype.extractCodesDTOIntoArray=function(t){var i=[],e=this.concatHabilitations(t);for(var a in e)i[e[a]]=!0;return i},r.prototype.concatHabilitations=function(t){var i=[],e=t[l.Services.Habilitation.DOMAIN.MYSYS],a=t[l.Services.Habilitation.DOMAIN.IAM],o=t[l.Services.Habilitation.DOMAIN.CULTURENET];return i=i.concat(e,a,o)},r.prototype._HabilitationsOK=function(t){return t&&t.timestamp&&Date.now()-t.timestamp<this.maximumTimeBeforeReload},r.prototype.EstHabilite=function(t){var i=c.CoreCommon.ServiceDePromesse.defer(),e=this;try{if(this._HabilitationsOK(this.habilitationsContextCache))if(this.habilitationsContextCache.codesHabilites){r.logger.info("Liste des codes d'habilitations testés : "+t);for(var a=[],o=0;o<t.length;o++)this.habilitationsCache&&this.habilitationsCache[t[o]]?a.push(!0):a.push(!1);c.Loggers.FLASH.INSTANCE.setValue("action","EstHabilite"),c.Loggers.FLASH.INSTANCE.setValue("details",t),r.logger.debug("Vérification codes habilitation success - result : %1 ",a),i.resolve(a)}else c.Loggers.FLASH.INSTANCE.setValue("action","EstHabilite"),c.Loggers.FLASH.INSTANCE.setValue("details",t),r.logger.error("Codes habilitation format incorrecte"),i.reject(new c.Erreur(l.Services.Libelle.LibelleModel.COM.ERREUR_HABILITATION_MAUVAIS_FORMAT));else this.ChargerHabilitations().then(function(){e.EstHabilite(t).then(function(t){i.resolve(t)}).catch(function(t){return i.reject(t)})}).catch(function(t){return i.reject(t)})}catch(t){r.logger.error("EstHabilite failed %1",JSON.stringify(t)),i.reject(new c.Erreur(t))}return i.promise},r.prototype.chargerHablitationsInternal=function(a,o){var n=this,t=this.library.Context.GetAuthentificationInfo(),i=this.library.Context.GetInfosUser();return null!==t?this.api.GetHabilitations(a===s.EHabilitationType.MYSYS,a===s.EHabilitationType.IAM,a===s.EHabilitationType.CULTURENET,i,t).then(function(t){var i=!0===o?null:JSON.parse(n.library.Context.GetFromContext(n.contextKey)),e=!i||!n._HabilitationsOK(i);if(e)i={codesHabilites:n.concatHabilitations(t),codesNonHabilites:[],timestamp:Date.now()};else switch(a){case s.EHabilitationType.MYSYS:t.mysys&&t.mysys.forEach(function(t){i.codesHabilites.indexOf(t)<0&&i.codesHabilites.push(t)});break;case s.EHabilitationType.IAM:t.iam&&t.iam.forEach(function(t){i.codesHabilites.indexOf(t)<0&&i.codesHabilites.push(t)});break;case s.EHabilitationType.CULTURENET:t.cultureNet&&t.cultureNet.forEach(function(t){i.codesHabilites.indexOf(t)<0&&i.codesHabilites.push(t)})}return n.library.Context.AddToContext(c.Context.StorageLevel.Global,n.contextKey,JSON.stringify(i)),n.habilitationsContextCache=i,n.habilitationsCache=n.transformContextDTOIntoArray(i),c.Loggers.FLASH.INSTANCE.setValue("action","ChargerHabilitations"),c.Loggers.FLASH.INSTANCE.setValue("details",n.habilitationsCache),r.logger.debug("GetHabilitations success"),e&&n.SendEvent(new c.Component.ManagerEvent(c.Component.ManagerEventType.ResetHabilitations,{})),n.habilitationsCache},function(t){throw c.Loggers.FLASH.INSTANCE.setValue("action","ChargerHabilitations"),r.logger.error("GetHabilitations failed %1",JSON.stringify(t)),t}):(c.Loggers.FLASH.INSTANCE.setValue("action","ChargerHabilitations"),r.logger.error("authentification manquante"),l.Services.CoreCommon.createPromiseSelfError(new c.Erreur(l.Services.Libelle.LibelleModel.COM.ERREUR_HABILITATION_AUTHENTIFICATION_MANQUANTE)))},r.prototype.ChargerHabilitations=function(t){return this.chargerHablitationsInternal(s.EHabilitationType.MYSYS,t)},r.prototype.chargerHabilitationsTypee=function(t,i){return this.chargerHablitationsInternal(t,i)},r.prototype.ObtenirHabilitations=function(){var t=this;try{return this._HabilitationsOK(this.habilitationsContextCache)?(c.Loggers.FLASH.INSTANCE.setValue("details",this.habilitationsCache),r.logger.debug("ObtenirHabilitations success"),this.library.Core.createPromiseSelfResolved(this.habilitationsCache)):this.ChargerHabilitations().then(function(){return t.ObtenirHabilitations()})}catch(t){return r.logger.error("ObtenirHabilitations failed %1",JSON.stringify(t)),this.library.Core.createPromiseSelfError(new c.Erreur(t))}},r.prototype.ObtenirHabilitation=function(i){var e=c.CoreCommon.ServiceDePromesse.defer();try{this.EstHabilite([i]).then(function(t){r.logger.debug("ObtenirHabilitation(code) success - code: %1, resultat: %2",i,t[0]),e.resolve(new s.HabilitationModel(i,t[0]))}).catch(function(t){return e.reject(t)})}catch(t){r.logger.error("ObtenirHabilitation(code) failed %1",JSON.stringify(t)),e.reject(new c.Erreur(t))}return e.promise},r.prototype.ModifierHabilitation=function(t,i){var e=c.CoreCommon.ServiceDePromesse.defer(),a=this;try{if(this._HabilitationsOK(this.habilitationsContextCache)){var o=this.habilitationsContextCache.codesHabilites.indexOf(t),n=this.habilitationsContextCache.codesNonHabilites.indexOf(t);-1<o?this.habilitationsContextCache.codesHabilites.splice(o,1):-1<n&&this.habilitationsContextCache.codesNonHabilites.splice(n,1),!0===i?this.habilitationsContextCache.codesHabilites.push(t):!1===i&&this.habilitationsContextCache.codesNonHabilites.push(t),this.library.Context.AddToContext(c.Context.StorageLevel.Global,this.contextKey,JSON.stringify(this.habilitationsContextCache)),r.logger.debug("ModifierHabilitation success - Code: %1, valeur: %2",t,i),this.habilitationsCache=this.transformContextDTOIntoArray(this.habilitationsContextCache),e.resolve(new s.HabilitationModel(t,i))}else this.ChargerHabilitations().then(function(){a.ModifierHabilitation(t,i).then(function(t){e.resolve(t)}).catch(function(t){return e.reject(t)})}).catch(function(t){return e.reject(t)})}catch(t){r.logger.error("ModifierHabilitation failed %1",JSON.stringify(t)),e.reject(new c.Erreur(t))}return e.promise},r.prototype.SupprimerHabilitations=function(){return this.library.Context.RemoveFromContext(c.Context.StorageLevel.Global,this.contextKey)},r.CLASS_NAME="MyWay.Services.Habilitation.HabilitationManager",r.logger=c.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME),r}(c.Components.ComponentManagerBase);s.HabilitationManager=t,c.Components.RegistryManager.getInstance().register(t)})((c=l.Services||(l.Services={})).Habilitation||(c.Habilitation={}))}(MyWay||(MyWay={})),function(t){var e;(e=t.Services||(t.Services={})).PhantomAgent.addListenerOnInit(function(t,i){t.Habilitation=new e.Habilitation.PhantomHabilitationAgent(i)})}(MyWay||(MyWay={})),function(t){var o,i,e;o=t.Services||(t.Services={}),i=o.Habilitation||(o.Habilitation={}),e=function(){function t(t){this.serviceManager=t}return t.prototype.EstHabilite=function(t){var i=o.CoreCommon.ServiceDePromesse.defer(),e=o.Controle.StaticArrayControle.isArray(t),a=e?t:[t];return this.serviceManager.Library.Habilitation.EstHabilite(a).then(function(t){e?i.resolve(t):i.resolve(t[0])}).catch(function(t){i.reject(t)}),i.promise},t}(),i.PhantomHabilitationAgent=e}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-habilitation-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var s in r)r.hasOwnProperty(s)&&(e[s]=r[s])};return function(e,r){function s(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(s.prototype=r.prototype,new s)}}();!function(e){var P,O,r;P=e.Services||(e.Services={}),O=P.Interop||(P.Interop={}),r=function(_){function R(){return _.call(this,P.Components.ComponentType.Interop)||this}return __extends(R,_),R.prototype.reception=function(e){var s=this;switch(e.subject){case O.Messages.InteropMessageSubject.AfficherWindowParHandle:var r=(m=e.message).handle,t=m.affiche;return this.managerInstance.AfficherWindowParHandle(r,t),this.library.Core.getPromesseSelfResoved();case O.Messages.InteropMessageSubject.AfficherWindowParPid:var n=(m=e.message).pid;return t=m.affiche,this.managerInstance.AfficherWindowParPid(n,t),this.library.Core.getPromesseSelfResoved();case O.Messages.InteropMessageSubject.AfficherSynthese:var a=(m=e.message).numeroClient;return this.managerInstance.AfficherSynthese(a),this.library.Core.getPromesseSelfResoved();case O.Messages.InteropMessageSubject.ActiverApplicationAppelante:var o=(m=e.message).numeroPlan;return this.managerInstance.ActiverApplicationAppelante(o),this.library.Core.getPromesseSelfResoved();case O.Messages.InteropMessageSubject.AddToContextInterop:var i=(m=e.message).level,c=m.key,g=m.value;return this.library.Core.promesseTryCatch(function(r){s.managerInstance.AddToContextInterop(i,c,g,r.resolve,function(e){P.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),R.logger.error("Service local indisponible - %1",JSON.stringify(e)),r.reject(new P.Erreur(P.Libelle.LibelleModel.COM.ERREUR_INTEROP_SERVICE_LOCAL_APPEL_IMPOSSIBLE))})});case O.Messages.InteropMessageSubject.AddListToContextInterop:var l=(m=e.message).level,u=m.datas;return this.library.Core.promesseTryCatch(function(r){s.managerInstance.AddListToContextInterop(l,u,r.resolve,function(e){P.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),R.logger.error("Service local indisponible - %1",JSON.stringify(e)),r.reject(new P.Erreur(P.Libelle.LibelleModel.COM.ERREUR_INTEROP_SERVICE_LOCAL_APPEL_IMPOSSIBLE))})});case O.Messages.InteropMessageSubject.GetFromContextInterop:var p=(m=e.message).level,I=m.key;return this.library.Core.promesseTryCatch(function(r){s.managerInstance.GetFromContextInterop(p,I,r.resolve,function(e){P.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),R.logger.error("Service local indisponible - %1",JSON.stringify(e)),r.reject(new P.Erreur(P.Libelle.LibelleModel.COM.ERREUR_INTEROP_SERVICE_LOCAL_APPEL_IMPOSSIBLE))})});case O.Messages.InteropMessageSubject.GetListFromContextInterop:var S=(m=e.message).level,M=m.datas;return this.library.Core.promesseTryCatch(function(r){s.managerInstance.GetListFromContextInterop(S,M,r.resolve,function(e){P.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),R.logger.error("Service local indisponible - %1",JSON.stringify(e)),r.reject(new P.Erreur(P.Libelle.LibelleModel.COM.ERREUR_INTEROP_SERVICE_LOCAL_APPEL_IMPOSSIBLE))})});case O.Messages.InteropMessageSubject.Lancer:var E=(m=e.message).executableWrapper,f=m.parametres,C=m.sync,d=m.contexte;return this.library.Core.promesseTryCatch(function(r){s.managerInstance.Lancer(E,d,f,C,function(e){P.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),R.logger.error("Service local indisponible - %1",JSON.stringify(e)),r.reject(new P.Erreur(P.Libelle.LibelleModel.COM.ERREUR_INTEROP_SERVICE_LOCAL_APPEL_IMPOSSIBLE))}),r.resolve()});case O.Messages.InteropMessageSubject.EndStep:var m=e.message;return this.library.Core.promesseTryCatch(function(r){try{s.managerInstance.EndStep(),s.managerInstance.EndTransition(null),r.resolve()}catch(e){P.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),R.logger.error("EndStep failed - %1",JSON.stringify(e)),r.reject(new P.Erreur(P.Libelle.LibelleModel.COM.ERREUR_FRAMEWORK,["EndStep failed"]))}});case O.Messages.InteropMessageSubject.TriggerNotifications:return this.managerInstance.TriggerNotifications();case O.Messages.InteropMessageSubject.LireFichier:var L=(m=e.message).nomFichier;return this.managerInstance.LireFichier(L).then(function(e){return{data:e}});case O.Messages.InteropMessageSubject.EcrireFichier:var h=(m=e.message).nomFichier,b=m.fluxdonnees,y=m.ajouter,v=m.creeDir;return this.managerInstance.EcrireFichier(h,b,y,v).then(function(e){return{data:e}});case O.Messages.InteropMessageSubject.ClearBus:e.message,R.logger.debug("Efface le bus interop"),this.managerInstance.ClearBus();var A=P.CoreCommon.ServiceDePromesse.defer();return A.resolve(),A.promise;default:return _.prototype.reception.call(this,e)}},R.CLASS_NAME="MyWay.Services.Interop.InteropManagerMessage",R.logger=P.Loggers.LoggerFactory.INSTANCE.getClass(R.CLASS_NAME),R}(P.Components.ComponentManagerMessageBase),O.InteropManagerMessage=r,P.Components.RegistryManagerMessage.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-interop-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])};return function(e,t){function n(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}}();!function(e){var t;(t=e.Services||(e.Services={})).Bug||(t.Bug={})}(MyWay||(MyWay={})),function(e){var n,t,o;n=e.Services||(e.Services={}),t=n.Interop||(n.Interop={}),o=function(e){function t(){return e.call(this,n.Components.ComponentType.Interop)||this}return __extends(t,e),t}(n.Components.ComponentManagerExtendedBase),t.InteropManagerExtended=o,n.Components.RegistryManagerExtended.getInstance().register(o)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-interop-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])};return function(t,e){function a(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}}();!function(t){var e,s,a;e=t.Services||(t.Services={}),s=e.Habilitation||(e.Habilitation={}),a=function(n){function t(){return n.call(this,e.Components.ComponentType.Habilitation)||this}return __extends(t,n),t.prototype.reception=function(t){switch(t.subject){case s.HabilitationMessageSubject.EstHabilite:var e=(a=t.message).code;return this.managerInstance.EstHabilite(e);case s.HabilitationMessageSubject.ChargerHabilitations:var a=t.message;return this.managerInstance.ChargerHabilitations();case s.HabilitationMessageSubject.ObtenirHabilitations:return a=t.message,this.managerInstance.ObtenirHabilitations();case s.HabilitationMessageSubject.ObtenirHabilitation:return e=(a=t.message).code,this.managerInstance.ObtenirHabilitation(e);case s.HabilitationMessageSubject.ModifierHabilitation:e=(a=t.message).code;var i=a.valeur;return this.managerInstance.ModifierHabilitation(e,i);default:return n.prototype.reception.call(this,t)}},t.CLASS_NAME="MyWay.Services.Habilitation.HabilitationManagerMessage",t.logger=e.Loggers.LoggerFactory.INSTANCE.getClass(t.CLASS_NAME),t}(e.Components.ComponentManagerMessageBase),s.HabilitationManagerMessage=a,e.Components.RegistryManagerMessage.getInstance().register(a)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-habilitation-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}i(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var n,e,i;n=t.Services||(t.Services={}),e=n.Habilitation||(n.Habilitation={}),i=function(t){function e(){return t.call(this,n.Components.ComponentType.Habilitation)||this}return __extends(e,t),e.prototype.EstHabilite=function(t){return this.manager.EstHabilite(t)},e.prototype.ChargerHabilitations=function(){return this.manager.ChargerHabilitations()},e.prototype.chargerHabilitationsTypee=function(t){return this.manager.chargerHabilitationsTypee(t)},e}(n.Components.ComponentManagerExtendedBase),e.HabilitationManagerExtended=i,n.Components.RegistryManagerExtended.getInstance().register(i)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-habilitation-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}o(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(S){var I,D,e;I=S.Services||(S.Services={}),D=I.Lisa||(I.Lisa={}),e=function(a){function T(){var r=a.call(this,I.Components.ComponentType.Lisa)||this;return r.DisplayProcessesOnProcessEnd=!1,r.api=null,r.endTransition=function(e){T.logger.debug("Debut EndTransition");var t=!1;e&&e.retourEtapePrecedente&&e.etapeCourante&&e.etapeCourante.maintienIFrameLastAction&&(r.library.Display.CleanLastProcessFrame(),t=!0),r.library.Context.SendPortalContext(!0,"Lisa: EndTransition"),r.library.Context.DisplayProcesses(e.nouvelleIframe).then(function(){if(t){var e=new I.NotificationMessage;e.Sujet="FrameShownOnComeBack",r.library.Context.Notify(e)}}).catch(function(e){I.Loggers.FLASH.INSTANCE.setValue("action","EndTransition"),I.Loggers.FLASH.INSTANCE.setValue("details",e),T.logger.error("Erreur DisplayProcesses")})},r}return __extends(T,a),T.prototype.init=function(e,t,r,o){var n=this;return this._modeVerificationProcessus=r.ModeVerificationProcessus,this.api=o,a.prototype.init.call(this,e,t,r,o).then(function(){n.library.Interop&&(n.onFinProcessus=function(e){n.library.Interop.NotifyEndProcessus(e)})})},T.prototype.startStandaloneProcessWithInitialisation=function(t,e,r){var o,n,a=this;return T.logger.debug("Debut StartStandaloneProcessWithInitialisation"),n="object"==typeof e&&null!==e?(o=null,e):(o=e,r),this._start(t,o,"",n).then(function(e){return a.SendEvent(new I.Component.ManagerEvent(I.Component.ManagerEventType.NouveauProcess,{portalContext:a.library.Context.GetPortalContext(),processusAOuvrirDansUneNouvelleInstance:!!n&&n.processusAOuvrirDansUneNouvelleInstance,info:t})),T.logger.debug("Fin StartStandaloneProcessWithInitialisation, res: %1",e),e},function(e){throw I.Loggers.FLASH.INSTANCE.setValue("action","StartStandaloneProcessWithInitialisation"),I.Loggers.FLASH.INSTANCE.setValue("details",e),T.logger.error("Start '%1' (%2) demandé mais en echec",t,o),e})},T.prototype.startUrl=function(e,t){var r=this;T.logger.debug("Debut StartUrl");var o=new D.StartResult(null);o.CodeProcessus=e,o.ProcessDemarre=new D.ProcessResult({Nom:e}),o.ProcessDemarre.OptionsProcess='{"EstApplicationExterne":true}';var n=new D.EtapeResult(null);if(n.LocalisationAbsolue=t,n.LocalisationRelative="",n.CodeApplication=e,n.CodeEtape=e,n.CodeMetier="",n.NomApplication=e,n.TypeApplication="HTML5",n.ValeurEntree=0,o.ProchaineEtape=n,o&&o.ProcessDemarre)try{return this._launchNextStep(o,"",null,null).then(function(e){return e.finDeProcessus||r.SendEvent(new I.Component.ManagerEvent(I.Component.ManagerEventType.NouvelleAppliExterne,{portalContext:r.library.Context.GetPortalContext()})),T.logger.debug("Fin StartUrl, res: %1",e),e})}catch(e){return I.Loggers.FLASH.INSTANCE.setValue("action","StartUrl"),I.Loggers.FLASH.INSTANCE.setValue("details",e),T.logger.error("_launchNextStep failed - %1",e),this.library.Core.createPromiseSelfError(e)}else I.Loggers.FLASH.INSTANCE.setValue("action","StartUrl"),T.logger.warn("Pas d'url démarrée"),this.library.Core.createPromiseSelfResolved(null)},T.prototype.next=function(n,e){var a=this;void 0===e&&(e=!1),T.logger.debug("Debut Next");var s=this.library.Context.GetCurrentProcess(),i=this.library.Context.GetCurrentStep(s);return i?(e?(T.logger.info("Demande de retour à l'étape précédente"),this._getPrevious(s,i)):(T.logger.info("Demande d'enchainement depuis '%1', valeur de sortie '%2'",i.codeEtape,n),this.api.next(i.codeEtape,n))).then(function(t){try{if(t.ProcessDemarre&&t.ProcessDemarre.OptionsProcessAsEtape){var e=null;e=JSON.parse(t.ProcessDemarre.OptionsProcessAsEtape)}if(t.ProcessDemarre&&null!=e&&e.HorsProcessus)return a._DemarreSousProcessusModeExterne(t);var r=new I.NotificationMessage;r.Sujet="fin d etape",r.Contenu=s.id;var o=a.library.Core.getPromesseSelfResoved();return i.isRouteur||(o=a.library.Context.Notify(r)),o.then(function(){try{T.logger.info("FE");var e=new I.TraceSuivi.TraceSuiviModel;return e.state="FE",a.library.TraceSuivi.tracer(e),i.isRouteur||(s.lastNextTime=Date.now()),a.library.Display.FinishSubmit(),a._handleNext(i.codeEtape,n,t).then(function(e){return i.etatEtape==I.Context.EtatEtape.STARTED&&(i.etatEtape=I.Context.EtatEtape.RESET),e.finDeProcessus||a.SendEvent(new I.Component.ManagerEvent(I.Component.ManagerEventType.NouvelleEtape,{portalContext:a.library.Context.GetPortalContext()})),T.logger.debug("Fin Next, res: %1",e),e},function(e){throw I.Loggers.FLASH.INSTANCE.setValue("action","Next"),I.Loggers.FLASH.INSTANCE.setValue("details",e),T.logger.error("_handleNext failed - %1",e),e})}catch(e){throw I.Loggers.FLASH.INSTANCE.setValue("action","Next"),I.Loggers.FLASH.INSTANCE.setValue("details",e),T.logger.error("Next failed - %1",e),e}})}catch(e){throw I.Loggers.FLASH.INSTANCE.setValue("action","Next"),I.Loggers.FLASH.INSTANCE.setValue("details",e),T.logger.error("Next failed - %1, e"),e}}).catch(function(e){throw I.Loggers.FLASH.INSTANCE.setValue("action","Next"),I.Loggers.FLASH.INSTANCE.setValue("details",e),T.logger.error("Next failed - %1",e),e}):(I.Loggers.FLASH.INSTANCE.setValue("action","Next"),T.logger.error("Aucune étape courante"),this.library.Core.createPromiseSelfError(new I.Erreur("Aucune étape courante")))},T.prototype.replaceTokens=function(e,t){T.logger.debug("Debut ReplaceTokens");var r=[],o=[];if(t)for(var n in t){var a=t[n];if(a&&0<a.indexOf("=>")){var s=a.split("=>");r[s[1]]=s[0],o[s[0]]=s[1]}}var i=this.library.Core.FindKeysToReplace(e),u=[];for(var n in i)r[i[n]]?u.push(r[i[n]]):u.push(i[n]);for(var l=/\{([0-9]+)-(.*?)\}/g,c=l.exec(e);c;){var p=c[2];u.indexOf(p)<0&&u.push(p),c=l.exec(e)}var C=this.library.Context.GetListFromContext(u,!0,!0);for(var n in C){var d=C[n];e=o[d.Key]?e.replace(new RegExp("\\["+o[d.Key]+"\\]","g"),d.Value):e.replace(new RegExp("\\["+d.Key+"\\]","g"),d.Value),e=o[d.Key]?e.replace(new RegExp("\\%5B"+o[d.Key]+"\\%5D","g"),d.Value):e.replace(new RegExp("\\%5B"+d.Key+"\\%5D","g"),d.Value)}return e=e.replace(l,function(e,t,r){for(var o=null,n=0;n<u.length;n++)u[n].Key===r&&(o=u[n].Value);if(!o)return"";var a=o;for(n=0;n<t;n++)a=encodeURIComponent(a);return a}),T.logger.debug("Fin ReplaceTokens, url: %1",e),e},T.prototype.start=function(t,r){var o=this;return void 0===r&&(r=null),T.logger.debug("Debut Start"),this._start(t,r,"current",null).then(function(e){return o.SendEvent(new I.Component.ManagerEvent(I.Component.ManagerEventType.NouveauProcess,{portalContext:o.library.Context.GetPortalContext(),info:t})),T.logger.debug("Fin Start, res: %1",e),e},function(e){throw I.Loggers.FLASH.INSTANCE.setValue("action","Start"),I.Loggers.FLASH.INSTANCE.setValue("details",e),T.logger.error("Start '%1' (%2) demandé mais en echec",t,r),e})},T.prototype.startStandaloneProcess=function(t,r){var o=this;return void 0===r&&(r=null),T.logger.debug("Debut StartStandaloneProcess"),this._start(t,r,"",null).then(function(e){return o.SendEvent(new I.Component.ManagerEvent(I.Component.ManagerEventType.NouveauProcess,{portalContext:o.library.Context.GetPortalContext(),info:t})),T.logger.debug("Fin StartStandaloneProcess, res: %1",e),e},function(e){throw I.Loggers.FLASH.INSTANCE.setValue("action","StartStandaloneProcess"),I.Loggers.FLASH.INSTANCE.setValue("details",e),T.logger.error("Start '%1' (%2) demandé mais en echec",t,r),e})},T.prototype.previous=function(){return this.next(null,!0)},T.prototype.AddProcess=function(e,t,r,o,n,a){var s=this.library.Context.GetPortalContext();for(var i in s.processes){var u=s.processes[i];if(u.id===e)return void(s.currentPath=u.getPath())}var l=new S.Services.Context.Process;return l.id=e,l.icon="cog",l.displayName=t,l.contextStorage=[],l.subElements=[],l.currentInnerElementPath="",l.knownSteps=o,l.codeProcess=r,l.estApplicationExterne=!1,a&&(l.contexteClientId=a),n&&(n.Icon&&(l.icon=n.Icon),n.TypeProcess&&(l.typeProcess=n.TypeProcess),n.EstApplicationExterne&&(l.estApplicationExterne=!0)),s.processes.push(l),s.currentPath=l.getPath(),l.lastNextTime=Date.now(),this.library.Context.SaveContext(),l},T.prototype.AddSubProcess=function(e,t,r,o,n,a,s,i,u){var l=this.library.Context.GetPortalContext();for(var c in l.processes){var p=l.processes[c];if(p.id===e)return void(l.currentPath=p.getPath())}var C=new S.Services.Context.Process;if(C.id=t.id+"|"+e,C.icon="cog",i&&i.Icon&&(C.icon=i.Icon),C.displayName=r,C.contextStorage=[],C.subElements=[],C.currentInnerElementPath="",C.knownSteps=s,C.codeEtape=n,C.codeProcess=o,C.estApplicationExterne=!1,u&&u.OutputContracts)for(var d in u.OutputContracts)C.outputContracts.push(u.OutputContracts[d]);C.isSubProcess=!0,C.contexteClientId=t.contexteClientId,this.setAuthorizedOutputs(C,t,a),t.subElements.push(C),l.currentPath=C.getPath(),C.lastNextTime=t.lastNextTime,this.library.Context.SaveContext()},T.prototype.AddStepWithResult=function(e,t,r){var o=e.CodeEtape;o+="-"+I.CoreCommon.creerChaineAleatoire(8);var n=e.Actions,a=e.Contrats;this.AddStep(o,e.CodeEtape,e.CodeApplication,e.CodeMetier,n,a,e.NomApplication,t,e.ValeurEntree,r,JSON.stringify(e))},T.prototype.AddStep=function(e,t,r,o,n,a,s,i,u,l,c){var p=this.library.Context.GetCurrentProcess();if(!p)throw"no current process";for(var C in p.subElements)if(p.subElements[C].id===e)return p.currentInnerElementPath=e,this.library.Context.SaveContext(),this.library.Context.GetPortalContext(!1);var d=new S.Services.Context.ProcessStep;d.parentPath=p.id,d.id=e;var h=I.Context.EtatEtape.RESET,P=!1;if(i.indexOf(".js")===i.length-3&&(P=!0),T.ProcessStepSetValues(d,p,s,i,n,a,r,t,o,u,null,l,c,h,P,Date.now()),this.setAuthorizedOutputs(d,p,n),l&&(!0!==l.MaintienIFrame&&"true"!==l.MaintienIFrame||(d.maintienIFrame=!0),l.OutputContracts&&0<l.OutputContracts.length))for(var v in l.OutputContracts)p.outputContracts.push(l.OutputContracts[v]);p.subElements.push(d),p.currentInnerElementPath=d.id,l&&l.ChangeTypeProcess&&p.typeProcess!==l.ChangeTypeProcess&&(p.typeProcess=l.ChangeTypeProcess),this.library.Context.GetPortalContext().currentPath=p.getPath(),this.SetParentProcessPath(p),this.library.Context.SaveContext()},T.prototype.setAuthorizedOutputs=function(e,t,r){if(t.isSubProcess)for(var o in e.authorizedOutputs=[],r){var n=r[o];for(var a in n.ValeursFinProcessPossibles){var s=t.authorizedOutputs.indexOf(n.ValeursFinProcessPossibles[a]),i=e.authorizedOutputs.indexOf(n.ValeurSortie);0<=s&&i<0&&e.authorizedOutputs.push(n.ValeurSortie)}}else for(var o in e.authorizedOutputs=[],r)n=r[o],(s=e.authorizedOutputs.indexOf(n.ValeurSortie))<0&&e.authorizedOutputs.push(n.ValeurSortie)},T.prototype.SetParentProcessPath=function(e){for(var t=e,r=this.library.Context.GetParentProcess(e);r;){var o=t.getPath().replace(r.id+"|","");r.currentInnerElementPath=o,t=r,r=this.library.Context.GetParentProcess(r)}},T.prototype.ConvertInitData=function(e){var t={};for(var r in"string"==typeof e&&(e=JSON.parse(e)),t.displayName=e.displayName,t.subProcessCode=e.subProcessCode,t.contextArray=[],e.context){var o=e.context[r];t.contextArray.push({Key:r,Value:o})}for(var r in e.contextArray){var n=e.contextArray[r];t.contextArray.push({Key:n.Key,Value:n.Value})}return t.idClient=e.idClient,t.idContexteClient=e.idContexteClient,t},T.prototype.AddBoundStep=function(e,t,r,o,n,a){var s=this.library.Context.GetCurrentProcess();if(!s)throw"no current process";var i=new S.Services.Context.ProcessStep;for(var u in i.id=t,i.nomApplication=r,i.url=o,i.boundId=n,i.isEnd=a,i.processName=s.displayName,e&&(e.nextStep=i),s.subElements.push(i),s.subElements){var l=s.subElements[u];if(!l.boundId&&l.id===n){l.boundId=n;break}}this.library.Context.SaveContext()},T.prototype.SwitchToSubProcess=function(e){var t,r=this.library.Context.GetCurrentMainProcess();if(!r)return null;for(var o in r.subElements){var n=r.subElements[o];if("Process"===n.type&&n.id===e){t=n;break}}if(!t)throw"process '"+e+"' not found";var a=this.library.Context.GetPortalContext();return a.currentPath=t.getPath(),this.SetParentProcessPath(t),this.library.Context.SaveContext(),a},T.prototype.SwitchToSubProcessAsync=function(e,t){t(this.SwitchToSubProcess(e))},T.prototype.SwitchToMainProcess=function(){var e=this.library.Context.GetCurrentMainProcess();if(!e)return null;var t=null;for(var r in e.subElements){var o=e.subElements[r];"ProcessStep"===o.type&&(t=o)}var n=this.library.Context.GetPortalContext();return t&&e.currentInnerElementPath!==t.id&&(e.currentInnerElementPath=t.id,n.currentPath=e.getPath(),this.library.Context.SaveContext()),n},T.prototype.SwitchToMainProcessAsync=function(e){e(this.SwitchToMainProcess())},T.prototype.SwitchToStep=function(e,t){var r,o=this.library.Context.GetPortalContext();if((r=this.library.Context.GetCurrentProcess())&&this.library.Context.GetCurrentStep(r),!r)throw"no current process";for(var n in r.subElements){var a=r.subElements[n];if(a.id===e){r.currentInnerElementPath=a.id;var s=this.library.Core.FindKeysToReplace(a.url);if(s&&0<s.length){var i=this.library.Context.GetListFromContext(s);for(var u in i){var l=i[u];a.url=a.url.replace(new RegExp("\\["+l.Key+"\\]","g"),l.Value)}}return this.library.Context.SaveContext(),o}}throw"step '"+e+"' not found"},T.prototype.SwitchToCurrentProcess=function(){var e=this.library.Context.GetPortalContext();return this.library.Context.SwitchToProcess(e.currentPath),this.library.Context.GetPortalContext()},T.prototype.SwitchToCurrentProcessAsync=function(e){e(this.SwitchToCurrentProcess())},T.prototype.EndSubProcess=function(e){this.library.Context.GetPortalContext();var t=I.Context.PortalContext.GetPathPart(e,I.Context.PATH_PART.PREVIOUS_PROCESS_ID),r=e.indexOf(t);t=e.substr(0,r)+t;var o=I.Context.PortalContext.GetPathPart(e,I.Context.PATH_PART.LAST_PROCESS_ID);o=t+"|"+o,this.library.Context.RemoveStep(o,t)},T.prototype.RemoveSubProcessIfSingle=function(e,t,r){for(var o=-1,n=I.Context.PortalContext.GetPathPart(t,I.Context.PATH_PART.MAIN_PROCESS_ID),a=I.Context.PortalContext.GetPathPart(t,I.Context.PATH_PART.LAST_PROCESS_ID),s=0;s<r.length;s++)if("Process"===(l=r[s]).type){var i=l;if(I.Context.PortalContext.GetPathPart(i.id,I.Context.PATH_PART.STEP_ID)===n){if(n!==a)return this.RemoveSubProcessIfSingle(e,t.replace(n+"|",""),i.subElements);o=s;break}}var u=null;if(0<=o){u=r.splice(o,1)[0];var l,c=this.library.Context.GetParentProcess(u);0<r.length?"Process"===(l=r[r.length-1]).type?e.currentPath=l.getPath():(c.currentInnerElementPath=l.id,e.currentPath=c.id+"|"+l.id):e.currentPath=""}return u},T.prototype._getPrevious=function(e,t){for(var r=I.CoreCommon.ServiceDePromesse.defer(),o=-1,n=0;n<e.subElements.length;n++)if(e.subElements[n].id==t.id){o=n-1;break}var a=e.subElements[o];if("ProcessStep"===a.type){var s=a,i=new D.NextResult(null);i.FinProcess=!1,i.CodeEtape=t.codeEtape,i.ValeurFinProcess=null,i.ValeurSortie=null,i.ProchaineEtape=JSON.parse(s.etapeResultAsString),r.resolve(i)}else r.reject(new I.Erreur("l'étape précédente n'est pas une étape applicative"));return r.promise},T.prototype._startSubProcess=function(e,t){var r=this;return this._start(e,t,"main",null).then(function(e){return r.SendEvent(new I.Component.ManagerEvent(I.Component.ManagerEventType.NouveauSousProcess,{portalContext:r.library.Context.GetPortalContext()})),e})},T.prototype._start=function(r,o,n,a){var s=this;T.logger.info("Demande de démarrage du processus : %1",r);var e,i=!1;if(this._modeVerificationProcessus===I.ModeVerificationProcessus.Aucun){i=!0;var t=I.CoreCommon.ServiceDePromesse.defer();t.resolve(),e=t.promise}else e=this.api.getHabilitationProcessus(r).then(function(t){return s.library.Habilitation.EstHabilite([t]).then(function(e){1===e.length?!1===e[0]?T.logger.warn("Utilisateur non autorisé à démarrer le processus %1. Habilitation du processus %2 non déclarée",r,t):(i=!0,T.logger.debug("Utilisateur autorisé à démarrer le processus %1. Habilitation du processus %2 trouvée",r,t)):T.logger.warn("Impossible de vérifier si l'utilisateur est habilité au processus %1 (Habilitation %2)",r,t)})}).catch(function(e){T.logger.warn("Impossible de récupérer l'habilitation nécessaire au processus %1",r)});return this.library.Core.promesseTryCatch(function(t){e.finally(function(){if(!i&&s._modeVerificationProcessus===I.ModeVerificationProcessus.Erreur){var e="Le processus n'est pas lancé en raison d'un problème d'habilitation";return T.logger.error(e),void t.reject(new I.Erreur(e))}s.api.start(r,o).then(function(e){if(e&&e.ProcessDemarre){T.logger.info("Démarrage du processus : %1",e.ProcessDemarre.Nom);try{s._launchNextStep(e,n,a,null).then(function(e){try{a&&a.displayName&&s.library.Context.ChangeProcessName(a.displayName,e.processId),t.resolve(e)}catch(e){I.Loggers.FLASH.INSTANCE.setValue("action","Next"),T.logger.error("change process name failed"),t.reject(e)}})}catch(e){t.reject(e)}}else T.logger.warn("Aucun processus démarré"),t.resolve(null)}).catch(t.reject)})})},T.prototype._getCodesProcessus=function(){return this.api.getCodesProcessus()},T.prototype._getInfoProcessus=function(e){return this.api.getInfoProcessus(e)},T.prototype._getTools=function(){var o=this;return this.api.getTools().then(function(e){for(var t in e){var r=e[t];r.Url=o.replaceTokens(r.Url,null)}return e})},T.prototype._handleNext=function(l,c,e){var p=this;if(e&&e.FinProcess){var C=this.library.Context.GetCurrentProcess(),d=(r=this.library.Context.GetPortalContext()).currentPath;if(C.codeEtape)return this.api.next(C.codeEtape,e.ValeurFinProcess).then(function(e){if(e){var t=[];if((C=p.library.Context.GetCurrentProcess()).outputContracts)for(var r in C.outputContracts){var o=C.outputContracts[r],n=p.library.Context.GetFromContext(o);t.push({Key:o,Value:n})}0<t.length&&p.library.Context.AddListToContext(I.Context.StorageLevel.Process,t,p.library.Context.GetParentProcess(C).id),T.logger.info("FSP"),(s=new I.TraceSuivi.TraceSuiviModel).state="FS",p.library.TraceSuivi.tracer(s);var a=C.lastNextTime;return p.EndSubProcess(d),p.library.Context.GetCurrentProcess().lastNextTime=a,p._handleNext(l,c,e)}var s;T.logger.info("FP"),C.contexteClientId&&p.library.ContexteClient.changeContexteOfProcess(null,C.id,null),(s=new I.TraceSuivi.TraceSuiviModel).state="FP",p.library.TraceSuivi.tracer(s),p._notifyEndProcessus(),p.library.Context.RemoveCurrentProcess();var i=p.library.Context.GetPortalContext();p.SendEvent(new I.Component.ManagerEvent(I.Component.ManagerEventType.FinDeProcessus,{portalContext:i})),p.DisplayProcessesOnProcessEnd&&(0<i.processes.length?p.library.Context.DisplayProcesses():p.library.Display.DisplayBaseFrame());var u=new D.LisaCallbackResult;return u.finDeProcessus=!0,p.library.Core.createPromiseSelfResolved(u)});T.logger.info("FP");var t=new I.TraceSuivi.TraceSuiviModel;C.contexteClientId&&this.library.ContexteClient.changeContexteOfProcess(null,C.id,null),t.state="FP",this.library.TraceSuivi.tracer(t),this._notifyEndProcessus(),this.library.Context.RemoveCurrentProcess();var r=this.library.Context.GetPortalContext();this.SendEvent(new I.Component.ManagerEvent(I.Component.ManagerEventType.FinDeProcessus,{portalContext:r})),this.DisplayProcessesOnProcessEnd&&(0<r.processes.length?this.library.Context.DisplayProcesses():this.library.Display.DisplayBaseFrame());var o=new D.LisaCallbackResult;return o.finDeProcessus=!0,this.library.Core.createPromiseSelfResolved(o)}return e?e.ProchaineEtape?this._launchNextStep(e,"current",null,c):this.library.Core.createPromiseSelfError(new I.Erreur("Aucune prochaine etape trouvée pour l'enchainement de "+l+" sortie "+c)):(I.Loggers.FLASH.INSTANCE.setValue("action","Next"),T.logger.error("pas de next trouvé pour etape %1, valeur %2",l,c),this.library.Core.createPromiseSelfResolved(null))},T.prototype._notifyEndProcessus=function(){if(this.onFinProcessus)try{this.onFinProcessus(this.library.Context.GetMainProcessId())}catch(e){I.Loggers.FLASH.INSTANCE.setValue("action","NotifyEndProcessus"),I.Loggers.FLASH.INSTANCE.setValue("details",e),T.logger.error("une erreur est survenue lors de la notification de fin de processus")}},T.prototype._launchNextStep=function(e,t,r,o){var n=this,a=[];for(var s in e.ProchaineEtape.Contrats){var i=e.ProchaineEtape.Contrats[s];"IN"===i.Mode&&a.push(i.Code)}var u,l=e.ProchaineEtape;"current"===t?u=this.library.Context.GetCurrentProcess():"main"===t&&(u=this.library.Context.GetCurrentMainProcess());var c=this.library.Context.GetCurrentStep(u);if(c&&"GERR_FLUX_DEMN_PRST$TraiterDemandeMyFlow"===c.codeEtape&&c.actions){for(var p=null,C=0;C<c.actions.length;C++)if(c.actions[C].ValeurSortie===o){p=c.actions[C];break}if(p&&p.Options){var d=JSON.parse(p.Options);!0!==d.MaintienIFrame&&"true"!==d.MaintienIFrame||(c.maintienIFrame=!0)}}if(u&&c&&"GERR_FLUX_DEMN_PRST$TraiterDemandeMyFlow"!==c.codeEtape){var h=this._handlePreviousSteps(e,u);if(h)return this.library.Core.createPromiseSelfResolved(h)}l.Actions,l.Contrats;var P=new D.LisaCallbackResult,v=null;if(e.ProcessDemarre){var S=e.ProcessDemarre.Code;S+="-"+I.CoreCommon.creerChaineAleatoire(8);var y=null;e.ProcessDemarre.OptionsProcess&&(y=JSON.parse(e.ProcessDemarre.OptionsProcess));var g=e.ProcessDemarre.Nom;if(r&&r.displayName&&(g=r.displayName),u){var f=null;e.ProcessDemarre.OptionsProcessAsEtape&&(f=JSON.parse(e.ProcessDemarre.OptionsProcessAsEtape)),this.AddSubProcess(S,u,g,e.ProcessDemarre.Code,e.ProcessDemarre.CodeEtape,e.ProcessDemarre.Actions,e.ProcessDemarre.EtapesConnues,y,f),f&&f.Mappage&&this._translateContext(f.Mappage,I.Context.StorageLevel.Process),T.logger.info("DSP"),(A=new I.TraceSuivi.TraceSuiviModel).state="DS",this.library.TraceSuivi.tracer(A)}else{var x=null;if(r){v=r.idClient;var m=r.idContexteClient;v?x=this.library.ContexteClient.nouveauContexte(v):m?x=this.library.ContexteClient.getContexte(m):""===v&&(x=this.library.ContexteClient.nouveauContexte())}var b=this.AddProcess(S,g,e.ProcessDemarre.Code,e.ProcessDemarre.EtapesConnues,y,x?x.getId():null);x&&x.ajouterProcessus(b),this.library.Interop.NotifyBeginProcessus(S),T.logger.info("DP"),(A=new I.TraceSuivi.TraceSuiviModel).state="DP",this.library.TraceSuivi.tracer(A),y&&y.TypeProcess}if(P.processId=S,P.codeProcessus=e.ProcessDemarre.Code,r&&r.contextArray)for(var s in this.library.Context.AddListToContext(I.Context.StorageLevel.Process,r.contextArray),r.contextArray){var E=r.contextArray[s];if("IDCLIENT"===E.Key){v=E.Value;break}}}l=e.ProchaineEtape;var A,N=this._evaluateUrl(l),L=null;return l.OptionsEtape&&(L=JSON.parse(l.OptionsEtape)),L||(L={}),c&&(c.maintienIFrameLastAction=c.maintienIFrame,c.actions&&c.actions.every(function(e){if(e.ValeurSortie!==o)return!0;var t={};try{t=JSON.parse(e.Options)}catch(e){}return!0===t.MaintienIFrame||"true"===t.MaintienIFrame?c.maintienIFrameLastAction=!0:!1!==t.MaintienIFrame&&"false"!==t.MaintienIFrame||(c.maintienIFrameLastAction=!1),!1})),c&&!0===c.maintienIFrameLastAction&&(N.indexOf(".js")===N.length-3?L.MaintienIFrame=!0:L.NouvelleIFrame=!0),this.AddStepWithResult(l,N,L),L&&L.Mappage&&this._translateContext(L.Mappage,I.Context.StorageLevel.Step),T.logger.info("DE"),T.logger.info("Nouvelle etape : %1, options: %2",l.CodeEtape,JSON.stringify(L)),(A=new I.TraceSuivi.TraceSuiviModel).state="DE",this.library.TraceSuivi.tracer(A),P.codeEtape=l.CodeEtape,L&&L.NouvelleIFrame?P.nouvelleIframe=!0:P.nouvelleIframe=!1,r&&r.subProcessCode?this._start(r.subProcessCode,null,"current",null).then(function(e){return P.sousProcessusDemarre=e.codeProcessus,n._finalizeCallbackResultValues(P),P},function(e){return I.Loggers.FLASH.INSTANCE.setValue("action","Next"),I.Loggers.FLASH.INSTANCE.setValue("details",e),T.logger.error("sous processus '%1' demandé mais en echec",r.subProcessCode),P}):(this._finalizeCallbackResultValues(P),this.library.Core.createPromiseSelfResolved(P))},T.prototype._evaluateUrl=function(e){var t=[];for(var r in e.Contrats){var o=e.Contrats[r];"IN"===o.Mode&&t.push(o.Code)}this._translateContext(t,I.Context.StorageLevel.Process);var n="";return e.LocalisationAbsolue&&(n+=e.LocalisationAbsolue),e.LocalisationRelative&&(n+=e.LocalisationRelative),n=this.replaceTokens(n,t),"PMM"===e.TypeApplication&&(n=this._addModeMyWay(n)),n},T.prototype._addModeMyWay=function(e){0<e.indexOf("?")?e+="&":e+="?";var t=S.Services.PortalServiceParameters.Instance().Environnement.toLowerCase(),r=this.library.Context.GetFromContext("VERS");r&&(r=r.substring(1));var o={environnement:t,version:r};return e+="modeMyWay="+JSON.stringify(o)},T.prototype._finalizeCallbackResultValues=function(e){var t=this.library.Context.GetCurrentProcess();e.etapeCourante=this.library.Context.GetCurrentStep(t);var r=new I.Aide.InfobulleAfficheeParametres,o=this.library.Context.GetAuthentificationInfo();o&&(r.codeEtablissement=o.codeEtablissement),r.codeEtape=e.codeEtape,r.codeProcessus=e.codeProcessus,this.library.Aide.displayAideFlash(r)},T.prototype._handlePreviousSteps=function(e,t){var r;if(e.ProcessDemarre)return null;for(var o in t.subElements){var n=t.subElements[o];if(n.codeEtape===e.ProchaineEtape.CodeEtape){r=n;break}}if(r){for(var a=this.library.Context.GetPortalContext(),s=a.GetCurrentProcess(),i=a.GetCurrentStep(s);i&&i.codeEtape!==e.ProchaineEtape.CodeEtape;){if(i.codeEtape&&0<=i.codeEtape.indexOf("GERR_FLUX_DEMN_PRST")&&i.maintienIFrame)return;s=(a=this.library.Context.RemoveCurrentStep(i.codeEtape)).GetCurrentProcess(),i=a.GetCurrentStep(s)}var u=this.library.Context.GetCurrentProcess(),l=this.library.Context.GetCurrentStep(u);if(l.etapeResultAsString){var c=JSON.parse(l.etapeResultAsString);l.url=this._evaluateUrl(c)}var p=new D.LisaCallbackResult;return p.codeEtape=l.codeEtape,p.codeProcessus=u.codeProcess,p.etapeCourante=l,p.finDeProcessus=!1,p.processId=u.id,p.sousProcessusDemarre=null,p.retourEtapePrecedente=!0,p}},T.prototype._translateContext=function(e,t){var r=[],o=[],n=[];if(e)for(var a in e){var s=e[a];if(s&&0<s.indexOf("=>")){var i=s.split("=>");r[i[1]]=i[0],n.push(i[0]),o[i[0]]=i[1]}}var u=this.library.Context.GetListFromContext(n,!0),l=[];for(var a in u){var c=u[a];o[c.Key]&&l.push({Key:o[c.Key],Value:c.Value})}this.library.Context.AddListToContext(t,l)},T.prototype._prepareNavigation=function(e,t,r){e&&0<e.length?T._setNextSteps(this,this.library,t,e,t,function(){r&&r(t)}):r&&r(t)},T._setNextSteps=function(e,t,r,o,n,a){var s,i=t.Context.GetCurrentProcess();for(var u in i.subElements){var l=i.subElements[u];if(l.id===r){s=l;break}}s&&T._setNextStep(e,t,s,o.shift(),o,n,T._setNextSteps,a)},T._setNextStep=function(e,t,r,o,n,a,s,i){var u="";o.LocalisationAbsolue&&(u+=o.LocalisationAbsolue),o.LocalisationRelative&&(u+=o.LocalisationRelative),u=e.replaceTokens(u,null);var l=o.CodeEtape;l+="-"+I.CoreCommon.creerChaineAleatoire(8);var c=0==n.length;t.Lisa.AddBoundStep(r,l,o.NomApplication,u,a,c),0<n.length?s(e,t,l,n,a,i):i()},T.prototype._portail_StartProcess=function(e,t,r,o){var n=this;return this.startStandaloneProcessWithInitialisation(e,o,r).then(function(e){return t&&(n.library.Context.PutProcessInWait(e.processId),n.library.Context.SetSingleProcess(e.processId)),n.library.Context.DisplayProcesses(),e})},T.prototype._portail_StartUrl=function(e,t,r){var o=this;return this.startUrl(e,t).then(function(e){return r&&(o.library.Context.PutProcessInWait(e.processId),o.library.Context.SetSingleProcess(e.processId)),o.library.Context.DisplayProcesses(),e})},T.prototype._portail_Next=function(e){var t=this;return this.next(e).then(function(e){return t.endTransition(e),e})},T.prototype._DemarreSousProcessusModeExterne=function(r){var e,t,o,n,a,s=this,i=null,u=this.library.Context.GetFromContext("ID-ECRAN-SIGNATURE");return o=r.ProcessDemarre.Code,t=r.ProcessDemarre.ValeurDepart.toString(),r.ProchaineEtape&&r.ProchaineEtape.OptionsEtape&&JSON.parse(r.ProchaineEtape.OptionsEtape),r.ProcessDemarre.OptionsProcessAsEtape&&(i=JSON.parse(r.ProcessDemarre.OptionsProcessAsEtape)),i&&i.Mappage&&this._translateContext(i.Mappage,I.Context.StorageLevel.Process),n=!(!i||!i.HorsPortail||"true"!==i.HorsPortail&&!0!==i.HorsPortail),a=!(!i||!i.SurTablette||"true"!==i.SurTablette&&!0!==i.SurTablette),(e=this._FormateInitData(r.ProchaineEtape.Contrats)).processusAOuvrirDansUneNouvelleInstance=n,(u?this.api.DemarrerSousProcessusExterne(o,!0,e,t,n,a,u):this.api.DemarrerSousProcessusExterne(o,!0,e,t,n,a)).then(function(e){if(e){var t=new D.LisaCallbackResult;return t.codeProcessus=r.ProcessDemarre.Code,t}return I.Loggers.FLASH.INSTANCE.setValue("action","DemarrerSousProcessusExterne"),T.logger.error("Le sous processus n'a pas pu démarrer en mode externe"),s.library.Core.createPromiseSelfError(new I.Erreur("Le sous processus n'a pas pu démarrer en mode externe"))})},T.prototype._FormateInitData=function(e){var t={},r=[],o=[];if(e){for(var n=e.length,a=0;a<n;a++){var s=e[a];o.push(s.Code)}r=this.library.Context.GetListFromContext(o),t.contextArray=r}return t},T.ProcessStepSetValues=function(e,t,r,o,n,a,s,i,u,l,c,p,C,d,h,P){if(e.codeEtape=i,e.codeMetier=u,e.codeApplication=s,e.nomApplication=r,e.valeurEntree=l,e.url=o,e.boundId=c,e.actions=[],e.contextStorage=[],e.processName=t.displayName,n)for(var v=n.length,S=0;S<v;S++){var y=n[S],g=new I.Context.StepAction;g.EstExterne=y.EstExterne,g.Nom=y.NomExterne,g.Options=y.OptionsAction,g.ValeurSortie=y.ValeurSortie,g.CodeEtape=i,e.actions.push(g)}if(e.contrats=[],a){var f=a.length;for(S=0;S<f;S++){var x=a[S],m=new I.Context.StepContrat;m.Code=x.Code,m.Longueur=x.Longueur,m.Mode=x.Mode,m.Nullable=x.Nullable,m.Type=x.Type,e.contrats.push(m)}}e.etapeResultAsString=C,e.isRouteur=h,e.etatEtape=d,e.creationDate=P,p&&p.ProcessusMaitre&&(e.processusMaitre=p.ProcessusMaitre),e.diagnosticTraceSentForStep=!1},T.CLASS_NAME="MyWay.Services.Lisa.LisaManager",T.logger=I.Loggers.LoggerFactory.INSTANCE.getClass(T.CLASS_NAME),T}(I.Components.ComponentManagerBase),D.LisaManager=e,I.Components.RegistryManager.getInstance().register(e)}(MyWay||(MyWay={})),function(e){var r;(r=e.Services||(e.Services={})).PhantomAgent.addListenerOnInit(function(e,t){e.Lisa=new r.Lisa.PhantomLisaAgent(t)})}(MyWay||(MyWay={})),function(e){var r,t,o;r=e.Services||(e.Services={}),t=r.Lisa||(r.Lisa={}),o=function(){function e(e){this.serviceManager=e}return e.prototype.Next=function(e){var t=r.CoreCommon.ServiceDePromesse.defer();return this.serviceManager.Library.Lisa.next(e),t.promise},e.prototype.NextWithStep=function(e,t){return this.Next(t)},e}(),t.PhantomLisaAgent=o}(MyWay||(MyWay={})),function(r){var o,e,t;o=r.Services||(r.Services={}),e=o.Lisa||(o.Lisa={}),t=function(){function t(){}return Object.defineProperty(t.prototype,"StepInfo",{get:function(){return r.Services.ServiceManager.Instance().Library.Context.GetCurrentStepInfo()},enumerable:!0,configurable:!0}),t.prototype.Next=function(e){r.Services.ServiceManager.Instance().Library.Lisa.next(e).then(function(e){r.Services.ServiceManager.Instance().Library.Lisa.endTransition(e)},function(e){o.Loggers.FLASH.INSTANCE.setValue("details",e),t.logger.error("une erreur est survenue")})},t.prototype.AddToContext=function(e,t){r.Services.ServiceManager.Instance().Library.Context.AddToContext(o.Context.StorageLevel.Process,e,t)},t.prototype.GetFromContext=function(e){return r.Services.ServiceManager.Instance().Library.Context.GetFromContext(e)},t.prototype.LireFichier=function(e){var t=o.CoreCommon.ServiceDePromesse.defer();return r.Services.ServiceManager.Instance().Library.Interop.LireFichier(e).then(function(e){t.resolve(e)}).catch(function(e){t.reject(e)}),t.promise},t.prototype.Previous=function(){r.Services.ServiceManager.Instance().Library.Lisa.previous().then(function(e){r.Services.ServiceManager.Instance().Library.Lisa.endTransition(e)},function(e){o.Loggers.FLASH.INSTANCE.setValue("details",e),t.logger.error("une erreur est survenue")})},t.CLASS_NAME="MyWay.Services.RouteurAgent",t.logger=o.Loggers.LoggerFactory.INSTANCE.getClass(t.CLASS_NAME),t}(),e.RouteurAgentImpl=t,o.RouteurAgent.setImplementation(new t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-lisa-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,s){e.__proto__=s}||function(e,s){for(var a in s)s.hasOwnProperty(a)&&(e[a]=s[a])};return function(e,s){function a(){this.constructor=e}r(e,s),e.prototype=null===s?Object.create(s):(a.prototype=s.prototype,new a)}}();!function(e){var S,L,s;S=e.Services||(e.Services={}),L=S.Lisa||(S.Lisa={}),s=function(c){function u(){return c.call(this,S.Components.ComponentType.Lisa)||this}return __extends(u,c),u.prototype.reception=function(e){var s=this;switch(e.subject){case L.Messages.LisaMessageSubject.Next:var a=(g=e.message).valeurSortie;return this.managerInstance.next(a).then(function(e){return s.managerInstance.endTransition(e),s.library.Core.getServiceDePromesse().defer().promise},function(e){throw S.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),S.Loggers.FLASH.INSTANCE.setValue("details",e),u.logger.error("Next failed - %1",e),new S.Erreur(S.Libelle.LibelleModel.COM.ERREUR_LISA_NEXT_IMPOSSIBLE)});case L.Messages.LisaMessageSubject.StartProcess:var r=(g=e.message).processCode,t=g.valeurDepart,n=g.initData;return this.managerInstance.startStandaloneProcessWithInitialisation(r,t,n).then(function(e){return s.managerInstance.endTransition,e},function(e){throw S.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),S.Loggers.FLASH.INSTANCE.setValue("details",e),u.logger.error("StartStandaloneProcess failed - %1",e),new S.Erreur(S.Libelle.LibelleModel.COM.ERREUR_LISA_START_IMPOSSIBLE)});case L.Messages.LisaMessageSubject.StartProcessPortal:return r=(g=e.message).processCode,t=g.valeurDepart,n=g.initData,this.managerInstance._portail_StartProcess(r,!1,n,t);case L.Messages.LisaMessageSubject.StartSubProcess:return r=(g=e.message).processCode,t=g.valeurDepart,this.managerInstance._startSubProcess(r,t).then(this.managerInstance.endTransition,function(e){throw S.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),S.Loggers.FLASH.INSTANCE.setValue("details",e),u.logger.error("StartSubProcess failed - %1",e),new S.Erreur(S.Libelle.LibelleModel.COM.ERREUR_LISA_START_IMPOSSIBLE)});case L.Messages.LisaMessageSubject.StartUrl:var o=(g=e.message).name,i=g.url;return this.managerInstance.startUrl(o,i).then(function(e){return s.managerInstance.endTransition,e},function(e){throw S.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),S.Loggers.FLASH.INSTANCE.setValue("details",e),u.logger.error("StartExternalApp failed - %1",e),new S.Erreur(S.Libelle.LibelleModel.COM.ERREUR_LISA_START_IMPOSSIBLE)});case L.Messages.LisaMessageSubject.StartUrlPortal:return o=(g=e.message).name,i=g.url,this.managerInstance._portail_StartUrl(o,i,!1);case L.Messages.LisaMessageSubject.StartExternalApp:if(o=(g=e.message).name,i=g.url,g.standAlone){var l=S.PrivatePortalServiceParameters.Instance().LisaPlaceholders["URL-SPA"]+S.PrivatePortalServiceParameters.Instance().LisaPlaceholders.ALIASPORTAIL+"/?u="+encodeURIComponent(i)+"&n="+o;return window.open(l),this.managerInstance.endTransition(null),this.library.Core.getPromesseSelfResoved()}return this.managerInstance.startUrl(o,i).then(function(e){return s.managerInstance.endTransition,e},function(e){throw S.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),S.Loggers.FLASH.INSTANCE.setValue("details",e),u.logger.error("StartExternalApp failed - %1",e),new S.Erreur(S.Libelle.LibelleModel.COM.ERREUR_LISA_START_IMPOSSIBLE)});case L.Messages.LisaMessageSubject.GetTools:var g=e.message;return this.managerInstance._getTools().catch(function(e){throw S.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),S.Loggers.FLASH.INSTANCE.setValue("details",e),u.logger.error("GetTools failed - %1",e.codeLibelle),new S.Erreur(S.Libelle.LibelleModel.COM.ERREUR_LISA_GETTOOLS_IMPOSSIBLE)});case L.Messages.LisaMessageSubject.GetCodesProcessus:return g=e.message,this.managerInstance._getCodesProcessus().catch(function(e){throw S.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),S.Loggers.FLASH.INSTANCE.setValue("details",e),u.logger.error("GetCodesProcessus failed - %1",e.codeLibelle),new S.Erreur("GetCodesProcessus failed")});case L.Messages.LisaMessageSubject.GetInfoProcessus:return g=e.message,this.managerInstance._getInfoProcessus(g.codeProcessus).catch(function(e){throw S.Loggers.FLASH.INSTANCE.setValue("action","HandleMessage"),S.Loggers.FLASH.INSTANCE.setValue("details",e),u.logger.error("GetInfoProcessus failed - %1",e.codeLibelle),new S.Erreur("GetInfoProcessus failed")});default:return c.prototype.reception.call(this,e)}},u.CLASS_NAME="MyWay.Services.Lisa.LisaManagerMessage",u.logger=S.Loggers.LoggerFactory.INSTANCE.getClass(u.CLASS_NAME),u}(S.Components.ComponentManagerMessageBase),L.LisaManagerMessage=s,S.Components.RegistryManagerMessage.getInstance().register(s)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-lisa-manager-message.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])};return function(t,e){function n(){this.constructor=t}r(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}}();!function(t){var e;(e=t.Services||(t.Services={})).Bug||(e.Bug={})}(MyWay||(MyWay={})),function(t){var n,e,r;n=t.Services||(t.Services={}),e=n.Lisa||(n.Lisa={}),r=function(t){function e(){return t.call(this,n.Components.ComponentType.Lisa)||this}return __extends(e,t),e.prototype.StartProcess=function(t,e,n,r){return this.manager._portail_StartProcess(t,e,n,r)},e.prototype.StartUrl=function(t,e,n){return this.manager._portail_StartUrl(t,e,n)},e.prototype.Next=function(t){return this.manager._portail_Next(t)},e}(n.Components.ComponentManagerExtendedBase),e.LisaManagerExtended=r,n.Components.RegistryManagerExtended.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-lisa-manager-extended.min.js.map
var MyWay;!function(e){var t;(t=e.Services||(e.Services={})).ServiceAgentMobileExtended.addActionPostInit(function(e){var r=t.ServiceManager.Instance().Library.Context.GetFromContext("MobileProcessId");return t.ServiceManager.Instance().Library.Context.GetProcessByIdFromAllPortails(r)?(t.ServiceManager.Instance().Library.Context.PutProcessInWait(r),t.ServiceManager.Instance().Library.Context.SetSingleProcess(r),e.Core.getPromesseSelfResoved()):(r&&t.ServiceManager.Instance().Library.Context.AddToContext(t.Context.StorageLevel.Global,"MobileProcessId",null),t.ServiceManager.Instance().Library.Lisa.startUrl("MobileProcess","").then(function(e){t.ServiceManager.Instance().Library.Context.PutProcessInWait(e.processId),t.ServiceManager.Instance().Library.Context.SetSingleProcess(e.processId),t.ServiceManager.Instance().Library.Context.AddToContext(t.Context.StorageLevel.Global,"MobileProcessId",e.processId)},function(e){}))})}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-lisa-mobile.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var i in r)r.hasOwnProperty(i)&&(e[i]=r[i])};return function(e,r){function i(){this.constructor=e}t(e,r),e.prototype=null===r?Object.create(r):(i.prototype=r.prototype,new i)}}();!function(u){var A,e,r;A=u.Services||(u.Services={}),e=A.Application||(A.Application={}),r=function(){function p(){this.libraryManager=null,this.privatePortalServiceParameters=null,this._localServiceUrl=A.PrivatePortalServiceParameters.Instance().LocalServiceUrl}return p.prototype.init=function(e,r){this.libraryManager=e,this.privatePortalServiceParameters=r.privatePortalServiceParameters},p.prototype.GetApplication=function(e,r){return e?this.libraryManager.Core.sendRequest({url:A.PrivatePortalServiceParameters.Instance().ApplicationUrl+"/?codeApplication="+e+"&versionDebutPublication="+A.CoreCommon.VersionMySys,method:A.MethodEnum.GET,authentificationInfo:r}).then(function(e){return A.Loggers.FLASH.INSTANCE.setValue("details",e),p.loggerApplicationApiBase.debug("GetApplication Success"),e},function(e){throw p.loggerApplicationApiBase.error("GetApplication failed - %1",JSON.stringify(e)),e}):this.libraryManager.Core.createPromiseSelfError(new A.Erreur(u.Services.Libelle.LibelleModel.COM.ERREUR_APPLICATION_CODE_NON_RENSEIGNE))},p.prototype.Demarrer=function(e){return this.libraryManager.Core.createPromiseSelfResolved(!1)},p.prototype.Lancer=function(e,r,i){if(this.privatePortalServiceParameters.LocalServiceDisabled)return this.warnLocalServiceUnavailability(),this.libraryManager.Core.createPromiseSelfError(new A.Erreur(u.Services.Libelle.LibelleModel.COM.ERREUR_APPLICATION_DEMARRAGE_IMPO));var t=JSON.stringify(e),n=JSON.stringify("null");return this.libraryManager.Core.sendRequest({url:this._localServiceUrl+"/lanceur/lancer?exec="+t+"&parametres="+JSON.stringify(r)+"&contexte="+n+"&sync="+i,contentType:A.ContentTypeEnum.JSON,method:A.MethodEnum.POST,cache:!1}).then(function(){return A.Loggers.FLASH.INSTANCE.setValue("details",r),p.loggerApplicationApiBase.debug("Lancer du Service Local - Success"),!0},function(){return p.loggerApplicationApiBase.error("Lancer du Service Local - Failed"),!1})},p.prototype.OuvrirUrl=function(e,r){var i=this;return 1===e.codeExecutableConteneurMyway&&r?this.libraryManager.Lisa.startUrl(e.libelleNomApplication,e.libelleCheminExecution).then(function(e){return i.libraryManager.Lisa.endTransition(e),p.loggerApplicationApiBase.debug("Start URL Success"),!0},function(e){throw p.loggerApplicationApiBase.error("Start URL failed - %1",JSON.stringify(e)),e}):(this.libraryManager.Display.OuvrirUrl(e.libelleCheminExecution),p.loggerApplicationApiBase.debug("OuvrirUrl Success"),this.libraryManager.Core.createPromiseSelfResolved(!0))},p.prototype.LancerApplicationClientLourd=function(e,r){var i=new u.Services.Interop.ExecApp(e.libelleCheminExecution),t=new u.Services.Interop.ExecutableWrapper(i,null,null,null);return new u.Services.Interop.ContexteMyway(null,null),this.Lancer(t,r,!1).then(function(e){return p.loggerApplicationApiBase.debug("API Lancer - Success"),e},function(e){throw e=new A.Erreur(u.Services.Libelle.LibelleModel.COM.ERREUR_APPLICATION_DEMARRAGE_IMPO),p.loggerApplicationApiBase.error("API Lancer - failed - %1",JSON.stringify(e)),e})},p.prototype.DemarrerProcessus=function(e,r,i,t){var n,a=this;if(r){var o=JSON.stringify(i),l={};l.codeProcessus=e,t&&(l.valeurDepart=t.toString()),l.initData=o;var s={};s.demandeDeDemarrageDeProcessusDetail=l;var c=new A.Component.ManagerEvent(A.Component.ManagerEventType.DemandeDeDemarrageDeProcessus,s);return A.Loggers.FLASH.INSTANCE.setValue("action","_handlePortalMessage"),p.loggerApplicationApiBase.debug("Send event 'DemarreProcess' : process=%1, valeurDepart=%2, initData=%3",e,t,o),this.libraryManager.Evennements.SendEvent(c),this.libraryManager.Core.createPromiseSelfResolved(!0)}return n=null==t?null:parseInt(t),this.libraryManager.Lisa.startStandaloneProcessWithInitialisation(e,n,i).then(function(e){return i.processusAOuvrirDansUneNouvelleInstance&&a.libraryManager.Context.PutProcessInWait(e.processId),a.libraryManager.Lisa.endTransition(e),p.loggerApplicationApiBase.debug("StartStandaloneProcessWithInitialisation Success"),!0},function(){var e=new A.Erreur(u.Services.Libelle.LibelleModel.COM.ERREUR_APPLICATION_DEMARRAGE_IMPO);throw p.loggerApplicationApiBase.error("StartStandaloneProcessWithInitialisation failed - %1",JSON.stringify(e)),e})},p.prototype.warnLocalServiceUnavailability=function(){p.loggerApplicationApiBase.warn("Le service local n'a pu être joint et a été désactivé. Veuillez redémarrer le service local et recharger le portail")},p.CLASS_NAME_BASE="MyWay.Services.Application.ApplicationApiBase",p.loggerApplicationApiBase=A.Loggers.LoggerFactory.INSTANCE.getClass(p.CLASS_NAME_BASE),p}(),e.ApplicationApiBase=r}(MyWay||(MyWay={})),function(e){var r,a,i;r=e.Services||(e.Services={}),a=r.Application||(r.Application={}),i=function(n){function e(){var e=n.call(this,r.Components.ComponentType.Application)||this;return e.api=null,e}return __extends(e,n),e.prototype.init=function(e,r,i){var t=this;return e.ServiceLocal?e.InteropAppliBancaire?this.api=new a.ApplicationApiPetra:this.api=new a.ApplicationApiWindows:this.api=new a.ApplicationApiFullWeb,n.prototype.init.call(this,e,r,i).then(function(){t.api.init(r,i)})},e.prototype.dispose=function(){return this.libraryManager.Core.getPromesseSelfResoved()},e.prototype.GetApplication=function(e,r){return this.api.GetApplication(e,r)},e.prototype.Demarrer=function(e){return this.api.Demarrer(e)},e.prototype.Lancer=function(e,r,i){return this.api.Lancer(e,r,i)},e.prototype.OuvrirUrl=function(e,r){return this.api.OuvrirUrl(e,r)},e.prototype.LancerApplicationClientLourd=function(e,r){return this.api.LancerApplicationClientLourd(e,r)},e.prototype.DemarrerProcessus=function(e,r,i,t){return this.api.DemarrerProcessus(e,r,i,t)},e}(r.Components.ComponentApiBase),a.ApplicationApiFactory=i,r.Components.RegistryApi.getInstance().register(i)}(MyWay||(MyWay={})),function(i){var t,e,r;t=i.Services||(i.Services={}),e=t.Application||(t.Application={}),r=function(e){function r(){return e.call(this)||this}return __extends(r,e),r.prototype.LancerApplicationClientLourd=function(e){return this.warnLocalServiceUnavailability(),this.libraryManager.Core.createPromiseSelfError(new t.Erreur(i.Services.Libelle.LibelleModel.COM.ERREUR_APPLICATION_DEMARRAGE_IMPO))},r.CLASS_NAME="MyWay.Services.Application.ApplicationApiFullWeb",r.logger=t.Loggers.LoggerFactory.INSTANCE.getClass(r.CLASS_NAME),r}(e.ApplicationApiBase),e.ApplicationApiFullWeb=r}(MyWay||(MyWay={})),function(t){var o,e,r;o=t.Services||(t.Services={}),e=o.Application||(o.Application={}),r=function(e){function a(){return e.call(this)||this}return __extends(a,e),a.prototype.DemarrerProcessus=function(e,r,i,t){var n=JSON.stringify(i);return this.libraryManager.Core.sendRequest({url:this.privatePortalServiceParameters.LocalServiceUrl+"/lanceur/DemarrerProcessus?codeProcessus="+e+"&initData="+n+"&valeurEntree="+(null==t?"":t)+"&horsPortail=false",contentType:o.ContentTypeEnum.JSON,method:o.MethodEnum.GET,cache:!1}).then(function(){return o.Loggers.FLASH.INSTANCE.setValue("details",e),a.logger.debug("DemarrerProcessus du Service Local - Success"),!0},function(){return a.logger.error("DemarrerProcessus du Service Local - Failed"),!1})},a.prototype.OuvrirUrl=function(e){o.CoreCommon.ServiceDePromesse.defer();var r=new t.Services.Interop.ExecWeb(e.libelleCheminExecution,e.libelleNomApplication),i=new t.Services.Interop.ExecutableWrapper(null,null,null,r);return new t.Services.Interop.ContexteMyway(null,null),this.Lancer(i,[],!1).then(function(e){return a.logger.debug("API Ouvrir URL - Success"),e},function(e){throw e=new o.Erreur(t.Services.Libelle.LibelleModel.COM.ERREUR_APPLICATION_DEMARRAGE_IMPO),a.logger.error("API Ouvrir URL - failed - %1",JSON.stringify(e)),e})},a.CLASS_NAME="MyWay.Services.Application.ApplicationApiPetra",a.logger=o.Loggers.LoggerFactory.INSTANCE.getClass(a.CLASS_NAME),a}(e.ApplicationApiBase),e.ApplicationApiPetra=r}(MyWay||(MyWay={})),function(u){var A,e,r;A=u.Services||(u.Services={}),e=A.Application||(A.Application={}),r=function(e){function p(){return e.call(this)||this}return __extends(p,e),p.prototype.DemarrerProcessus=function(r,i,t,n){var e,a=this;if(t={},i){var o=JSON.stringify(t),l={};l.codeProcessus=r,n&&(l.valeurDepart=n.toString()),l.initData=o;var s={};s.demandeDeDemarrageDeProcessusDetail=l;var c=new A.Component.ManagerEvent(A.Component.ManagerEventType.DemandeDeDemarrageDeProcessus,s);return A.Loggers.FLASH.INSTANCE.setValue("action","_handlePortalMessage"),p.logger.debug("Send event 'DemarreProcess' : process=%1, valeurDepart=%2, initData=%3",r,n,o),this.libraryManager.Evennements.SendEvent(c),this.libraryManager.Core.createPromiseSelfResolved(!0)}return e=null==n?null:parseInt(n),this.libraryManager.Lisa.startStandaloneProcessWithInitialisation(r,e,t).then(function(e){return t.processusAOuvrirDansUneNouvelleInstance&&a.LancerProcessusAvecServiceLocal(r,i,t,n),a.libraryManager.Lisa.endTransition(e),p.logger.debug("StartStandaloneProcessWithInitialisation Success"),!0},function(){var e=new A.Erreur(u.Services.Libelle.LibelleModel.COM.ERREUR_APPLICATION_DEMARRAGE_IMPO);throw p.logger.error("StartStandaloneProcessWithInitialisation failed - %1",JSON.stringify(e)),e})},p.prototype.LancerProcessusAvecServiceLocal=function(e,r,i,t){var n=JSON.stringify(i);return this.libraryManager.Core.sendRequest({url:this.privatePortalServiceParameters.LocalServiceUrl+"/lanceur/DemarrerProcessus?codeProcessus="+e+"&initData="+n+"&valeurEntree="+(null==t?"":t),contentType:A.ContentTypeEnum.JSON,method:A.MethodEnum.GET,cache:!1}).then(function(){return A.Loggers.FLASH.INSTANCE.setValue("details",e),p.logger.debug("DemarrerProcessus du Service Local - Success"),!0},function(){return p.logger.error("DemarrerProcessus du Service Local - Failed"),!1})},p.CLASS_NAME="MyWay.Services.Application.ApplicationApiWindows",p.logger=A.Loggers.LoggerFactory.INSTANCE.getClass(p.CLASS_NAME),p}(e.ApplicationApiBase),e.ApplicationApiWindows=r}(MyWay||(MyWay={})),function(e){var r,i;r=e.Services||(e.Services={}),(i=r.Application||(r.Application={})).TYPE_URL_GET="G",i.TYPE_URL_POST="P"}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-application-api.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var i=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,r){e.__proto__=r}||function(e,r){for(var t in r)r.hasOwnProperty(t)&&(e[t]=r[t])};return function(e,r){function t(){this.constructor=e}i(e,r),e.prototype=null===r?Object.create(r):(t.prototype=r.prototype,new t)}}();!function(c){var s,p,e;s=c.Services||(c.Services={}),p=s.Application||(s.Application={}),e=function(n){function l(){var e=n.call(this,s.Components.ComponentType.Application)||this;return e.contextKey="APPLICATIONS",e.isTotemCapable=!0,e.delegationPortail=!1,e.api=null,e}return __extends(l,n),l.prototype.init=function(e,r,t,i){return this.api=i,this.isTotemCapable=t.isTotemCapable,t.delegationPortail&&(this.delegationPortail=t.delegationPortail),n.prototype.init.call(this,e,r,t,i)},l.prototype.remplacerVariablesContexte=function(e){return this.library.Lisa.replaceTokens(e,null).replace(new RegExp("[[]+[a-zA-Z0-9]+]|undefined","g"),"")},l.prototype.creerUrlAvecParametres=function(e){var r=this;return e.map(function(e){return e.nomVariablePost=r.remplacerVariablesContexte(e.nomVariablePost),e.valeurVariablePost=r.remplacerVariablesContexte(e.valeurVariablePost),s.CoreCommon.encoderURL(e.nomVariablePost)+"="+s.CoreCommon.encoderURL(e.valeurVariablePost)}).join("&")},l.prototype.Demarrer=function(e,r,t){var a=this;void 0===r&&(r=null),null===r&&(r=this.delegationPortail);var o=s.CoreCommon.ServiceDePromesse.defer();if(e)this.ObtenirInformationsApplication(e).then(function(e){if(1===e.codeApplicationMaintenance){var r=new s.Erreur(c.Services.Libelle.LibelleModel.COM.ERREUR_APPLICATION_MAINTENANCE);return e.libelleMessageMaintenance&&(r.libelle=e.libelleMessageMaintenance),s.Loggers.FLASH.INSTANCE.setValue("details",r),l.logger.debug("Application en maintenance"),o.reject(r)}switch(e.codeTypeApplication){case 1:case 2:case 5:if(e.libelleCheminExecution=a.remplacerVariablesContexte(e.libelleCheminExecution),e.libelleValeurParametre2===p.TYPE_URL_GET&&0<e.listeApplicationUrlValeur.length){var t=a.creerUrlAvecParametres(e.listeApplicationUrlValeur);e.libelleCheminExecution+="?"+t}a.api.OuvrirUrl(e,a.isTotemCapable).then(function(e){o.resolve(e)}).catch(function(e){o.reject(e)});break;case 3:var i=[];null!==e.libelleValeurParametre1&&(e.libelleValeurParametre1=a.remplacerVariablesContexte(e.libelleValeurParametre1),i.push(e.libelleValeurParametre1)),a.api.LancerApplicationClientLourd(e,i).then(function(e){o.resolve(e)}).catch(function(e){o.reject(e)});break;default:var n=new s.Erreur(c.Services.Libelle.LibelleModel.COM.ERREUR_APPLICATION_TYPE_INCONNU);l.logger.error("ObtenirInformationsApplication failed  %1",JSON.stringify(n)),o.reject(n)}}).catch(function(e){o.reject(e)});else{var i=new s.Erreur(c.Services.Libelle.LibelleModel.COM.ERREUR_APPLICATION_CODE_NON_RENSEIGNE);l.logger.error("Demarrer %1",JSON.stringify(i)),o.reject(i)}return o.promise},l.prototype.DemarrerProcessus=function(e,r,t,i){void 0===r&&(r=null),void 0===i&&(i=null),null===r&&(r=this.delegationPortail);var n=s.CoreCommon.ServiceDePromesse.defer();return this.api.DemarrerProcessus(e,r,t,i).then(function(e){n.resolve(e)}).catch(function(e){n.reject(e)}),n.promise},l.prototype.ObtenirInformationsApplication=function(e){return this.api.GetApplication(e,this.library.Context.GetAuthentificationInfo())},l.CLASS_NAME="MyWay.Services.Application.ApplicationManager",l.logger=s.Loggers.LoggerFactory.INSTANCE.getClass(l.CLASS_NAME),l}(s.Components.ComponentManagerBase),p.ApplicationManager=e,s.Components.RegistryManager.getInstance().register(e)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-application-manager.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var r=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,n){e.__proto__=n}||function(e,n){for(var t in n)n.hasOwnProperty(t)&&(e[t]=n[t])};return function(e,n){function t(){this.constructor=e}r(e,n),e.prototype=null===n?Object.create(n):(t.prototype=n.prototype,new t)}}();!function(e){var n;(n=e.Services||(e.Services={})).Bug||(n.Bug={})}(MyWay||(MyWay={})),function(e){var t,n,r;t=e.Services||(e.Services={}),n=t.Application||(t.Application={}),r=function(e){function n(){return e.call(this,t.Components.ComponentType.Application)||this}return __extends(n,e),n.prototype.Demarrer=function(e){return this.manager.Demarrer(e,null)},n.prototype.DemarrerProcessus=function(e,n,t,r){return void 0===n&&(n=null),void 0===r&&(r=null),this.manager.DemarrerProcessus(e,n,t,r)},n}(t.Components.ComponentManagerExtendedBase),n.ApplicationManagerExtended=r,t.Components.RegistryManagerExtended.getInstance().register(r)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-application-manager-extended.min.js.map
var MyWay,__extends=this&&this.__extends||function(){var n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var r in t)t.hasOwnProperty(r)&&(e[r]=t[r])};return function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)}}();!function(e){var r,n,t;r=e.Services||(e.Services={}),n=r.Application||(r.Application={}),t=function(t){function e(){return t.call(this,r.Components.ComponentType.Application)||this}return __extends(e,t),e.prototype.onDemarrer=function(e){return this.managerInstance.Demarrer(e.codeApplication)},e.prototype.onDemarrerProcessus=function(e){return this.managerInstance.DemarrerProcessus(e.codeProcessus,e.delegationPortail,e.initData,e.valeurDepart)},e.prototype.reception=function(e){switch(e.subject){case n.Messages.ApplicationMessageSubject.Demarrer:return this.onDemarrer(e.message);case n.Messages.ApplicationMessageSubject.DemarrerProcessus:return this.onDemarrerProcessus(e.message);default:t.prototype.reception.call(this,e)}},e.CLASS_NAME="MyWay.Services.Application.ApplicationManagerMessage",e.logger=r.Loggers.LoggerFactory.INSTANCE.getClass(e.CLASS_NAME),e}(r.Components.ComponentManagerMessageBase),n.ApplicationManagerMessage=t,r.Components.RegistryManagerMessage.getInstance().register(t)}(MyWay||(MyWay={}));
//# sourceMappingURL=mw-stc-framework-modules-application-manager-message.min.js.map